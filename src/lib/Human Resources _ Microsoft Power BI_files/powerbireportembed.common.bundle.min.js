
window.parseTimeMarkers = window.parseTimeMarkers || {};
window.parseTimeMarkers['powerbireportembed.common.bundle.min.js'] = {
    nominalStart: Date.now(),
    start: Date.now()
};
var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}})(),powerbi;!(function(e){var t;!(function(t){function r(t){var r=t[0].toLowerCase()+t.slice(1),n=e.infonav.components[t];angular.module("powerbi.infonavbootstrap").component(r,n)}angular.module("powerbi.infonavbootstrap",["powerbi.common"]).factory("interpretHttpService",["$timeout","promiseFactory",function(e,r){return t.services.createInterpretHttpService(e,r)}]).factory("interpretProbe",["interpretHttpService","promiseFactory","$timeout","featureSwitchService",function(e,r,n,a){return t.services.createInterpretProbeService(e,r,n,a)}]),t.registerInfonavBootstrapComponent=r})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Server=0]="Server",e[e.User=1]="User"})(t=e.SpanSource||(e.SpanSource={}));var r;!(function(e){e[e.None=0]="None",e[e.LinguisticSchemaAutoGenerated=1]="LinguisticSchemaAutoGenerated",e[e.LinguisticSchemaNotAvailable=2]="LinguisticSchemaNotAvailable",e[e.LinguisticSchemaIsStillLoading=4]="LinguisticSchemaIsStillLoading",e[e.InvalidDataModel=8]="InvalidDataModel",e[e.DataRetrievalFailed=16]="DataRetrievalFailed",e[e.DataRetrievalSkipped=32]="DataRetrievalSkipped",e[e.DuplicateExecuteSemanticQuery=64]="DuplicateExecuteSemanticQuery"})(r=e.InterpretWarnings||(e.InterpretWarnings={}));var n;!(function(e){e[e.AdjectivePhrasing=0]="AdjectivePhrasing",e[e.AttributePhrasing=1]="AttributePhrasing",e[e.VerbPhrasing=2]="VerbPhrasing"})(n=e.PhrasingType||(e.PhrasingType={}));var a;!(function(e){e[e.Integer=0]="Integer",e[e.Number=1]="Number",e[e.String=2]="String"})(a=e.InputType||(e.InputType={}))})(t=e.contracts||(e.contracts={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Data=1]="Data",e[e.QueryMetadata=2]="QueryMetadata",e[e.VisualConfiguration=4]="VisualConfiguration",e[e.SupportPodQueries=64]="SupportPodQueries",e[e.Cortana=128]="Cortana",e[e.Personality=256]="Personality",e[e.TermBindings=512]="TermBindings",e[e.Diagnostics=1024]="Diagnostics"})(t=e.InterpretRequestOptions||(e.InterpretRequestOptions={}))})(t=e.contracts||(e.contracts={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.openTileAction="/openQnA",e.openTileEventName="openQnaTile",e.pinSelectedVisual="pinSelectedVisual",e.showQnaStart="showQnaStart",e.ScopedInstanceProviderName="infonav",e.DefaultVisualMaxWidth=1024,e.DefaultVisualMaxHeight=768})(t=e.constants||(e.constants={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){var a=r(t);return n(a,e)}function r(e){var t;if(_.isEmpty(e))return t;for(var r=0,n=e;r<n.length;r++){var a=n[r];if(t&&a.Language!==t){t=void 0;break}t=a.Language}return t}function n(e,t){var r="";if(e){var n=!1,i=a(t.currentLanguageLocale);e=a(e);var c=o[e];c&&(r=c.resStringSuffix,n=c.preview),n||e!==i||(r="")}return t.get("Qna_Input_Placeholder"+r)}function a(e){if(e){var t=e.split("-");return t[0].toLowerCase()}}var o={en:{resStringSuffix:"_English"},es:{resStringSuffix:"_Spanish",preview:!0}};e.getPlaceholderText=t})(t=e.QnaLanguageUtil||(e.QnaLanguageUtil={}))})(t=e.utils||(e.utils={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r,n=e.common.helpers.ModelConverterHelper;!(function(e){function t(e,t){return{DbMonikers:_(e).filter((function(e){return e&&n.getIsQnaSupported(e,t)&&!_.isEmpty(e.vsName)&&!_.isEmpty(e.dbName)})).filter((function(e){return e&&!_.isEmpty(e.vsName)&&!_.isEmpty(e.dbName)})).map((function(e){return{VirtualServerName:e.vsName,DatabaseName:e.dbName}})).value()}}e.createInterpretRequestScope=t})(r=t.InterpretUtil||(t.InterpretUtil={}))})(r=t.utils||(t.utils={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r,n=jsCommon.Lazy,a=e.visuals.plugins;!(function(e){function t(e){var t=i.getValue();return t[e]}function r(e){var t=c.getValue();return t[e]}function o(e,t){for(var r=[],n={},a=0,o=t.length;a<o;a++){var i=t[a];n[i.vsName+i.dbName]=i}for(var c=e.configs,s=0,u=c.length;s<u;s++){var l=c[s],p=l.Query||e.queryDefn,f=l.DataShapeBinding||e.dataShapeBinding,d=l.QueryMetadata||e.queryMetadata,i=n[e.virtualServerName+e.databaseName];null!=i&&r.push({config:{Query:p,QueryMetadata:d,DataShapeBinding:f,VisualizationType:l.VisualizationType,VisualElements:l.VisualElements},model:i,dataViewSource:e.dataViewSource})}return r}var i=new n(function(){var e={};return e[3]=a.card,e[31]=a.lineClusteredColumnComboChart,e[29]=a.multiRowCard,e[7]=a.clusteredBarChart,e[10]=a.clusteredColumnChart,e[20]=a.donutChart,e[16]=a.funnel,e[30]=a.gauge,e[22]=a.heatMap,e[9]=a.hundredPercentStackedBarChart,e[12]=a.hundredPercentStackedColumnChart,e[4]=a.lineChart,e[1]=a.map,e[19]=a.filledMap,e[2]=a.matrix,e[5]=a.pieChart,e[6]=a.scatterChart,e[8]=a.barChart,e[11]=a.columnChart,e[0]=a.table,e[17]=a.treemap,e[23]=a.waterfallChart,e[26]=a.stackedAreaChart,e[32]=a.areaChart,e}),c=new n(function(){var e={};return e[a.card.name]=3,e[a.lineClusteredColumnComboChart.name]=31,e[a.multiRowCard.name]=29,e[a.clusteredBarChart.name]=7,e[a.clusteredColumnChart.name]=10,e[a.donutChart.name]=20,e[a.funnel.name]=16,e[a.gauge.name]=30,e[a.heatMap.name]=22,e[a.hundredPercentStackedBarChart.name]=9,e[a.hundredPercentStackedColumnChart.name]=12,e[a.lineChart.name]=4,e[a.map.name]=1,e[a.filledMap.name]=19,e[a.matrix.name]=2,e[a.pieChart.name]=5,e[a.scatterChart.name]=6,e[a.barChart.name]=8,e[a.columnChart.name]=11,e[a.table.name]=0,e[a.treemap.name]=17,e[a.waterfallChart.name]=23,e[a.stackedAreaChart.name]=26,e[a.areaChart.name]=32,e});e.getPlugin=t,e.getType=r,e.interpretResultToConfig=o})(r=t.visualUtil||(t.visualUtil={}))})(r=t.utils||(t.utils={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(t){var r;!(function(t){var r,n=e.visuals.plugins,a=e.explore.QueryProjectionBuilderCoreUtils.QueryProjectionBuilder,o=e.infonav.utils.visualUtil;!(function(e){function t(e,t,r){var n=o.getPlugin(e);if(null!=n){var a;switch(e){case 3:case 29:case 0:a=new i(n,t,r);break;case 2:a=new m(n,t,r);break;case 20:case 16:case 4:case 26:case 32:case 5:case 23:a=new c(n,t,r);break;case 7:case 10:case 9:case 12:case 8:case 11:a=new s(n,t,r);break;case 1:case 22:a=new p(n,t,r);break;case 19:a=new f(n,t,r);break;case 17:a=new d(n,t,r);break;case 6:a=new l(n,t,r);break;case 30:a=new u(n,t,r);break;default:return}return a}}e.createProjectionBuilder=t})(r=t.QueryProjectionBuilderUtils||(t.QueryProjectionBuilderUtils={}));var i=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 1===e.length&&e[0].name===a.ValuesRole},t.prototype.build=function(e){var t={};if(1===this.projectionsInfo.length)return a.addValuesRole(t,this.projectionsInfo[0]),t;for(var r=e.Primary.Groupings,n=r[0].Projections,o=0,i=n.length;o<i;o++)a.addValuesRole(t,this.projectionsInfo[n[o]]);return t},t})(a),c=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return this.plugin.name===n.funnel.name?4===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.YRole&&e[2].name===a.GradientRole&&e[3].name===a.TooltipRole:4===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.TooltipRole},t.prototype.build=function(e){var t=e.Primary.Groupings,r={};if(this.processPrimaryGroup(t[0],r),e.Secondary){var n=e.Secondary.Groupings;1===n.length&&this.processSecondaryGroup(n[0],r)}return r},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=r.length;n<o;n++){var i=r[n],c=this.projectionsInfo[i];0===c.metadata.kind?a.addCategoryRole(t,c):1===c.metadata.kind&&a.addYRole(t,c)}},t.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,n=0,o=r.length;n<o;n++){var i=r[n];a.addSeriesRole(t,this.projectionsInfo[i])}},t})(a),s=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.GradientRole&&e[4].name===a.TooltipRole},t})(c),u=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===a.YRole&&e[1].name===a.MinValueRole&&e[2].name===a.MaxValueRole&&e[3].name===a.TargetValueRole&&e[4].name===a.TooltipRole},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=0,i=r;o<i.length;o++){var c=i[o],s=this.projectionsInfo[c];if(1===s.metadata.kind){switch(n){case 0:a.addYRole(t,s);break;case 1:a.addTargetValueRole(t,s);break;case 2:a.addMaxValueRole(t,s);break;case 3:a.addMinValueRole(t,s);break;case 4:a.addTooltipRole(t,s)}n++}}},t})(c),l=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 8===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.XRole&&e[3].name===a.YRole&&e[4].name===a.SizeRole&&e[5].name===a.GradientRole&&e[6].name===a.PlayRole&&e[7].name===a.TooltipRole},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=0,i=r.length;o<i;o++){var c=r[o],s=this.projectionsInfo[c];if(0===s.metadata.kind)a.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(n){case 0:a.addXRole(t,s);break;case 1:a.addYRole(t,s);break;case 2:a.addSizeRole(t,s);break;case 3:a.addGradientRole(t,s);break;case 4:a.addTooltipRole(t,s)}n++}}},t})(c),p=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 7===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.XRole&&e[4].name===a.SizeRole&&e[5].name===a.GradientRole&&e[6].name===a.TooltipRole},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=0,i=r;o<i.length;o++){var c=i[o],s=this.projectionsInfo[c];if(0===s.metadata.kind)a.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(n){case 0:a.addSizeRole(t,s);break;case 1:a.addXRole(t,s);break;case 2:a.addYRole(t,s);break;case 3:a.addGradientRole(t,s);break;case 4:a.addTooltipRole(t,s)}n++}}},t})(c),f=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 6===e.length&&e[0].name===a.CategoryRole&&e[1].name===a.SeriesRole&&e[2].name===a.YRole&&e[3].name===a.XRole&&e[4].name===a.SizeRole&&e[5].name===a.TooltipRole},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=0,i=r;o<i.length;o++){var c=i[o],s=this.projectionsInfo[c];if(0===s.metadata.kind)a.addCategoryRole(t,s);else if(1===s.metadata.kind){switch(n){case 0:a.addSizeRole(t,s);break;case 1:a.addXRole(t,s);break;case 2:a.addYRole(t,s);break;case 3:a.addTooltipRole(t,s)}n++}}},t})(c),d=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 5===e.length&&e[0].name===a.GroupRole&&e[1].name===a.DetailsRole&&e[2].name===a.ValuesRole&&e[3].name===a.GradientRole&&e[4].name===a.TooltipRole},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=r.length;n<o;n++){var i=r[n],c=this.projectionsInfo[i];0===c.metadata.kind?a.addGroupRole(t,c):1===c.metadata.kind&&a.addValuesRole(t,c)}},t.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,n=0,o=r.length;n<o;n++){var i=r[n];a.addDetailsRole(t,this.projectionsInfo[i])}},t})(c),m=(function(e){function t(t,r,n){return e.call(this,t,r,n)||this}return __extends(t,e),t.prototype.validatePlugin=function(){var e=this.plugin.capabilities.dataRoles;return 3===e.length&&e[0].name===a.RowsRole&&e[1].name===a.ColumnsRole&&e[2].name===a.ValuesRole},t.prototype.build=function(e){var t=e.Primary.Groupings,r={};if(this.processPrimaryGroups(t,r),e.Secondary){var n=e.Secondary.Groupings;this.processSecondaryGroups(n,r)}return r},t.prototype.processPrimaryGroups=function(e,t){if(e)for(var r=0,n=e.length;r<n;r++)this.processPrimaryGroup(e[r],t)},t.prototype.processSecondaryGroups=function(e,t){if(e)for(var r=0,n=e.length;r<n;r++)this.processSecondaryGroup(e[r],t)},t.prototype.processPrimaryGroup=function(e,t){for(var r=e.Projections,n=0,o=r.length;n<o;n++){var i=(r[n],this.projectionsInfo[r[n]]);0===i.metadata.kind?a.addRowsRole(t,i):1===i.metadata.kind&&a.addValuesRole(t,i)}},t.prototype.processSecondaryGroup=function(e,t){for(var r=e.Projections,n=0,o=r.length;n<o;n++)a.addColumnsRole(t,this.projectionsInfo[r[n]])},t})(a)})(r=t.util||(t.util={}))})(r=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var r;!(function(r){var n=e.common.helpers.ModelConverterHelper,a=(function(){function r(e,r,n,a,o,i){this.$timeout=e,this.featureSwitchService=r,this.promiseFactory=n,this.interpretProbeService=a,this.conceptualSchemaProxy=o,this.localizationService=i,this.placeholder=t.utils.QnaLanguageUtil.getPlaceholderText(i),this.sendInterpretProbe()}return r.createOptions=function(){return{additionalServices:["$timeout","featureSwitchService","promiseFactory","interpretProbe","conceptualSchemaProxy","localizationService"]}},r.prototype.launchQna=function(){this.showQna(),this.$timeout((function(){return $(".qnaInputContainer #content").focus()}))},r.prototype.sendInterpretProbe=function(e){var a=this,o=_.filter(this.models,(function(e){return e&&n.getIsQnaSupported(e,a.featureSwitchService.featureSwitches)})),i=this.interpretProbeService.probe(o||[],e),c=this.promiseFactory.defer();return i.then((function(e){a.placeholder=t.utils.QnaLanguageUtil.getPlaceholderText(a.localizationService,e),r.preloadConceptualSchemas(a.models||[],a.conceptualSchemaProxy),c.resolve({})}),(function(){c.reject()})),c.promise},r.preloadConceptualSchemas=function(e,t){for(var n=3,a=Math.min(e.length,n),o=0,i=_.take(e,a);o<i.length;o++){var c=i[o];t.get(r.createDataSourceArray(c))}},r.createDataSourceArray=function(t){return e.explore.contracts.createDataSourceArray([{type:"dsr",id:t.id,packageId:t.packageId,name:void 0,dsr:{schemaName:void 0,vsName:t.vsName,dbName:t.dbName,modelId:t.id}}])},r})();r.QnaInputLauncherController=a,a.$inject=a.createOptions().additionalServices})(r=t.controllers||(t.controllers={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(t){t.QnaInputLauncher={templateUrl:"qnaInputLauncher/qnaInputLauncher.html",bindings:{models:"=",showQna:"="},controller:e.controllers.QnaInputLauncherController}})(t=e.components||(e.components={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={})),powerbi.infonav.registerInfonavBootstrapComponent("QnaInputLauncher");var powerbi;!(function(e){var t;!(function(t){var r;!(function(r){function n(e,t,r,n,o){var i=6e5;return new a(e,t,r,n,o||i)}r.createInterpretProbeService=n;var a=(function(){function r(e,t,r,n,a){this.interpretHttpService=e,this.promiseFactory=t,this.timeoutService=r,this.featureSwitchService=n,this.probePromiseCache=new o(a)}return r.prototype.probe=function(e,r,n){var a=t.utils.InterpretUtil.createInterpretRequestScope(e,this.featureSwitchService.featureSwitches);return _.isEmpty(a.DbMonikers)?this.promiseFactory.reject():this.probeInternal(a,r,n).promise},r.prototype.isProbeCompleted=function(e){var t=this.probePromiseCache.getPromise(e);return t&&t.isComplete},r.prototype.probeInternal=function(e,t,r){var n=this,a=this.probePromiseCache.getPromise(e);if(!a){var o=this.promiseFactory.defer();a={promise:o.promise,waitingInterprets:[],isComplete:!1},this.probePromiseCache.setPromise(e,a),this.sendProbeRequest(e,t).then((function(e){o.resolve(e.data)}),(function(){o.reject(),n.probePromiseCache.clearPromise(e)})),o.promise.finally((function(){a.isComplete=!0;var e=a.waitingInterprets,t=e.length;if(t>0){var r=e[t-1].runToCompletion();r.finally((function(){for(var r=0;r<t-1;r++)e[r].reject()}))}a.waitingInterprets=[]}))}return r&&a.waitingInterprets.push(r),a},r.prototype.sendProbeRequest=function(t,r){var n=6e4,a=e.common.httpService.powerbiRequestOptions(r,"InterpretProbe");return a.timeout=n,this.interpretHttpService.probe(t,r)},r})(),o=(function(){function e(e){this.cache={},this.expirationInMilliseconds=e}return e.prototype.getPromise=function(t){var r=e.getCacheKey(t),n=this.cache[r];return n&&n.expiration<Date.now()&&(delete this.cache[r],n=void 0),n},e.prototype.setPromise=function(t,r){r.expiration=Date.now()+this.expirationInMilliseconds,this.cache[e.getCacheKey(t)]=r},e.prototype.clearPromise=function(t){delete this.cache[e.getCacheKey(t)]},e.getCacheKey=function(e){return _(e.DbMonikers).sortBy((function(e){return e.VirtualServerName})).sortBy((function(e){return e.DatabaseName})).map((function(e){return e.DatabaseName+":"+e.VirtualServerName})).value().join("::")},e})()})(r=t.services||(t.services={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={})),angular.module("powerbi.infonavbootstrap").run(["$templateCache",function(e){e.put("qnaInputLauncher/qnaInputLauncher.html",'<span class="qnaInputLauncher" ng-click="$ctrl.launchQna()"><span class="glyphicon pbi-glyph-qna icon"></span><span class="qnaInputLauncherText" ng-bind="$ctrl.placeholder"></span></span>')}]);var powerbi;!(function(e){var t;!(function(t){var r;!(function(r){function n(e,t){return new i(e,t)}r.createInterpretHttpService=n;var a=25e3,o=6e4,i=(function(){function r(e,t){this.timeoutService=e,this.promiseFactory=t}return r.prototype.probe=function(r,n){var a=e.common.httpService.powerbiRequestOptions(n,"InterpretProbe");a.timeout=o;var i={Scope:r,Options:t.contracts.InterpretRequestOptions.SupportPodQueries};return e.common.httpService.post("/explore/interpretation/interpretprobe/",i,a)},r.prototype.interpret=function(t,r,n){var o=e.common.httpService.powerbiRequestOptions(r,"Interpret"),i=this.promiseFactory.defer();return o.timeout=i.promise,this.timeoutService((function(){return i.resolve({})}),a),n&&n.then((function(){return i.resolve({})})),e.common.httpService.post("/explore/interpretation/interpret/",t,o)},r})()})(r=t.services||(t.services={}))})(t=e.infonav||(e.infonav={}))})(powerbi||(powerbi={}));;var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{u(i.next(e))}catch(e){o(e)}}function a(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}u((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return a.label++,{value:n[1],done:!1};case 5:a.label++,o=n[1],n=[0];continue;case 7:n=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){a=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){a.label=n[1];break}if(6===n[0]&&a.label<s[1]){a.label=s[1],s=n;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(n);break}s[2]&&a.ops.pop(),a.trys.pop();continue}n=t.call(e,a)}catch(e){n=[6,e],o=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},powerbi;!(function(e){var t;!(function(t){var n;!(function(t){function n(t,n){void 0===n&&(n=[]);var i=t[0].toLowerCase()+t.slice(1);n.push((function(n,i,r,o){return new e.explore.infonav.directives[t](n,i,r,o)})),angular.module("powerbi.infonav").directive(i,n)}function i(t){var n=t[0].toLowerCase()+t.slice(1),i=e.explore.infonav.components[t];angular.module("powerbi.infonav").component(n,i)}angular.module("powerbi.infonav",["powerbi.explore","powerbi.common","powerbi.infonavbootstrap"]).factory("answeredQuestionEventLoggerFactory",["promiseFactory","telemetryService","$timeout",function(e,n,i){return t.createAnsweredQuestionEventLoggerFactory(e,n,i)}]).factory("interpretService",["interpretProbe","interpretHttpService","promiseFactory","$timeout","telemetryService","contentProviderHttpService","featureSwitchService",function(e,n,i,r,o,s,a){return t.services.createInterpretService(e,n,i,r,o,s,a)}]).factory("interpretUsageListener",["usageHttpService",function(t){return e.explore.infonav.usage.createInterpretUsageListener(t)}]).factory("sampleQuestionsService",["interpretService","featureSwitchService","promiseFactory",function(t,n,i){return e.explore.infonav.services.createSampleQuestionsService(t,n,i)}]).factory("usageHttpService",[function(){return e.explore.infonav.services.createUsageService()}]).factory("bindingElementFactory",["localizationService",function(t){return e.explore.infonav.services.createBindingElementFactory(t)}]).factory("termConverterService",["bindingElementFactory","rtl",function(t,n){return e.explore.infonav.services.createTermConverterService(t,n)}]).factory("qnaInputInterpreterService",["interpretService","interpretUsageListener","promiseFactory","contentProviderHttpService","answeredQuestionEventLoggerFactory","applicationOptions",function(t,n,i,r,o,s){return e.explore.infonav.services.createQnaInputInterpreterService(t,n,i,r,o,s)}]).run(["scopedProvider",function(n){n.register("visualPlugin",{services:["asyncFeatureSwitchService","mapControlFactory","promiseFactory"],scopedServices:["resourceLoader"],fn:function(t,n,i,r){return e.explore.infonav.services.createVisualPlugins(t,i,r,n)}},e.infonav.constants.ScopedInstanceProviderName).register("eventBridge",{fn:function(){return e.common.createEventBridge()}}).register("infoNavCanvasDefinitionFactory",{services:["moduleLoader","conceptualSchemaProxy","explorationProxy","explorationSerializer","featureSwitchService","geoTaggingAnalyzerService","aggrOps","promiseFactory"],scopedServices:["eventBridge"],fn:function(e,n,i,r,o,s,a,u,c){return t.services.createInfoNavCanvasDefinitionFactory(e,n,i,r,o,s,a,u,c)}})}]),t.registerInfonavDirective=n,t.registerInfonavComponent=i})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function n(t,n,i,r,o,s,a,c,l,p,d,h){void 0===n&&(n=!1),void 0===i&&(i=void 0),void 0===r&&(r=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===p&&(p=void 0),void 0===d&&(d=!1),void 0===h&&(h=!1);var v={parentId:t,isError:n,errorSource:i,errorCode:r,errorMessage:o,activityName:s,activityId:a,isDebug:c,isCancelled:l,pingLatency:p,isAppInactive:d,isInCapacity:h},g={name:"PBI.QnA.QnaHowToAskClicked",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.QnAQnaHowToAskClickedLoggers};return g}function i(t,n,i,r,o,s,a,c,l,p,d,h,v,g){void 0===r&&(r=!1),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===d&&(d=!1),void 0===h&&(h=void 0),void 0===v&&(v=!1),void 0===g&&(g=!1);var f={suggestionType:t,pageType:n,parentId:i,isError:r,errorSource:o,errorCode:s,errorMessage:a,activityName:c,activityId:l,isDebug:p,isCancelled:d,pingLatency:h,isAppInactive:v,isInCapacity:g},m={name:"PBI.QnA.QnaStartSuggestionClicked",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({suggestionType:e.telemetry.QnaStartSuggestionType[f.suggestionType],pageType:e.telemetry.QnaStartPageType[f.pageType],parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.QnAQnaStartSuggestionClickedLoggers};return m}function r(t,n,i,r,o,s,a,c,l,p,d,h,v,g,f,m,y,S,I,T,C,x){void 0===h&&(h=!1),void 0===v&&(v=void 0),void 0===g&&(g=void 0),void 0===f&&(f=void 0),void 0===m&&(m=void 0),void 0===y&&(y=void 0),void 0===S&&(S=!1),void 0===I&&(I=!1),void 0===T&&(T=void 0),void 0===C&&(C=!1),void 0===x&&(x=!1);var w={EventsKitEventName:t,howEnded:n,isResponseEmpty:i,fromCache:r,contentProviderType:o,ownerType:s,duration:a,probeDuration:c,wasCancelled:l,interpretRequestId:p,parentId:d,isError:h,errorSource:v,errorCode:g,errorMessage:f,activityName:m,activityId:y,isDebug:S,isCancelled:I,pingLatency:T,isAppInactive:C,isInCapacity:x},b={name:"PBI.QnA.INAQ",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({EventsKitEventName:w.EventsKitEventName,howEnded:w.howEnded,isResponseEmpty:w.isResponseEmpty,fromCache:w.fromCache,contentProviderType:w.contentProviderType,ownerType:e.telemetry.OwnerType[w.ownerType],duration:w.duration,probeDuration:w.probeDuration,wasCancelled:w.wasCancelled,interpretRequestId:w.interpretRequestId,parentId:w.parentId},{isError:w.isError,errorSource:e.telemetry.ErrorSource[w.errorSource],errorCode:w.errorCode,errorMessage:w.errorMessage,activityName:w.activityName,activityId:w.activityId,isDebug:w.isDebug,isCancelled:w.isCancelled,pingLatency:w.pingLatency,isAppInactive:w.isAppInactive,isInCapacity:w.isInCapacity})},info:w,loggers:e.telemetry.QnAINAQLoggers};return b}function o(t,n,i,r,o,s,a,c,l,p,d,h){void 0===n&&(n=!1),void 0===i&&(i=void 0),void 0===r&&(r=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===p&&(p=void 0),void 0===d&&(d=!1),void 0===h&&(h=!1);var v={parentId:t,isError:n,errorSource:i,errorCode:r,errorMessage:o,activityName:s,activityId:a,isDebug:c,isCancelled:l,pingLatency:p,isAppInactive:d,isInCapacity:h},g={name:"PBI.QnA.QuestionBoxLoadingMessage",category:e.TelemetryCategory.Verbose,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.QnAQuestionBoxLoadingMessageLoggers};return g}function s(t,n,i,r,o,s,a,c,l,p,d,h,v){void 0===i&&(i=!1),void 0===r&&(r=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===p&&(p=!1),void 0===d&&(d=void 0),void 0===h&&(h=!1),void 0===v&&(v=!1);var g={isUtteranceEmpty:t,parentId:n,isError:i,errorSource:r,errorCode:o,errorMessage:s,activityName:a,activityId:c,isDebug:l,isCancelled:p,pingLatency:d,isAppInactive:h,isInCapacity:v},f={name:"PBI.QnA.DropdownItemSelected",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isUtteranceEmpty:g.isUtteranceEmpty,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.QnADropdownItemSelectedLoggers};return f}function a(t,n,i,r,o,s,a,c,l,p,d,h){void 0===n&&(n=!1),void 0===i&&(i=void 0),void 0===r&&(r=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===p&&(p=void 0),void 0===d&&(d=!1),void 0===h&&(h=!1);var v={parentId:t,isError:n,errorSource:i,errorCode:r,errorMessage:o,activityName:s,activityId:a,isDebug:c,isCancelled:l,pingLatency:p,isAppInactive:d,isInCapacity:h},g={name:"PBI.QnA.QuestionBoxAutoComplete",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.QnAQuestionBoxAutoCompleteLoggers};return g}var u=jsCommon.Utility;t.QnAQnaHowToAskClicked=n;var c;!(function(e){e[e.Generated=0]="Generated",e[e.Tile=1]="Tile",e[e.FeaturedQuestion=2]="FeaturedQuestion"})(c=t.QnaStartSuggestionType||(t.QnaStartSuggestionType={}));var l;!(function(e){e[e.HowToAsk=0]="HowToAsk",e[e.ErrorPage=1]="ErrorPage"})(l=t.QnaStartPageType||(t.QnaStartPageType={})),t.QnAQnaStartSuggestionClicked=i;var p;!(function(e){e[e.Unknown=0]="Unknown",e[e.Owner=1]="Owner",e[e.Shared=2]="Shared"})(p=t.OwnerType||(t.OwnerType={})),t.QnAINAQ=r,t.QnAQuestionBoxLoadingMessage=o,t.QnADropdownItemSelected=s,t.QnAQuestionBoxAutoComplete=a})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(t){function n(e,t,n,r){return new i(e,n,t,new o(e,r))}var i=e.explore.services.ExplorationVisualPluginService,r=e.explore.services.ExplorationVisualPluginProvider;t.createVisualPlugins=n;var o=(function(){function t(e,t){this.featureSwitchService=e,this.explorationPlugins=new r(e,t)}return t.prototype.getPlugin=function(t){var n=this.featureSwitchService.featureSwitches;switch(t){case e.visuals.plugins.card.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.card,(function(){return new e.visuals.Card({isScrollable:!0,displayUnitSystemType:e.DisplayUnitSystemType.Verbose})}),n);default:return this.explorationPlugins.getPlugin(t)}},t})()})(n=t.services||(t.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(n){var i;!(function(n){var i=t.ScopeUtils,r=(function(){function t(t,n){var r=this;if(this.scope=t,this.services=n,this.infoNavContainerOptions=this.services.explorationCapabilities.getCapabilities(),t.viewModel={exploreCanvas:null},t.respectPaneUpdates){var o=this.services.eventBridge.setBubblingScope(this.services.rootScope).subscribe(e.explore.services.events.visualConversion,(function(e,t){return r.onVisualConversion(t)}));t.$on("$destroy",(function(){o.unsubscribeAll()}))}i.defineDataSourcesOnScopeLegacy(this.scope,this.services.dataSources),this.handleNewCanvasDefinition(t.canvasDefinition,null),t.$watch("canvasDefinition",(function(e,t){return r.handleNewCanvasDefinition(e,t)}))}return t.createOptions=function(){return{scopedDependencies:["dataSources","eventBridge","explorationCapabilities","explorationNavigation","selection"]}},t.prototype.handleNewCanvasDefinition=function(e,t){var n=this,i=this.services,r=this.scope;if(this.services.dataSources.set(null),r.packageId=null,!e)return r.sourceLabel=null,void(r.viewModel.exploreCanvas=null);var o=e.dataSources;this.services.dataSources.set(o),r.packageId=e.model.packageId,e.initialize(t,i.eventBridge,this.scope.respectPaneUpdates,i.selection).then((function(){e===n.scope.canvasDefinition&&(i.explorationNavigation.goto(e.section),r.viewModel.exploreCanvas=e.exploreCanvas,n.updateExplorationMaxSize(e))}))},t.prototype.onVisualConversion=function(e){var t=this.scope.canvasDefinition;t&&(t.onVisualConversion(e.newVisualType),this.updateExplorationMaxSize(t))},t.prototype.updateExplorationMaxSize=function(e){if(!this.infoNavContainerOptions.cortana){var t={};e.maxWidth>0&&(t["max-width"]=e.maxWidth+"px"),e.maxHeight>0&&(t["max-height"]=e.maxHeight+"px"),this.scope.explorationStyle=t}},t})();n.InfoNavCanvasController=r})(i=n.controllers||(n.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(n){var i;!(function(i){var r=e.infonav.constants,o=jsCommon.EnumExtensions,s=e.explore.constants,a=e.explore.viewModels,u=e.common.helpers.ModelConverterHelper,c=e.common.contracts.Permissions,l=t.ScopeUtils,p=110,d=50,h=(function(){function t(e,t){this.scope=e,this.services=t,this.initialize()}return t.createOptions=function(){return{scopedServiceRoot:!0,scopedProviderInstanceName:r.ScopedInstanceProviderName,additionalServices:["featureSwitchService","resourcePackagesService","localizationService","rtl"],scopedDependencies:["dataSources","infoNavCanvasDefinitionFactory","explorationCapabilities","explorationNavigation","filterGenerator","pinVisual","selection","undoRedo","viewModeState","visualPlugin"]}},t.prototype.onInterpretSuccess=function(e,t,n,i){var r=_.find(this.scope.models,(function(e){return e.vsName===t.virtualServerName&&e.dbName===t.databaseName}));this.scope.sourceLabel=this.getSourceLabelForModel(r),t.restatement&&this.scope.newQnaEnabled&&(this.scope.restatement=t.restatement.replace(/^Show /,"Showing ")),i&&this.handleNewInterpretResponse(e,t,n)},t.prototype.getSourceLabelForModel=function(e){return e&&!_.isEmpty(e.displayName)?this.services.localizationService.format("InfoNav_SourceLabel",[e.displayName]):null},t.prototype.handleNewInterpretResponse=function(e,t,i){this.utterance=e.utterance,this.utteranceData=t;var r=this.scope.infoNavContainerOptions.cortana?n.services.SingleVisualizationType.Cortana:n.services.SingleVisualizationType.PrimaryVisual,o=this.services.infoNavCanvasDefinitionFactory.createGivenUtteranceData(t,this.scope.models,i,r,this.services.visualPlugin,this.services.resourcePackagesService);this.setNewCanvasDefinition(o)},t.prototype.onInterpretError=function(e){this.utterance=e,this.scope.sourceLabel=this.scope.restatement=null,this.showDefaultError(e),this.scope.hostService.updatePinIconState&&this.scope.hostService.updatePinIconState({visible:!1,enabled:!1})},t.prototype.onInterpretResultCleared=function(){this.utterance="",this.scope.sourceLabel=this.scope.restatement=null,this.scope.hasResult=!1,this.scope.infoNavCanvasDefinition=null,this.updateState(0),this.scope.hostService.updatePinIconState&&this.scope.hostService.updatePinIconState({visible:!1,enabled:!1})},t.prototype.onInterpretIssued=function(){3!==this.scope.state&&2!==this.scope.state&&this.updateState(1)},t.prototype.initialize=function(){var e=this;l.defineDataSourcesOnScopeLegacy(this.scope,this.services.dataSources),this.scope.infoNavContainerOptions?this.services.explorationCapabilities.setCapabilities(this.scope.infoNavContainerOptions):this.scope.infoNavContainerOptions=this.services.explorationCapabilities.getCapabilities(),this.scope.infoNavContainerOptions.shouldShowPageFilters=function(t){return e.shouldShowPageFilters(t)},this.services.explorationCapabilities.setCapabilities(this.scope.infoNavContainerOptions),this.services.viewModeState.setMode(0),this.explorationLoadedEventRaised=!1,this.scope.viewModel=n.viewModels.ViewModelFactory.createInfoNavContainer(this.services.filterGenerator),this.scope.hasResult=!1;var i=a.createFieldListViewModelFactory(a.createFieldListMenuItemFactory(this.services.localizationService,this.services.featureSwitchService),a.createFieldListPropertyTemplateGenerator(),this.services.localizationService,this.services.featureSwitchService);this.scope.fieldListConfig={viewModelFactory:i,alwaysHasActiveItem:!0},this.scope.newQnaEnabled=!this.services.rtl.isRtlLayout&&!this.scope.infoNavContainerOptions.cortana;var o=this.scope.hostService.getInitialVisualState;this.scope.state=o?o():0,this.services.undoRedo.setHandler({rollback:function(){},takeSnapshot:function(){return null}}),this.scope.hasExplorePermission=function(e){return t.hasExplorePermission(e)},this.services.pinVisual.setHandler({pinVisual:function(t){e.pinVisual(t)}}),this.interpretListener=new y(this.services.timeout,new g(this.services.timeout,new f(this))),this.scope.hostService.setInterpretListener(this.interpretListener),this.scope.$watchGroup(["infoNavCanvasDefinition","infoNavCanvasDefinition.maxHeight"],(function(){e.scope.infoNavContentMaxHeight=null;var t=e.scope.infoNavCanvasDefinition;if(t&&t.maxHeight&&t.maxHeight>0){var n=p+d;e.scope.infoNavContentMaxHeight=t.maxHeight+n+"px"}}));var s=this.services.rootScope.$on(r.openTileEventName,(function(t,n){return e.onOpenTile(t,n)})),u=this.services.rootScope.$on(r.pinSelectedVisual,(function(t){return e.pinSelectedVisual(t)})),c=this.services.rootScope.$on(r.showQnaStart,(function(){e.scope.hasResult=!1,e.scope.state=4}));this.scope.$on("$destroy",(function(){e.interpretListener=null,e.scope.hostService.setInterpretListener(null),s(),u(),c()}))},t.prototype.shouldShowPageFilters=function(e){var t=this.scope.infoNavCanvasDefinition;return t.section!==e||t.showPageFilters},t.prototype.setNewCanvasDefinition=function(e){var t=this;this.scope.infoNavCanvasDefinition=e,this.raiseExplorationLoadedEventIfNeeded();var n=e.dataSources;this.services.dataSources.set(n),this.scope.packageId=e.model.packageId,e.initializePromise.then((function(){e===t.scope.infoNavCanvasDefinition&&(e.resetSelection&&t.services.selection.clearSelection(),t.scope.hostService.updatePinIconState&&t.scope.hostService.updatePinIconState({visible:!0,enabled:e.pinEnabled}),t.services.viewModeState.updateConfig((function(n){n.alwaysPopulatePanes=!t.scope.infoNavContainerOptions.cortana&&!e.pod})),t.scope.infoNavContainerOptions.showTaskPane=!t.scope.infoNavContainerOptions.cortana&&!e.pod,t.services.explorationCapabilities.setCapabilities(t.scope.infoNavContainerOptions),t.updateState(3),t.scope.hasResult=!0)}))},t.prototype.pinVisual=function(e){var t=this.scope.infoNavCanvasDefinition.model;t&&(this.scope.infoNavCanvasDefinition.pod||(e.action={action:r.openTileAction},e.utterance=this.utterance,e.modelId=t.id,e.packageId=t.packageId,this.services.rootScope.$emit(s.pinVisualContainerEventName,e)))},t.prototype.showDefaultError=function(t){var n=this;this.scope.hasResult=!1,this.scope.infoNavCanvasDefinition=null,this.updateState(2);var i=this.services.featureSwitchService.featureSwitches,r=_.any(this.scope.models,(function(e){return u.getIsQnaSupported(e,i)}));e.common.localize.ensureLocalization((function(){r?n.scope.errorMessage=e.common.localize.get("QnaStart_ErrorPrompt"):n.scope.errorMessage=e.common.localize.get(1===n.scope.models.length?"QnAVisualization_UnsupportedModelTitleText":"QnAVisualization_UnsupportedModelsTitleText")}))},t.prototype.updateState=function(e){var t=this,n=this.scope;n.state!==e&&(!this.openTileEvent||3!==e&&2!==e||(2!==e?this.openTileEvent.resolve():this.openTileEvent.reject(),this.openTileEvent=null),n.state=e,this.raiseStateChanged(),window.setTimeout((function(){return t.scope.$apply()})))},t.prototype.onOpenTile=function(e,t){e.stopPropagation(),this.interpretListener.onInterpretResultCleared(),this.openTileEvent=t.openTileTelemetryEvent,this.utterance=t.utterance,this.utteranceData=null;var n=this.services.infoNavCanvasDefinitionFactory.createGivenTileData(t,this.scope.models,this.services.visualPlugin);this.setNewCanvasDefinition(n),this.scope.hostService.setUtteranceText&&t.utterance&&this.scope.hostService.setUtteranceText(t.utterance)},t.prototype.pinSelectedVisual=function(t){if(t.stopPropagation(),3===this.scope.state)if(this.scope.infoNavCanvasDefinition.pod){var n=this.scope.infoNavCanvasDefinition,i={exploration:n.exploration,section:n.section,reportId:n.exploration.contract.reportId,modelId:n.model.id,packageId:n.model.packageId,action:{action:e.common.constants.openQnAActionName},utterance:this.utterance,pod:n.pod.name,filters:n.extractParameterFilters()};this.services.rootScope.$emit(e.common.constants.pinReportPageToDashboard,i)}else{var r=this.services.selection.getSelectedElements(),o=r[0].visualContainer,s=[],a=o.filters||[],u=this.services.explorationNavigation.getCurrentSection();u&&u.filters&&u.filters.length&&(a=a.concat(u.filters));for(var c=[],l=0,p=a.length;l<p;l++){var d=a[l].filter;d&&(s.push(d),c.push(a[l]))}var h={dataFilter:e.data.SemanticFilter.merge(s),highlightFilter:null,filterMetadata:this.services.filterGenerator.generateFilterMetadata(c)};this.services.pinVisual.pinVisualContainer(this.scope.infoNavCanvasDefinition.dataSources,o,h)}},t.prototype.raiseStateChanged=function(){var e=this.scope.hostService.onStateChanged;e&&e(this.utteranceData,this.scope.state)},t.prototype.raiseExplorationLoadedEventIfNeeded=function(){this.explorationLoadedEventRaised||(this.scope.$broadcast(e.explore.constants.explorationLoadedEventName),this.explorationLoadedEventRaised=!0)},t.hasExplorePermission=function(e){return o.hasFlag(e.permissions,c.Explore)||o.hasFlag(e.permissions,c.ReadWrite)},t})();i.InfoNavContainerController=h;var v=500,g=(function(){function e(e,t,n){this.timeout=e,this.interpretListener=t,this.throttleTimeoutMilliseconds=n||v}return e.prototype.onInterpretIssued=function(){this.interpretListener.onInterpretIssued()},e.prototype.onInterpretSuccess=function(e,t,n,i){var r=this;this.doThrottledVisualUpdate((function(){return r.interpretListener.onInterpretSuccess(e,t,n,i)}))},e.prototype.onInterpretError=function(e,t){var n=this;this.doThrottledVisualUpdate((function(){return n.interpretListener.onInterpretError(e,t)}))},e.prototype.onInterpretResultCleared=function(){this.cancelThrottledVisualUpdate(),this.interpretListener.onInterpretResultCleared()},e.prototype.cancelThrottledVisualUpdate=function(){this.throttledVisualUpdatePromise&&this.timeout.cancel(this.throttledVisualUpdatePromise),this.throttledVisualUpdatePromise=null,this.doWaitingVisualUpdate=null},e.prototype.doThrottledVisualUpdate=function(e){var t=this;this.throttledVisualUpdatePromise?this.doWaitingVisualUpdate=e:(e(),this.throttledVisualUpdatePromise=this.timeout((function(){if(t.throttledVisualUpdatePromise=null,t.doWaitingVisualUpdate){var e=t.doWaitingVisualUpdate;t.doWaitingVisualUpdate=null,t.doThrottledVisualUpdate(e)}}),this.throttleTimeoutMilliseconds))},e})();i.ThrottledInterpretListener=g;var f=(function(){function e(e){this.innerListener=e}return e.prototype.onInterpretIssued=function(){this.innerListener.onInterpretIssued()},e.prototype.onInterpretSuccess=function(e,t,n,i){this.currentUtteranceData&&t.interpretResult.completedUtterance===this.currentUtteranceData.interpretResult.completedUtterance||(this.currentUtteranceData=t,this.innerListener.onInterpretSuccess(e,t,n,i))},e.prototype.onInterpretError=function(e,t){this.innerListener.onInterpretError(e,t)},e.prototype.onInterpretResultCleared=function(){this.innerListener.onInterpretResultCleared()},e})();i.CompletedUtteranceInterpretListener=f;var m=1e3,y=(function(){function e(e,t,n){this.timeout=e,this.interpretListener=t,this.errorDelayTimeoutMilliseconds=n||m}return e.prototype.onInterpretIssued=function(){this.cancelWaitingError(),this.interpretListener.onInterpretIssued()},e.prototype.onInterpretSuccess=function(e,t,n,i){this.cancelWaitingError(),this.interpretListener.onInterpretSuccess(e,t,n,i)},e.prototype.onInterpretError=function(e,t){var n=this;this.cancelWaitingError(),t||(this.onErrorPromise=this.timeout((function(){n.interpretListener.onInterpretError(e,t)}),this.errorDelayTimeoutMilliseconds))},e.prototype.onInterpretResultCleared=function(){this.cancelWaitingError(),this.interpretListener.onInterpretResultCleared()},e.prototype.cancelWaitingError=function(){this.onErrorPromise&&this.timeout.cancel(this.onErrorPromise),this.onErrorPromise=null},e})();i.DelayedErrorInterpretListener=y})(i=n.controllers||(n.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=e.common.helpers.ModelConverterHelper,r=10,o=(function(){function n(e,t){var i=this;this.scope=e,this.services=t,e.showUtterance=function(e){return i.showUtterance(e)},e.toggleLimit=function(e){return n.toggleLimit(e)},e.viewModel={modelSuggestionSets:[]},this.loadSuggestions(),e.$watch("models",(function(){return i.loadSuggestions()}))}return n.createOptions=function(){return{additionalServices:["localizationService","promiseFactory","sampleQuestionsService","telemetryService","featureSwitchService"]}},n.prototype.loadSuggestions=function(){var e=this.services,t=this.scope,i=t.models;return _.isEmpty(i)?void(t.viewModel.modelSuggestionSets=[]):(t.isLoading=!0,void n.loadSuggestionsForModels(i,e).then((function(e){i===t.models&&(t.viewModel.modelSuggestionSets=e,t.isLoading=!1)})))},n.loadSuggestionsForModels=function(e,t){for(var i=t.promiseFactory.defer(),r=[],o=t.sampleQuestionsService.getSampleQuestions(e),s=0,a=0,u=o;a<u.length;a++){var c=u[a];c.then((function(o){if(!_.isEmpty(o)){var s=n.getSuggestionsForSampleQuestions(e,o,t.featureSwitchService.featureSwitches);n.mergeSuggestionSets(r,s),r.length>0&&i.resolve(r)}})),c.finally((function(){s++,s===o.length&&i.resolve(r)}))}return i.promise},n.getSuggestionsForSampleQuestions=function(e,t,o){return _.isEmpty(t)?[]:_(e||[]).filter((function(e){return i.getIsQnaSupported(e,o)})).map((function(e){return{modelName:e.displayName,dbName:e.dbName,vsName:e.vsName,initialSuggestionLimit:r,currentSuggestionLimit:r,suggestions:_(t).filter((function(t){return t.modelId===e.id})).map((function(e){return{suggestion:e.question.trim(),source:n.convertSampleQuestionSource(e.source)}})).uniq((function(e){return e.suggestion.toUpperCase()})).value()}})).filter((function(e){return e.suggestions.length>0})).value()},n.mergeSuggestionSets=function(e,t){for(var n=0,i=t;n<i.length;n++){var r=i[n],o=r.dbName,s=r.vsName,a=_.find(e,(function(e){return e.dbName===o&&e.vsName===s}));a?a.suggestions=_(a.suggestions.concat(r.suggestions)).uniq((function(e){return e.suggestion.trim().toUpperCase()})).value():e.push(r)}},n.prototype.showUtterance=function(t){var n=_.isEmpty(this.scope.errorMessage)?e.telemetry.QnaStartPageType.HowToAsk:e.telemetry.QnaStartPageType.ErrorPage;this.services.telemetryService.logEvent(e.telemetry.QnAQnaStartSuggestionClicked,t.source,n);var i=t.suggestion;_.endsWith(i," ")||(i+=" "),this.scope.interpretUtterance(i)},n.toggleLimit=function(e){e.currentSuggestionLimit?e.currentSuggestionLimit=void 0:e.currentSuggestionLimit=e.initialSuggestionLimit},n.convertSampleQuestionSource=function(n){switch(n){case t.services.SampleQuestionSource.Generated:return e.telemetry.QnaStartSuggestionType.Generated;case t.services.SampleQuestionSource.Tile:return e.telemetry.QnaStartSuggestionType.Tile;case t.services.SampleQuestionSource.FeaturedQuestion:return e.telemetry.QnaStartSuggestionType.FeaturedQuestion;default:return e.telemetry.QnaStartSuggestionType.Generated}},n})();n.InfoNavQnaStartController=o})(n=t.controllers||(t.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i;!(function(n){var i=e.common.helpers.ModelConverterHelper,r=(jsCommon.DOMConstants,e.infonav.utils.QnaLanguageUtil),o=(function(){function e(e,o,s,a,u,c,l,p,d){var h=this;this.interpretService=l,this.qnaInputInterpreterService=d,this.utteranceElement=e.find("#utteranceContent")[0],this.captureElement=e.find("#cap")[0],this.contentElement=e.find("#content")[0],this.stateMachine=t.stateMachine.createStateMachine(n.QnaInputStateMachine.definition,n.QnaInputState.Inactive),this.registerStateMachineActions();var v={stateMachine:this.stateMachine,contentElement:this.contentElement,utteranceElement:this.utteranceElement,captureElement:this.captureElement,utterance:function(e,t){return h.processUtterance(e,t)},selectCharacters:function(e,t){return h.selectCharacters(e,t)}};this.termManager=new n.TermManager(p,v);var g=this.output;g.showQnaFeedback=!1,g.updateUtteranceWithoutInterpret=function(e){h.processUtterance(e,!0,!0),h.sendInterpretForCurrentInput(!1),h.selectCharacters(e.length),h.contentElement.focus()},g.interpretUtterance=function(e){var t=h.processUtterance(e);return h.selectCharacters(t.length),h.contentElement.focus(),t};var f=a.featureSwitches;this.sharedViewModel={additionalODataFilterGetter:function(){return h.getAdditionalODataFilter},interpretListener:function(){return h.interpretListener},interpretResponse:null,models:function(){return _.filter(h.models,(function(e){return e&&i.getIsQnaSupported(e,f)}))},showLoadingPlaceholder:!1,showLoadingSpinner:!1,showPinButton:!1,showQnaFeedback:function(e){return h.output.showQnaFeedback=e},stateMachine:this.stateMachine,storedUserInput:null,usageReportingEnabled:function(){return h.usageReportingEnabled},userInput:function(e){return h.processUtterance(e)}},this.interpretService.probe(_.filter(this.models,(function(e){return e&&i.getIsQnaSupported(e,f)}))).then((function(e){var t=_.map(e.results,(function(e){return e.source}));h.placeholder=r.getPlaceholderText(s,t)})),this.addEventListeners()}return e.createOptions=function(){return{additionalServices:["$element","interpretUsageListener","localizationService","featureSwitchService","modalDialogService","promiseFactory","interpretService","termConverterService","qnaInputInterpreterService"]}},e.prototype.handleResize=function(){this.termManager&&this.termManager.handleResize()},e.prototype.selectUtterance=function(){this.contentElement.focus(),this.selectCharacters(0,this.utterance.length)},e.prototype.processUtterance=function(e,t,i){if(void 0!==e){e=e.replace(/\s/g," ");var r=this.contentElement.selectionStart,o=this.contentElement.selectionEnd;this.termManager.updateUtterance(this.output.utterance,e,t),this.contentElement.value=this.output.utterance=e,this.selectCharacters(r,o),_.isEmpty(e)?this.interpretListener&&this.interpretListener.onInterpretResultCleared():i||this.stateMachine.enqueueTransition(n.QnaInputTransitionId.TextChanged);
}return this.utterance},Object.defineProperty(e.prototype,"utterance",{get:function(){return this.output.utterance},set:function(e){this.processUtterance(e)},enumerable:!0,configurable:!0}),e.prototype.addEventListeners=function(){var e=this;this.contentElement.addEventListener("input",(function(t){return e.utterance=e.contentElement.value})),this.contentElement.addEventListener("focus",(function(){return e.utteranceFocus()})),this.contentElement.addEventListener("blur",(function(){return e.utteranceBlur()})),this.contentElement.addEventListener("keyup",(function(t){switch(t.keyCode){case 39:case 37:case 35:case 36:e.stateMachine.enqueueTransition(n.QnaInputTransitionId.NavigateLeftRight)}})),this.contentElement.addEventListener("keydown",(function(t){switch(t.keyCode){case 9:e.termManager.hasCurrentTerm()&&(e.stateMachine.enqueueTransition(n.QnaInputTransitionId.TextSuggestionConfirmed),t.preventDefault());break;case 13:e.termManager.hasCurrentTerm()?e.stateMachine.enqueueTransition(n.QnaInputTransitionId.TextSuggestionConfirmed):e.stateMachine.enqueueTransition(n.QnaInputTransitionId.ConfirmQuery),t.preventDefault();break;case 40:e.stateMachine.enqueueTransition(n.QnaInputTransitionId.NavigateDown),t.preventDefault();break;case 38:e.stateMachine.enqueueTransition(n.QnaInputTransitionId.NavigateUp),t.preventDefault();break;case 27:e.termManager.hasOpenMenu?e.termManager.hideMenus():e.clear(),t.preventDefault()}}))},e.prototype.hideAllMenus=function(){this.stateMachine.enqueueTransition(n.QnaInputTransitionId.NavigateOutOfBounds)},e.prototype.utteranceBlur=function(){this.stateMachine.enqueueTransition(n.QnaInputTransitionId.EndSession)},e.prototype.utteranceFocus=function(){this.contentElement.value===this.placeholder&&(this.contentElement.value=""),_.isEmpty(this.contentElement.value)&&this.stateMachine.enqueueTransition(n.QnaInputTransitionId.BeginSession)},e.prototype.clear=function(){this.contentElement.value=this.utterance="",this.termManager.clearTerms(),this.interpretListener&&this.interpretListener.onInterpretResultCleared(),this.contentElement.focus()},e.prototype.selectCharacters=function(e,t){void 0===t&&(t=e),this.contentElement.setSelectionRange(e,t)},e.prototype.registerStateMachineActions=function(){var e=this;this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.interpret,(function(){return e.sendInterpretForCurrentInput()})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.sendInterpretProbe,(function(){return e.interpretService.probe(e.models)})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.displayQueryResult,(function(){return e.interpretLoaded(!1)})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.updateResult,(function(){return e.interpretLoaded(!0)})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.storeUserInput,(function(){})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.restoreUserInput,(function(){})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.clearUserInputBuffer,(function(){})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.displaySuggestionsForEmptyQuery,(function(){})),this.stateMachine.addTransitionActionHandler(n.QnaInputTransitionAction.textInput_UpdateTermSelection,(function(){}))},e.prototype.sendInterpretForCurrentInput=function(e){void 0===e&&(e=!0),this.interpretListener&&this.interpretListener.onInterpretIssued(),this.qnaInputInterpreterService.sendInterpret(this.utterance,this.sharedViewModel,this.termManager.getUserSpanBindings(),e)},e.prototype.interpretLoaded=function(e){var t=this.sharedViewModel.interpretResponse,n=this.contentElement.selectionEnd>=this.contentElement.value.trim().length&&!e;this.termManager.processInterpret(t,n)},e})();n.QnaInputController=o,o.$inject=o.createOptions().additionalServices})(i=n.qna||(n.qna={}))})(n=t.controllers||(t.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(e){e[e.clearInterpretResult=0]="clearInterpretResult",e[e.clearUserInputBuffer=1]="clearUserInputBuffer",e[e.displayQueryResult=2]="displayQueryResult",e[e.displaySuggestionsForEmptyQuery=3]="displaySuggestionsForEmptyQuery",e[e.interpret=4]="interpret",e[e.restoreUserInput=5]="restoreUserInput",e[e.selectTerm=6]="selectTerm",e[e.sendInterpretProbe=7]="sendInterpretProbe",e[e.setInputTextToSelectedSuggestion=8]="setInputTextToSelectedSuggestion",e[e.storeUserInput=9]="storeUserInput",e[e.suggestionList_Clear=10]="suggestionList_Clear",e[e.suggestionList_ClearPreserveRestatement=11]="suggestionList_ClearPreserveRestatement",e[e.suggestionList_ClearSelection=12]="suggestionList_ClearSelection",e[e.suggestionList_SelectNext=13]="suggestionList_SelectNext",e[e.suggestionList_SelectPrevious=14]="suggestionList_SelectPrevious",e[e.textInput_Blur=15]="textInput_Blur",e[e.textInput_Clear=16]="textInput_Clear",e[e.textInput_ClearTermHighlights=17]="textInput_ClearTermHighlights",e[e.textInput_CompleteInput=18]="textInput_CompleteInput",e[e.textInput_ShowAutoCompletion=19]="textInput_ShowAutoCompletion",e[e.textInput_UpdateTermSelection=20]="textInput_UpdateTermSelection",e[e.updateResult=21]="updateResult",e[e.hideMenus=22]="hideMenus",e[e.startNavigate=23]="startNavigate",e[e.findTerm=24]="findTerm"})(n=t.QnaInputTransitionAction||(t.QnaInputTransitionAction={}));var i;!(function(e){e[e.BeginSession=0]="BeginSession",e[e.EndSession=1]="EndSession",e[e.ClearInterpretResult=2]="ClearInterpretResult",e[e.ClearQueryWithBlur=3]="ClearQueryWithBlur",e[e.ClearQueryWithoutBlur=4]="ClearQueryWithoutBlur",e[e.ConfirmQuery=5]="ConfirmQuery",e[e.TextChanged=6]="TextChanged",e[e.CompleteQuery=7]="CompleteQuery",e[e.NavigateUp=8]="NavigateUp",e[e.NavigateDown=9]="NavigateDown",e[e.NavigateOutOfBounds=10]="NavigateOutOfBounds",e[e.TextSuggestionSelected=11]="TextSuggestionSelected",e[e.TextSuggestionConfirmed=12]="TextSuggestionConfirmed",e[e.TermSelected=13]="TermSelected",e[e.ResultReady=14]="ResultReady",e[e.NavigateLeftRight=15]="NavigateLeftRight"})(i=t.QnaInputTransitionId||(t.QnaInputTransitionId={}));var r;!(function(e){e[e.Inactive=0]="Inactive",e[e.Typing=1]="Typing",e[e.BrowseSuggestions=2]="BrowseSuggestions",e[e.TermSelection=3]="TermSelection"})(r=t.QnaInputState||(t.QnaInputState={}));var o=(function(){function t(){}return Object.defineProperty(t,"definition",{get:function(){return t.storedDefinition||t.initializeDefinition(),t.storedDefinition},enumerable:!0,configurable:!0}),t.initializeDefinition=function(){t.storedDefinition=new e.stateMachine.StateMachineDefinition,t.storedDefinition.addTransition(r.Inactive,i.BeginSession,r.Typing,t.beginSessionActions),t.storedDefinition.addTransition(r.Inactive,i.ClearInterpretResult,r.Inactive,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.Inactive,i.ClearQueryWithBlur,r.Inactive,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.Inactive,i.ClearQueryWithoutBlur,r.Inactive,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.Inactive,i.ResultReady,r.Typing,t.inactiveStateResultReadyActions),t.storedDefinition.addTransition(r.Inactive,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.Inactive,i.TextSuggestionConfirmed,r.Typing,t.textSuggestionConfirmedActions),t.storedDefinition.addTransition(r.Inactive,i.TextSuggestionSelected,r.Typing,[n.setInputTextToSelectedSuggestion]),t.storedDefinition.addTransition(r.Inactive,i.TermSelected,r.BrowseSuggestions,t.termSelectedActions),t.storedDefinition.addTransition(r.Inactive,i.NavigateOutOfBounds,r.Inactive,t.navigateOutOfBoundsEventActions),t.storedDefinition.addTransition(r.Typing,i.ClearInterpretResult,r.Typing,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.Typing,i.ClearQueryWithBlur,r.Typing,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.Typing,i.ClearQueryWithoutBlur,r.Typing,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.Typing,i.CompleteQuery,r.Typing,t.completeQueryEventActions),t.storedDefinition.addTransition(r.Typing,i.EndSession,r.Inactive,t.endSessionEventTypingActions),t.storedDefinition.addTransition(r.Typing,i.NavigateDown,r.BrowseSuggestions,t.navigateDownEventActions),t.storedDefinition.addTransition(r.Typing,i.NavigateUp,r.BrowseSuggestions,t.navigateUpEventActions),t.storedDefinition.addTransition(r.Typing,i.NavigateOutOfBounds,r.Typing,t.navigateOutOfBoundsEventActions),t.storedDefinition.addTransition(r.Typing,i.NavigateLeftRight,r.Typing,t.navigateLeftRightEventActions),t.storedDefinition.addTransition(r.Typing,i.ResultReady,r.Typing,t.queryResultReadyEventActions),t.storedDefinition.addTransition(r.Typing,i.TermSelected,r.BrowseSuggestions,t.termSelectedActions),t.storedDefinition.addTransition(r.Typing,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.Typing,i.TextSuggestionConfirmed,r.TermSelection,t.textSuggestionConfirmedActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ClearInterpretResult,r.Typing,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ClearQueryWithBlur,r.Typing,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ClearQueryWithoutBlur,r.Typing,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ConfirmQuery,r.TermSelection,t.confirmQueryEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.EndSession,r.Inactive,t.endSessionBrowseSuggestionsEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateDown,r.BrowseSuggestions,t.selectNextActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateOutOfBounds,r.Typing,t.navigateOutOfBoundsEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateUp,r.BrowseSuggestions,t.selectPreviousActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateLeftRight,r.Typing,t.navigateLeftRightEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TermSelected,r.BrowseSuggestions,t.termSelectedActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TextSuggestionConfirmed,r.TermSelection,t.textSuggestionConfirmedActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TextSuggestionSelected,r.BrowseSuggestions,[n.setInputTextToSelectedSuggestion]),t.storedDefinition.addTransition(r.TermSelection,i.ClearInterpretResult,r.Typing,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.TermSelection,i.ClearQueryWithBlur,r.Typing,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.TermSelection,i.ClearQueryWithoutBlur,r.Typing,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.TermSelection,i.EndSession,r.Inactive,t.endSessionBrowseSuggestionsEventActions),t.storedDefinition.addTransition(r.TermSelection,i.NavigateDown,r.BrowseSuggestions,t.navigateDownEventActions),t.storedDefinition.addTransition(r.TermSelection,i.NavigateUp,r.BrowseSuggestions,t.navigateUpEventActions),t.storedDefinition.addTransition(r.TermSelection,i.NavigateOutOfBounds,r.Typing,t.navigateOutOfBoundsEventActions),t.storedDefinition.addTransition(r.TermSelection,i.ResultReady,r.Typing,t.termSelectionQueryResultReadyEventActions),t.storedDefinition.addTransition(r.TermSelection,i.TermSelected,r.BrowseSuggestions,t.termSelectedActions),t.storedDefinition.addTransition(r.TermSelection,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.TermSelection,i.TextSuggestionSelected,r.Typing,[n.setInputTextToSelectedSuggestion]),t.storedDefinition.addTransition(r.TermSelection,i.TextSuggestionConfirmed,r.Typing,t.textSuggestionConfirmedActions)},t})();o.storedDefinition=null,o.beginSessionActions=[n.displaySuggestionsForEmptyQuery,n.sendInterpretProbe],o.clearInterpretResultActions=[n.clearInterpretResult],o.clearQueryWithoutBlurEventActions=[n.textInput_Clear,n.suggestionList_Clear,n.clearInterpretResult],o.clearQueryWithBlurEventActions=[n.textInput_Blur].concat(o.clearQueryWithoutBlurEventActions),o.completeQueryEventActions=[n.textInput_CompleteInput,n.interpret],o.inactiveStateResultReadyActions=[n.updateResult],o.textChangedEventActions=[n.clearUserInputBuffer,n.interpret],o.selectPreviousActions=[n.suggestionList_SelectPrevious],o.selectNextActions=[n.suggestionList_SelectNext],o.navigateLeftRightEventActions=[n.findTerm],o.navigateUpEventActions=[n.storeUserInput].concat(o.selectPreviousActions),o.navigateDownEventActions=[n.findTerm,n.startNavigate],o.textSuggestionConfirmedActions=[n.setInputTextToSelectedSuggestion].concat(o.textChangedEventActions),o.endSessionEventActions=[],o.endSessionBrowseSuggestionsEventActions=[n.restoreUserInput].concat(o.endSessionEventActions),o.endSessionEventTypingActions=[n.hideMenus].concat(o.endSessionEventActions),o.queryResultReadyEventActions=[n.displayQueryResult],o.termSelectionQueryResultReadyEventActions=o.queryResultReadyEventActions.concat(n.textInput_UpdateTermSelection),o.confirmQueryEventActions=o.textChangedEventActions,o.navigateOutOfBoundsEventActions=[n.suggestionList_ClearSelection,n.restoreUserInput,n.hideMenus],o.termSelectedActions=[],t.QnaInputStateMachine=o})(n=t.qna||(t.qna={}))})(t=e.controllers||(e.controllers={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i;!(function(n){function i(e){return new s(e)}var r=e.common.helpers.ModelConverterHelper,o=(function(){function e(e,r){var o=this;this.scope=e,this.services=r,e.infoNavControlContainer=i(r.promiseFactory),e.sharedViewModel={getAdditionalODataFilter:e.getAdditionalODataFilter,interpretListener:e.interpretListener,interpretResponse:null,models:this.filterModelsFromScope(e.models),showLoadingPlaceholder:!1,showLoadingSpinner:!1,showPinButton:!1,showQnaFeedback:!1,stateMachine:t.stateMachine.createStateMachine(n.QuestionBoxStateMachine.definition,n.QuestionBoxControlState.Inactive),storedUserInput:null,usageReportingEnabled:e.usageReportingEnabled,userInput:""};var s=e.output;s.utterance="",s.showQnaFeedback=!1,s.interpretUtterance=function(e){return o.updateUtterance(e,!0)},s.updateUtteranceWithoutInterpret=function(e){return o.updateUtterance(e,!1)},s.clearQuestionBox=function(){return o.clearQuestionBox()},s.showUserFeedbackDialog=function(){return o.showUserFeedbackDialog()};var a=[e.$watch("getAdditionalODataFilter",(function(t){return e.sharedViewModel.getAdditionalODataFilter=t})),e.$watch("interpretListener",(function(t){return e.sharedViewModel.interpretListener=t})),e.$watch("models",(function(t){return e.sharedViewModel.models=o.filterModelsFromScope(t)})),e.$watch("usageReportingEnabled",(function(t){return e.sharedViewModel.usageReportingEnabled=t})),e.$watch("sharedViewModel.showQnaFeedback",(function(t){return e.output.showQnaFeedback=t})),e.$watch("sharedViewModel.storedUserInput",(function(){return o.setOutputUtterance()})),e.$watch("sharedViewModel.userInput",(function(){return o.setOutputUtterance()}))];this.scope.$on("$destroy",(function(){for(var e=0,t=a;e<t.length;e++){var n=t[e];n()}}))}return e.createOptions=function(){return{additionalServices:["interpretUsageListener","localizationService","modalDialogService","promiseFactory","featureSwitchService"]}},e.prototype.filterModelsFromScope=function(e){var t=this.services.featureSwitchService.featureSwitches;return _.filter(e,(function(e){return e&&r.getIsQnaSupported(e,t)}))},e.prototype.setOutputUtterance=function(){var e=this.scope.sharedViewModel,t=this.scope.output;null!=e.storedUserInput?t.utterance=e.storedUserInput:t.utterance=e.userInput},e.prototype.updateUtterance=function(e,t){var i=this;this.scope.infoNavControlContainer.getTextInputControl().then((function(r){r.setInputText(e,!0),r.focus(),t&&i.scope.sharedViewModel.stateMachine.enqueueTransition(n.QuestionBoxControlTransitionId.TextChanged)}))},e.prototype.clearQuestionBox=function(){this.scope.sharedViewModel.stateMachine.enqueueTransition(n.QuestionBoxControlTransitionId.ClearQueryWithBlur)},e.prototype.showUserFeedbackDialog=function(){var e=this,t=this.services.localizationService,n=this.services.rootScope.$new(),i=[new InJs.ModalDialogAction(t.get("ModalDialog_Send"),function(t,i){n.closeDialog(),e.scope.sharedViewModel.usageReportingEnabled&&null!=n.feedback.selected&&e.services.interpretUsageListener.setFeedbackForLastUtterance(n.feedback.selected)},null,null,(!0)),new InJs.ModalDialogAction(t.get("ModalDialog_Cancel"),function(e,t){n.closeDialog()})],r={dialogName:t.get("UtteranceFeedbackDialogTitle"),isDismissable:!0,scope:n,template:"<user-feedback-dialog></user-feedback-dialog>",dialogActions:i};this.services.modalDialogService.showLegacyWebModalDialog(r)},e})();n.QuestionBoxContainerController=o,n.createInfoNavControlContainer=i;var s=(function(){function e(e){this._promiseFactory=e}return e.prototype.getTextInputControl=function(){return this._textInputControlDeferred||(this._textInputControlDeferred=this._promiseFactory.defer(),this._textInputControl&&this._textInputControlDeferred.resolve(this._textInputControl)),this._textInputControlDeferred.promise},e.prototype.setTextInputControl=function(e){this._textInputControl=e,this._textInputControlDeferred&&this._textInputControlDeferred.resolve(e)},e.prototype.getSuggestionListControl=function(){return this._suggestionListControlDeferred||(this._suggestionListControlDeferred=this._promiseFactory.defer(),this._suggestionListControl&&this._suggestionListControlDeferred.resolve(this._suggestionListControl)),this._suggestionListControlDeferred.promise},e.prototype.setSuggestionListControl=function(e){this._suggestionListControl=e,this._suggestionListControlDeferred&&this._suggestionListControlDeferred.resolve(e)},e})()})(i=n.qna||(n.qna={}))})(n=t.controllers||(t.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i;!(function(n){var i=e.infonav.contracts,r=3,o=4,s=2,a=3e3,u=(function(){function u(e,t){var n=this;this.latestProbeRequestId=0,this.outstandingInterpretRequests=[],this.scope=e,this.services=t,this.answeredQuestionEventLogger=t.answeredQuestionEventLoggerFactory.createAnsweredQuestionEventLogger(a),e.sharedViewModel.showLoadingPlaceholder=!1,e.infoNavControlContainer.getSuggestionListControl().then((function(t){e.infoNavControlContainer.getTextInputControl().then((function(e){n.suggestionListControl=t,n.textInputControl=e,n.registerStateMachineActions()}))})),this.sendInterpretProbeWithLoadingMessage(),e.$watch("sharedViewModel.models",(function(e,t){var i=_.map(e,(function(e){return e.id})),r=_.map(t,(function(e){return e.id})),o=_.difference(i,r);_.isEmpty(o)||n.sendInterpretProbeWithLoadingMessage()})),e.$watch("sharedViewModel.interpretResponse",(function(e){e&&e!==n.interpretResponse&&n.handleNewInterpretResponse(e,null)}))}return u.createOptions=function(){return{additionalServices:["answeredQuestionEventLoggerFactory","conceptualSchemaProxy","contentProviderHttpService","interpretService","interpretUsageListener","promiseFactory","telemetryService"]}},Object.defineProperty(u.prototype,"contentProviders",{get:function(){return this.services.contentProviderHttpService.getBuiltInContentProviders()},enumerable:!0,configurable:!0}),u.prototype.sendInterpretProbeWithLoadingMessage=function(){var t=this,n=this.scope.sharedViewModel;if(!_.isEmpty(n.models)){this.latestProbeRequestId++;var i=this.latestProbeRequestId;n.showLoadingPlaceholder=!0;var r=this.services.telemetryService.startEvent(e.telemetry.QnAQuestionBoxLoadingMessage),o=this.sendInterpretProbe(r.event).then((function(){return r.resolve()}),(function(){return r.reject()}));o.finally((function(){i===t.latestProbeRequestId&&(n.showLoadingPlaceholder=!1)}))}},u.prototype.sendInterpretProbe=function(e){var t=this,n=this.scope.sharedViewModel,i=this.services.interpretService.probe(n.models||[],e),r=this.services.promiseFactory.defer();return i.then((function(){u.preloadConceptualSchemas(n.models||[],t.services.conceptualSchemaProxy),r.resolve({})}),(function(){r.reject()})),r.promise},u.prototype.sendInterpretForCurrentInput=function(){var e=this,n=this.scope,r=n.sharedViewModel;r.showLoadingSpinner=!0,r.interpretListener&&r.interpretListener.onInterpretIssued();var o=this.answeredQuestionEventLogger.startAnsweredQuestionEvent(),a={},u=r.userInput,c=null;r.getAdditionalODataFilter&&(c=r.getAdditionalODataFilter());var l=this.services.promiseFactory.defer();this.outstandingInterpretRequests.push(l),this.enforceMaxConcurrentRequests();var p;if(!u||u.trim().length<s){var d=this.services.promiseFactory.defer();this.services.interpretService.probe(r.models).then((function(){return d.reject()}),(function(){return d.reject()})),p=d.promise}else p=this.services.interpretService.interpret(u,i.InterpretRequestOptions.QueryMetadata|i.InterpretRequestOptions.VisualConfiguration|i.InterpretRequestOptions.Data|i.InterpretRequestOptions.SupportPodQueries,r.models,c,a,l.promise),p.finally((function(){return o.resolve(a)}));p.then((function(n){if(!e.shouldIgnoreResponse(n,l,u)){if(e.handleNewInterpretResponse(n,l),r.interpretListener)if(!n||n.isEmpty(!0)||n.result.isEmpty(!0))r.interpretListener.onInterpretError(n?n.utterance:null,e.hasOutstandingRequests());else{var i=t.util.InterpretResultUtility.parseInterpret(n.result);i?r.interpretListener.onInterpretSuccess(n,i,c,!0):r.interpretListener.onInterpretError(n?n.utterance:null,e.hasOutstandingRequests())}r.usageReportingEnabled&&e.services.interpretUsageListener.onInterpretSuccess(n,e.getModelContentProviderType(n))}}),(function(){e.shouldIgnoreResponse(null,l,u)||(e.updateStateGivenResponse(null,l),r.interpretListener&&r.interpretListener.onInterpretError(u,e.hasOutstandingRequests()))})),r.usageReportingEnabled&&this.services.interpretUsageListener.onInterpretIssued()},u.prototype.handleNewInterpretResponse=function(e,t){this.updateStateGivenResponse(e,t),this.scope.sharedViewModel.stateMachine.enqueueTransition(n.QuestionBoxControlTransitionId.ResultReady)},u.prototype.shouldIgnoreResponse=function(e,t,n){if(!_.contains(this.outstandingInterpretRequests,t))return!0;var i=this.scope.sharedViewModel.userInput,r=n;e&&e.result&&e.result.completedUtterance&&!_.isEmpty(e.result.completedUtterance.Text)&&(r=e.result.completedUtterance.Text);var o=Math.min(i.length,r.length);return i.substr(0,o)!==r.substr(0,o)},u.prototype.updateStateGivenResponse=function(e,t){this.updateOutstandingRequestsGivenCompletedRequest(t);var n=this.scope.sharedViewModel;n.interpretResponse=this.interpretResponse=e,n.showLoadingSpinner=this.hasOutstandingRequests(),n.showQnaFeedback=n.usageReportingEnabled},u.prototype.hasOutstandingRequests=function(){return!_.isEmpty(this.outstandingInterpretRequests)},u.prototype.enforceMaxConcurrentRequests=function(){if(this.outstandingInterpretRequests.length>o)for(var e=this.outstandingInterpretRequests.splice(0,this.outstandingInterpretRequests.length-o),t=0,n=e;t<n.length;t++){var i=n[t];i.resolve({})}},u.prototype.updateOutstandingRequestsGivenCompletedRequest=function(e){var t;t=e?_.findIndex(this.outstandingInterpretRequests,(function(t){return t===e})):this.outstandingInterpretRequests.length;for(var n=0;n<t;n++)this.outstandingInterpretRequests[n].resolve({});this.outstandingInterpretRequests.splice(0,t+1)},u.prototype.storeInput=function(){this.scope.sharedViewModel.storedUserInput=this.scope.sharedViewModel.userInput||"",this.textInputControl.hideAutoCompletion()},u.prototype.restoreInput=function(){null!=this.scope.sharedViewModel.storedUserInput&&(this.textInputControl.setInputText(this.scope.sharedViewModel.storedUserInput,!1),this.textInputControl.showAutoCompletion(),this.scope.sharedViewModel.storedUserInput=null),this.interpretResponse&&this.textInputControl.applyNLResult(this.interpretResponse.result)},u.prototype.clearStoredInput=function(){this.scope.sharedViewModel.storedUserInput=null},u.prototype.setInputTextToSelectedSuggestion=function(){this.services.telemetryService.logEvent(e.telemetry.QnADropdownItemSelected,_.isEmpty(this.scope.sharedViewModel.userInput)),this.textInputControl.setInputText(this.suggestionListControl.currentSelectionText,!1)},u.prototype.clearInterpret=function(){var e=this.scope.sharedViewModel;e.interpretResponse=this.interpretResponse=null,e.showQnaFeedback=!1,e.showLoadingSpinner=!1;var t=this.outstandingInterpretRequests;this.outstandingInterpretRequests=[];for(var n=0,i=t;n<i.length;n++){var r=i[n];r.resolve({})}var o=e.interpretListener;o&&o.onInterpretResultCleared()},u.prototype.selectTermInternal=function(){var e=this.textInputControl.getSelection(),t=this.interpretResponse;t&&!e.isUserRangeSelection&&t.result.hasSuggestionsForTermSelection(e)?(this.textInputControl.highlightSelectedTerm(),this.displayQueryResultInternal(!0,!0,e)):this.displayQueryResultInternal(!0,!0)},u.prototype.displayQueryResultInternal=function(e,t,n){var i=this.interpretResponse;i?(this.suggestionListControl.displaySuggestions(this.scope.sharedViewModel.userInput,i,n,!t),this.textInputControl.applyNLResult(i.result,e)):this.suggestionListControl.displaySuggestions(this.scope.sharedViewModel.userInput)},u.prototype.displaySuggestionsForEmptyQuery=function(){jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(this.scope.sharedViewModel.userInput)&&this.suggestionListControl.displaySuggestions(null)},u.prototype.getModelContentProviderType=function(t){if(t){var n=t.result;if(n){var i=_.find(this.scope.sharedViewModel.models,(function(e){return e.vsName===n.virtualServerName&&e.dbName===n.databaseName}));if(i&&null!=i.contentProviderId)return e.common.findContentProviderName(this.contentProviders,i.contentProviderId)}}return"Unknown"},u.prototype.registerStateMachineActions=function(){var e=this,t=this.scope.sharedViewModel.stateMachine;t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.interpret,(function(){return e.sendInterpretForCurrentInput()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.storeUserInput,(function(){return e.storeInput()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.restoreUserInput,(function(){return e.restoreInput()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.clearUserInputBuffer,(function(){return e.clearStoredInput()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.setInputTextToSelectedSuggestion,(function(){return e.setInputTextToSelectedSuggestion()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.clearInterpretResult,(function(){return e.clearInterpret()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.displayQueryResult,(function(){return e.displayQueryResultInternal(!0,!0)})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.updateResult,(function(){return e.displayQueryResultInternal(!1,!1)})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.displaySuggestionsForEmptyQuery,(function(){return e.displaySuggestionsForEmptyQuery()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.selectTerm,(function(){return e.selectTermInternal()})),t.addTransitionActionHandler(n.QuestionBoxControlTransitionAction.sendInterpretProbe,(function(){return e.sendInterpretProbe(null)}))},u.preloadConceptualSchemas=function(e,t){for(var n=Math.min(e.length,r),i=0,o=_.take(e,n);i<o.length;i++){var s=o[i];t.get(u.createDataSourceArray(s))}},u.createDataSourceArray=function(t){return e.explore.contracts.createDataSourceArray([{type:"dsr",id:t.id,packageId:t.packageId,name:void 0,dsr:{schemaName:void 0,vsName:t.vsName,dbName:t.dbName,modelId:t.id}}])},u})();n.QuestionBoxController=u})(i=n.qna||(n.qna={}))})(n=t.controllers||(t.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(e){e[e.clearInterpretResult=0]="clearInterpretResult",e[e.clearUserInputBuffer=1]="clearUserInputBuffer",e[e.displayQueryResult=2]="displayQueryResult",e[e.displaySuggestionsForEmptyQuery=3]="displaySuggestionsForEmptyQuery",e[e.interpret=4]="interpret",e[e.restoreUserInput=5]="restoreUserInput",e[e.selectTerm=6]="selectTerm",e[e.sendInterpretProbe=7]="sendInterpretProbe",e[e.setInputTextToSelectedSuggestion=8]="setInputTextToSelectedSuggestion",e[e.storeUserInput=9]="storeUserInput",e[e.suggestionList_Clear=10]="suggestionList_Clear",e[e.suggestionList_ClearPreserveRestatement=11]="suggestionList_ClearPreserveRestatement",e[e.suggestionList_ClearSelection=12]="suggestionList_ClearSelection",e[e.suggestionList_SelectNext=13]="suggestionList_SelectNext",e[e.suggestionList_SelectPrevious=14]="suggestionList_SelectPrevious",e[e.textInput_Blur=15]="textInput_Blur",e[e.textInput_Clear=16]="textInput_Clear",e[e.textInput_ClearTermHighlights=17]="textInput_ClearTermHighlights",e[e.textInput_CompleteInput=18]="textInput_CompleteInput",e[e.textInput_ShowAutoCompletion=19]="textInput_ShowAutoCompletion",e[e.textInput_UpdateTermSelection=20]="textInput_UpdateTermSelection",e[e.updateResult=21]="updateResult"})(n=t.QuestionBoxControlTransitionAction||(t.QuestionBoxControlTransitionAction={}));var i;!(function(e){e[e.BeginSession=0]="BeginSession",e[e.EndSession=1]="EndSession",e[e.ClearInterpretResult=2]="ClearInterpretResult",e[e.ClearQueryWithBlur=3]="ClearQueryWithBlur",e[e.ClearQueryWithoutBlur=4]="ClearQueryWithoutBlur",e[e.ConfirmQuery=5]="ConfirmQuery",e[e.TextChanged=6]="TextChanged",e[e.CompleteQuery=7]="CompleteQuery",e[e.NavigateUp=8]="NavigateUp",e[e.NavigateDown=9]="NavigateDown",e[e.NavigateOutOfBounds=10]="NavigateOutOfBounds",e[e.TextSuggestionSelected=11]="TextSuggestionSelected",e[e.TextSuggestionConfirmed=12]="TextSuggestionConfirmed",e[e.TermSelected=13]="TermSelected",e[e.ResultReady=14]="ResultReady"})(i=t.QuestionBoxControlTransitionId||(t.QuestionBoxControlTransitionId={}));var r;!(function(e){e[e.Inactive=0]="Inactive",e[e.Typing=1]="Typing",e[e.BrowseSuggestions=2]="BrowseSuggestions",e[e.TermSelection=3]="TermSelection"})(r=t.QuestionBoxControlState||(t.QuestionBoxControlState={}));var o=(function(){function t(){}return Object.defineProperty(t,"definition",{get:function(){return t.storedDefinition||t.initializeDefinition(),t.storedDefinition},enumerable:!0,configurable:!0}),t.initializeDefinition=function(){t.storedDefinition=new e.stateMachine.StateMachineDefinition,t.storedDefinition.addTransition(r.Inactive,i.BeginSession,r.Typing,t.beginSessionActions),t.storedDefinition.addTransition(r.Inactive,i.ClearInterpretResult,r.Inactive,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.Inactive,i.ClearQueryWithBlur,r.Inactive,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.Inactive,i.ClearQueryWithoutBlur,r.Inactive,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.Inactive,i.ResultReady,r.Inactive,t.inactiveStateResultReadyActions),t.storedDefinition.addTransition(r.Inactive,i.TextChanged,r.Inactive,t.textChangedEventActions),t.storedDefinition.addTransition(r.Inactive,i.TextSuggestionConfirmed,r.Typing,t.textSuggestionConfirmedActions),t.storedDefinition.addTransition(r.Inactive,i.TextSuggestionSelected,r.Typing,[n.setInputTextToSelectedSuggestion]),t.storedDefinition.addTransition(r.Typing,i.ClearInterpretResult,r.Typing,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.Typing,i.ClearQueryWithBlur,r.Typing,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.Typing,i.ClearQueryWithoutBlur,r.Typing,t.clearQueryWithoutBlurEventActions),
t.storedDefinition.addTransition(r.Typing,i.CompleteQuery,r.Typing,t.completeQueryEventActions),t.storedDefinition.addTransition(r.Typing,i.EndSession,r.Inactive,t.endSessionEventTypingActions),t.storedDefinition.addTransition(r.Typing,i.NavigateDown,r.BrowseSuggestions,t.navigateDownEventActions),t.storedDefinition.addTransition(r.Typing,i.NavigateUp,r.BrowseSuggestions,t.navigateUpEventActions),t.storedDefinition.addTransition(r.Typing,i.ResultReady,r.Typing,t.queryResultReadyEventActions),t.storedDefinition.addTransition(r.Typing,i.TermSelected,r.TermSelection,t.termSelectedActions),t.storedDefinition.addTransition(r.Typing,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.Typing,i.TextSuggestionConfirmed,r.TermSelection,t.textSuggestionConfirmedActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ClearInterpretResult,r.Typing,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ClearQueryWithBlur,r.Typing,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ClearQueryWithoutBlur,r.Typing,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.ConfirmQuery,r.TermSelection,t.confirmQueryEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.EndSession,r.Inactive,t.endSessionBrowseSuggestionsEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateDown,r.BrowseSuggestions,t.selectNextActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateOutOfBounds,r.Typing,t.navigateOutOfBoundsEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.NavigateUp,r.BrowseSuggestions,t.selectPreviousActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TermSelected,r.Typing,t.termSelectedActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TextSuggestionConfirmed,r.TermSelection,t.textSuggestionConfirmedActions),t.storedDefinition.addTransition(r.BrowseSuggestions,i.TextSuggestionSelected,r.BrowseSuggestions,[n.setInputTextToSelectedSuggestion]),t.storedDefinition.addTransition(r.TermSelection,i.ClearInterpretResult,r.Typing,t.clearInterpretResultActions),t.storedDefinition.addTransition(r.TermSelection,i.ClearQueryWithBlur,r.Typing,t.clearQueryWithBlurEventActions),t.storedDefinition.addTransition(r.TermSelection,i.ClearQueryWithoutBlur,r.Typing,t.clearQueryWithoutBlurEventActions),t.storedDefinition.addTransition(r.TermSelection,i.EndSession,r.Inactive,t.endSessionBrowseSuggestionsEventActions),t.storedDefinition.addTransition(r.TermSelection,i.NavigateDown,r.BrowseSuggestions,t.navigateDownEventActions),t.storedDefinition.addTransition(r.TermSelection,i.NavigateUp,r.BrowseSuggestions,t.navigateUpEventActions),t.storedDefinition.addTransition(r.TermSelection,i.ResultReady,r.Typing,t.termSelectionQueryResultReadyEventActions),t.storedDefinition.addTransition(r.TermSelection,i.TermSelected,r.Typing,t.termSelectedActions),t.storedDefinition.addTransition(r.TermSelection,i.TextChanged,r.Typing,t.textChangedEventActions),t.storedDefinition.addTransition(r.TermSelection,i.TextSuggestionSelected,r.Typing,[n.setInputTextToSelectedSuggestion]),t.storedDefinition.addTransition(r.TermSelection,i.TextSuggestionConfirmed,r.Typing,t.textSuggestionConfirmedActions)},t})();o.storedDefinition=null,o.beginSessionActions=[n.displaySuggestionsForEmptyQuery,n.sendInterpretProbe],o.clearInterpretResultActions=[n.clearInterpretResult],o.clearQueryWithoutBlurEventActions=[n.textInput_Clear,n.suggestionList_Clear,n.clearInterpretResult],o.clearQueryWithBlurEventActions=[n.textInput_Blur].concat(o.clearQueryWithoutBlurEventActions),o.completeQueryEventActions=[n.textInput_CompleteInput,n.interpret],o.inactiveStateResultReadyActions=[n.updateResult],o.textChangedEventActions=[n.clearUserInputBuffer,n.interpret,n.textInput_ClearTermHighlights],o.selectPreviousActions=[n.textInput_ClearTermHighlights,n.suggestionList_SelectPrevious],o.selectNextActions=[n.textInput_ClearTermHighlights,n.suggestionList_SelectNext],o.navigateUpEventActions=[n.storeUserInput].concat(o.selectPreviousActions),o.navigateDownEventActions=[n.storeUserInput].concat(o.selectNextActions),o.textSuggestionConfirmedActions=[n.setInputTextToSelectedSuggestion].concat(o.textChangedEventActions),o.endSessionEventActions=[n.textInput_ClearTermHighlights,n.suggestionList_ClearPreserveRestatement,n.textInput_ShowAutoCompletion],o.endSessionBrowseSuggestionsEventActions=[n.restoreUserInput].concat(o.endSessionEventActions),o.endSessionEventTypingActions=o.endSessionEventActions,o.queryResultReadyEventActions=[n.displayQueryResult],o.termSelectionQueryResultReadyEventActions=o.queryResultReadyEventActions.concat(n.textInput_UpdateTermSelection),o.confirmQueryEventActions=o.textChangedEventActions,o.navigateOutOfBoundsEventActions=[n.suggestionList_ClearSelection,n.restoreUserInput],o.termSelectedActions=[n.textInput_ClearTermHighlights,n.selectTerm],t.QuestionBoxStateMachine=o})(n=t.qna||(t.qna={}))})(t=e.controllers||(e.controllers={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var n;!(function(t){var n=50,i=7,r=(function(){function r(e,t){var i=this;this.scope=e,this.services=t;var r=e.viewModel={restatement:null,uiSuggestionItems:[],maxSuggestions:n,showSuggestionsHost:!1,selectedSuggestionIndex:-1};e.handleSuggestionMouseDown=function(e,t){return i.handleSuggestionMouseDown(e,t)},e.handleSuggestionMouseEnter=function(e){r.selectedSuggestionIndex=e},e.infoNavControlContainer.setSuggestionListControl(this),this.registerStateMachineActions()}return r.createOptions=function(){return{additionalServices:["sampleQuestionsService"]}},r.prototype.clear=function(e){var t=this.scope,n=t.viewModel;n.selectedSuggestionIndex=-1,n.uiSuggestionItems=[],e?n.showSuggestionsHost=!!n.restatement:(n.restatement=null,n.showSuggestionsHost=!1)},r.prototype.clearSelection=function(){this.scope.viewModel.selectedSuggestionIndex=-1},r.prototype.selectPrevious=function(){var e=this.scope,t=e.viewModel;t.selectedSuggestionIndex===-1?this.attemptSelection(t.uiSuggestionItems.length-1):this.attemptSelection(t.selectedSuggestionIndex-1)},r.prototype.selectNext=function(){var e=this.scope;this.attemptSelection(e.viewModel.selectedSuggestionIndex+1)},Object.defineProperty(r.prototype,"currentSelectionText",{get:function(){var e=this.scope.viewModel,t=e.selectedSuggestionIndex,n=e.uiSuggestionItems;return t>=0&&t<n.length?n[t].text:null},enumerable:!0,configurable:!0}),r.prototype.displaySuggestions=function(e,t,n,i){var o=this.scope,s=o.viewModel,a=t?t.result:null;if(a&&a.restatement&&!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(a.restatement)?s.restatement=a.restatement:s.restatement=null,s.selectedSuggestionIndex=-1,i)return s.uiSuggestionItems=[],void(s.showSuggestionsHost=!!s.restatement);if(_.isEmpty(e)){s.showSuggestionsHost=!1;for(var u=s.uiSuggestionItems=[],c=this.services.sampleQuestionsService.getSampleQuestions(o.sharedViewModel.models),l=0,p=c;l<p.length;l++){var d=p[l];d.then((function(e){s.uiSuggestionItems===u&&(r.addSampleQuestionsToSuggestions(e,u),s.showSuggestionsHost=!_.isEmpty(s.uiSuggestionItems))}))}}else s.uiSuggestionItems=this.generateSuggestionsForUtterance(e,a,n),s.showSuggestionsHost=!_.isEmpty(s.uiSuggestionItems)||!_.isEmpty(s.restatement);o.scrollToTop&&this.services.timeout((function(){return o.scrollToTop()}),0,!1)},r.prototype.handleSuggestionMouseDown=function(e,n){n.preventDefault(),this.attemptSelection(e),this.doStateMachineTransition(t.QuestionBoxControlTransitionId.TextSuggestionConfirmed)},r.prototype.attemptSelection=function(e){var n=this.scope,i=n.viewModel;e>=0&&e<i.uiSuggestionItems.length?(i.selectedSuggestionIndex=e,this.doStateMachineTransition(t.QuestionBoxControlTransitionId.TextSuggestionSelected),n.scrollSelectionIntoView&&this.services.timeout((function(){return n.scrollSelectionIntoView()}),0,!1)):(i.selectedSuggestionIndex=-1,this.doStateMachineTransition(t.QuestionBoxControlTransitionId.NavigateOutOfBounds),n.scrollToTop&&this.services.timeout((function(){return n.scrollToTop()}),0,!1))},r.prototype.doStateMachineTransition=function(e){this.scope.sharedViewModel.stateMachine.enqueueTransition(e)},r.prototype.generateSuggestionsForUtterance=function(e,t,n){return t?n?t.getTermSuggestions(n):t.getCompletionSuggestions():[]},r.addSampleQuestionsToSuggestions=function(t,n){for(var r=function(t){var i=t.question.trim().toUpperCase(),r=_.any(n,(function(e){return e.text.trim().toUpperCase()===i}));r||n.push(new e.models.UISuggestionItem([{text:t.question,emphasize:!1}]))},o=0;n.length<i&&o<t.length;)r(t[o]),o++},r.prototype.registerStateMachineActions=function(){var e=this,n=this.scope.sharedViewModel.stateMachine;n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.suggestionList_Clear,(function(){return e.clear(!1)})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.suggestionList_ClearPreserveRestatement,(function(){return e.clear(!0)})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.suggestionList_ClearSelection,(function(){return e.clearSelection()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.suggestionList_SelectNext,(function(){return e.selectNext()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.suggestionList_SelectPrevious,(function(){return e.selectPrevious()}))},r})();t.SuggestionListController=r})(n=t.qna||(t.qna={}))})(t=e.controllers||(e.controllers={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(t){var n;!(function(t){var n=e.infonav.contracts,i=120,r=(function(){function e(e,n){var r=this;this.termConverterService=e,this.inputController=n,this.terms=[],this.handleResize=_.throttle(this.handleLayout,i),this.stateMachine=n.stateMachine,this.utteranceElem=n.utteranceElement,this.currentTerm=null,this.userSpanBindings=[],this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.setInputTextToSelectedSuggestion,(function(){return r.setInputTextToSelectedSuggestion()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.suggestionList_SelectNext,(function(){return r.navigateDown()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.suggestionList_SelectPrevious,(function(){return r.navigateUp()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.suggestionList_ClearSelection,(function(){return r.hideMenus()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.textInput_ClearTermHighlights,(function(){return r.hideMenus()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.hideMenus,(function(){r.hideMenus()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.startNavigate,(function(){r.startNavigate()})),this.stateMachine.addTransitionActionHandler(t.QnaInputTransitionAction.findTerm,(function(){r.findCurrentTerm(r.inputController.contentElement.selectionStart,r.inputController.contentElement.selectionEnd)}))}return e.prototype.hasCurrentTerm=function(){return null!=this.currentTerm},Object.defineProperty(e.prototype,"hasOpenMenu",{get:function(){return this.currentTerm&&this.currentTerm.menuOpened},enumerable:!0,configurable:!0}),e.prototype.getUserSpanBindings=function(){return this.userSpanBindings},Object.defineProperty(e.prototype,"utteranceElement",{get:function(){return this.utteranceElem},enumerable:!0,configurable:!0}),e.prototype.hideMenus=function(){this.currentTerm&&this.currentTerm.closeMenu()},e.prototype.menuClosed=function(){this.currentTerm=null,this.inputController.captureElement.style.display="none"},e.prototype.updateUtterance=function(e,t,n){if(void 0===n&&(n=!1),!_.isEmpty(e)){if(_.isEmpty(t))return void(this.utteranceElem.innerHTML="");if(this.terms){for(var i=0,r=Math.min(e.length,t.length);i<r&&e.charAt(i)===t.charAt(i);)i++;i--;for(var o=e.length,s=t.length;o>i&&s>i&&e.charAt(o)===t.charAt(s);)o--,s--;o++,s++,n||this.updateUserBindings(i,o,s);for(var a=0,u=this.terms;a<u.length;a++){var c=u[a];c.span.StartIndex+c.text.length>=i&&(c.span.StartIndex<i-1?c.header.textContent=c.header.textContent.substr(0,i-c.span.StartIndex+1):c.element.parentElement===this.utteranceElem&&this.utteranceElem.removeChild(c.element))}}}},e.prototype.updateUserBindings=function(e,t,n){var i=t-n;_.remove(this.userSpanBindings,(function(n){var r=n.StartIndex,o=n.StartIndex+n.Length-1;return n.StartIndex>=t&&(n.StartIndex-=i),r>e&&o<t||r<e&&o>e||r<t&&o>t}))},e.prototype.processInterpret=function(e,t){void 0===t&&(t=!0),this.userSpanBindings=[];var i=this.termConverterService.convert(e),r=i.terms,o=this.inputController.utterance();if(o===e.utterance){var s=this.inputController.contentElement,a=s.selectionStart,u=s.selectionEnd;if(s.value=i.utterance,this.inputController.selectCharacters(a,u),r.length>0){for(var c=this.utteranceElem,l=_.indexBy(this.terms,(function(e){return e.span.StartIndex})),p=[],d=null,h=r.length-1;h>=0;h--){var v=r[h];v.manager=this,v.span.Source===n.SpanSource.User&&this.userSpanBindings.push(v.span);var g=l[v.span.StartIndex];g&&v.reuseElement(g)?p.push(g):c.insertBefore(v.element,d),d=v.element}for(var f=0,m=this.terms;f<m.length;f++){var v=m[f];_.contains(p,v)||v.element.parentElement!==this.utteranceElem||c.removeChild(v.element)}this.handleLayout(),i.hasCompletions&&t&&this.selectTerm(r[r.length-1],!0)}return this.terms=r,!0}return!1},e.prototype.handleLayout=function(){if(this.terms)for(var e=Number.MIN_VALUE,t=0,n=this.terms;t<n.length;t++){var i=n[t],r=$(i.element),o=r.offset().top;o>e?(e=o,r.addClass("row")):r.removeClass("row")}},e.prototype.selectReplacement=function(e,t){var n=this.inputController.utterance(),i=e.span.StartIndex+e.span.Length,r=e.span.StartIndex+t.length,o=n.substring(0,e.span.StartIndex)+t+n.substring(i);i===n.length&&(o+=" ",r++);var s=this.userSpanBindings.indexOf(e.span);if(s>-1&&this.userSpanBindings.splice(s,1),!e.currentReplacement.container.Core){this.userSpanBindings.push({StartIndex:e.span.StartIndex,Length:t.length,Binding:e.currentReplacement.container});for(var a=e.span.Length-t.length,u=0,c=this.userSpanBindings;u<c.length;u++){var l=c[u];l.StartIndex>e.span.StartIndex&&(l.StartIndex-=a)}}this.inputController.utterance(o,!0),this.inputController.selectCharacters(r),this.inputController.contentElement.focus(),this.currentTerm=null},e.prototype.selectTerm=function(e,n){void 0===n&&(n=!1),this.stateMachine.enqueueTransition(t.QnaInputTransitionId.TermSelected),this.currentTerm&&this.currentTerm!==e&&this.currentTerm.closeMenu(),this.currentTerm=e,e.openMenu()?(n||this.inputController.selectCharacters(e.span.StartIndex,e.span.StartIndex+e.span.Length),this.inputController.captureElement.style.display="block"):this.currentTerm=null},e.prototype.clearTerms=function(){this.utteranceElem.innerHTML="",this.terms=[]},e.prototype.navigateUp=function(){var e=!1;this.currentTerm&&(e=this.currentTerm.selectPreviousReplacement()),e||this.stateMachine.enqueueTransition(t.QnaInputTransitionId.NavigateOutOfBounds)},e.prototype.navigateDown=function(){this.currentTerm&&this.currentTerm.selectNextReplacement()},e.prototype.startNavigate=function(){this.currentTerm?this.selectTerm(this.currentTerm):this.stateMachine.enqueueTransition(t.QnaInputTransitionId.NavigateOutOfBounds)},e.prototype.findCurrentTerm=function(e,t){var n=this.findTerm(e,t);n&&n===this.currentTerm||!this.currentTerm||this.currentTerm.closeMenu(),this.currentTerm=n},e.prototype.setInputTextToSelectedSuggestion=function(){var e=this.currentTerm;e&&e.chooseCurrentReplacement()},e.prototype.findTerm=function(e,t){for(var n=this.terms.length-1;n>=0;n--){var i=this.terms[n];if(i.hasBindings&&i.span.StartIndex<=e&&i.span.StartIndex+i.span.Length>=e)return i}},e})();t.TermManager=r})(n=t.qna||(t.qna={}))})(n=t.controllers||(t.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(t){var n;!(function(t){var n=20,i=250,r=(function(){function r(e,t){var n=this;this.terms=[],this.selection={},this.hasUncommittedText=!0,this.lastTextValue="",this.scope=e,this.services=t,e.onUserInputFocus=function(){return n.onUserInputFocus()},e.onUserInputBlur=function(){return n.onUserInputBlur()},e.onUserInputChange=function(){return n.onUserInputChange()},e.onUserInputKeyDown=function(e){return n.onUserInputKeyDown(e)},e.onUserInputKeyUp=function(e){return n.onUserInputKeyUp(e)},e.onUserInputClick=function(){return n.onUserInputClick()},e.onUserInputSelect=function(){return n.onUserInputSelect()},e.viewModel={hasFocus:!1,showAutoComplete:!0,userInput:"",placeholder:null,autoComplete:null,inputRendererTerms:[],inputRendererRemainder:null,inputRendererShowUnrecognized:!1,showInputTermSelection:!1,inputTermSelectionPosition:{}},e.infoNavControlContainer.setTextInputControl(this),this.registerStateMachineActions()}return r.createOptions=function(){return{additionalServices:["telemetryService"]}},r.prototype.getInputText=function(){return this.scope.sharedViewModel.userInput},r.prototype.setInputText=function(e,t){var n=this.scope;this.hasUncommittedText=!0,this.lastTextValue=n.sharedViewModel.userInput=e,this.renderInputText(),this.clearAutoCompletion(),t&&!_.isEmpty(e)&&this.services.timeout((function(){return n.setCursorPositionAtEnd()}),0,!1)},r.prototype.focus=function(){this.hasFocus()||this.scope.setFocusToInput()},r.prototype.blur=function(){this.hasFocus()&&this.scope.blurInput()},r.prototype.completeInput=function(){this.services.telemetryService.logEvent(e.telemetry.QnAQuestionBoxAutoComplete);var t=this.scope;this.setInputText(t.sharedViewModel.userInput+t.viewModel.autoComplete,!0)},r.prototype.clearAutoCompletion=function(){this.scope.viewModel.autoComplete=null,this.scrollLeftIfEmpty()},r.prototype.showAutoCompletion=function(){this.scope.viewModel.showAutoComplete=!0},r.prototype.hideAutoCompletion=function(){this.scope.viewModel.showAutoComplete=!1},r.prototype.clear=function(){var e=this.scope;this.lastTextValue=e.sharedViewModel.userInput="";var t=e.viewModel;t.inputRendererTerms=[],t.inputRendererRemainder=null,t.showInputTermSelection=!1,this.currentResult=null,this.terms=[],this.clearAutoCompletion()},r.prototype.updateTermSelection=function(){this.trackSelectionInternal(!0)},r.prototype.hasFocus=function(){return this.scope.viewModel.hasFocus},r.prototype.applyNLResult=function(e,t){this.currentResult!==e&&(this.currentResult=e,this.terms=e.getCompletedUtteranceAsTerms(),t&&(this.setCompletionText(),this.showAutoCompletion()),this.renderInputText(e),this.trackSelectionInternal(!1))},r.prototype.clearTermHighlights=function(){this.scope.viewModel.showInputTermSelection=!1},r.prototype.highlightSelectedTerm=function(){this.clearTermHighlights();var e=this.scope,t=e.viewModel;jsCommon.BrowserUtility.getInternetExplorerVersion()>0&&this.scope.sharedViewModel.userInput.indexOf("\t")>=0||(t.showInputTermSelection=!0,t.inputTermSelectionPosition=e.getSelectedTermPosition(this.selection.start,this.selection.end))},r.prototype.getSelection=function(){return this.selection},r.prototype.doStateMachineTransition=function(e){this.scope.sharedViewModel.stateMachine.enqueueTransition(e)},r.prototype.onUserInputFocus=function(){this.doStateMachineTransition(t.QuestionBoxControlTransitionId.BeginSession),this.scope.viewModel.hasFocus=!0},r.prototype.onUserInputBlur=function(){this.doStateMachineTransition(t.QuestionBoxControlTransitionId.EndSession),this.scope.viewModel.hasFocus=!1,this.scrollLeftIfEmpty()},r.prototype.onUserInputChange=function(){this.renderInputText(),this.setCompletionText();var e=this.scope.sharedViewModel.userInput,n=(this.lastTextValue||"").length,i=(e||"").length;if(this.lastTextValue=e,i>0){var r=Math.abs(n-i);r>1&&this.doStateMachineTransition(t.QuestionBoxControlTransitionId.ClearInterpretResult),this.doStateMachineTransition(t.QuestionBoxControlTransitionId.TextChanged)}else this.doStateMachineTransition(t.QuestionBoxControlTransitionId.ClearQueryWithoutBlur);this.hasUncommittedText=!1},r.prototype.onUserInputKeyDown=function(e){var n=e.keyCode;if(18!==n&&17!==n&&16!==n){var i=this.scope,r=i.sharedViewModel,o=i.getSelectionEnd();switch(o!==(r.userInput?r.userInput.length:0)&&this.clearAutoCompletion(),n){case 13:e.preventDefault(),this.hasUncommittedText?(this.doStateMachineTransition(t.QuestionBoxControlTransitionId.ConfirmQuery),this.hasUncommittedText=!1):this.doStateMachineTransition(t.QuestionBoxControlTransitionId.EndSession);break;case 27:this.doStateMachineTransition(t.QuestionBoxControlTransitionId.ClearQueryWithoutBlur);break;case 9:case 39:_.isEmpty(i.viewModel.autoComplete)?this.hasUncommittedText&&(this.doStateMachineTransition(t.QuestionBoxControlTransitionId.ConfirmQuery),this.hasUncommittedText=!1):(e.preventDefault(),this.doStateMachineTransition(t.QuestionBoxControlTransitionId.CompleteQuery));break;case 38:e.preventDefault(),this.doStateMachineTransition(t.QuestionBoxControlTransitionId.NavigateUp);break;case 40:e.preventDefault(),this.doStateMachineTransition(t.QuestionBoxControlTransitionId.NavigateDown)}}},r.prototype.onUserInputKeyUp=function(e){var t=e.keyCode;37!==t&&39!==t&&35!==t&&36!==t||this.trackSelection()},r.prototype.onUserInputClick=function(){this.trackSelection();var e=this.scope;_.isEmpty(e.sharedViewModel.userInput)&&e.selectInput()},r.prototype.onUserInputSelect=function(){this.trackSelection()},r.prototype.trackSelection=function(){var e=this;this.trackSelectionPromise&&(this.services.timeout.cancel(this.trackSelectionPromise),this.trackSelectionPromise=null),this.trackSelectionPromise=this.services.timeout((function(){return e.trackSelectionInternal(!0)}),n,!0)},r.prototype.trackSelectionInternal=function(e){var n=this,i=0,r=this.scope,o=r.getSelectionStart(),s=r.getSelectionEnd();if(null!==s&&null!==o){for(var a=o===s,u=[],c=0,l=this.terms.length;c<l;c++){var p=this.terms[c];p.trim().length>0&&(a&&i<=s&&o<=i+p.length?u.push(c):!a&&i<s&&o<i+p.length&&u.push(c)),i+=p.length}if(!_.isEmpty(u)){if(this.selection={start:u[0],end:u[u.length-1]},this.currentResult.suggestionItems){var d=_.filter(this.currentResult.suggestionItems,(function(e){return e.TermStartIndex<=n.selection.end&&n.selection.start<=e.TermEndIndex}));if(!_.isEmpty(d)){var h=_.filter(d,(function(e){return d[0].TermStartIndex===e.TermStartIndex&&d[0].TermEndIndex===e.TermEndIndex}));h.length===d.length&&(this.selection.start=d[0].TermStartIndex,this.selection.end=d[0].TermEndIndex)}}this.selection.text=this.terms.slice(this.selection.start,this.selection.end+1).join(""),this.selection.isUserRangeSelection=!a,this.selection.userRangeText=this.scope.sharedViewModel.userInput.substring(o,s),this.selection.isSingleTermSelection=this.selection.start===this.selection.end,e&&this.doStateMachineTransition(t.QuestionBoxControlTransitionId.TermSelected)}}},r.prototype.setCompletionText=function(){var e=this.currentResult,t=this.scope,n=t.viewModel;n.autoComplete=null;var i=t.sharedViewModel.userInput;if(e&&e.completedUtterance&&e.completedUtterance.Text.length>=i.length&&0===e.completedUtterance.Text.indexOf(i)){var r=e.completedUtterance.Text.substring(i.length);n.autoComplete=r}},r.prototype.renderInputText=function(e){var t=this.scope.viewModel;if(t.inputRendererTerms=[],t.inputRendererRemainder=null,t.inputRendererShowUnrecognized=!1,e&&e.completedUtterance){for(var n=e.getCompletedUtteranceAsTerms(),r=this.scope.sharedViewModel.userInput,o=0,s=n.length;o<s&&!_.isEmpty(r);o++){var a=n[o];0===r.indexOf(a)&&(t.inputRendererTerms.push({term:a,index:o,unrecognized:e.unrecognizedTerms&&e.unrecognizedTerms.indexOf(o)!==-1}),r=r.replace(a,""))}_.isEmpty(r)||(t.inputRendererRemainder=r),this.inputRendererShowUnrecognizedPromise&&(this.services.timeout.cancel(this.inputRendererShowUnrecognizedPromise),this.inputRendererShowUnrecognizedPromise=null),this.inputRendererShowUnrecognizedPromise=this.services.timeout((function(){return t.inputRendererShowUnrecognized=!0}),i,!0)}else t.inputRendererRemainder=this.scope.sharedViewModel.userInput},r.prototype.scrollLeftIfEmpty=function(){var e=this.scope;_.isEmpty(e.sharedViewModel.userInput)&&this.services.timeout((function(){return e.scrollInputBoxToLeft()}),0,!1)},r.prototype.registerStateMachineActions=function(){var e=this,n=this.scope.sharedViewModel.stateMachine;n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.textInput_Blur,(function(){return e.blur()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.textInput_Clear,(function(){return e.clear()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.textInput_ClearTermHighlights,(function(){return e.clearTermHighlights()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.textInput_CompleteInput,(function(){return e.completeInput()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.textInput_ShowAutoCompletion,(function(){return e.showAutoCompletion()})),n.addTransitionActionHandler(t.QuestionBoxControlTransitionAction.textInput_UpdateTermSelection,(function(){return e.updateTermSelection()}))},r})();t.TextInputController=r})(n=t.qna||(t.qna={}))})(n=t.controllers||(t.controllers={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=(function(){function n(){this.restrict="E",this.templateUrl="views/infoNavCanvas.html",this.scope={canvasDefinition:"=",respectPaneUpdates:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.InfoNavCanvasController)}return n})();n.InfoNavCanvas=i})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("InfoNavCanvas",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=(function(){function n(){this.restrict="E",this.templateUrl="views/infoNavContainer.html",this.scope={hostService:"=",interpretUtterance:"=?",infoNavContainerOptions:"=?",models:"=",getAdditionalODataFilter:"=",interpretListener:"=",questionBoxOutput:"=",usageReportingEnabled:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.InfoNavContainerController)}return n})();n.InfoNavContainer=i})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("InfoNavContainer",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=(function(){function n(){this.restrict="E",this.templateUrl="views/infoNavQnaStart.html",this.scope={errorMessage:"@",interpretUtterance:"=",models:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.InfoNavQnaStartController)}return n})();n.InfoNavQnaStart=i})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("InfoNavQnaStart",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i="data-suggestionIndex",r=".infonav-suggestionsHostInnerLayout",o=(function(){function n(){this.restrict="E",this.templateUrl="views/qna/suggestionList.html",this.scope={infoNavControlContainer:"=",sharedViewModel:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.qna.SuggestionListController),this.link=function(e,t,n){e.scrollSelectionIntoView=function(){var n=t.find("["+i+'="'+e.viewModel.selectedSuggestionIndex+'"]');if(n.length>0){var o=n.offset(),s=n.outerHeight(),a=n.closest(r),u=a.height(),c=a.offset(),l=o.top>=c.top,p=o.top+s<=u+c.top;if(l&&p)return;var d=0;n.prevAll().each((function(e,t){d+=$(t).outerHeight()})),l?p||a.scrollTop(d-u+s):a.scrollTop(d)}},e.scrollToTop=function(){t.find(r).scrollTop(0)}}}return n})();n.QnaSuggestionList=o})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("QnaSuggestionList",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=".infonav-textInputBox",r=".infonav-userInput",o="data-termindex",s=(function(){function n(){this.restrict="E",this.templateUrl="views/qna/textInput.html",this.scope={infoNavControlContainer:"=",sharedViewModel:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.qna.TextInputController),this.link=function(e,t,n){var s=t.find(r),a=s.get(0),u=t.find(i);e.setFocusToInput=function(){return s.focus()},e.blurInput=function(){return s.blur()},e.selectInput=function(){return s.select()},e.scrollInputBoxToLeft=function(){return u.scrollLeft(0)},e.setCursorPositionAtEnd=function(){return a.selectionStart=a.selectionEnd=e.sharedViewModel.userInput.length},e.getSelectionStart=function(){try{return a.selectionStart}catch(e){return null}},e.getSelectionEnd=function(){try{return a.selectionEnd}catch(e){return null}},e.getSelectedTermPosition=function(e,n){for(var i={top:0,left:0,height:0,width:0},r=e;r<=n;r++){var s=t.find("["+o+'="'+r+'"]');i.width+=s.width(),s.length>0&&r===e&&(i.top=s.position().top,i.left=s.position().left,i.height=s.height())}return i}}}return n})();n.QnaTextInput=s})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("QnaTextInput",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=(function(){function n(){this.restrict="E",this.templateUrl="views/qna/questionBox.html",this.scope={infoNavControlContainer:"=",sharedViewModel:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.qna.QuestionBoxController)}return n})();n.QuestionBox=i})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("QuestionBox",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=(function(){function n(){this.restrict="E",this.templateUrl="views/qna/questionBoxContainer.html",this.scope={getAdditionalODataFilter:"=",interpretListener:"=",models:"=",output:"=",usageReportingEnabled:"="},this.replace=!0,this.controller=e.common.createController(t.controllers.qna.QuestionBoxContainerController)}return n})();n.QuestionBoxContainer=i})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("QuestionBoxContainer",[]);var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function t(t,n,i,r){void 0===i&&(i=0),this._utterance=t,this._results=n.map((function(n){return new e.InterpretResult(n,t)})),this._resultIndex=i,this._featureSwitches=r}return Object.defineProperty(t.prototype,"utterance",{get:function(){return this._utterance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"result",{get:function(){return _.isEmpty(this._results)?null:this._resultIndex<0||this._resultIndex>=this._results.length?null:this._results[this._resultIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"results",{get:function(){return this._results},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resultIndex",{get:function(){return this._resultIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"featureSwitches",{
get:function(){return this._featureSwitches},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(e){return this._results.length<1||this._results[this._resultIndex].isEmpty(e)},t.prototype.isUtteranceLinguisticallyEquivalent=function(e){return e&&(e._utterance||"").trim()===(this._utterance||"").trim()},t})();e.InterpretResponse=t})(t=e.models||(e.models={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e){this._parts=e}return Object.defineProperty(e.prototype,"parts",{get:function(){return this._parts},set:function(e){this._parts=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){var e="";return this._parts.forEach((function(t,n,i){e+=t.text})),e},enumerable:!0,configurable:!0}),e})();e.UISuggestionItem=t;var n=(function(){function e(e,t){this._source=e,this._utterance=t}return Object.defineProperty(e.prototype,"language",{get:function(){return this._source.Language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alternateCompletions",{get:function(){return this._source.AlternateCompletions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"suggestionItems",{get:function(){return this._source.SuggestionItems},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"suggestedPhrasingTemplates",{get:function(){return this._source.SuggestedPhrasingTemplates},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"completedUtterance",{get:function(){return this._source.CompletedUtterance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"warnings",{get:function(){return this._source.Warnings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._source.Error},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"databaseName",{get:function(){return this._source.DatabaseName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"virtualServerName",{get:function(){return this._source.VirtualServerName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restatement",{get:function(){return this._source.Restatement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spans",{get:function(){return this._source.Spans},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"utterance",{get:function(){return this._utterance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unrecognizedTerms",{get:function(){return this._source.UnrecognizedTerms?this._source.UnrecognizedTerms.map((function(e){return e.TermIndex})):null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(e){return!(this._source.Command||e&&(this.restatement||this.completedUtterance||this.alternateCompletions&&this.alternateCompletions.length||this.suggestionItems&&this.suggestionItems.length))},e.prototype.hasCompletionSuggestions=function(){return!!this._source&&!!this.alternateCompletions&&this.alternateCompletions.length>0},e.prototype.hasTermSuggestions=function(){return!!this._source&&!!this.suggestionItems&&this.suggestionItems.length>0},e.prototype.getCompletedUtteranceAsTerms=function(){var t=new Array,n=this.completedUtterance;if(n)for(var i=n.Terms,r=0,o=i.length;r<o;r++)t.push(e.getTermText(n,r));return t},e.getTermText=function(e,t){var n=e.Text,i=e.Terms,r=i[t].StartCharIndex,o=t===i.length-1,s=o?n.length:i[t+1].StartCharIndex;return n.substring(r,s)},e.prototype.getTermSuggestionsForSelection=function(e){for(var t=[],n=0;n<this.suggestionItems.length;n++){var i=this.suggestionItems[n];i.TermStartIndex<=e.end&&e.start<=i.TermEndIndex&&t.push(i)}return t},e.prototype.hasSuggestionsForTermSelection=function(e){if(this._source&&this.suggestionItems)for(var t=this.suggestionItems,n=0;n<t.length;n++)if(t[n].TermStartIndex<=e.end&&e.start<=t[n].TermEndIndex)return!0;return!1},e.prototype.getCompletionSuggestions=function(){var e=new Array;if(this._source&&this.completedUtterance&&this.hasCompletionSuggestions())for(var n=this.getCompletedUtteranceAsTerms(),i=0;i<this.alternateCompletions.length;i++){var r=this.alternateCompletions[i],o=new t;o.parts=new Array;for(var s=0;s<r.Items.length;s++){var a=r.Items[s];if(a.TermIndices)for(var u=0;u<a.TermIndices.length;u++){var c={};if(c.text=a.Text?a.Text:n[a.TermIndices[u]],c.emphasize=!!a.Text,o.parts.push(c),a.Text&&0===u)break}else{var l={};l.text=a.Text,l.emphasize=!0,o.parts.push(l)}}e.push(o)}return e},e.prototype.getTermSuggestions=function(e){var n=new Array;if(e&&this.completedUtterance&&this.hasTermSuggestions())for(var i=this.getCompletedUtteranceAsTerms(),r=this.getTermSuggestionsForSelection(e),o=0;o<r.length;o++){var s=r[o];if(s.TermStartIndex<=e.end&&e.start<=s.TermEndIndex){var a=new t;a.parts=i.map((function(e){var t={};return t.text=e,t.emphasize=!1,t}));var u=s.TermEndIndex-s.TermStartIndex+1;a.parts.splice(s.TermStartIndex,u,{text:s.SuggestedReplacement,emphasize:!0}),n.push(a)}}return n},e})();e.InterpretResult=n})(t=e.models||(e.models={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(t){function n(){return new i}t.createUsageService=n;var i=(function(){function t(){this.firstUsage=!0}return t.prototype.update=function(t){var n={UtteranceData:t};this.firstUsage&&(n.FirstUsage=!0,this.firstUsage=!1);var i=e.common.httpService.powerbiRequestOptions(null,"UsageUpdate");e.common.httpService.post("infonav/usage/update/",{request:n},i)},t})()})(n=t.services||(t.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){return new n(e)}e.createBindingElementFactory=t;var n=(function(){function e(e){this.localizationService=e}return e.prototype.buildBindingElement=function(e,t,n){var i=document.createElement("div");if(i.textContent=t,e.appendChild(i),n){var r=document.createElement("div");r.className="replacementDetail",r.textContent="("+n+")",e.appendChild(r)}},e.prototype.buildPropertyBaseElement=function(e,t){t.ConceptualProperty?this.buildBindingElement(e,t.Text,this.localizationService.format("Qna_BindingType_Property",[t.ConceptualEntity,t.ConceptualProperty])):t.ConceptualHierarchy&&(t.ConceptualHierarchyLevel?this.buildBindingElement(e,t.Text,this.localizationService.format("Qna_BindingType_Hierarchy",[t.ConceptualEntity,t.ConceptualHierarchy,t.ConceptualHierarchyLevel])):this.buildBindingElement(e,t.Text,this.localizationService.format("Qna_BindingType_Property",[t.ConceptualEntity,t.ConceptualHierarchy])))},e.prototype.buildTable=function(e,t){this.buildBindingElement(e,t.Text,t.ConceptualEntity)},e.prototype.buildPod=function(e,t){this.buildBindingElement(e,t.Text,this.localizationService.get("Qna_BindingType_ReportPage"))},e.prototype.buildProperty=function(e,t){return this.buildPropertyBaseElement(e,t)},e.prototype.buildValue=function(e,t){return this.buildPropertyBaseElement(e,t)},e.prototype.buildRange=function(e,t){return this.buildPropertyBaseElement(e,t)},e.prototype.buildVisType=function(e,t){this.buildBindingElement(e,t.Text,this.localizationService.get("Qna_BindingType_VisualizationType"))},e.prototype.buildComposite=function(e,t){this.buildBindingElement(e,t.Text,this.localizationService.get("Qna_BindingType_Composite"))},e.prototype.buildCoreTerm=function(e,t){this.buildBindingElement(e,t.Text)},e.prototype.buildAnyEntityTerm=function(e,t){this.buildBindingElement(e,t.Text)},e.prototype.build=function(e){var t,n=document.createElement("li");e.Composite?(t=e.Composite,this.buildComposite(n,e.Composite)):e.Pod?(t=e.Pod,this.buildPod(n,e.Pod)):e.Property?(t=e.Property,this.buildProperty(n,e.Property)):e.Range?(t=e.Range,this.buildRange(n,e.Range)):e.Table?(t=e.Table,this.buildTable(n,e.Table)):e.Value?(t=e.Value,this.buildValue(n,e.Value)):e.VisType?(t=e.VisType,this.buildVisType(n,e.VisType)):e.Core?(t=e.Core,this.buildCoreTerm(n,e.Core)):e.AnyEntity&&(t=e.AnyEntity,this.buildAnyEntityTerm(n,e.AnyEntity));var i=t.Text;return{element:n,text:i,binding:t,container:e}},e})();e.BindingElementFactory=n})(t=e.services||(e.services={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(n){var i;!(function(i){function r(e,t,n,i,r,o,s,u,c){return new a(e,t,n,i,r,o,s,u,c)}var o=e.explore.FilterUtils,s=e.infonav.utils.visualUtil;i.createInfoNavCanvasDefinitionFactory=r;var a=(function(){function r(e,t,n,i,r,o,s,a,u){this.moduleLoader=e,this.conceptualSchemaProxy=t,this.explorationProxy=n,this.explorationSerializer=i,this.featureSwitchService=r,this.geoTaggingAnalyzerService=o,this.aggrOps=s,this.promiseFactory=a,this.eventBridge=u}return r.prototype.createGivenUtteranceData=function(a,u,c,l,p,d){var h;a&&a.queryDefn&&(h=_.filter(a.queryDefn.From,(function(t){return t.Type===e.data.EntitySourceType.Pod})));var v=_.find(u,(function(e){return e.vsName===a.virtualServerName&&e.dbName===a.databaseName})),g=r.createDataSourceArray(v);if(_.isEmpty(h)){var f=s.interpretResultToConfig(a,u),m=t.services.createVisualAuthoringCore(p,this.geoTaggingAnalyzerService,this.aggrOps,this.featureSwitchService),y=n.viewModels.ViewModelFactory.createVisualDataFromInterpretResult(f,this.conceptualSchemaProxy,g,m).then((function(e){return _.isEmpty(e)?null:e[0]}));return new i.SingleVisualizationCanvasDefinition(this.moduleLoader,y,c,l,v,g,this.promiseFactory)}var S=h[0],I=r.unwrapReportIdFromSchema(S.Schema),T=S.Entity,C=o.extractParameterFilters(a.queryDefn,a.queryMetadata);return new i.PodExploreCanvasDefinition(I,T,C,v,g,this.explorationProxy,this.explorationSerializer,this.promiseFactory,this.eventBridge,p,d)},r.prototype.createGivenTileData=function(e,t,o){var s=_.find(t,(function(t){return t.id===e.modelId})),a=r.createDataSourceArray(s);if(e.reportPageTile){var u=e.reportPageTile.reportId,c=e.reportPageTile.pod,l=[],p=e.reportPageTile.filters&&this.explorationSerializer.deserializeFilterCollection(e.reportPageTile.filters,l,!1);if(!_.isEmpty(l))return;return new i.PodExploreCanvasDefinition(u,c,p,s,a,this.explorationProxy,this.explorationSerializer,this.promiseFactory,this.eventBridge,null,null)}if(e.visualContainer){var d=n.viewModels.ViewModelFactory.createVisualDataFromVisualContainer(e.visualContainer,s);return new i.SingleVisualizationCanvasDefinition(this.moduleLoader,this.promiseFactory.resolve(d),null,i.SingleVisualizationType.PrimaryVisual,s,a,this.promiseFactory)}},r.createDataSourceArray=function(t){return e.explore.contracts.createDataSourceArray([{type:"dsr",id:t.id,packageId:t.packageId,name:void 0,dsr:{schemaName:void 0,vsName:t.vsName,dbName:t.dbName,modelId:t.id}}])},r.unwrapReportIdFromSchema=function(e){var t="Report_";return e&&_.startsWith(e,t)&&(e=e.substring(t.length)),parseInt(e,10)},r})()})(i=n.services||(n.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(n){var i;!(function(n){var i=e.explore.constants.ExploreCanvasConstants,r=e.explore.viewModels,o=e.explore.FilterUtils,s=(function(){function e(e,t,n,i,r,o,s,a,u,c,l){this.reportId=e,this.podName=t,this.parameterFilters=n,this.model=i,this.dataSources=r,this.explorationProxy=o,this.explorationSerializer=s,this.promiseFactory=a,this.eventBridge=u,this.visualPlugin=c,this.resourcePackagesService=l,this.pinEnabled=!0,this.resetSelection=!0,this.showPageFilters=!0,this.initializeDeferred=a.defer()}return Object.defineProperty(e.prototype,"initializePromise",{get:function(){return this.initializeDeferred.promise},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e){var t=this;return e&&e.infoNavPodExplorationCreator?this.infoNavPodExplorationCreator=e.infoNavPodExplorationCreator:this.infoNavPodExplorationCreator=new a(this.explorationProxy,this.explorationSerializer,this.promiseFactory,this.eventBridge),this.infoNavPodExplorationCreator.createExploration(this.reportId,this.podName,this.parameterFilters,this.model).then((function(e){t.ensureCustomViz(e).then((function(){t.exploration=e.exploration,t.exploreCanvas=e.exploration.exploreCanvas,t.section=e.section,t.pod=e.pod,t.originalFilters=e.originalFilters,t.section.size.displayOption=4,t.maxWidth=e.section.size.width+2*i.AutoLayoutVisualPadding+2*i.ExploreCanvasPadding,t.maxHeight=e.section.size.height+2*i.AutoLayoutVisualPadding+2*i.ExploreCanvasPadding+i.AutoLayoutVisualVCHeader+i.ScrollbarOffset,t.initializeDeferred.resolve(null)}))})),this.initializePromise},e.prototype.onVisualConversion=function(e){},e.prototype.extractParameterFilters=function(){var e=[],t=this.explorationSerializer.deserializeFilterCollection(this.originalFilters,e,!1);if(_.isEmpty(e))return o.extractParameterFiltersFromSection(this.section.filters,t)},e.prototype.ensureCustomViz=function(e){var t=e.section,n=_.filter(e.exploration.contract.resourcePackages,(function(e){return _.any(t.visualContainers,(function(t){return t.config.singleVisual.visualType===e.name}))}));return n.length>0&&(this.resourcePackagesService&&this.resourcePackagesService.registerPackages(n),this.visualPlugin)?this.visualPlugin.ensurePlugins(n):this.promiseFactory.resolve()},e})();n.PodExploreCanvasDefinition=s,n.ExplorationExpirationMilliseconds=6e4;var a=(function(){function i(e,t,n,i){this.explorationProxy=e,this.explorationSerializer=t,this.promiseFactory=n,this.eventBridge=i,this.lastExplorationData=null,this.lastExplorationTime=0,this.lastReportId=null,this.lastPodName=null,this.lastParameterFilters=null}return i.prototype.createExploration=function(t,i,s,a){var u=this,c=null,l=JSON.stringify(s);if(this.lastExplorationData&&this.lastExplorationTime+n.ExplorationExpirationMilliseconds>Date.now()&&this.lastReportId===t&&this.lastPodName===i){var p=this.lastExplorationData;if(this.lastParameterFilters===l)c=this.promiseFactory.resolve(p);else{this.lastExplorationTime=Date.now(),this.lastParameterFilters=l;var d=[],h=this.explorationSerializer.deserializeFilterCollection(p.originalFilters,d,!1);p.section.filters=h,o.applySectionParameterFilters(p.section,p.pod,s,!0),this.eventBridge.publishToChannel(e.explore.services.events.visualContainerChanged,{affectContainer:function(){return!0},allowCache:!0}),c=this.promiseFactory.resolve(p)}}else c=this.explorationProxy.get({id:t}).then((function(e){var n=u.findPodSectionIndices(e,i);if(n){var a=e.sections[n.sectionIndex],c=e.pods[n.podIndex];o.mergeExplorationSectionFilters(e,a);var p=u.explorationSerializer.serializeFilterCollection(a.filters);o.applySectionParameterFilters(a,c,s);var d={exploration:r.ViewModelFactory.convertExploration(e,0,n.sectionIndex),section:a,pod:c,originalFilters:p};return u.lastExplorationData=d,u.lastExplorationTime=Date.now(),u.lastReportId=t,u.lastPodName=i,u.lastParameterFilters=l,d}}));return c},i.prototype.findPodSectionIndices=function(e,n){var i=t.PodUtils.findPodIndexForPodName(e,n);if(i>=0){var r=e.pods[i].boundSection,o=t.SectionUtils.findSectionIndexForSectionName(e,r);if(o>=0)return{podIndex:i,sectionIndex:o}}},i})();n.InfoNavPodExplorationCreator=a})(i=n.services||(n.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(n){var i;!(function(n){var i,r=e.infonav.constants,o=e.explore.constants.ExploreCanvasConstants,s=e.explore.contracts,a=e.data.SemanticFilter,u=jsCommon.Utility,c=e.explore.util.VisualContainerUtils,l=t.viewModels.ViewModelFactory,p=e.infonav.utils.visualUtil;!(function(e){e[e.PrimaryVisual=0]="PrimaryVisual",e[e.Cortana=1]="Cortana"})(i=n.SingleVisualizationType||(n.SingleVisualizationType={}));var d=(function(){function n(e,t,n,i,r,o,s){this.moduleLoader=e,this.visualDataPromise=t,this.additionalODataFilter=n,this.singleVisualizationType=i,this.model=r,this.dataSources=o,this.promiseFactory=s,this.pinEnabled=!0,this.resetSelection=!1,this.showPageFilters=!1,this.maxSizeProvider=new h,this.initializeDeferred=this.promiseFactory.defer()}return Object.defineProperty(n.prototype,"initializePromise",{get:function(){return this.initializeDeferred.promise},enumerable:!0,configurable:!0}),n.prototype.initialize=function(e,t,n,i){var r=this;return e&&e.singleVisualExploration?this.singleVisualExploration=e.singleVisualExploration:this.singleVisualExploration=new v(t,this.singleVisualizationType,this.maxSizeProvider),this.visualDataPromise.then((function(e){return r.handleVisualData(e,r.additionalODataFilter,n,i)})),this.initializePromise},n.prototype.onVisualConversion=function(e){var t=p.getType(e),n=this.maxSizeProvider.calculateCanvasSize(t);this.maxWidth=n.width,this.maxHeight=n.height},n.prototype.handleVisualData=function(n,i,r,o){return __awaiter(this,void 0,e.Promise,(function(){var s,a,u,c;return __generator(this,(function(l){switch(l.label){case 0:return i?[4,this.loadODataFilterDependencies()]:[3,2];case 1:l.sent(),e.explore.odata&&(a=e.explore.odata.createODataFilterParser().tryGetFilters(i),_.isEmpty(a)||(s={filters:a})),l.label=2;case 2:return this.singleVisualExploration.updateForVisual(n,s),r&&t.services.selectionUtils.selectVisualContainer(this.singleVisualExploration.visualContainerContract,o),this.exploreCanvas=this.singleVisualExploration.exploreCanvas,this.section=this.singleVisualExploration.section,u=p.getType(this.singleVisualExploration.visualContainerContract.config.singleVisual.visualType),c=this.maxSizeProvider.calculateCanvasSize(u),this.maxWidth=c.width,this.maxHeight=c.height,this.model=n.model,this.initializeDeferred.resolve(null),[2]}}))}))},n.prototype.loadODataFilterDependencies=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.promiseFactory.all([this.moduleLoader.require({javascript:"odataFilterParser"}),this.moduleLoader.require({javascript:"odataExplore"})])];case 1:return e.sent(),[2]}}))}))},n})();n.SingleVisualizationCanvasDefinition=d;var h=(function(){function e(){}return e.prototype.calculateCanvasSize=function(e){var t=.75,n=650;switch(e){case 3:return{width:n,height:175};case 5:case 20:case 30:case 17:case 16:return{width:n,height:t*n};default:return{width:r.DefaultVisualMaxWidth,height:r.DefaultVisualMaxHeight}}},e.prototype.calculateSectionSize=function(e){var t=960,n=720,r=20,s=-250;switch(e){case i.Cortana:return{width:o.DefaultCortanaWidth+r,height:o.DefaultCortanaHeight+s};case i.PrimaryVisual:return{width:t,height:n};default:return{width:t,height:n}}},e})(),v=(function(){function e(e,t,n){this.eventBridge=e,this.singleVisualizationType=t,this.maxSizeProvider=n,this.initialize()}return Object.defineProperty(e.prototype,"section",{get:function(){return this.sectionInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"exploreCanvas",{get:function(){return this.exploreCanvasInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visualContainerContract",{get:function(){return this.visualContainer.contract},enumerable:!0,configurable:!0}),e.prototype.updateForVisual=function(e,n){n&&!_.isEmpty(n.filters)?this.sectionInternal.filters=n.filters:this.sectionInternal.filters=[],this.visualContainer.contract.filters=e.visualContainer.filters,this.visualContainer.contract.config=e.visualContainer.config,this.visualContainer.dataViewSource=e.dataViewSource,this.visualContainer.updateViewState(),this.eventBridge.publishToChannel(t.services.events.visualContainerChanged,{affectContainer:c.contractEqualityComparator(this.visualContainer.contract)})},e.prototype.initialize=function(){var e,t=this;e=this.singleVisualizationType===i.Cortana?3:0;var n=this.maxSizeProvider.calculateSectionSize(this.singleVisualizationType);this.initialVisualContainerPosition={x:0,y:0,width:n.width,height:n.height};var r={id:0,name:u.generateGuid(),config:{},layouts:jsCommon.ArrayExtensions.extendWithId([{id:0,position:this.initialVisualContainerPosition}])},o=l.convertVisualContainerStandalone(r);o.allowDeferredRendering=!0,o.hostServices={deleteVisualRelationships:_.noop,getFilters:function(){var e=[],n=o.contract.filters||[];n=n.concat(t.sectionInternal.filters||[]);for(var i=0,r=n;i<r.length;i++){var s=r[i],u=s.filter;u&&e.push(u)}return{dataFilter:a.merge(e),highlightFilter:null}},getVisualRelationshipFilterAction:function(){return 0},selectDataPoint:_.noop,setVisualRelationshipFilterAction:_.noop,clearHighlight:_.noop},this.sectionInternal={name:"InfoNavSection",displayName:"InfoNavSection",size:{displayOption:e,width:n.width,height:n.height},visualContainers:[o.contract],filters:[]},this.explorationContract={width:this.sectionInternal.size.width,height:this.sectionInternal.size.height,dataSources:s.createDataSourceArray(),sections:[this.sectionInternal]},this.exploreCanvasInternal=l.convertSectionToExploreCanvas(this.explorationContract,this.sectionInternal,0),this.visualContainer=this.exploreCanvasInternal.visualContainers[0]},e})()})(i=n.services||(n.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){function i(e,t,n,i,r,o,s,a){return new c(e,t,n,i,r,o,s,a||u)}var r=e.infonav.contracts,o=jsCommon.EnumExtensions,s=e.infonav.utils.InterpretUtil,a=2,u=6e4;n.createInterpretService=i;var c=(function(){function n(e,t,n,i,r,o,s,a){this.interpretProbeService=e,this.interpretHttpService=t,this.promiseFactory=n,this.telemetryService=r,this.contentProviderHttpService=o,this.featureSwitchService=s,this.interpretCache=new l(a,i)}return n.prototype.probe=function(t,n){return this.interpretProbeService.probe(t,n).then((function(t){return new e.explore.infonav.models.InterpretResponse(null,t)}))},Object.defineProperty(n.prototype,"contentProviders",{get:function(){return this.contentProviderHttpService.getBuiltInContentProviders()},enumerable:!0,configurable:!0}),n.prototype.interpret=function(e,t,i,r,o,s,a,u){var c=this,l=_.first(i);o.isError=null,o.isResponseEmpty=null,o.fromCache=null,o.wasCancelled=null,o.probeCompletedTimestamp=null,o.contentProviderType=this.getModelContentProviderType(l),o.ownerType=n.getModelOwnerType(l);var p=this.interpretInternal(e,t,i,r,o,s,a,u);return p.then((function(e){if(o.isError=!1,o.isResponseEmpty=!e||e.isEmpty(!1),e){var t=n.getFirstModelFromInterpretResponse(e,i);t&&(o.contentProviderType=c.getModelContentProviderType(t),o.ownerType=n.getModelOwnerType(t))}}),(function(){o.isError=!0,o.isResponseEmpty=!0})),p},n.prototype.interpretInternal=function(e,i,r,o,a,u,c,l){var p=this,d=s.createInterpretRequestScope(r,this.featureSwitchService.featureSwitches);if(_.isEmpty(d.DbMonikers))return this.promiseFactory.reject();var h=n.constructInterpretRequest(e,i,d,o,null,l);a.fromCache=!1;var v=this.interpretCache.getInterpretResponse(h);if(v)return a.fromCache=!0,this.promiseFactory.resolve(v);var g=this.promiseFactory.defer();a.wasCancelled=!1,u&&u.then((function(){return a.wasCancelled=!0})),a.probeCompletedTimestamp=null;var f=function(){a.probeCompletedTimestamp=Date.now(),p.interpretHttpService.interpret(h,null,u).then((function(n){var i=n.data,r=_.isArray(i)?{results:i}:i;a.interpretRequestId=n.requestId;var o=new t.models.InterpretResponse(e,r.results,0,r.featureSwitches);p.interpretCache.setInterpretResponse(h,o),g.resolve(o)}),(function(e){a.interpretRequestId=e.requestId,g.reject()}))};if(c)f();else{var m=this.interpretProbeService;if(m.isProbeCompleted(d))f();else{var y={runToCompletion:function(){return f(),g.promise},reject:function(){g.reject()}};this.interpretProbeService.probe(r,null,y)}}return g.promise},n.getFirstModelFromInterpretResponse=function(e,t){if(e){var n=e.result;if(n)return _.find(t,(function(e){return e.vsName===n.virtualServerName&&e.dbName===n.databaseName}))}return null},n.prototype.getModelContentProviderType=function(t){return t&&null!=t.contentProviderId?e.common.findContentProviderName(this.contentProviders,t.contentProviderId):"Unknown"},n.getModelOwnerType=function(t){return t&&null!=t.permissions?jsCommon.EnumExtensions.hasFlag(t.permissions,e.common.contracts.Permissions.All)?e.telemetry.OwnerType.Owner:e.telemetry.OwnerType.Shared:e.telemetry.OwnerType.Unknown},n.constructInterpretRequest=function(e,t,n,i,s,u){var c={Version:a,Utterance:e,Scope:n,AdditionalODataFilter:i,Spans:u};if(t&&(c.Options=t,s&&o.hasFlag(c.Options,r.InterpretRequestOptions.Data))){var l=s.result;if(l&&!l.isEmpty(!1)&&!o.hasFlag(l.source.Warnings,r.InterpretWarnings.DataRetrievalFailed)){var p=l.source.Command,d=p.VisualConfigurations;c.LastQuery={Query:p.Query,Binding:_.isEmpty(d)?null:d[0].DataShapeBinding}}}return c},n})(),l=(function(){function e(e,t){this.cache={},this.expirationInMilliseconds=e,this.timeoutService=t}return e.prototype.getInterpretResponse=function(t){if(!e.shouldRequestUseCache(t))return null;var n=e.getCacheKey(t),i=this.cache[n];if(i){if(!(i.expiration<Date.now()))return i.response;delete this.cache[n]}return null},e.prototype.setInterpretResponse=function(t,n){if(e.shouldRequestUseCache(t)&&e.shouldResponseUseCache(t,n)){var i=e.getCacheKey(t);this.cache[i]={response:n,expiration:Date.now()+this.expirationInMilliseconds},this.removeExpiredEntriesAfterTimeout()}},e.prototype.removeExpiredEntriesAfterTimeout=function(){var e=this;this.removeExpiredEntriesPromise||(this.removeExpiredEntriesPromise=this.timeoutService((function(){e.removeExpiredEntriesPromise=null;var t=Date.now(),n=!1;for(var i in e.cache){var r=e.cache[i];r.expiration<t?delete e.cache[i]:n=!0}n&&e.removeExpiredEntriesAfterTimeout()}),this.expirationInMilliseconds))},e.shouldRequestUseCache=function(e){return!(!_.isEmpty(e.AdditionalODataFilter)||!_.isEmpty(e.Spans))},e.shouldResponseUseCache=function(e,t){return(!o.hasFlag(e.Options,r.InterpretRequestOptions.Data)||!_.any(t.results,(function(e){return o.hasFlag(e.warnings,r.InterpretWarnings.DataRetrievalFailed)||o.hasFlag(e.warnings,r.InterpretWarnings.DataRetrievalSkipped)})))&&!_.any(t.results,(function(e){return o.hasFlag(e.warnings,r.InterpretWarnings.LinguisticSchemaIsStillLoading)}))},e.getCacheKey=function(e){return[e.Utterance||"",e.Options?e.Options.toString(10):"-",e.DesiredInterpretationsCount?e.DesiredInterpretationsCount.toString(10):"-",e.Scope?JSON.stringify(e.Scope.DbMonikers):"-",e.Version?e.Version.toString(10):"-"].join("::")},e})()})(n=t.services||(t.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){function i(e,t,n,i,r,o){return new u(e,t,n,i,r,o)}var r=e.infonav.contracts;n.createQnaInputInterpreterService=i;var o=3e3,s=4,a=1,u=(function(){function n(e,t,n,i,r,s){this.interpretService=e,this.interpretUsageListener=t,this.promiseFactory=n,this.contentProviderHttpService=i,this.outstandingInterpretRequests=[],this.answeredQuestionEventLogger=r.createAnsweredQuestionEventLogger(o),this.diagnosticsEnabled=s.diagnostics}return n.prototype.sendInterpret=function(e,n,i,o){var s=this;void 0===o&&(o=!1);var u=null,c=n.additionalODataFilterGetter();c&&(u=c());var l=this.answeredQuestionEventLogger.startAnsweredQuestionEvent(),p={},d=this.promiseFactory.defer();this.outstandingInterpretRequests.push(d),this.enforceMaxConcurrentRequests();var h;if(!e||e.trim().length<a){var v=this.promiseFactory.defer();this.interpretService.probe(n.models()).then((function(){return v.reject()}),(function(){return v.reject()})),h=v.promise}else{var g=r.InterpretRequestOptions.QueryMetadata|r.InterpretRequestOptions.VisualConfiguration|r.InterpretRequestOptions.SupportPodQueries|r.InterpretRequestOptions.TermBindings;this.diagnosticsEnabled&&(g|=r.InterpretRequestOptions.Diagnostics),h=this.interpretService.interpret(e,g,n.models(),u,p,d.promise,null,i),h.finally((function(){return l.resolve(p)}))}h.then((function(i){if(!s.shouldIgnoreResponse(i,n,d,e)){s.handleNewInterpretResponse(i,n,d);var r=n.interpretListener();if(r)if(!i||i.isEmpty(!0)||i.result.isEmpty(!0))r.onInterpretError(i?i.utterance:null,s.hasOutstandingRequests());else{var a=t.util.InterpretResultUtility.parseInterpret(i.result);a?r.onInterpretSuccess(i,a,u,o):r.onInterpretError(i?i.utterance:null,s.hasOutstandingRequests())}n.usageReportingEnabled()&&s.interpretUsageListener.onInterpretSuccess(i,s.getModelContentProviderType(i,n))}}),(function(){if(!s.shouldIgnoreResponse(null,n,d,e)){s.updateStateGivenResponse(null,n,d);var t=n.interpretListener();t&&t.onInterpretError(e,s.hasOutstandingRequests())}})),n.usageReportingEnabled()&&this.interpretUsageListener.onInterpretIssued()},Object.defineProperty(n.prototype,"contentProviders",{get:function(){return this.contentProviderHttpService.getBuiltInContentProviders()},enumerable:!0,configurable:!0}),n.prototype.enforceMaxConcurrentRequests=function(){if(this.outstandingInterpretRequests.length>s)for(var e=this.outstandingInterpretRequests.splice(0,this.outstandingInterpretRequests.length-s),t=0,n=e;t<n.length;t++){var i=n[t];i.resolve({})}},n.prototype.handleNewInterpretResponse=function(t,n,i){this.updateStateGivenResponse(t,n,i),n.stateMachine.enqueueTransition(e.explore.infonav.controllers.qna.QnaInputTransitionId.ResultReady)},n.prototype.shouldIgnoreResponse=function(e,t,n,i){if(!_.contains(this.outstandingInterpretRequests,n))return!0;if(!e&&""===i)return!0;var r=t.userInput(),o=i;e&&e.result&&e.result.completedUtterance&&!_.isEmpty(e.result.completedUtterance.Text)&&(o=e.result.completedUtterance.Text);var s=Math.min(r.length,o.length);return r.substr(0,s)!==o.substr(0,s)},n.prototype.updateStateGivenResponse=function(e,t,n){this.updateOutstandingRequestsGivenCompletedRequest(n),t.interpretResponse=this.interpretResponse=e,t.showLoadingSpinner=this.hasOutstandingRequests(),t.showQnaFeedback(t.usageReportingEnabled)},n.prototype.hasOutstandingRequests=function(){return!_.isEmpty(this.outstandingInterpretRequests)},n.prototype.updateOutstandingRequestsGivenCompletedRequest=function(e){var t;t=e?_.findIndex(this.outstandingInterpretRequests,(function(t){return t===e})):this.outstandingInterpretRequests.length;for(var n=0;n<t;n++)this.outstandingInterpretRequests[n].resolve({});this.outstandingInterpretRequests.splice(0,t+1)},n.prototype.getModelContentProviderType=function(t,n){if(t){var i=t.result;if(i){var r=_.find(n.models(),(function(e){return e.vsName===i.virtualServerName&&e.dbName===i.databaseName}));if(r&&null!=r.contentProviderId)return e.common.findContentProviderName(this.contentProviders,r.contentProviderId)}}return"Unknown"},n})()})(n=t.services||(t.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(t){function n(e,t,n){return new o(e,t,n)}var i,r=e.common.helpers.ModelConverterHelper;!(function(e){e[e.Generated=0]="Generated",e[e.Tile=1]="Tile",e[e.FeaturedQuestion=2]="FeaturedQuestion"})(i=t.SampleQuestionSource||(t.SampleQuestionSource={})),t.createSampleQuestionsService=n;var o=(function(){function e(e,t,n){this.interpretService=e,this.featureSwitchService=t,this.promiseFactory=n,this.tileUtterancesByModel={}}return e.prototype.getSampleQuestions=function(t){if(_.isEmpty(t))return[];for(var n=[],i=this.featureSwitchService.featureSwitches,o=_(t).filter((function(e){return r.getIsQnaSupported(e,i)})).sortBy((function(e){return e.id})).value(),s=e.createFeaturedQuestions(o),a=0,u=o;a<u.length;a++){var c=u[a],l=c.id;l in this.tileUtterancesByModel&&s.push.apply(s,this.tileUtterancesByModel[l])}return s=_.uniq(s,(function(e){return e.question.trim().toUpperCase()})),n.push(this.promiseFactory.resolve(s)),n.push(this.interpretService.probe(o).then((function(t){
return e.createSampleQuestionsFromResponse(t,o)}),(function(){return[]}))),n},e.prototype.addTileUtterance=function(e,t){this.tileUtterancesByModel[t]||(this.tileUtterancesByModel[t]=[]),this.tileUtterancesByModel[t].push({question:e,source:i.Tile,modelId:t})},e.prototype.deleteTileUtterance=function(t,n){if(n in this.tileUtterancesByModel){var r={question:t,source:i.Tile,modelId:n},o=_.findIndex(this.tileUtterancesByModel[n],(function(t){return e.areEqual(r,t)}));o!==-1&&this.tileUtterancesByModel[n].splice(o,1)}},e.prototype.clearTilesUtterance=function(){this.tileUtterancesByModel={}},e.createFeaturedQuestions=function(e){return _(e).map((function(e){return _(e.featuredQuestions).sortBy((function(e){return e.order})).map((function(t){return{question:t.utterance,source:i.FeaturedQuestion,modelId:e.id}})).value()})).flatten().value()},e.createSampleQuestionsFromResponse=function(t,n){if(!t||t.isEmpty(!0))return[];var r=_(t.results).map((function(t){return t.alternateCompletions.map((function(r){if(r.Items.length>1)return null;var o=e.findModelId(t.databaseName,t.virtualServerName,n);return o===-1?null:{question:r.Items[0].Text,source:i.Generated,modelId:o}}))})).flatten().filter((function(e){return!!e})).uniq((function(e){return e.question.trim().toUpperCase()})).value();return r||[]},e.findModelId=function(e,t,n){var i=_.find(n,(function(n){return n.dbName===e&&n.vsName===t}));return i?i.id:-1},e.areEqual=function(e,t){return e===t||jsCommon.StringExtensions.equalIgnoreCase(e.question,t.question)&&e.source===t.source&&e.modelId===t.modelId},e})()})(n=t.services||(t.services={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){return new i(e,t)}e.createTermConverterService=t;var n=(function(){function e(e,t,n){this.span=t,this.bindingElementFactory=n,this.menuOpened=!1,this.currentReplacementIndex=0,this.hasBuiltReplacements=!1,this.span=t,this.text=e.substr(t.StartIndex,t.Length),jsCommon.StringExtensions.isWhitespace(this.text)||(this.text=this.text.replace(/ /g," "));var i=[];t.Binding&&i.push(t.Binding),t.AlternateBindings&&(i=i.concat(t.AlternateBindings)),t.SuggestedReplacements&&(i=i.concat(t.SuggestedReplacements)),t.PhraseCompletions&&(i=i.concat(t.PhraseCompletions)),this.bindings=i}return Object.defineProperty(e.prototype,"element",{get:function(){return this.elem||(this.elem=this.buildElement()),this.elem},enumerable:!0,configurable:!0}),e.prototype.reuseElement=function(e){return!!(e.element.parentElement&&(this.text.indexOf(e.text)>-1||e.text.indexOf(this.text)>-1)&&e.hasBindings&&this.hasBindings)&&(this.elem=this.buildElement(e),!0)},Object.defineProperty(e.prototype,"hasElement",{get:function(){return!!this.elem},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasBindings",{get:function(){return this.bindings.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentReplacement",{get:function(){return this.replacements[this.currentReplacementIndex]},enumerable:!0,configurable:!0}),e.prototype.chooseCurrentReplacement=function(){this.chooseReplacement(this.currentReplacement)},e.prototype.chooseReplacement=function(e){this.header.innerText=e.text,this.manager&&this.manager.selectReplacement(this,e.text),this.closeMenu()},e.prototype.selectNextReplacement=function(){var e=this.currentReplacementIndex;this.currentReplacement.element.className="",e=Math.min(e+1,this.replacements.length-1),this.currentReplacementIndex=e,this.currentReplacement.element.className="selected";var t=this.replacementElement.offsetHeight,n=this.replacementElement.scrollTop,i=this.currentReplacement.element.offsetHeight,r=this.currentReplacement.element.offsetTop;r+i>n+t&&(this.replacementElement.scrollTop=r-t+i)},e.prototype.selectPreviousReplacement=function(){var e=this.currentReplacementIndex;return this.currentReplacement.element.className="",e--,e>=0?(this.currentReplacementIndex=e,this.currentReplacement.element.className="selected",this.currentReplacement.element.offsetTop<this.replacementElement.scrollTop&&(this.replacementElement.scrollTop=this.currentReplacement.element.offsetTop),!0):(e=0,!1)},e.prototype.closeMenu=function(){this.menuOpened&&this.replacementElement&&(this.currentReplacement.element.className="",this.replacementElement.style.display="none"),this.menuOpened=!1,this.header.className="term-main",this.manager&&this.manager.menuClosed()},e.prototype.openMenu=function(){return this.hasBindings&&(this.menuOpened||(this.hasBuiltReplacements||this.buildReplacements(),this.replacementElement.style.display="block",this.replacementElement.offsetWidth+this.elem.offsetLeft>this.manager.utteranceElement.parentElement.offsetWidth?this.replacementElement.style.left=this.elem.offsetLeft+this.elem.offsetWidth-this.replacementElement.offsetWidth+"px":this.replacementElement.style.left="",this.currentReplacementIndex=0,this.replacementElement.scrollTop=0,this.currentReplacement.element&&(this.currentReplacement.element.className="selected")),this.menuOpened=!0,this.header.className="term-main selected"),this.menuOpened},e.prototype.buildElement=function(e){var t,n,i=this;e&&e.hasElement?(t=e.element,this.replacementElement=e.replacementElement,e.menuOpened&&this.buildReplacements()):t=document.createElement("span"),n=this.header=document.createElement("span"),n.className="term-main";var r=this.span;n.appendChild(document.createTextNode(this.text.replace(/ /g," ")));var o=""===this.text.trim(),s=["term"];return r.Unrecognized||s.push("recognized"),this.hasBindings?(s.push("bindings"),o||s.push("replacements")):o&&s.push("space"),t.className=s.join(" "),e&&e.header&&e.header.parentElement===t?t.replaceChild(n,e.header):t.appendChild(n),this.hasBindings&&n.addEventListener("click",(function(e){i.menuOpened?i.closeMenu():i.manager&&i.manager.selectTerm(i)})),t},e.prototype.buildReplacements=function(){var e=this;if(this.bindingElementFactory){var t=!this.replacementElement;t?this.replacementElement=document.createElement("ul"):this.replacementElement.innerHTML="",this.replacements=this.bindings.map((function(t,n){var i=e.bindingElementFactory.build(t);return i.element.addEventListener("mousedown",(function(t){e.currentReplacementIndex=n,e.chooseCurrentReplacement(),t.preventDefault()})),e.replacementElement.appendChild(i.element),i})),t&&this.elem.appendChild(this.replacementElement)}this.hasBuiltReplacements=!0},e})();e.Term=n;var i=(function(){function e(e,t){this.bindingElementFactory=e,this.rtl=t}return e.prototype.convertIntermediateTerms=function(e,t,i,r){for(var o=i;o<r;)if(/\s/.test(t.charAt(o)))e.push(new n(t,{StartIndex:o,Length:1})),o++;else{var s=t.indexOf(" ",o);s=s>-1?Math.min(s,r):r,e.push(new n(t,{StartIndex:o,Length:s-o})),o=s}},e.prototype.isTextRTL=function(t){return e.rtlDirCheck.test(t)},e.prototype.swapTerms=function(e,t,n){var i=e.splice(t,n-t),r=i.reverse();e.splice.apply(e,[t,0].concat(r))},e.prototype.reorderLtrRuns=function(e){for(var t=null,n=0;n<e.length;n++){var i=e[n].text,r=this.isTextRTL(i);r?null!==t&&(this.swapTerms(e,t,n),t=null):null===t&&(t=n)}return null!==t&&this.swapTerms(e,t,e.length-1),e},e.prototype.convert=function(e){var t,i=e.utterance.replace(/\u00A0/g," "),r=e.result,o=[];if(r){var s=r.spans,a=0;if(!_.isEmpty(s)){for(var u=0,c=s;u<c.length;u++){var l=c[u];a<l.StartIndex&&(this.convertIntermediateTerms(o,i,a,l.StartIndex),a=l.StartIndex);var p=new n(i,l,this.bindingElementFactory);o.push(p),a+=l.Length,i=i.substring(0,l.StartIndex)+p.text+i.substring(a)}t=_.last(o).hasBindings}a<i.length&&(this.convertIntermediateTerms(o,i,a,i.length),t=!1)}return this.rtl.isRtlLayout&&(o=this.reorderLtrRuns(o)),{utterance:i,hasCompletions:t,terms:o}},e})();i.ltrCharacters="A-Za-zÀ-ÖØ-öø-ʸ̀-֐ࠀ-῿Ⰰ-﬜﷾-﹯﻽-￿",i.rtlCharacters="֑-߿יִ-﷽ﹰ-ﻼ",i.rtlDirCheck=new RegExp("^[^"+i.ltrCharacters+"]*["+i.rtlCharacters+"]")})(t=e.services||(e.services={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){return new n(e,t)}e.createStateMachine=t;var n=(function(){function e(e,t){this.stateMachineDefinition=e,this.current=t,this.isBusy=!1,this.transitionQueue=[],this.transitionActionHandlers={}}return e.prototype.addTransitionActionHandler=function(e,t){this.transitionActionHandlers[e.toString()]=t},e.prototype.enqueueTransition=function(e){this.transitionQueue.push(e),this.performTransitionInternal()},e.prototype.performTransitionInternal=function(){if(!this.isBusy){for(this.isBusy=!0;this.transitionQueue.length>0;){var e=this.transitionQueue.shift(),t=this.stateMachineDefinition.getTransition(this.current,e);if(void 0!==t){this.current=t.toState;for(var n=t.actions,i=0,r=n;i<r.length;i++){var o=r[i],s=this.transitionActionHandlers[o.toString()];s&&s()}}}this.isBusy=!1}},e})()})(t=e.stateMachine||(e.stateMachine={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function t(){this.states={}}return t.prototype.getTransition=function(e,t){return this.states[e.toString()][t.toString()]},t.prototype.containsState=function(e){return e.toString()in this.states},t.prototype.addTransition=function(t,n,i,r){var o=this.states[t.toString()];void 0===o&&(this.states[t.toString()]=o={}),o[n.toString()]=new e.Transition(r,i),this.containsState(i)||(this.states[i.toString()]={})},t})();e.StateMachineDefinition=t})(t=e.stateMachine||(e.stateMachine={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this._actions=e,this._toState=t}return Object.defineProperty(e.prototype,"toState",{get:function(){return this._toState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actions",{get:function(){return this._actions},enumerable:!0,configurable:!0}),e})();e.Transition=t})(t=e.stateMachine||(e.stateMachine={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(t){return new r(new e.InterpretUsageQueue(t))}var n=jsCommon.TimerPromiseFactory;e.createInterpretUsageListener=t;var i=5e3,r=(function(){function e(e,t){this.interpretUsageQueue=e,this.timerFactory=t||n.instance}return e.prototype.setFeedbackForLastUtterance=function(e){this.sendPendingResponse(),this.interpretUsageQueue.setFeedbackForLastUtterance(e),this.interpretUsageQueue.flushPending()},e.prototype.onInterpretIssued=function(){var e=this;this.userCompletionPromise&&this.userCompletionPromise.reject(),this.userCompletionPromise=this.timerFactory.create(i),this.userCompletionPromise.done((function(){return e.sendPendingResponse()}))},e.prototype.onInterpretSuccess=function(e,t){return this.userCompletionPromise?(this.pendingInterpretResponse=e,void(this.pendingContentProviderType=t)):void this.registerResponse(e,t)},e.prototype.sendPendingResponse=function(){this.userCompletionPromise&&(this.userCompletionPromise.reject(),this.userCompletionPromise=null);var e=this.pendingInterpretResponse;e&&this.registerResponse(e,this.pendingContentProviderType)},e.prototype.registerResponse=function(e,t,n,i){e.isUtteranceLinguisticallyEquivalent(this.lastInterpretResponse)||(this.interpretUsageQueue.register(e,t,n,i),this.lastInterpretResponse=e)},e})();e.InterpretUsageListener=r})(t=e.usage||(e.usage={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t=jsCommon.TimerPromiseFactory,n=100,i=12e4,r=(function(){function r(n,i,r){this.pendingInterpretations=[],this.usageService=n,this.usageUpdateUtteranceFactory=i||new e.UsageUpdateUtteranceFactory,this.timerFactory=r||t.instance}return r.prototype.register=function(t,r,o,s,a){var u=this;this.mostRecentInterpretation={interpretation:t,flags:o||e.UtteranceFlags.None,feedback:s||e.UtteranceFeedback.None,timeStamp:a||new Date,contentProviderType:r},this.pendingInterpretations.push(this.mostRecentInterpretation),this.pendingInterpretations.length>n?this.flushPending():this.sendPendingUsagesPromise||(this.sendPendingUsagesPromise=this.timerFactory.create(i),this.sendPendingUsagesPromise.done((function(){return u.sendAllUsages()})))},r.prototype.flushPending=function(){this.sendPendingUsagesPromise&&this.sendPendingUsagesPromise.reject(),this.sendAllUsages()},r.prototype.sendAllUsages=function(){var e=[];this.sendPendingUsagesPromise=null;for(var t=0,n=this.pendingInterpretations.length;t<n;++t){var i=this.pendingInterpretations[t];e=e.concat(this.usageUpdateUtteranceFactory.create(i.interpretation,i.flags,i.feedback,i.timeStamp,i.contentProviderType))}this.pendingInterpretations=[],e.length>0&&this.usageService.update(e)},r.prototype.setFeedbackForLastUtterance=function(t){this.updateMostRecentUtterance((function(n){n.feedback=t,t===e.UtteranceFeedback.Bad&&(n.flags|=e.UtteranceFlags.User)}))},r.prototype.updateMostRecentUtterance=function(e){var t=this.pendingInterpretations.length;t>0?e(this.pendingInterpretations[t-1]):this.mostRecentInterpretation&&(e(this.mostRecentInterpretation),this.pendingInterpretations.push(this.mostRecentInterpretation))},r})();e.InterpretUsageQueue=r})(t=e.usage||(e.usage={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.None=0]="None",e[e.ResultIsEmpty=1]="ResultIsEmpty",e[e.User=2]="User"})(t=e.UtteranceFlags||(e.UtteranceFlags={}));var n;!(function(e){e[e.None=0]="None",e[e.Bad=1]="Bad",e[e.Medium=2]="Medium",e[e.Good=3]="Good"})(n=e.UtteranceFeedback||(e.UtteranceFeedback={}))})(t=e.usage||(e.usage={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var n=jsCommon.StringExtensions,i=(function(){function i(){}return i.prototype.create=function(e,t,n,r,o){for(var s=[],a=e.results,u=0,c=a.length;u<c;++u)s.push(i.createUsageData(a[u],t,n,u,r,o));return s},i.createUsageData=function(e,t,n,r,o,s){var a=e.source,u={Text:e.utterance,ResultRank:r,Flags:t|i.determineFlags(e),DatabaseName:a.DatabaseName,VirtualServerName:a.VirtualServerName,ClientDateTime:jsCommon.DateExtensions.serializeDate(o),UserFeedback:n,ContentProviderType:s},c=e.completedUtterance;if(c){u.Text=c.Text;var l=e.unrecognizedTerms;l&&l.length>0&&(u.UnrecognizedTerms=i.convertUnrecognizedTerms(l,c))}return a.Score&&(u.Score=a.Score),u},i.determineFlags=function(e){var n=t.UtteranceFlags.None;return e.completedUtterance||(n|=t.UtteranceFlags.ResultIsEmpty),n},i.convertUnrecognizedTerms=function(t,i){for(var r=[],o=i.Terms,s=0,a=t.length;s<a;++s){var u=t[s],c=o[u].StartCharIndex,l=e.models.InterpretResult.getTermText(i,u);r.push({StartIndex:c,Length:n.trimTrailingWhitespace(l).length})}return r},i})();t.UsageUpdateUtteranceFactory=i})(t=e.usage||(e.usage={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){if(!e)return null;var t=e.utterance;return e.completedUtterance&&(t=e.completedUtterance.Text),n(t,e)}function n(e,t){var n=t.source,i=n.Command;if(!i)return null;var r=i.Binding,o=i.Data,s=null,a=null,u=null;if(o){if(!r)return null;if(a=JSON.parse(r),u=JSON.parse(o),!u)return null;s={data:{descriptor:a,dsr:u}}}return{utterance:e,interpretResult:t,restatement:n.Restatement,queryDefn:i.Query,queryDescriptor:a,queryMetadata:i.QueryMetadata,configs:i.VisualConfigurations,dataViewSource:s,virtualServerName:n.VirtualServerName,databaseName:n.DatabaseName}}e.parseInterpret=t})(t=e.InterpretResultUtility||(e.InterpretResultUtility={}))})(t=e.util||(e.util={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(n){var i;!(function(n){var i,r=(e.explore.viewModels,e.explore.infonav.util.QueryProjectionBuilderUtils),o=e.data.services.SemanticQuerySerializer,s=jsCommon.Utility;!(function(e){function n(e){return{taskPane:u(),visualizationPane:c(e)}}function i(e,n,i,a){return n.get(i).then((function(n){for(var i=[],u=0,c=e.length;u<c;u++){var l=e[u],p=l.config,d=o.deserializeQuery(p.Query),h=r.createProjectionBuilder(p.VisualizationType,d,n),v=t.VisualContainerFactory.create(s.generateGuid(),d,p.QueryMetadata,p.DataShapeBinding,h,n,a);v.config.singleVisual.objects=l.dataViewObjectDefinitions||v.config.singleVisual.objects,i.push({visualContainer:v,model:l.model,dataViewSource:l.dataViewSource})}return i}))}function a(e,t){return{visualContainer:e,model:t}}function u(){return{isPaneExpanded:!1}}function c(e){return{sections:[],activeSection:0,pagePaneSections:[],activePageSection:0,isPaneExpanded:!1,visualPluginFilter:function(t){var n=e.tryGetFilterPropertyIdentifier(t.capabilities);return!n}}}e.createInfoNavContainer=n,e.createVisualDataFromInterpretResult=i,e.createVisualDataFromVisualContainer=a,e.createTaskPane=u,e.createVisualizationPane=c})(i=n.ViewModelFactory||(n.ViewModelFactory={}))})(i=n.viewModels||(n.viewModels={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),angular.module("powerbi.infonav").run(["$templateCache",function(e){e.put("components/qnaInput/qnaInput.html",'<div class="qnaInputContainer" on-resize="$ctrl.handleResize()"><span class="glyphicon pbi-glyph-qna icon" ng-click="$ctrl.selectUtterance()"></span><div id="box"><textarea id="content" type="text" placeholder="{{::$ctrl.placeholder}}" spellcheck="false" autofocus></textarea><div id="utterance"><div id="utteranceContent"></div></div></div></div><div id="cap" ng-click="$ctrl.hideAllMenus()"></div>'),e.put("views/infoNavCanvas.html",'<div class="infoNavCanvas"><section class="exploration" ng-if="viewModel.exploreCanvas" ng-style="explorationStyle"><explore-canvas view-model="viewModel.exploreCanvas"></explore-canvas></section></div>'),e.put("views/infoNavContainer.html",'<section class="explorationContainer infoNavContainer"><exploration-host class="explorationHost" view-model="viewModel" id="athenaExplorationHost"><task-pane class="qnaTaskPane" view-model="viewModel.taskPane" field-list-config="::fieldListConfig" ng-if="hasResult" ng-show="infoNavContainerOptions.showTaskPane" resizable resizable-containerid="athenaExplorationHost" resizable-sibling="qnaVizPane" ng-attr-resizable-expanded="{{viewModel.taskPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"></task-pane><visualization-pane class="qnaVizPane" ng-if="hasResult" ng-show="infoNavContainerOptions.showVisualizationPane" view-model="viewModel.visualizationPane" resizable resizable-containerid="athenaExplorationHost" resizable-sibling="qnaTaskPane" resizable-expanded="{{viewModel.visualizationPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"></visualization-pane><div class="infonavContentWrapper"><section class="infonavContent" ng-style="{\'max-height\':infoNavContentMaxHeight}"><div class="infonavHeader"><qna-input models="models" get-additional-o-data-filter="getAdditionalODataFilter" output="questionBoxOutput" interpret-listener="interpretListener" usage-reporting-enabled="allowQnaDataCollection" ng-if="newQnaEnabled"></qna-input></div><div class="infonavMainContent"><info-nav-canvas ng-show="hasResult" canvas-definition="infoNavCanvasDefinition" respect-pane-updates="true"></info-nav-canvas><div ng-if="state === 1" class="qnaLoading"><spinner class="large qnaLoadingSpinner"></spinner><span localize="Qna_LoadingMessage"></span></div><div class="qnaStartFrame" ng-if="(state === 0 || state === 2 || state === 4) && !infoNavContainerOptions.cortana"><info-nav-qna-start models="models" error-message="{{state === 2 ? errorMessage : \'\'}}" interpret-utterance="interpretUtterance || questionBoxOutput.interpretUtterance"></info-nav-qna-start></div></div><div class="infonavFooter"><h3 ng-if="restatement && !infoNavContainerOptions.cortana" class="restatement">{{restatement}}</h3><h3 ng-if="sourceLabel" class="dataSource">{{sourceLabel}}</h3></div></section></div></exploration-host></section>'),e.put("views/infoNavQnaStart.html",'<div ng-switch="isLoading" class="qnaStart"><div ng-switch-when="true" class="qnaLoading"><spinner modern class="large qnaLoadingSpinner"></spinner><span localize="Qna_LoadingMessage"></span></div><div ng-switch-when="false" class="qnaStartContent"><div ng-switch="viewModel.modelSuggestionSets.length> 0"><div ng-switch-when="true"><div ng-if="!!errorMessage" class="prompt">{{errorMessage}}</div><div class="suggestionSet" ng-repeat="set in viewModel.modelSuggestionSets"><div class="modelName" title="{{::set.modelName}}">{{::set.modelName}}</div><div class="suggestions"><ul><li ng-repeat="s in set.suggestions | limitTo : set.currentSuggestionLimit"> <a ng-click="showUtterance(s)" class="utterance">{{::s.suggestion}}</a></li><li ng-if="set.suggestions.length> set.initialSuggestionLimit"><a ng-click="toggleLimit(set)" ng-switch="!!set.currentSuggestionLimit" class="seeMore"><span ng-switch-when="true" localize="QnaStart_SeeMore"></span><span ng-switch-when="false" localize="QnaStart_SeeLess"></span></a></li></ul></div></div></div><div ng-switch-when="false"><span ng-if="errorMessage" class="prompt" localize="QnAVisualization_EmptyResultTitleText"></span><span ng-if="!errorMessage" class="prompt" localize="QnaStart_ErrorLoadingSuggestions"></span></div></div></div></div>'),e.put("views/qna/questionBox.html",'<div class="infonav-questionBoxContainer"><div class="infonav-questionBoxControl"><qna-text-input info-nav-control-container="infoNavControlContainer" shared-view-model="sharedViewModel"></qna-text-input></div></div>'),e.put("views/qna/questionBoxContainer.html",'<div class="qnaQuestionBoxContainer"><spinner class="qnaSpinner" ng-show="sharedViewModel.showLoadingSpinner"></spinner><question-box info-nav-control-container="infoNavControlContainer" shared-view-model="sharedViewModel"></question-box><qna-suggestion-list info-nav-control-container="infoNavControlContainer" shared-view-model="sharedViewModel"></qna-suggestion-list></div>'),e.put("views/qna/suggestionList.html",'<div class="infonav-suggestionsHost" ng-show="viewModel.showSuggestionsHost"><div class="infonav-suggestionsHostInnerBorder"><div class="infonav-suggestionsHostInnerLayout" ng-class="{\'no-restatement\': !viewModel.restatement}"><ul class="infonav-suggestionsList"><li class="infonav-restatement" ng-if="!!viewModel.restatement">{{viewModel.restatement}}</li><div class="infonav-hr" ng-if="!!viewModel.restatement && viewModel.uiSuggestionItems.length> 0"></div><li ng-repeat="item in viewModel.uiSuggestionItems | limitTo : viewModel.maxSuggestions" ng-class="{\'infonav-listItemSelected\': $index === viewModel.selectedSuggestionIndex}" ng-mouseenter="handleSuggestionMouseEnter($index)" ng-mousedown="handleSuggestionMouseDown($index, $event)" data-suggestionIndex="{{$index}}"> <span ng-repeat="part in item.parts" ng-class="{\'infonav-suggestedTermReplacement\': part.emphasize}">{{part.text}}</span></li></ul></div></div></div>'),e.put("views/qna/textInput.html",'<div class="infonav-textInputControl"><div class="infonav-textInputBox"><div class="infonav-inputAutoComplete" ng-show="viewModel.showAutoComplete" ng-switch="viewModel.hasFocus"> <span ng-switch-when="true" ng-if="viewModel.autoComplete" class="autoCompleteUserInput">{{sharedViewModel.userInput}}</span><span ng-switch-when="true" ng-if="viewModel.autoComplete" class="autoCompleteCompletion">{{viewModel.autoComplete}}</span><span ng-switch-when="false" ng-show="!sharedViewModel.userInput" ng-switch="sharedViewModel.showLoadingPlaceholder"><span ng-switch-when="true" localize="QnaTextBoxLoadingPlaceholder"></span><span ng-switch-when="false" localize="QnaTextBoxPlaceholder"></span></span></div><div class="infonav-inputTermSelection" ng-show="viewModel.showInputTermSelection" ng-style="{                \'top\':viewModel.inputTermSelectionPosition.top,                \'left\':viewModel.inputTermSelectionPosition.left,                \'width\':viewModel.inputTermSelectionPosition.width,                \'height\':viewModel.inputTermSelectionPosition.height}"></div><div class="infonav-inputRenderer"> <span ng-repeat="t in viewModel.inputRendererTerms" ng-class="{\'infonav-unrecognizedTerm\': t.unrecognized && viewModel.inputRendererShowUnrecognized}" data-termindex="{{t.index}}">{{t.term}}</span><span ng-if="!!viewModel.inputRendererRemainder">{{viewModel.inputRendererRemainder}}</span></div> <input class="infonav-userInput" type="text" spellcheck="false" autocomplete="off" maxlength="500" ng-model="sharedViewModel.userInput" ng-focus="onUserInputFocus()" ng-blur="onUserInputBlur()" ng-change="onUserInputChange()" ng-keydown="onUserInputKeyDown($event)" ng-keyup="onUserInputKeyUp($event)" ng-click="onUserInputClick()" ng-on-select="onUserInputSelect()" ng-trim="false"/></div></div>'),e.put("views/userFeedbackDialog.html",'<div><div localize="UtteranceFeedbackDialogPrompt"></div><div class="utteranceFeedbackOptions"> <label ng-repeat="o in feedback.options"><input type="radio" name="utteranceFeedback" ng-value="{{o.value}}" ng-model="feedback.selected"/> <span>{{o.text}}</span></label></div></div>')}]);var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){var n=(function(){function t(t,n){this.scope=t,this.services=n,t.feedback={options:[this.createFeedbackOption("UtteranceFeedbackResultGood",e.usage.UtteranceFeedback.Good),this.createFeedbackOption("UtteranceFeedbackResultMedium",e.usage.UtteranceFeedback.Medium),this.createFeedbackOption("UtteranceFeedbackResultBad",e.usage.UtteranceFeedback.Bad)],selected:null},t.$watch("feedback.selected",(function(e){t.getPrimaryButton().prop("disabled",null==e)}))}return t.createOptions=function(){return{additionalServices:["localizationService"]}},t.prototype.createFeedbackOption=function(e,t){return{value:t,text:this.services.localizationService.get(e)}},t})();t.UserFeedbackDialogController=n})(t=e.controllers||(e.controllers={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){var n;!(function(n){var i=(function(){function n(){this.restrict="E",this.templateUrl="views/userFeedbackDialog.html",this.replace=!0,this.controller=e.common.createController(t.controllers.UserFeedbackDialogController),this.link=function(e,t,n){e.getPrimaryButton=function(){return t.parent().parent().find(".infonav-dialogActions > input").filter(":first")}}}return n})();n.UserFeedbackDialog=i})(n=t.directives||(t.directives={}))})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavDirective("UserFeedbackDialog",[]);var powerbi;!(function(e){var t;!(function(t){var n;!(function(t){function n(e,t,n){return new i(e,t,n)}t.createAnsweredQuestionEventLoggerFactory=n;var i=(function(){function e(e,t,n){this.promiseFactory=e,this.telemetryService=t,this.timeoutService=n}return e.prototype.createAnsweredQuestionEventLogger=function(e){return new s(e,this.promiseFactory,this.telemetryService,this.timeoutService)},e})(),r="1",o="3",s=(function(){function t(e,t,n,i){this.delayMilliseconds=e,this.promiseFactory=t,this.telemetryService=n,this.timeoutService=i}return t.prototype.startAnsweredQuestionEvent=function(){var e=this,t=Date.now(),n=-1,i=this.promiseFactory.defer();return i.promise.then((function(){return n=Date.now()})),this.lastTimeout&&this.timeoutService.cancel(this.lastTimeout),this.lastTimeout=this.timeoutService((function(){e.lastTimeout=null,i.promise.then((function(i){return e.endAnsweredQuestionEvent(t,n,i)}))}),this.delayMilliseconds,!1),i},t.prototype.endAnsweredQuestionEvent=function(t,n,i){var s=-1;i.probeCompletedTimestamp&&i.probeCompletedTimestamp>=t&&(s=i.probeCompletedTimestamp-t),i.wasCancelled&&(i.isError=!1);var a=function(a,u,c,l){return void 0===u&&(u=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),e.telemetry.QnAINAQ("FireActivityCompletionSummaryEvent",i.isError?o:r,i.isResponseEmpty,i.fromCache,i.contentProviderType,i.ownerType,n-t,s,i.wasCancelled,i.interpretRequestId,a,i.isError,c,l)};this.telemetryService.logEvent(a)},t})()})(n=t.infonav||(t.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(t){t.QnaInput={templateUrl:"components/qnaInput/qnaInput.html",bindings:{getAdditionalODataFilter:"=",interpretListener:"=",models:"=",output:"=",usageReportingEnabled:"="},controller:e.controllers.qna.QnaInputController}})(t=e.components||(e.components={}))})(t=e.infonav||(e.infonav={}))})(t=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.infonav.registerInfonavComponent("QnaInput");;var __awaiter=this&&this.__awaiter||function(e,t,i,a){return new(i||(i=Promise))(function(n,o){function s(e){try{c(a.next(e))}catch(e){o(e)}}function r(e){try{c(a.throw(e))}catch(e){o(e)}}function c(e){e.done?n(e.value):new i(function(t){t(e.value)}).then(s,r)}c((a=a.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return a([e,t])}}function a(i){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=o[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(o,i[1])).done)return s;switch(o=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return r.label++,{value:i[1],done:!1};case 5:r.label++,o=i[1],i=[0];continue;case 7:i=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){r=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){r.label=i[1];break}if(6===i[0]&&r.label<s[1]){r.label=s[1],s=i;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(i);break}s[2]&&r.ops.pop(),r.trys.pop();continue}i=t.call(e,r)}catch(e){i=[6,e],o=0}finally{n=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var n,o,s,r={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return{next:i(0),throw:i(1),return:i(2)}},powerbi;!(function(e){var t;!(function(t){function i(t,i,a,n,o,s,r,c,l,d,g,p){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===g&&(g=!1),void 0===p&&(p=!1);var v={parentId:t,isError:i,errorSource:a,errorCode:n,errorMessage:o,activityName:s,activityId:r,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:g,isInCapacity:p},h={name:"PBI.Settings.AdminAuditing",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsAdminAuditingLoggers};return h}function a(t,i,a,n,o,s,r,c,l,d,g,p){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===g&&(g=!1),void 0===p&&(p=!1);var v={parentId:t,isError:i,errorSource:a,errorCode:n,errorMessage:o,activityName:s,activityId:r,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:g,isInCapacity:p},h={name:"PBI.Settings.OpenGatewaySettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsOpenGatewaySettingsLoggers};return h}function n(t,i,a,n,o,s,r,c,l,d,g,p){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===g&&(g=!1),void 0===p&&(p=!1);var v={parentId:t,isError:i,errorSource:a,errorCode:n,errorMessage:o,activityName:s,activityId:r,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:g,isInCapacity:p},h={name:"PBI.Settings.GetUsageMetricsDashboardId",category:e.TelemetryCategory.Verbose,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsGetUsageMetricsDashboardIdLoggers};return h}function o(t,i,a,n,o,s,r,c,l,d,g,p){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===g&&(g=!1),void 0===p&&(p=!1);var v={parentId:t,isError:i,errorSource:a,errorCode:n,errorMessage:o,activityName:s,activityId:r,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:g,isInCapacity:p},h={name:"PBI.Settings.GetTenantSettings",category:e.TelemetryCategory.Verbose,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsGetTenantSettingsLoggers};return h}function s(t,i,a,n,o,s,r,c,l,d,g,p){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===g&&(g=!1),void 0===p&&(p=!1);var v={parentId:t,isError:i,errorSource:a,errorCode:n,errorMessage:o,activityName:s,activityId:r,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:g,isInCapacity:p},h={name:"PBI.Settings.UpdateTenantSettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsUpdateTenantSettingsLoggers};return h}function r(t,i,a,n,o,s,r,c,l,d,g,p,v,h,S,y,w){void 0===r&&(r=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===g&&(g=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===S&&(S=void 0),void 0===y&&(y=!1),void 0===w&&(w=!1);var m={name:t,isEnabled:i,isGranular:a,hasAllowedSecurityGroups:n,hasDeniedSecurityGroups:o,parentId:s,isError:r,errorSource:c,errorCode:l,errorMessage:d,activityName:g,activityId:p,isDebug:v,isCancelled:h,pingLatency:S,isAppInactive:y,isInCapacity:w},f={name:"PBI.Settings.UpdateTenantSetting",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({name:m.name,isEnabled:m.isEnabled,isGranular:m.isGranular,hasAllowedSecurityGroups:m.hasAllowedSecurityGroups,hasDeniedSecurityGroups:m.hasDeniedSecurityGroups,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.SettingsUpdateTenantSettingLoggers};return f}function c(t,i,a,n,o,s,r,c,l,d,g,p,v){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===g&&(g=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1);var h={numberOfDataClassifications:t,parentId:i,isError:a,errorSource:n,errorCode:o,errorMessage:s,activityName:r,activityId:c,isDebug:l,isCancelled:d,pingLatency:g,isAppInactive:p,isInCapacity:v},S={name:"PBI.Settings.UpdateDataClassifications",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numberOfDataClassifications:h.numberOfDataClassifications,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.SettingsUpdateDataClassificationsLoggers};return S}function l(t,i,a,n,o,s,r,c,l,d,g,p,v){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===o&&(o=void 0),void 0===s&&(s=void 0),void 0===r&&(r=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===g&&(g=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1);var h={adminPortalTab:t,parentId:i,isError:a,errorSource:n,errorCode:o,errorMessage:s,activityName:r,activityId:c,isDebug:l,isCancelled:d,pingLatency:g,isAppInactive:p,isInCapacity:v},S={name:"PBI.Settings.AdminPortalTabSelected",category:e.TelemetryCategory.Verbose,time:Date.now(),id:u.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({adminPortalTab:e.telemetry.AdminPortalTab[h.adminPortalTab],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.SettingsAdminPortalTabSelectedLoggers};return S}var d,u=jsCommon.Utility;!(function(e){e[e.None=0]="None",e[e.UsageMetrics=1]="UsageMetrics",e[e.ManageUsers=2]="ManageUsers",e[e.Auditing=3]="Auditing",e[e.TenantSettings=4]="TenantSettings",e[e.CapacitySettings=5]="CapacitySettings"})(d=t.AdminPortalTab||(t.AdminPortalTab={})),t.SettingsAdminAuditing=i,t.SettingsOpenGatewaySettings=a,t.SettingsGetUsageMetricsDashboardId=n,t.SettingsGetTenantSettings=o,t.SettingsUpdateTenantSettings=s,t.SettingsUpdateTenantSetting=r,t.SettingsUpdateDataClassifications=c,t.SettingsAdminPortalTabSelected=l})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(t){var i=[{name:"Gateways",blockType:1,consumerHostFlags:8},{name:"Gateway",blockType:1,consumerHostFlags:8},{name:"GatewaySettings",blockType:1,consumerHostFlags:8},{name:"GatewayAdministrators",blockType:1,consumerHostFlags:8},{name:"Datasource",blockType:1,consumerHostFlags:8},{name:"DatasourceSettings",blockType:1,consumerHostFlags:8},{name:"DatasourceUsers",blockType:1,consumerHostFlags:8},{name:"SelectGateway",blockType:1,consumerHostFlags:8},{name:"UpnMappingPane",blockType:2,consumerHostFlags:8},{name:"AdminPortal",blockType:2,consumerHostFlags:8},{name:"Auditing",blockType:2,consumerHostFlags:8},{name:"DataClassifications",blockType:2,consumerHostFlags:8},{name:"ManageUsers",blockType:2,consumerHostFlags:8},{name:"TenantSettingsContainer",blockType:2,consumerHostFlags:8},{name:"TenantSetting",blockType:2,consumerHostFlags:8},{name:"UsageMetrics",blockType:2,consumerHostFlags:8}];e.common.registerBuildingBlocksForHost(t,i,{directivesTarget:"powerbi.settings.directives",directivesMap:e.settings.directives,componentsTarget:"powerbi.settings.components",componentsMap:e.settings.components})}angular.module("powerbi.settings",[]),angular.module("powerbi.settings.directives",[]),angular.module("powerbi.settings.components",[]),angular.module("powerbi.settings.controllers",[]),angular.module("powerbi.settings",["powerbi.common","powerbi.connectivity","powerbi.settings.directives","powerbi.settings.controllers"]).factory("selectGatewayService",["$rootScope","$compile","gatewaysMetadataService","modalDialogService","localizationService",function(t,i,a,n,o){return e.settings.createSelectGatewayService(t,i,a,n,o)}]).factory("gatewaysMetadataHttpService",[function(){return e.connectivity.createGatewaysMetadataHttpService()}]).factory("gatewaysMetadataService",["promiseFactory","gatewaysMetadataHttpService","telemetryService","featureSwitchService",function(t,i,a,n){return e.connectivity.createGatewaysMetadataService(t,i,a,n)}]).factory("gatewayDataService",["gatewaysMetadataService","promiseFactory","featureSwitchService","moduleLoader",function(t,i,a,n){return e.settings.createGatewayDataService(t,i,a,n)}]).factory("adminPortalHttp",[function(){return e.settings.createAdminPortalHttpService()}]).factory("adminPortal",["promiseFactory","adminPortalHttp","localizationService","telemetryService","$interval",function(t,i,a,n,o){return e.settings.createAdminPortalService(t,i,a,n,o)}]),t.registerBuildingBlocksForHost=i})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/gatewaySettingsView.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(t.controllers.GatewaySettingsController)}return i})();i.GatewaySettings=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.switchToUserTabEventName="gatewaySettingsSwitchToUserTab",e.dataSourceCreatedEventName="gatewaySettingsDataSourceCreated",e.onDirtyGatewaySelectionChanging="gatewayOnDirtyGatewaySelectionChanging",e.onGatewaySelectionChanged="gatewayOnGatewaySelectionChanged",e.discardAddingDataSourceEventName="gatewaySettingsDiscardAddingDataSource",e.addDataSourceEventName="gatewayAddDataSource",e.gatewaySelectionAppliedEventName="gatewaySettingsGatewaySelectionApplied",e.gatewaySelectionDiscardedEventName="gatewaySettingsGatewaySelectionDiscarded",e.selectGatewayStatusReadyEventName="gatewaySettingsSelectGatewayStatusReady",e.showGatewayUserMappingPaneEventName="showGatewayUserMappingPaneEvent",e.hideGatewayUserMappingPaneEventName="hideGatewayUserMappingPaneEvent",e.DataSourceTypePrefix="SettingsDataSourceType_",e.AuthenticationMethodPrefix="SettingsAuthenticationMethod_",e.LabelPrefix="SettingsLabel_",e.ServerError_ModelHasNoPowerBIDMMoniker="ModelHasNoPowerBIDMMoniker",e.TenantSettingFormName="tenantSettingForm",e.DataClassificationsFormName="dataClassificationsForm",e.AdminPortalNavigationStateName="landing.adminPortal",e.PublishContentPackTenantSwitchId=9,e.ExternalSharingTenantSwitchId=11,e.ExternalSharingV2TenantSwitchId=12,e.PublishToWebTenantSwitchId=13,e.ExportDataTenantSwitchId=14,e.RScriptVisualTenantSwitchId=15,e.CortanaTenantSwitchId=16,e.ExportPowerPointTenantSwitchId=17,e.OnPremAnalayzeInExcelTenantSwitchId=18,e.TemplatePublishTenantSwitchId=19,e.AuditingTenantSwitchId=21,e.EsriVisualTenantSwitchId=23,e.PrintingTenantSwitchId=24,e.UsageMetricsTenantSwitchId=29;var t;!(function(e){e[e.ExportAndSharing=1]="ExportAndSharing",e[e.ContentPack=2]="ContentPack",e[e.Integration=3]="Integration",e[e.RVisuals=4]="RVisuals",e[e.Audit=5]="Audit",e[e.Dashboard=6]="Dashboard",e[e.Others=7]="Others"})(t=e.TenantSettingsGroupName||(e.TenantSettingsGroupName={})),e.TenantSettingsGroups=[t.ExportAndSharing,t.ContentPack,t.Integration,t.RVisuals,t.Audit,t.Dashboard,t.Others],e.TenantSettingGroupMapping={11:t.ExportAndSharing,12:t.ExportAndSharing,13:t.ExportAndSharing,14:t.ExportAndSharing,17:t.ExportAndSharing,24:t.ExportAndSharing,9:t.ContentPack,19:t.ContentPack,16:t.Integration,18:t.Integration,23:t.Integration,15:t.RVisuals,21:t.Audit,29:t.Audit}})(t=e.constants||(e.constants={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.DataSourceSettingsModel=t})(t=e.models||(e.models={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=e.common.models.EmailsListModel,a=(function(){function e(){this.pendingUsers=new i,this.editableUsers=[],this.isAdding=!1,this.isReloadingList=!1}return e})();t.DataSourceUserModel=a})(i=t.models||(t.models={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.common.contracts.gateway.CredentialType,n=e.common.contracts.gateway.DataSourceType,o=e.connectivity.models.GatewayTabSelectionType,s=e.common.contracts.gateway.GatewayStatus,r=(function(){function i(){}return i.convertSettingsGateways=function(e){var t=this;return _.map(e,(function(e){return t.convertGateway(e)}))},i.convertGateway=function(e){var t=this.getGatewayAnnotation(e);return{displayName:e.gatewayName,id:e.gatewayId,isLoadingDataSources:!1,isLoadingStatus:!1,status:this.convertGatewayStatus(e.gatewayStatus),dataSources:[],isExpanded:!1,description:e.gatewayDescription,enableAutoUpdate:!1,joinImprovmentProgram:!1,administrators:null,tabSelectionType:o.Settings,publicKey:e.gatewayPublicKey,isWaitingForGatewayUpdate:!1,isDirty:!1,contactInformationString:null,connectionError:null,originalValues:null,traceDetails:null,contextMenuItem:null,gatewayAnnotation:t,staticCapabilities:null}},i.convertDataSources=function(e){var t=this;return _.map(e,(function(e){return t.convertDataSource(e)}))},i.convertDataSource=function(e){var t={id:e.dataSourceId,displayName:e.dataSourceName,onPremGatewayRequired:e.onPremGatewayRequired,dataSourceType:e.dataSourceType,connectionInfo:this.convertConnectionDetails(e.connectionDetails,e.credentialDetails),users:null,tabSelectionType:o.Settings,singleSignOnType:e.singleSignOnType};return t.dataSourceAnnotation=this.convertDataSourceAnnotation(e.dataSourceAnnotation),t},i.convertDataSourceAnnotation=function(t){var i={dataSourceAnnotationUPNMapping:{connectionStringPropertyName:e.common.contracts.gateway.ConnectionStringPropertyName.EffectiveUserName,mappingRules:[]}};if(!t)return i;try{return JSON.parse(t)}catch(e){return i}},i.convertUsers=function(e,t){var i=[{accessRight:t,principalList:e}];return i},i.convertToPrincipalAccessEntry=function(e,t){var i=[{accessRight:t,principalList:e}];return i},i.convertDiscoverDataSourceFeaturesToDataSourceTypeOptions=function(e){for(var i=this,o=[],s=0,r=e.dataSourceTypes;s<r.length;s++){var c=r[s];if(!_.isEmpty(n[c.dataSourceType])){var l=_.map(c.dataSourceCredentialTypes,(function(e){return{id:e,name:i.getLocalizedString(t.constants.AuthenticationMethodPrefix,a[e])}})),d=_.map(c.dataSourceLabels,(function(e){return{name:e.name,displayName:i.getLocalizedString(t.constants.LabelPrefix,e.name),type:i.getLabelType(e.name)}}));o[c.dataSourceType]={id:c.dataSourceType,name:this.getLocalizedString(t.constants.DataSourceTypePrefix,n[c.dataSourceType]),labels:d,authenticationMethodOptions:l}}}return o},i.convertAuthenticationParametersToCredentialData=function(e){return _.map(e,(function(e){return{name:e.name,value:e.value}}))},i.convertConnectionDetails=function(e,t){return{connetionDetails:e,credentialDetails:t}},i.getGatewayAnnotation=function(e){if(e.gatewayAnnotation)try{return JSON.parse(e.gatewayAnnotation)}catch(e){return null}return null},i.convertGatewayStatus=function(t){return t===s.Live?e.connectivity.models.GatewayStatus.Live:e.connectivity.models.GatewayStatus.NotReachable},i.getLocalizedString=function(t,i){var a=i.length>0?i.charAt(0).toUpperCase()+i.slice(1):"",n=e.common.localize.get("SettingsDataSource_"+t+a);return n||(n=a),n},i.getLabelType=function(e){switch(e.toLocaleLowerCase()){case"url":case"sharepointsiteurl":return"url";default:return"text"}},i})();i.GatewayModelConverter=r})(i=t.models||(t.models={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e,t,i,a){this.modelId=e,this.selectedGatewayId=-1,this.title=null,this.showStatus=!0,this.showHeader=t,this.allowPersonalGateway=i,this.egwStatusLoaded=!1,this.isCloudScheduleRefresh=a,this.showNewPersonalGatewayAvailableMessage=!1,this.isDMTSPersonalGateway=!1}return e})();e.SelectGatewayModel=t})(t=e.models||(e.models={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(){this.featureSwitches=[],this.tenantSettingsGroups=[],this.dataClassifications=[]}return e})();e.TenantSettings=t;var i=(function(){function e(e,t,i){this.name=e,this.displayName=t,this.tenantSettings=i}return e})();e.TenantSettingsGroup=i;var a=(function(){function e(e){this.contract=e,this.id=e.switchId,this.name=e.switchName,this.isEnabled=e.isEnabled,this.isGranular=e.isGranular}return e.prototype.equals=function(e){return!(!e||e.id!==this.id)&&this.isEnabled===e.isEnabled},e})();e.TenantSetting=a;var n=(function(){function e(e){this.contract=e}return e})();e.UsageMetricsDashboard=n})(t=e.models||(e.models={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a,n=e.common.contracts.ADUserMetaDataObjectType,o=e.common.models.EmailsListModel,s=e.common.contracts.GroupType,r=t.constants.TenantSettingGroupMapping,c=t.constants.TenantSettingsGroupName,l=t.constants.TenantSettingsGroups;!(function(e){function t(e,t){for(var i=[],a=0,n=e;a<n.length;a++){var o=n[a],s=u(o,t);s&&i.push(s)}return i}function a(e,t){for(var a=new i.TenantSettings,n=[],o=0,s=e.featureSwitches;o<s.length;o++){var r=s[o],c=u(r,t);c&&n.push(c)}return a.featureSwitches=n,a.tenantSettingsGroups=h(n,t),a.dataClassifications=e.dataClassifications,a}function d(e,t,i){var a=[{displayName:e.get("UsageMetrics"),type:1,requiredPermissionRole:1},{displayName:e.get("AdminPortal_ManageUsers"),type:2,requiredPermissionRole:1},{displayName:e.get("AdminPortal_TenantSettings"),type:4,requiredPermissionRole:1}];return t.featureSwitches.adminAuditingEnabled&&i&&"undefined"!=typeof window.o365AdminAuditingPageUrl&&a.splice(2,0,{displayName:e.get("AdminPortal_Auditing"),type:3,requiredPermissionRole:1}),t.featureSwitches.adminCapacityEnabled&&a.splice(4,0,{displayName:e.get("CapacityAdmin_ManageCapacity"),type:5,requiredPermissionRole:0}),a}function u(e,t){var a=new i.TenantSetting(e);if(a.displayName=t.get("TenantSetting_"+a.name+"_Title"),a.description=t.getOptional("TenantSetting_"+a.name+"_Description"),a.privacy=g(a.name,t),a.group=r[a.id]||c.Others,a.allowedSecurityGroups=p(e.allowedSecurityGroups),a.deniedSecurityGroups=p(e.deniedSecurityGroups),a.enabledForSecurityGroupsInfoMessage=t.getOptional("TenantSetting_"+a.name+"_EnabledForSecurityGroupsInfoMessage"),a.disabledInfoMessage=t.getOptional("TenantSetting_"+a.name+"_DisabledInfoMessage"),a.displayName)return a}function g(e,t){var i,a="TenantSetting_"+e+"_Privacy";if(t.getOptional(a)){var n=t.getOptional("TenantSetting_"+e+"_PrivacyPolicyUrl"),o=t.getOptional("TenantSetting_"+e+"_PrivacyTermsUrl"),s=t.getOptional("TenantSetting_"+e+"_PrivacyLearnMoreUrl");return n&&o&&s&&(i={privacyPolicyUrl:n,termsOfUseUrl:o,learnMoreUrl:s}),{privacyKey:a,fragments:i}}}function p(e){var t=new o;return e&&(t.inputUserList=_.map(e,(function(e){return v(e)}))),t}function v(e){return{displayName:e.name,objectId:e.id,userPrincipalName:e.emailAddress,isSecurityGroup:!0,objectType:n.Group,groupType:e.emailAddress?s.EmailEnabledSecurityGroup:s.SecurityGroup}}function h(e,t){for(var a,n=[],o=0,s=l;o<s.length;o++){a=s[o];var r=S(e,a);if(0!==r.length||a===c.Dashboard){var d=t.get("TenantSettingsGroup_"+c[a]);n.push(new i.TenantSettingsGroup(a,d,r))}}return n}function S(e,t){return _.filter(e,(function(e){return e.group===t}))}e.convertTenantSettings=t,e.convertTenantSettingsV2=a,e.createAdminPortalOptions=d,e.convertTenantSetting=u})(a=i.AdminPortalModelFactory||(i.AdminPortalModelFactory={}))})(i=t.models||(t.models={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(e,i){this.scope=e,this.services=i;var a=i.gatewayDataService.selectedGatewayDatasource;a.dataSourceAnnotation&&a.dataSourceAnnotation.dataSourceAnnotationUPNMapping||(a.dataSourceAnnotation=t.models.GatewayModelConverter.convertDataSourceAnnotation("")),this.viewModel=_.cloneDeep(i.gatewayDataService.selectedGatewayDatasource.dataSourceAnnotation.dataSourceAnnotationUPNMapping),this.localizedOriginalName=i.localizationService.get("UpnMappingPane_OriginalName"),this.localizedNewName=i.localizationService.get("UpnMappingPane_NewName"),this.localizedResultOfApplyingMappingRule=i.localizationService.get("UpnMappingPane_AfterRuleAppliedPlaceHolder"),this.resetNewRule()}return i.createOptions=function(){return{additionalServices:["gatewayDataService","gatewaysMetadataService","localizationService","errorService","telemetryService","notificationToast"]}},i.prototype.addNewRule=function(){var e=this.newRule;this.viewModel.mappingRules.push({algorithm:e.algorithm,searchString:e.searchString,replacementString:e.replacementString}),this.resetNewRule()},i.prototype.deleteRule=function(){if(this.selectedRule){var e=this.viewModel.mappingRules.indexOf(this.selectedRule);this.viewModel.mappingRules.splice(e,1)}},i.prototype.testRule=function(){var e=this;this.testRuleOriginalName&&(this.isTestRuleRequestPending=!0,this.services.gatewaysMetadataService.getUPNMappingResult([this.testRuleOriginalName],this.viewModel).then((function(t){if(!_.isEmpty(t.upns)){var i=t.upns[0];e.testRuleNewName=i.result}}),(function(){e.services.errorService.error(e.services.localizationService.get("UpnMappingPane_FailToTestUPNRuleMessage"),"FailToTestUPNRuleMessage")})).finally((function(){e.isTestRuleRequestPending=!1})))},i.prototype.saveChangesAndExit=function(){var t=this;this.isUpdateDataSourceRequestPending=!0;var i=JSON.stringify({dataSourceAnnotationUPNMapping:{connectionStringPropertyName:this.viewModel.connectionStringPropertyName,mappingRules:this.viewModel.mappingRules}}),a=this.services.gatewayDataService.selectedGatewayDatasource,n=this.services.telemetryService.startEvent(e.telemetry.SettingsUpdateGatewayDatasourceUPNMapping);this.services.gatewaysMetadataService.updateDataSource(a.gateway.id,a.id,{dataSourceType:null,onPremGatewayRequired:null,connectionDetails:null,credentialDetails:null,dataSourceAnnotation:i,supportedAuthenticationTypes:null}).then((function(){a.dataSourceAnnotation.dataSourceAnnotationUPNMapping=_.cloneDeep(t.viewModel),t.closeUpnMappingPane(),t.services.notificationToast.notify({title:t.services.localizationService.get("UpnMappingPane_SuccessfulMessage"),notificationType:e.common.NotificationToastType.Info}),n.resolve()}),(function(){t.services.errorService.error(t.services.localizationService.get("UpnMappingPane_FailToUpdateMessage"),"FailToUpdateGatewayUPNMapping"),n.reject()})).finally((function(){t.isUpdateDataSourceRequestPending=!1}))},i.prototype.closeUpnMappingPane=function(){this.scope.$emit(t.constants.hideGatewayUserMappingPaneEventName)},i.prototype.selectPre=function(){var e=this.viewModel.mappingRules,t=e.indexOf(this.selectedRule);e.length>1&&t>0&&(this.selectedRule=e[t-1])},i.prototype.selectNext=function(){var e=this.viewModel.mappingRules,t=e.indexOf(this.selectedRule);e.length>1&&t<e.length-1&&(this.selectedRule=e[t+1])},i.prototype.resetNewRule=function(){this.newRule={algorithm:e.common.contracts.gateway.DataSourceAnnotationUPNMappingAlgorithm.SubstringReplacement,searchString:"",replacementString:""}},i})();i.UpnMappingPaneController=a})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.UpnMappingPane={templateUrl:"components/gateway/upnMappingPane/upnMappingPaneView.html",controller:e.common.createController(t.controllers.UpnMappingPaneController)}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(i,a){var n=this;this.services=a,this.services.appMetadataService.getAppMetadata().then((function(e){var i=n.services.featureSwitchService;return n.adminCapacityEnabled=i.featureSwitches.adminCapacityEnabled,n.adminAuditingEnabled=i.featureSwitches.adminAuditingEnabled&&e.clusterFeatureSwitches.clusterAuditingEnabled,n.services.localizationService.ensureLocalization((function(){n.options=t.models.AdminPortalModelFactory.createAdminPortalOptions(n.services.localizationService,n.services.featureSwitchService,e.clusterFeatureSwitches.clusterAuditingEnabled)})),n.services.userInfo.userMetadataPromise})).then((function(t){n.options=_.filter(n.options,(function(e){return n.isOptionAllowed(e)})),n.services.telemetryService.logEvent(e.telemetry.SettingsAdminPortalTabSelected,n.getSelectedTabTelemetryName()),n.showOptionsList=!0}))}return i.createOptions=function(){return{additionalServices:["appMetadataService","featureSwitchService","localizationService","navigation","telemetryService","userInfo"]}},i.prototype.onActiveOptionChanged=function(e){this.services.navigation.navigateToAdminPortal(e)},i.prototype.getCurrentAdminPortalSettingsTab=function(){var e=this.services.navigation.currentAdminPortalSettingsTab;return!e&&_.any(this.options)?this.options[0].type:e},i.prototype.isOptionAllowed=function(e){return 1!==e.requiredPermissionRole||this.services.userInfo.userMetadata.isTenantAdmin},i.prototype.getSelectedTabTelemetryName=function(){var t=this.getCurrentAdminPortalSettingsTab();switch(t){case 3:return e.telemetry.AdminPortalTab.Auditing;case 1:return e.telemetry.AdminPortalTab.UsageMetrics;case 2:return e.telemetry.AdminPortalTab.ManageUsers;case 4:return e.telemetry.AdminPortalTab.TenantSettings;case 5:return e.telemetry.AdminPortalTab.CapacitySettings;default:return e.telemetry.AdminPortalTab.None}},i})();i.AdminPortalController=a})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.AdminPortal={controller:e.common.createController(t.controllers.AdminPortalController),templateUrl:"components/adminPortal/adminPortal/adminPortal.html"}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(t,i){var a=this;this.scope=t,this.services=i;var n=this.services.$window;this.scope.auditingPageLanding=function(){n.open(window.o365AdminAuditingPageUrl,"_blank"),a.services.telemetryService.logEvent(e.telemetry.SettingsAdminAuditing)}}return t.createOptions=function(){return{additionalServices:["$window","telemetryService"]}},t})();t.AuditingController=i})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.Auditing={controller:e.common.createController(t.controllers.AuditingController),templateUrl:"components/adminPortal/auditing/auditing.html"}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.errorDetailsHelper,n=(function(){function n(e,t){this.services=t}return n.createOptions=function(){return{additionalServices:["adminPortal","errorService","localizationService","notificationToast","telemetryService"]}},n.prototype.$onInit=function(){this.showDetails=!1,this.lastSavedViewModel=_.cloneDeep(this.viewModel),this.refreshDataClassificationsForm()},n.prototype.$postLink=function(){var e=this;this.dataClassificationsForm.validate=function(){return e.validateDataClassifications()}},n.prototype.getFormName=function(){return t.constants.DataClassificationsFormName},n.prototype.toggleDetailsView=function(){this.showDetails=!this.showDetails},n.prototype.applyChanges=function(){return __awaiter(this,void 0,e.Promise,(function(){
var t,i,n,o,s;return __generator(this,(function(r){switch(r.label){case 0:if(t=this.validateDataClassifications(),i=this.services.localizationService,!t)return[3,5];n=this.services.notificationToast.notify({title:i.get("AdminPortal_TenantSettings_Saving_Title"),message:i.get("AdminPortal_TenantSettings_Saving_Message"),notificationType:e.common.NotificationToastType.Loading}),o=this.services.telemetryService.startEvent(e.telemetry.SettingsUpdateDataClassifications,this.viewModel.length),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.services.adminPortal.updateDataClassifications(this.viewModel,o.event)];case 2:return r.sent(),this.lastSavedViewModel=_.cloneDeep(this.viewModel),this.services.notificationToast.hide(n),this.services.notificationToast.notify({title:i.get("AdminPortal_TenantSettings_DataClassification_Changed"),message:i.get("AdminPortal_TenantSettings_Success_Message"),notificationType:e.common.NotificationToastType.Success}),o.resolve(),[3,4];case 3:return s=r.sent(),this.services.notificationToast.hide(n),this.services.errorService.error(i.get("AdminPortal_TenantSettings_Failure_Message"),"FailedToApplyDataClassificationsChanges",{requestId:s.requestId,statusCode:s.status.toString()}),o.reject(a.getTelemetryErrorDetails(s.error,s.status)),[3,4];case 4:this.refreshDataClassificationsForm(),this.dataClassificationsForm.$setPristine(),r.label=5;case 5:return[2]}}))}))},n.prototype.cancelChanges=function(){this.viewModel=_.cloneDeep(this.lastSavedViewModel),this.refreshDataClassificationsForm(),this.dataClassificationsForm.$setPristine()},n.prototype.setDefaultDataClassification=function(e){for(var t=0,i=this.viewModel.length;t<i;t++)this.viewModel[t].default=t===e;this.dataClassificationsForm.$setDirty()},n.prototype.onDataClassificationToggled=function(){this.isEnabled?this.addDataClassification():this.viewModel=[]},n.prototype.addDataClassification=function(){var t=this.viewModel;t.push(new e.common.models.DataClassification),1===t.length&&(t[0].default=!0),this.dataClassificationsForm.$setDirty()},n.prototype.removeDataClassification=function(e){var t=this.viewModel,i=t[e].default;t.splice(e,1),i&&t.length>0&&(t[0].default=!0),0===t.length&&(this.isEnabled=!1),this.dataClassificationsForm.$setDirty()},n.prototype.validateDataClassifications=function(){if(this.isEnabled){for(var e={},t=0,i=0,a=this.viewModel.length;i<a;i++){var n=this.viewModel[i];if(!n.name)return this.errorMessage=this.services.localizationService.get("AdminPortal_TenantSettings_DataClassificationTable_Error_MissingName"),!1;if(!n.shortHand||n.shortHand.length>4)return this.errorMessage=this.services.localizationService.get("AdminPortal_TenantSettings_DataClassificationTable_Error_MissingShortHand"),!1;if(n.url&&0!==n.url.indexOf("http://")&&0!==n.url.indexOf("https://"))return this.errorMessage=this.services.localizationService.get("AdminPortal_TenantSettings_DataClassificationTable_Error_WrongUrlFormat"),!1;n.default&&t++,e[n.shortHand]=e[n.shortHand]?e[n.shortHand]+1:1}if(this.viewModel.length>0&&1!==t)return this.errorMessage=this.services.localizationService.get("AdminPortal_TenantSettings_DataClassificationTable_Error_NoDefault"),!1;for(var o in e)if(e[o]>1)return this.errorMessage=this.services.localizationService.get("AdminPortal_TenantSettings_DataClassificationTable_Error_ShortHandMustBeUnique"),!1}return this.errorMessage=void 0,!0},n.prototype.refreshDataClassificationsForm=function(){this.updateIsEnabled(),this.updateGranularityState(),this.updateStatusMessage(),this.errorMessage=void 0},n.prototype.updateIsEnabled=function(){this.isEnabled=!_.isEmpty(this.viewModel)},n.prototype.updateGranularityState=function(){this.granularityState=this.isEnabled?i.TenantSettingGranularityState.EnabledForEntireOrganization:i.TenantSettingGranularityState.Disabled},n.prototype.updateStatusMessage=function(){this.statusMessage=this.services.localizationService.get("TenantSettingStatus_"+i.TenantSettingGranularityState[this.granularityState])},n})();i.DataClassificationsController=n})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.DataClassifications={bindings:{viewModel:"="},controller:e.common.createController(t.controllers.DataClassificationsController),templateUrl:"components/adminPortal/dataClassifications/dataClassifications.html"}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.common.constants,n=e.errorDetailsHelper,o=t.constants.TenantSettingsGroupName,s=(function(){function i(i,a){var n=this;this.scope=i,this.services=a,this.scope.tenantSettings=new t.models.TenantSettings,this.scope.isLoading=!0,this.scope.hasChanges=!1,this.prepareUnsupportedSettings(),this.scope.dataClassificationToggle={enabled:!1},this.scope.isDataClassificationFeatureEnabled=this.services.featureSwitchService.featureSwitches.dataClassificationEnabled,this.scope.areGranularTenantControlsEnabled=this.services.featureSwitchService.featureSwitches.granularTenantControls;var o=this.services.telemetryService.startEvent(e.telemetry.SettingsGetTenantSettings);this.services.featureSwitchService.featureSwitches.dataClassificationEnabled?this.services.adminPortal.getTenantSettingsV2(o.event).then((function(e){n.scope.tenantSettings.featureSwitches=n.filterOutUnsupportedFeaturesSettings(e.featureSwitches),n.scope.tenantSettings.tenantSettingsGroups=e.tenantSettingsGroups,n.scope.tenantSettings.dataClassifications=e.dataClassifications,n.originalSettings=_.cloneDeep(n.scope.tenantSettings),n.scope.dataClassificationToggle.enabled=e.dataClassifications.length>0,n.scope.isLoading=!1})):this.services.adminPortal.getTenantSettings(o.event).then((function(e){n.scope.tenantSettings.featureSwitches=n.filterOutUnsupportedFeaturesSettings(e),n.originalSettings=_.cloneDeep(n.scope.tenantSettings),n.scope.isLoading=!1})),this.scope.updateFormState=function(){return n.updateFormState()},this.scope.applyChanges=function(){return n.applyChanges()},this.scope.cancelChanges=function(){return n.cancelChanges()},this.scope.addDataClassification=function(){return n.addDataClassification()},this.scope.removeDataClassification=function(e){return n.removeDataClassification(e)},this.scope.onDataClassificationToggled=function(){return n.onDataClassificationToggled()},this.scope.setDefaultDataClassification=function(e){return n.setDefaultDataClassification(e)},this.scope.isDashboardGroup=function(e){return n.isDashboardGroup(e)},this.registerRouteStateChangeEvent()}return i.createOptions=function(){return{additionalServices:["adminPortal","appMetadataService","errorService","featureSwitchService","localizationService","notificationToast","navigation","telemetryService"]}},i.prototype.$onDestroy=function(){this.routeStateChangeUnsubscribe()},i.prototype.registerRouteStateChangeEvent=function(){var e=this;this.routeStateChangeUnsubscribe=this.services.rootScope.$on(a.navigation.stateChangeStart,(function(i,a,n,o,s){e.scope.areGranularTenantControlsEnabled&&o&&o.name===t.constants.AdminPortalNavigationStateName&&e.isTenantSettingsFormDirty()&&(e.showSavePrompt(a,n),i.preventDefault())}))},i.prototype.showSavePrompt=function(e,t){var i=this,a=this.services.errorService.control(),n=this.services.localizationService;this.isTenantSettingsFormValid()?a.showPrompt(n.get("AdminPortal_TenantSettings_UnappliedChangesWarning_Title"),n.get("AdminPortal_TenantSettings_UnappliedChangesWarning_Message"),[new InJs.ModalDialogAction(n.get("ModalDialogButtonText_ApplyAll"),function(n,o){a.hideDialog(),i.routeStateChangeUnsubscribe(),i.applyChangesAndNavigateAwayIfSuccess(e,t)}),new InJs.ModalDialogAction(n.get("ModalDialogButtonText_DiscardAll"),function(n,o){a.hideDialog(),i.routeStateChangeUnsubscribe(),i.tenantSettingsForm.$setPristine(),i.navigateAway(e,t)}),new InJs.ModalDialogAction(n.get("ModalDialogButtonText_Cancel"),function(e,t){a.hideDialog()})]):a.showPrompt(n.get("AdminPortal_TenantSettings_UnappliedChangesWithErrors_Title"),n.get("AdminPortal_TenantSettings_UnappliedChangesWithErrors_Message"),[new InJs.ModalDialogAction(n.get("ModalDialogButtonText_FixErrors"),function(e,t){a.hideDialog()}),new InJs.ModalDialogAction(n.get("ModalDialogButtonText_DiscardChanges"),function(n,o){a.hideDialog(),i.routeStateChangeUnsubscribe(),i.tenantSettingsForm.$setPristine(),i.navigateAway(e,t)})])},i.prototype.isTenantSettingsFormDirty=function(){var e=this;return this.getDataClassificationsForm().$dirty||void 0!==_.find(this.scope.tenantSettings.featureSwitches,(function(t){return e.getTenantSettingForm(t.id).$dirty}))},i.prototype.isTenantSettingsFormValid=function(){var e=this;return this.getDataClassificationsForm().validate()&&void 0===_.find(this.scope.tenantSettings.featureSwitches,(function(t){return!e.getTenantSettingForm(t.id).validate()}))},i.prototype.getDataClassificationsForm=function(){return this.tenantSettingsForm["$ctrl."+t.constants.DataClassificationsFormName]},i.prototype.getTenantSettingForm=function(e){return this.tenantSettingsForm["$ctrl."+t.constants.TenantSettingFormName+e]},i.prototype.navigateAway=function(e,t){e&&e.name&&this.services.navigation.stateService.go(e.name,t)},i.prototype.isDashboardGroup=function(e){return e===o.Dashboard},i.prototype.setDefaultDataClassification=function(e){for(var t=0,i=this.scope.tenantSettings.dataClassifications.length;t<i;t++)this.scope.tenantSettings.dataClassifications[t].default=t===e;this.updateFormState()},i.prototype.onDataClassificationToggled=function(){this.scope.dataClassificationToggle.enabled?this.addDataClassification():this.scope.tenantSettings.dataClassifications=[],this.updateFormState()},i.prototype.addDataClassification=function(){var t=this.scope.tenantSettings.dataClassifications;t.push(new e.common.models.DataClassification),1===t.length&&(t[0].default=!0),this.updateFormState()},i.prototype.removeDataClassification=function(e){var t=this.scope.tenantSettings.dataClassifications,i=t[e].default;t.splice(e,1),i&&t.length>0&&(t[0].default=!0),0===t.length&&(this.scope.dataClassificationToggle.enabled=!1),this.updateFormState()},i.prototype.prepareUnsupportedSettings=function(){var e=this;this.unsupportedSettings=[];var i=!1;this.services.appMetadataService.getAppMetadata().then((function(a){i=a.clusterFeatureSwitches.clusterAuditingEnabled;var n=e.services.featureSwitchService.featureSwitches;n.scriptVisualEnabled||e.unsupportedSettings.push(t.constants.RScriptVisualTenantSwitchId),n.exportReportToPowerPointEnabled||e.unsupportedSettings.push(t.constants.ExportPowerPointTenantSwitchId),n.adminAuditingEnabled&&i||e.unsupportedSettings.push(t.constants.AuditingTenantSwitchId),n.clientUsageMetricsEnabled||e.unsupportedSettings.push(t.constants.UsageMetricsTenantSwitchId)}))},i.prototype.filterOutUnsupportedFeaturesSettings=function(e){for(var t=[],i=0,a=e;i<a.length;i++){var n=a[i];this.unsupportedSettings.indexOf(n.id)===-1&&t.push(n)}return t},i.prototype.updateFormState=function(){this.checkChanges()},i.prototype.applyChanges=function(){var t=this;if(this.scope.hasChanges){for(var i=this.services.notificationToast.notify({title:this.services.localizationService.get("AdminPortal_TenantSettings_Saving_Title"),message:this.services.localizationService.get("AdminPortal_TenantSettings_Saving_Message"),notificationType:e.common.NotificationToastType.Loading}),a=0,n=this.scope.tenantSettings.featureSwitches.length;a<n;a++)this.scope.tenantSettings.featureSwitches[a].contract.isEnabled=this.scope.tenantSettings.featureSwitches[a].isEnabled;var o=this.isDataClassificationSettingChanged();if(!_.isEmpty(this.scope.tenantSettings)){var s=this.services.telemetryService.startEvent(e.telemetry.SettingsUpdateTenantSettings);this.services.featureSwitchService.featureSwitches.dataClassificationEnabled?this.services.adminPortal.updateTenantSettingsConfigV2(this.scope.tenantSettings,s.event).then((function(){t.services.notificationToast.hide(i);for(var a=function(i,a){var n=t.scope.tenantSettings.featureSwitches[i],o=_.find(t.originalSettings.featureSwitches,(function(e){return e.id===n.id}));n.isEnabled!==o.isEnabled&&(o.isEnabled=n.isEnabled,t.services.telemetryService.logEvent(e.telemetry.SettingsUpdateTenantSetting,n.name,n.isEnabled,!1,!1,!1),t.services.notificationToast.notify({title:t.getSaveSuccessTitle(n),message:t.services.localizationService.get("AdminPortal_TenantSettings_Success_Message"),notificationType:e.common.NotificationToastType.Success}))},n=0,r=t.scope.tenantSettings.featureSwitches.length;n<r;n++)a(n,r);o&&(t.services.telemetryService.logEvent(e.telemetry.SettingsUpdateTenantSetting,"dataClassification",t.scope.tenantSettings.dataClassifications.length>0,!1,!1,!1),t.services.notificationToast.notify({title:t.services.localizationService.get("AdminPortal_TenantSettings_DataClassification_Changed"),message:t.services.localizationService.get("AdminPortal_TenantSettings_Success_Message"),notificationType:e.common.NotificationToastType.Success})),t.originalSettings.dataClassifications=_.cloneDeep(t.scope.tenantSettings.dataClassifications),s.resolve()}),(function(){t.services.notificationToast.hide(i),t.services.notificationToast.notify({title:t.services.localizationService.get("AdminPortal_TenantSettings_Failure_Title"),message:t.services.localizationService.get("AdminPortal_TenantSettings_Failure_Message"),notificationType:e.common.NotificationToastType.Error}),s.reject()})).finally((function(){t.checkChanges()})):this.services.adminPortal.updateTenantSettingsConfig(this.scope.tenantSettings.featureSwitches,s.event).then((function(){t.services.notificationToast.hide(i);for(var a=function(i,a){var n=t.scope.tenantSettings.featureSwitches[i],o=_.find(t.originalSettings.featureSwitches,(function(e){return e.id===n.id}));n.isEnabled!==o.isEnabled&&(o.isEnabled=n.isEnabled,t.services.telemetryService.logEvent(e.telemetry.SettingsUpdateTenantSetting,n.name,n.isEnabled,!1,!1,!1),t.services.notificationToast.notify({title:t.getSaveSuccessTitle(n),message:t.services.localizationService.get("AdminPortal_TenantSettings_Success_Message"),notificationType:e.common.NotificationToastType.Success}))},n=0,o=t.scope.tenantSettings.featureSwitches.length;n<o;n++)a(n,o);t.originalSettings.dataClassifications=_.cloneDeep(t.scope.tenantSettings.dataClassifications),s.resolve()}),(function(){t.services.notificationToast.hide(i),t.services.notificationToast.notify({title:t.services.localizationService.get("AdminPortal_TenantSettings_Failure_Title"),message:t.services.localizationService.get("AdminPortal_TenantSettings_Failure_Message"),notificationType:e.common.NotificationToastType.Error}),s.reject()})).finally((function(){t.checkChanges()}))}}},i.prototype.applyChangesAndNavigateAwayIfSuccess=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var a,o,s,r,c,l,d,u,g=this;return __generator(this,(function(p){switch(p.label){case 0:a=this.services.notificationToast.notify({title:this.services.localizationService.get("AdminPortal_TenantSettings_Saving_Title"),message:this.services.localizationService.get("AdminPortal_TenantSettings_Saving_Message"),notificationType:e.common.NotificationToastType.Loading}),o=this.services.telemetryService.startEvent(e.telemetry.SettingsUpdateTenantSettings),s=this.getDataClassificationsForm().$dirty?this.scope.tenantSettings.dataClassifications:void 0,r=_.filter(this.scope.tenantSettings.featureSwitches,(function(e){return g.getTenantSettingForm(e.id).$dirty})),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.services.adminPortal.updateTenantSettingsAndDataClassifications(r,s,o.event)];case 2:for(p.sent(),this.services.notificationToast.hide(a),this.services.notificationToast.notify({title:this.services.localizationService.get("TenantSetting_SavingSucceededNotification_Title"),message:this.services.localizationService.get("TenantSetting_SavingNotification_Message"),notificationType:e.common.NotificationToastType.Success}),c=0,l=r;c<l.length;c++)d=l[c],this.services.telemetryService.logEvent(e.telemetry.SettingsUpdateTenantSetting,d.name,d.isEnabled,d.isGranular,d.allowedSecurityGroups&&!_.isEmpty(d.allowedSecurityGroups.inputUserList),d.deniedSecurityGroups&&!_.isEmpty(d.deniedSecurityGroups.inputUserList));return s&&this.services.telemetryService.logEvent(e.telemetry.SettingsUpdateDataClassifications,s.length),o.resolve(),this.tenantSettingsForm.$setPristine(),this.navigateAway(t,i),[3,4];case 3:return u=p.sent(),this.services.notificationToast.hide(a),this.services.errorService.error(this.services.localizationService.get("AdminPortal_TenantSettings_Failure_Message"),"FailedToApplyTenantSettingsChanges",{requestId:u.requestId,statusCode:u.status.toString()}),o.reject(n.getTelemetryErrorDetails(u.error,u.status)),[3,4];case 4:return[2]}}))}))},i.prototype.cancelChanges=function(){_.isEmpty(this.scope.tenantSettings)||(this.scope.tenantSettings=_.cloneDeep(this.originalSettings),this.scope.dataClassificationToggle.enabled=this.scope.tenantSettings.dataClassifications.length>0),this.scope.hasChanges=!1},i.prototype.checkChanges=function(){this.scope.hasChanges=!1;for(var e=function(e,i){var a=t.scope.tenantSettings.featureSwitches[e],n=_.find(t.originalSettings.featureSwitches,(function(e){return e.id===a.id}));if(a.isEnabled!==n.isEnabled)return t.scope.hasChanges=!0,{value:void 0}},t=this,i=0,a=this.scope.tenantSettings.featureSwitches.length;i<a;i++){var n=e(i,a);if("object"==typeof n)return n.value}if(this.isDataClassificationSettingChanged()){this.scope.hasChanges=!0;for(var o={},s=0,i=0,a=this.scope.tenantSettings.dataClassifications.length;i<a;i++){var r=this.scope.tenantSettings.dataClassifications[i];if(!r.name||!r.shortHand||r.shortHand.length>4)return void(this.scope.hasChanges=!1);if(r.url&&0!==r.url.indexOf("http://")&&r.url.indexOf("https://"))return void(this.scope.hasChanges=!1);r.default&&s++,o[r.shortHand]=o[r.shortHand]?o[r.shortHand]+1:1}if(this.scope.tenantSettings.dataClassifications.length>0&&1!==s)return void(this.scope.hasChanges=!1);for(var c in o)if(o[c]>1)return void(this.scope.hasChanges=!1)}},i.prototype.isDataClassificationSettingChanged=function(){if(this.scope.tenantSettings.dataClassifications.length!==this.originalSettings.dataClassifications.length)return!0;for(var e=function(e,i){var a=t.scope.tenantSettings.dataClassifications[e],n=_.find(t.originalSettings.dataClassifications,(function(e){return e.id===a.id}));for(var o in a)if("$$hashKey"!==o&&void 0!==n[o]&&a[o]!==n[o])return{value:!0}},t=this,i=0,a=this.scope.tenantSettings.dataClassifications.length;i<a;i++){var n=e(i,a);if("object"==typeof n)return n.value}return!1},i.prototype.getSaveSuccessTitle=function(e){if(e)return this.services.localizationService.format("AdminPortal_TenantSettings_Success_RadioButton_Title",[e.name,e.isEnabled?this.services.localizationService.get("AdminPortal_TenantSettings_ButtonText_Enabled"):this.services.localizationService.get("AdminPortal_TenantSettings_RadioButton_Disabled")])},i})();i.TenantSettingsContainerController=s})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.TenantSettingsContainer={controller:e.common.createController(t.controllers.TenantSettingsContainerController),templateUrl:"components/adminPortal/tenantSettingsContainer/tenantSettingsContainer.html"}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a,n=t.models.AdminPortalModelFactory,o=e.errorDetailsHelper,s=e.common.models.EmailsListModel;!(function(e){e[e.Disabled=1]="Disabled",e[e.EnabledForEntireOrganization=2]="EnabledForEntireOrganization",e[e.EnabledForSpecificSecurityGroups=3]="EnabledForSpecificSecurityGroups"})(a=i.TenantSettingGranularityState||(i.TenantSettingGranularityState={}));var r=(function(){function i(e,t){this.services=t}return i.createOptions=function(){return{additionalServices:["adminPortal","errorService","localizationService","notificationToast","telemetryService"]}},i.prototype.$onInit=function(){this.showDetails=!1,this.refreshTenantSettingForm()},i.prototype.$postLink=function(){var e=this;this.tenantSettingForm=this[this.getFormName()],this.tenantSettingForm.validate=function(){return e.validateTenantSettingForm(e.services.localizationService)}},i.prototype.getFormName=function(){return t.constants.TenantSettingFormName+this.viewModel.id},i.prototype.toggleDetailsView=function(){this.showDetails=!this.showDetails},i.prototype.onEnabledToggleChange=function(){this.viewModel.isEnabled||(this.viewModel.allowedSecurityGroups=new s,this.viewModel.deniedSecurityGroups=new s),this.refreshTenantSettingForm()},i.prototype.onDeniedSecurityGroupsCheckboxChanged=function(){this.deniedSecurityGroupsEnabled||(this.viewModel.deniedSecurityGroups=new s)},i.prototype.onRadioGroupSelectionChanged=function(){this.granularityState===a.EnabledForEntireOrganization&&(this.viewModel.allowedSecurityGroups=new s)},i.prototype.applyChanges=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,a,n,s,r;return __generator(this,(function(c){switch(c.label){case 0:if(t=this.services.localizationService,!this.validateTenantSettingForm(t))return[2];i=this.services.notificationToast.notify({title:t.get("TenantSetting_SavingNotification_Title"),message:t.get("TenantSetting_SavingNotification_Message"),notificationType:e.common.NotificationToastType.Loading}),a=this.viewModel,n=this.services.telemetryService.startEvent(e.telemetry.SettingsUpdateTenantSetting,a.name,a.isEnabled,a.isGranular,this.hasAllowedSecurityGroups(),this.hasDeniedSecurityGroups()),s=_.cloneDeep(this.viewModel.contract),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.services.adminPortal.updateTenantSetting(a,n.event)];case 2:return c.sent(),this.services.notificationToast.hide(i),this.services.notificationToast.notify({title:t.get("TenantSetting_SavingSucceededNotification_Title"),message:t.get("TenantSetting_SavingNotification_Message"),notificationType:e.common.NotificationToastType.Success}),n.resolve(),[3,4];case 3:return r=c.sent(),this.services.notificationToast.hide(i),this.viewModel.contract=s,this.services.errorService.error(this.services.localizationService.get("TenantSetting_SavingFailedNotification_Message"),"FailedToApplyTenantSettingsChanges",{requestId:r.requestId,statusCode:r.status.toString()}),n.reject(o.getTelemetryErrorDetails(r.error,r.status)),[3,4];case 4:return this.refreshTenantSettingForm(),this.tenantSettingForm.$setPristine(),[2]}}))}))},i.prototype.cancelChanges=function(){this.viewModel=n.convertTenantSetting(this.viewModel.contract,this.services.localizationService),this.refreshTenantSettingForm(),this.tenantSettingForm.$setPristine()},i.prototype.showDisabledInfoMessage=function(){return this.viewModel.disabledInfoMessage&&this.tenantSettingForm.$dirty&&!this.viewModel.isEnabled},i.prototype.showEnabledForSecurityGroupsInfoMessage=function(){return this.viewModel.enabledForSecurityGroupsInfoMessage&&(this.granularityState===a.EnabledForSpecificSecurityGroups||this.deniedSecurityGroupsEnabled)},i.prototype.validateTenantSettingForm=function(e){var t=this.viewModel.allowedSecurityGroups,i=this.viewModel.deniedSecurityGroups;if(this.granularityState===a.EnabledForSpecificSecurityGroups&&t.validationTrigger&&!t.validationTrigger())return!1;if(this.deniedSecurityGroupsEnabled&&i.validationTrigger&&!i.validationTrigger())return!1;if(this.granularityState===a.EnabledForSpecificSecurityGroups&&this.deniedSecurityGroupsEnabled)for(var n=_.map(t.inputUserList,(function(e){return e.objectId})),o=_.map(i.inputUserList,(function(e){return e.objectId})),s=_.zipObject(o,o),r=0,c=n;r<c.length;r++){var l=c[r];if(s[l])return i.errorMessage=e.get("TenantSetting_DuplicateAllowedAndDeniedSecurityGroup"),i.hasValidationError=!0,!1}return!0},i.prototype.refreshTenantSettingForm=function(){this.updateGranularityState(),this.updateStatusMessage(),this.updateDeniedSecurityGroupsEnabled()},i.prototype.updateDeniedSecurityGroupsEnabled=function(){this.deniedSecurityGroupsEnabled=this.hasDeniedSecurityGroups()},i.prototype.updateGranularityState=function(){this.viewModel.isEnabled?this.hasAllowedSecurityGroups()?this.granularityState=a.EnabledForSpecificSecurityGroups:this.granularityState=a.EnabledForEntireOrganization:this.granularityState=a.Disabled},i.prototype.updateStatusMessage=function(){var e=this.services.localizationService;this.granularityState===a.EnabledForEntireOrganization&&this.hasDeniedSecurityGroups()?this.statusMessage=e.get("TenantSettingStatus_EnabledForSpecificSecurityGroups"):this.statusMessage=e.get("TenantSettingStatus_"+a[this.granularityState])},i.prototype.hasAllowedSecurityGroups=function(){return this.viewModel.allowedSecurityGroups&&!_.isEmpty(this.viewModel.allowedSecurityGroups.inputUserList)},i.prototype.hasDeniedSecurityGroups=function(){return this.viewModel.deniedSecurityGroups&&!_.isEmpty(this.viewModel.deniedSecurityGroups.inputUserList)},i})();i.TenantSettingController=r})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.TenantSetting={bindings:{viewModel:"<"},controller:e.common.createController(t.controllers.TenantSettingController),templateUrl:"components/adminPortal/tenantSetting/tenantSetting.html"}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.scope=e,this.services=t,this.scope.o365AdminUserPageUrl=window.o365AdminUserPageUrl}return e.createOptions=function(){return{additionalServices:["errorService","localizationService","adminPortal"]}},e})();e.ManageUsersController=t})(t=e.controllers||(e.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){i.ManageUsers={controller:e.common.createController(t.controllers.ManageUsersController),templateUrl:"components/adminPortal/manageUsers/manageUsers.html"}})(i=t.components||(t.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.UsageMetrics={templateUrl:"components/adminPortal/usageMetrics/usageMetrics.html"}})(t=e.components||(e.components={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.scope.onTabSelected=function(e){return a.onTabSelected(e)},this.scope.$on(t.constants.switchToUserTabEventName,(function(e){return a.switchToUserTabListener(e)}))}return i.prototype.switchToUserTabListener=function(t){t.stopPropagation(),this.onTabSelected(e.connectivity.models.GatewayTabSelectionType.Users)},i.prototype.onTabSelected=function(e){this.scope.viewModel.tabSelectionType=e},i})();i.DataSourceController=a})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.common.contracts.gateway.CredentialType,n=e.common.contracts.gateway.DataSourceType,o=e.common.EncryptionContext,s=e.common.contracts.gateway.GatewayStaticCapabilities,r=e.common.contracts.gateway.PrivacyLevel,c=e.common.contracts.gateway.SingleSignOnType,l=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.viewModel=this.scope.viewModel=new t.models.DataSourceSettingsModel,this.viewModel.isLoadingForm=!0,this.viewModel.advancedSettingsExpanded=!1,this.initEntropy(),this.initializePlaceholder(),this.initViewModelOptions().then((function(){a.loadViewModelData(),a.startWatchFormControl(),a.startWatchDataSourceModel()})),this.scope.tryDiscardChanges=function(){return a.tryDiscardChanges()},this.scope.tryAddDataSource=function(){return a.tryAddDataSource()},this.scope.tryApplyChanges=function(){return a.tryApplyChanges()},this.scope.switchToUserTab=function(){return a.switchToUserTab()},this.scope.onAuthenticationParameter1Change=function(){return a.onAuthenticationParameter1Change()},this.scope.onAuthenticationParameter1Focus=function(){return a.onAuthenticationParameter1Focus()},this.scope.onAuthenticationParameter1Blur=function(){return a.onAuthenticationParameter1Blur()},this.scope.onAuthenticationParameter2Change=function(){return a.onAuthenticationParameter2Change()},this.scope.onAuthenticationParameter2Focus=function(){return a.onAuthenticationParameter2Focus()},this.scope.onAuthenticationParameter2Blur=function(){return a.onAuthenticationParameter2Blur()},this.scope.onDataSourceTypeChange=function(){return a.onDataSourceTypeChange()},this.scope.onAuthenticationMethodChange=function(){return a.onAuthenticationMethodChange()},this.scope.enterpriseGatewayETLEnabled=this.services.featureSwitchService.featureSwitches.enterpriseGatewayETLEnabled,this.scope.allowSingleSignOn=function(){return a.allowSingleSignOn()},this.scope.onSingleSignOnSettingChange=function(){return a.onSingleSignOnSettingChange()}}return i.createOptions=function(){return{additionalServices:["errorService","featureSwitchService","localizationService","gatewaysMetadataService","promiseFactory","gatewayDataService"]}},i.prototype.initializePlaceholder=function(){i.Placeholder||("Google Inc."===navigator.vendor?i.Placeholder="••••••••••••":i.Placeholder="●●●●●●●●●●●●")},i.prototype.initEntropy=function(){var e=this;this.services.gatewaysMetadataService.getEntropy().then((function(t){if(e.entropy=[],t)for(var i=atob(t),a=i.length,n=0;n<a;n++)e.entropy.push(i.charCodeAt(n));else e.entropy=o.generateEntropy()}),(function(e){}))},i.prototype.initViewModelOptions=function(){var e=this,i=this.services.promiseFactory.defer();return this.services.gatewaysMetadataService.discoverDataSourceFeatures().then((function(i){e.viewModel.dataSourceTypeOptions=t.models.GatewayModelConverter.convertDiscoverDataSourceFeaturesToDataSourceTypeOptions(i)}),(function(e){})).finally((function(){i.resolve(null)})),i.promise},i.prototype.startWatchFormControl=function(){var e=this,t=this.scope.$watch("settingsForm",(function(i){i&&(e.scope.dataSourceModel.isDirty=function(){return i.$dirty},e.viewModel.isAddingDataSource&&e.scope.settingsForm.$setDirty(),t())}))},i.prototype.startWatchDataSourceModel=function(){var e=this;this.scope.$watch("dataSourceModel",(function(t,i){i!==t&&(e.loadViewModelData(),e.scope.dataSourceModel.isDirty=function(){return e.scope.settingsForm.$dirty})}))},i.prototype.loadViewModelData=function(){var e=this.scope.dataSourceModel,t=this.viewModel,a=t.isAddingDataSource=e.id<0,n=a?void 0:e.connectionInfo.credentialDetails.credentialType,o=a?void 0:JSON.parse(e.connectionInfo.connetionDetails);if(t.editableSettings={dataSourceName:e.displayName,dataSourceType:e.dataSourceType,authenticationMethod:n,authenticationParameters:a?this.initAuthenticationParameters(e.dataSourceType,n):this.initAuthenticationParameters(e.dataSourceType,n,[i.Placeholder,i.Placeholder]),authenticationParameter1Edited:!1,authenticationParameter2Edited:!1,privacyLevel:a?r.Organizational:e.connectionInfo.credentialDetails.privacyLevel,singleSignOnType:e.singleSignOnType},!a)for(var s=0,l=this.viewModel.dataSourceTypeOptions[e.dataSourceType].labels;s<l.length;s++){var d=l[s];t.editableSettings[d.name]=o[d.name]}t.waitingForDataSourceStatus=!1,t.hasTestConnectionFailure=!1,t.isLoadingForm=!1,t.messageState=0,e.compositeErrorMessage="",this.scope.settingsForm&&(a?this.scope.settingsForm.$setDirty():this.scope.settingsForm.$setPristine()),t.isSingleSignOnEnabled=null!=e.singleSignOnType&&e.singleSignOnType!==c.None,this.isSingleSignOnOptionChanged=!1},i.prototype.getUserNameLabel=function(t){return t===e.common.contracts.gateway.DataSourceType.File||t===e.common.contracts.gateway.DataSourceType.Folder?this.services.localizationService.get("SettingsDataSource_SettingsWindowsUsername"):this.services.localizationService.get("SettingsDataSource_SettingsUsername");
},i.prototype.getPasswordLabel=function(t){return t===e.common.contracts.gateway.DataSourceType.File||t===e.common.contracts.gateway.DataSourceType.Folder?this.services.localizationService.get("SettingsDataSource_SettingsWindowsPassword"):this.services.localizationService.get("SettingsDataSource_SettingsPassword")},i.prototype.initAuthenticationParameters=function(e,t,i){var n=[];if(null!=t)switch(t){case a.NotSpecified:case a.Anonymous:break;case a.Basic:case a.Windows:i||(i=["",""]),n.push({name:"username",value:i[0],displayName:this.getUserNameLabel(e),shouldDisplay:!0}),n.push({name:"password",value:i[1],displayName:this.getPasswordLabel(e),shouldDisplay:!0})}return n},i.prototype.getDefaultAuthenticationMethod=function(){var e=this.viewModel.editableSettings,t=this.viewModel.dataSourceTypeOptions[e.dataSourceType].authenticationMethodOptions;if(1===t.length)return t[0].id},i.prototype.onDataSourceTypeChange=function(){for(var e=this.viewModel.editableSettings,t=this.getDefaultAuthenticationMethod(),i=0,a=this.viewModel.dataSourceTypeOptions[e.dataSourceType].labels;i<a.length;i++){var n=a[i];e[n.name]=""}e.authenticationMethod=t,e.authenticationParameters=this.initAuthenticationParameters(this.viewModel.dataSourceTypeOptions[e.dataSourceType].id,t),e.authenticationParameter1Edited=!1,e.authenticationParameter2Edited=!1},i.prototype.onAuthenticationMethodChange=function(){this.scope.viewModel.editableSettings.authenticationParameters=this.initAuthenticationParameters(this.scope.viewModel.dataSourceTypeOptions[this.scope.viewModel.editableSettings.dataSourceType].id,this.scope.viewModel.editableSettings.authenticationMethod,["",""]),this.scope.viewModel.editableSettings.authenticationParameter1Edited=!0,this.scope.viewModel.editableSettings.authenticationParameter2Edited=!0},i.prototype.tryDiscardChanges=function(){var e=this;this.showDiscardPopup().then((function(){e.viewModel.isAddingDataSource?e.scope.$emit(t.constants.discardAddingDataSourceEventName):e.loadViewModelData()}))},i.prototype.showDiscardPopup=function(){var e=this.services.promiseFactory.defer(),t=this.services.errorService,i=t.control(),a=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_YesOption"),n=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_CancelOption"),o=[new InJs.ModalDialogAction(a,function(t,a){i.hideDialog(),e.resolve(null)}),new InJs.ModalDialogAction(n,function(t,a){i.hideDialog(),e.reject()})],s=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_Title"),r=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_DataSourceMessage");return i.showCustomDialog(s,$("<div/>").text(r),o,(function(e){e.parent().find('input[value="'+n+'"]').focus()}),!0,!0),e.promise},i.prototype.onAuthenticationParameter1Change=function(){this.viewModel.editableSettings.authenticationParameters.length>1&&!this.viewModel.editableSettings.authenticationParameter2Edited&&(this.viewModel.editableSettings.authenticationParameters[1].value="",this.viewModel.editableSettings.authenticationParameter2Edited=!0),this.viewModel.editableSettings.authenticationParameter1Edited=!0},i.prototype.onAuthenticationParameter1Focus=function(){this.viewModel.isAddingDataSource||this.viewModel.editableSettings.authenticationParameter1Edited||(this.viewModel.editableSettings.authenticationParameters[0].value="")},i.prototype.onAuthenticationParameter1Blur=function(){this.viewModel.isAddingDataSource||this.viewModel.editableSettings.authenticationParameter1Edited||(this.viewModel.editableSettings.authenticationParameters[0].value=i.Placeholder)},i.prototype.onAuthenticationParameter2Change=function(){this.viewModel.editableSettings.authenticationParameter1Edited||(this.viewModel.editableSettings.authenticationParameters[0].value="",this.viewModel.editableSettings.authenticationParameter1Edited=!0),this.viewModel.editableSettings.authenticationParameter2Edited=!0},i.prototype.onAuthenticationParameter2Focus=function(){this.viewModel.isAddingDataSource||this.viewModel.editableSettings.authenticationParameter2Edited||(this.viewModel.editableSettings.authenticationParameters[1].value="")},i.prototype.onAuthenticationParameter2Blur=function(){this.viewModel.isAddingDataSource||this.viewModel.editableSettings.authenticationParameter2Edited||(this.viewModel.editableSettings.authenticationParameters[1].value=i.Placeholder)},i.prototype.isDataSourceNameUnique=function(e,t){return!_.find(this.scope.dataSourceModel.gateway.dataSources,(function(i){return i.displayName===e&&i!==t}))},i.prototype.tryAddDataSource=function(){var e=this;if(this.isFormValid()){var i=this.scope.dataSourceModel,a=this.viewModel.editableSettings,n=i.gateway,o=this.services.gatewayDataService.getDecodedPublicKey(i.gateway.publicKey),s={credentialData:t.models.GatewayModelConverter.convertAuthenticationParametersToCredentialData(this.viewModel.editableSettings.authenticationParameters)};this.services.gatewayDataService.encryptCredentials(s,o,a.authenticationMethod,this.entropy).then((function(i){e.viewModel.waitingForDataSourceStatus=!0,i.privacyLevel=a.privacyLevel;var o={dataSourceName:a.dataSourceName,dataSourceType:a.dataSourceType,onPremGatewayRequired:!0,connectionDetails:e.getConnectionDetailsString(),credentialDetails:i,supportedAuthenticationTypes:null,singleSignOnType:e.viewModel.singleSignOnType};e.services.gatewayDataService.createDataSourceWithRetry(n,o,a.authenticationParameters,e.entropy).then((function(i){e.viewModel.waitingForDataSourceStatus=!1,e.scope.dataSourceModel.id=i.dataSourceId,e.scope.dataSourceModel.displayName=i.dataSourceName,e.scope.dataSourceModel.dataSourceType=i.dataSourceType,e.scope.dataSourceModel.connectionInfo.connetionDetails=i.connectionDetails,e.scope.dataSourceModel.connectionInfo.credentialDetails=i.credentialDetails,e.scope.dataSourceModel.dataSourceAnnotation=t.models.GatewayModelConverter.convertDataSourceAnnotation(""),e.scope.dataSourceModel.singleSignOnType=i.singleSignOnType,e.loadViewModelData(),e.scope.dataSourceModel.connected=!0,e.scope.dataSourceModel.connectionError=null,e.viewModel.messageState=1,e.scope.$emit(t.constants.dataSourceCreatedEventName,[i.dataSourceId])}),(function(t){e.showDataSourceError(t),e.scope.dataSourceModel.connected=!1}))}))}},i.prototype.tryApplyChanges=function(){var e=this;if(this.isFormValid()){var i=this.scope.dataSourceModel,a=this.viewModel.editableSettings,n=i.gateway,o=i.id;if(this.isSingleSignOnOptionChanged&&this.allowSingleSignOn()&&this.services.gatewaysMetadataService.updateDataSource(n.id,o,{dataSourceType:null,onPremGatewayRequired:null,connectionDetails:null,credentialDetails:null,dataSourceAnnotation:null,supportedAuthenticationTypes:null,singleSignOnType:this.viewModel.singleSignOnType}).then((function(){e.scope.dataSourceModel.singleSignOnType=e.viewModel.singleSignOnType,e.isCredentialsEdited()?e.isSingleSignOnOptionChanged=!1:e.loadViewModelData()}),(function(t){e.showDataSourceError(t)})),this.isCredentialsEdited()){var s=this.services.gatewayDataService.getDecodedPublicKey(i.gateway.publicKey),r={credentialData:t.models.GatewayModelConverter.convertAuthenticationParametersToCredentialData(this.viewModel.editableSettings.authenticationParameters)};this.services.gatewayDataService.encryptCredentials(r,s,a.authenticationMethod,this.entropy).then((function(t){e.viewModel.waitingForDataSourceStatus=!0,t.privacyLevel=a.privacyLevel,e.services.gatewayDataService.updateCredentialsWithRetry(n,o,a.authenticationParameters,t,e.entropy).then((function(){e.viewModel.waitingForDataSourceStatus=!1,e.scope.dataSourceModel.connectionInfo.credentialDetails.credentialType=e.viewModel.editableSettings.authenticationMethod,e.scope.dataSourceModel.connectionInfo.credentialDetails.privacyLevel=e.viewModel.editableSettings.privacyLevel,e.loadViewModelData(),e.scope.dataSourceModel.connected=!0,e.scope.dataSourceModel.connectionError=null}),(function(t){e.showDataSourceError(t),e.viewModel.hasTestConnectionFailure=!0}))}))}}},i.prototype.isFormValid=function(){return!this.scope.settingsForm.$invalid&&(!(this.viewModel.isAddingDataSource&&!this.isDataSourceNameUnique(this.viewModel.editableSettings.dataSourceName,this.scope.dataSourceModel))||(this.scope.dataSourceModel.errorTitle="",this.scope.dataSourceModel.compositeErrorMessage=this.services.localizationService.get("SettingsDatasources_DuplicateDataSourceName"),this.viewModel.messageState=2,!1))},i.prototype.switchToUserTab=function(){this.scope.$emit(t.constants.switchToUserTabEventName)},i.prototype.getConnectionDetailsString=function(){for(var e={},t=this.viewModel.dataSourceTypeOptions[this.viewModel.editableSettings.dataSourceType].labels,i=0,a=t;i<a.length;i++){var n=a[i];e[n.name]=this.viewModel.editableSettings[n.name]}return JSON.stringify(e)},i.prototype.getDataSourceName=function(e){var t=this.viewModel.dataSourceTypeOptions[e.dataSourceType].labels;return t.length>0?e[t[0].name]:""},i.prototype.showDataSourceError=function(t){var i=this,a=e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(t.error);a.always((function(a){var n=e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code,o=i.services.localizationService.get(n);"ServerError_DMTS_DuplicateDatasourceError"===n?(i.scope.dataSourceModel.errorTitle="",i.scope.dataSourceModel.compositeErrorMessage=o):(i.scope.dataSourceModel.errorTitle=i.services.localizationService.get("SettingsDataSource_SettingsConnectionErrorTitle"),i.scope.dataSourceModel.compositeErrorMessage=i.services.localizationService.format("SettingsDataSource_SettingsConnectionErrorMessage",[i.getDataSourceName(i.viewModel.editableSettings),o]));var s=[];if(a&&a.displayableErrorInfo)for(var r=0;r<a.displayableErrorInfo.length;r++){var c=a.displayableErrorInfo[r];s.push({key:c.errorInfoKey,value:c.errorInfoValue})}i.scope.dataSourceModel.traceDetails={requestId:t.requestId,activityId:t.activityId,clusterUri:clusterUri,errorCode:t.status.toString(),error:t.error.code,details:s,time:(new Date).toString(),version:e.build,linkText:i.services.localizationService.get("SettingsGateways_TroubleshootMessage"),link:"https://go.microsoft.com/fwlink/?LinkId=627095"},i.viewModel.waitingForDataSourceStatus=!1,i.viewModel.messageState=2}))},i.prototype.allowSingleSignOn=function(){return null!=this.scope.dataSourceModel.gateway&&null!=this.scope.dataSourceModel.gateway.staticCapabilities&&(this.scope.dataSourceModel.gateway.staticCapabilities&s.DirectQuerySingleSignOn_Kerberos)===s.DirectQuerySingleSignOn_Kerberos&&this.doDatasourcetypeSupportSingleSignOn(this.viewModel.editableSettings.dataSourceType)},i.prototype.doDatasourcetypeSupportSingleSignOn=function(e){switch(e){case n.SqlServer:case n.Oracle:case n.SAP:case n.Teradata:return!0;default:return!1}},i.prototype.onSingleSignOnSettingChange=function(){this.viewModel.singleSignOnType=this.viewModel.isSingleSignOnEnabled?c.Kerberos:c.None,this.isSingleSignOnOptionChanged=!this.isSingleSignOnOptionChanged},i.prototype.isCredentialsEdited=function(){return this.viewModel.editableSettings.authenticationParameter1Edited||this.viewModel.editableSettings.authenticationParameter2Edited},i})();i.DataSourceSettingsController=l})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.common.contracts.gateway.AccessRight,n=e.common.contracts.gateway.DataSourceType,o=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.dataSourceModel=e.dataSourceModel,this.viewModel=this.scope.viewModel=new t.models.DataSourceUserModel,this.scope.tryAddUsers=function(){return a.tryAddUsers()},this.scope.tryRemoveSelectedUsers=function(){return a.tryRemoveSelectedUsers()},this.scope.shouldDisableRemoveButton=function(){return a.shouldDisableRemoveButton()},this.scope.mapUserNames=function(){return a.mapUserNames()},this.getDataSourceUsers(),this.setupUpnMappingButton(),this.startWatchDataSourceModel(),this.scope.dataSourceModel.isDirty=function(){return!1}}return i.createOptions=function(){return{additionalServices:["errorService","localizationService","gatewaysMetadataService","telemetryService"]}},i.prototype.startWatchDataSourceModel=function(){var e=this;this.scope.$watch("dataSourceModel",(function(t,i){i!==t&&(e.dataSourceModel=e.scope.dataSourceModel,e.getDataSourceUsers(),e.setupUpnMappingButton())}))},i.prototype.setupUpnMappingButton=function(){this.scope.upnMappingEnabled=this.dataSourceModel&&this.dataSourceModel.dataSourceType===n.AnalysisServices},i.prototype.tryAddUsers=function(){var i=this;this.viewModel.pendingUsers.validationTrigger()&&(this.viewModel.isAdding=!0,this.validateEmailAddresses(),this.viewModel.pendingUsers.validEmailsList.length>0?this.services.gatewaysMetadataService.addDataSourcePrincipals(this.dataSourceModel.gateway.id,this.dataSourceModel.id,t.models.GatewayModelConverter.convertUsers(this.viewModel.pendingUsers.validEmailsList,a.read)).then((function(){i.viewModel.isAdding=!1,i.viewModel.pendingUsers.inputUserList=[],i.getDataSourceUsers()}),(function(t){i.viewModel.isAdding=!1,i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"AddDataSourceUser_Error",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})})):(this.viewModel.isAdding=!1,this.viewModel.pendingUsers.inputUserList=[]))},i.prototype.validateEmailAddresses=function(){this.viewModel.pendingUsers.validEmailsList=_.unique(this.arrayStringsToLowerCase(this.viewModel.pendingUsers.validEmailsList));var e=this.arrayStringsToLowerCase(_.map(this.viewModel.editableUsers,(function(e){return e.emailAddress})));this.viewModel.pendingUsers.validEmailsList=_.difference(this.viewModel.pendingUsers.validEmailsList,e)},i.prototype.arrayStringsToLowerCase=function(e){var t=_.map(e,(function(e){return e.toLowerCase()}));return t},i.prototype.tryRemoveSelectedUsers=function(){var i=this,n=_.filter(this.viewModel.editableUsers,(function(e){return e.shouldBeRemoved})),o=_.map(n,(function(e){return{objectId:e.objectId,principalType:e.principalType}}));this.viewModel.isReloadingList=!0,this.services.gatewaysMetadataService.deleteDataSourcePrincipals(this.dataSourceModel.gateway.id,this.dataSourceModel.id,t.models.GatewayModelConverter.convertToPrincipalAccessEntry(o,a.none)).then((function(){i.getDataSourceUsers()}),(function(t){i.viewModel.isReloadingList=!1,i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"AddDataSourceUser_Error",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})}))},i.prototype.getDataSourceUsers=function(){var t=this;this.viewModel.isReloadingList=!0,this.services.gatewaysMetadataService.getDataSourcePrincipals(this.dataSourceModel.gateway.id,this.dataSourceModel.id).then((function(e){var i=_.filter(e,(function(e){return e.accessRight===a.read||e.accessRight===a.write})),n=_.flatten(_.map(i,(function(e){return e.principalList})));t.viewModel.editableUsers=_.map(n,(function(e){var t=e.givenName?e.givenName:e.displayName,i=e.familyName?e.familyName:"";return{objectId:e.objectId,name:t+" "+i,emailAddress:e.emailAddress,principalType:e.principalType,shouldBeRemoved:!1}})),t.viewModel.isReloadingList=!1}),(function(i){t.services.errorService.error(t.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+i.error.code),"GetDataSourceUsers_Error",{requestId:i.requestId,ecsCorrelationId:i.activityId,statusCode:i.status.toString()}),t.viewModel.isReloadingList=!1}))},i.prototype.shouldDisableRemoveButton=function(){return _.all(this.viewModel.editableUsers,(function(e){return!e.shouldBeRemoved}))},i.prototype.mapUserNames=function(){this.services.telemetryService.logEvent(e.telemetry.SettingsOpenGatewayDatasourceUPNMappingPane),this.scope.$emit(t.constants.showGatewayUserMappingPaneEventName)},i})();i.DataSourceUsersController=o})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.common.contracts.gateway.AccessRight,n=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.gatewayModel=e.gatewayModel,this.viewModel=this.scope.viewModel=new t.models.DataSourceUserModel,this.scope.tryAddAdministrators=function(){return a.tryAddAdministrators()},this.scope.tryRemoveSelectedAdminstrators=function(){return a.tryRemoveSelectedAdministrators()},this.scope.shouldDisableRemoveButton=function(){return a.shouldDisableRemoveButton()},this.getGatewayAdministrators(),this.startWatchGatewayModel()}return i.createOptions=function(){return{additionalServices:["errorService","localizationService","gatewaysMetadataService"]}},i.prototype.startWatchGatewayModel=function(){var e=this;this.scope.$watch("gatewayModel",(function(t,i){i!==t&&(e.gatewayModel=e.scope.gatewayModel,e.getGatewayAdministrators())}))},i.prototype.tryAddAdministrators=function(){var i=this;this.viewModel.pendingUsers.validationTrigger()&&(this.viewModel.isAdding=!0,this.validateEmailAddresses(),this.viewModel.pendingUsers.validEmailsList.length>0?this.services.gatewaysMetadataService.addGatewayPrincipals(this.gatewayModel.id,t.models.GatewayModelConverter.convertUsers(this.viewModel.pendingUsers.validEmailsList,a.read|a.write)).then((function(){i.viewModel.isAdding=!1,i.viewModel.pendingUsers.inputUserList=[],i.getGatewayAdministrators()}),(function(t){i.viewModel.isAdding=!1,i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"AddGatewayAdmin_Error",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})})):(this.viewModel.isAdding=!1,this.viewModel.pendingUsers.inputUserList=[]))},i.prototype.validateEmailAddresses=function(){this.viewModel.pendingUsers.validEmailsList=_.unique(this.arrayStringsToLowerCase(this.viewModel.pendingUsers.validEmailsList));var e=this.arrayStringsToLowerCase(_.map(this.viewModel.editableUsers,(function(e){return e.emailAddress})));this.viewModel.pendingUsers.validEmailsList=_.difference(this.viewModel.pendingUsers.validEmailsList,e)},i.prototype.arrayStringsToLowerCase=function(e){var t=_.map(e,(function(e){return e.toLowerCase()}));return t},i.prototype.tryRemoveSelectedAdministrators=function(){var i=this,n=_.filter(this.viewModel.editableUsers,(function(e){return e.shouldBeRemoved})),o=_.map(n,(function(e){return{objectId:e.objectId,principalType:e.principalType}}));this.viewModel.isReloadingList=!0,this.services.gatewaysMetadataService.deleteGatewayPrincipals(this.gatewayModel.id,t.models.GatewayModelConverter.convertToPrincipalAccessEntry(o,a.none)).then((function(){i.getGatewayAdministrators()}),(function(t){i.viewModel.isReloadingList=!1,i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"AddGatewayAdmin_Error",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})}))},i.prototype.getGatewayAdministrators=function(){var t=this;this.viewModel.isReloadingList=!0,this.services.gatewaysMetadataService.getGatewayPrincipals(this.gatewayModel.id).then((function(e){var i=_.filter(e,(function(e){return e.accessRight&(a.read|a.write)})),n=_.flatten(_.map(i,(function(e){return e.principalList})));t.viewModel.editableUsers=_.map(n,(function(e){var t=e.givenName?e.givenName:e.displayName,i=e.familyName?e.familyName:"";return{objectId:e.objectId,name:t+" "+i,emailAddress:e.emailAddress,principalType:e.principalType,shouldBeRemoved:!1}})),t.viewModel.isReloadingList=!1}),(function(i){t.services.errorService.error(t.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+i.error.code),"GetGatewaysAdmins_Error",{requestId:i.requestId,ecsCorrelationId:i.activityId,statusCode:i.status.toString()}),t.viewModel.isReloadingList=!1}))},i.prototype.shouldDisableRemoveButton=function(){return _.all(this.viewModel.editableUsers,(function(e){return!e.shouldBeRemoved}))},i})();i.GatewayAdministratorsController=n})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){var i=this;this.scope=e,this.services=t,this.scope.onTabSelected=function(e){return i.onTabSelected(e)}}return e.prototype.onTabSelected=function(e){this.scope.viewModel.tabSelectionType=e},e})();e.GatewayController=t})(t=e.controllers||(e.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.connectivity.models.DataSourceContextMenuItemModel,n=e.connectivity.models.GatewayContextMenuItemModel,o=e.connectivity.models.GatewayStatus,s=e.connectivity.models.GatewayTabSelectionType,r=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.scope.onItemSelected=function(e,t){return a.onItemSelected(e,t)},this.scope.getSelectionType=function(){return a.getSelectionType()},this.scope.tryAddDataSource=function(){return a.tryAddDataSource(a.scope.viewModel.currentGateway)},this.scope.testConnections=function(){return a.testConnections()},this.scope.isLoading=!1,this.loadGateways(),this.scope.$on(t.constants.dataSourceCreatedEventName,(function(e,t){return a.updateCurrentDataSource(e,t[0])})),this.scope.$on(t.constants.discardAddingDataSourceEventName,(function(e){return a.discardAddingDataSource(e)})),this.scope.$on(t.constants.addDataSourceEventName,(function(e){return a.tryAddDataSource(a.scope.viewModel.currentGateway)}))}return i.createOptions=function(){return{additionalServices:["errorService","gatewayDataService","gatewaysMetadataService","localizationService","navigation","promiseFactory"]}},i.prototype.updateCurrentDataSource=function(e,t){e.stopPropagation(),this.scope.viewModel.currentDataSourceId=t,this.loadDataSourceContextMenu(this.scope.viewModel.currentDataSource)},i.prototype.discardAddingDataSource=function(e){e.stopPropagation(),this.scope.viewModel.currentGateway.dataSources.pop(),this.openItem(this.scope.viewModel.currentGatewayId,null)},i.prototype.gatewayExists=function(e){var t=_.find(this.scope.viewModel.gateways,(function(t){return t.id===e}));return null!==t&&void 0!==t},i.prototype.dataSourceExists=function(e,t){var i=_.find(e.dataSources,(function(e){return e.id===t}));return null!==i&&void 0!==i},i.prototype.tryInitializeGatewaySelection=function(){if(this.scope.viewModel.gateways.length>0){var e=this.services.navigation,t=e?e.gatewayId:null,i=e?e.dataSourceId:null;null!==t&&this.gatewayExists(t)?i||this.onItemSelected(t,null):(t=this.scope.viewModel.gateways[0].id,this.onItemSelected(t,null))}},i.prototype.tryInitializeDataSourceSelection=function(e){var t=this.services.navigation,i=t?t.gatewayId:null,a=t?t.dataSourceId:null;e.id===i&&a&&(a===-1?(this.onItemSelected(i,null),this.tryAddDataSource(e)):this.dataSourceExists(e,a)?this.onItemSelected(i,a):this.onItemSelected(i,null))},i.prototype.loadGateways=function(){var e=this;this.scope.isLoading=!0,this.services.gatewaysMetadataService.getGateways().then((function(i){e.scope.viewModel={gateways:t.models.GatewayModelConverter.convertSettingsGateways(i),currentGatewayId:0,currentDataSourceId:0,currentGateway:null,currentDataSource:null},e.scope.isLoading=!1,e.tryInitializeGatewaySelection(),e.loadGatewaysState()}),(function(t){e.services.errorService.error(e.services.localizationService.get("SettingsGateways_Error_FailedToLoad"),"SettingsGateways_Error_FailedToLoad")}))},i.prototype.loadGatewaysState=function(){for(var e=0;e<this.scope.viewModel.gateways.length;e++){var t=this.scope.viewModel.gateways[e];this.loadGatewayContextMenu(t),this.loadGatewayStatus(t),this.loadDataSources(t)}},i.prototype.loadGatewayContextMenu=function(t){var i=this,a=new n(t);a.actions=[],a.actions.push({text:this.services.localizationService.get("AddDataSourceText"),action:function(){i.tryAddDataSource(t)}}),a.actions.push({text:this.services.localizationService.get("DashboardContextMenu_Delete"),action:function(){i.tryDeleteGateway(t)}}),a.metadata=[],a.metadata.push({type:e.common.models.ContextMenuItemMetadataType.Status,status:e.common.models.ContextMenuItemMetadataStatus.Unknown,value:""}),t.contextMenuItem=a},i.prototype.tryDeleteGateway=function(e){var t=this,i=this.services.errorService,a=i.control(),n=this.services.localizationService.get("SettingsGateway_DeleteWarning_YesOption"),o=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_CancelOption"),s=[new InJs.ModalDialogAction(n,function(i,n){a.hideDialog(),t.deleteGateway(e)}),new InJs.ModalDialogAction(o,function(e,t){a.hideDialog()})],r=this.services.localizationService.get("SettingsGateway_DeleteWarning_Title"),c=this.services.localizationService.get("SettingsGateway_DeleteWarning_Message");a.showCustomDialog(r,$("<div/>").text(c),s,(function(e){e.parent().find('input[value="'+o+'"]').focus()}),!0,!0)},i.prototype.deleteGateway=function(t){var i=this;t&&this.services.gatewaysMetadataService.deleteGateway(t.id).then((function(){var e=i.scope.viewModel.gateways.indexOf(t);e>-1&&(i.scope.viewModel.gateways.splice(e,1),i.scope.viewModel.gateways.length>0?i.onItemSelected(i.scope.viewModel.gateways[0].id,null):i.onItemSelected(null,null))}),(function(t){i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"Gateways_Error_FailedToDelete",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})}))},i.prototype.getCurrentGateway=function(){return this.scope.viewModel.currentGateway},i.prototype.getCurrentDataSource=function(){return this.scope.viewModel.currentDataSource},i.prototype.loadGatewayStatus=function(t){var i=this;t.isLoadingStatus=!0,this.services.gatewaysMetadataService.getGatewayStatus(t.id).then((function(a){if(t.status=o.Live,t.staticCapabilities=a.gatewayStaticCapabilities,t.isLoadingStatus=!1,t.contextMenuItem){var n=t.contextMenuItem.metadata[0];n.status=e.common.models.ContextMenuItemMetadataStatus.Success,n.value=i.services.localizationService.get("SettingsGateway_OnlineMessage")}}),(function(a){t.isLoadingStatus=!1,t.status=o.NotReachable,e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(a.error).done((function(n){if(t.connectionError=i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+a.error.code),t.contextMenuItem){var o=t.contextMenuItem.metadata[0];o.status=e.common.models.ContextMenuItemMetadataStatus.Error,o.value=i.services.localizationService.get("SettingsGateway_NotConnectedMessage")}var s=[];if(n&&n.displayableErrorInfo)for(var r=0,c=n.displayableErrorInfo;r<c.length;r++){var l=c[r];s.push({key:l.errorInfoKey,value:l.errorInfoValue})}t.traceDetails={requestId:a.requestId,activityId:a.activityId,clusterUri:clusterUri,errorCode:a.status.toString(),error:a.error.code,details:s,time:(new Date).toString(),version:e.build,linkText:i.services.localizationService.get("SettingsGateways_TroubleshootMessage"),link:"https://go.microsoft.com/fwlink/?LinkId=627095"}}))}))},i.prototype.loadDataSources=function(i){var a=this;i.isLoadingDataSources=!0,this.services.gatewaysMetadataService.getDataSources(i.id).then((function(e){i.dataSources=t.models.GatewayModelConverter.convertDataSources(e),i.isLoadingDataSources=!1,a.tryInitializeDataSourceSelection(i),a.loadDataSourcesState(i)}),(function(t){a.services.errorService.error(a.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"SettingsDataSources_Error_FailedToLoad",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})}))},i.prototype.loadDataSourcesState=function(e){for(var t=0;t<e.dataSources.length;t++){var i=e.dataSources[t];i.gateway=e,this.loadDataSourceContextMenu(i),this.loadDataSourceStatus(e,i)}},i.prototype.loadDataSourceContextMenu=function(t){var i=this,n=new a(t);n.actions=[],n.actions.push({text:this.services.localizationService.get("DashboardContextMenu_Delete"),action:function(){i.tryDeleteDataSource(t)}}),n.metadata=[],n.metadata.push({type:e.common.models.ContextMenuItemMetadataType.Status,status:e.common.models.ContextMenuItemMetadataStatus.Unknown,value:""}),t.contextMenuItem=n},i.prototype.tryDeleteDataSource=function(e){var t=this,i=this.services.errorService,a=i.control(),n=this.services.localizationService.get("SettingsDataSource_DeleteWarning_YesOption"),o=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_CancelOption"),s=[new InJs.ModalDialogAction(n,function(i,n){a.hideDialog(),t.deleteDataSource(e)}),new InJs.ModalDialogAction(o,function(e,t){a.hideDialog()})],r=this.services.localizationService.get("SettingsDataSource_DeleteWarning_Title"),c=this.services.localizationService.get("SettingsDataSource_DeleteWarning_Message");a.showCustomDialog(r,$("<div/>").text(c),s,(function(e){e.parent().find('input[value="'+o+'"]').focus()}),!0,!0)},i.prototype.deleteDataSource=function(t){var i=this,a=t.gateway;if(a&&t)if(t.id<0){var n=a.dataSources.indexOf(t);n>-1&&(a.dataSources.splice(n,1),this.openItem(a.id,null))}else this.services.gatewaysMetadataService.deleteDataSource(a.id,t.id).then((function(){var e=a.dataSources.indexOf(t);e>-1&&(a.dataSources.splice(e,1),i.onItemSelected(a.id,null))}),(function(t){i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"DataSources_Error_FailedToDelete",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})}))},i.prototype.loadDataSourceStatus=function(t,i){var a=this;i.id!==-1&&this.services.gatewaysMetadataService.getDataSourceStatus(t.id,i.id).then((function(){if(i.connected=!0,i.connectionError=null,i.contextMenuItem){var t=i.contextMenuItem.metadata[0];t.status=e.common.models.ContextMenuItemMetadataStatus.Success,t.value=a.services.localizationService.get("SettingsGateway_OnlineMessage")}}),(function(t){i.connected=!1,i.gateway.isExpanded=!0,e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(t.error).done((function(n){if(i.connectionError=a.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),i.contextMenuItem){var o=i.contextMenuItem.metadata[0];o.status=e.common.models.ContextMenuItemMetadataStatus.Error,o.value=a.services.localizationService.get("SettingsGateway_NotConnectedMessage")}var s=[];if(n&&n.displayableErrorInfo)for(var r=0,c=n.displayableErrorInfo;r<c.length;r++){var l=c[r];s.push({key:l.errorInfoKey,value:l.errorInfoValue})}i.traceDetails={requestId:t.requestId,activityId:t.activityId,clusterUri:clusterUri,errorCode:t.status.toString(),error:t.error.code,details:s,time:(new Date).toString(),version:e.build,linkText:a.services.localizationService.get("SettingsGateways_TroubleshootMessage"),link:"https://go.microsoft.com/fwlink/?LinkId=627095"}}))}))},i.prototype.generateUniqueDataSourceName=function(){if(!this.scope.viewModel.currentGateway)return null;for(var e=this.services.localizationService.get("NewDataSourceName"),t=e,i=0;;){var a=_.find(this.scope.viewModel.currentGateway.dataSources,(function(e){return e.displayName===t}));if(!a)break;i++,t=e+" "+i}return t},i.prototype.tryAddDataSource=function(e){var i=this;this.scope.viewModel.currentDataSourceId<0||(this.scope.viewModel.currentDataSource&&this.scope.viewModel.currentDataSource.isDirty&&this.scope.viewModel.currentDataSource.isDirty()?this.showDiscardPopup().then((function(){i.addDataSource(e)})):this.scope.viewModel.currentGateway&&this.scope.viewModel.currentGateway.isDirty?this.scope.$broadcast(t.constants.onDirtyGatewaySelectionChanging,"SettingsGateway_DiscardChangesWarning_GatewayMessage",(function(){
i.addDataSource(e),i.scope.$apply()})):this.addDataSource(e))},i.prototype.addDataSource=function(e){var t={id:-1,displayName:this.generateUniqueDataSourceName(),dataSourceType:void 0,gateway:e,connectionInfo:{},users:null,tabSelectionType:s.Settings};e.dataSources.push(t),this.loadDataSourceContextMenu(t),this.openItem(e.id,t.id)},i.prototype.onItemSelected=function(e,i){var a=this;e===this.scope.viewModel.currentGatewayId&&i===this.scope.viewModel.currentDataSourceId||(this.scope.viewModel.currentDataSource&&this.scope.viewModel.currentDataSource.isDirty&&this.scope.viewModel.currentDataSource.isDirty()?this.showDiscardPopup().then((function(){a.scope.viewModel.currentDataSourceId<0&&a.scope.viewModel.currentGateway.dataSources.pop(),a.openItem(e,i)})):this.scope.viewModel.currentGateway&&this.scope.viewModel.currentGateway.isDirty?this.scope.$broadcast(t.constants.onDirtyGatewaySelectionChanging,"SettingsGateway_DiscardChangesWarning_GatewayMessage",(function(){a.openItem(e,i),a.scope.$apply()})):(this.scope.viewModel.currentDataSource&&this.scope.viewModel.currentDataSourceId<0&&this.scope.viewModel.currentGateway.dataSources.pop(),this.openItem(e,i)))},i.prototype.openItem=function(e,i){var a=this,n=this.scope.viewModel;n.currentGatewayId=e,n.currentDataSourceId=i,n.currentGateway=this.getCurrentGatewayModel(),this.services.gatewayDataService.selectedGatewayDatasource=n.currentDataSource=this.getCurrentDataSourceModel(),i?this.scope.viewModel.currentGateway.isExpanded=!0:requestAnimationFrame((function(){return a.scope.$broadcast(t.constants.onGatewaySelectionChanged)})),this.services.navigation&&this.services.navigation.navigateToGatewayItem(e,i)},i.prototype.getSelectionType=function(){return this.scope.viewModel.currentGatewayId?this.scope.viewModel.currentDataSourceId?e.connectivity.models.GatewaysSelectionType.DataSource:e.connectivity.models.GatewaysSelectionType.Gateway:e.connectivity.models.GatewaysSelectionType.None},i.prototype.getCurrentGatewayModel=function(){var e=this;return _.find(this.scope.viewModel.gateways,(function(t){return t.id===e.scope.viewModel.currentGatewayId}))},i.prototype.getCurrentDataSourceModel=function(){var e=this.scope.viewModel.currentDataSourceId;if(e){var t=this.getCurrentGatewayModel();if(t)return _.find(t.dataSources,(function(t){return t.id===e}))}return null},i.prototype.showDiscardPopup=function(){var e=this.services.promiseFactory.defer(),t=this.services.errorService,i=t.control(),a=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_YesOption"),n=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_CancelOption"),o=[new InJs.ModalDialogAction(a,function(t,a){i.hideDialog(),e.resolve(null)}),new InJs.ModalDialogAction(n,function(t,a){i.hideDialog(),e.reject()})],s=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_Title"),r=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_DataSourceMessage");return i.showCustomDialog(s,$("<div/>").text(r),o,(function(e){e.parent().find('input[value="'+n+'"]').focus()}),!0,!0),e.promise},i.prototype.testConnections=function(){if(this.scope.viewModel.gateways)for(var e=0,t=this.scope.viewModel.gateways;e<t.length;e++){var i=t[e];if(this.loadGatewayStatus(i),i.dataSources)for(var a=0,n=i.dataSources;a<n.length;a++){var o=n[a];this.loadDataSourceStatus(i,o)}}},i})();i.GatewaysController=r})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.scope.updateDirtyFlag=function(){return a.updateDirtyFlag()},this.scope.applyChanges=function(){return a.applyChanges()},this.scope.discardChanges=function(){return a.discardChanges()},this.scope.addDataSource=function(){return a.addDataSource()};var n=this.scope.$on(t.constants.onDirtyGatewaySelectionChanging,(function(e,t,i){return a.discardOrCancel(t,i)})),o=this.scope.$on(t.constants.onGatewaySelectionChanged,(function(){return a.initializeGateway()}));this.initializeGateway(),this.scope.$on("$destroy",(function(){n(),o()}))}return i.createOptions=function(){return{additionalServices:["errorService","localizationService","gatewaysMetadataService","telemetryService"]}},i.prototype.initializeGateway=function(){var e=this.scope.viewModel;e.contactInformationString=this.getContactInformationString(e.gatewayAnnotation.gatewayContactInformation),this.initializeOriginalValues()},i.prototype.updateDirtyFlag=function(){var e=this.scope.viewModel;e.isDirty=e.displayName!==e.originalValues.name||e.description!==e.originalValues.description||e.gatewayAnnotation.gatewayDepartment!==e.originalValues.department||e.contactInformationString!==e.originalValues.contactInformationString},i.prototype.discardOrCancel=function(e,t){var i=this,a=this.services.errorService.control(),n=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_YesOption"),o=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_CancelOption"),s=[new InJs.ModalDialogAction(n,function(e,n){i.restoreOriginalValues(),i.scope.$apply(),a.hideDialog(),t&&t()}),new InJs.ModalDialogAction(o,function(e,t){a.hideDialog()})],r=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_Title"),c=this.services.localizationService.get(e);a.showCustomDialog(r,$("<div/>").text(c),s,(function(e){e.parent().find('input[value="'+o+'"]').focus()}),!0,!0)},i.prototype.restoreOriginalValues=function(){var e=this.scope.viewModel;e.displayName=e.originalValues.name,e.description=e.originalValues.description,e.gatewayAnnotation.gatewayDepartment=e.originalValues.department,e.contactInformationString=e.originalValues.contactInformationString,e.isDirty=!1},i.prototype.initializeOriginalValues=function(){var e=this.scope.viewModel;e.originalValues={name:e.displayName,description:e.description,department:e.gatewayAnnotation.gatewayDepartment,contactInformationString:e.contactInformationString},e.isDirty=!1},i.prototype.getContactInformationString=function(e){var t="";return e&&(t=e.join(";")),t},i.prototype.parseContactInformation=function(e){return e.split(";")},i.prototype.applyChanges=function(){var t=this;this.scope.viewModel.gatewayAnnotation.gatewayContactInformation=this.parseContactInformation(this.scope.viewModel.contactInformationString);var i={gatewayName:this.scope.viewModel.displayName,gatewayDescription:this.scope.viewModel.description,gatewayAnnotation:JSON.stringify(this.scope.viewModel.gatewayAnnotation)};this.scope.viewModel.isWaitingForGatewayUpdate=!0,this.services.gatewaysMetadataService.updateGateway(this.scope.viewModel.id,i).then((function(){t.scope.viewModel.isWaitingForGatewayUpdate=!1,t.initializeOriginalValues()}),(function(i){t.scope.viewModel.isWaitingForGatewayUpdate=!1,t.services.errorService.error(t.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+i.error.code),"UpdateGateway_Error",{requestId:i.requestId,ecsCorrelationId:i.activityId,statusCode:i.status.toString()})}))},i.prototype.discardChanges=function(){this.discardOrCancel("SettingsGateway_DiscardChangesWarning_GatewaySettingsMessage",null)},i.prototype.addDataSource=function(){this.scope.$emit(t.constants.addDataSourceEventName)},i})();i.GatewaySettingsController=a})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=e.common.contracts.gateway.GatewayType,n=(function(){function i(e,i){var a=this;this.scope=e,this.services=i,this.scope.viewModel.title=this.services.localizationService.format("SettingsGateways_ConnectToServer",[this.scope.viewModel.serverName]),this.scope.viewModel.gatewayOnlineStatusLabel=this.services.localizationService.format("Gateways_Status_Bracketed",[this.services.localizationService.get("Gateways_Status_Online")]),this.scope.viewModel.gatewayOfflineStatusLabel=this.services.localizationService.format("Gateways_Status_Bracketed",[this.services.localizationService.get("Gateways_Status_Offline")]),this.scope.gatewayTypeSelected=function(){return a.gatewayTypeSelected()},this.scope.enterpriseGatewaySelected=function(e){return a.enterpriseGatewaySelected(e)},this.scope.navigateToManageGateways=function(){return a.navigateToManageGateways()},this.scope.deletePersonalGateway=function(){return a.deletePersonalGateway()},this.scope.$on(t.constants.gatewaySelectionAppliedEventName,(function(){return a.onGatewaySelectionApplied()})),this.scope.$on(t.constants.gatewaySelectionDiscardedEventName,(function(){return a.onGatewaySelectionDiscarded()})),this.scope.isSovereignCloud=this.services.featureSwitchService.featureSwitches.isSovereignCloud,this.populateGatewayTable()}return i.createOptions=function(){return{additionalServices:["telemetryService","errorService","localizationService","selectGatewayService","gatewaysMetadataService","featureSwitchService","navigation"]}},i.prototype.populateGatewayTable=function(){var e=this;this.services.gatewaysMetadataService.getModelDataSources(this.scope.viewModel.modelId).then((function(i){if(e.scope.cachedDiscoverDatasourceResponse=i,0===i.gateways.length&&0===i.datasources.length)return e.scope.viewModel.isCloudScheduleRefresh||e.loadPersonalGateway(),e.scope.viewModel.enterpriseGateways=[],e.scope.viewModel.egwStatusLoaded=!0,void(e.scope.viewModel.useEnterpriseGateway=!1);var n=e.services.selectGatewayService.getAvailableGateways(i);e.scope.viewModel.serverName=e.services.selectGatewayService.getServerName(i),e.scope.viewModel.enterpriseGateways=t.models.GatewayModelConverter.convertSettingsGateways(n.filter((function(e){return e.gatewayType===a.Resource}))),e.loadSelectedGateway(i),e.loadDataSourcesStatus(i.datasources),e.loadDmtsPlaceHolderPersonalGatewayId(i),e.loadPersonalGateway(),e.scope.viewModel.egwStatusLoaded=!0,e.checkIfOnPremMigrationIsAllowed(),e.scope.$emit(t.constants.selectGatewayStatusReadyEventName)}),(function(i){i.error&&i.error.code===t.constants.ServerError_ModelHasNoPowerBIDMMoniker&&(e.scope.viewModel.isCloudScheduleRefresh||e.loadPersonalGateway(),e.scope.viewModel.enterpriseGateways=[],e.scope.viewModel.egwStatusLoaded=!0,e.scope.viewModel.useEnterpriseGateway=!1)}))},i.prototype.loadDmtsPlaceHolderPersonalGatewayId=function(e){var t=_.find(e.gateways,(function(e){return e.gatewayType===a.Personal}));t&&(this.scope.viewModel.dmtsPlaceHolderGatewayId=t.gatewayId)},i.prototype.loadPersonalGateway=function(){var e=this;this.services.gatewaysMetadataService.getPersonalGateway().then((function(i){e.scope.viewModel.pgw=i,e.scope.viewModel.isDMTSPersonalGateway=e.isDMTSPersonalGateway(),e.scope.viewModel.pgwAnnotation=t.models.GatewayModelConverter.getGatewayAnnotation(e.scope.viewModel.pgw),e.updateStatus()}),(function(e){}))},i.prototype.checkIfOnPremMigrationIsAllowed=function(){var e=this;this.services.gatewaysMetadataService.checkIfOnPremMigrationIsAllowed().then((function(t){e.scope.viewModel.showNewPersonalGatewayAvailableMessage=!e.scope.viewModel.isCloudScheduleRefresh&&t.IsMigrationAllowed&&t.FirstTimeInstallDMTSPersonalGateway&&t.AllDataSourcesAreSupported}),(function(e){}))},i.prototype.loadDataSourcesStatus=function(e){if(this.scope.viewModel.showStatus)for(var t=0,i=this.scope.viewModel.enterpriseGateways;t<i.length;t++){var a=i[t];this.getDataSourcesStatus(a,e,this.services.gatewaysMetadataService)}},i.prototype.getDataSourcesStatus=function(t,i,a){var n,o,s=this,r=this.getDataSourceIds(t.id,i);if(n=r.length,0===n)return void(t.status=e.connectivity.models.GatewayStatus.NotReachable);o=!0,t.status=e.connectivity.models.GatewayStatus.Unknown;for(var c=0,l=r;c<l.length;c++){var d=l[c];a.getDataSourceStatus(t.id,d).then((function(){o&&(n--,0===n&&(t.status=e.connectivity.models.GatewayStatus.Live,s.updateStatus()))}),(function(i){o=!1,t.status=e.connectivity.models.GatewayStatus.NotReachable,s.updateStatus()}))}},i.prototype.getDataSourceIds=function(e,t){for(var i=[],a=0,n=t;a<n.length;a++){var o=n[a];o.gatewayId===e&&i.push(o.dataSourceId)}return i},i.prototype.loadSelectedGateway=function(e){var t=this.services.selectGatewayService.getSelectedGateway(e),i=this.services.selectGatewayService.getSelectedGatewayType(t);switch(i){case 0:this.scope.viewModel.selectedGatewayId=-1,this.scope.viewModel.useEnterpriseGateway=void 0,this.scope.viewModel.egwAccessLost=this.services.selectGatewayService.isEGWAccessLost(e);break;case 1:this.scope.viewModel.selectedGatewayId=t.gatewayId,this.scope.viewModel.useEnterpriseGateway=!1;break;case 2:this.scope.viewModel.selectedGatewayId=t.gatewayId,this.scope.viewModel.useEnterpriseGateway=!0}},i.prototype.gatewayTypeSelected=function(){this.scope.viewModel.selectedGatewayId=this.scope.viewModel.useEnterpriseGateway?this.scope.viewModel.enterpriseGateways[0].id:this.scope.viewModel.dmtsPlaceHolderGatewayId,this.scope.viewModel.isDirty=!0},i.prototype.enterpriseGatewaySelected=function(e){this.scope.viewModel.useEnterpriseGateway=!0,this.scope.viewModel.selectedGatewayId=e,this.scope.viewModel.isDirty=!0},i.prototype.onGatewaySelectionApplied=function(){var e=this;this.services.gatewaysMetadataService.getModelDataSources(this.scope.viewModel.modelId).then((function(i){e.scope.cachedDiscoverDatasourceResponse=i,e.scope.$emit(t.constants.selectGatewayStatusReadyEventName)}),(function(e){})),this.scope.viewModel.isDirty=!1},i.prototype.onGatewaySelectionDiscarded=function(){this.loadSelectedGateway(this.scope.cachedDiscoverDatasourceResponse),this.scope.viewModel.isDirty=!1},i.prototype.updateStatus=function(){if(this.scope.viewModel.pgw&&this.scope.viewModel.pgw.gatewayStatus!==e.common.contracts.gateway.GatewayStatus.NotInstalled){for(var i=0,a=this.scope.viewModel.enterpriseGateways;i<a.length;i++){var n=a[i];if(n.status===e.connectivity.models.GatewayStatus.Unknown)return}this.scope.$emit(t.constants.selectGatewayStatusReadyEventName)}},i.prototype.navigateToManageGateways=function(){this.services.navigation&&this.services.navigation.navigateToGateways()},i.prototype.isDMTSPersonalGateway=function(){if(this.scope.viewModel.pgw){var e=this.services.selectGatewayService.getAvailableGateways(this.scope.cachedDiscoverDatasourceResponse),t=e.filter((function(e){return e.gatewayType===a.Personal}));if(t&&1===t.length)return t[0].gatewayId===this.scope.viewModel.pgw.gatewayId}return!1},i.prototype.deletePersonalGateway=function(){this.tryDeleteGateway(this.scope.viewModel.pgw)},i.prototype.tryDeleteGateway=function(t){var i=this,a=this.services.errorService,n=a.control(),o=this.services.localizationService.get("SettingsGateway_DeleteWarning_YesOption"),s=this.services.localizationService.get("SettingsDataSource_DiscardChangesWarning_CancelOption"),r=[new InJs.ModalDialogAction(o,function(a,o){n.hideDialog(),i.services.gatewaysMetadataService.deleteGateway(t.gatewayId).then((function(){i.scope.viewModel.isDMTSPersonalGateway=!1,i.scope.viewModel.showNewPersonalGatewayAvailableMessage=!0,i.loadPersonalGateway()}),(function(t){i.services.errorService.error(i.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+t.error.code),"Gateways_Error_FailedToDelete",{requestId:t.requestId,ecsCorrelationId:t.activityId,statusCode:t.status.toString()})}))}),new InJs.ModalDialogAction(s,function(e,t){n.hideDialog()})],c=this.services.localizationService.get("SettingsGateway_DeletePersonalGatewayWarning_Title"),l=this.services.localizationService.get("SettingsGateway_DeletePersonalGatewayWarning_Message");n.showCustomDialog(c,$("<div/>").text(l),r,(function(e){e.parent().find('input[value="'+s+'"]').focus()}),!0,!0)},i})();i.SelectGatewayController=n})(i=t.controllers||(t.controllers={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/datasourceView.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(t.controllers.DataSourceController)}return i})();i.Datasource=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/datasourceSettingsView.html",this.replace=!0,this.scope={dataSourceModel:"=datasourceModel"},this.controller=e.common.createController(t.controllers.DataSourceSettingsController)}return i})();i.DatasourceSettings=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/datasourceUsersView.html",this.replace=!0,this.scope={dataSourceModel:"=datasourceModel"},this.controller=e.common.createController(t.controllers.DataSourceUsersController)}return i})();i.DatasourceUsers=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/gatewayView.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(t.controllers.GatewayController)}return i})();i.Gateway=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/gatewayAdministratorsView.html",this.replace=!0,this.scope={gatewayModel:"= gatewayModel"},this.controller=e.common.createController(t.controllers.GatewayAdministratorsController)}return i})();i.GatewayAdministrators=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.templateUrl="views/gatewaysView.html",this.replace=!0,this.controller=e.common.createController(t.controllers.GatewaysController)}return i})();i.Gateways=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){var a=(function(){function i(){this.restrict="E",this.replace=!0,this.templateUrl="views/selectGatewayView.html",this.scope={viewModel:"="},this.controller=e.common.createController(t.controllers.SelectGatewayController)}return i})();i.SelectGateway=a})(i=t.directives||(t.directives={}))})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,a){return new s(e,t,i,a)}var a=e.common.contracts.gateway.EncryptedConnection,n=e.common.EncryptionContext,o=e.common.contracts.gateway.PrivacyLevel;t.createGatewayDataService=i;var s=(function(){function i(e,t,i,a){this.gatewaysMetadataService=e,this.promiseFactory=t,this.featureSwitchService=i,this.moduleLoader=a}return i.prototype.getDecodedPublicKey=function(e){return atob(e).split(/<\/Modulus>|<Modulus>/)[1]},i.prototype.encryptCredentials=function(e,t,i,s){var r=this,c=this.promiseFactory.defer();return n.create(JSON.stringify(e),t,s,(function(e){var t={credentials:e,credentialType:i,encryptedConnection:r.featureSwitchService.featureSwitches.enterpriseGatewayETLEnabled?a.NotEncrypted:a.Encrypted,privacyLevel:o.Public,encryptionAlgorithm:"RSA-OAEP"};c.resolve(t)}),this.moduleLoader).then((function(e){e.RSAEncrypt()})),c.promise},i.prototype.createDataSourceWithRetry=function(e,t,i,a){var n=this,o=this.promiseFactory.defer();return this.gatewaysMetadataService.createDataSource(e.id,t).then((function(e){o.resolve(e)}),(function(s){n.updateGatewayPublicKeyIfNeed(e,t.credentialDetails.credentialType,i,a,s).then((function(i){t.credentialDetails=i,n.gatewaysMetadataService.createDataSource(e.id,t).then((function(e){o.resolve(e)}),(function(e){o.reject(e)}))}),(function(){o.reject(s)}))})),o.promise},i.prototype.updateCredentialsWithRetry=function(e,t,i,a,n){var o=this,s=this.promiseFactory.defer();return this.gatewaysMetadataService.updateCredentials(e.id,t,a).then((function(){s.resolve(null)}),(function(r){o.updateGatewayPublicKeyIfNeed(e,a.credentialType,i,n,r).then((function(i){i.privacyLevel=a.privacyLevel,o.gatewaysMetadataService.updateCredentials(e.id,t,i).then((function(){s.resolve(null)}),(function(e){s.reject(e)}))}),(function(){s.reject(r)}))})),s.promise},i.prototype.updateGatewayPublicKeyIfNeed=function(i,a,n,o,s){var r=this,c=this.promiseFactory.defer(),l=e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(s.error);return l.always((function(s){if(s&&s.displayableErrorInfo){var l=e.common.localize.get("ServerError_DM_ErrorDetailNameCode_UnderlyingErrorMessage");_.filter(s.displayableErrorInfo,(function(e){return e.errorInfoKey===l}))&&r.gatewaysMetadataService.getGateways().then((function(e){var s=_.filter(e,(function(e){return e.gatewayId===i.id&&i.publicKey!==e.gatewayPublicKey}));if(_.isEmpty(s))c.reject();else{i.publicKey=s[0].gatewayPublicKey;var l=r.getDecodedPublicKey(i.publicKey),d={credentialData:t.models.GatewayModelConverter.convertAuthenticationParametersToCredentialData(n)};r.encryptCredentials(d,l,a,o).then((function(e){c.resolve(e)}),(function(){c.reject()}))}}),(function(e){c.reject()}))}})),c.promise},i})();t.GatewayDataService=s})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(e,t,a,n,o){return new i(e,t,a,n,o)}e.createSelectGatewayService=t;var i=(function(){function t(e,t,i,a,n){this.rootScope=e,this.compile=t,this.gatewaysMetadataService=i,this.modalDialogService=a,this.localizationService=n}return t.prototype.bindModelToGateway=function(e,t,i,a){var n=this;this.showDialog(e,(function(a){return n.bindModel(e,a,t,i)}),a)},t.prototype.bindModel=function(e,t,i,a){this.gatewaysMetadataService.bindModelToGateway(e,t).then((function(){i()}),(function(e){a()}))},t.prototype.getAvailableGateways=function(e){if(0===e.monikers.length)return[];var t=_.filter(e.monikers,(function(e){return e.monikerGateways.length>0})),i=_.map(t,(function(e){return _.map(e.monikerGateways,(function(e){return e.gatewayId}))})),a=_.intersection.apply(_,i),n=_.filter(e.gateways,(function(e){return a.indexOf(e.gatewayId)!==-1&&e.gatewayPublicKey}));return n},t.prototype.getServerName=function(e){if(0===e.monikers.length)return null;if(0===e.monikers[0].monikerDataSources.length)return null;try{var t=JSON.parse(e.monikers[0].monikerDataSources[0].connectionDetails);return t.server}catch(e){return null}},t.prototype.getSelectedGateway=function(e){for(var t=[],i=_.some(e.monikers,(function(e){return 0===e.monikerDataSources.length})),a=0,n=e.monikers;a<n.length;a++){var o=n[a],s=_.map(o.monikerDataSources,(function(e){return e.dataSourceId}));if(!_.every(s))return i?_.find(e.gateways,(function(e){return _.isEmpty(e.gatewayName)})):void 0;t=t.concat(s)}var r=_.filter(e.datasources,(function(e){return t.indexOf(e.dataSourceId)>-1})),c=_.map(r,(function(e){return e.gatewayId})),l=_.uniq(c);if(1===l.length)return _.find(e.gateways,(function(e){return l[0]===e.gatewayId}))},t.prototype.isEGWAccessLost=function(e){for(var t=[],i=0,a=e.monikers;i<a.length;i++){var n=a[i],o=_.map(n.monikerDataSources,(function(e){return e.dataSourceId}));if(!_.every(o))return!1;t=t.concat(o)}if(t.length>0)for(var s=0,r=t;s<r.length;s++){var c=r[s];if(!_.find(e.datasources,(function(e){return e.dataSourceId===c})))return!0}return!1},t.prototype.getSelectedGatewayType=function(e){return e?_.isEmpty(e.gatewayName)?1:2:0},t.prototype.showDialog=function(i,a,n){var o=new e.models.SelectGatewayModel(i,(!0),(!1),(!1)),s=this.rootScope.$new();s.viewModel=o;var r,c={dialogName:null,isDismissable:!0,scope:s,template:t.htmlTemplate,focusOnFirstButton:!0,dialogCssClass:"gatewaysDialog",dialogActions:[new InJs.ModalDialogAction(this.localizationService.get("SettingsGateways_Connect"),function(e,t){a(o.selectedGatewayId),r.closeDialog()}),new InJs.ModalDialogAction(this.localizationService.get("SettingsGateways_Cancel"),function(e,t){n(),r.closeDialog()})]};r=this.modalDialogService.showLegacyWebModalDialog(c)},t})();i.htmlTemplate="<select-gateway view-model='viewModel'> </select-gateway>",e.SelectGatewayService=i})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={})),angular.module("powerbi.settings").run(["$templateCache",function(e){e.put("components/adminPortal/adminPortal/adminPortal.html",'<div class="sliderContentView adminPortal"><div class="header label-xl"><span localize="AdminPortal_Title"></span></div><div class="adminPortalSpinner" ng-if="$ctrl.adminCapacityEnabled && !$ctrl.showOptionsList"><spinner class="centered xlarge"></spinner><div class="spinnerInfo" localize="Loading_Text"></div></div><div class="content" ng-if="$ctrl.showOptionsList"><div class="adminPortalLeftColumn"><ul class="contentOption"><li class="option label-med" ng-repeat="option in $ctrl.options track by option.type" ng-mousedown="$ctrl.onActiveOptionChanged(option.type)" ng-class="{selected: $ctrl.getCurrentAdminPortalSettingsTab() === option.type}" ng-if="$ctrl.isOptionAllowed(option)"><span ng-bind="::option.displayName"></span></li></ul></div><div class="adminPortalRightColumn" ng-switch="$ctrl.getCurrentAdminPortalSettingsTab()"><usage-metrics class="contentPane" ng-switch-when="1"></usage-metrics><manage-users class="contentPane" ng-switch-when="2"></manage-users><auditing class="contentPane" ng-switch-when="3" ng-if="::$ctrl.adminAuditingEnabled"></auditing><tenant-settings-container class="contentPane" ng-switch-when="4"></tenant-settings-container><capacity-admin-container class="contentPane" ng-switch-when="5" ng-if="::$ctrl.adminCapacityEnabled"></capacity-admin-container></div></div></div>'),e.put("components/adminPortal/auditing/auditing.html",'<div class="auditing"><div class="title label-xl trimmedTextWithEllipsis" localize="AdminPortal_Auditing_Title" localize-tooltip="AdminPortal_Auditing_Title"></div><div class="subtitle label-med trimmedTextWithEllipsis"><span localize="AdminPortal_Auditing_SubtitleV2" localize-fragments><pbi-link fragment-index="0" guid="823102" label="LearnMore"></pbi-link></span></div><div class="goToButton"><a class="btn primary" localize="AdminPortal_Auditing_ButtonText" ng-click="auditingPageLanding()"></a></div></div>'),e.put("components/adminPortal/dataClassifications/dataClassifications.html",'<ng-form name="{{::(\'$ctrl.\' + $ctrl.getFormName())}}"><div class="titleContainer" ng-click="$ctrl.toggleDetailsView()"><i class="glyphicon detailsViewExpander" ng-class="$ctrl.showDetails ? \'pbi-glyph-caretdownright\': \'pbi-glyph-caretright\'"></i><div class="tenantSettingTitle"><header class="displayName" localize="AdminPortal_TenantSettings_DataClassification_Title"></header><header class="statusMessage" ng-bind="$ctrl.statusMessage" ng-if="!$ctrl.dataClassificationsForm.$dirty"></header><header class="statusMessage unappliedChanges" localize="TenantSettingStatus_UnappliedChanges" ng-if="$ctrl.dataClassificationsForm.$dirty"></header></div></div><div class="details" ng-if="$ctrl.showDetails"><header class="description" localize="AdminPortal_TenantSettings_DataClassification_Description"></header><pbi-toggle class="toggleAction" ng-model="$ctrl.isEnabled" ng-change="$ctrl.onDataClassificationToggled()" no-label on-state-text="Enabled" off-state-text="Disabled"></pbi-toggle><div class="dataClassificationContainer" ng-if="$ctrl.isEnabled"><table pbi-table pbi-table-config="$ctrl.tableConfig"><tr ng-repeat="item in $ctrl.viewModel"><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_Default" class="default"><div class="pbi-input"> <input type="radio" name="dataClassification" ng-model="item.default" ng-value="true" ng-change="$ctrl.setDefaultDataClassification($index)"><label class="form-label label-med"></label></div></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_Classification" class="name"> <input type="text" ng-model="item.name"/></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_Shorthand" class="shorthand"> <input type="text" maxlength="4" ng-model="item.shortHand"/></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_ShowTag" class="showTag"><pbi-checkbox label="test" ng-model="item.showTag" localize-tooltip="AdminPortal_TenantSettings_DataClassification_ShowTagTooltip"></pbi-checkbox></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_URL"> <input type="text" ng-model="item.url"/></td><td class="remove"> <button ng-click="$ctrl.removeDataClassification($index)"><i class="glyphicon pbi-glyph-delete glyph-small"></i></button></td></tr></table> <button class="add" ng-click="$ctrl.addDataClassification()"><i class="glyphicon pbi-glyph-add glyph-small"></i><span localize="AdminPortal_TenantSettings_DataClassification_AddItem"></span></button></div><div class="nonGranularErrorMessageContainer" ng-if="$ctrl.errorMessage"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="errorMessage" ng-bind="$ctrl.errorMessage"></span></div><div class="applyButtonContainer"><pbi-button class="applyChangesButton" label="PBI_Button_Label_Apply" primary="true" ng-click="$ctrl.applyChanges()" ng-disabled="!$ctrl.dataClassificationsForm.$dirty"></pbi-button><pbi-button class="cancelChangesButton" label="PBI_Button_Label_Cancel" ng-click="$ctrl.cancelChanges()" ng-disabled="!$ctrl.dataClassificationsForm.$dirty"></pbi-button></div><div class="nonGranularInfoMessageContainer"><i class="glyphicon glyph-small pbi-glyph-info"></i><span class="infoMessage" localize="TenantSetting_NonGranularInfoMessage"></span></div></div></ng-form>'),e.put("components/adminPortal/manageUsers/manageUsers.html",'<div class="manageUsers"><div class="title label-xl trimmedTextWithEllipsis" localize="AdminPortal_ManageUsers_Title" localize-tooltip="AdminPortal_ManageUsers_Title"></div><div class="subtitle label-med trimmedTextWithEllipsis" localize="AdminPortal_ManageUsers_Subtitle" localize-tooltip="AdminPortal_ManageUsers_Subtitle"></div><div class="goToButton"><a class="btn primary" localize="AdminPortal_ManageUsers_ButtonText" ng-href="{{::o365AdminUserPageUrl}}" target="_blank"></a></div></div>'),e.put("components/adminPortal/tenantSetting/tenantSetting.html",'<ng-form name="{{::(\'$ctrl.\' + $ctrl.getFormName())}}"><div class="titleContainer" ng-click="$ctrl.toggleDetailsView()"><i class="glyphicon detailsViewExpander" ng-class="$ctrl.showDetails ? \'pbi-glyph-caretdownright\' : \'pbi-glyph-caretright\'"></i><div class="tenantSettingTitle"><header class="displayName" ng-bind="::$ctrl.viewModel.displayName"></header><header class="statusMessage" ng-bind="$ctrl.statusMessage" ng-if="!$ctrl.tenantSettingForm.$dirty"></header><header class="statusMessage unappliedChanges" localize="TenantSettingStatus_UnappliedChanges" ng-if="$ctrl.tenantSettingForm.$dirty"></header></div></div><div class="details" ng-if="$ctrl.showDetails"><header class="description" ng-bind="$ctrl.viewModel.description"></header><pbi-toggle class="toggleAction" ng-model="$ctrl.viewModel.isEnabled" ng-change="$ctrl.onEnabledToggleChange()" no-label on-state-text="Enabled" off-state-text="Disabled"></pbi-toggle><div class="infoMessageContainer guidanceInfoMessage" ng-if="$ctrl.showDisabledInfoMessage()"><i class="glyphicon glyph-small pbi-glyph-info"></i><div class="infoMessage" ng-bind="::$ctrl.viewModel.disabledInfoMessage"></div></div><div class="infoMessageContainer privacyInfoMessage" ng-if="::$ctrl.viewModel.privacy"><i class="glyphicon glyph-small pbi-glyph-securityalert"></i><div class="infoMessage"><span ng-if="$ctrl.viewModel.privacy.fragments" localize="{{::$ctrl.viewModel.privacy.privacyKey}}" localize-fragments><a fragment-index="0" localize="Terms" target="_blank" href="{{::$ctrl.viewModel.privacy.fragments.termsOfUseUrl}}"/><a fragment-index="1" localize="PrivacyPolicy" target="_blank" href="{{::$ctrl.viewModel.privacy.fragments.privacyPolicyUrl}}"/><a fragment-index="2" localize="LearnMore" target="_blank" href="{{::$ctrl.viewModel.privacy.fragments.learnMoreUrl}}"/></span><span ng-if="!$ctrl.viewModel.privacy.fragments" localize="{{::$ctrl.viewModel.privacy.privacyKey}}"/></div></div><div class="granularityControl" ng-if="$ctrl.viewModel.isEnabled && $ctrl.viewModel.isGranular"><div class="applyToRadioGroup"><pbi-radio-group ng-model="$ctrl.granularityState" label="TenantSetting_ApplyTo" ng-change="$ctrl.onRadioGroupSelectionChanged()"><pbi-radio label="TenantSetting_ApplyTo_EntireOrganization" ng-value="2"></pbi-radio><pbi-radio label="TenantSetting_ApplyTo_SpecificSecurityGroups" ng-value="3"></pbi-radio></pbi-radio-group></div><emails-list id="allowedSecurityGroupsBox" class="securityGroupsBox" view-model="$ctrl.viewModel.allowedSecurityGroups" ng-if="$ctrl.granularityState == 3" block-users allow-object-ids allow-security-groups></emails-list><pbi-checkbox class="deniedSecurityGroupsCheckbox" label="TenantSetting_ExceptSpecificSecurityGroups" ng-model="$ctrl.deniedSecurityGroupsEnabled" ng-change="$ctrl.onDeniedSecurityGroupsCheckboxChanged()"></pbi-checkbox><emails-list id="deniedSecurityGroupsBox" class="securityGroupsBox" ng-if="$ctrl.deniedSecurityGroupsEnabled" view-model="$ctrl.viewModel.deniedSecurityGroups" block-users allow-object-ids allow-security-groups></emails-list><div class="infoMessageContainer guidanceInfoMessage" ng-if="$ctrl.showEnabledForSecurityGroupsInfoMessage()"><i class="glyphicon glyph-small pbi-glyph-info"></i><div class="infoMessage" ng-bind="::$ctrl.viewModel.enabledForSecurityGroupsInfoMessage"></div></div></div><div class="applyButtonContainer"><pbi-button class="applyChangesButton" label="PBI_Button_Label_Apply" primary="true" ng-click="$ctrl.applyChanges()" ng-disabled="!$ctrl.tenantSettingForm.$valid || !$ctrl.tenantSettingForm.$dirty"></pbi-button><pbi-button class="cancelChangesButton" label="PBI_Button_Label_Cancel" ng-click="$ctrl.cancelChanges()" ng-disabled="!$ctrl.tenantSettingForm.$valid || !$ctrl.tenantSettingForm.$dirty"></pbi-button></div><div class="nonGranularInfoMessageContainer" ng-if="::!$ctrl.viewModel.isGranular"><i class="glyphicon glyph-small pbi-glyph-info"></i><span class="infoMessage" localize="TenantSetting_NonGranularInfoMessage"></span></div></div></ng-form>'),
e.put("components/adminPortal/tenantSettingsContainer/tenantSettingsContainer.html",'<div class="tenantSettingsContainer"><spinner class="centered" ng-show="isLoading"></spinner><div class="title label-xl" ng-if="::!areGranularTenantControlsEnabled" localize="AdminPortal_TenantSettings_Title" localize-tooltip="AdminPortal_TenantSettings_Title"></div><div class="settingsContent {{::areGranularTenantControlsEnabled ? \'\' : \'nonGranularSettings\'}}" ng-if="!isLoading"><div class="nonGranularTenantSettingsContainer" ng-if="::!areGranularTenantControlsEnabled" ng-repeat="featureSwitch in tenantSettings.featureSwitches"><div class="radioButton"><div class="radioButtonTitle label-med" ng-bind="::featureSwitch.displayName"></div><div class="radioButtonContainer"><div class="pbi-input"> <input type="radio" ng-model="featureSwitch.isEnabled" ng-value="true" ng-change="updateFormState()"><label class="form-label label-med" localize="ToggleSwitchOn"></label></div><div class="pbi-input"> <input type="radio" ng-model="featureSwitch.isEnabled" ng-value="false" ng-change="updateFormState()"><label class="form-label label-med" localize="ToggleSwitchOff"></label></div></div><div class="radioButtonPrivacy label-med" ng-if="::featureSwitch.privacy" ng-bind="::featureSwitch.privacy"></div></div></div><ng-form name="$ctrl.tenantSettingsForm" class="granularTenantSettingsContainer" ng-if="::areGranularTenantControlsEnabled"><div class="tenantSettingsGroup" ng-class="::{lastDivider: $last}" ng-repeat="tenantSettingsGroup in ::tenantSettings.tenantSettingsGroups"><div class="groupTitle" ng-bind="::tenantSettingsGroup.displayName"></div><div class="tenantSettingContainer" ng-repeat="tenantSetting in tenantSettingsGroup.tenantSettings"><tenant-setting view-model="tenantSetting"></tenant-setting></div><x-data-classifications view-model="tenantSettings.dataClassifications" ng-if="isDataClassificationFeatureEnabled && isDashboardGroup(tenantSettingsGroup.name)"></x-data-classifications><hr ng-if="::!$last"/></div></ng-form><div class="nonGranularTenantSettingsContainer dataClassificationSwitchContainer" ng-if="isDataClassificationFeatureEnabled && !areGranularTenantControlsEnabled"><div class="radioButton"><div class="radioButtonTitle label-med"><span localize="AdminPortal_TenantSettings_DataClassification_Title"></span><i class="glyphicon pbi-glyph-info glyph-small" localize-tooltip="AdminPortal_TenantSettings_DataClassification_RadioButtonTooltip"></i></div><div class="radioButtonContainer"><div class="pbi-input"> <input type="radio" ng-model="dataClassificationToggle.enabled" ng-value="true" ng-change="onDataClassificationToggled()"><label class="form-label label-med" localize="ToggleSwitchOn"></label></div><div class="pbi-input"> <input type="radio" ng-model="dataClassificationToggle.enabled" ng-value="false" ng-change="onDataClassificationToggled()"><label class="form-label label-med" localize="ToggleSwitchOff"></label></div></div></div></div><div class="dataClassificationContainer nonGranularTenantSettingsContainer" ng-if="isDataClassificationFeatureEnabled && dataClassificationToggle.enabled && !areGranularTenantControlsEnabled"><table pbi-table pbi-table-config="$ctrl.tableConfig"><tr ng-repeat="item in tenantSettings.dataClassifications"><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_Default" class="default"><div class="pbi-input"> <input type="radio" name="dataClassification" ng-model="item.default" ng-value="true" ng-change="setDefaultDataClassification($index)"> <label class="form-label label-med">&nbsp;</label></div></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_Classification" class="name"> <input type="text" ng-model="item.name" ng-change="updateFormState()"/></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_Shorthand" class="shortHand"> <input type="text" maxlength="4" ng-model="item.shortHand" ng-change="updateFormState()"/></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_ShowTag" class="showTag"><pbi-checkbox label="test" ng-model="item.showTag" localize-tooltip="AdminPortal_TenantSettings_DataClassification_ShowTagTooltip" ng-change="updateFormState()"></pbi-checkbox></td><td localized-header="AdminPortal_TenantSettings_DataClassificationTable_Column_URL"> <input type="text" ng-model="item.url" ng-change="updateFormState()"/></td><td class="remove"> <button ng-click="removeDataClassification($index)"><i class="glyphicon pbi-glyph-delete glyph-small"></i></button></td></tr></table> <button class="add" ng-click="addDataClassification()"><i class="glyphicon pbi-glyph-add glyph-small"></i><span localize="AdminPortal_TenantSettings_DataClassification_AddItem"></span></button></div><div class="settingsButtonContainer" ng-if="::!areGranularTenantControlsEnabled"><pbi-button id="applyChanges" label="AdminPortal_TenantSettings_ButtonText_Apply" primary="true" ng-disabled="!hasChanges" ng-click="applyChanges()"></pbi-button><pbi-button id="cancelChanges" label="PBI_Button_Label_Cancel" ng-disabled="!hasChanges" ng-click="cancelChanges()"></pbi-button></div></div></div>'),e.put("components/adminPortal/usageMetrics/usageMetrics.html",'<div class="usageMetrics"><iframe ng-src="/adminPortalDashboard" frameborder="0" scrolling="no"></iframe></div>'),e.put("components/gateway/upnMappingPane/upnMappingPaneView.html",'<div class="upnMappingPane"><header><h3 class="primaryHeading" localize="UpnMappingPane_Title"></h3><h6 class="secondaryHeading" localize="UpnMappingPane_Subtitle" localize-fragments><a fragment-index="0" href="//go.microsoft.com/fwlink/?LinkID=786855" target="_blank" localize="LearnMore"></a></h6></header><section class="contentContainer"><section class="dataSource"><h6 localize="UpnMappingPane_SelectDataSource"></h6><div class="pbi-input inline"> <input type="radio" ng-model="$ctrl.viewModel.connectionStringPropertyName" ng-value="0"/><label class="form-label" localize="UpnMappingPane_EffectiveUserName"></label></div><div class="pbi-input inline"> <input type="radio" ng-model="$ctrl.viewModel.connectionStringPropertyName" ng-value="1"/><label class="form-label" localize="UpnMappingPane_CustomData"></label></div></section><section class="mappingTable"><div class="mappingTableContainer"><div class="caption"><div localize="UpnMappingPane_Replace"></div><div localize="UpnMappingPane_With"></div></div><div class="tableContainer"><table><tr ng-repeat="rule in $ctrl.viewModel.mappingRules track by $index" ng-click="$ctrl.selectedRule = rule" ng-class="{selected: rule === $ctrl.selectedRule}"><td ng-bind="$index + 1"></td><td ng-bind="rule.searchString"></td><td ng-bind="rule.replacementString"></td></tr><tr><td ng-bind="$ctrl.viewModel.mappingRules.length + 1"></td><td> <input name="newSearchString" ng-model="$ctrl.newRule.searchString" placeholder="{{::$ctrl.localizedOriginalName}}"/></td><td> <input name="newReplacementString" ng-model="$ctrl.newRule.replacementString" placeholder="{{::$ctrl.localizedNewName}}"/></td></tr></table></div></div><div class="tableSelectionControl"><i class="glyphicon pbi-glyph-chevronupmedium glyph-small" ng-class="{disabled: !$ctrl.selectedRule}" ng-click="$ctrl.selectPre()"></i><i class="glyphicon pbi-glyph-chevrondownmedium glyph-small" ng-class="{disabled: !$ctrl.selectedRule}" ng-click="$ctrl.selectNext()"></i></div><div> <button localize="UpnMappingPane_Add" ng-disabled="!$ctrl.newRule.searchString || !$ctrl.newRule.replacementString" ng-click="$ctrl.addNewRule()"></button> <button localize="UpnMappingPane_Delete" ng-disabled="!$ctrl.selectedRule" ng-click="$ctrl.deleteRule()"></button></div></section><section class="testRule"><div localize="UpnMappingPane_TestRuleTitle"></div><div class="originalValue"><div localize="UpnMappingPane_OriginalName"></div><div> <input ng-model="$ctrl.testRuleOriginalName" placeholder="{{::$ctrl.localizedOriginalName}}"/> <button localize="UpnMappingPane_TestRuleButtonText" ng-disabled="!$ctrl.testRuleOriginalName" ng-click="$ctrl.testRule()"></button></div></div><div class="replacementValue"><div localize="UpnMappingPane_AfterRuleApplied"></div><div> <input ng-model="$ctrl.testRuleNewName" placeholder="{{::$ctrl.localizedResultOfApplyingMappingRule}}" readonly/><spinner ng-show="$ctrl.isTestRuleRequestPending"></spinner></div></div></section></section><footer><div class="buttons"><spinner ng-show="$ctrl.isUpdateDataSourceRequestPending"></spinner> <button class="biButton primary" type="button" localize="OK_ButtonText" ng-disabled="false" ng-click="$ctrl.saveChangesAndExit()"/> <button class="biButton" type="button" localize="Cancel_ButtonText" ng-click="$ctrl.closeUpnMappingPane()"/></div></footer></div>'),e.put("views/datasourceSettingsView.html",'<div class="formContainer" ng-cloak><header ng-switch on="viewModel.waitingForDataSourceStatus || viewModel.isLoadingForm"><div ng-switch-when="true"><spinner></spinner></div><div ng-switch-when="false"><div class="successContainer" ng-if="!viewModel.hasTestConnectionFailure && dataSourceModel.connected"><span class="glyphicon glyph-small pbi-glyph-success glyph-success-color"></span><span localize="SettingsDataSource_SettingsConnectionSuccessfulText"></span></div><div ng-if="dataSourceModel.connectionError"><inline-message use-error-icon trace-details="dataSourceModel.traceDetails"><span localize="SettingsDataSource_SettingsConnectionErrorTitle"></span><span ng-bind="dataSourceModel.connectionError"></span></inline-message></div><div class="messageContainer" ng-switch on="viewModel.messageState"><div ng-switch-when="1"><inline-message class="inlineInfo"><span class="glyphicon glyph-small pbi-glyph-info"></span><span localize="SettingsDataSource_SettingsAddUserText1" localize-fragments><a fragment-index="0" href=\'\' localize="SettingsDataSource_SettingsAddUserText2" ng-click="switchToUserTab()"></a></span></inline-message></div><div ng-switch-when="2"><inline-message use-error-icon trace-details="dataSourceModel.traceDetails"><span ng-bind="dataSourceModel.errorTitle"></span><span ng-bind="dataSourceModel.compositeErrorMessage"></span></inline-message></div></div></div></header><form name="settingsForm" autocomplete="off" ng-hide="viewModel.isLoadingForm"><section><label for="dataSourceName" class="input-field-label" localize="SettingsDataSource_SettingsName"></label> <input id="dataSourceName" select-pristine-on-focus type="text" ng-disabled="!viewModel.isAddingDataSource || viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings.dataSourceName" required/></section><section><label for="dataSourceType" class="input-field-label" localize="SettingsDataSource_SettingsType"></label> <select id="dataSourceType" ng-disabled="!viewModel.isAddingDataSource || viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings.dataSourceType" ng-change="onDataSourceTypeChange()" ng-options="option.id as option.name for option in viewModel.dataSourceTypeOptions | filter: {name: \'\'}" required><option value="" disabled localize="SettingsGateway_SelectDataSourceType">Select a data source type</option></select></section><div class="connectionSettings" ng-show="viewModel.editableSettings.dataSourceType !== undefined"><section ng-repeat="label in viewModel.dataSourceTypeOptions[viewModel.editableSettings.dataSourceType].labels"> <label for="{{label.name}}" class="input-field-label">{{label.displayName}}</label> <input id="{{label.name}}" type="{{label.type}}" ng-disabled="!viewModel.isAddingDataSource || viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings[label.name]" required/></section><section ng-show="viewModel.dataSourceTypeOptions[viewModel.editableSettings.dataSourceType].authenticationMethodOptions.length> 1"><label for="dataSourceAuthenticationMethod" class="input-field-label" localize="SettingsDataSource_SettingsAuthenticationMethod"></label> <select id="dataSourceAuthenticationMethod" ng-disabled="viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings.authenticationMethod" ng-change="onAuthenticationMethodChange()" ng-options="option.id as option.name for option in viewModel.dataSourceTypeOptions[viewModel.editableSettings.dataSourceType].authenticationMethodOptions" required><option value="" disabled localize="SettingsGateway_SelectAnAuthenticationMethod">Select an authentication method</option></select></section><div ng-show="viewModel.editableSettings.authenticationMethod !== undefined && viewModel.editableSettings.authenticationMethod !== 0 && viewModel.editableSettings.authenticationMethod !== 2"><section><span localize="SettingsDataSource_SettingsCredentialEncryptionText"></span> &#32;<a target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=627092" localize="LearnMore"></a></section><section ng-show="viewModel.editableSettings.authenticationParameters[0].shouldDisplay"> <label for="authenticationParameter1" class="input-field-label">{{viewModel.editableSettings.authenticationParameters[0].displayName}}</label> <input id="authenticationParameter1" type="text" ng-disabled="viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings.authenticationParameters[0].value" ng-change="onAuthenticationParameter1Change()" ng-focus="onAuthenticationParameter1Focus()" ng-blur="onAuthenticationParameter1Blur()" ng-required="viewModel.editableSettings.authenticationParameters[0].shouldDisplay"/></section><section ng-show="viewModel.editableSettings.authenticationParameters[1].shouldDisplay"> <label for="authenticationParameter2" class="input-field-label">{{viewModel.editableSettings.authenticationParameters[1].displayName}}</label> <input id="authenticationParameter2" type="password" ng-disabled="viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings.authenticationParameters[1].value" ng-change="onAuthenticationParameter2Change()" ng-focus="onAuthenticationParameter2Focus()" ng-blur="onAuthenticationParameter2Blur()" ng-required="viewModel.editableSettings.authenticationParameters[1].shouldDisplay"/></section></div><section ng-if="enterpriseGatewayETLEnabled"><div class="advancedSettingsContainer" ng-class="{expanded: viewModel.advancedSettingsExpanded}"><i class="glyphicon pbi-glyph-chevronrightmedium expandIcon" ng-click="viewModel.advancedSettingsExpanded = !viewModel.advancedSettingsExpanded; $event.stopPropagation();"></i><span localize="SettingsDataSource_AdvancedSettings"></span><div ng-show="viewModel.advancedSettingsExpanded"><section ng-if="allowSingleSignOn()" id="singleSignOnOptionSection"><div class="singleSignOnSettingCheckBox"> <input id="singleSignOnForDQ" type="checkbox" ng-model="viewModel.isSingleSignOnEnabled" ng-change="onSingleSignOnSettingChange()"/><label class="singleSignOnSettingDescription" localize="SettingsDataSource_SettingsSingleSignOn_Text" for="singleSignOnForDQ"/></div><div class="singleSignOnSettingDescription"><span localize="SettingsDataSource_SettingsSingleSignOn_Info"></span><a target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=627092" localize="LearnMore"></a></div></section><section><label for="dataSourcePrivacyLevel" class="input-field-label" localize="SettingsDataSource_SettingsPrivacyLevelLabel"></label> <select id="dataSourcePrivacyLevel" ng-disabled="viewModel.waitingForDataSourceStatus" ng-model="viewModel.editableSettings.privacyLevel"><option value="0" localize="SettingsDataSource_SettingsPrivacyLevel_None" ng-selected="viewModel.editableSettings.privacyLevel === 0"></option><option value="1" localize="SettingsDataSource_SettingsPrivacyLevel_Private" ng-selected="viewModel.editableSettings.privacyLevel === 1"></option><option value="2" localize="SettingsDataSource_SettingsPrivacyLevel_Organizational" ng-selected="viewModel.editableSettings.privacyLevel === 2"></option><option value="3" localize="SettingsDataSource_SettingsPrivacyLevel_Public" ng-selected="viewModel.editableSettings.privacyLevel === 3"></option></select></section></div></div></section></div><div class="buttonsContainer" ng-if="viewModel.editableSettings.dataSourceType !== undefined"><div ng-switch on="viewModel.isAddingDataSource"> <button class="primary" localize="SettingsDataSource_SettingsApply" ng-switch-when="false" ng-disabled="viewModel.waitingForDataSourceStatus || !settingsForm.$dirty" ng-click="tryApplyChanges()"></button> <button class="primary" localize="SettingsDataSource_SettingsAdd" ng-switch-when="true" ng-disabled="viewModel.waitingForDataSourceStatus" ng-click="tryAddDataSource()"></button> <button localize="SettingsDataSource_SettingsDiscard" ng-disabled="!settingsForm.$dirty || viewModel.waitingForDataSourceStatus" ng-click="tryDiscardChanges()" formnovalidate></button></div></div></form></div>'),e.put("views/datasourceUsersView.html",'<div class="formContainer verticalPaneContainer" ng-cloak><div class="leftVerticalPane"><section class="pendingUsersContainer"><label class="input-field-label" localize="SettingsDataSource_UsersAllowed"></label><emails-list view-model="viewModel.pendingUsers" allow-security-groups allow-unified-groups></emails-list></section><section class="editableUsersContainer"><div class="editableUsersTable"><div class="tableContentContainer" ng-switch on="viewModel.isReloadingList || viewModel.isAdding"><div ng-switch-when="true"><spinner></spinner></div><div ng-switch-when="false" ng-repeat="editableUser in viewModel.editableUsers" class="pbi-input"> <input type="checkbox" ng-model="editableUser.shouldBeRemoved"> <label class="form-label">{{editableUser.name}}</label></div></div></div> <button localize="SettingsDataSource_SettingsRemove" ng-disabled="viewModel.isReloadingList || shouldDisableRemoveButton()" ng-click="tryRemoveSelectedUsers()"></button> <button class="rightSideButton" ng-if="upnMappingEnabled" localize="UpnMappingPane_Title" ng-disabled="!viewModel.editableUsers || viewModel.editableUsers.length === 0" ng-click="mapUserNames()"></button></section></div><div class="rightVerticalPane"> <button class="primary" localize="SettingsDataSource_SettingsAdd" ng-disabled="viewModel.isAdding || !viewModel.pendingUsers.inputUserList" ng-click="tryAddUsers()"></button></div></div>'),e.put("views/datasourceView.html",'<div class="settingsContainer" ng-cloak><div class="tabHeader"><ul><li ng-click="onTabSelected(1)" ng-class="{selected: viewModel.tabSelectionType === 1}" localize="SettingsDataSource_SettingsTitle"></li><li ng-click="onTabSelected(2)" ng-class="{selected: viewModel.tabSelectionType === 2}" ng-if="viewModel.id !== -1" localize="SettingsDataSource_UsersTitle"></li></ul></div><div ng-switch on="viewModel.tabSelectionType"><datasource-settings ng-switch-when="1" datasource-model="viewModel"></datasource-settings><datasource-users ng-switch-when="2" datasource-model="viewModel"></datasource-users></div></div>'),e.put("views/gatewayAdministratorsView.html",'<div class="formContainer verticalPaneContainer" ng-cloak><div class="leftVerticalPane"><section class="pendingUsersContainer"><label class="input-field-label" localize="SettingsDataSource_AdminsAllowed"></label><emails-list view-model="viewModel.pendingUsers" allow-security-groups allow-unified-groups></emails-list></section><section class="editableUsersContainer"><div class="editableUsersTable"><div class="tableContentContainer" ng-switch on="viewModel.isReloadingList || viewModel.isAdding"><div ng-switch-when="true"><spinner></spinner></div><div ng-switch-when="false" ng-repeat="editableUser in viewModel.editableUsers" class="pbi-input"> <input type="checkbox" ng-model="editableUser.shouldBeRemoved"> <label class="form-label">{{editableUser.name}}</label></div></div></div> <button class="rightSideButton" localize="SettingsDataSource_SettingsRemove" ng-disabled="viewModel.isReloadingList || shouldDisableRemoveButton()" ng-click="tryRemoveSelectedAdminstrators()"></button></section></div><div class="rightVerticalPane"> <button class="primary" localize="SettingsDataSource_SettingsAdd" ng-disabled="viewModel.isAdding || !viewModel.pendingUsers.inputUserList" ng-click="tryAddAdministrators()"></button></div></div>'),e.put("views/gatewaySettingsView.html",'<div class="formContainer" ng-cloak><header ng-switch="viewModel.isLoadingStatus"><div ng-switch-when="false" ng-switch="viewModel.status"><div ng-switch-when="1"><inline-message use-error-icon trace-details="viewModel.traceDetails"><span ng-bind="viewModel.connectionError"></span></inline-message></div><div ng-switch-when="2"><span class="glyphicon glyph-small pbi-glyph-success glyph-success-color"></span><span localize="SettingsGateway_ConnectedText"></span></div></div><div ng-switch-when="true"><div class="statusContainer"><spinner class="settingsLoadingSpinner"></spinner><span localize="SettingsGateway_WaitingForConnectinonText"></span></div></div><div class="warning" ng-if="viewModel.status === 2 && viewModel.dataSources.length === 0"><inline-message class="inlineInfo"><span class="glyphicon glyph-small pbi-glyph-info"></span><a href=\'\' localize="AddDataSourceToGatewayText" ng-click="addDataSource()"></a></inline-message></div></header><form name="settingsForm" autocomplete="off"><section><label for="gatewayName" class="input-field-label" localize="SettingsGateway_Name"></label> <input id="gatewayName" type="text" ng-disabled="viewModel.isWaitingForGatewayUpdate" ng-model=viewModel.displayName ng-change="updateDirtyFlag()"/></section><section><label for="gatewayDepartment" class="input-field-label" localize="SettingsGateways_Department"></label> <input id="gatewayDepartment" type="text" ng-disabled="viewModel.isWaitingForGatewayUpdate" ng-model=viewModel.gatewayAnnotation.gatewayDepartment ng-change="updateDirtyFlag()"/></section><section><label for="gatewayDescription" class="input-field-label" localize="SettingsGateway_Description"></label><textarea id="gatewayDescription" ng-disabled="viewModel.isWaitingForGatewayUpdate" ng-model="viewModel.description" ng-change="updateDirtyFlag()" ng-trim="false" maxlength="4000"/></section><section><label for="gatewayContactInfo" class="input-field-label" localize="SettingsGateway_ContactInformation"></label><textarea id="gatewayContactInfo" ng-disabled="viewModel.isWaitingForGatewayUpdate" ng-model="viewModel.contactInformationString" ng-change="updateDirtyFlag()" ng-trim="false" maxlength="4000"/></section><div class="buttonsContainer"> <button class="biButton primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="!viewModel.isDirty" ng-click="applyChanges()"></button> <button class="biButton" localize="SettingsDataSource_SettingsDiscard" ng-disabled="!viewModel.isDirty" ng-click="discardChanges()"></button></div></form></div>'),e.put("views/gatewaysView.html",'<div class="gatewaysSliderContentView" ng-switch="isLoading"><div class="gatewaysLayoutTop"><div class="sliderContentHeader"><div localize="EnterpriseGateway_Title" feature-switch-not="breadcrumbNavigationEnabled"></div><spinner class="large settingsLoadingSpinner" ng-switch-when="true"></spinner></div></div><div class="gatewaysLayoutBody" ng-switch-when="false" ng-switch="viewModel.gateways.length> 0" feature-switch-class="breadcrumbNavigationEnabled"><div ng-switch-when="true"><div class="settingsAddDataSource" ng-click="tryAddDataSource()"><span class="glyphicon glyph-mini pbi-glyph-add" feature-switch-not="breadcrumbNavigationEnabled"></span><span class="settingsAddDataSourceLabel" localize="AddDataSourceText"></span></div><div class="settingsGateways"><div class="settingsGatewaysLeftColumn"><div class="gatewayTree"><ul><li class="navTreeItem" ng-repeat="gateway in viewModel.gateways" ng-class="{expanded: gateway.isExpanded}"><div ng-click="onItemSelected(gateway.id, null)" ng-class="{selected: gateway.isExpanded ? viewModel.currentGatewayId === gateway.id && viewModel.currentDataSourceId === null : viewModel.currentGatewayId === gateway.id}"><div class="gatewayTreeItem"> <span class="expanderContainer"><i ng-show="gateway.dataSources.length>0" class="glyphicon refreshSectionExpander pbi-glyph-chevronrightmedium expandIcon" ng-click="gateway.isExpanded = !gateway.isExpanded; $event.stopPropagation();"></i></span><span class="gatewayLabel trimmedTextWithEllipsis" ng-bind="gateway.displayName"></span><span class="glyphicon pbi-glyph-warning glyph-small glyph-warning-color warningIcon" ng-if="gateway.status != 2"></span> <button class="contextMenuButton" context-menu localize-tooltip="NavigationPane_OpenMenu" context="gateway.contextMenuItem" ng-click="$event.stopPropagation()"><i class="glyphicon pbi-glyph-more gatewayMoreIcon"></i></button></div></div><div class="expandableInnerContainer" ng-show="gateway.isExpanded"><ul><li ng-repeat="dataSource in gateway.dataSources" ng-click="onItemSelected(gateway.id, dataSource.id)" class="gatewayTreeItem" ng-class="{selected: viewModel.currentGatewayId === gateway.id && viewModel.currentDataSourceId === dataSource.id}"><span class="gatewayLabel trimmedTextWithEllipsis" ng-bind="dataSource.displayName"></span><span class="glyphicon pbi-glyph-warning glyph-small glyph-warning-color warningIcon" ng-if="dataSource.connectionError || dataSource.compositeErrorMessage"></span> <button class="contextMenuButton" context-menu localize-tooltip="NavigationPane_OpenMenu" context="dataSource.contextMenuItem" ng-click="$event.stopPropagation()"><i class="glyphicon pbi-glyph-more gatewayMoreIcon"></i></button></li></ul></div></li></ul></div><div class="testConnectionContainer"> <button localize="SettingsGateway_TestConnections" ng-click="testConnections()"></button></div></div><div class="settingsGatewaysRightColumn"><div ng-switch on="getSelectionType()"><gateway ng-switch-when="1" view-model="viewModel.currentGateway"></gateway><datasource ng-switch-when="2" view-model="viewModel.currentDataSource"></datasource></div></div></div></div><div class="gatewaysEmpty unselectable" ng-switch-when="false"><i class="glyphicon pbi-glyph-warning glyph-med warningIcon"></i><h2 localize="Gateways_NoGatewaysWarningTitle"></h2><p localize="Gateways_NoGatewaysWarningText"></p><a href="https://go.microsoft.com/fwlink/?LinkId=627094" target="_blank" localize="LearnMore"></a></div></div></div>'),e.put("views/gatewayView.html",'<div class="settingsContainer" ng-cloak><div class="tabHeader"><ul><li ng-click="onTabSelected(1)" ng-class="{selected: viewModel.tabSelectionType === 1}"><span localize="SettingsGateway_SettingsTitle"></span></li><li ng-click="onTabSelected(2)" ng-class="{selected: viewModel.tabSelectionType === 2}"><span localize="GatewayDataSource_SettingsAdministrators"></span></li></ul></div><div ng-switch on="viewModel.tabSelectionType"><gateway-settings ng-switch-when="1" view-model="viewModel"></gateway-settings><gateway-administrators ng-switch-when="2" gateway-model="viewModel"></gateway-administrators></div></div>'),e.put("views/selectGatewayView.html",'<div class="selectGateway" ng-class="{\'noEGW\': viewModel.enterpriseGateways.length===0, \'singleEGW\': viewModel.enterpriseGateways.length===1, \'multipleEGW\': viewModel.enterpriseGateways.length> 1}"><div localize="SettingsDataset_Gateway_StaticInfo" localize-fragments><a fragment-index="0" localize="SettingsDataset_Gateway_StaticInfo_ManageGateways" href="" ng-click="navigateToManageGateways()"></a><a fragment-index="1" localize="LearnMore" target="_blank" href="//go.microsoft.com/fwlink/?LinkId=843378"></a></div><div ng-show="::viewModel.showHeader"><div class="title"><span ng-bind="viewModel.title"></span></div></div><div class="gatewayTypeSelectionContainer" ng-show="viewModel.allowPersonalGateway"><div class="gwOption" ng-switch on="viewModel.isCloudScheduleRefresh"><span ng-show="viewModel.showNewPersonalGatewayAvailableMessage"><label localize="SettingsDataset_New_OnPrem_Gateway_Available" class="newPersonalGatewayAvailableMessage"></label><a localize="SettingsDataset_OnPrem_Gateway_InstallNow" target="_blank" href="//go.microsoft.com/fwlink/?LinkID=534231" class="pgwLink"></a><a localize="LearnMore" target="_blank" href="//go.microsoft.com/fwlink/?LinkId=843378" class="pgwLink"></a></span> <span class="pbi-input"><input ng-switch-when="false" type="radio" name="pgwRadioOption" ng-model="viewModel.useEnterpriseGateway" ng-value="false" ng-change="gatewayTypeSelected()" ng-disabled="viewModel.pgw.gatewayStatus === 1"><label ng-switch-when="false" class="form-label" localize="SettingsDataset_GatewaySelectLabel_PGW"></label> <input ng-switch-when="true" type="radio" name="pgwRadioOption" ng-model="viewModel.useEnterpriseGateway" ng-value="false" ng-change="gatewayTypeSelected()" ng-disabled="isSovereignCloud"><label ng-switch-when="true" class="form-label" localize="SettingsDataset_GatewaySelectLabel_Cloud"></label></span><span class="additionalInfo" ng-switch-when="false"><span ng-show="viewModel.pgw.gatewayStatus === 0" localize="Gateways_StatusWithMachineName" localize-fragments><span fragment-index="0" class="gatewayStatusLabelOnline" localize="Gateways_Status_Online"></span><span fragment-index="1" ng-bind="viewModel.pgwAnnotation.gatewayMachine"></span></span><span ng-show="viewModel.pgw.gatewayStatus === 2 || viewModel.pgw.gatewayStatus === 3" localize="Gateways_StatusWithMachineName" localize-fragments><span fragment-index="0" class="gatewayStatusLabelOffline" localize="Gateways_Status_Offline"></span><span fragment-index="1" ng-bind="viewModel.pgwAnnotation.gatewayMachine"></span></span><span ng-show="viewModel.isDMTSPersonalGateway"><a localize="SettingsGateway_DeletePersonalGateway" target="_blank" class="pgwLink" ng-click="deletePersonalGateway()"></a></span></span></div><div class="gwOption"> <span class="pbi-input"><input type="radio" name="egwRadioOption" ng-model="viewModel.useEnterpriseGateway" ng-value="true" ng-change="gatewayTypeSelected()" ng-disabled="!viewModel.egwStatusLoaded || viewModel.enterpriseGateways.length === 0"><label class="form-label" localize="SettingsDataset_GatewaySelectLabel_EGW"></label></span><spinner ng-show="!viewModel.egwStatusLoaded"></spinner></div></div><div ng-show="viewModel.egwStatusLoaded"><div class="gatewaysIntroText hideIfNoEGW hideIfSingleEGW" localize="Gateways_MultipleEnterpriseGatewaysText"></div><div class="gatewaysIntroText hideIfNoEGW hideIfMultipleEGW" localize="Gateways_SingleEnterpriseGatewaysText" ng-show="!viewModel.allowPersonalGateway"></div><div class="gatewaysIntroText hideIfSingleEGW hideIfMultipleEGW" localize="Gateways_NoEnterpriseGatewaysText" ng-show="!viewModel.allowPersonalGateway"></div></div><div class="gatewaysTableOuterContainer hideIfNoEGW" ng-switch on="viewModel.egwStatusLoaded"><spinner ng-switch-when="false"></spinner><div class="gatewaysTableInnerContainer" ng-switch-when="true"><table class="gatewaysTable"><thead class="gatewaysTableHeader"><tr><th class="gatewaysTableSelection hideIfNoEGW hideIfSingleEGW"></th><th class="gatewaysTableStatus" ng-show="viewModel.showStatus"><div class="gatewaysTableHeaderContent" localize="SettingsGateways_Status"></div></th><th class="gatewaysTableDepartmentName"><div class="gatewaysTableHeaderContent" localize="SettingsGateways_Department"></div></th><th class="gatewaysTableGatewayName"><div class="gatewaysTableHeaderContent" localize="SettingsGateways_Gateway"></div></th><th class="gatewaysTableCreatedBy"><div class="gatewaysTableHeaderContent" localize="SettingsGateways_ContactInformation"></div></th><th class="gatewaysTableGatewayDescription"><div class="gatewaysTableHeaderContent" localize="SettingsGateway_Description"></div></th></tr></thead><tbody class="gatewaysTableBody"><tr ng-repeat="gateway in viewModel.enterpriseGateways" ng-click="enterpriseGatewaySelected(gateway.id)"><td class="egwRadioButton hideIfNoEGW hideIfSingleEGW"><div class="pbi-input"> <input type="radio" name="gwRadioOption" ng-model="viewModel.selectedGatewayId" ng-value="gateway.id" ng-click="enterpriseGatewaySelected(gateway.id)"><label class="dummyRadioButtonLabel"></label></div></td><td ng-show="viewModel.showStatus"><span ng-show="gateway.status === 1" class="gatewayStatusLabelOffline" localize="Gateways_Status_Offline"></span><span ng-show="gateway.status === 2" class="gatewayStatusLabelOnline" localize="Gateways_Status_Online"></span><spinner ng-show="gateway.status === 3" class="gatewayStatusSpinner glyph-mini"></spinner></td><td class="trimmedTextWithEllipsis"><span ng-bind="gateway.gatewayAnnotation.gatewayDepartment" title="{{gateway.gatewayAnnotation.gatewayDepartment}}"></span></td><td class="trimmedTextWithEllipsis"><span ng-if="gateway.displayName" ng-bind="gateway.displayName" title="{{gateway.displayName}}"></span><span ng-if="!gateway.displayName" localize="SettingsGateways_ConnectToCloudDatasource"></span></td><td class="trimmedTextWithEllipsis"><span ng-bind="gateway.gatewayAnnotation.gatewayContactInformation.join(\';\')" title="{{gateway.gatewayAnnotation.gatewayContactInformation.join(\';\')}}"></span></td><td><span ng-bind="gateway.description" title="{{gateway.description}}"></span></td></tr></tbody></table></div></div></div>');
}]);var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,a,o){return new n(e,t,i,a,o)}var a=e.common.contracts.GroupType;t.createAdminPortalService=i;var n=(function(){function i(e,t,i,a,n){this.promiseFactory=e,this.adminPortalHttpService=t,this.localizationService=i,this.telemetryService=a}return i.prototype.getTenantSettings=function(e){var i=this,a=this.promiseFactory.defer();return this.adminPortalHttpService.getTenantSettings(e).then((function(e){a.resolve(t.models.AdminPortalModelFactory.convertTenantSettings(e.data,i.localizationService))}),(function(e){a.reject(e)})),a.promise},i.prototype.updateTenantSettingsConfig=function(e,t){var i=this.promiseFactory.defer();return this.adminPortalHttpService.updateTenantSettingsConfig(e.map((function(e){return e.contract})),t).then((function(e){i.resolve(e)}),(function(e){i.reject(e)})),i.promise},i.prototype.getTenantSettingsV2=function(e){var i=this,a=this.promiseFactory.defer();return this.adminPortalHttpService.getTenantSettingsV2(e).then((function(e){a.resolve(t.models.AdminPortalModelFactory.convertTenantSettingsV2(e.data,i.localizationService))}),(function(e){a.reject(e)})),a.promise},i.prototype.updateTenantSettingsConfigV2=function(e,t){var i={featureSwitches:e.featureSwitches.map((function(e){return e.contract})),dataClassifications:e.dataClassifications};return this.adminPortalHttpService.updateTenantSettingsConfigV2(i,t)},i.prototype.updateTenantSetting=function(e,t){var i=this,a={featureSwitches:_.map([e],(function(e){return i.updateAndGetTenantSettingContract(e)})),dataClassifications:void 0};return this.adminPortalHttpService.updateTenantSettingsConfigV2(a,t)},i.prototype.updateDataClassifications=function(e,t){var i={featureSwitches:[],dataClassifications:e};return this.adminPortalHttpService.updateTenantSettingsConfigV2(i,t)},i.prototype.updateTenantSettingsAndDataClassifications=function(e,t,i){var a=this,n={featureSwitches:_.map(e,(function(e){return a.updateAndGetTenantSettingContract(e)})),dataClassifications:t};return this.adminPortalHttpService.updateTenantSettingsConfigV2(n,i)},i.prototype.refreshAndGetAdminUserMetadata=function(){if(!this._userMetadataPromise){var t=this.promiseFactory.defer(),i=this.telemetryService.startEvent(e.telemetry.DashboardRefreshAndGetUserMetadata);this.adminPortalHttpService.refreshAndGetAdminUserMetadata(i.event).then((function(e){t.resolve(e.data),i.resolve()}),(function(){t.reject(),i.reject()})),this._userMetadataPromise=t.promise}return this._userMetadataPromise},i.prototype.updateAndGetTenantSettingContract=function(e){return e.contract.isEnabled=e.isEnabled,e.contract.allowedSecurityGroups=this.createSecurityGroupsContracts(e.allowedSecurityGroups),e.contract.deniedSecurityGroups=this.createSecurityGroupsContracts(e.deniedSecurityGroups),e.contract},i.prototype.createSecurityGroupsContracts=function(e){var t=this;return _.map(e.inputUserList,(function(e){return t.createSecurityGroupContract(e)}))},i.prototype.createSecurityGroupContract=function(e){return{id:e.objectId,name:e.displayName,emailAddress:e.userPrincipalName,isEmailEnabled:e.groupType===a.EmailEnabledSecurityGroup}},i})()})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(){return new a}t.createAdminPortalHttpService=i;var a=(function(){function t(){}return t.prototype.getAdminUsageGroupMetadata=function(t,i){var a=e.common.httpService.powerbiRequestOptions(i,"GetAdminGroupContainer",{isAdminRequest:!0,groupObjectIdOverride:t});return e.common.httpService.get("powerbi/metadata/admingroupmetadata/",a)},t.prototype.getAdminUsageDashboardMetadata=function(t,i,a){var n=e.common.httpService.powerbiRequestOptions(a,"GetAdminUsageDashboardMetadata",{isAdminRequest:!0,groupObjectIdOverride:i});return e.common.httpService.get("powerbi/metadata/dashboards/"+t,n)},t.prototype.batchGetAdminUsageTiles=function(t,i,a,n){var o=e.common.httpService.powerbiRequestOptions(n,"BatchGetAdminUsageTiles",{isAdminRequest:!0,groupObjectIdOverride:a});return o.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/dashboard/"+t+"/tiles",JSON.stringify(i),o)},t.prototype.createAdminUsageDashboard=function(t,i){var a=e.common.httpService.powerbiRequestOptions(i,"createAdminUsageDashboard",{isAdminRequest:!0,groupObjectIdOverride:t});return e.common.httpService.get("powerbi/content/providers/adminportal/usage/",a)},t.prototype.getTenantSettings=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetTenantSettings",{isAdminRequest:!0});return i.enableTelemetry=!0,e.common.httpService.get("/powerbi/flight/tenantswitches",i)},t.prototype.updateTenantSettingsConfig=function(t,i){var a=e.common.httpService.powerbiRequestOptions(i,"UpdateTenantSettings",{isAdminRequest:!0});return a.enableTelemetry=!0,e.common.httpService.post("/powerbi/flight/tenantswitches",{switches:t},a)},t.prototype.getTenantSettingsV2=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetTenantSettings",{isAdminRequest:!0});return i.enableTelemetry=!0,e.common.httpService.get("/metadata/tenantsettings",i)},t.prototype.updateTenantSettingsConfigV2=function(t,i){var a=e.common.httpService.powerbiRequestOptions(i,"UpdateTenantSettings",{isAdminRequest:!0});return a.enableTelemetry=!0,e.common.httpService.put("/metadata/tenantsettings",t,a)},t.prototype.refreshAndGetAdminUserMetadata=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"RefreshAndGetAdminUserMetadata",{isAdminRequest:!0,dismissGroupObjectId:!0});return e.common.httpService.put("powerbi/metadata/refreshusermetadata",null,i)},t})()})(t=e.settings||(e.settings={}))})(powerbi||(powerbi={}));;var powerbi;!(function(i){var t;!(function(i){var t;!(function(i){i.userNotificationsInfoService="userNotificationsInfoService"})(t=i.constants||(i.constants={}))})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(t){angular.module("powerbi.userNotifications",[]).factory("userNotificationHttp",[function(){return i.userNotifications.createUserNotificationHttpService()}]).factory("userNotificationInfo",["userNotificationHttp","promiseFactory","telemetryService","$window","$interval","asyncFeatureSwitchService","syncService","userInfo","$timeout",function(t,e,o,n,s,r,a,c,f){return i.userNotifications.createUserNotificationInfoService({userNotificationHttpService:t,promiseFactory:e,telemetryService:o,intervalService:s,asyncFeatureSwitchService:r,syncService:a,userInfo:c,timeout:f},!0)}]).factory("userNotificationTileFilterService",["userNotificationInfo",function(t){return i.userNotifications.createUserNotificationTileFilterService(t)}])})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(i){var t;!(function(i){var t;!(function(i){i[i.NewFeatureProductMessage=0]="NewFeatureProductMessage",i[i.DashboardSharing=2]="DashboardSharing",i[i.DashboardAddedToGroup=3]="DashboardAddedToGroup",i[i.Trial=5]="Trial",i[i.DataDrivenAlert=6]="DataDrivenAlert",i[i.DynamicMessage=999]="DynamicMessage"})(t=i.NotificationCategory||(i.NotificationCategory={}));var e;!(function(i){i[i.DashboardContentPackNewVersion=0]="DashboardContentPackNewVersion",i[i.UsersNotifications_SharedDashboard=1]="UsersNotifications_SharedDashboard",i[i.ExtendTrial_TrialExpired=2]="ExtendTrial_TrialExpired",i[i.UsersNotifications_TrialRunsOutInLessThanADay=3]="UsersNotifications_TrialRunsOutInLessThanADay",i[i.UsersNotifications_TrialRunningOut=4]="UsersNotifications_TrialRunningOut",i[i.UsersNotifications_TitleTrialExpired=5]="UsersNotifications_TitleTrialExpired",i[i.UsersNotifications_UserName=6]="UsersNotifications_UserName",i[i.UsersNotifications_GoToApp=7]="UsersNotifications_GoToApp",i[i.UsersNotifications_GoToDashboard=8]="UsersNotifications_GoToDashboard",i[i.UsersNotifications_TrialRunsOutInOneDay=9]="UsersNotifications_TrialRunsOutInOneDay",i[i.UsersNotifications_TitleTrialRunsOutInOneDay=10]="UsersNotifications_TitleTrialRunsOutInOneDay",i[i.UsersNotifications_TitleTrialRunsOutInLessThanADay=11]="UsersNotifications_TitleTrialRunsOutInLessThanADay",i[i.UsersNotifications_TitleTrialRunningOut=12]="UsersNotifications_TitleTrialRunningOut",i[i.UsersNotifications_RequestExtensionLinkText=13]="UsersNotifications_RequestExtensionLinkText",i[i.UsersNotifications_DataDrivenAlert=14]="UsersNotifications_DataDrivenAlert",i[i.UsersNotifications_GroupName=15]="UsersNotifications_GroupName",i[i.UsersNotifications_NewDashboard=16]="UsersNotifications_NewDashboard",i[i.UsersNotifications_TileName=17]="UsersNotifications_TileName",i[i.UsersNotifications_DataDrivenDown=18]="UsersNotifications_DataDrivenDown",i[i.UsersNotifications_DataDrivenUp=19]="UsersNotifications_DataDrivenUp",i[i.UsersNotifications_GoToTile=20]="UsersNotifications_GoToTile",i[i.UsersNotifications_DatasetSettingChangeTitle=21]="UsersNotifications_DatasetSettingChangeTitle",i[i.UsersNotifications_DatasetInGroupWorkspaceSettingChangeMessage=22]="UsersNotifications_DatasetInGroupWorkspaceSettingChangeMessage",i[i.UsersNotifications_DatasetInMyWorkspaceSettingChangeMessage=23]="UsersNotifications_DatasetInMyWorkspaceSettingChangeMessage",i[i.UsersNotifications_LearnMore=24]="UsersNotifications_LearnMore",i[i.UsersNotifications_AlertTitle=1e3]="UsersNotifications_AlertTitle",i[i.UsersNotifications_AlertExceeded=1001]="UsersNotifications_AlertExceeded",i[i.UsersNotifications_AlertWentBelow=1002]="UsersNotifications_AlertWentBelow",i[i.UsersNotifications_AlertAction=1003]="UsersNotifications_AlertAction",i[i.UsersNotifications_AlertExceededNoTileName=1004]="UsersNotifications_AlertExceededNoTileName",i[i.UsersNotifications_AlertWentBelowNoTileName=1005]="UsersNotifications_AlertWentBelowNoTileName"})(e=i.NotificationResource||(i.NotificationResource={}));var o;!(function(i){i[i.DismissAll=0]="DismissAll",i[i.Dismiss=1]="Dismiss",i[i.SeenAll=2]="SeenAll",i[i.Seen=3]="Seen"})(o=i.UserNotificationsStatus||(i.UserNotificationsStatus={}))})(t=i.contracts||(i.contracts={}))})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(t){var e;!(function(t){var e=jsCommon.DateExtensions,o=i.common.utils.DateFormatter,n=(function(){function t(i,t){this.contract=i,this.localizationService=t,i.message&&(i.message.title&&(this.title=i.message.title.text||this.getLocalizedValue(i.message.title)),i.message.message&&(this.description=i.message.message.text||this.getLocalizedValue(i.message.message)),this.image=i.message.image);var n=i.createdTime;this.formattedDate=n?o.getPrettyRelativeDate(e.parseUtcDate(n),this.localizationService):"",this.seen=i.seen,i.action&&(this.actionText=i.action.resource.text?i.action.resource.text:this.getLocalizedValue(i.action.resource),this.actionPath=i.action.path,this.actionType=i.action.actionType)}return t.prototype.getLocalizedValue=function(t){var o=i.userNotifications.contracts.NotificationResource[t.displayTextResource];if(o&&t.values&&t.values.length>0){for(var n=[],s=0,r=t.values;s<r.length;s++){var a=r[s];switch(a.NotificationValueType){case 2:n.push(this.localizationService.formatValue(e.parseUtcDate(a.value)));break;case 1:var c=parseFloat(a.value);if(a.Format){var f=i.formattingService.formatValue(c,a.Format);n.push(this.localizationService.formatValue(f))}else n.push(this.localizationService.formatValue(a.value));break;default:n.push(this.localizationService.formatValue(a.value))}}return this.localizationService.format(o,n)}return this.localizationService.get(o)},t})();t.UserNotificationModel=n})(e=t.models||(t.models={}))})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(t){function e(){return new o}t.createUserNotificationHttpService=e;var o=(function(){function t(){}return t.prototype.getActiveNotification=function(t,e,o){var n=i.common.httpService.powerbiRequestOptions(t,"LoadMoreNotifications"),s="metadata/notifications?take="+e;return o&&(s=s+"&skip="+o),i.common.httpService.get(s,n)},t.prototype.getActiveNotificationSummary=function(t,e){var o=i.common.httpService.powerbiRequestOptions(t,"GetUserNotificationsSummary");return i.common.httpService.get("metadata/notifications/summary?take="+e,o)},t.prototype.updateNotificationStatus=function(t,e,o){var n;return n=o?i.common.httpService.powerbiRequestOptions(o,"UpdateUserNotificationsStatus"):i.common.httpService.powerbiRequestOptions(),i.common.httpService.put("metadata/notifications/"+t+"/action/"+e,null,n)},t.prototype.markNotificationsSeen=function(t,e){var o;o=e?i.common.httpService.powerbiRequestOptions(e,"UpdateUserNotificationsStatus"):i.common.httpService.powerbiRequestOptions();var n={ids:t};return i.common.httpService.put("metadata/notifications/action/"+i.userNotifications.contracts.UserNotificationsStatus.Seen+"/collections",n,o)},t})()})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(t){function e(i,t,e){return o||(o=new a(i,t,e)),o}var o;t.createUserNotificationInfoService=e;var n=100,s=6e5,r=6e3,a=(function(){function e(i,t,e){var o=this;this.notificationsUpdatedListeners=[],this.clientNotificationId=0,this.services=i,t&&!e&&(this.userNotifications={totalCount:0,unseenCount:0,notifications:[]},i.timeout((function(){o.initialize()}),r))}return e.prototype.getNextPageData=function(t){var e=this;t||(t=n);var o=this.services.telemetryService.startEvent(i.telemetry.UserNotificationsLoadMoreNotifications),s=this.userNotifications.notifications[this.userNotifications.notifications.length-1].id;this.services.userNotificationHttpService.getActiveNotification(o.event,t,s).then((function(i){e.userNotifications.notifications=e.userNotifications.notifications.concat(e.filterNotSupportedNotifications(i.data)),e.notifyNotificationsUpdated(),o.resolve()}),(function(i){o.reject()}))},e.prototype.registerNotificationsUpdatedListener=function(i){this.notificationsUpdatedListeners.push(i)},e.prototype.updateLastSeenDate=function(){if(this.userNotifications){this.userNotifications.unseenCount=0;var i=this.getLatestNotificationForServer(),e=i&&!i.seen;this.userNotifications.notifications.forEach((function(i){i.seen=!0})),this.notifyNotificationsUpdated(),e&&this.services.userNotificationHttpService.updateNotificationStatus(i.id,t.contracts.UserNotificationsStatus.SeenAll).then((function(i){}),(function(i){}))}},e.prototype.updateSeenNotifications=function(i){this.userNotifications&&(this.userNotifications.unseenCount-=i.length,this.userNotifications.notifications.forEach((function(t){_.contains(i,t.id)&&(t.seen=!0)})),this.notifyNotificationsUpdated(),this.services.userNotificationHttpService.markNotificationsSeen(i))},e.prototype.dismissNotification=function(e,o){if(this.userNotifications.totalCount=this.userNotifications.totalCount-1,this.userNotifications.notifications=_.filter(this.userNotifications.notifications,(function(i){return i.id!==e.id})),e.seen||(this.userNotifications.unseenCount=this.userNotifications.unseenCount-1),this.notifyNotificationsUpdated(),!o&&e.id>0){var n=this.services.telemetryService.startEvent(i.telemetry.UserNotificationsDismissNotification);this.services.userNotificationHttpService.updateNotificationStatus(e.id,t.contracts.UserNotificationsStatus.Dismiss,n.event).then((function(i){n.resolve()}),(function(i){n.reject()}))}},e.prototype.dismissAll=function(){if(this.userNotifications&&this.userNotifications.notifications.length>0){var e=this.getLatestNotificationForServer();if(this.userNotifications.totalCount=0,this.userNotifications.unseenCount=0,this.userNotifications.notifications=[],this.notifyNotificationsUpdated(),e){var o=this.services.telemetryService.startEvent(i.telemetry.UserNotificationsDismissAllNotifications);this.services.userNotificationHttpService.updateNotificationStatus(e.id,t.contracts.UserNotificationsStatus.DismissAll,o.event).then((function(i){o.resolve()}),(function(i){o.reject()}))}}},e.prototype.onNotificationAdded=function(){this.getActiveNotification(n)},e.prototype.onNotificationDismiss=function(i){var t=_.find(this.userNotifications.notifications,(function(t){return t.id===i}));t&&this.dismissNotification(t,!0)},e.prototype.onNotificationSeen=function(i){var t=this,e=!1;this.userNotifications.notifications.forEach((function(o){o.id<=i&&o.id>0&&!o.seen&&(o.seen=!0,t.userNotifications.unseenCount=t.userNotifications.unseenCount-1,e=!0)})),e&&this.notifyNotificationsUpdated()},e.prototype.onNotificationDismissAll=function(){this.userNotifications.totalCount>0&&this.getActiveNotification(n)},e.prototype.loadIcon=function(i){if(!i.iconUrl&&i.message.image&&i.message.image.imagePath)switch(i.message.image.imageType){case 0:this.services.userInfo.findOrGetUserPhoto(i.message.image.imagePath).then((function(t){i.iconUrl=t}));break;case 1:this.services.userInfo.findOrGetGroupPhoto(i.message.image.imagePath).then((function(t){i.iconUrl=t}))}},e.prototype.addClientNotification=function(i){i&&(i.id=this.clientNotificationId--,i.seen=!1,this.userNotifications&&(this.userNotifications.totalCount++,this.userNotifications.unseenCount++,this.userNotifications.notifications=[i].concat(this.userNotifications.notifications),this.notifyNotificationsUpdated()))},e.prototype.getHighestNotificationLevel=function(i){return!this.userNotifications||_.isEmpty(this.userNotifications.notifications)?1:_.max(i,(function(i){return i.notificationLevel})).notificationLevel},e.prototype.initialize=function(){var i=this;this.getActiveNotification(n),this.services.syncService.addNotificationsRefreshListener(this),this.services.intervalService((function(){i.getActiveNotification(n)}),s)},e.prototype.getLatestNotificationForServer=function(){var i=_.find(this.userNotifications.notifications,(function(i){return i.id>0&&!i.seen}));return i},e.prototype.mergeNotifications=function(i){if(i){this.userNotifications.totalCount=i.totalCount,this.userNotifications.unseenCount=i.unseenCount;var t=_.filter(this.userNotifications.notifications,(function(i){return i.id<=0}));if(t&&t.length>0){this.userNotifications.totalCount=i.totalCount+t.length;var e=_.filter(t,(function(i){return!i.seen}));e&&e.length>0&&(this.userNotifications.unseenCount=i.unseenCount+e.length)}var o=[],n=_.map(this.userNotifications.notifications,(function(i){return i.id}));o=_.filter(i.notifications,(function(i){return n.indexOf(i.id)<0})),o.length>0&&(t&&t.length>0?this.userNotifications.notifications=t.concat(o).concat(_.filter(this.userNotifications.notifications,(function(i){return i.id>0}))):this.userNotifications.notifications=o.concat(this.userNotifications.notifications))}},e.prototype.notifyNotificationsUpdated=function(){this.notificationsUpdatedListeners.forEach((function(i){i()}))},e.prototype.getActiveNotification=function(t){var e=this;void 0===t&&(t=n);var o=this.services.telemetryService.startEvent(i.telemetry.UserNotificationsGetNotificationsSummary);this.services.userNotificationHttpService.getActiveNotificationSummary(o.event,t).then((function(i){var t=e.filterNotSupportedUserNotifications(i.data);e.userNotifications&&e.userNotifications.notifications?e.mergeNotifications(t):e.userNotifications=t,e.notifyNotificationsUpdated(),o.resolve()}),(function(i){o.reject()}))},e.prototype.filterNotSupportedUserNotifications=function(i){if(i&&i.totalCount>0){i.notifications=this.filterNotSupportedNotifications(i.notifications);var t=_.filter(i.notifications,(function(i){return!i.seen}));i.unseenCount=t?t.length:0}return i},e.prototype.filterNotSupportedNotifications=function(i){return _.filter(i,(function(i){return t.contracts.NotificationCategory[i.notificationCategory]}))},e})()})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(i){function t(i){return new e(i)}i.createUserNotificationTileFilterService=t;var e=(function(){function i(i){this.userNotificationInfoService=i}return i.prototype.filterNotifications=function(i,t){if(_.isEmpty(i))return[];var e=t?t:this.tileId;return e?_.filter(i,(function(i){var t=i.message.filterProperties?i.message.filterProperties.TileId:null;if(!t)return!1;var o=parseInt(t,10);return(2===i.action.actionType||3===i.action.actionType)&&o===e})):i},i})()})(t=i.userNotifications||(i.userNotifications={}))})(powerbi||(powerbi={}));var powerbi;!(function(i){var t;!(function(t){function e(t,e,o,n,s,a,c,f,u,v,N,d){void 0===e&&(e=!1),void 0===o&&(o=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=void 0),void 0===f&&(f=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===N&&(N=!1),void 0===d&&(d=!1);var l={parentId:t,isError:e,errorSource:o,errorCode:n,errorMessage:s,activityName:a,activityId:c,isDebug:f,isCancelled:u,pingLatency:v,isAppInactive:N,isInCapacity:d},p={name:"PBI.UserNotifications.GetNotificationsSummary",category:i.TelemetryCategory.Verbose,time:Date.now(),id:r.generateGuid(),formatted:function(){return i.mergeFormattedEventInfo({parentId:l.parentId},{isError:l.isError,errorSource:i.telemetry.ErrorSource[l.errorSource],errorCode:l.errorCode,errorMessage:l.errorMessage,activityName:l.activityName,activityId:l.activityId,isDebug:l.isDebug,isCancelled:l.isCancelled,pingLatency:l.pingLatency,isAppInactive:l.isAppInactive,isInCapacity:l.isInCapacity})},info:l,loggers:i.telemetry.UserNotificationsGetNotificationsSummaryLoggers};return p}function o(t,e,o,n,s,a,c,f,u,v,N,d){void 0===e&&(e=!1),void 0===o&&(o=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=void 0),void 0===f&&(f=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===N&&(N=!1),void 0===d&&(d=!1);var l={parentId:t,isError:e,errorSource:o,errorCode:n,errorMessage:s,activityName:a,activityId:c,isDebug:f,isCancelled:u,pingLatency:v,isAppInactive:N,isInCapacity:d},p={name:"PBI.UserNotifications.LoadMoreNotifications",category:i.TelemetryCategory.CustomerAction,time:Date.now(),id:r.generateGuid(),formatted:function(){return i.mergeFormattedEventInfo({parentId:l.parentId},{isError:l.isError,errorSource:i.telemetry.ErrorSource[l.errorSource],errorCode:l.errorCode,errorMessage:l.errorMessage,activityName:l.activityName,activityId:l.activityId,isDebug:l.isDebug,isCancelled:l.isCancelled,pingLatency:l.pingLatency,isAppInactive:l.isAppInactive,isInCapacity:l.isInCapacity})},info:l,loggers:i.telemetry.UserNotificationsLoadMoreNotificationsLoggers};return p}function n(t,e,o,n,s,a,c,f,u,v,N,d){void 0===e&&(e=!1),void 0===o&&(o=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=void 0),void 0===f&&(f=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===N&&(N=!1),void 0===d&&(d=!1);var l={parentId:t,isError:e,errorSource:o,errorCode:n,errorMessage:s,activityName:a,activityId:c,isDebug:f,isCancelled:u,pingLatency:v,isAppInactive:N,isInCapacity:d},p={name:"PBI.UserNotifications.DismissNotification",category:i.TelemetryCategory.CustomerAction,time:Date.now(),id:r.generateGuid(),formatted:function(){return i.mergeFormattedEventInfo({parentId:l.parentId},{isError:l.isError,errorSource:i.telemetry.ErrorSource[l.errorSource],errorCode:l.errorCode,errorMessage:l.errorMessage,activityName:l.activityName,activityId:l.activityId,isDebug:l.isDebug,isCancelled:l.isCancelled,pingLatency:l.pingLatency,isAppInactive:l.isAppInactive,isInCapacity:l.isInCapacity})},info:l,loggers:i.telemetry.UserNotificationsDismissNotificationLoggers};return p}function s(t,e,o,n,s,a,c,f,u,v,N,d){void 0===e&&(e=!1),void 0===o&&(o=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===c&&(c=void 0),void 0===f&&(f=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===N&&(N=!1),void 0===d&&(d=!1);var l={parentId:t,isError:e,errorSource:o,errorCode:n,errorMessage:s,activityName:a,activityId:c,isDebug:f,isCancelled:u,pingLatency:v,isAppInactive:N,isInCapacity:d},p={name:"PBI.UserNotifications.DismissAllNotifications",category:i.TelemetryCategory.CustomerAction,time:Date.now(),id:r.generateGuid(),formatted:function(){return i.mergeFormattedEventInfo({parentId:l.parentId},{isError:l.isError,errorSource:i.telemetry.ErrorSource[l.errorSource],errorCode:l.errorCode,errorMessage:l.errorMessage,activityName:l.activityName,activityId:l.activityId,isDebug:l.isDebug,isCancelled:l.isCancelled,pingLatency:l.pingLatency,isAppInactive:l.isAppInactive,isInCapacity:l.isInCapacity})},info:l,loggers:i.telemetry.UserNotificationsDismissAllNotificationsLoggers};return p}var r=jsCommon.Utility;t.UserNotificationsGetNotificationsSummary=e,t.UserNotificationsLoadMoreNotifications=o,t.UserNotificationsDismissNotification=n,t.UserNotificationsDismissAllNotifications=s})(t=i.telemetry||(i.telemetry={}))})(powerbi||(powerbi={}));;var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}})(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,o=1,r=arguments.length;o<r;o++){t=arguments[o];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},__awaiter=this&&this.__awaiter||function(e,t,o,r){return new(o||(o=Promise))(function(i,a){function n(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):new o(function(t){t(e.value)}).then(n,s)}c((r=r.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function o(e){return function(t){return r([e,t])}}function r(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,a&&(n=a[2&o[0]?"return":o[0]?"throw":"next"])&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[0,n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(n=s.trys,!(n=n.length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var i,a,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return{next:o(0),throw:o(1),return:o(2)}},powerbi;!(function(e){var t;!(function(t){var o;!(function(t){t.contentPackDirtyShowNotification="contentPackDirty",t.reportDeletedEventName="reportDeleted",t.onDatasetAddedEventName="onDatasetAdded",t.deleteModelFailedEventName="deleteModelFailed",t.deleteModelStartedEventName="deleteModelStarted",t.onDashboardShallowEditEventName="onDashboardShallowEdit",t.mergeDashboardContainerModelsReportsAndPackagesEventName="mergeDashboardContainerModelsReportsAndPackages",t.updateDashboardContainerEventName="updateDashboardContainer",t.addOrUpdateDashboardEventName="addOrUpdateDashboard",t.samplesContentProviderId=-1,t.initialDashboardContainerLoadingState="#loading#",t.initialDashboardContainerErrorState="#error#",t.initialDashboardContainerReadyEventName="initialDashboardContainerReady",t.CannotDeleteModelPublishedToOrganizationalAppHeader="CannotDeleteModelPublishedToOrganizationalApp",t.shouldShowEnableCustomVisualsDialog="shouldShowEnableCustomVisualsDialog",t.seenDashboardsStorageKey="seenSharedDashboards",t.ScopedInstanceProviderName="dataServices",t.dashboardElementName=".dashboard";var o;!(function(e){e.reloadExcelWorkbookEventName="reloadExcelWorkbook",e.pinClickedEventName="pinClicked",e.editInExcelOnlineClickedEventName="editInExcelOnlineClicked",e.editInExcelClickedEventName="editInExcelClicked",e.calculateWorkbookClickedEventName="calculateWorkbookClicked",e.bindToExcelWorkbookEventName="bindToExcelWorkbook",e.openWorkbookContextMenuEventName="openWorkbookContextMenu",e.viewWorkbookEventName="viewWorkbook",e.renameWorkbookEventName="renameWorkbook",e.editWorkbookEventName="editWorkbook",e.scheduleRefreshWorkbookEventName="scheduleRefreshWorkbook",e.refreshNowWorkbookEventName="refreshNowWorkbook",e.removeWorkbookEventName="removeWorkbook",e.excelWebAppScriptsLoaded="excelWebAppScriptsLoaded",e.defaultKeepOriginalContentSize=!1,e.workbookAddedEventName="workbookAdded"})(o=t.workbook||(t.workbook={})),t.SingleValueRealTimeWindow=250,t.MultipleValueRealTimeWindow=6e4,t.RealTimeIntervals=[1,5,10,15,20,25,30,45,60],t.RealTimeDataSourceName="_RealTimeSchema_",t.modelPlaceholderImageUrl="/"+e.build+"/images/modelPlaceholder.png",t.packagePublishedSuccessfullyEventName="packagePublishedSuccessfully",t.packageVersionChange="packageVersionChange";var r;!(function(e){e.TileConfigVersion="1.1",e.NoVisualType="No visual type",e.InvalidElements="Invalid elements",e.NoSelect="Select expr doesn't exist for data role projection",e.InvalidSemanticQuery="Invalid Semantic Query",e.NoQuery="No query",e.NoPlugin="No plugin",e.Version1_0="Version 1.0",e.Version1_1="Version 1.1"})(r=t.upgrader||(t.upgrader={}))})(o=t.constants||(t.constants={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.RenameReport",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardRenameReportLoggers};return h}function r(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.DeleteReport",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardDeleteReportLoggers};return h}function i(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.InitializeNavigationPaneReports",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardInitializeNavigationPaneReportsLoggers};return h}function a(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.InitializeNavigationPaneModels",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardInitializeNavigationPaneModelsLoggers};return h}function n(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.RenameDataset",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardRenameDatasetLoggers};return h}function s(t,o,r,i,a,n,s,c,d,l,p,u,v,h){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),void 0===l&&(l=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var m={cortanaValue:t,qnaValue:o,parentId:r,isError:i,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:d,isDebug:l,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},f={name:"PBI.Dashboard.UpdateModelQnaFeatures",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({cortanaValue:m.cortanaValue,qnaValue:m.qnaValue,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardUpdateModelQnaFeaturesLoggers};return f}function c(t,o,r,i,a,n,s,c,d,l,p,u,v){void 0===r&&(r=!1),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=!1),void 0===l&&(l=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={count:t,parentId:o,isError:r,errorSource:i,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:d,isCancelled:l,pingLatency:p,isAppInactive:u,isInCapacity:v},m={name:"PBI.Dashboard.UpdateFeaturedQuestions",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({count:h.count,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardUpdateFeaturedQuestionsLoggers};return m}function d(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.DeleteDataset",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardDeleteDatasetLoggers};return h}function l(t,o){var r={tileType:t,message:o},i={name:"PBI.Dashboard.TileError",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileType:r.tileType,message:r.message},{})},info:r,loggers:e.telemetry.DashboardTileErrorLoggers};return i}function p(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.AddUpdateDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardAddUpdateDashboardLoggers};return h}function u(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===m&&(m=!1);var f={numNewUnseenSharedDashboards:t,numSharedDashboards:o,numAllDashboards:r,parentId:i,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:d,activityId:l,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:m},g={name:"PBI.Dashboard.SharingNewUnseenDashboards",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numNewUnseenSharedDashboards:f.numNewUnseenSharedDashboards,numSharedDashboards:f.numSharedDashboards,numAllDashboards:f.numAllDashboards,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.DashboardSharingNewUnseenDashboardsLoggers};return g}function v(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.InitializeNavigationPaneWorkbooks",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardInitializeNavigationPaneWorkbooksLoggers};return h}function h(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.UpdateLocalWorkbookNeverShowExplanation",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardUpdateLocalWorkbookNeverShowExplanationLoggers};return h}function m(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.RenameWorkbook",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardRenameWorkbookLoggers};return h}function f(t,o,r,i,a,n,s,c,d,l,p,u,v,h){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),void 0===l&&(l=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var m={storageProvider:t,contentProvider:o,parentId:r,isError:i,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:d,isDebug:l,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},f={name:"PBI.Dashboard.RemoveWorkbook",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({storageProvider:m.storageProvider,contentProvider:m.contentProvider,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardRemoveWorkbookLoggers};return f}function g(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.GetWorkbookWopiAccessInformation",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardGetWorkbookWopiAccessInformationLoggers};return h}function y(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f,g){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===d&&(d=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===g&&(g=!1);var y={etagHash:t,correlationId:o,storageProvider:r,permissions:i,contentProvider:a,parentId:n,isError:s,errorSource:c,errorCode:d,errorMessage:l,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:m,isAppInactive:f,isInCapacity:g},b={name:"PBI.Dashboard.WorkbookEmbeddingExternalSuccess",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({etagHash:y.etagHash,correlationId:y.correlationId,storageProvider:y.storageProvider,permissions:y.permissions,contentProvider:y.contentProvider,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.DashboardWorkbookEmbeddingExternalSuccessLoggers};return b}function b(t,o,r,i,a,n,s,c){var d={etagHash:t,errorCode:o,errorDescription:r,correlationId:i,storageProvider:a,permissions:n,contentProvider:s,message:c},l={name:"PBI.Dashboard.WorkbookEmbeddingExternalFailure",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({etagHash:d.etagHash,errorCode:d.errorCode,errorDescription:d.errorDescription,correlationId:d.correlationId,storageProvider:d.storageProvider,permissions:d.permissions,contentProvider:d.contentProvider,message:d.message},{})},info:d,loggers:e.telemetry.DashboardWorkbookEmbeddingExternalFailureLoggers};return l}function S(t,o,r,i,a,n,s,c,d,l,p,u,v,h){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),void 0===l&&(l=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var m={dashboardId:t,resourcePackagesCount:o,parentId:r,isError:i,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:d,isDebug:l,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},f={name:"PBI.Dashboard.ImportResourcePackagesOnLoad",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardId:m.dashboardId,resourcePackagesCount:m.resourcePackagesCount,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardImportResourcePackagesOnLoadLoggers};return f}function k(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.GetNavigationPanePackage",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardGetNavigationPanePackageLoggers};return h}function I(t,o,r,i){var a={Id:t,packageId:o,objectType:r,message:i},n={name:"PBI.Permissions.ObjectNotFound",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({Id:a.Id,packageId:a.packageId,objectType:a.objectType,message:a.message},{})},info:a,loggers:e.telemetry.PermissionsObjectNotFoundLoggers};return n}function C(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.Apps.GetApp",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.AppsGetAppLoggers};return h}function D(t,o,r,i,a,n,s,c,d,l,p,u,v,h){void 0===i&&(i=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=void 0),void 0===l&&(l=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var m={appGUID:t,contentProviderCategory:o,parentId:r,isError:i,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:d,isDebug:l,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},f={name:"PBI.Apps.UninstallApp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({appGUID:m.appGUID,contentProviderCategory:m.contentProviderCategory,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.AppsUninstallAppLoggers};return f}function T(t,o,r,i,a,n,s,c,d,l,p,u,v){void 0===r&&(r=!1),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===d&&(d=!1),void 0===l&&(l=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={error:t,parentId:o,isError:r,errorSource:i,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:d,isCancelled:l,pingLatency:p,isAppInactive:u,isInCapacity:v},m={name:"PBI.TileConfig.UpgradeTileConfig",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({error:h.error,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.TileConfigUpgradeTileConfigLoggers};return m}function w(t,o,r,i,a,n,s,c,d,l,p,u){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===i&&(i=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:o,errorSource:r,errorCode:i,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:d,pingLatency:l,isAppInactive:p,isInCapacity:u},h={name:"PBI.AppService.GetOrgAppsMetadata",category:e.TelemetryCategory.Verbose,time:Date.now(),id:P.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.AppServiceGetOrgAppsMetadataLoggers};return h}var P=jsCommon.Utility;t.DashboardRenameReport=o,t.DashboardDeleteReport=r,t.DashboardInitializeNavigationPaneReports=i,t.DashboardInitializeNavigationPaneModels=a,t.DashboardRenameDataset=n,t.DashboardUpdateModelQnaFeatures=s,t.DashboardUpdateFeaturedQuestions=c,t.DashboardDeleteDataset=d,t.DashboardTileError=l,t.DashboardAddUpdateDashboard=p,t.DashboardSharingNewUnseenDashboards=u,t.DashboardInitializeNavigationPaneWorkbooks=v,t.DashboardUpdateLocalWorkbookNeverShowExplanation=h,t.DashboardRenameWorkbook=m,t.DashboardRemoveWorkbook=f,t.DashboardGetWorkbookWopiAccessInformation=g,t.DashboardWorkbookEmbeddingExternalSuccess=y,t.DashboardWorkbookEmbeddingExternalFailure=b,t.DashboardImportResourcePackagesOnLoad=S,t.DashboardGetNavigationPanePackage=k,t.PermissionsObjectNotFound=I,t.AppsGetApp=C,t.AppsUninstallApp=D,t.TileConfigUpgradeTileConfig=T,t.AppServiceGetOrgAppsMetadata=w})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.none=0]="none",e[e.workbookTileGeneralError=10]="workbookTileGeneralError",e[e.workbookTileFileNotFound=11]="workbookTileFileNotFound",e[e.workbookTileObjectNotFound=12]="workbookTileObjectNotFound",e[e.workbookTileUnauthorized=13]="workbookTileUnauthorized"})(t=e.TileErrorCode||(e.TileErrorCode={}));var o;!(function(e){e[e.None=0]="None",e[e.InProgress=1]="InProgress",e[e.Completed=2]="Completed"})(o=e.TilePublishState||(e.TilePublishState={}));var r;!(function(e){e[e.composite=0]="composite",e[e.iframe=1]="iframe",e[e.image=2]="image",e[e.model=3]="model",e[e.ssrs=4]="ssrs",e[e.workbook=5]="workbook",e[e.report=6]="report",e[e.realTime=8]="realTime"})(r=e.TileType||(e.TileType={}));var i;!(function(e){e[e.PowerBIServiceException=0]="PowerBIServiceException",e[e.DSRException=1]="DSRException"})(i=e.QueryResultErrorType||(e.QueryResultErrorType={}));var a;!(function(e){e[e.SingleVisual=0]="SingleVisual"})(a=e.CompositeTileType||(e.CompositeTileType={}));var n;!(function(e){e[e.Undefined=0]="Undefined",e[e.AppTemplate=1]="AppTemplate",e[e.AppInstance=2]="AppInstance",e[e.AppCopy=3]="AppCopy"})(n=e.PackageType||(e.PackageType={}))})(t=e.contracts||(e.contracts={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report",e[e.Model=2]="Model",e[e.Workbook=3]="Workbook"})(t=e.ContentPackItems||(e.ContentPackItems={}))})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=e.common.contracts.ContentTileType,r=e.common.models.Model,i=(function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),Object.defineProperty(t.prototype,"contentTileType",{get:function(){
return o.AppDataset},enumerable:!0,configurable:!0}),t})(r);t.AppDataset=i})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.AppModelIconColors=["#000","#FFF"],e.AppModelIconBackgroundColors=[{color:"#01B8AA",fontColor:"#000"},{color:"#374649",fontColor:"#FFF"},{color:"#FD625E",fontColor:"#FFF"},{color:"#F2C80F",fontColor:"#000"},{color:"#5F6B6D",fontColor:"#000"},{color:"#8AD4EB",fontColor:"#000"},{color:"#FE9666",fontColor:"#000"},{color:"#A66999",fontColor:"#000"},{color:"#3599B8",fontColor:"#000"},{color:"#DFBFBF",fontColor:"#000"}],e.ServiceAppFallbackColors={color:"#374649",fontColor:"#FFF"},e.AppModelIcons=["financial","emi","group","realtime","image","pc1","paintbrush","world","streaming-data","user","barchart","gauge","globe","piedouble","areachart","comment","visualinteraction","code","shapes","piechart","stackedcolumn","scatter","database","home","insight"]})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r=e.common.contracts.ContentTileType,i=jsCommon.Lazy;o.DashboardAsyncLayoutDelayMs=100;var a=(function(){function e(e){this.contract=e,this.resetSampleFields(),this.hasOnPremiseModel=!1,this.isEnabled=!0,this.isUsedByContentPack=!1,this.isLoaded=e&&null!=e.tiles,this.hitCount=0,this.lazyTiles=null}return e.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&null!=(e=this.getPermissionsCallback())?e:this.contract&&this.contract.permissions},e.prototype.resetSampleFields=function(){this.isSharedSample=!1,this.isSample=!1,this.isNotified=!1,this.sampleProviderName=""},e.prototype.increaseHitCount=function(){this.hitCount++},Object.defineProperty(e.prototype,"tiles",{get:function(){return this.lazyTiles||(this.lazyTiles=new i(function(){return[]})),this.lazyTiles.getValue()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.contract.id},set:function(e){this.contract.id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"objectId",{get:function(){return this.contract.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canEdit",{get:function(){return t.DashboardUtils.isWriteable(this.contract)&&!(this.gridLayoutService&&this.gridLayoutService.strategy.isLayoutLocked)&&!this.contract.cached},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contentTileType",{get:function(){return r.Dashboard},enumerable:!0,configurable:!0}),e.prototype.isFilled=function(){return this.contract.tiles&&this.tiles.length===this.contract.tiles.length},e.prototype.calculateLayout=function(){this.layoutRequired=!1;var e=this.tiles;if(!_.isEmpty(e))for(var t=0,o=e;t<o.length;t++){var r=o[t];r.calculateLayout()}},e.prototype.applyLayout=function(){var e=this.tiles;if(!_.isEmpty(e))for(var t=0,o=e;t<o.length;t++){var r=o[t];r.applyLayout()}},e.prototype.runLayoutIfRequired=function(){this.layoutRequired&&(this.calculateLayout(),this.applyLayout())},e.prototype.scheduleDelayedLayout=function(e){var t=this;void 0===e&&(e=!1),this.layoutRequired||(this.layoutRequired=!0,e||setTimeout((function(){t.layoutRequired&&(t.calculateLayout(),t.applyLayout())}),o.DashboardAsyncLayoutDelayMs))},e.prototype.findTile=function(e){return _.find(this.tiles,(function(t){return t.id===e}))},e.prototype.findTileByObjectIdOrOriginalObjectId=function(e,t){if(e||t)return _.find(this.tiles,(function(o){return!_.isEmpty(e)&&o.contract.objectId===e||!_.isEmpty(t)&&o.contract.originalTileObjectId===t}))},e.prototype.getTileIndex=function(e){return _.findIndex(this.tiles,(function(t){return t.id===e}))},e.prototype.getTileContractIndex=function(e){return _.findIndex(this.contract.tiles,(function(t){return t.id===e}))},e.prototype.getUniquePackageId=function(){var e=this.contract;return e.originalPackageId?e.originalPackageId:e.packageIds&&1===e.packageIds.length?e.packageIds[0]:void 0},e.prototype.hasModel=function(e){return _.some(this.tiles,(function(t){return t.contract.modelId===e}))},e.prototype.hasOwnerInfo=function(){return!_.isEmpty(this.ownerFullname)||!_.isEmpty(this.ownerMail)},e})();o.Dashboard=a})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(r){function i(e,t,o,r,i,a,n,s,c,d,l,p){return new b(e,t,o,r,i,a,n,s,c,d,l,p)}var a=jsCommon.ArrayExtensions,n=e.common.contracts,s=n.ContentProviderCategory,c=n.ContentTileType,d=t.models,l=jsCommon.GzipUtility,p=jsCommon.JsonExtensions,u=jsCommon.Lazy,v=e.common.helpers.ModelConverterHelper,h=jsCommon.PerfTimer,m=n.PublishOrRefreshStatus,f=e.common.models.Report,g=t.contracts.TileType,y=e.explore.contracts.Version;r.createDataServiceModelConverter=i;var b=(function(){function i(e,t,o,r,i,a,n,s,c,d,l,p){this.geolocationService=e,this.telemetryService=t,this.visualPlugins=o,this.visualPluginOps=r,this.featureSwitchService=i,this.geocoder=a,this.promiseFactory=n,this.moduleLoader=s,this.permissionService=c,this.tileConfigUpgraderService=d,this.localizationService=l,this.explorationSerializer=p}return i.prototype.setModelMerger=function(e){this.modelMerger=e},i.prototype.convertCompositeTile=function(o){if(!o||o.type!==g.composite)return null;var i=this.convertTileConfig(o);this.convertTileLayoutConfig(o);var a;if(!i||!i.visualContainer)return null;a=new r.SingleVisualCompositeTileModel(o,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader),a.config=i.visualContainer,a.displayText=o.displayText,a.subDisplayText=o.subDisplayText;var n=t.ContractUtils.getMasterLayoutPosition(o);if(a.size={rowSpan:n.height,colSpan:n.width},a.isLoading=r.TileFactory.isTileLoading(o),o.queryResultError){a.isError=!0;var s=o.queryResultError;this.telemetryService.logEvent(e.telemetry.DashboardTileError,g[g.composite],jsCommon.StringExtensions.format("{0}:{1} with rootActivityId:{2}, modelId:{3} and tileId:{4}",jsCommon.EnumExtensions.toString(t.contracts.QueryResultErrorType,s.type),s.errorDetail,s.rootActivityId,o.modelId.toString(),o.id.toString()));var c=t.TileUtils.getTileErrorDetailsFromQueryResultError(s);c?(a.errorDetails=c,a.errorText=c.message):a.errorText=e.common.localize.get("Tile_ErrorText")}return a},i.prototype.convertTileData=function(t){if(t.tileDataSet)return t.tileDataSet;var o=this.convertTileConfig(t);try{t.tileDataSet=this.parseTileData(t,o.tileDataType)}catch(o){throw this.telemetryService.logEvent(e.telemetry.DashboardTileError,g[g.composite],jsCommon.StringExtensions.format("DsrParseError:{0} with modelId:{1} and tileId:{2}",o.message,t.modelId.toString(),t.id.toString())),o}return t.tileDataSet},i.prototype.convertDashboard=function(e,t,o,r){var i=this,a=this.convertDashboardShallow(e);return e.tiles&&(a.lazyTiles=new u(function(){return _.map(e.tiles,(function(e){return i.convertTile(e,t,o,r)}))})),a},i.prototype.convertDashboardShallow=function(e){var t=this,o=new r.Dashboard(e);return o.getPermissionsCallback=function(){return t.permissionService.getDashboardEffectivePermissions(e)},o.dataClassificationId=e.dataClassificationId,this.modelMerger.mergeDashboardShallow(o,e),o},i.prototype.convertIframeTile=function(e){if(!e||e.type!==g.iframe)return null;var t=new r.IframeTileModel(e),o=this.convertTileConfig(e);return this.convertTileLayoutConfig(e),o&&o.iframe&&(t.srcUrl=o.iframe.srcUrl,t.embedCode=o.iframe.embedCode),t.isLoading=r.TileFactory.isTileLoading(e),t},i.prototype.convertImageTile=function(e){if(!e||e.type!==g.image)return null;var o=new r.ImageTileModel(e);return this.convertTileLayoutConfig(e),o.displayText=e.displayText,o.subDisplayText=e.subDisplayText,"number"!=typeof o.contract.reportId||e.config?(o.isStatic=!1,o.imageUrl=this.getImageUrl(e)):(o.isStatic=!0,o.imageUrl=t.constants.modelPlaceholderImageUrl),o.isLoading=r.TileFactory.isTileLoading(e),o},i.prototype.convertContentPackBase=function(e){if(e){var o,r,i=p.tryParseJSON(e.providerConfig);i&&(o=_.isEmpty(i.shortDescription)||e.category!==s.ServiceApp&&e.category!==s.Services?i.description:i.shortDescription,r=i.author);var a={providerContract:e,providerId:e.providerId,displayText:e.displayText,iconUrl:e.iconUrl||"",description:o,publishTime:t.AppUtils.convertDate(e.publishTime),providerKey:e.providerKey,author:r,category:e.category,allowCopyContent:!0,dashboardIds:e.dashboardIds||[],reportIds:e.reportIds||[],modelIds:e.modelIds||[],workbookIds:e.workbookIds||[]};return a}},i.prototype.convertAppModelBase=function(e){var r=p.tryParseJSON(e.providerConfig);if(r&&r.appSettings){var i=r.appSettings;return{icon:i.iconName,iconColor:i.iconColor,iconBackgroundColor:i.iconBackgroundColor,headerBackgroundColor:i.headerBackgroundColor||t.AppUtils.getAppHeaderBackgroundColor(i.iconBackgroundColor),defaultContent:i.defaultAppArtifact,defaultContentOption:i.defaultAppArtifact?1:0}}if(e.category===s.ServiceApp||e.category===s.Services)return{iconColor:o.ServiceAppFallbackColors.fontColor,iconBackgroundColor:o.ServiceAppFallbackColors.color,headerBackgroundColor:t.AppUtils.getAppHeaderBackgroundColor(o.ServiceAppFallbackColors.color),defaultContentOption:0}},i.prototype.convertInstalledAppModel=function(e,o){var r=this.convertContentPackBase(e);if(r){var i=this.convertAppModelBase(e),a=__assign({objectId:e.providerKey,contentTileType:c.OrgApp,packageId:o.id,displayName:e.displayText,publishTime:t.AppUtils.convertDate(e.publishTime),getPermissions:function(){return n.Permissions.Read|n.Permissions.CopyOnWrite},dashboards:[],models:[],reports:[],workbooks:[],displayDate:t.AppUtils.convertDate(e.publishTime),isFavorite:!1,isFavoriteDisabled:!1,favoriteInfo:void 0},r,i);return t.AppUtils.isOrgApp(e)||(a.displayDate=t.AppUtils.convertDate(o.lastRefreshTime)),a}},i.prototype.convertModel=function(e){var t=this.convertModelShallow(e);return this.updateModelProperties(t,e),t},i.prototype.convertAppDataset=function(e){var t=new r.AppDataset(e);return this.updateModelProperties(t,e),t},i.prototype.convertModelTile=function(e){if(!e||e.type!==g.model)return null;var t=new r.ModelTileModel(e);return this.convertTileLayoutConfig(e),t.displayText=e.displayText,t.isLoading=r.TileFactory.isTileLoading(e),t.subDisplayText=e.subDisplayText,t},i.prototype.convertModelShallow=function(t){return new e.common.models.Model(t)},i.prototype.convertPackage=function(e){var t=this,o=this.convertPackageShallow(e);return e&&(o.contract=e,o.id=e.id,o.contentProviderId=e.contentProviderId,o.lastRefreshTime=e.lastRefreshTime,o.latestVersion=e.latestVersion,o.version=e.version,o.name=e.name,o.publishOrRefreshStatus=e.publishOrRefreshStatus||m.FinishedSuccessfully,o.packageType=e.packageType,o.originalPackageId=e.originalPackageId,o.getPermissionsCallback=function(){return t.permissionService.getPackageEffectivePermissions(e)}),o},i.prototype.convertPackageShallow=function(e){return new d.Package(e)},i.prototype.convertRealTimeTile=function(e){if(!e||e.type!==g.realTime)return null;var o=this.convertTileConfig(e);this.convertTileLayoutConfig(e);var i=new r.RealTimeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader);o&&o.realTimeVisual&&(i.config=o.realTimeVisual),i.displayText=e.displayText,i.subDisplayText=e.subDisplayText;var a=t.ContractUtils.getMasterLayoutPosition(e);return i.size={rowSpan:a.height,colSpan:a.width},i},i.prototype.convertReport=function(e){var t=this,o=this.convertReportShallow(e);return e&&(o.id=e.id,o.modelId=e.modelId,o.reportUrl=e.reportUrl,o.packagePublishStatus=e.packagePublishStatus||m.FinishedSuccessfully,o.name=e.name,o.displayName=e.displayName,o.description=e.description,o.fileName=e.fileName,o.packageId=e.packageId,o.packageVersion=e.packageVersion,o.contentProviderId=e.contentProviderId,o.objectId=e.objectId,o.getPermissionsCallback=function(){return t.permissionService.getReportEffectivePermissions(e)},this.fillReport(o,e)),o},i.prototype.convertReportShallow=function(e){return new f(e)},i.prototype.convertReportTile=function(e){return e&&e.type===g.report?(this.convertTileLayoutConfig(e),new r.ReportTileModel(e)):null},i.prototype.convertSpecificTileShallow=function(e,o){switch(this.convertTileLayoutConfig(e),e.type){case g.composite:var i=this.convertTileConfig(e);if(i&&i.visualContainer&&(o.composite=new r.SingleVisualCompositeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader)),o.composite){var a=t.ContractUtils.getMasterLayoutPosition(e);o.composite.size={rowSpan:a.height,colSpan:a.width},o.composite.isLoading=r.TileFactory.isTileLoading(e)}break;case g.iframe:o.iframe=new r.IframeTileModel(e),o.iframe.isLoading=r.TileFactory.isTileLoading(e);break;case g.image:o.image=new r.ImageTileModel(e),o.image.isLoading=r.TileFactory.isTileLoading(e);break;case g.model:o.model=new r.ModelTileModel(e),o.model.isLoading=r.TileFactory.isTileLoading(e);break;case g.ssrs:o.model=new r.SsrsTileModel(e),o.model.isLoading=r.TileFactory.isTileLoading(e);break;case g.workbook:o.workbook=new r.WorkbookTileModel(e,o),o.workbook.isLoading=r.TileFactory.isTileLoading(e);break;case g.report:o.model=new r.ReportTileModel(e),o.model.isLoading=r.TileFactory.isTileLoading(e);break;case g.realTime:this.convertTileConfig(e),o.realTime=new r.RealTimeTileModel(e,this.visualPlugins,this.visualPluginOps,this.featureSwitchService,this.geolocationService,this.geocoder,this.promiseFactory,this.moduleLoader)}},i.prototype.convertSsrsTile=function(e){if(!e||e.type!==g.ssrs)return null;this.convertTileLayoutConfig(e);var t=new r.SsrsTileModel(e);return e.config&&(t.imageUrl=this.getSsrsImageUrl(e)),t.isLoading=r.TileFactory.isTileLoading(e),t},i.prototype.convertTile=function(e,t,o,r){this.convertTileLayoutConfig(e);var i=this.convertTileShallow(e,t,o);if(this.modelMerger.mergeTile(i,e,t,o,r),null!=e.reportId){var a=this.getTileReport(e.reportId,o);a&&(i.report=i.report||new f(a),this.fillReport(i.report,a))}return i},i.prototype.convertTileLayoutConfig=function(e){if(!e.$layoutConfig){var t={x:e.col,y:e.row,width:e.colSpan,height:e.rowSpan},o=void 0;if(e.layoutConfig)try{o=JSON.parse(e.layoutConfig);var r=a.extendWithId(o.layouts),i=r.withId(0);i.position=t}catch(e){}else o={layouts:[{id:0,position:t}]};e.$layoutConfig=o,e.layoutConfig=JSON.stringify(o)}return e.$layoutConfig},i.prototype.convertTileAction=function(e){var t=e.$action;if(!t){var o;if(e.action&&0===e.action.indexOf("{"))try{o=JSON.parse(e.action)}catch(e){}else o={action:e.action};t=e.$action=o}return t},i.prototype.convertTileConfig=function(e){var t=e.$config;if(!t){var o=h.start("Parse tile config");try{t=e.$config=this.deserializeTileConfig(e.config);var r=t.visualContainer||t.realTimeVisual;this.deserializeVisualContainer(r);var i=r||t.visual;this.deserializeModelExtensions(i),this.tileConfigUpgraderService.upgrade(e.id,t,e.query)}catch(e){}finally{o()}}return t},i.prototype.deserializeTileConfig=function(e){var t=p.tryParseJSON(e);return null==t&&(t={version:y.ZeroStr}),t},i.prototype.deserializeVisualContainer=function(e){e&&e.visualContainer&&!e.$visualContainer&&(e.$visualContainer=this.explorationSerializer.deserializeVisualContainer(e.visualContainer))},i.prototype.deserializeModelExtensions=function(e){e&&e.modelExtensions&&!e.$modelExtensions&&(e.$modelExtensions=this.explorationSerializer.deserializeModelExtensions(e.modelExtensions))},i.prototype.convertTileShallow=function(e,t,o){this.convertTileLayoutConfig(e);var i=new r.Tile(e,this.localizationService);return this.modelMerger.mergeTileShallow(i,e,t,o),i},i.prototype.convertWorkbook=function(e){var t=this,o=this.convertWorkbookShallow(e);return e&&(o.id=e.id,o.modelId=e.modelId,o.viewUrl=this.getWorkbookViewUrl(e),o.editUrl=this.getWorkbookEditUrl(e),o.embedUrl=this.getWorkbookEmbedView(e),o.name=e.name,o.displayName=e.displayName,o.description=e.description,o.fileName=e.fileName,o.packageId=e.packageId,o.getPermissionsCallback=function(){return t.permissionService.getWorkbookEffectivePermissions(e)}),o},i.prototype.convertWorkbookShallow=function(e){return new r.Workbook(e)},i.prototype.convertWorkbookTile=function(e,o,i){if(!e||e.type!==g.workbook)return null;this.convertTileLayoutConfig(e);var a=new r.WorkbookTileModel(e,i);a.displayText=e.displayText,a.subDisplayText=e.subDisplayText,a.isLoading=r.TileFactory.isTileLoading(e),a.image=e.tileDataBinaryBase64Encoded,e.$config.workbookTile&&e.$config.workbookTile.keepOriginalContentSize?a.keepOriginalContentSize=e.$config.workbookTile.keepOriginalContentSize:a.keepOriginalContentSize=t.constants.workbook.defaultKeepOriginalContentSize;var n=e.$config.workbookTile;return o&&(n&&(a.embedUrl=o.embedUrl+"&item="+n.item),o.contract&&(a.webUri=o.contract.webUri)),a},i.prototype.fillDashboardChildren=function(e,t,o,r){var i=this,a=e.contract;e.displayName!==a.displayName&&(e.displayName=a.displayName),a.tiles&&(e.lazyTiles=new u(function(){return a.tiles.map((function(e){return i.convertTile(e,t,o,r)}))}))},i.prototype.fillModel=function(e,t){e.id=t.id,e.contract=t},i.prototype.fillReport=function(e,t){e.id=t.id,e.contract=t,e.reportUrl=t.reportUrl},i.prototype.getImageUrl=function(e){var t=this.convertTileConfig(e);if(t&&t.imageTile)return t.imageTile.imageUrl},i.prototype.getSsrsImageUrl=function(e){var t=this.convertTileConfig(e);if(t&&t.ssrsTile)return t.ssrsTile.imageUrl},i.prototype.getTileModel=function(e,t){var o=void 0;if(t){var r=a.indexOf(t,(function(t){return t&&t.id===e}));r!==-1&&(o=t[r])}return o},i.prototype.getTileReport=function(e,t){var o=void 0;if(t){var r=a.indexOf(t,(function(t){return t&&t.id===e}));r!==-1&&(o=t[r])}return o},i.prototype.getTileWorkbook=function(e,t,o){var r=void 0;if(o){var i=a.indexOf(o,(function(o){return o.id===e&&o.packageId===t}));i!==-1&&(r=o[i])}return r},i.prototype.resolveTilePackage=function(e,t){if(e.packageId){var o=a.indexOf(t,(function(t){return t.id===e.packageId}));o!==-1&&(e.tilePackage=t[o])}},i.prototype.getWorkbookViewUrl=function(e){return this.getWorkbookActionUrl(e,"view")},i.prototype.getWorkbookEditUrl=function(e){return this.getWorkbookActionUrl(e,"edit")},i.prototype.getWorkbookEmbedView=function(e){return this.getWorkbookActionUrl(e,"embedview")},i.prototype.getWorkbookActionUrl=function(e,t){return e.webUri&&e.etagHash?e.webUri+"/_layouts/WopiFrame.aspx?sourcedoc={"+e.etagHash+"}&action="+t:""},i.prototype.updateModelProperties=function(e,t){var o=this;t&&(e.id=t.id,e.isNew=t.isNew,e.cloudRlsEnabled=t.cloudRlsEnabled,e.name=t.name,e.displayName=t.displayName,e.description=t.description,e.fileName=t.fileName,e.packageId=t.packageId,e.packageVersion=t.packageVersion,e.contentProviderId=t.contentProviderId,e.isHidden=t.isHidden||!1,e.isRefreshInProgress=t.currentRefreshStartingTime&&v.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.dbName=t.dbName,e.vsName=t.vsName,e.realTimeMode=t.realTimeMode,e.getPermissionsCallback=function(){return o.permissionService.getModelEffectivePermissions(t)},this.fillModel(e,t))},i.prototype.parseTileData=function(e,t){var o,r=h.start("Parse tile data");try{if(e.tileDataBinaryBase64Encoded){var i=l.uncompress(e.tileDataBinaryBase64Encoded);o=JSON.parse(i)}else e.tileData&&(o=JSON.parse(e.tileData));return{type:t,data:o}}finally{r()}},i})()})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){function r(e,t){return new s(e,t)}var i=jsCommon.ArrayExtensions,a=jsCommon.Lazy,n=e.common.helpers.ModelConverterHelper;o.createDataServiceModelMerger=r;var s=(function(){function e(e,t){this.modelConverter=e,this.permissionService=t}return e.prototype.mergeDashboard=function(e,t,o,r,i){var n=this,s=this.modelConverter.convertDashboard(t,o,r,i);e.contract=t,e.displayName=s.displayName,e.getPermissionsCallback=function(){return n.permissionService.getDashboardEffectivePermissions(t)},e.contract.modelIds=t.modelIds,e.contract.reportIds=t.reportIds,e.contract.packageIds=t.packageIds,e.contract.workbookIds=t.workbookIds,e.qnaEnabled=t.qnaEnabled,e.gravityEnabled=t.gravityEnabled,e.isSharedFromSecurityGroup=t.isSharedFromSecurityGroup,e.isHidden=t.isHidden;var c=e.tiles;e.lazyTiles=new a(function(){var e=[];if(_.isEmpty(s.tiles))return e;for(var t=function(t){var a=_.find(c,(function(e){return e.id===t.id}));a?(e.push(a),n.mergeTile(a,t.contract,o,r,i)):e.push(t)},a=0,d=s.tiles;a<d.length;a++){var l=d[a];t(l)}return e})},e.prototype.mergeDashboardOwnerInfo=function(e,t){e.ownerFullname=t.givenName,t.familyName&&(e.ownerFullname=e.ownerFullname+" "+t.familyName),e.ownerMail=t.emailAddress,t.userObjectId&&(e.ownerUserObjectId=t.userObjectId),t.groupObjectId&&(e.ownerGroupObjectId=t.groupObjectId),e.contract.ownerInfo||(e.contract.ownerInfo=t)},e.prototype.mergeDashboardShallow=function(e,t){var o=this;if(t.displayName&&(e.displayName=t.displayName),void 0!==t.permissions&&(e.getPermissionsCallback=function(){return o.permissionService.getDashboardEffectivePermissions(t)}),t.modelIds&&(e.contract.modelIds=t.modelIds),t.reportIds&&(e.contract.reportIds=t.reportIds),t.workbookIds&&(e.contract.workbookIds=t.workbookIds),t.packageIds&&(e.contract.packageIds=t.packageIds),void 0!==t.qnaEnabled&&(e.qnaEnabled=t.qnaEnabled),void 0!==t.gravityEnabled&&(e.gravityEnabled=t.gravityEnabled),void 0!==t.isSharedFromSecurityGroup&&(e.isSharedFromSecurityGroup=t.isSharedFromSecurityGroup),void 0!==t.isHidden&&(e.isHidden=t.isHidden),void 0!==t.ownerInfo){var r=t.ownerInfo;this.mergeDashboardOwnerInfo(e,r)}e.sharedTime=t.sharedTime||"/Date(0)/"},e.prototype.mergeDashboardTiles=function(e,t){var o=t.models||[],r=t.reports||[],i=t.workbooks||[],a=t.packages||[],n=e.contract.tiles;if(n)for(var s=0,c=n;s<c.length;s++){var d=c[s];this.modelConverter.resolveTilePackage(d,a)}var l=e.tiles;if(l)for(var p=0,u=l;p<u.length;p++){var v=u[p];this.mergeTile(v,v.contract,o,r,i)}},e.prototype.mergeModel=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.isNew=t.isNew||e.isNew,e.getPermissionsCallback=function(){return o.permissionService.getModelEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.packagePublishStatus=null!=t.packagePublishStatus?t.packagePublishStatus:e.packagePublishStatus,e.isRefreshInProgress=t.currentRefreshStartingTime&&n.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.cloudRlsEnabled=t.cloudRlsEnabled,e.realTimeMode=t.realTimeMode)},e.prototype.mergeModelContentProviderId=function(e,o){if(e)for(var r=0;r<e.length;r++){var i=e[r];i.contentProviderId=i.contentProviderId||t.ContractUtils.findContentProviderId(o,i.packageId)}},e.prototype.mergeReport=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.objectId=t.objectId||e.objectId,e.modelId=t.modelId||e.modelId,e.reportUrl=t.reportUrl||e.reportUrl,e.getPermissionsCallback=function(){return o.permissionService.getReportEffectivePermissions(t)},e.packagePublishStatus=t.packagePublishStatus||e.packagePublishStatus,e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId)},e.prototype.mergeTileShallow=function(e,t,r,i){this.modelConverter.convertTileLayoutConfig(t),e.contract=t,e.type=t.type,this.mergeTileLayoutConfig(e,t),e.displayText=t.displayText,e.subDisplayText=t.subDisplayText,e.backgroundImageUrl=this.modelConverter.getImageUrl(t),e.errorCode=t.errorCode;var a=this.modelConverter.getTileReport(t.reportId,i);if(t.query&&t.query.modelQuery&&(e.utterance=t.query.modelQuery.utterance),e.action=this.modelConverter.convertTileAction(t),e.config=this.modelConverter.convertTileConfig(t),e.isLoading=o.TileFactory.isTileLoading(t),t.modelId){var n=this.modelConverter.getTileModel(t.modelId,r);n&&(e.vsName=n.vsName,e.dbName=n.dbName)}t.reportId&&(e.report=e.report||this.modelConverter.convertReport(a),e.report.id=t.reportId),a&&(this.modelConverter.fillReport(e.report,a),e.action||(e.action={action:"/openReport"})),this.modelConverter.convertSpecificTileShallow(t,e)},e.prototype.mergeTileLayoutConfig=function(e,t){if(!(e.layoutPosition.x&&e.layoutPosition.y&&e.layoutPosition.width&&e.layoutPosition.height)){var o=i.extendWithId(t.$layoutConfig.layouts),r=e.gridLayoutContext,a=r?r.getActiveLayout():0,n=o.withId(a);n&&this.mergeLayoutPosition(e.layoutPosition,n.position)}},e.prototype.mergeLayoutPosition=function(e,t){t&&(e.x=e.x||t.x,e.y=e.y||t.y,e.width=e.width||t.width,e.height=e.height||t.height)},e.prototype.mergeTile=function(e,t,r,i,a,n){var s=e.composite,c=e.realTime;this.mergeTileShallow(e,t,r,i),e.composite=this.modelConverter.convertCompositeTile(t),s&&e.composite&&(e.composite.setDataLoadEventDelegate(s.dataLoadEventDelegate),e.composite.copyDependencies(s),s instanceof o.SingleVisualCompositeTileModel&&e.composite instanceof o.SingleVisualCompositeTileModel&&this.mergeVisual(e.composite.visual,s.visual)),e.iframe=this.modelConverter.convertIframeTile(t),e.image=this.modelConverter.convertImageTile(t),e.model=this.modelConverter.convertModelTile(t),e.ssrs=this.modelConverter.convertSsrsTile(t);var d=this.modelConverter.convertRealTimeTile(t);if(this.updateTileRealTimeModel(e,c,d),e&&e.reportTile){var l=e.reportTile.exploration;e.reportTile=this.modelConverter.convertReportTile(t),e.reportTile.exploration=l}else e.reportTile=this.modelConverter.convertReportTile(t);if(!_.isEmpty(a)){var p=this.modelConverter.getTileWorkbook(t.workbookId,t.packageId,a);if(p){var u=this.modelConverter.convertWorkbook(p);e.workbook=this.modelConverter.convertWorkbookTile(t,u,e)}}if(i){var v=this.modelConverter.getTileReport(t.reportId,i);v?(e.report=e.report||this.modelConverter.convertReport(v),this.modelConverter.fillReport(e.report,v)):e.report=null,e.contractsReport=this.modelConverter.getTileReport(t.reportId,i)}else if(n){for(var h=void 0,m=0,f=n.length;m<f;m++)if(t.reportId===n[m].id){h=n[m];break}h&&(e.report=e.report||h,this.modelConverter.fillReport(e.report,h.contract),e.contractsReport=h.contract)}t.modelId&&(e.contractsModel=this.modelConverter.getTileModel(t.modelId,r))},e.prototype.mergeWorkbook=function(e,t){var o=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.getPermissionsCallback=function(){return o.permissionService.getWorkbookEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.packageId=t.packageId||e.packageId)},e.prototype.mergePackage=function(e,t){var o=this;e&&t&&(e.contract=t,e.contentProviderId=t.contentProviderId,e.id=t.id,e.lastRefreshTime=t.lastRefreshTime,e.latestVersion=t.latestVersion,e.name=t.name,e.publishOrRefreshStatus=t.publishOrRefreshStatus,e.version=t.version,e.originalPackageId=t.originalPackageId||e.originalPackageId,e.packageType=t.packageType||e.packageType,e.getPermissionsCallback=function(){return o.permissionService.getPackageEffectivePermissions(t)})},e.prototype.updateTileRealTimeModel=function(e,t,o){e.realTime=o,t&&e.realTime&&e.realTime.copyRealTimeModelDependencies(t)},e.prototype.mergeVisual=function(e,t){t.visual&&e.type===t.type&&(e.visual=t.visual),e.viewport=t.viewport},e})();o.DataServiceModelMerger=s})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return e.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&(e=this.getPermissionsCallback()),e?e:this.contract&&this.contract.permissions},e.prototype.hasUpdate=function(){return this.version&&this.latestVersion&&this.version!==this.latestVersion},e})();e.Package=t})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=e.common.models.DefaultGridLayoutStrategy,r=(function(t){function o(e,o){var r=t.call(this)||this;return r.displayWidth=e,r.displayHeight=o,r.minNumOfColumns=2,r.isLayoutLocked=!0,r}return __extends(o,t),o.prototype.calculateDisplayPositions=function(e){t.prototype.calculateDisplayPositions.call(this,e),this.scaleDashboard(e)},o.prototype.scaleDashboard=function(t){var r=this.getDashboardSize(t),i=o.calculateDashboardScaleFactor(r.width,r.height,this.displayWidth,this.displayHeight);if(!(i<=0)){var a={transform:"scale("+i+")",width:r.width+"px",height:this.displayHeight/i+"px",left:0};$(e.dataServices.constants.dashboardElementName).css(a)}},o.prototype.getDashboardSize=function(t){var o=this.getMaxColumnInLayout(t),r=this.getMaxRowInLayout(t);o<this.minNumOfColumns&&(o=this.minNumOfColumns);var i=e.common.GridLayoutConstants.defaultGridItemSpacing;return{width:o*this.gridWidth+i,height:r*this.gridHeight+i}},o.calculateDashboardScaleFactor=function(e,t,o,r){return o/e},o.prototype.getMaxRowInLayout=function(e){return _.max(_.map(e,(function(e){return e.displayRow-1+e.displaySize.rowSpan})))},o.prototype.getMaxColumnInLayout=function(e){return _.max(_.map(e,(function(e){return e.displayCol-1+e.displaySize.colSpan})))},o})(o);t.PhoneLandscapeTileLayoutStrategy=r})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o,r=e.dataServices.contracts.TileType;!(function(e){e.tileSpacing=12,e.smallTileRowSpan=4,e.defaultTileRowSpan=6,e.mediumTileRowSpan=7,e.largeTileRowSpan=9,e.resizeBuffer=10,e.aspectRatio=.1111})(o=t.PhoneTileLayoutConstants||(t.PhoneTileLayoutConstants={}));var i=(function(){function t(t,i){this.isLayoutLocked=!0,this.willOverrideDisplayPosition=!0,this.gridItemSpacing=o.tileSpacing,this.tileTypeRowSpanMap={},this.visualTypeRowSpanMap={},this.gridWidth=t-this.gridItemSpacing,this.gridHeight=Math.round(this.gridWidth*o.aspectRatio),this.gridMinWidthOnResize=this.gridWidth-o.resizeBuffer,this.gridMinHeightOnResize=this.gridHeight-o.resizeBuffer,this.gridMaxWidthOnResize=this.gridWidth*e.common.models.gridLayoutConstants.gridMaxColSpan,this.gridMaxHeightOnResize=this.gridHeight*e.common.models.gridLayoutConstants.gridMaxColSpan,this.tileTypeRowSpanMap[r.report]=o.mediumTileRowSpan,this.visualTypeRowSpanMap[e.visuals.plugins.card.name]=o.smallTileRowSpan,this.visualTypeRowSpanMap[e.visuals.plugins.animatedNumber.name]=o.smallTileRowSpan,this.visualTypeRowSpanMap[e.visuals.plugins.textbox.name]=o.smallTileRowSpan}return t.prototype.calculateDisplayPositions=function(t){for(var o=e.dataServices.DashboardUtils.orderItems(_.map(t,(function(e){return{getActiveLayoutPosition:function(){return e.getLayoutPosition()},getItem:function(){return e}}}))),r=1,i=0,a=o;i<a.length;i++){var n=a[i];n.displayCol=1,n.displayRow=r,this.calculateDisplaySize(n),r+=n.displaySize.rowSpan}this.removeScale()},t.prototype.calculateDisplaySize=function(e){var t=this.getRowSpan(e);e.displaySize={colSpan:1,rowSpan:t}},t.prototype.getRowSpan=function(e){var t=e.gridItem,r=this.tileTypeRowSpanMap[t.type];if(!r&&t.composite){var i=t.composite;null!==i&&(r=this.visualTypeRowSpanMap[i.visual.type])}return r||o.defaultTileRowSpan},t.prototype.removeScale=function(){$(e.dataServices.constants.dashboardElementName).removeAttr("style")},t.prototype.isDynamic=function(){return!1},t})();t.PhonePortraitTileLayoutStrategy=i})(o=t.models||(t.models={}));
})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(t){var o=(function(){function t(e,t){this.datasetInfo=e,this.definition=t}return Object.defineProperty(t.prototype,"databaseName",{get:function(){return this.datasetInfo.databaseName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryKey",{get:function(){return this.datasetInfo.resourceKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"secondaryKey",{get:function(){return this.datasetInfo.resourceKeySecondary},enumerable:!0,configurable:!0}),t.prototype.getPushUrl=function(){var e=window.tenantId,t=window.apiUri,o=window.clusterUri;"https://wabi-staging-us-east-redirect.analysis.windows.net"===o&&(t="https://powerbistagingapi.analysis.windows.net");var r="/beta/"+e+"/datasets/"+this.databaseName+"/rows",i=jsCommon.Utility.urlCombine(t,r),a={};return a.key=this.primaryKey,jsCommon.QueryStringUtil.addOrUpdateQueryStringToUrl(i,a)},t.createRealTimeDatasetDefinition=function(o,r,i){var a=i.schema(e.constants.RealTimeDataSourceName).entities,n=_.first(a),s=[];return _.map(n.properties,(function(e){s.push({name:e.displayName,dataType:t.convertToRealTimeDataType(e.type)})})),{name:o,columns:s,mode:r,tableName:n.name}},t.convertToRealTimeDataType=function(e){switch(e.primitiveType){case 3:case 4:return 1;case 7:return 2;case 1:return 0;case 5:return 3}},t})();t.RealTimeModel=o})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=e.common.GridLayoutConstants,r=(function(e){function t(t,o){var r=e.call(this,t,o)||this;return r.maxColumnsToDisaply=7,r.minColumnsToDisplay=3,r.portionOfNextColumn=.2,r}return __extends(t,e),t.prototype.getDashboardSize=function(e){var t=this.getMaxColumnInLayout(e),r=this.getMaxRowInLayout(e);t>this.maxColumnsToDisaply?t=this.maxColumnsToDisaply+this.portionOfNextColumn:t<this.minColumnsToDisplay&&(t=this.minColumnsToDisplay);var i=o.defaultGridItemSpacing;return{width:t*this.gridWidth+i,height:r*this.gridHeight+i}},t})(t.PhoneLandscapeTileLayoutStrategy);t.TabletTileLayoutStrategy=r})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r,i=e.common.GridLayoutConstants,a=e.data.services.DataViewObjectSerializer,n=e.data.services.DataViewTransformActionsSerializer,s=e.common.models.gridLayoutConstants,c=e.common.contracts.PinData,d=t.constants.upgrader.TileConfigVersion,l=t.contracts.TileType,p=jsCommon.Utility;!(function(o){function r(e,t,o){for(var r=0,i=o.length;r<i;r++){var a=o[r];if(a.vsName===e&&a.dbName===t)return a}}function u(e,t,o,r){return T(e,l.composite,t,o,r)}function v(e,t){var o=h(e,t);if(null!=e.realTimeDataWindow){var r=o;return r.dataWindow=e.realTimeDataWindow,{realTimeVisual:r,version:d}}return{version:d,visualContainer:o}}function h(e,t){var o={$visualContainer:e.visualContainer,$modelExtensions:e.modelExtensions};return m(o,e.dataTransforms,e.elements,e.tileLayoutType,e.queryMetadata,e.themeName,e.tileFilterDetails,e.tileHeading,e.tileSubDisplay,t,c.getVisualType(e)),o}function m(e,t,o,r,i,a,s,c,d,l,p){r&&(e.layoutType=r),a&&(e.themeName=a),o&&(e.elements=o),i&&(e.queryMetadata=i),c&&(e.heading1=c),s&&(e.heading2=s),d&&(e.heading3=d);var u=l.capabilities(p);t&&(e.transform=n.serializeTransformActions(n.serializeDataViewTransformActions(t,u&&u.objects)))}function f(e,o,r){var i=v(o,e);o.tileDataType&&(i.tileDataType=o.tileDataType);var a=T(i,null!=o.realTimeDataWindow?l.realTime:l.composite,o.query,o.dataViewSource,r);return a.publishState=t.contracts.TilePublishState.Completed,o.action&&(a.action=JSON.stringify(o.action)),null!=o.utterance&&(a.query.modelQuery.utterance=o.utterance),o.name&&(a.name=o.name),a.reportId=o.reportId,o.modelId&&(a.modelId=o.modelId),o.packageId&&(a.packageId=o.packageId),a.resourcePackageIds=o.resourcePackageIds,a}function g(e){var o=_.omit({id:++P,type:e.type,query:e.query,action:e.action,$config:e.$config,tileData:e.tileData,tileDataSet:e.tileDataSet,publishState:e.publishState,displayText:e.displayText,subDisplayText:e.subDisplayText,modelId:e.modelId,reportId:e.reportId,workbookId:e.workbookId,packageId:e.packageId,name:e.name},(function(e){return void 0===e})),r=t.ContractUtils.getMasterLayoutPosition(e),i=t.ContractUtils.createMasterLayoutConfig({height:r.height,width:r.width});return o.$layoutConfig=i,o.layoutConfig=JSON.stringify(i),o}function y(e,o,r,a,n,c,p,u,v,h,m){var f={version:d};(p||u)&&(f.reportTile={pod:p,filters:u});var g;v&&(g={modelQuery:{utterance:v}});var y=2*i.defaultGridWidth,b=2*i.defaultGridHeight,S=h?h/y:2,k=m?m/b:2;0===Math.round(S)&&(S=2),0===Math.round(k)&&(S=2);var I=Math.round(i.gridItemMediumLandscapeColSpan*S),C=Math.round(i.gridItemMediumLandscapeRowSpan*k);I=I>s.gridMaxColSpan?s.gridMaxColSpan:I,C=C>s.gridMaxRowSpan?s.gridMaxRowSpan:C;var D=t.ContractUtils.createMasterLayoutConfig({width:I,height:C}),T={id:++P,type:l.report,displayText:a,subDisplayText:n,action:JSON.stringify(c),reportId:e,sectionId:r,modelId:o,publishState:t.contracts.TilePublishState.Completed,query:g,config:f?JSON.stringify(f):void 0,$config:f,layoutConfig:JSON.stringify(D),$layoutConfig:D};return T}function b(e){return e.publishState===t.contracts.TilePublishState.InProgress}function S(){var e=[],t=C();t&&!_.isEmpty(t.tiles)&&e.push(t);var o=D();return o&&!_.isEmpty(o.tiles)&&e.push(o),_.cloneDeep(e)}function k(e){for(var t=S(),o=0,r=t;o<r.length;o++){var i=r[o],a=_.find(i.tiles,(function(t){return t.id===e}));if(null!=a)return a.template}return null}function I(e){if(void 0!==e)return JSON.stringify(e,(function(e,t){return e&&e.charAt&&"$"===e.charAt(0)?void 0:t}))}function C(){var o=[{id:1,title:e.common.localize.get("AddWidgetModal_IframeOption_Title"),description:e.common.localize.get("AddWidgetModal_IframeOption_Description"),iconClass:"pbi-glyph-iframe",template:"<edit-iframe-widget></edit-iframe-widget>",defaultTileContract:{type:l.iframe,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{iframe:{srcUrl:"",embedCode:""},version:"1.0",widget:{id:1,name:"webContent"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}},{id:2,title:e.common.localize.get("AddWidgetModal_ImageOption_Title"),description:e.common.localize.get("AddWidgetModal_ImageOption_Description"),iconClass:"pbi-glyph-image",template:"<edit-image-widget></edit-image-widget>",defaultTileContract:{type:l.image,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{imageTile:{imageUrl:""},version:"1.0",widget:{id:2,name:"image"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}},{id:3,title:e.common.localize.get("AddWidgetModal_TextOption_Title"),description:e.common.localize.get("AddWidgetModal_TextOption_Description"),iconClass:"pbi-glyph-font",template:"<edit-text-widget></edit-text-widget>",defaultTileContract:{type:l.composite,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{version:"1.0",visualContainer:{layoutType:e.common.contracts.TileLayoutType.Default,$visualContainer:{name:p.generateGuid(),config:{singleVisual:{objects:{},visualType:"textbox"}}}},widget:{id:3,name:"textbox"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}},{id:4,title:e.common.localize.get("AddWidgetModal_VideoOption_Title"),description:e.common.localize.get("AddWidgetModal_VideoOption_Description"),iconClass:"pbi-glyph-slideshow",template:"<edit-video-widget></edit-video-widget>",defaultTileContract:{type:l.iframe,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{iframe:{srcUrl:"",embedCode:""},version:"1.0",widget:{id:4,name:"video"}},$layoutConfig:t.ContractUtils.createMasterLayoutConfig()}}];return{title:e.common.localize.get("Add_Widgets_Section_Title"),tiles:o}}function D(){var o=[];return o.push({id:6,title:e.common.localize.get("Realtime_TileTitle"),description:e.common.localize.get("Realtime_TileDetails"),iconClass:"pbi-glyph-streaming-data",defaultTileContract:{type:l.realTime,$action:{action:null,targetUrl:"",openInSameTab:!1},$config:{realTimeVisual:{dataWindow:null,layoutType:e.common.contracts.TileLayoutType.Default,$visualContainer:{name:p.generateGuid(),config:{singleVisual:null}}},version:"1.0"},$layoutConfig:t.ContractUtils.createMasterLayoutConfig({width:i.gridItemSmallLandscapeColSpan,height:i.gridItemSmallLandscapeRowSpan})}}),{title:e.common.localize.get("Add_Realtime_Section_Title"),tiles:o}}function T(o,r,a,n,s){var c=i.gridItemMediumLandscapeColSpan,d=i.gridItemMediumLandscapeRowSpan;t.TileUtils.getVisualType(o)===e.visuals.plugins.card.name&&(c=i.gridItemSmallLandscapeColSpan,d=i.gridItemSmallLandscapeRowSpan);var l=a?{modelQuery:{sq:JSON.stringify(a)}}:null,p=t.ContractUtils.createMasterLayoutConfig({width:c,height:d}),u={id:++P,type:r,query:l,$config:o,tileData:n?I(n.data):null,tileDataSet:n,layoutConfig:JSON.stringify(p),$layoutConfig:p},v=o.visualContainer;return v&&(u.displayText=v.heading1,u.subDisplayText=v.heading3),s&&(u.modelId=s.id),u}function w(e,t,o,r){if(e){var i=_.cloneDeep(e),n=i.realTimeVisual||i.visualContainer;if(n){if(r){var s=e.realTimeVisual||e.visualContainer;n.visualContainer=t.serializeVisualContainer(s.$visualContainer)}else{var c=n.$visualContainer.config.singleVisual,d=c.stylePresetName;d&&(n.stylePresetName=d),n.visual=c.visualType;var s=e.realTimeVisual||e.visualContainer,l=s.$visualContainer.config.singleVisual.objects;if(l){var p=o.capabilities(c.visualType);p&&p.objects&&(n.objects=a.serializeObjects(l,p.objects))}i.visualContainer&&(i.visual=n,delete i.visualContainer),i.version="0.1"}n.$modelExtensions&&(n.modelExtensions=t.serializeModelExtensions(n.$modelExtensions)),delete n.$visualContainer,delete n.$modelExtensions}return JSON.stringify(i)}}var P=100;o.findModel=r,o.createCompositeTile=u,o.createTileConfig=v,o.createTileForPinData=f,o.createNonVisualTileFromExisting=g,o.createReportTileForExploreData=y,o.isTileLoading=b,o.getTileGalleryGroups=S,o.getTileTemplate=k,o.serializeTileConfig=w})(r=o.TileFactory||(o.TileFactory={}))})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=e.common.contracts.ContentTileType,r=jsCommon.EnumExtensions,i=e.common.contracts.Permissions,a=e.common.models.ReportResource,n=e.common.models.ResourceType,s=(function(e){function t(t){var o=e.call(this,"undefined"==typeof t?0:t.id,n.Workbook,"undefined"==typeof t?0:t.packageId)||this;return o.contract=t,o}return __extends(t,e),t.prototype.getPermissions=function(){var e;return this.getPermissionsCallback&&(e=this.getPermissionsCallback()),e?e:this.contract&&this.contract.permissions},Object.defineProperty(t.prototype,"contentTileType",{get:function(){return o.Workbook},enumerable:!0,configurable:!0}),t.prototype.isOwner=function(){return r.hasFlag(this.getPermissions(),i.All)},t.prototype.isPersonalized=function(){var e=this.getPermissions();return r.hasFlag(e,i.ReadWrite|i.Explore)&&!r.hasFlag(e,i.All)},t.prototype.isEditable=function(){var e=this.editUrl;return this.isOwner()&&null!==e&&void 0!==e&&""!==e},Object.defineProperty(t.prototype,"displayNameWithExtension",{get:function(){var e=jsCommon.FileUtils.getFileExtension(this.contract.sourceFilePath);return this.displayName.concat(".").concat(e)},enumerable:!0,configurable:!0}),t})(a);t.Workbook=s})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r=e.explore.services.createVisualHostServices,i=e.data.services.DataViewTransformActionsSerializer,a=e.common.models.gridLayoutConstants,n=e.common.helpers.ModelConverterHelper,s=(function(){function e(e,t,o){this.useSmallPlotArea=!1,this.contract=e,this.visualPluginService=t,this.pluginOps=o}return Object.defineProperty(e.prototype,"type",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileData",{get:function(){return null},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isError",{get:function(){return this._isError},set:function(e){this._isError=e,this.onErrorDelegate&&this.onErrorDelegate()},enumerable:!0,configurable:!0}),e.prototype.isDataStale=function(e){return!1},e.prototype.setDependencies=function(e){this.dataProxy=e},e.prototype.setDataLoadEventDelegate=function(e){this.dataLoadEventDelegate=e},e.prototype.copyDependencies=function(e){e.dataProxy&&this.setDependencies(e.dataProxy)},e})();o.CompositeTileModel=s,o.staleDataDeltaInMs=36e5;var c=(function(s){function c(e,t,o,i,a,n,c,d){var l=s.call(this,e,t,o)||this;return l.requiresResize=!1,l.geoLocationService=a,l.geocoder=n,l.featureSwitches=i,l.promiseFactory=c,l.moduleLoader=d,l._visual={hostServices:r(l.promiseFactory,l.moduleLoader,a,n)},l}return __extends(c,s),Object.defineProperty(c.prototype,"type",{get:function(){return t.contracts.CompositeTileType.SingleVisual},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"visual",{get:function(){return this._visual},enumerable:!0,configurable:!0}),c.prototype.getThemeName=function(){return this._visual&&this._visual.themeName},c.prototype.isDataStale=function(e){if(!e)return!1;var t=this.contract,r=n.convertRefreshTimeToJsDateTime(t.tileDataUpdatedTime),i=r&&r.getTime();return!!i&&e-i>o.staleDataDeltaInMs},c.prototype.setData=function(e,t,o){this.ensureVisual(),this._visual.data=e,this._visual.dataTransforms=t,this._visual.type=o},c.prototype.ensureVisual=function(){this._visual||(this._visual={hostServices:r(this.promiseFactory,this.moduleLoader,this.geoLocationService,this.geocoder)},this.calculateLayout())},Object.defineProperty(c.prototype,"config",{get:function(){return this._config},set:function(e){if(this._config=e,this._visual){var t=e.$visualContainer.config.singleVisual,o=t.visualType;this._visual.type=o,this._visual.themeName=e.themeName,this._visual.stylePresetName=t.stylePresetName;var r,a,n=this.visualPluginService.capabilities(o);n&&(r=n.objects,a=t.objects);var s=jsCommon.JsonExtensions.tryParseJSON(e.transform);s?this._visual.dataTransforms=i.deserializeDataViewTransformActions(s,r):this._visual.dataTransforms=i.createTransformActions(e.queryMetadata,e.elements,r,a)}},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"tileData",{get:function(){return this._tileData},set:function(e){this._tileData=e,this.readDataView(!0)},enumerable:!0,configurable:!0}),c.prototype.refreshData=function(){this.readDataView(!1)},c.prototype.setDependencies=function(e){var t=!this.dataProxy&&this._tileData&&!this.isLoading;s.prototype.setDependencies.call(this,e),t&&this.refreshData()},c.prototype.readDataView=function(o){return __awaiter(this,void 0,e.Promise,(function(){var r,i,a,n,s,c,d,l,p,u,v;return __generator(this,(function(h){switch(h.label){case 0:if(r=this._visual.type,i=e.visualHost.utils.shouldDisableVisual(r,e.common.localize.shouldDisableMap()),this.visual&&!this.requiresData()&&!i)return[2];if(a=this.dataProxy,!a)return[2];if(this.contract.queryResultError&&(n=t.TileUtils.getTileErrorDetailsFromQueryResultError(this.contract.queryResultError),n?(this.isError=!0,this.errorDetails=n,this.errorText=n.message):this.errorText=e.common.localize.get("Tile_ErrorText")),!this._tileData||!this._tileData.data)return this.isLoading=!0,[2];s=this._tileData,c={type:s.type,query:{dataSources:null,command:s.data},allowCache:o,perfId:r,kinds:this.pluginOps.dataViewKinds(r)},d=null,this.dataLoadEventDelegate&&(d=this.dataLoadEventDelegate(),this.dataLoadEventDelegate=null),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,a.execute(c)];case 2:return l=h.sent(),p={dataView:l&&l.dataReaderResult?l.dataReaderResult.dataView:null,dataViewSource:l&&l.dataViewSource?l.dataViewSource:null},u=l.dataReaderResult.error,i&&(u={code:"NotSupportedForLocale",debugInfo:"",getDetails:function(e){return{displayableErrorInfo:[{errorInfoKey:e.get("VisualContainer_NotSupportedForLocaleKey"),errorInfoValue:e.get("VisualContainer_NotSupportedForLocaleValue")}],message:e.get("VisualContainer_NotSupportedForLocaleMessage")}},ignorable:!1,requestId:""},this.errorDetails=u.getDetails(e.common.localize),this.errorText=this.errorDetails.message),this._visual.data=p,this.isError=this.isError||null!=u,d&&(this.isError?d.reject():d.resolve()),[3,4];case 3:return v=h.sent(),this.isError=!0,d&&d.reject(),[3,4];case 4:return[2]}}))}))},c.prototype.applyLayout=function(t){if(this.requiresResize){var o=this.visual;if(o&&o.visual){var r=o.visual,i=t===a.changeType.resized?2:t===a.changeType.resizing?1:void 0;r.update({viewport:o.viewport,dataViews:o.dataViews,suppressAnimations:!0,type:e.VisualUpdateType.Resize,resizeMode:i})}this.requiresResize=!1}},c.prototype.calculateLayout=function(t,r){if(t&&(this.viewport&&this.viewport.height===t.height&&this.viewport.width===t.width||(this.requiresResize=!0),this.viewport=t),null!=r&&this.useSmallPlotArea!==r&&(this.useSmallPlotArea=r,this.requiresResize=!0),this.viewport){var i=this.viewport.height,a=this.viewport.width;switch(this._config&&this._config.layoutType){case e.common.contracts.TileLayoutType.Full:break;default:i-=this.useSmallPlotArea?o.TileConstants.VisualSmallVerticalMargin:o.TileConstants.VisualVerticalMargin,a-=o.TileConstants.VisualHorizontalMargin}this._visual&&(this._visual.viewport={height:i,width:a,scale:1})}},c.prototype.canResizeTo=function(t){var o=this._visual&&this._visual.visual;return!!o&&(!o.canResizeTo||o.canResizeTo(e.common.GridLayoutConstants.getDefaultGridItemViewport(t)))},c.prototype.getErrorLocId=function(e,t){return""},c.prototype.requiresData=function(){var e=this.visual,t=this.pluginOps;if(e){if(e&&e.type){if(!t)return!0;if(!t.isQueryVisual(e.type))return!1}return!0}},c.prototype.updateVisualInteractivityOptions=function(e){var t=this.visualPluginService.getInteractivityOptions(this._visual.type);"undefined"!=typeof t.isInteractiveLegend&&(t.isInteractiveLegend=t.isInteractiveLegend&&e),this._visual.interactivityOptions=t},c})(s);o.SingleVisualCompositeTileModel=c})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.tileModel=e}return Object.defineProperty(e.prototype,"isSelected",{get:function(){return this.tileModel.isSelected},set:function(e){this.tileModel.isSelected=e},enumerable:!0,configurable:!0}),e})();e.DashboardTileModel=t})(t=e.models||(e.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=(function(){function t(e){this.contract=e}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.IframeTileModel=o})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=(function(){function t(e){this.contract=e}return Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){this._imageUrl=e,e&&!this.isStatic&&0!==e.indexOf("data:")&&(this._imageUrl=jsCommon.Utility.getAbsoluteUri(e))},enumerable:!0,configurable:!0}),t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.ImageTileModel=o})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=(function(){function t(e){this.contract=e}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeRowSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.ModelTileModel=o})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r=t.constants.SingleValueRealTimeWindow,i=e.data.EmptyDataClientError,a=e.data.FailedRealTimeUpdateClientError,n=(function(n){function s(e,t,o,r,i,a,s,c){var d=n.call(this,e,t,o,r,i,a,s,c)||this;return d._visual=null,d}return __extends(s,n),s.prototype.setModelId=function(e){this.contract.modelId=e,this.initialize()},Object.defineProperty(s.prototype,"realTimeModelId",{get:function(){var e=this.contract,t=this.modelService.findModel(e.modelId,e.packageId);return t&&t.contract?{id:t.id,originalModelId:t.contract.originalModelId,tableName:this.getSchemaTableName(),schema:this.getRealTimeConceptualSchema(),packageId:e.packageId}:null},enumerable:!0,configurable:!0}),s.prototype.setRealTimeModelDependencies=function(e,t,o,r,i){n.prototype.setDependencies.call(this,e),this.visualQueryGenerator=t,this.conceptualSchemaProxy=o,this.realTimeDataService=r,this.modelService=i},s.prototype.copyRealTimeModelDependencies=function(e){e.schema&&(this.schema=e.schema),e.dataProxy&&e.realTimeDataService&&e.visualQueryGenerator&&e.conceptualSchemaProxy&&(this.setRealTimeModelDependencies(e.dataProxy,e.visualQueryGenerator,e.conceptualSchemaProxy,e.realTimeDataService,e.modelService),e.onErrorDelegate&&!this.onErrorDelegate&&(this.onErrorDelegate=e.onErrorDelegate),this.realTimeDataService.replaceListener(e.realTimeModelId,e,this))},s.prototype.onDataChanged=function(){var t=this;if(this.singleVisualConfig){var o=r,a=this.config;a&&a.dataWindow&&(o=a.dataWindow);var n=this.visualQueryGenerator.execute({dataSources:this.datasources,schema:this.schema,config:this.singleVisualConfig,additionalFilters:null,dataWindow:o});if(!n||n.error){var s=void 0;n&&n.error&&(s=n.error.getDetails(e.common.localize)),this.onError(s)}else this.dataProxy.execute(n.options).then((function(e){t.isError=!1;var o={dataView:e&&e.dataReaderResult?e.dataReaderResult.dataView:null},r=t.lastCategoryValue;try{var i=t.getLastDateOrNumericCategoryValue(o.dataView);if(null!=r&&null!=i&&r.valueOf()>=i.valueOf())return;t.lastCategoryValue=i}catch(e){}t.setData(o,n.transforms,t.config.$visualContainer.config.singleVisual.visualType),t.isLoading=!1}),(function(o){if(!(o instanceof i)){var r=o&&o.getDetails(e.common.localize);t.onError(r)}}))}},s.prototype.onError=function(t){t||(t=(new a).getDetails(e.common.localize)),this.setErrorDetails(t)},Object.defineProperty(s.prototype,"datasources",{get:function(){var e=this.realTimeModelId;if(e)return o.RealTimeModelUtility.getRealTimeDataSource(e.id,e.originalModelId)},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"singleVisualConfig",{get:function(){return this.config.$visualContainer.config.singleVisual},set:function(e){this.config.$visualContainer.config.singleVisual=e,this.onDataChanged()},enumerable:!0,configurable:!0}),s.prototype.isDataStale=function(e){return!1},s.prototype.initialize=function(){var e=this,o=t.ContractUtils.getMasterLayoutPosition(this.contract);this.size={rowSpan:o.height,colSpan:o.width};var r=this.datasources;r&&this.conceptualSchemaProxy.get(r).then((function(t){e.fixUpSchema(t),e.schema=t,e.realTimeDataService.subscribe(e.realTimeModelId,e)}))},s.prototype.unsubscribe=function(){this.realTimeModelId&&this.realTimeDataService.unsubscribe(this.realTimeModelId,this)},s.prototype.fixUpSchema=function(o){for(var r=o.schema(t.constants.RealTimeDataSourceName).entities,i=r[0].properties,a=0,n=i;a<n.length;a++){var s=n[a];s.type!==e.ValueType.fromDescriptor({numeric:!0})&&s.type!==e.ValueType.fromDescriptor({integer:!0})||(s.kind=1)}},s.prototype.getSchemaTableName=function(){var e=this.getRealTimeConceptualSchema();if(e){var t=e.entities;return _.first(t).name}},s.prototype.getRealTimeConceptualSchema=function(){if(this.schema)return this.schema.schema(t.constants.RealTimeDataSourceName)},s.prototype.setErrorDetails=function(e){this.errorDetails=e,this.errorText=e.message,this.isError=!0},s.prototype.getLastDateOrNumericCategoryValue=function(e){var t=e&&e.categorical;if(t){var o=_.first(t.categories),r=o&&o.values;if(!_.isEmpty(r)){var i=_.last(r);return i&&!_.isBoolean(i)&&(_.isDate(i)||_.isNumber(i))?i:void 0}}},s})(o.SingleVisualCompositeTileModel);o.RealTimeTileModel=n})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r,i=o.RealTimeModel;!(function(o){function r(o,r){if(o&&!(o<0))return e.explore.contracts.createDataSourceArray([{id:o,type:e.data.tabular.type,name:t.constants.RealTimeDataSourceName,tabular:{modelId:null!=r?r:o}}])}function a(t){var o=e.data.tabular.getColumnsMetadata(t);if(o){for(var r=[],a=0,n=o;a<n.length;a++){var s=n[a];r.push({name:s.name,dataType:i.convertToRealTimeDataType(e.ValueType.fromDescriptor(s.type))})}return r}}o.getRealTimeDataSource=r,o.convertToColumnsDefinition=a})(r=o.RealTimeModelUtility||(o.RealTimeModelUtility={}))})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=(function(){function t(e){this.contract=e,this.exploration={contract:void 0,exploreCanvas:void 0,sections:[]},this.isError=!1,this.tilesUpdated=!1}return t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.ReportTileModel=o})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o=(function(){function t(e){this.contract=e}return Object.defineProperty(t.prototype,"imageUrl",{get:function(){return this._imageUrl},set:function(e){e&&(0!==e.indexOf("data:")?this._imageUrl=jsCommon.Utility.getAbsoluteUri(e):this._imageUrl=e)},enumerable:!0,configurable:!0}),t.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemLargeLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemLargeLandscapeColSpan},t.prototype.getErrorLocId=function(e,t){return""},t})();t.SsrsTileModel=o})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){function r(e){if(!(_.isEmpty(e)||e.length<o.DashboardIntraDomainNavigationPrefix.length)&&i(e))return e.substr(o.DashboardIntraDomainNavigationPrefix.length)}function i(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(o.DashboardIntraDomainNavigationPrefix)}function a(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(o.ReportIntraDomainNavigationPrefix)}function n(e){return!_.isEmpty(e)&&0===e.toLowerCase().indexOf(o.WorkbookIntraDomainNavigationPrefix)}function s(e){return i(e)||a(e)||n(e)}var c,d=jsCommon.ArrayExtensions,l=jsCommon.DateExtensions,p=e.common.utils.DateFormatter,u=e.common.helpers.ModelConverterHelper,v=jsCommon.UrlUtils;!(function(e){e[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report"})(c=o.IntraDomainNavigationType||(o.IntraDomainNavigationType={})),o.getDashboardGuidFromUrl=r,o.IsDashboardIntraDomainPrefix=i,o.IsReportIntraDomainPrefix=a,o.IsWorkbookIntraDomainPrefix=n,o.IsValidIntraDomainPrefix=s,o.DashboardIntraDomainNavigationPrefix="/dashboards/",o.ReportIntraDomainNavigationPrefix="/reports/",o.WorkbookIntraDomainNavigationPrefix="/workbooks/";var h;!(function(e){e.SubtitleHeight=10,e.TileDefaultPadding=10,e.RegularHeaderHeight=50,e.SmallHeaderHeight=42,e.LargeHeaderHeight=65,e.VisualVerticalMargin=20,e.VisualHorizontalMargin=20,e.VisualSmallVerticalMargin=8})(h=o.TileConstants||(o.TileConstants={}));var m=(function(){function o(e,t){this.isSelected=!1,this.contract=e,this.tileHeaderSize=1,this.layoutPosition={},this.localizationService=t}return Object.defineProperty(o.prototype,"gridLayouts",{get:function(){return this.contract.$layoutConfig.layouts},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"id",{get:function(){return this.contract.id},set:function(e){this.contract.id=e},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectId",{get:function(){return this.contract.objectId},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"details",{get:function(){switch(this.type){case t.contracts.TileType.composite:return this.composite;case t.contracts.TileType.iframe:return this.iframe;case t.contracts.TileType.image:return this.image;case t.contracts.TileType.model:return this.model;case t.contracts.TileType.ssrs:return this.ssrs;case t.contracts.TileType.workbook:return this.workbook;case t.contracts.TileType.report:return this.reportTile;case t.contracts.TileType.realTime:return this.realTime;default:return null}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"shouldBeIncludedInTelemetryMeasurement",{get:function(){return this.details&&!!this.details.shouldBeIncludedInTelemetryMeasurement},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isTemporary",{get:function(){return this.id<=0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isTileLoading",{get:function(){return this.composite?this.composite.isLoading&&!this.composite.isError:this.isLoading},enumerable:!0,configurable:!0}),o.prototype.calculateLayout=function(t){var o=this.getHeaderSizeByType(this.tileHeaderSize);if(this.compositeTile&&t){var r=t,i=2===this.tileHeaderSize;if(i)if(this.hasTitle())r.height-=o;else{var a=this.composite&&this.composite.config&&this.composite.config.layoutType;a!==e.common.contracts.TileLayoutType.Full&&(r.height-=h.TileDefaultPadding)}else this.hasTitle()&&(this.hasSubtitle()?r.height-=o:r.height-=o-h.SubtitleHeight);this.compositeTile.calculateLayout(r,i)}},o.prototype.applyLayout=function(e){this.compositeTile&&this.compositeTile.applyLayout(e)},o.prototype.invalidateLayout=function(){this.tryPopulateLayoutPositionValues()&&this.gridLayoutContext.onLayoutInvalidated()},o.prototype.tryPopulateLayoutPositionValues=function(){if(!this.gridLayoutContext||this.gridLayoutContext.isLayoutUpdateLocked)return!1;var e=this.gridLayoutContext.getActiveLayout(),t=d.extendWithId(this.contract.$layoutConfig.layouts),o=t.withId(e);return o&&o.position&&(this.layoutPosition=_.cloneDeep(o.position)),!0},o.prototype.applyChanges=function(){if(this.contract&&this.gridLayoutContext){var e=_.cloneDeep(this.layoutPosition),t=this.contract.$layoutConfig;this.addOrUpdateLayoutPosition(t,e),this.contract.layoutConfig=JSON.stringify(this.contract.$layoutConfig)}},o.isValidUrl=function(e,t){return!_.isEmpty(e)&&(v.isValidHttpUrl(e)||t&&s(e))},o.prototype.getDisplayText=function(){if(this.displayText)return this.displayText;if(this.compositeTile){var e=this.compositeTile.config;if(e&&!_.isEmpty(e.heading1))return e.heading1}return""},o.prototype.getSubDisplayText=function(){if(this.displayText&&this.subDisplayText)return this.subDisplayText;if(this.compositeTile){var e=this.compositeTile.config;if(!this.displayText&&e&&!_.isEmpty(e.heading3))return e.heading3}return""},o.prototype.shouldPlaceBulletSeperator=function(){var e=this.displayText&&this.displayText.length>0;return e&&this.subDisplayText&&this.subDisplayText.length>0&&this.config&&this.config.lastRefreshTimeEnabled},Object.defineProperty(o.prototype,"hrefTarget",{get:function(){return this.action.openInSameTab?"_self":"_blank"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastRefreshTimeInLocaleString",{get:function(){var e=u.convertRefreshTimeToJsDateTime(this.contract.tileDataUpdatedTime);return e?e.toLocaleString():this.datasetModel?this.datasetModel.lastRefreshTimeInLocaleString:void 0},enumerable:!0,
configurable:!0}),Object.defineProperty(o.prototype,"formattedTime",{get:function(){var e;if(this.workbook){var t=this.contract.tilePackage;e=t?u.convertRefreshTimeToJsDateTime(t.lastRefreshTime):null}else e=u.convertRefreshTimeToJsDateTime(this.contract.tileDataUpdatedTime);if(e){var o=f,r=l.isContainedInTimeFrame,i=l.isMomentPresent();return i&&r(e,o.Minute,o.MaxMinuteThreshold,!1)?p.getPrettyRelativeDate(e,this.localizationService):i&&r(e,o.Day,o.SameDayThreshold,!0)?l.GetTime(this.localizationService.currentLanguageLocale,e):i&&r(e,o.Day,o.YesterdayThreshold,!0)?this.localizationService.format("DashboardTile_YesterdayTemplate",[l.GetTime(this.localizationService.currentLanguageLocale,e)]):i&&r(e,o.Day,o.WeekThreshold,!0)?l.GetDayWithTime(this.localizationService.currentLanguageLocale,e):l.GetFullDateWithTime(this.localizationService.currentLanguageLocale,e)}if(this.datasetModel)return this.datasetModel.lastRefreshTimeInLocaleString},enumerable:!0,configurable:!0}),o.prototype.setDatasetModelAndPackageInfo=function(e,t){e&&(this.datasetModel=e,t&&(this.datasetModel.packagePublishStatus=t.publishOrRefreshStatus))},o.prototype.hasTitle=function(){if(this.config&&this.config.hideTitle)return!1;var e=this.compositeTile?this.compositeTile.config:null;return!_.isEmpty(this.displayText)||e&&!_.isEmpty(e.heading1)},o.prototype.hasSubtitle=function(){var e=this.config;return(!e||!e.hideTitle)&&(!_.isEmpty(this.subDisplayText)||e&&e.lastRefreshTimeEnabled)},o.prototype.lastRefreshTimeInLocaleWithLabel=function(){if(this.config&&this.config.lastRefreshTimeEnabled)return this.localizationService.format("DashboardTile_LastRefreshTimeTemplate",[this.formattedTime])},o.prototype.setTileHeaderSize=function(e){this.tileHeaderSize!==e&&(this.tileHeaderSize=e,this.invalidateLayout())},Object.defineProperty(o.prototype,"compositeTile",{get:function(){return this.composite||this.realTime},enumerable:!0,configurable:!0}),o.prototype.hasLayoutDefinition=function(e){var t=d.extendWithId(this.contract.$layoutConfig.layouts);return!!t.withId(e)},o.prototype.hasLayoutPosition=function(e){return!!t.ContractUtils.getLayoutPosition(this.contract,e)},o.prototype.removeLayoutPosition=function(e){return void 0===e&&(e=1),this.hasLayoutDefinition(e)&&(this.addLayout({id:e,position:null},e),this.resetTileLayoutSizeAndPosition()),this.getCurrentTileLayoutDescriptor()},o.prototype.resetTileLayoutSizeAndPosition=function(){this.layoutPosition.x=null,this.layoutPosition.y=null,this.layoutPosition.height=null,this.layoutPosition.width=null,this.gridLayoutContext=null},o.prototype.removeLayoutDefinition=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.hasLayoutDefinition(e)&&(_.remove(this.contract.$layoutConfig.layouts,(function(t){return t.id===e})),t&&this.resetTileLayoutSizeAndPosition()),this.getCurrentTileLayoutDescriptor()},o.prototype.applyLayoutSize=function(e,t){this.compositeTile&&(this.compositeTile.size={colSpan:e.colSpan,rowSpan:e.rowSpan}),this.applyLayout(t)},o.prototype.getCurrentTileLayoutDescriptor=function(e,t){var o=e?e:this.contract.$layoutConfig;return{id:this.id,row:null,col:null,rowSpan:null,colSpan:null,layoutConfig:JSON.stringify(o),query:t?t[0]:null,updatedQuery:t?t[1]:null,modelId:this.contract.modelId}},o.prototype.buildLayoutDescriptor=function(){var e=_.cloneDeep(this.layoutPosition),t=_.cloneDeep(this.contract.$layoutConfig);this.addOrUpdateLayoutPosition(t,e);var o=this.updateTileQueryAfterResize(e);return this.getCurrentTileLayoutDescriptor(t,o)},o.prototype.updateTileQueryAfterResize=function(o){var r=this.composite&&this.composite.contract&&this.composite.contract.query;if(r){var i=t.ContractUtils.convertToTileDataQuery(r);if(!i)return;for(var a=_.cloneDeep(r),n=o.width*e.common.GridLayoutConstants.defaultGridWidth,s=o.height*e.common.GridLayoutConstants.defaultGridHeight,c=!1,d=0;d<i.Commands.length;++d){var l=i.Commands[d].ScriptVisualCommand;if(l){var p=l.ViewportWidthPx,u=l.ViewportHeightPx;p===n&&u===s||(l.ViewportWidthPx=n,l.ViewportHeightPx=s,i.Commands[d].ScriptVisualCommand=l,c=!0)}}if(c){this.composite.contract.query.modelQuery.sq=JSON.stringify(i);var v=JSON.stringify(this.composite.contract.query);return[a,v]}}},o.prototype.addOrUpdateLayoutPosition=function(e,t){var o=this.gridLayoutContext.getActiveLayout(),r=d.extendWithId(e.layouts),i=r.withId(o);i||(i={id:o,position:{}},r.push(i)),i.position=t},o.prototype.addLayout=function(e,t){return this.removeLayoutDefinition(t),this.contract.$layoutConfig.layouts.push(e),this.getCurrentTileLayoutDescriptor()},o.prototype.getHeaderSizeByType=function(e){switch(e){case 0:return h.LargeHeaderHeight;case 2:return h.SmallHeaderHeight;case 1:default:return h.RegularHeaderHeight}},o})();o.Tile=m;var f;!(function(e){e.Minute="minute",e.Day="day",e.MaxMinuteThreshold=15,e.SameDayThreshold=0,e.YesterdayThreshold=1,e.WeekThreshold=6})(f||(f={}))})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r=(function(){function o(e,t){this.contract=e,this.tileModel=t}return o.prototype.canResizeTo=function(t){return t.rowSpan===e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan||t.colSpan===e.common.GridLayoutConstants.gridItemSmallLandscapeColSpan},o.prototype.getErrorLocId=function(e,o){var r,i=[];switch(e){case t.contracts.TileErrorCode.workbookTileGeneralError:r="WorkbookTile_GeneralError";break;case t.contracts.TileErrorCode.workbookTileFileNotFound:r="WorkbookTile_FileNotFound";break;case t.contracts.TileErrorCode.workbookTileObjectNotFound:r="WorkbookTile_ObjectNotFound",i=this.contract.$config.workbookTile?[this.contract.$config.workbookTile.item]:["pinned object"];break;case t.contracts.TileErrorCode.workbookTileUnauthorized:r="WorkbookTile_Unauthorized";break;default:return""}return o.format(r,i)},o.prototype.hasImages=function(){return this.hasWorkbookTileConfig&&this.tileModel.config.workbookTile.images&&this.tileModel.config.workbookTile.images.length>0},Object.defineProperty(o.prototype,"images",{get:function(){return this.hasWorkbookTileConfig?this.tileModel.config.workbookTile.images:null},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hasWorkbookTileConfig",{get:function(){return!!this.tileModel&&!!this.tileModel.config&&!!this.tileModel.config.workbookTile},enumerable:!0,configurable:!0}),o})();o.WorkbookTileModel=r})(o=t.models||(t.models={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){function t(e){var t=i.tryParseJSON(e.layoutConfig),o=r.extendWithId(t.layouts).withId(0);e.col=o.position.x,e.row=o.position.y,e.colSpan=o.position.width,e.rowSpan=o.position.height}function o(e){for(var t=0,o=e;t<o.length;t++){var a=o[t],n=i.tryParseJSON(a.layoutConfig),s=r.extendWithId(n.layouts).withId(0);a.col=s.position.x,a.row=s.position.y,a.colSpan=s.position.width,a.rowSpan=s.position.height}}var r=jsCommon.ArrayExtensions,i=jsCommon.JsonExtensions;e.conformOutgoingTile=t,e.conformOutgoingTileLayoutDescriptors=o})(t=e.compatibility||(e.compatibility={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,o,r,i,a,s){return t.dashboardHttpService||(t.dashboardHttpService=new n(e,o,r,i,a,s)),t.dashboardHttpService}var r=jsCommon.GzipUtility,i=t.models.TileFactory;t.createDashboardHttpService=o;var a=1048576,n=(function(){function o(e,t,o,r,i,a){this.syncService=e,this.promiseFactory=t,this.notificationToastService=o,this.explorationSerializer=r,this.featureSwitchService=i,this.visualPlugin=a,this.batchedDashboardRequests=[]}return o.prototype.getDashboardContainer=function(t){var o=e.common.httpService.powerbiRequestOptions(t,"GetDashboardContainer");return e.common.httpService.get("powerbi/metadata/dashboards",o)},o.prototype.getDashboards=function(e,t,o){return this.getDashboardsInternal(e,t,o)},o.prototype.getDashboardContainerByObjectId=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetDashboardByObjectId"),i=this.getDashboardContainerByObjectIdUrl(t);return e.common.httpService.get(i,r)},o.prototype.batchGetDashboards=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetDashboardsByIds");return i.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/getDashboardsByIds",JSON.stringify(o),i)},o.prototype.getDashboardMetadata=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetDashboardMetadata");return i.enableTelemetry=!0,e.common.httpService.get("powerbi/metadata/dashboards/"+o+"/metadata",i)},o.prototype.getDashboardUrl=function(e){return"powerbi/metadata/dashboards/"+e},o.prototype.getDashboardContainerByObjectIdUrl=function(e){return"metadata/embed/dashboard/"+e},o.prototype.addDashboard=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"AddDashboard");this.syncService.addMetadataEditRequestId(r.headers[e.telemetryConstants.httpRequestIdHeader]);var i={displayName:t.displayName};return r.enableTelemetry=!0,e.common.httpService.put("powerbi/metadata/dashboards",i,r)},o.prototype.renameDashboard=function(o,r,i){t.DashboardUtils.isWriteable(o)||this.notifyReadOnly(o.id);var a=e.common.httpService.powerbiRequestOptions(i,"RenameDashboard");return this.syncService.addMetadataEditRequestId(a.headers[e.telemetryConstants.httpRequestIdHeader]),a.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/dashboards/"+o.id+"/name",JSON.stringify(r),a)},o.prototype.duplicateDashboard=function(o,r,i){t.DashboardUtils.isWriteable(o)||this.notifyReadOnly(o.id);var a=e.common.httpService.powerbiRequestOptions(i,"DuplicateDashboard");return this.syncService.addMetadataEditRequestId(a.headers[e.telemetryConstants.httpRequestIdHeader]),a.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/dashboards/"+o.id+"/copy",JSON.stringify(r),a)},o.prototype.setQnaEnabledForDashboard=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"SetQnaEnabled");return this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),i.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/dashboards/"+t+"/qnaEnabled",JSON.stringify(o),i)},o.prototype.deleteDashboard=function(o,r){t.DashboardUtils.isWriteable(o)||this.notifyReadOnly(o.id);var i=e.common.httpService.powerbiRequestOptions(r,"DeleteDashboard");this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),i.enableTelemetry=!0;var a="powerbi/metadata/dashboards/"+o.id;return e.common.httpService.delete(a,i)},o.prototype.exportDashboard=function(o,r,i){if(!t.DashboardUtils.isWriteable(o))return this.notificationToastService.notify({title:e.common.localize.get("Warning_Title"),message:e.common.localize.get("DashboardReadOnlyExportWarning_Message"),notificationType:e.common.NotificationToastType.Alert}),null;var a=e.common.httpService.powerbiRequestOptions(i,"ExportDashboard");return a.responseType="blob",a.enableTelemetry=!0,e.common.httpService.get("powerbi/resource/packages/"+o.id+"/?packageType="+r,a)},o.prototype.addTile=function(o,n,s,c,d){if(!t.DashboardUtils.isWriteable(o))return e.common.httpService.getResolvedHttpChain();var l=e.common.httpService.powerbiRequestOptions(d);this.syncService.addMetadataEditRequestId(l.headers[e.telemetryConstants.httpRequestIdHeader]);var p={id:0,type:n.type,config:i.serializeTileConfig(n.$config,this.explorationSerializer,this.visualPlugin,this.featureSwitchService.featureSwitches.visualContainerTileConfig),displayText:n.displayText,subDisplayText:n.subDisplayText,name:n.name,action:n.action,image:n.image,query:n.query,tileDataBinaryBase64Encoded:r.compress(n.tileData),layoutConfig:n.layoutConfig,publishState:n.publishState,resourcePackageIds:n.resourcePackageIds};p.modelId=n.modelId,p.reportId=n.reportId,p.workbookId=n.workbookId,p.sectionId=n.sectionId,"number"==typeof n.packageId&&(p.packageId=n.packageId),t.compatibility.conformOutgoingTile(p);var u=JSON.stringify(p).length;return u>a?this.promiseFactory.reject({data:p,headers:function(){return null},status:e.HttpStatusCode.RequestEntityTooLarge,error:{code:"AddTileRequestTooLarge","pbi.error":{code:"AddTileRequestTooLarge",parameters:[],details:[],exceptionCulprit:e.ExceptionCulprit.User}}}):(l.telemetryDescription="AddTile",l.enableTelemetry=!0,e.common.httpService.put("powerbi/metadata/tiles/"+o.id,p,l))},o.prototype.updateTile=function(t,o,r){var i,a={};return _.isEqual(t.displayText,o.displayText)||(a.displayText=o.displayText),_.isEqual(t.subDisplayText,o.subDisplayText)||(a.subDisplayText=o.subDisplayText),_.isEqual(t.action,o.action)||(a.action=o.action),_.isEqual(t.config,o.config)||(a.config=o.config),_.isEqual(t.query,o.query)||(a.query=o.query),_.isEqual(t.tileData,o.tileData)||(a.tileDataBinaryBase64Encoded=jsCommon.GzipUtility.compress(o.tileData)),i=e.common.httpService.powerbiRequestOptions(r,"UpdateTile"),i.enableTelemetry=!0,this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),e.common.httpService.patch("powerbi/metadata/tiles/"+t.id,JSON.stringify(a),i)},o.prototype.deleteTile=function(o,r,i){t.DashboardUtils.isWriteable(o)||this.notifyReadOnly(o.id);var a=e.common.httpService.powerbiRequestOptions(i,"DeleteTile");return this.syncService.addMetadataEditRequestId(a.headers[e.telemetryConstants.httpRequestIdHeader]),a.enableTelemetry=!0,e.common.httpService.delete("powerbi/metadata/tiles/"+r,a)},o.prototype.getTile=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetTile");return r.enableTelemetry=!0,e.common.httpService.get("powerbi/metadata/tiles/"+t,r)},o.prototype.batchGetTiles=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"BatchGetTiles");return i.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/dashboard/"+t+"/tiles",JSON.stringify(o),i)},o.prototype.renameTile=function(t,o,r,i){var a=e.common.httpService.powerbiRequestOptions(i,"RenameTile");this.syncService.addMetadataEditRequestId(a.headers[e.telemetryConstants.httpRequestIdHeader]);var n={id:t,displayText:o,subDisplayText:r};return a.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/tiles/"+t+"/displayText",JSON.stringify(n),a)},o.prototype.getTileShortUrl=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetTileShortUrl");return i.enableTelemetry=!0,e.common.httpService.get("metadata/dashboards/"+t+"/tiles/"+o+"/shortUrl",i)},o.prototype.batchUpdateTileSizePosition=function(e,o,r,i){if(t.compatibility.conformOutgoingTileLayoutDescriptors(r),!t.DashboardUtils.isWriteable(o))return this.isDashboardBatchTilePositionUpgrade(o,r)||this.notifyReadOnly(o.id),null;var a=r.filter((function(e){return!!e.updatedQuery})),n=r.filter((function(e){return!e.updatedQuery})),s=this.batchUpdateTileSizePositionInternal(o,n,i,!0),c=this.batchUpdateTileSizePositionInternal(o,a,i,!1),d=[];return s&&d.push(s),c&&d.push(c),e.allSettled(d)},o.prototype.batchUpdateTileSizePositionInternal=function(t,o,r,i){if(void 0===i&&(i=!0),o&&0!==o.length){var a=e.common.httpService.powerbiRequestOptions(r,"SetTileSizePosition"),n=a.headers[e.telemetryConstants.httpRequestIdHeader];return i?this.syncService.addMetadataEditRequestId(n):this.syncService.addDashboardTransactionFilter(n,(function(t){return t.changeType!==e.common.contracts.MetadataChangeType.TileDataChange})),a.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/dashboard/"+t.id+"/tiles/sizeandposition",o,a)}},o.prototype.isDashboardBatchTilePositionUpgrade=function(t,o){for(var r={},i=t.tiles,a=0,n=i.length;a<n;++a){var s=i[a];r[s.id]=s}for(var a=0,n=o.length;a<n;++a){var c=o[a],s=r[c.id];if(s&&s.row>e.common.constants.contractRowProtocolThreshold)return!0}return!1},o.prototype.setActiveDashboardId=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"SetActiveDashboard");i.enableTelemetry=!0;var a=null;return o&&o.length>0&&(a=JSON.stringify(o)),e.common.httpService.post("/powerbi/metadata/user/activedashboard/"+t,a,i)},o.prototype.refreshTileData=function(t,o,r,i){var a=e.common.httpService.powerbiRequestOptions(r,"SetActiveDashboard",i);a.enableTelemetry=!0;var n=null;return o&&o.length>0&&(n=JSON.stringify(o)),e.common.httpService.post("/powerbi/metadata/user/activedashboard/"+t+"/refresh",n,a)},o.prototype.notifyReadOnly=function(t,o){var r="NotifiedReadOnlyDashboard"+t,i=o||!e.common.sessionStorageService.getData(r);i&&(this.notificationToastService.notify({title:e.common.localize.get("Warning_Title"),message:e.common.localize.get("DashboardReadOnlyWarning_Message"),notificationType:e.common.NotificationToastType.Alert}),e.common.sessionStorageService.setData(r,!0))},o.prototype.addDashboardRequestToBatch=function(t,o,r){for(var i=this.batchedDashboardRequests,a=0,n=i.length;a<n;++a){var s=i[a];if(s.dashboardId===o&&s.requestType===r)return s.deferred.promise()}var c=$.Deferred(),d={dashboardId:o,deferred:c,requestType:r};return i.push(d),void 0===d.requestType||null===d.requestType||d.requestType===e.common.DashboardRequestType.Default?this.getDashboards(t,[o],void 0).then((function(e){return e&&e.length>0?c.resolve(e[0].data):c.reject()}),(function(){c.reject()})):d.requestType===e.common.DashboardRequestType.Metadata&&this.getDashboardMetadata(t,o,void 0).then((function(e){return e?c.resolve(e.data):c.reject()}),(function(){c.reject()})),c.promise()},o.prototype.getDashboardsInternal=function(t,o,r,i){var a=this;return _.isEmpty(o)?null:(i=i||t.defer(),e.common.httpService.getAll(o.map((function(e){return a.getDashboardUrl(e)})),o.map((function(t){var o=e.common.httpService.powerbiRequestOptions(r,"GetDashboard");return o.enableTelemetry=!0,o}))).then((function(e){i.resolve(e)}),(function(o){for(var n=[],s=[],c=0,d=o.length;c<d;c++){var l=o[c];l.status===e.HttpStatusCode.OK?n.push(l):s.push(l)}var p=!!s.length;n.length?(i.resolve(n),p&&a.getDashboardsInternal(t,s.map((function(e){return e.data.dashboards[0].id})),r,i)):i.reject(s)})),i.promise)},o.prototype.updateDashboardSetting=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"UpdateDashboardSetting");return this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),i.enableTelemetry=!0,e.common.httpService.post("powerbi/metadata/dashboards/"+t+"/settings",JSON.stringify(o),i)},o})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e){return t.modelHttpService||(t.modelHttpService=new r(e)),t.modelHttpService}t.createModelHttpService=o;var r=(function(){function t(e){this.syncService=e}return t.prototype.getModels=function(t){var o=e.common.httpService.powerbiRequestOptions(t,"GetModels");return e.common.httpService.get("powerbi/metadata/models",o)},t.prototype.getModel=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetModel");return o?e.common.httpService.get("powerbi/metadata/models/"+t+"/?modelOptions=Default&packageId="+o,i):e.common.httpService.get("powerbi/metadata/models/"+t+"/?modelOptions=Default",i)},t.prototype.getModelForRefresh=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetModelForRefresh");return e.common.httpService.get("powerbi/metadata/models/"+t+"/?modelOption=Refresh&packageId="+o,i)},t.prototype.getModelAndPackageForRefresh=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetModelAndPackageForRefresh");return this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),e.common.httpService.get("powerbi/metadata/models/"+t+"/?modelOption=PackageModelRefresh&packageId="+o,i)},t.prototype.renameModel=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"RenameModel");return this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),e.common.httpService.post("powerbi/metadata/models/"+t.id+"/name",JSON.stringify(o),i)},t.prototype.deleteModel=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"DeleteModel");return e.common.httpService.delete("powerbi/content/models/"+t.id+"/?packageId="+t.packageId,r)},t.prototype.getPackageModels=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetPackageModels");return e.common.httpService.get("powerbi/metadata/packages/"+t+"/models",r)},t.prototype.getModelRefreshHistories=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetModelRefreshHistories");return e.common.httpService.get("powerbi/metadata/models/"+t+"/refreshhistories",r)},t.prototype.getPackageRefreshHistories=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetPackageRefreshHistories");return e.common.httpService.get("powerbi/metadata/packages/"+t+"/refreshhistories",r)},t.prototype.updateFeaturedQuestions=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"UpdateFeaturedQuestions");return e.common.httpService.put("powerbi/metadata/models/"+t+"/featuredQuestions",JSON.stringify(o),i)},t.prototype.disableRlsModel=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"DisableRlsModel");return e.common.httpService.post("metadata/model/"+t+"/rlsdisabled",JSON.stringify(!1),r)},t.prototype.updateModelQnaFeatures=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"UpdateModelQnaFeatures");return e.common.httpService.post("powerbi/metadata/models/"+t+"/qnafeatures",JSON.stringify(o),i)},t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){function o(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetPackage");return e.common.httpService.get("powerbi/metadata/packages/"+t,r)}t.getPackage=o})(o=t.packageHttpService||(t.packageHttpService={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e){return new r(e)}t.createReportHttpService=o;var r=(function(){function t(e){this.syncService=e}return t.prototype.getReports=function(t){var o=e.common.httpService.powerbiRequestOptions(t,"GetReports");return e.common.httpService.get("powerbi/metadata/reports",o)},t.prototype.getReport=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"GetReport");return e.common.httpService.get("powerbi/metadata/reports/"+t,r)},t.prototype.renameReport=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"RenameReport");return this.syncService.addMetadataEditRequestId(i.headers[e.telemetryConstants.httpRequestIdHeader]),e.common.httpService.post("powerbi/metadata/reports/"+t.id+"/name",JSON.stringify(o),i)},t.prototype.deleteReport=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"DeleteReport");return e.common.httpService.delete("powerbi/content/reports/"+t.id+"/",r)},t.prototype.getReportShortUrl=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetReportShortUrl");i.enableTelemetry=!0;var a="metadata/reports/"+t+"/shortUrl";return null!=o&&o.trim().length>0&&(a=a+"?reportPage="+o),e.common.httpService.get(a,i)},t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e){return new i(e)}var r=jsCommon.QueryStringUtil;t.createTutorialDataStoreService=o;var i=(function(){function t(t,o){this.featureSwitchService=t,this.promiseFactory=o||e.createJQueryPromiseFactory(),this.loadedDeferred=this.promiseFactory.defer()}return t.prototype.setJsonData=function(e){if(this.jsonData=e,!r.getQueryStringValue(t.IgnoreQueryParam)){if(this.store={},!r.getQueryStringValue(t.ShowAllQueryParam))try{_.extend(this.store,JSON.parse(e))}catch(e){}this.loadedDeferred.resolve({})}},t.prototype.onReady=function(e){this.store?e():this.loadedDeferred.promise.then((function(){return e()}))},t.prototype.hasKey=function(t){return!!this.store&&(t===e.common.constants.previewConceptualModelNewKey&&this.featureSwitchService.featureSwitches.previewConceptualModel&&this.featureSwitchService.featureSwitches.previewDefaultOptIn?!this.store.hasOwnProperty(t)||this.store[t]:this.store.hasOwnProperty(t)&&this.store[t])},t.prototype.getKey=function(e){return this.store?this.store[e]:null},t.prototype.setKey=function(o,i,a){var n=this;if(!this.store)return this.promiseFactory.reject();this.store[o]=i;var s=JSON.stringify(this.store);if(this.jsonData===s)return this.promiseFactory.resolve();if(!r.getQueryStringValue(t.ShowAllQueryParam)){var c=e.common.httpService.powerbiRequestOptions(a.event,"SetGettingStartedStatus",{dismissGroupObjectId:!0}),d=JSON.stringify(s);return e.common.httpService.post(t.ServerURL,d,c).then((function(){n.jsonData=s,a.resolve()}),(function(){a.reject()}))}return this.promiseFactory.reject()},t})();i.ServerURL="powerbi/metadata/user/gettingStartedStatus",i.IgnoreQueryParam="ignoreGettingStartedPopups",i.ShowAllQueryParam="showGettingStartedPopups",t.TutorialDataStoreService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e){return new r(e)}t.createWorkbookHttpService=o;var r=(function(){function t(e){this.syncService=e}return t.prototype.getWorkbooks=function(t){var o=e.common.httpService.powerbiRequestOptions(t,"GetWorkbooks");return e.common.httpService.get("powerbi/metadata/workbooks",o)},t.prototype.getWorkbook=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"GetWorkbook");return e.common.httpService.get("powerbi/metadata/workbooks/"+t+"/?packageId="+o,i)},t.prototype.renameWorkbook=function(t,o,r){var i=e.common.httpService.powerbiRequestOptions(r,"RenameWorkbook");return e.common.httpService.post("powerbi/metadata/workbooks/"+t.id+"/name",JSON.stringify(o),i)},t.prototype.deleteWorkbook=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"DeleteWorkbook");return e.common.httpService.delete("powerbi/content/workbooks/"+t.id+"/?packageId="+t.packageId,r)},t.prototype.getWorkbookWopiData=function(t,o){var r=e.common.httpService.powerbiRequestOptions(o,"WopiWorkbook");return e.common.httpService.post("powerbi/metadata/workbooks/wopiaccessinfo",JSON.stringify(t),r)},t})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,i,a,n,s){return new r(e,t,o,i,a,n,s)}t.createAppMetadataService=o;var r=(function(){function o(e,t,o,r,i,a,n){this.rootScope=e,this.promiseFactory=t,this.resourcePackagesService=o,this.resourcePackageGateService=r,this.visualPluginService=i,this.telemetryService=a,this.editableFeatureSwitchService=n,this.gettingAppMetadata=!1,this.getAppMetadataDeferred=this.promiseFactory.defer()}return o.prototype.getAppMetadata=function(){var e=this;if(!this.gettingAppMetadata)if(window.initialDashboardContainer)if(window.initialDashboardContainer===t.constants.initialDashboardContainerLoadingState){this.gettingAppMetadata=!0;var o=this.rootScope.$on(t.constants.initialDashboardContainerReadyEventName,(function(){e.editableFeatureSwitchService.registerFeatureSwitches(window.initialDashboardContainer.featureSwitches),e.importResourcePackages(window.initialDashboardContainer.resourcePackages).finally((function(){e.getAppMetadataDeferred.resolve(window.initialDashboardContainer),e.gettingAppMetadata=!1,o()}))}))}else window.initialDashboardContainer!==t.constants.initialDashboardContainerErrorState?(this.editableFeatureSwitchService.registerFeatureSwitches(window.initialDashboardContainer.featureSwitches),this.importResourcePackages(window.initialDashboardContainer.resourcePackages).finally((function(){e.getAppMetadataDeferred.resolve(window.initialDashboardContainer)}))):this.getAppMetadataDeferred.reject();else this.getAppMetadataDeferred.reject();return this.getAppMetadataDeferred.promise},o.prototype.getOrgAppsMetadata=function(){var t=this,o=window.initialDashboardContainer&&window.initialDashboardContainer.groupGUID;if(!_.isEmpty(o)){if(null!=this.getMyWorkSpaceAppMetadataDeferred)return this.getMyWorkSpaceAppMetadataDeferred.promise;var r=this.telemetryService.startEvent(e.telemetry.AppServiceGetOrgAppsMetadata);this.getMyWorkSpaceAppMetadataDeferred=this.promiseFactory.defer();var i=e.common.httpService.powerbiRequestOptions(r.event,"AppServiceGetOrgAppsMetadata",{dismissGroupObjectId:!0});return e.common.httpService.get("powerbi/metadata/app",i).then((function(e){t.getMyWorkSpaceAppMetadataDeferred.resolve(e.data),r.resolve()}),(function(o){t.getMyWorkSpaceAppMetadataDeferred.reject(null),r.reject(e.errorDetailsHelper.getTelemetryErrorDetails(o.error,o.status))})),this.getMyWorkSpaceAppMetadataDeferred.promise}return this.getAppMetadata()},o.prototype.importResourcePackages=function(t){var o=this;if(this.importResourcePackagesDeferred)return this.importResourcePackagesDeferred.promise;this.importResourcePackagesDeferred=this.promiseFactory.defer();var r=window.initialDashboardContainer.activeDashboardId;if(_.isEmpty(t))this.importResourcePackagesDeferred.resolve(null),window.initialDashboardContainer&&r&&this.telemetryService.logEvent(e.telemetry.DashboardImportResourcePackagesOnLoad,r.toString(),0);else{var i;window.initialDashboardContainer&&r&&(i=this.telemetryService.startEvent(e.telemetry.DashboardImportResourcePackagesOnLoad,window.initialDashboardContainer.activeDashboardId.toString(),t.length));var a=_.map(t,(function(e){return e.id.toString()}));this.resourcePackageGateService.shouldShowWarning(a,r.toString())?(this.importResourcePackagesDeferred.resolve(null),i&&i.resolve()):(this.resourcePackagesService.registerPackages(t),this.visualPluginService.ensurePlugins(t,!1).catch((function(){i&&i.reject()})).finally((function(){i&&i.resolve(),o.importResourcePackagesDeferred.resolve(null)})))}return this.importResourcePackagesDeferred.promise},o})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(){return new i}var r=e.common.contracts.ContentProviderCategory;t.createAppCollectionService=o;var i=(function(){function e(){this.apps=[]}return e.prototype.findServiceContentProvider=function(e){return _.find(this.apps,(function(t){return t.providerId===e&&(t.category===r.ServiceApp||t.category===r.Services)}))},e.prototype.findOrganizationalContentProvider=function(e){return _.find(this.apps,(function(t){return t.providerId===e&&(t.category===r.Organizational||t.category===r.OrganizationalApp||t.category===r.OrganizationalTemplate||t.category===r.OrganizationalTemplateApp)}))},e.prototype.findContentProviderByKey=function(e){if(null!=e)return _.find(this.apps,(function(t){return t.providerKey===e}))},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,a,n,s,c,l,p,u,v){return new d(e,t,o,r,i,a,n,s,c,l,p,u,v)}function r(e){return new l(e)}var i=e.common.contracts.ContentProviderCategory,a=e.errorDetailsHelper,n=e.common.dialog.MessageDialogBuilder,s=e.common.NotifyCollection,c=t.contracts.PackageType;t.createAppService=o;var d=(function(){function t(e,t,o,r,i,a,c,d,l,p,u,v,h){this.appMetadataService=e,this.dashboardDataService=t,this.appCollectionService=o,this.modelService=r,this.reportService=i,this.workbookService=a,this.promiseFactory=c,this.dataServiceModelConverter=d,this.asyncFeatureSwitchService=l,this.telemetryService=p,this.modalDialogService=u,this.errorService=v,this.localizationService=h,this.inFlightAppRequests=[{},{},{}],this.appInstanceRequests={},this.apps=[],this.instances=new s,this.messageDialogBuilder=new n(u)}return Object.defineProperty(t.prototype,"apps",{get:function(){return this.appCollectionService.apps},set:function(e){this.appCollectionService.apps=e},enumerable:!0,configurable:!0}),t.prototype.ensureAppsInitialization=function(){return null!=this.appsInitializationDeferred?this.appsInitializationDeferred.promise:this.getOrgAppsMetadata().promise},t.prototype.getAppByCategory=function(e){return _.filter(this.apps,(function(t){
return t.category===e}))},t.prototype.getAppByGUID=function(e){return _.find(this.apps,(function(t){return t.providerKey===e}))},t.prototype.updateAppsCollection=function(e,t){var o=this;this.apps=_.filter(e,(function(e){return o.isAppContentProvider(e)}))||[],this.instances.setItems([]);var r=_.filter(t,(function(e){return e.packageType===c.AppInstance}));if(!_.isEmpty(r))for(var i=0,a=r;i<a.length;i++){var n=a[i];this.onInstanceAdded(n)}},t.prototype.addApp=function(e){!this.isInstalledApp(e)&&this.isAppContentProvider(e)&&this.apps.push(e)},Object.defineProperty(t.prototype,"appInstances",{get:function(){return this.instances.items},set:function(e){this.instances.setItems(e)},enumerable:!0,configurable:!0}),t.prototype.onInstanceAdded=function(e){var t=this;if(e.packageType!==c.AppInstance)return this.promiseFactory.reject();var o=this.getAppInstance(e.id);if(null!=o)return this.promiseFactory.resolve(o);var r=this.appInstanceRequests[e.id];if(r)return r.promise;r=this.appInstanceRequests[e.id]=this.promiseFactory.defer();var i=this.getAppDefinitionForInstance(e);return i.then((function(o){var i=t.createInstance(o,e);t.addInstance(i),r.resolve(i)}),(function(e){r.reject()})).finally((function(){delete t.appInstanceRequests[e.id]})),r.promise},t.prototype.onInstanceDeleted=function(e){this.instances.deleteItems((function(t){return t.packageId===e}))},t.prototype.deleteInstance=function(e){var t=this,o=this.getAppInstance(e);if(null==o)return this.promiseFactory.reject();var r=this.promiseFactory.defer();return this.messageDialogBuilder.show("UninstallAppDialog",{titleText:this.localizationService.get("AppModel_UninstallAppTitle"),messageText:this.localizationService.get("AppModel_UninstallAppMessage"),okButtonText:this.localizationService.get("ModalDialogButtonText_Delete"),cancelButtonText:this.localizationService.get("ModalDialogButtonText_Cancel")}).then((function(e){0===e?t.deleteInstanceInternal(o,r):r.reject()})),r.promise},t.prototype.getAppInstance=function(e){return _.find(this.appInstances,(function(t){return t.packageId===e}))},t.prototype.subscribeToInstanceEvents=function(e){this.appInstancesCollectionChangedHandlers||(this.appInstancesCollectionChangedHandlers=[],this.setupAppInstanceListener()),this.appInstancesCollectionChangedHandlers.push(e)},t.prototype.unsubscribeToInstanceEvents=function(e){this.appInstancesCollectionChangedHandlers&&(_.pull(this.appInstancesCollectionChangedHandlers,e),_.isEmpty(this.appInstancesCollectionChangedHandlers)&&(this.appInstancesCollectionChangedHandlers=null,this.instances.unsubscribe(this.appInstanceListener)))},t.prototype.getAppInstancesForApp=function(e){return _.filter(this.appInstances,(function(t){return t.providerContract.providerKey===e}))},t.prototype.onArtifactAdded=function(e,t,o,r){_.contains(o,e.id)||(o.push(e.id),r.push(e),this.notifyListeners((function(e){return e.onInstanceUpdated&&e.onInstanceUpdated(t)})))},t.prototype.onArtifactDeleted=function(e,t,o,r){_.contains(o,e.id)&&(_.pull(o,e.id),_.pull(r,e),this.notifyListeners((function(e){return e.onInstanceUpdated&&e.onInstanceUpdated(t)})))},t.prototype.setupArtifactListeners=function(){var e=this;this.dashboardListener={onDashboardAdded:function(t){var o=e.getAppInstance(t.contract.originalPackageId);o&&e.onArtifactAdded(t,o,o.dashboardIds,o.dashboards)},onDashboardDeleted:function(t){var o=e.getAppInstance(t.contract.originalPackageId);o&&e.onArtifactDeleted(t,o,o.dashboardIds,o.dashboards)},onDashboardsReset:_.noop},this.dashboardDataService.subscribe(this.dashboardListener),this.reportListener={onReportAdded:function(t){var o=e.getAppInstance(t.packageId);o&&e.onArtifactAdded(t,o,o.reportIds,o.reports)},onReportDeleted:function(t){var o=e.getAppInstance(t.packageId);o&&e.onArtifactDeleted(t,o,o.reportIds,o.reports)},onReportsReset:_.noop},this.reportService.subscribe(this.reportListener),this.workbookListener={onWorkbookAdded:function(t){var o=e.getAppInstance(t.packageId);o&&e.onArtifactAdded(t,o,o.workbookIds,o.workbooks)},onWorkbookDeleted:function(t){var o=e.getAppInstance(t.packageId);o&&e.onArtifactDeleted(t,o,o.workbookIds,o.workbooks)},onWorkbooksReset:_.noop},this.workbookService.subscribe(this.workbookListener),this.modelListener={onModelAdded:function(t){var o=e.getAppInstance(t.packageId);o&&e.onArtifactAdded(t,o,o.modelIds,o.models)},onModelDeleted:function(t){var o=e.getAppInstance(t.packageId);o&&e.onArtifactDeleted(t,o,o.modelIds,o.models)},onModelsReset:_.noop},this.modelService.subscribe(this.modelListener)},t.prototype.setupAppInstanceListener=function(){var e=this;this.appInstanceListener||(this.appInstanceListener={onAdded:function(t){return e.notifyListeners((function(e){return e.onInstanceInstalled&&e.onInstanceInstalled(t)}))},onDeleted:function(t){return e.notifyListeners((function(e){return e.onInstanceUninstalled&&e.onInstanceUninstalled(t)}))},onReset:function(){return e.notifyListeners((function(e){return e.onInstancesReset&&e.onInstancesReset()}))}}),this.instances.subscribe(this.appInstanceListener)},t.prototype.getOrgAppsMetadata=function(){var e=this;if(null==this.appsInitializationDeferred){this.appsInitializationDeferred=this.promiseFactory.defer();var t=this.appMetadataService.getOrgAppsMetadata?this.appMetadataService.getOrgAppsMetadata():this.appMetadataService.getAppMetadata();this.promiseFactory.all([t,this.asyncFeatureSwitchService.getFeatureSwitches(),this.dashboardDataService.getDashboards(),this.reportService.ensureReportsInitialization(),this.workbookService.ensureWorkbookInitialization(),this.modelService.modelsPromise]).then((function(t){e.initializeAppCategories(e.asyncFeatureSwitchService);var o=t[0];o&&(o.apps||o.packages)&&e.updateAppsCollection(o.apps,o.packages),e.asyncFeatureSwitchService.featureSwitches.appsEnabled&&e.setupArtifactListeners(),e.appsInitializationDeferred.resolve(e)}),(function(){e.appsInitializationDeferred.reject()}))}return this.appsInitializationDeferred},t.prototype.notifyListeners=function(e){var t=this.appInstancesCollectionChangedHandlers;if(!_.isEmpty(t)&&e)for(var o=t.length-1;o>=0;o--)e(t[o])},t.prototype.deleteInstanceInternal=function(t,o){var r=this,n=t.providerContract.providerKey,s=t.packageId;this.onInstanceDeleted(s);var c=this.telemetryService.startEvent(e.telemetry.AppsUninstallApp,n,i[t.category]),d=e.common.httpService.powerbiRequestOptions(c.event,"UninstallApp");d.enableTelemetry=!0,e.common.httpService.delete("/powerbi/content/providers/organization/"+n+"/?packageid="+s+"&uninstall=true",d).then((function(e){c.resolve(),o.resolve(null)}),(function(e){r.addInstance(t),c.reject(a.getTelemetryErrorDetails(e.error,e.status)),r.errorService.error(r.localizationService.get("AppModel_FailToUninstallAppMessage"),"AppModel_FailToUninstallApp",{requestId:e.requestId,statusCode:e.status.toString()}),o.reject()}))},t.prototype.getServiceApp=function(e){return _.find(this.apps,(function(t){return t.providerId===e&&(t.category===i.ServiceApp||t.category===i.Services)}))},t.prototype.getOrgApp=function(e){return _.find(this.apps,(function(t){return t.providerId===e&&(t.category===i.OrganizationalApp||t.category===i.OrganizationalTemplateApp)}))},t.prototype.getAppDefinitionForInstance=function(e){return e.packageType!==c.AppInstance?this.promiseFactory.reject():e.contentProviderRefId?this.getAppDefinitionByType(e.contentProviderRefId,0):e.serviceContentProviderId?this.getAppDefinitionByType(e.serviceContentProviderId,1):this.promiseFactory.reject()},t.prototype.getAppDefinitionByType=function(e,t){var o,r=this;switch(t){case 0:o=this.getOrgApp(e);break;case 1:o=this.getServiceApp(e);break;default:o=null}if(o)return this.promiseFactory.resolve(o);var i=this.inFlightAppRequests[t][e];return i?i.promise:(i=this.inFlightAppRequests[t][e]=this.promiseFactory.defer(),this.getAppDefinition(e,1===t).then((function(e){var t=e&&e.data;t&&r.isAppContentProvider(t)?(o=r.getAppByGUID(t.providerKey),o||r.addApp(t),i.resolve(o||t)):i.reject()}),(function(e){return i.reject()})).finally((function(){delete r.inFlightAppRequests[t][e]})),i.promise)},t.prototype.isInstalledApp=function(e){return!!this.getAppByGUID(e.providerKey)},t.prototype.isAppCategory=function(e){return _.contains(this.validAppCategories,e)},t.prototype.isAppContentProvider=function(e){return!!e&&this.isAppCategory(e.category)},t.prototype.initializeAppCategories=function(e){this.validAppCategories=[],e.featureSwitches.appsEnabled&&this.validAppCategories.push(i.OrganizationalApp),e.featureSwitches.appTemplatesEnabled&&this.validAppCategories.push(i.OrganizationalTemplateApp),e.featureSwitches.serviceAppsEnabled&&(this.validAppCategories.push(i.ServiceApp),this.validAppCategories.push(i.Services))},t.prototype.getAppDefinition=function(t,o){var r=this.telemetryService.startEvent(e.telemetry.AppsGetApp),i=e.common.httpService.powerbiRequestOptions(r.event,"GetContentProvider"),n="/metadata/appmodel/contentprovider?id="+t;o&&(n+="&isService=true");var s=e.common.httpService.get(n,i);return s.then((function(e){r.resolve()}),(function(e){r.reject(a.getTelemetryErrorDetails(e.error,e.status))})),s},t.prototype.addInstance=function(e){var t=this.getAppInstance(e.packageId);null==t&&this.instances.addItem(e)},t.prototype.createInstance=function(e,t){var o=this.dataServiceModelConverter.convertInstalledAppModel(e,t),r=t.id;return o.dashboards=this.dashboardDataService.findDashboardsByPackageId(r)||[],o.reports=this.reportService.findReportsByPackageId(r)||[],o.workbooks=this.workbookService.findWorkbooksByPackageId(r)||[],o.models=this.modelService.findModelsByPackageId(r)||[],o.dashboardIds=_.map(o.dashboards,(function(e){return e.id})),o.reportIds=_.map(o.reports,(function(e){return e.id})),o.workbookIds=_.map(o.workbooks,(function(e){return e.id})),o.modelIds=_.map(o.models,(function(e){return e.id})),o},t})();t.createMockAppService=r;var l=(function(){function e(e){this.promiseFactory=e}return Object.defineProperty(e.prototype,"apps",{get:function(){return[]},set:function(e){},enumerable:!0,configurable:!0}),e.prototype.ensureAppsInitialization=function(){return this.promiseFactory.reject()},e.prototype.getAppByCategory=function(e){return[]},e.prototype.getAppByGUID=function(e){return null},e.prototype.updateAppsCollection=function(e){},e.prototype.updateInstances=function(e){},e.prototype.addApp=function(e){},e.prototype.isAppCategory=function(e){return!1},e.prototype.onInstanceAdded=function(e){return this.promiseFactory.reject()},e.prototype.onInstanceDeleted=function(e){},e.prototype.deleteInstance=function(e){return this.promiseFactory.reject()},e.prototype.getAppInstance=function(e){return null},e.prototype.subscribeToInstanceEvents=function(e){},e.prototype.unsubscribeToInstanceEvents=function(e){},e.prototype.getAppInstancesForApp=function(e){},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(){return new i}var r=e.common.NotifyCollection;t.createDashboardCollectionService=o;var i=(function(){function e(){this.listeners=[],this.collection=new r}return Object.defineProperty(e.prototype,"dashboards",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.getDashboardContracts=function(){return _.map(this.dashboards,(function(e){return e.contract}))},e.prototype.findDashboardContract=function(e){var t=this.getDashboardContracts();return _.find(t,(function(t){return t.id===e}))},e.prototype.onAdded=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onDashboardAdded&&i.onDashboardAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onDashboardDeleted&&i.onDashboardDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,o=e;t<o.length;t++){var r=o[t];r.onDashboardsReset&&r.onDashboardsReset()}},e.prototype.addDashboard=function(e){this.collection.addItem(e)},e.prototype.removeDashboard=function(e){this.collection.deleteItems((function(t){return t.id===e}))},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,n,s){return new a(e,t,o,r,i,n,s)}var r=e.common.contracts.PermissionArtifactType;t.createDashboardDataService=o;var i=3e3,a=(function(){function e(e,t,o,r,i,a,n){this.refreshStateListeners=[],this.InEditMobileLayoutMode=!1,this.dashboardCollectionService=a,this.isDashboardLoaded=!1,this.dashboardHttpService=e,this.promiseFactory=t,this.featureSwitchService=o,this.modelMerger=r,this.modelService=i,this.dashboardsDeferred=t.defer(),this.isQnaEnabled=!1,this.modelService.addModelUpdateListener(this),this.timeout=n,this.refreshState=0}return e.prototype.registerRefreshStateListener=function(e){_.contains(this.refreshStateListeners,e)||this.refreshStateListeners.push(e)},e.prototype.unregisterRefreshStateListener=function(e){_.remove(this.refreshStateListeners,e)},e.prototype.onDashboardTileRefreshStarted=function(e){this.activeDashboardId===e&&0===this.refreshState&&this.notify(1,e)},e.prototype.onDashboardTileRefreshFinished=function(e){var t=this;this.activeDashboardId===e&&1===this.refreshState&&(this.notify(2,e),this.timeout((function(){return t.notify(0,e)}),i))},e.prototype.notify=function(e,t){this.refreshState=e;for(var o=0,r=this.refreshStateListeners;o<r.length;o++){var i=r[o];i.onStateChange(this.refreshState,t)}},Object.defineProperty(e.prototype,"dashboards",{get:function(){return this.dashboardCollectionService.dashboards},set:function(e){this.dashboardCollectionService.dashboards=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleDashboards",{get:function(){return _.filter(this.dashboardCollectionService.dashboards,(function(e){return!e.isHidden}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editableAndReshareableDashboards",{get:function(){var e=this.dashboards;return _.filter(e,(function(e){return!e.contract.isHidden&&t.PermissionsUtils.canReshare(e.getPermissions(),r.Dashboard)}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboard",{get:function(){return this.activeDashboardId===-1?null:this.findDashboard(this.activeDashboardId)},set:function(e){e?this.activeDashboardId=e.id:this.activeDashboardId=-1,this.refreshState=0,this.updateActiveDashboardModels()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboardContainsQnaSupportedModel",{get:function(){return t.DashboardUtils.containsQnaSupportedModel(this.activeDashboardModels,this.modelService,this.featureSwitchService)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeDashboardIndex",{get:function(){return this.dashboards.indexOf(this.activeDashboard)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayName",{get:function(){return this.activeDashboard?this.activeDashboard.displayName:""},enumerable:!0,configurable:!0}),e.prototype.addDashboard=function(e){if(e){var t=this.getDashboardIndex(e.id);t<0&&this.dashboardCollectionService.addDashboard(e)}},e.prototype.addOrReplaceDashboard=function(e){var t=this.getDashboardIndex(e.id);t<0?this.dashboardCollectionService.addDashboard(e):this.dashboards.splice(t,1,e)},e.prototype.deleteDashboardAtServerSide=function(e,t){var o=this.promiseFactory.defer(),r=this.dashboards.filter((function(t){return t.id===e}))[0];return r?this.dashboardHttpService.deleteDashboard(r.contract,t.event).then((function(){t.resolve(),o.resolve(null)}),(function(e){t.reject(),o.reject(e)})):o.reject(),o.promise},e.prototype.deleteDashboard=function(e){this.removeDashboard(e)},e.prototype.deleteTile=function(e,t){var o=this,r=this.promiseFactory.defer(),i=this.findDashboard(e);return i?this.tryUpdateTile(i,t,(function(e,t){if(e>=0&&t>=0){var a=i.contract.tiles[e];i.contract.tiles.splice(e,1),i.tiles.splice(t,1),i.hasModel(a.modelId)||o.dashboardHttpService.addDashboardRequestToBatch(o.promiseFactory,i.id).done((function(e){o.modelMerger.mergeDashboardShallow(i,e.dashboards[0]),o.updateActiveDashboardModels(),r.resolve(null)})).fail((function(){r.reject()}))}else r.resolve(null)})):r.resolve(null),r.promise},e.prototype.dropDashboardfromMemoryIfNotActive=function(e){var t=this.activeDashboard;if(!t||t.id!==e){var o=this.findDashboard(e);return o&&(o.contract.tiles=null,o.isLoaded=!1),!0}return!1},e.prototype.findDashboard=function(e){return _.find(this.dashboards,(function(t){return t.id===e}))},e.prototype.findDashboardByGUID=function(e){for(var t=0,o=this.dashboards;t<o.length;t++){var r=o[t];if(r.objectId===e)return r}},e.prototype.findDashboardsByPackageId=function(e){var t=this.dashboards;if(t)return _.filter(t,(function(t){return!(!t.contract||!t.contract.originalPackageId)&&t.contract.originalPackageId===e}))},e.prototype.retrieveDashboardForApp=function(e,t){return _.find(this.dashboards,(function(o){return o.getUniquePackageId()===e&&o.contract.originalDashboardObjectId===t}))},e.prototype.getDashboardIndex=function(e){for(var t=this.dashboards,o=0,r=t.length;o<r;o++)if(t[o].id===e)return o;return-1},e.prototype.registerDashboards=function(e){this.dashboards=e,this.isDashboardLoaded=!0},e.prototype.tryUpdateTile=function(e,t,o){if(e){var r=e.getTileContractIndex(t),i=e.getTileIndex(t);o(r,i),e.scheduleDelayedLayout(this.activeDashboard!==e)}},e.prototype.updateActiveDashboardModels=function(){this.activeDashboardModels=t.DashboardUtils.getDashboardModels(this.activeDashboard,this.modelService.getModelContracts()),this.updateIsQnaEnabled()},e.prototype.isActiveDashboardModelRefreshDisabled=function(){var e=this.activeDashboardModels;if(_.isEmpty(e))return!1;for(var t=this.modelService,o=0,r=e;o<r.length;o++){var i=r[o],a=t.findModel(i.id,i.packageId);if(a&&a.isRefreshDisabledDueToInactivity())return!0}return!1},e.prototype.updateIsQnaEnabled=function(){this.activeDashboard?"undefined"!=typeof this.activeDashboard.qnaEnabled?this.isQnaEnabled=this.activeDashboard.qnaEnabled:this.isQnaEnabled=this.activeDashboardContainsQnaSupportedModel:this.isQnaEnabled=!1},e.prototype.onModelUpdated=function(e,t){var o=this.modelService.findModel(e,t);o&&this.updateActiveDashboardModels()},e.prototype.getDashboards=function(){var e=this;return this.dashboardsDeferred.promise.then((function(){return e.dashboards}))},e.prototype.resolveDashboardDeferred=function(){this.dashboardsDeferred.resolve(this)},e.prototype.rejectDashboardDeferred=function(){this.dashboardsDeferred.reject()},e.prototype.removeDashboard=function(e){this.dashboardCollectionService.removeDashboard(e)},e.prototype.subscribe=function(e){this.dashboardCollectionService.subscribe(e)},e.prototype.unsubscribe=function(e){this.dashboardCollectionService.unsubscribe(e)},e})();t.DashboardDataService=a})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,i,a,n,s,c,d,l,p,u,v,h,m,f,g){return new r(e,t,o,i,a,n,s,c,d,l,p,u,v,h,m,f,g)}t.createDashboarSyncService=o;var r=(function(){function o(e,t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f){this.rootScope=e,this.dashboardDataService=t,this.dashboardHttpService=o,this.modelConverter=r,this.modelMerger=i,this.modelService=a,this.reportService=s,this.promiseFactory=n,this.resourcePackageGateService=c,this.resourcePackageListenerService=d,this.resourcePackagesService=l,this.syncService=p,this.telemetryService=u,this.tutorialDataStore=v,this.userInfo=h,this.workbookService=m,this.permissionService=f,this.syncService.addDashboardRefreshListener(this)}return o.prototype.onTilesAddedOrUpdated=function(e,t){var o=this;if(!this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)){if(this.dashboardDataService.selectedDashboardTile){0===t.length&&(t=this.dashboardDataService.activeDashboard.tiles.map((function(e){return e.id})));var r=t.indexOf(this.dashboardDataService.selectedDashboardTile.tileModel.id);if(r>=0&&(t.splice(r,1),0===t.length))return}this.dashboardHttpService.batchGetTiles(e,t,void 0).then((function(t){var r=t.data;if(!_.isEmpty(r))for(var i=0,a=r.length;i<a;++i){var n=r[i];o.registerAndUpdateTile(e,n)}}))}},o.prototype.onTileDeleted=function(e,t){this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)||this.dashboardDataService.deleteTile(e,t)},o.prototype.onDashboardAdded=function(e){this.addOrDeepEditDashboard(e)},o.prototype.onDashboardDeleted=function(e){this.beforeDashboardDeleting&&this.beforeDashboardDeleting(e),this.dashboardDataService.deleteDashboard(e),this.afterDashboardDeleting&&this.afterDashboardDeleting(e)},o.prototype.onDashboardShallowEdit=function(o){var r=this,i=this.dashboardDataService.findDashboard(o);i&&this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,o,e.common.DashboardRequestType.Metadata).done((function(e){var o=e.dashboards[0],a=o.isHidden&&!i.isHidden;r.modelMerger.mergeDashboardShallow(i,o),a&&r.dashboardDataService.deleteDashboard(i.id),r.rootScope.$emit(t.constants.onDashboardShallowEditEventName,i,o)}))},o.prototype.onDashboardDeepEdit=function(e){this.dashboardDataService.dropDashboardfromMemoryIfNotActive(e)||this.addOrDeepEditDashboard(e)},o.prototype.onDashboardTileDataChange=function(e){this.onTilesAddedOrUpdated(e,[]),this.dashboardDataService.onDashboardTileRefreshFinished(e)},o.prototype.onClearBatchedDashboardRequests=function(){this.dashboardHttpService.batchedDashboardRequests=[]},o.prototype.addOrDeepEditDashboard=function(o){var r=this,i=this.telemetryService.startEvent(e.telemetry.DashboardAddUpdateDashboard);this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,o).done((function(e){r.addOrUpdateDashboard(e),r.rootScope.$emit(t.constants.updateDashboardContainerEventName,[e]),r.dashboardDataService.onDashboardTileRefreshFinished(o),i.resolve()})).fail((function(){i.reject()}))},o.prototype.addOrUpdateCustomVisualTile=function(e,o,r,i){var a=this;this.isResourcePackageInCache(e)?this.addOrUpdateTile(o,r,this.modelService.getModelContracts()):this.resourcePackageListenerService.getAndLoadVisualPlugin(e).then((function(){a.addOrUpdateTile(o,r,a.modelService.getModelContracts()),i&&(a.resourcePackageGateService.resetResourceFlag(),a.rootScope.$emit(t.constants.shouldShowEnableCustomVisualsDialog))}))},o.prototype.addOrUpdateDashboard=function(e){var o=e.dashboards[0],r=this.modelConverter.convertDashboard(o,e.models,e.reports),i=this.dashboardDataService.getDashboardIndex(o.id),a=!1;if(this.modelConverter.fillDashboardChildren(r,e.models,e.reports,this.workbookService.getWorkbookContracts()),i>=0){var n=this.dashboardDataService.dashboards[i];this.modelMerger.mergeDashboard(n,o,e.models,e.reports);for(var s=n.tiles.length,c=0;c<s;c++){var d=n.tiles[c];d.invalidateLayout()}}else this.dashboardDataService.addDashboard(r),r.isNew=!0,r.isNotified=!1,r.isLoaded=!0,a=!0,this.userInfo.addOrUpdateDashboardOwnerInfoCache(o.ownerInfo);this.rootScope.$emit(t.constants.addOrUpdateDashboardEventName,e,a),this.dashboardDataService.onDashboardTileRefreshFinished(r.id)},o.prototype.addOrUpdateTile=function(e,t,o){var r=this;e&&(o=o||[],this.updateModelsIfRequired(e,t),this.dashboardDataService.tryUpdateTile(e,t.id,(function(i,a){var n=r.reportService.findReport(t.reportId),s=null;i>=0?(e.contract.tiles[i]=t,a>=0&&(s=e.tiles[a],r.modelMerger.mergeTile(s,t,o,null,r.workbookService.getWorkbookContracts(),r.reportService.reports))):(!n&&t.reportId&&(n=r.modelConverter.convertReport({id:t.reportId}),r.reportService.addReport(n)),s=r.modelConverter.convertTile(t,o,null,r.workbookService.getWorkbookContracts()),e.contract.tiles.push(t),e.tiles.push(s)),s&&(s.invalidateLayout(),n&&(s.report=n))})))},o.prototype.clearSeenDashboards=function(){var o=this.telemetryService.startEvent(e.telemetry.DashboardSharingNewUnseenDashboards,0,0,0);this.tutorialDataStore.setKey(t.constants.seenDashboardsStorageKey,{},o)},o.prototype.registerAndUpdateTile=function(e,t){var o=this.dashboardDataService.findDashboard(e),r=$.map(t.resourcePackageIds,(function(e){return e.toString()})),i=this.resourcePackageGateService.shouldShowWarning(r,this.dashboardDataService.activeDashboard.objectId);if(t.resourcePackageIds&&t.resourcePackageIds.length>0)for(var a=t.resourcePackageIds.length,n=0;n<a;++n)this.addOrUpdateCustomVisualTile(t.resourcePackageIds[n],o,t,i);else this.addOrUpdateTile(o,t,this.modelService.getModelContracts())},o.prototype.updateModelsIfRequired=function(e,o){var r=this,i=e.getTileContractIndex(o.id),a=i!==-1&&o.publishState===t.contracts.TilePublishState.Completed&&e.contract.tiles[i].publishState===t.contracts.TilePublishState.InProgress;!a&&e.hasModel(o.modelId)||this.dashboardHttpService.addDashboardRequestToBatch(this.promiseFactory,e.id).done((function(o){a&&(r.modelMerger.mergeDashboardTiles(e,o),r.rootScope.$emit(t.constants.mergeDashboardContainerModelsReportsAndPackagesEventName,o),r.modelMerger.mergeModelContentProviderId(o.models,o.packages)),r.modelMerger.mergeDashboardShallow(e,o.dashboards[0]),r.dashboardDataService.updateActiveDashboardModels()}))},o.prototype.isResourcePackageInCache=function(e){var t=this.resourcePackagesService.getAllPackages();return _.some(t,(function(t){return t.id===e}))},o})();t.DashboardSyncService=r})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,i,a,n){return new r(e,t,o,i,a,n)}t.createHostAppMetadataService=o;var r=(function(){function t(e,t,o,r,i,a){this.promiseFactory=e,this.telemetryService=t,this.eventFactory=o,this.editableFeatureSwitchService=r,this.errorCallback=i,this.getAppMetadataDeferred=this.promiseFactory.defer(),this.requestAppMetadata(r,a)}return t.prototype.getAppMetadata=function(){return this.getAppMetadataDeferred.promise},t.prototype.requestAppMetadata=function(o,r){var i=this,a=this.telemetryService.startEvent(this.eventFactory),n=e.common.httpService.powerbiRequestOptions(a.event,"DashboardHostGetAppMetadata",{isAdminRequest:r});e.common.httpService.get("powerbi/metadata/app",n).then((function(e){var t=e.data;window.initialDashboardContainer=t,i.editableFeatureSwitchService.registerFeatureSwitches(t.featureSwitches),i.getAppMetadataDeferred.resolve(t),a.resolve()}),(function(o){i.getAppMetadataDeferred.reject(null),a.reject(e.errorDetailsHelper.getTelemetryErrorDetails(o.error,o.status)),i.errorCallback&&i.errorCallback(t.pageRefreshErrorMessage)}))},t})();r.pageRefreshErrorMessage="GetAppMetadataRequestFailed"})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(){return new o}e.createPackageCollectionService=t;var o=(function(){function e(){this.packages=[]}return e.prototype.getPackageContracts=function(){return _.map(this.packages,(function(e){return e.contract}))},e.prototype.findPackageContract=function(e){var t=this.getPackageContracts();return _.find(t,(function(t){return t.id===e}))},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,a,n,s,d,l,p,u,v,h,m){return new c(e,t,o,r,i,a,n,s,d,l,p,u,v,h,m)}var r=t.models.ContentPackItems,i=e.common.contracts.ContentProviderCategory,a=t.contracts.PackageType,n=e.common.contracts.PublishOrRefreshStatus,s=e.common.contracts.StorageProviderType;t.createPackageService=o;var c=(function(){function o(e,t,o,r,i,a,n,s,c,d,l,p,u,v,h){this.rootScope=e,this.telemetryService=t,this.errorService=o,this.modelMerger=r,this.modelConverter=i,this.reportService=a,this.modelService=n,this.syncService=s,this.localizationService=c,this.appMetadataService=d,this.workbookService=l,this.appService=p,this.packageCollectionService=u,this.permissionService=v,this.promiseFactory=h,this.initPackages(),this.syncService.addPackageRefreshListener(this)}return o.prototype.ensurePackagesInitialization=function(){return this.packagesInitializationDeferred.promise},Object.defineProperty(o.prototype,"packages",{get:function(){return this.packageCollectionService.packages},set:function(e){this.packageCollectionService.packages=e},enumerable:!0,configurable:!0}),o.prototype.findPackage=function(e){return _.find(this.packages,(function(t){return t.id===e}))},o.prototype.getWorkbookStorageProvider=function(e){var t=this.findPackage(e);return t&&t.contract?t.contract.storageProviderType:null},o.prototype.getWorkbookContentProvider=function(e){var t=this.findPackage(e);return t?t.contentProviderId:null},o.prototype.getInstalledOrgPackage=function(e){return _.find(this.packages,(function(t){return t.contract&&t.contract.contentProviderRefId&&t.contract.contentProviderRefId===e&&t.packageType===a.AppInstance}))},o.prototype.isLocalWorkbook=function(e){var t=this.findPackage(e);return t&&t.contract&&t.contract.storageProviderType===s.Local},o.prototype.getPackagesByProviderId=function(e,t){switch(t){case i.BuiltIn:return _.filter(this.packages,(function(t){return t.contract.contentProviderId===e}));case i.Organizational:case i.OrganizationalApp:case i.OrganizationalTemplate:case i.OrganizationalTemplateApp:return _.filter(this.packages,(function(t){return t.contract.contentProviderRefId===e}));case i.ServiceApp:case i.Services:return _.filter(this.packages,(function(t){return t.contract.serviceContentProviderId===e}))}},o.prototype.getPackagesByProviderIdAndPackageType=function(e,t,o){switch(t){case i.BuiltIn:return _.filter(this.packages,(function(t){return t.contract.contentProviderId===e&&t.packageType===o}));case i.Organizational:case i.OrganizationalApp:case i.OrganizationalTemplate:case i.OrganizationalTemplateApp:return _.filter(this.packages,(function(t){return t.contract.contentProviderRefId===e&&t.packageType===o}));case i.ServiceApp:case i.Services:return _.filter(this.packages,(function(t){return t.contract.serviceContentProviderId===e&&t.packageType===o}))}},o.prototype.getAllAppPackagesByType=function(e){return _.filter(this.packages,(function(t){return t.packageType===e}))},o.prototype.isRefreshNowEnabledForWorkbook=function(e){if(!e)return!1;if(!e.isOwner())return!1;var t=this.findPackage(e.packageId);return!(!t||!t.contract)},o.prototype.isScheduleRefreshEnabledForWorkbook=function(e){return!(!e||!e.contract)&&(!!this.isRefreshNowEnabledForWorkbook(e)&&(void 0!==e.modelId&&!!e.contract.isPowerPivotVersionSupportsRefresh))},o.prototype.initPackages=function(){var e=this;this.packagesInitializationDeferred=this.promiseFactory.defer(),this.appMetadataService.getAppMetadata().then((function(t){e.loadPackages(t),e.packagesInitializationDeferred.resolve(e)}),(function(){return e.packagesInitializationDeferred.reject()}))},o.prototype.loadPackages=function(e){e&&e.packages&&this.updatePackageCollection(e.packages)},o.prototype.updatePackageCollection=function(e){if(this.packages=[],!_.isEmpty(e))for(var t=0,o=e.length;t<o;++t)this.packages.push(this.modelConverter.convertPackage(e[t]))},o.prototype.mergePackageCollection=function(e){if(!_.isEmpty(e)){for(var t=0,o=e.length;t<o;++t)this.packages.push(this.modelConverter.convertPackage(e[t]));this.packages=_.unique(this.packages,!1,(function(e){return e.id}))}},o.prototype.deletePackage=function(e){var t=this.getPackageIndex(e);if(t>=0){var o=this.findPackage(e);o.contract.reports&&this.reportService.deleteReportForPackage(e),o.packageType===a.AppInstance&&this.appService.onInstanceDeleted(o.id),this.modelService.deleteModelForPackage(e),this.workbookService.deleteWorkbookForPackage(e),this.packages.splice(t,1)}},o.prototype.getPackageIndex=function(e){if(this.packages.length>0)for(var t=0,o=this.packages.length;t<o;t++){var r=this.packages[t];if(r.id===e)return t}return-1},o.prototype.updatePackage=function(e){if(e&&e.id){var o=this.findPackage(e.id);o?this.modelMerger.mergePackage(o,e):(o=this.modelConverter.convertPackage(e),this.packages.push(o)),o.hasUpdate()&&this.rootScope.$emit(t.constants.packageVersionChange,e.id);
}},o.prototype.onPackagePublishRefreshCompleted=function(o){var r=this,i=this.telemetryService.startEvent(e.telemetry.DashboardGetNavigationPanePackage);t.packageHttpService.getPackage(o,i.event).then((function(t){var s=t.data;if(s.models)for(var c=0,d=s.models.length;c<d;c++){var l=s.models[c],p=r.modelService.findModel(l.id,o);p?r.updateExistingModel(p,l,s.publishOrRefreshStatus):r.modelService.onModelAdded(l.id,o)}if(s.reports)for(var c=0,u=s.reports.length;c<u;c++){var v=s.reports[c],h=r.reportService.updateReport(v);h?h.packagePublishStatus=s.publishOrRefreshStatus:r.reportService.addContractReport(v)}if(s.workbooks)for(var c=0,m=s.workbooks.length;c<m;c++){var f=s.workbooks[c],g=r.workbookService.updateWorkbook(f.id);g||r.workbookService.onWorkbookAdded(f.id,o)}s.packageType===a.AppInstance&&r.appService.onInstanceAdded(s),r.updatePackage(s),s.publishOrRefreshStatus===n.FinishedSuccessfully&&r.rootScope.$emit(e.dataServices.constants.packagePublishedSuccessfullyEventName,s.id),i.resolve()}),(function(){i.reject()}))},o.prototype.onPackagePublishEdit=function(o){var i=this,a=this.telemetryService,s=a.startEvent(e.telemetry.DashboardGetNavigationPanePackage);t.packageHttpService.getPackage(o,s.event).then((function(a){var c=a.data,d=!1,l=0;if(c.models)for(var p=0,u=c.models.length;p<u;p++){var v=c.models[p],h=i.modelService.findModel(v.id,o);h&&i.updateExistingModel(h,v,c.publishOrRefreshStatus)}if(c.reports)for(var p=0,m=c.reports.length;p<m;p++){var f=c.reports[p],g=i.reportService.findReport(f.id);g&&g.packageVersion!==f.packageVersion&&g.isUsedByContentPack&&(d=!0,l=f.id);var y=i.reportService.updateReport(f);y&&(y.modelId=f.modelId,y.model=i.modelService.findModel(f.modelId,o),y.packagePublishStatus=c.publishOrRefreshStatus)}if(c.workbooks)for(var p=0,b=c.workbooks.length;p<b;p++){var S=c.workbooks[p];i.workbookService.updateWorkbook(S.id)}var k=i.findPackage(c.id),I=k?k.publishOrRefreshStatus:null;i.updatePackage(c),I!==n.FinishedSuccessfully&&c.publishOrRefreshStatus===n.FinishedSuccessfully&&i.rootScope.$emit(e.dataServices.constants.packagePublishedSuccessfullyEventName,c.id),c.publishOrRefreshStatus===n.PublishError&&i.deletePackageOnPublishFailure(a),d&&(i.rootScope.$emit(t.constants.contentPackDirtyShowNotification,l,r.Report),d=!1),s.resolve()}),(function(){s.reject()}))},o.prototype.updateExistingModel=function(e,t,o){e.dbName=t.dbName,e.vsName=t.vsName,e.contract.packagePublishStatus=o,e.packagePublishStatus=o},o.prototype.onPackageDeleted=function(e){this.deletePackage(e)},o.prototype.deletePackageOnPublishFailure=function(e){var t=this,o=this.localizationService.get("NavigationPane_PackagePublishErrorTitle"),r=this.localizationService.get("NavigationPane_PackagePublishErrorContent"),i={label:this.localizationService.get("ModalDialogButtonText_Delete"),resultValue:"delete",cssClass:"primary"},a={label:this.localizationService.get("ModalDialogButtonText_Cancel"),resultValue:"cancel"},n=[i,a],s=function(o){if("delete"===o)for(var r=e.data.models.length,i=0;i<r;i++)t.modelService.deleteModel(e.data.models[i].id)};this.errorService.error(r,"deletePackageOnPublishFailure",{title:o,dialogOptions:n,dismissCallback:s,isDismissable:!0,showAdditionalErrorInfo:!0,requestId:e?e.requestId:"",statusCode:e?e.status.toString():""})},o})();t.PackageService=c})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,n,s,c,d){return new a(e,t,o,r,i,n,s,c,d)}var r=jsCommon.EnumExtensions,i=e.common.contracts.Permissions;t.createPermissionService=o;var a=(function(){function o(e,t,o,r,i,a,n,s,c){this.activeGroupIdService=e,this.impersonationService=t,this.appCollectionService=o,this.packageCollectionService=r,this.modelCollectionService=i,this.reportCollectionService=a,this.workbookCollectionService=n,this.dashboardCollectionService=s,this.telemetryService=c,this.errorsLogged={}}return Object.defineProperty(o.prototype,"activeWorkSpacePermission",{get:function(){return this.activeGroupIdService.isReadOnly?i.Read:i.All},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isActiveWorkspaceIsReadOnly",{get:function(){return this.impersonationService.impersonating||!r.hasFlag(this.activeWorkSpacePermission,i.Write)},enumerable:!0,configurable:!0}),o.prototype.isGroupWorkspaceReadOnly=function(e,t){var o=e&&!t?i.Read:i.All;return!r.hasFlag(o,i.Write)},o.prototype.getReportEffectivePermissions=function(e){var o=e&&e.permissions;return null==o?this.logErrorIfItemNotFoundForType("report",e.id):e&&e.packageId&&(t.PermissionsUtils.markDashboardAndReportsAsCopyableIfPartOfTemplateInstance(null,[e.id],null,e.packageId,this.modelCollectionService,this.reportCollectionService,this.dashboardCollectionService,this.packageCollectionService,this.appCollectionService),o=e&&e.permissions),o},o.prototype.getModelEffectivePermissions=function(e){var t=e&&e.permissions;return null==t&&this.logErrorIfItemNotFoundForType("model",e.id,e.packageId),t},o.prototype.getDashboardEffectivePermissions=function(e){var o=e&&e.permissions;return null==o?this.logErrorIfItemNotFoundForType("dashboard",e.id):e&&e.originalPackageId&&(t.PermissionsUtils.markDashboardAndReportsAsCopyableIfPartOfTemplateInstance([e.id],null,null,e.originalPackageId,this.modelCollectionService,this.reportCollectionService,this.dashboardCollectionService,this.packageCollectionService,this.appCollectionService),o=e&&e.permissions),o},o.prototype.getWorkbookEffectivePermissions=function(e){var t=e&&e.permissions;return null==t&&this.logErrorIfItemNotFoundForType("workbook",e.id),t},o.prototype.getPackageEffectivePermissions=function(e){var t=e&&e.permissions;return null==t&&this.logErrorIfItemNotFoundForType("package",e.id,e.id),t},o.prototype.logErrorIfItemNotFoundForType=function(t,o,r){this.errorsLogged[t]||(this.errorsLogged[t]=!0,this.telemetryService.logEvent(e.telemetry.PermissionsObjectNotFound,o,r,t))},o})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o){return new r(e,t,o)}t.createResourcePackageListenerService=o;var r=(function(){function t(e,t,o){this.resourcePackageService=e,this.promiseFactory=t,this.visualPluginService=o}return t.prototype.onResourcePackageAdded=function(e){return this.getAndLoadVisualPlugin(e)},t.prototype.getResourcePackageByResourceId=function(t){var o=e.common.httpService.powerbiRequestOptions(null,"GetResourcePackageByResourceId");return e.common.httpService.post("/powerbi/metadata/resourcePackage",[t],o)},t.prototype.getAndLoadVisualPlugin=function(e){var t=this,o=this.promiseFactory.defer(),r=this.resourcePackageService.getPackageById(e);return r?o.resolve([r]):this.getResourcePackageByResourceId(e).then((function(r){var i=t.resourcePackageService.getPackageById(e);i?o.resolve([i]):(t.resourcePackageService.registerPackages(r.data),t.visualPluginService.ensurePlugins(r.data).then((function(){o.resolve(r.data)}),(function(){o.reject()})))}),(function(e){o.reject()})),o.promise},t.prototype.getAndLoadVisualPluginsForDashboard=function(e){var t=this,o=this.getAllRequiredResourcePackageIds(e);return this.loadRequiredResourcePackagesAndVisualPlugins(o).then((function(e){var o=_.chain(e).filter((function(e){return 0===e.type})).map((function(e){return t.getCustomVisualTypesFromResourcePackages(e.value)})).flatten(!1).unique().value();return t.promiseFactory.resolve(o)}))},t.prototype.getCustomVisualTypesFromResourcePackages=function(e){return _.chain(e).filter((function(e){return 0===e.type})).map((function(e){return e.name})).unique().value()},t.prototype.getLoadedCustomVisualTypesForDashboard=function(e){var t=[];if(e&&e.tiles)for(var o=0,r=e.tiles;o<r.length;o++){var i=r[o],a=i.contract.resourcePackageIds;if(a)for(var n=0,s=a;n<s.length;n++){var c=s[n],d=this.resourcePackageService.getPackageById(c);d&&0===d.type&&t.push(d.name)}}return _.unique(t)},t.prototype.getAllRequiredResourcePackageIds=function(e){var t=[];if(e&&e.tiles)for(var o=0,r=e.tiles;o<r.length;o++){var i=r[o],a=i.contract.resourcePackageIds;if(a)for(var n=0,s=a;n<s.length;n++){var c=s[n];t.push(c)}}return _(t).unique().value()},t.prototype.getAllRequiredResourcePackageIdStrings=function(e){var t=this.getAllRequiredResourcePackageIds(e);return $.map(t,(function(e){return e.toString()}))},t.prototype.loadRequiredResourcePackagesAndVisualPlugins=function(e){for(var t=[],o=0,r=e;o<r.length;o++){var i=r[o];t.push(this.getAndLoadVisualPlugin(i))}return this.promiseFactory.allSettled(t)},t})();t.ResourcePackageListenerService=r})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,a,s,c,d,l,p,u){return new n(e,t,o,r,i,a,s,c,d,l,p,u)}var r=jsCommon.EnumExtensions,i=e.common.contracts.Permissions,a=e.common.contracts.PermissionArtifactType;t.createReportService=o;var n=(function(){function o(e,t,o,r,i,a,n,s,c,d,l,p){this.rootScope=e,this.telemetryService=t,this.errorService=o,this.modelMerger=r,this.modelConverter=i,this.syncService=a,this.reportHttpService=n,this.localizationService=s,this.appMetadataService=c,this.promiseFactory=d,this.reportCollectionService=l,this.permissionService=p,this.reportsDeferred=d.defer(),this.syncService.addReportRefreshListener(this),this.initReports()}return o.prototype.ensureReportsInitialization=function(){return this.reportsDeferred.promise},Object.defineProperty(o.prototype,"reports",{get:function(){return this.reportCollectionService.reports},set:function(e){this.reportCollectionService.reports=e},enumerable:!0,configurable:!0}),o.prototype.getReports=function(){return this.reportsDeferred.promise.then((function(e){return e.reports}))},o.prototype.onReportAdded=function(e){var t=this,o=this.findReport(e);o&&!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(o.displayName)||this.reportHttpService.getReport(e,this.telemetryService.root).then((function(r){var a=r.data;if((a.permissions&i.Write)===i.Write||(a.permissions&i.CopyOnWrite)===i.CopyOnWrite)if(o=t.findReport(e))t.modelMerger.mergeReport(o,a);else{var n=t.modelConverter.convertReport(a);n.isNew=!0,t.addReport(n)}}),(function(){}))},o.prototype.onReportDeleted=function(e){this.removeReport(e)},o.prototype.onReportSlideThumbnailEdit=function(e){},o.prototype.onReportUpdated=function(t){var o=this;if(!(this.reports.length<0)){var r=this.findReport(t);r&&this.reportHttpService.getReport(t,this.telemetryService.root).then((function(i){o.modelMerger.mergeReport(r,i.data),o.currentActiveReport={id:t,displayName:r.displayName,guid:r.objectId},o.rootScope.$emit(e.common.constants.currentActiveReportInfoChangedEventName,o.currentActiveReport)}),_.noop)}},o.prototype.retrieveReportForApp=function(e,t){if(null!=e&&!_.isEmpty(t))return _.find(this.reports,(function(o){return o.packageId===e&&o.contract.originalReportObjectId===t}))},o.prototype.updateReportCollection=function(e){var t=[];if(!_.isEmpty(e))for(var o=0,r=e.length;o<r;++o)t.push(this.modelConverter.convertReport(e[o]));this.reports=t},o.prototype.mergeReportCollection=function(e){if(!_.isEmpty(e))for(var t=_.indexBy(this.reports,"id"),o=0,r=e;o<r.length;o++){var i=r[o];t[i.id]||this.addReport(this.modelConverter.convertReport(i))}},o.prototype.updateReport=function(e){var t=this.findReport(e.id);return t&&this.modelMerger.mergeReport(t,e),t},o.prototype.getReportContracts=function(){return this.reportCollectionService.getReportContracts()},Object.defineProperty(o.prototype,"editableReports",{get:function(){var e=this.permissionService;return _.filter(this.reports,(function(o){var r=e.getReportEffectivePermissions(o.contract);return t.PermissionsUtils.canReshare(r,a.Report)}))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"copyAndEditReports",{get:function(){var e=this.permissionService;return _.filter(this.reports,(function(t){var o=e.getReportEffectivePermissions(t.contract);return r.hasFlag(o,i.Write)||r.hasFlag(o,i.CopyOnWrite)}))},enumerable:!0,configurable:!0}),o.prototype.deleteReportsForModel=function(e,t){for(var o=_.filter(this.reports,(function(o){return o.modelId===e&&o.packageId===t})),r=0,i=o.length;r<i;++r)this.onReportDeleted(o[r].id);return o},o.prototype.deleteReportForPackage=function(e){for(var t=_.filter(this.reports,(function(t){return t.packageId===e})),o=0,r=t.length;o<r;++o)this.onReportDeleted(t[o].id)},o.prototype.addContractReport=function(e){if(e&&null!=e.id){var t=this.modelConverter.convertReport(e),o=this.getReportIndex(e.id);o<0&&(t.isNew=!0,this.addReport(t))}},o.prototype.addReport=function(e){this.reportCollectionService.addReport(e)},o.prototype.removeReport=function(e){var t=this.findReport(e);if(null!=t)return this.reportCollectionService.removeReport(e),t},o.prototype.deleteReport=function(e){this.deleteReportInternal(e)},o.prototype.getReportIndex=function(e){if(null!=e&&this.reports.length>0)for(var t=0,o=this.reports.length;t<o;t++){var r=this.reports[t];if(r.id===e)return t}return-1},o.prototype.findReport=function(e){return null!=e?_.find(this.reports,(function(t){return t.id===e})):null},o.prototype.findReportByGUID=function(e){return null!=e?_.find(this.reports,(function(t){return t.objectId===e})):null},o.prototype.findReportByOriginalReportId=function(e){return null!=e?_.find(this.reports,(function(t){return t.contract.originalReportId===e})):null},o.prototype.findReportsByPackageId=function(e){return _.filter(this.reports,(function(t){return t.packageId===e}))},o.prototype.renameReport=function(o,r){var i=this;if(this.isReportNameValid(o)){var a=this.findReport(r);if(!a)return;var n=a.contract.displayName;if(n!==o){var s=this.telemetryService.startEvent(e.telemetry.DashboardRenameReport);a.displayName=o,this.reportHttpService.renameReport(a,o,s.event).then((function(){s.resolve(),a&&a.isUsedByContentPack&&i.rootScope.$emit(t.constants.contentPackDirtyShowNotification,a.id,t.models.ContentPackItems.Report),i.rootScope.$emit(e.common.constants.currentActiveReportInfoChangedEventName,{id:r,displayName:a.displayName,guid:a.objectId})}),(function(t){t.status===e.HttpStatusCode.Unauthorized?i.errorService.error(i.localizationService.get("Report_NoPermissionToRenameMessage"),"Report_NoPermissionToRename",{requestId:t.requestId,statusCode:t.status.toString()}):i.errorService.error(i.localizationService.get("Report_FailToRenameReportMessage"),"Report_FailToRenameReport",{requestId:t.requestId,statusCode:t.status.toString()}),a.displayName=n,s.reject()}))}}},o.prototype.isReportNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},o.prototype.initReports=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(t){e.loadReports(t)}),(function(){e.loadReports()}))},o.prototype.deleteReportInternal=function(o){var r=this,i=this.telemetryService.startEvent(e.telemetry.DashboardDeleteReport),a=this.removeReport(o);return null==a?void i.resolve():void this.reportHttpService.deleteReport(a.contract,i.event).then((function(){r.rootScope.$emit(t.constants.reportDeletedEventName,o),i.resolve(),a&&a.isUsedByContentPack&&r.rootScope.$emit(t.constants.contentPackDirtyShowNotification,a.id,t.models.ContentPackItems.Report)}),(function(t){t.status===e.HttpStatusCode.Unauthorized?r.errorService.error(r.localizationService.get("Report_NoPermissionToDeleteMessage"),"Report_NoPermissionToDelete",{requestId:t.requestId,statusCode:t.status.toString()}):r.errorService.error(r.localizationService.get("Report_FailToDeleteReportMessage"),"Report_FailToDeleteReport",{requestId:t.requestId,statusCode:t.status.toString()}),r.addReport(a),i.reject()}))},o.prototype.loadReports=function(t){var o=this;if("undefined"==typeof t){var r=this.telemetryService.startEvent(e.telemetry.DashboardInitializeNavigationPaneReports);this.reportHttpService.getReports(r.event).then((function(e){var t=e.data;o.updateReportCollection(t),r.resolve(),o.reportsDeferred.resolve(o)}),(function(){r.reject(),o.reportsDeferred.reject()}))}else t.reports&&(this.updateReportCollection(t.reports),this.reportsDeferred.resolve(this))},o.prototype.subscribe=function(e){this.reportCollectionService.subscribe(e)},o.prototype.unsubscribe=function(e){this.reportCollectionService.unsubscribe(e)},o})();t.ReportService=n})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(){return new i}var r=e.common.NotifyCollection;t.createReportCollectionService=o;var i=(function(){function e(){this.listeners=[],this.collection=new r}return Object.defineProperty(e.prototype,"reports",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.getReportContracts=function(){return _.map(this.reports,(function(e){return e.contract}))},e.prototype.findReportContract=function(e){var t=this.getReportContracts();return _.find(t,(function(t){return t.id===e}))},e.prototype.onAdded=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onReportAdded&&i.onReportAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onReportDeleted&&i.onReportDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,o=e;t<o.length;t++){var r=o[t];r.onReportsReset&&r.onReportsReset()}},e.prototype.addReport=function(e){this.collection.addItem(e)},e.prototype.removeReport=function(e){this.collection.deleteItems((function(t){return t.id===e}))},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o=e.common.contracts.Permissions,r=e.common.models.ReportPermissions,i=(function(){function t(e){this.userInfo=e}return t.prototype.mapReportOwnerFullnames=function(e,t,o,r){this.mapResourceOwnerFullnames(e,t,o,r,"reportIds")},t.prototype.mapWorkbookOwnerFullnames=function(e,t,o,r){this.mapResourceOwnerFullnames(e,t,o,r,"workbookIds")},t.prototype.mapResourceOwnerFullnames=function(e,t,o,r,i){for(var a=0,n=e;a<n.length;a++){var s=n[a];s.ownerFullname||(s.ownerFullname=this.getOwnerFullname(s.contract.permissions,s.packageId,i,s.id,t,o,r))}},t.prototype.getOwnerFullnameFromUserInfo=function(){if(!this.userInfo)return"";var e=_.trim(this.userInfo.givenName),t=_.trim(this.userInfo.surname);return _.isEmpty(e)?"":(_.isEmpty(t)||(e+=" "+t),e)},t.prototype.hasPermission=function(e,t){return(e&t)===t},t.prototype.getOwnerFromGroupOrUser=function(t,o){return t===e.common.constants.myWorkspaceGroupId?this.getOwnerFullnameFromUserInfo():o},t.prototype.getOwnerFromUserInfo=function(e,t,i){return this.hasPermission(e,o.CopyOnWrite)||this.hasPermission(e,r.Personalized)?this.getOwnerFromGroupOrUser(t,i):""},t.prototype.getOwnerFromDashboard=function(e){return null!=e?e.ownerFullname:""},t.prototype.getOwnerFullname=function(e,t,o,r,i,a,n){for(var s,c,d,l=0,p=i;l<p.length;l++){var u=p[l],v=u.contract;if(v.originalPackageId===t){s=u;break}!c&&v.packageIds&&_.contains(v.packageIds,t)&&(c=u),!d&&v[o]&&_.contains(v[o],r)&&(d=u)}var h=s||c||d;return h?this.getOwnerFromDashboard(h):this.getOwnerFromUserInfo(e,a,n)},t})();t.ResourceOwnershipService=i})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(){return new n}var r=jsCommon.EnumExtensions,i=e.common.NotifyCollection,a=e.common.contracts.Permissions;t.createModelCollectionService=o;var n=(function(){function e(){this.listeners=[],this.collection=new i}return Object.defineProperty(e.prototype,"models",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.getModelContracts=function(){return _.map(this.models,(function(e){return e.contract}))},e.prototype.findModelContract=function(e,t){var o=this.getModelContracts();if(t)return _.find(o,(function(o){return o.id===e&&o.packageId===t}));var i=_.find(o,(function(t){return t.id===e&&r.hasFlag(t.permissions,a.Write)}));return i||_.find(o,(function(t){return t.id===e}))},e.prototype.onAdded=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onModelAdded&&i.onModelAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onModelDeleted&&i.onModelDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,o=e;t<o.length;t++){var r=o[t];r.onModelsReset&&r.onModelsReset()}},e.prototype.addModel=function(e){this.collection.addItem(e)},e.prototype.removeModel=function(e,t){var o;return o=t?function(o){return o.id===e&&o.packageId===t}:function(t){return t.id===e},!!this.removeModels(o)},e.prototype.removeModels=function(e){return this.collection.deleteItems(e)},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,a,n,c,d,l,p,u,v,h){return new s(e,t,o,r,i,a,n,c,d,l,p,u,v,h)}var r=jsCommon.EnumExtensions,i=e.common.contracts.Permissions,a=e.common.contracts.PermissionArtifactType,n=jsCommon.StringExtensions;t.createModelService=o;var s=(function(){function o(e,t,o,r,i,a,n,s,c,d,l,p,u,v){this.rootScope=e,this.telemetryService=t,this.errorService=o,this.modelMerger=r,this.modelConverter=i,this.syncService=a,this.modelHttpService=n,this.localizationService=s,this.reportService=c,this.appMetadataService=d,this.promiseFactory=l,this.dataProxy=p,this.modelCollectionService=u,this.permissionService=v,this.modelUpdateListeners=[],this.syncService.addModelRefreshListener(this),this._modelsDeferred=this.promiseFactory.defer(),this.initModels()}return Object.defineProperty(o.prototype,"models",{get:function(){return this.modelCollectionService.models},set:function(e){this.modelCollectionService.models=e},enumerable:!0,configurable:!0}),o.prototype.applyModelUpdated=function(e,t){for(var o=0;o<this.modelUpdateListeners.length;++o)this.modelUpdateListeners[o].onModelUpdated(e,t)},o.prototype.onModelAdded=function(e,t){var o=this.findModels(e,t);0===o.length&&this.addOrUpdateModel(e,t);for(var r=0,i=o.length;r<i;r++){var a=o[r];n.isNullOrUndefinedOrWhiteSpaceString(a.displayName)&&this.addOrUpdateModel(a.id,a.packageId,a)}},o.prototype.addOrUpdateModel=function(o,r,i){var a=this,n=this.telemetryService.startEvent(e.telemetry.DashboardInitializeNavigationPaneModels);this.modelHttpService.getModel(o,r,this.telemetryService.root).then((function(e){var r=e.data,s=a.modelConverter.convertModel(r);a.isContractExplorableNonLegacySampleModel(s.contract)&&(i=a.findModel(o,r.packageId),i?(a.modelMerger.mergeModel(i,r),a.applyModelUpdated(i.id,i.packageId)):(s.isNew=!0,a.pushModel(s),a.rootScope.$emit(t.constants.onDatasetAddedEventName,r))),n.resolve(),a.updateTimestamp()}),(function(){n.reject()}))},o.prototype.pushModel=function(e){this.modelCollectionService.addModel(e)},o.prototype.removeModel=function(e,t){if(_.isEmpty(this.models))return!1;var o=this.modelCollectionService.removeModel(e,t);return o&&this.updateTimestamp(),o},o.prototype.onModelDeleted=function(e,t){this.models&&this.removeModel(e,t)},o.prototype.onModelUpdated=function(t,o){var r=this;if(this.models)for(var i=this.findModels(t,o),a=0,n=i.length;a<n;a++){var s=this.telemetryService,c=s.startEvent(e.telemetry.DashboardInitializeNavigationPaneModels),d=i[a];this.modelHttpService.getModel(t,d.packageId,this.telemetryService.root).then((function(e){r.modelMerger.mergeModel(d,e.data),r.applyModelUpdated(d.id,d.packageId),c.resolve(),r.updateTimestamp();var t=e.data;r.dataProxy.clearCache("dsr",[{dbName:t.dbName,modelId:t.id,vsName:t.vsName,schemaName:void 0}])}),(function(){c.reject()}))}},o.prototype.addModelUpdateListener=function(e){this.modelUpdateListeners.push(e)},o.prototype.removeModelUpdateListener=function(e){_.pull(this.modelUpdateListeners,e)},Object.defineProperty(o.prototype,"modelsPromise",{get:function(){return this._modelsDeferred.promise},enumerable:!0,configurable:!0}),o.prototype.updateDatasetCollection=function(e){var t=[];if(!_.isEmpty(e))for(var o=0,r=e.length;o<r;++o)t.push(this.modelConverter.convertModel(e[o]));this.modelCollectionService.models=t,this.updateTimestamp()},o.prototype.mergeDatasetCollection=function(e){if(!_.isEmpty(e))for(var t=_.indexBy(this.models,"id"),o=0,r=e;o<r.length;o++){var i=r[o];t[i.id]?this.updateContractModel(i):this.pushModel(this.modelConverter.convertModel(i))}},o.prototype.getModelContracts=function(){return this.modelCollectionService.getModelContracts()},o.prototype.deleteModelForPackage=function(e){for(var t=this.getModelsByPackageId(this.models,e),o=0,r=t.length;o<r;++o)this.onModelDeleted(t[o].id,e)},o.prototype.updateContractModel=function(e){if(e){var t=this.findModel(e.id,e.packageId);t&&(this.modelMerger.mergeModel(t,e),this.applyModelUpdated(t.id,t.packageId))}},o.prototype.addContractModel=function(e){if(e){var t=this.modelConverter.convertModel(e),o=this.getModelIndex(t.id,t.packageId);o<0&&(t.isNew=!0,this.addModel(t))}},o.prototype.addModel=function(e){if(e){var t=this.getModelIndex(e.id,e.packageId);t<0&&(this.modelCollectionService.addModel(e),this.updateTimestamp())}},o.prototype.deleteModel=function(e,t){this.deleteModelInternal(e,t)},o.prototype.getModelIndex=function(e,t){if(this.models.length>0)for(var o=0,r=this.models.length;o<r;o++){var i=this.models[o];if(i.id===e&&i.packageId===t)return o}return-1},o.prototype.getModelIndices=function(e){var t=[];if(this.models.length>0)for(var o=0,r=this.models.length;o<r;o++){var i=this.models[o];i.id===e&&t.push(o)}return t},o.prototype.getModelRefreshSchedule=function(e,t){return this.findModel(e,t).contract.refreshSchedule},o.prototype.findModel=function(e,t,o){var a=this.findModels(e);if(!_.isEmpty(a)){if(1===a.length)return a[0];var n;return null!=t&&(n=this.getModelByPackageId(a,t),n||!o)?n:(n=_.find(a,(function(e){return r.hasFlag(e.getPermissions(),i.All)})),n||a[0])}},o.prototype.findModels=function(e,t){return t?_.filter(this.models,(function(o){return o.id===e&&o.packageId===t})):_.filter(this.models,(function(t){return t.id===e}))},o.prototype.findModelByDBName=function(e,t){var o;return o=t?_.find(this.models,(function(o){return o.dbName===e&&o.packageId===t})):_.find(this.models,(function(t){return t.dbName===e&&r.hasFlag(t.getPermissions(),i.Write)})),o||t||(o=_.find(this.models,(function(t){return t.dbName===e}))),o},o.prototype.findModelsByDBName=function(e){return _.filter(this.models,(function(t){return t.dbName===e}))},o.prototype.findModelByPackageId=function(e){return this.getModelByPackageId(this.models,e)},o.prototype.findModelsByPackageId=function(e){return this.getModelsByPackageId(this.models,e)},Object.defineProperty(o.prototype,"editableModels",{get:function(){var e=this;return _.filter(this.models,(function(o){var r=o.contract;if(o.contract.isHidden)return!1;var i=e.permissionService.getModelEffectivePermissions(r);return t.PermissionsUtils.canReshare(i,a.Dataset)}))},enumerable:!0,configurable:!0}),o.prototype.isContractExplorableNonLegacySampleModel=function(e){var o=e.permissions;return e.contentProviderId!==t.constants.samplesContentProviderId&&(r.hasFlag(o,i.Write)||r.hasFlag(o,i.CopyOnWrite)||r.hasFlag(o,i.Explore))},o.prototype.isExplorableNonLegacySampleModel=function(e){var o=e.getPermissions();return e.contentProviderId!==t.constants.samplesContentProviderId&&(r.hasFlag(o,i.Write)||r.hasFlag(o,i.CopyOnWrite)||r.hasFlag(o,i.Explore))},Object.defineProperty(o.prototype,"copyAndEditModels",{get:function(){var e=this;return _.filter(this.models,(function(t){return e.isExplorableNonLegacySampleModel(t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"sanitizedCopyAndEditModels",{get:function(){var e=this;return _.filter(this.models,(function(t){return e.isExplorableNonLegacySampleModel(t)&&!n.isNullOrUndefinedOrWhiteSpaceString(t.displayName)&&!t.realTimeMode}))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"streamingModels",{get:function(){var e=this;return _.filter(this.models,(function(t){return e.isExplorableNonLegacySampleModel(t)&&!!t.realTimeMode}))},enumerable:!0,configurable:!0}),o.prototype.renameModel=function(o,r,i){var a=this;if(this.isModelNameValid(o)){var n=this.findModel(r,i);if(!n)return;var s=n.contract.displayName;if(s!==o){var c=this.telemetryService.startEvent(e.telemetry.DashboardRenameDataset);n.displayName=o,this.modelHttpService.renameModel(n,o,c.event).then((function(){c.resolve();var e=a.findModel(n.id,n.packageId);e&&e.isUsedByContentPack&&a.rootScope.$emit(t.constants.contentPackDirtyShowNotification,e.id,t.models.ContentPackItems.Model)}),(function(t){t.status===e.HttpStatusCode.Unauthorized?a.errorService.error(a.localizationService.get("Model_NoPermissionToRenameMessage"),"Model_NoPermissionToRename",{requestId:t.requestId,statusCode:t.status.toString()}):a.errorService.error(a.localizationService.get("Model_FailToRenameModelMessage"),"Model_FailToRenameModel",{requestId:t.requestId,statusCode:t.status.toString()}),n.displayName=s,c.reject()}))}}},o.prototype.updateModelQnaFeatures=function(t,o){var r=this.promiseFactory.defer(),i=this.telemetryService.startEvent(e.telemetry.DashboardUpdateModelQnaFeatures,o.cortanaEnabled,o.powerBIQnaEnabled);return this.modelHttpService.updateModelQnaFeatures(t,o,i.event).then((function(){i.resolve(),r.resolve({})}),(function(){i.reject(),r.reject()})),r.promise},o.prototype.updateFeaturedQuestions=function(t,o){var r=this.promiseFactory.defer(),i=this.telemetryService.startEvent(e.telemetry.DashboardUpdateFeaturedQuestions,o.length);return this.modelHttpService.updateFeaturedQuestions(t,o,i.event).then((function(){i.resolve(),r.resolve({})}),(function(){i.reject(),r.reject()})),r.promise},o.prototype.isModelNameValid=function(e){return!n.isNullOrUndefinedOrWhiteSpaceString(e)},o.prototype.removeModels=function(e){this.modelCollectionService.removeModels((function(t){return _.contains(e,t.id)}))&&this.updateTimestamp()},Object.defineProperty(o.prototype,"lastUpdatedTimestamp",{get:function(){return this._lastUpdatedTimestamp},enumerable:!0,configurable:!0}),o.prototype.updateTimestamp=function(){this._lastUpdatedTimestamp=(new Date).getTime()},o.prototype.initModels=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(t){e.loadModels(t)}),(function(){e.loadModels()}))},o.prototype.deleteModelInternal=function(o,r){for(var i=this,a=this.findModels(o,r),n=0,s=a.length;n<s;n++){var c,d=this.telemetryService.startEvent(e.telemetry.DashboardDeleteDataset),l=a[n],p=this.getModelIndex(o,l.packageId);p>=0?(this.removeModel(o,l.packageId),c=this.reportService.deleteReportsForModel(o,l.packageId),this.rootScope.$emit(t.constants.deleteModelStartedEventName,o),this.modelHttpService.deleteModel(l.contract,d.event).then((function(){d.resolve(),i.updateTimestamp()}),(function(r){r.status===e.HttpStatusCode.Unauthorized?i.errorService.error(i.localizationService.get("Model_NoPermissionToDeleteMessage"),"Model_NoPermissionToDelete",{requestId:r.requestId,statusCode:r.status.toString()}):r.status===e.HttpStatusCode.BadRequest&&r.headers(e.common.PowerBIErrorHeader)===t.constants.CannotDeleteModelPublishedToOrganizationalAppHeader?i.errorService.error(i.localizationService.get("Model_DeleteWaitMessage"),"Model_DeleteWaitMessage",{requestId:r.requestId,statusCode:r.status.toString()}):i.errorService.error(i.localizationService.get("Model_FailToDeleteModelMessage"),"Model_FailToDeleteModel",{requestId:r.requestId,statusCode:r.status.toString()}),i.pushModel(l);for(var a=0,n=c.length;a<n;++a)i.reportService.addReport(c[a]);i.rootScope.$emit(t.constants.deleteModelFailedEventName,o),
d.reject()}))):d.resolve()}},o.prototype.loadModels=function(t){var o=this;if(t)t.models&&(this.updateDatasetCollection(t.models),this._modelsDeferred.resolve(this.models));else{var r=this.telemetryService.startEvent(e.telemetry.DashboardInitializeNavigationPaneModels);this.modelHttpService.getModels(r.event).then((function(e){o.updateDatasetCollection(e.data),o._modelsDeferred.resolve(o.models),r.resolve()}),(function(){o._modelsDeferred.reject(),r.reject()}))}},o.prototype.getModelByPackageId=function(e,t){return _.find(e,(function(e){return e.packageId===t}))},o.prototype.getModelsByPackageId=function(e,t){return _.filter(e,(function(e){return e.packageId===t}))},o.prototype.subscribe=function(e){this.modelCollectionService.subscribe(e)},o.prototype.unsubscribe=function(e){this.modelCollectionService.unsubscribe(e)},o})();t.ModelService=s;var c=(function(){function e(){}return e.prototype.getModelContracts=function(){return[]},e.prototype.updateContractModel=function(e){},e.prototype.addContractModel=function(e){},e.prototype.addModel=function(e){},e.prototype.deleteModel=function(e,t){},e.prototype.deleteModelForPackage=function(e){},e.prototype.getModelIndex=function(e,t){return 0},e.prototype.getModelIndices=function(e){return[]},e.prototype.getModelRefreshSchedule=function(e,t){},e.prototype.findModel=function(e,t){},e.prototype.findModels=function(e,t){return[]},e.prototype.findModelByDBName=function(e,t){},e.prototype.findModelsByDBName=function(e){return[]},e.prototype.findModelByPackageId=function(e){},e.prototype.findModelsByPackageId=function(e){return[]},e.prototype.renameModel=function(e,t,o){},e.prototype.isExplorableNonLegacySampleModel=function(e){return!0},e.prototype.isModelNameValid=function(e){},e.prototype.removeModels=function(e){},e.prototype.updateDatasetCollection=function(e){},e.prototype.mergeDatasetCollection=function(e){},e.prototype.onModelAdded=function(e,t){},e.prototype.onModelDeleted=function(e,t){},e.prototype.onModelUpdated=function(e,t){},e.prototype.updateModelQnaFeatures=function(e,t){},e.prototype.updateFeaturedQuestions=function(e,t){},e.prototype.addModelUpdateListener=function(e){},e.prototype.removeModelUpdateListener=function(e){},e.prototype.subscribe=function(e){},e.prototype.unsubscribe=function(e){},e})();t.MockModelService=c})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(e,t,o,r,i,a,n,s,d,l,p,u,v,h,m,f,g){return new c(e,t,o,r,i,a,n,s,d,l,p,u,v,h,m,f,g)}var r,i=e.common.constants,a=e.common.contracts.Permissions,n=e.common.contracts.PermissionArtifactType;!(function(e){e[e.NamedRange=0]="NamedRange",e[e.Parameter=1]="Parameter",e[e.Table=2]="Table",e[e.PivotTable=3]="PivotTable",e[e.Chart=4]="Chart",e[e.WebExtension=5]="WebExtension"})(r=t.EwaNamedItemType||(t.EwaNamedItemType={})),t.createWorkbookService=o;var s=".xlsx,.xlsm",c=(function(){function o(e,t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f){this.workbookCollectionService=m,this.telemetryService=t,this.rootScope=e,this.errorService=o,this.modelMerger=r,this.modelConverter=i,this.syncService=a,this.workbookHttpService=n,this.localizationService=s,this.featureSwitchService=c,this.appMetadataService=d,this.windowService=l,this.promiseFactory=p,this.tutorialDataStore=u,this.compile=v,this.localFileService=h,this.permissionService=f,this.spoAuthenticationTelemetryCollected=!1,this.wopiDataTTL=new Array,this.deferredWopiData=Array(),this.workbooksDeferred=p.defer(),this.syncService.addWorkbookRefreshListener(this),this.replaceWorkbookScope=this.rootScope.$new(),this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1,this.initWorkbooks()}return Object.defineProperty(o.prototype,"workbooks",{get:function(){return this.workbookCollectionService.workbooks},set:function(e){this.workbookCollectionService.workbooks=e},enumerable:!0,configurable:!0}),o.prototype.addContractWorkbook=function(e){if(e&&null!=e.id){var t=this.modelConverter.convertWorkbook(e),o=this.getWorkbookIndex(t.id,t.packageId);o<0&&this.addWorkbook(t)}},o.prototype.addWorkbook=function(e){if(e&&null!=e.id){var t=this.getWorkbookIndex(e.id,e.packageId);t<0&&(this.workbookCollectionService.addWorkbook(e),this.updateTimestamp())}},o.prototype.deleteWorkbookForPackage=function(e){for(var t=_.filter(this.workbooks,(function(t){return t.packageId===e})),o=0,r=t.length;o<r;++o)this.onWorkbookDeleted(t[o].id,e)},o.prototype.postUploadWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToUploadWorkbook_Title","UploadExcel_FailedToUploadWorkbook_Message")},o.prototype.postReplaceWorkbookErrorMessage=function(e){this.postErrorForWorkbook(e,"UploadExcel_FailedToReplaceWorkbook_Title","UploadExcel_FailedToReplaceWorkbook_Message")},o.prototype.postErrorForWorkbook=function(t,o,r){var a=t.headers(e.common.PowerBIErrorHeader),n=r;if(a){var s=e.common.KnownContentProviderErrors[i.excelContentProviderId],c=s&&s[a];c&&c.messageId&&(n=c.messageId)}this.errorService.error(e.common.localize.get(n),n,{requestId:t.requestId,statusCode:t.status.toString(),title:e.common.localize.get(o)})},o.prototype.replaceLocalWorkbook=function(e){var t=this,o=this.findWorkbookByUniqueId(e);this.replaceWorkbookScope.workbookToUpdate=o;var r,i=this.promiseFactory.defer();r=function(){t.localFileService.chooseLocalFile(i,s)},i.promise.then((function(e){t.getUserConsentToReplace(r,e)})),r=function(){t.replaceWorkbook()},this.localFileService.chooseLocalFile(i,s)},o.prototype.showReplaceWorkbookTutorialIfNeeded=function(e){var t=this;return this.neverShowUpdateExplanation=this.tutorialDataStore.hasKey(o.UpdateLocalWorkbookExplanation),this.neverShowUpdateExplanation?void e():void this.showInputDialog("ReplaceLocalWorkbook_Title","ReplaceLocalWorkbook_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e,"ToastNotification_DontShowThisAgain",(function(){t.neverShowUpdateExplanation=!t.neverShowUpdateExplanation}))},o.prototype.getUserConsentToReplace=function(e,t){if(t){this.replaceWorkbookScope.localWorkbookToUpload=t;var o=t.name;this.replaceWorkbookScope.workbookToUpdate&&this.replaceWorkbookScope.workbookToUpdate.displayNameWithExtension.toLowerCase()!==o.toLowerCase()?this.showInputDialog("ReplaceLocalWorkbook_DifferentName_Title","ReplaceLocalWorkbook_DifferentName_Message","ReplaceLocalWorkbook_ReplaceFile","UploadReplace_CancelButton",e):this.showReplaceWorkbookTutorialIfNeeded(e)}},o.prototype.showInputDialog=function(e,t,o,r,i,a,n){var s,c=this,d=this.errorService.control(),l=[new InJs.ModalDialogAction(this.localizationService.get(o),function(e,t){d.hideDialog(),c.dismissExplanationPermanentlyIfNeeded(),i()}),new InJs.ModalDialogAction(this.localizationService.get(r),function(e,t){d.hideDialog()})];a&&(s=new InJs.ModalDialogAction(this.localizationService.get(a),function(e,t){n()}));var p=this.localizationService.get(e),u=this.localizationService.get(t);d.showCustomDialog(p,angular.element("<div/>").text(u),l,(function(e){e.parent().find('input[value="'+c.localizationService.get(o)+'"]').focus()}),!1,null,null,null,null,null,null,null,null,null,s)},o.prototype.dismissExplanationPermanentlyIfNeeded=function(){if(this.neverShowUpdateExplanation){var t=this.telemetryService.startEvent(e.telemetry.DashboardUpdateLocalWorkbookNeverShowExplanation);this.tutorialDataStore.setKey(o.UpdateLocalWorkbookExplanation,!0,t)}},o.prototype.replaceWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!0,this.updateLocalWorkbookElement||(this.updateLocalWorkbookTemplate=angular.element(o.HtmlTemplateUpdate),this.updateLocalWorkbookElement=this.compile(this.updateLocalWorkbookTemplate)(this.replaceWorkbookScope),$("body").append(this.updateLocalWorkbookElement)),this.replaceWorkbookScope.$applyAsync()},o.prototype.finishReplacingLocalWorkbook=function(){this.replaceWorkbookScope.shouldReplaceLocalWorkbook=!1},o.prototype.onWorkbookAdded=function(e,o){var r=this,i=this.findWorkbook(e,o);i||this.workbookHttpService.getWorkbook(e,o,this.telemetryService.root).then((function(a){if(i=r.findWorkbook(e,o),!i){var n=a.data;i=r.modelConverter.convertWorkbook(n),i.isNew=!0,r.workbookCollectionService.addWorkbook(i),r.updateTimestamp(),r.rootScope.$emit(t.constants.workbook.workbookAddedEventName,i.uniqueId)}}),(function(){}))},o.prototype.onWorkbookDeleted=function(e,t){0!==this.workbooks.length&&this.workbookCollectionService.removeWorkbook(e,t)&&this.updateTimestamp()},o.prototype.onWorkbookUpdated=function(e){var t=this;if(0!==this.workbooks.length){var o=this.findWorkbooks(e);if(o)for(var r=0,i=o.length;r<i;r++)this.workbookHttpService.getWorkbook(e,o[r].packageId,this.telemetryService.root).then((function(e){var o=e.data,r=t.findWorkbook(o.id,o.packageId);t.modelMerger.mergeWorkbook(r,o)}),(function(){}))}},o.prototype.updateWorkbookCollection=function(e){this.updateWorkbooks(e),this.updateTimestamp()},o.prototype.mergeWorkbookCollection=function(t){if(!_.isEmpty(t))for(var o=_.indexBy(this.workbooks,"uniqueId"),r=0,i=t;r<i.length;r++){var a=i[r];o[e.common.models.ReportResource.getUniqueId(e.common.models.ResourceType.Workbook,a.id,a.packageId)]||this.workbookCollectionService.addWorkbook(this.modelConverter.convertWorkbook(a))}this.updateTimestamp()},o.prototype.updateWorkbook=function(e){var t=this.findWorkbook(e.id,e.packageId);return t&&this.modelMerger.mergeWorkbook(t,e),t},o.prototype.getWorkbookContracts=function(){return this.workbookCollectionService.getWorkbookContracts()},Object.defineProperty(o.prototype,"copyAndEditWorkbooks",{get:function(){var e=this.permissionService;return _.filter(this.workbooks,(function(t){var o=e.getWorkbookEffectivePermissions(t.contract);return(o&a.Write)===a.Write||(o&a.CopyOnWrite)===a.CopyOnWrite}))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"editAndReShareWorkbooks",{get:function(){var e=this.permissionService;return _.filter(this.workbooks,(function(t){var o=e.getWorkbookEffectivePermissions(t.contract);return(o&a.Write)===a.Write&&(o&a.ReShare)===a.ReShare}))},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"lastUpdatedTimestamp",{get:function(){return this._lastUpdatedTimestamp},enumerable:!0,configurable:!0}),o.prototype.ensureWorkbookInitialization=function(){return this.workbooksDeferred.promise},o.prototype.findWorkbooks=function(e){return _.filter(this.workbooks,(function(t){return t.id===e}))},o.prototype.updateTimestamp=function(){this._lastUpdatedTimestamp=(new Date).getTime()},o.prototype.getWorkbookIndex=function(e,t){for(var o=0,r=this.workbooks.length;o<r;o++){var i=this.workbooks[o];if(i.id===e&&i.packageId===t)return o}return-1},o.prototype.findWorkbook=function(e,t){return t?_.find(this.workbooks,(function(o){return o.id===e&&o.packageId===t})):_.find(this.workbooks,(function(t){return t.id===e&&t.isOwner()}))},o.prototype.findWorkbooksByPackageId=function(e){if(null!=e)return _.filter(this.workbooks,(function(t){return t.packageId===e}))},o.prototype.findWorkbookByEtagHash=function(e){return _.find(this.workbooks,(function(t){return t.contract.etagHash===e}))},o.prototype.findWorkbookByUniqueId=function(e){return _.find(this.workbooks,(function(t){return t.uniqueId===e}))},o.prototype.getWorkbookUniqueId=function(e){return e.uniqueId},o.prototype.initWorkbooks=function(){var e=this;this.appMetadataService.getAppMetadata().then((function(t){e.loadWorkbooks(t)}),(function(){e.loadWorkbooks()}))},o.prototype.loadWorkbooks=function(t){var o=this;if(t)t.workbooks&&(t.workbooks.forEach((function(e){var t=o.modelConverter.convertWorkbook(e);o.workbookCollectionService.addWorkbook(t)})),this.workbooksDeferred.resolve(this),this.updateTimestamp());else{var r=this.telemetryService.startEvent(e.telemetry.DashboardInitializeNavigationPaneWorkbooks);this.workbookHttpService.getWorkbooks(r.event).then((function(e){o.updateWorkbooks(e.data),r.resolve(),o.workbooksDeferred.resolve(o),o.updateTimestamp()}),(function(){r.reject(),o.workbooksDeferred.reject()}))}},o.prototype.updateWorkbooks=function(e){var t=this,o=[];_.isEmpty(e)||(o=_.map(e,(function(e){return t.modelConverter.convertWorkbook(e)}))),this.workbookCollectionService.workbooks=o},Object.defineProperty(o.prototype,"originalWorkbooks",{get:function(){var e=this.permissionService;return _.filter(this.workbooks,(function(o){var r=e.getWorkbookEffectivePermissions(o.contract);return t.PermissionsUtils.canReshare(r,n.Workbook)}))},enumerable:!0,configurable:!0}),o.prototype.renameWorkbook=function(t,o,r){var i=this;if(this.isWorkbookNameValid(t)){var a=this.findWorkbook(o,r);if(a){var n=a.contract.displayName;if(n!==t){var s=this.telemetryService.startEvent(e.telemetry.DashboardRenameWorkbook);a.displayName=t,this.workbookHttpService.renameWorkbook(a,t,s.event).then((function(){s.resolve()}),(function(t){t.status===e.HttpStatusCode.Unauthorized?i.errorService.error(i.localizationService.get("Workbook_NoPermissionToRenameMessage"),"Workbook_NoPermissionToRename",{requestId:t.requestId,statusCode:t.status.toString()}):i.errorService.error(i.localizationService.get("Workbook_FailToRenameWorkbookMessage"),"Workbook_FailToRenameWorkbook",{requestId:t.requestId,statusCode:t.status.toString()}),a.displayName=n,s.reject()}))}}}},o.prototype.isWorkbookNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},o.prototype.removeWorkbook=function(t,o,r,i){var a=this,n=this.telemetryService.startEvent(e.telemetry.DashboardRemoveWorkbook,r,i),s=this.workbookCollectionService.removeWorkbook(t,o);return s?void this.workbookHttpService.deleteWorkbook(s.contract,n.event).then((function(){n.resolve(),a.updateTimestamp()}),(function(t){t.status===e.HttpStatusCode.Unauthorized?a.errorService.error(a.localizationService.get("Workbook_NoPermissionToRemoveMessage"),"Workbook_NoPermissionToRemove",{requestId:t.requestId,statusCode:t.status.toString()}):a.errorService.error(a.localizationService.get("Workbook_FailToRemoveWorkbookMessage"),"Workbook_FailToRemoveWorkbook",{requestId:t.requestId,statusCode:t.status.toString()}),a.workbookCollectionService.addWorkbook(s),n.reject()})):void n.resolve()},o.prototype.haveWorkbookEmbedAccessData=function(e){var t=this.deferredWopiData[e],o=this.wopiDataTTL[e];return!(!t||o&&!(o>(new Date).getTime()))},o.prototype.getWorkbookEmbedAccessData=function(t,o,r){var i=this;if(r)var a=this.telemetryService.startChildEvent(r,e.telemetry.DashboardGetWorkbookWopiAccessInformation);else var a=this.telemetryService.startEvent(e.telemetry.DashboardGetWorkbookWopiAccessInformation);if(this.haveWorkbookEmbedAccessData(t))return a.resolve(),this.deferredWopiData[t].promise;var n=this.promiseFactory.defer();this.deferredWopiData[t]=n,this.wopiDataTTL[t]=null;var s=!1;return this.workbookHttpService.getWorkbookWopiData(t,a.event).then((function(e){if(!e.data||!e.data.accessToken||!e.data.url)return void(s=!0);var o=e.data;i.wopiDataTTL[t]=o.accessTokenTtl,i.deferredWopiData[t].resolve(o),a.resolve()}),(function(e){s=!0})).finally((function(){s&&(i.deferredWopiData[t].reject(),i.deferredWopiData[t]=null,a.reject())})),n.promise},o.prototype.createExcelWebAppEmbedUrlParams=function(e,t){var o=[{key:"dsdiv",value:e},{key:"dswp",value:"1"},{key:"dsts",value:"None"},{key:"dsat",value:"1"},{key:"dspti",value:"1"},{key:"dsfl",value:"1"},{key:"dsacs",value:this.featureSwitchService.featureSwitches.ffxlChartSelectionEnabled?"1":"0"},{key:"dsrc",value:"pplr"}];t&&o.push({key:"dssc",value:t});var r=o.map((function(e){return"&"+e.key+"="+e.value})).join("");return r},o.prototype.embedWorkbook=function(t,o,r,i,a,n,s,c,d,l){var p=this;if(null!==o&&null!==r){var u=this.promiseFactory.defer(),v=this.promiseFactory.defer(),h=d?"&wdPublishedInPbiHint=true":"";return v.promise.then((function(){var d=p.createExcelWebAppEmbedUrlParams(o.targetDiv,l),v=r+"&access_token="+i+"&access_token_ttl="+a+d+h,m=p.promiseFactory.defer();m.promise.then((function(r){r.getSucceeded()?(p.telemetryService.logEvent(e.telemetry.DashboardWorkbookEmbeddingExternalSuccess,t,r.getCorrelationId(),n,c,s),u.resolve({ewaControl:r.getReturnValue(),window:o})):(p.telemetryService.logEvent(e.telemetry.DashboardWorkbookEmbeddingExternalFailure,t,r.getCode(),r.getDescription(),r.getCorrelationId(),n,c,s),u.reject())}),(function(){p.telemetryService.logEvent(e.telemetry.DashboardWorkbookEmbeddingExternalFailure,t,-1,null,null,n,c,s),u.reject()})),o.loadEwaScripts(v,m)})),o.loadEvent=v,o.loaded&&v.resolve(null),u.promise}},o.prototype.getDefaultTileTitle=function(e,t){var o=t,r=e.sheetName;if(r)o+=", "+r.replace(/\''/g,"'");else{var i=e.item.split("!");i.length>1&&(o+=", "+i[0].substr(1,i[0].length-2))}return o},o.prototype.getDefaultTileSubtitle=function(e){var t=e.split("!");return t.length>1?t[1]:e},o.prototype.getTileSelectionQuery=function(e,t,o,i){var a="";return o===r.Chart&&i&&(a="Sheets('"+i+"')/"),a+=this.getNamedItemTypeAsString(o)+"('",e?a+=e:t&&(a+=t),encodeURIComponent(a+"')")},o.prototype.encodeImageTileQueryString=function(e){var t=encodeURI(e);return t=t.replace(/\'/g,"%27"),t=t.replace(/\(/g,"%28"),t=t.replace(/\)/g,"%29")},o.prototype.getNamedItemTypeAsString=function(e){switch(e){case r.NamedRange:return"Ranges";case r.Parameter:return"Parameters";case r.Table:return"Tables";case r.PivotTable:return"PivotTables";case r.Chart:return"Charts"}return"Ranges"},o.prototype.getWorkbookTilePreviewImageUrl=function(e){var t=this,o=this.promiseFactory.defer();return this.getWorkbookEmbedAccessData(e.workbookId,e.packageId).then((function(r){if(e.$config.workbookTile){var i=r.url.replace(/ExcelJs.ashx/i,"/XlRestInternal.aspx"),a=t.encodeImageTileQueryString(t.getTileSelectionQuery(e.$config.workbookTile.item,e.$config.workbookTile.activeSelection,e.$config.workbookTile.itemType,e.$config.workbookTile.sheetName));i+="&framemode=proxy&wdRestQuery=$format=image&wdRestPart=Model/"+a+"&access_token="+r.accessToken+"&access_token_ttl="+r.accessTokenTtl,o.resolve(i)}else o.reject()}),(function(){o.reject()})),o.promise},o.prototype.getWorkbookTileBestImageUrl=function(t){if(t.hasImages()){var o=t.images,r=-1,i=-1,a=t.tileModel.layoutPosition,n=e.common.GridLayoutConstants.getDefaultGridItemViewport({colSpan:a.width,rowSpan:a.height}),s=Number.MAX_VALUE,c=Number.MIN_VALUE,d=window.devicePixelRatio;if(n.width=n.width*d,n.height=n.height*d,t.keepOriginalContentSize)return jsCommon.Utility.getAbsoluteUri(o[0].imageUrl);for(var l=0;l<o.length;l++){o[l].width>c&&(c=o[l].width,i=l);var p=o[l].width-n.width,u=o[l].height-n.height,v=Math.max(p,u);v>=0&&v<s&&(s=v,r=l)}return r===-1&&(r=i),jsCommon.Utility.getAbsoluteUri(o[r].imageUrl)}return t.image?"data:image/png;base64,"+t.image:""},o.prototype.setModelDynamicImageUrl=function(e){e.dynamicImageUrl=this.getWorkbookTileBestImageUrl(e),e.dynamicImageUrl||(e.dynamicImageUrl=e.previewImageUrl)},o.prototype.getWorkbooks=function(){return this.workbooksDeferred.promise.then((function(e){return e.workbooks}))},o.prototype.subscribe=function(e){this.workbookCollectionService.subscribe(e)},o.prototype.unsubscribe=function(e){this.workbookCollectionService.unsubscribe(e)},o})();c.HtmlTemplateUpdate="<content-provider-local-file selected-file='localWorkbookToUpload' is-update-from-element-flow='true' ng-if='shouldReplaceLocalWorkbook' element-to-update='workbookToUpdate'></content-provider-local-file>",c.UpdateLocalWorkbookExplanation="updateLocalWorkbookExplanation",t.WorkbookService=c})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function o(){return new i}var r=e.common.NotifyCollection;t.createWorkbookCollectionService=o;var i=(function(){function e(){this.listeners=[],this.collection=new r}return Object.defineProperty(e.prototype,"workbooks",{get:function(){return this.collection.items},set:function(e){this.collection.setItems(e)},enumerable:!0,configurable:!0}),e.prototype.getWorkbookContracts=function(){return _.map(this.workbooks,(function(e){return e.contract}))},e.prototype.addWorkbook=function(e){this.collection.addItem(e)},e.prototype.removeWorkbook=function(e,t){var o=this.collection.deleteItems((function(o){return o.id===e&&o.packageId===t}));return _.first(o)},e.prototype.onAdded=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onWorkbookAdded&&i.onWorkbookAdded(e)}},e.prototype.onDeleted=function(e){for(var t=this.listeners,o=0,r=t;o<r.length;o++){var i=r[o];i.onWorkbookDeleted&&i.onWorkbookDeleted(e)}},e.prototype.onReset=function(){for(var e=this.listeners,t=0,o=e;t<o.length;t++){var r=o[t];r.onWorkbooksReset&&r.onWorkbooksReset()}},e.prototype.subscribe=function(e){this.listeners.length<1&&this.collection.subscribe(this),this.listeners.push(e)},e.prototype.unsubscribe=function(e){_.pull(this.listeners,e),this.listeners.length<1&&this.collection.unsubscribe(this)},e})()})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){function r(e,t){return new n(e,t)}var i=t.constants.upgrader,a=e.explore.contracts.Version;o.createTileConfigUpgraderService=r;var n=(function(){function r(e,t){this.telemetryService=t,this.upgraders=[o.v0_1.createVersionUpgrader(),o.v1_0.createVersionUpgrader(e,t)]}return r.prototype.upgrade=function(o,r,n){if(r){var s=t.ContractUtils.convertToSemanticQueryWithDataShapeBinding(n);r&&(r.version?"1.0"===r.version?this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.Version1_0):"1.1"===r.version&&this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.Version1_1):r.version=a.ZeroStr);for(var c=0,d=this.upgraders;c<d.length;c++){var l=d[c];a.lt(r.version,l.version)&&l.upgrade(o,r,s)}}},r})();o.TileConfigUpgraderService=n})(o=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(t){var o;!(function(t){function o(){return new r}t.createVersionUpgrader=o;var r=(function(){function t(){this.version="0.1"}return t.prototype.upgrade=function(t,o,r){if(o.version=this.version,r&&r.defn&&!r.defn.Version&&o.visual&&!_.isEmpty(o.visual.elements)&&o.visual.visual===e.visuals.plugins.scatterChart.name){var i=o.visual.elements;if(i[0].DataRoles){for(var a=i[0].DataRoles,n=!1,s=!1,c=!1,d=void 0,l=0,p=a;l<p.length;l++){var u=p[l];"Category"===u.Name&&(n=!0,d=u.Projection),s=s||"Series"===u.Name,c=c||"Size"===u.Name}c&&n&&!s&&a.push({Name:"Series",Projection:d})}}},t})()})(o=t.v0_1||(t.v0_1={}))})(o=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o;!(function(o){var r;!(function(o){function r(e,t){return new a(e,t)}var i=t.constants.upgrader;o.createVersionUpgrader=r;var a=(function(){function t(e,t){this.pluginService=e,this.telemetryService=t,this.version="1.1"}return t.prototype.upgrade=function(t,o,r){o.version=this.version;var a=o.visual||o.realTimeVisual;if(a){a.visual||this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.NoVisualType);var n={stylePresetName:a.stylePresetName,visualType:a.visual},s=this.pluginService.getPlugin(a.visual);s||this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.NoPlugin);var c=s&&s.capabilities.objects,d=e.data.services.DataViewObjectSerializer.deserializeObjects(a.objects,c);d&&(n.objects=d);var l={name:"tile"+t,config:{singleVisual:n}};if(r&&r.defn){var p=e.data.services.SemanticQuerySerializer.tryDeserializeQuery(r.defn);if(p){var u=p.select(),v={};a.elements||(this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.InvalidElements),a.elements=[]);for(var h=0,m=e.VisualElement.getDataRolesFromVisualElements(a.elements);h<m.length;h++){var f=m[h],g=u[f.Projection];if(g){var y=f.Name,b=v[y];b||(v[y]=b=new e.data.QueryProjectionCollection([])),b.all().push({queryRef:g.name}),f.isActive&&b.addActiveQueryReference(g.name)}else this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.NoSelect)}l.filters=e.explore.FilterUtils.deriveFromSQFilters(p.from(),p.where(),a.queryMetadata),n.query=new e.explore.contracts.VisualQuery(p.where([],new e.data.SQFrom),v)}else this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.InvalidSemanticQuery)}else this.telemetryService.logEvent(e.telemetry.TileConfigUpgradeTileConfig,i.NoQuery),delete a.transform;var S={$visualContainer:l,dataWindow:o.realTimeVisual&&o.realTimeVisual.dataWindow,elements:a.elements,heading1:a.heading1,heading2:a.heading2,heading3:a.heading3,layoutType:a.layoutType,queryMetadata:a.queryMetadata,themeName:a.themeName,transform:a.transform,$modelExtensions:a.$modelExtensions};S=_.omit(S,(function(e){return void 0===e})),o.realTimeVisual?o.realTimeVisual=S:o.visualContainer=S}},t})()})(r=o.v1_0||(o.v1_0={}))})(o=t.upgrader||(t.upgrader={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o,r=t.models.AppModelIconBackgroundColors,i=jsCommon.Color,a=e.common.contracts.ContentProviderCategory,n=e.common.models.Model,s=jsCommon.DateExtensions,c=jsCommon.Utility,d=t.models.Workbook;!(function(e){function t(e){var t=e.defaultContent;if(0!==e.defaultContentOption&&t)return o(e,{dashboardOriginalGUID:t.dashboardObjectId,reportOriginalGUID:t.reportObjectId,workbookID:t.workbookObjectId})}function o(e,t){if(t.dashboardOriginalGUID){var o=t.dashboardOriginalGUID;return _.find(e.dashboards,(function(e){return e.contract.originalDashboardObjectId===o}))}if(t.reportOriginalGUID){var r=t.reportOriginalGUID;return _.find(e.reports,(function(e){return e.contract.originalReportObjectId===r}))}if(t.workbookID){var i=t.workbookID;return _.find(e.workbooks,(function(e){return e.uniqueId===i}))}}function l(e){return e&&e.category===a.OrganizationalApp}function p(e,t){var o=t.getAppInstance(e);return o&&l(o.providerContract)}function u(e){return e.category===a.OrganizationalTemplateApp||e.category===a.ServiceApp||e.category===a.Services}function v(e,t){var o=t.getAppInstance(e);return o&&u(o.providerContract)}function h(e,t,o){if(e&&e.contract){var r=e.getUniquePackageId&&e.getUniquePackageId();if(r){var i=t.getAppInstance(r);return i&&i.providerContract.providerKey}}}function m(e,t,o){if(e){var r=e.packageId;if(r){var i=t.getAppInstance(r);return i&&i.providerContract.providerKey}}}function f(e,t,o){var r=e.getAppInstancesForApp(o);if(!_.isEmpty(r)){var i=r[0];return i.category===a.OrganizationalApp,i.packageId}}function g(e){var t=c.getDateFromWcfJsonString(e,!0);return t||(t=s.parseIsoDate(e)),t}function y(e){return!(e.icon||_.isEmpty(e.iconUrl)&&_.isEmpty(e.localAppLogoImageData))}function b(e,t){if(y(e)){if(e.localAppLogoImageData)return"url("+e.localAppLogoImageData+")";if(e.iconUrl){var o=e;return"url("+c.urlCombine(t.backendUri,o.iconUrl)+")"}}}function S(e){var t=_.find(r,(function(t){return t.color===e}));return t&&t.fontColor||D}function k(e){if(e){var t=.8,o=.2;return i.calculateHighlightColor(i.parseColorString(e),t,o)}}function I(e){return e instanceof n?e.dbName:e instanceof d?e.uniqueId:e.objectId}function C(e){var t=jsCommon.JsonExtensions.tryParseJSON(e.providerConfig);if(t)return t.author}var D="#FFF";e.getDefaultAppArtefact=t,e.getAppArtifact=o,e.isOrgApp=l,e.isOrgAppInstance=p,e.isParameterizedApp=u,e.isParameterizedAppInstance=v,e.getDashboardAppGUID=h,e.getResourceAppGUID=m,e.getPackageIDByOrgAppGUID=f,e.convertDate=g,e.hasAppLogoImage=y,e.getAppLogoImageUrlStyle=b,e.getAppHeaderFontColor=S,e.getAppHeaderBackgroundColor=k,e.getAppContentModelObjectId=I,e.getAppAuthor=C})(o=t.AppUtils||(t.AppUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o,r=e.common.helpers.ModelConverterHelper,i=e.common.contracts.Permissions,a=3;!(function(e){function t(e){return(e.permissions&i.Write)===i.Write}function o(e,t,o){var i=o.featureSwitches;return _.some(e,(function(e){if(t){var o=t.findModel(e.id,e.packageId);return!!o&&r.getIsQnaSupported(o.contract,i)}return r.getIsQnaSupported(e,i)}))}function n(e,t){var o=[];if(!e)return o;var r=e.contract,i=[],a=r.modelIds;_.isEmpty(a)||(i=a.slice(0));var n=r.tiles;if(_.map(n,(function(e){null!=e.modelId&&i.push(e.modelId)})),_.isEmpty(i))return o;i=_.uniq(i);for(var s=0,c=i.length;s<c;s++){var d=_.filter(t,(function(e){return e.id===i[s]}));_.isEmpty(d)||o.push(d[0])}return o}function s(e){for(var t=[],o=1e3,r=_.sortBy(e,(function(e){var t=e.getActiveLayoutPosition();return t.y*o+t.x})),i=0,a=r;i<a.length;i++){var n=a[i],s=n.getActiveLayoutPosition();c(t,s.y,s.height)}for(var l=[],p=1e3,u=_.sortBy(e,(function(e){var t=e.getActiveLayoutPosition();return t.x*p+t.y})),v=0,h=u;v<h.length;v++){var n=h[v],s=n.getActiveLayoutPosition();c(l,s.x,s.width)}for(var m=d(t,l,r,u),f=0===m?t:l,g=0===m?u:r,y=[],b=0,S=0,k=f;S<k.length;S++){for(var I=k[S],C=b+1;C<I.startPosition;C++)y.push(void 0);for(var D=I.startPosition;D<I.startPosition+I.size;D++)y.push(I.startPosition),b=D}for(var T=_.groupBy(g,(function(e){var t=0===m?e.getActiveLayoutPosition().y:e.getActiveLayoutPosition().x;return y[t-1]})),w=[],P=0,M=f;P<M.length;P++){var I=M[P];w=w.concat(T[I.startPosition])}return _.map(w,(function(e){return e.getItem()}))}function c(e,t,o){var r=e.length,i=e[r-1];!_.isEmpty(e)&&t>=i.startPosition&&t<i.startPosition+i.size?t+o>i.startPosition+i.size&&(i.size=t+o-i.startPosition):e.push({startPosition:t,size:o})}function d(e,t,o,r){var i,a=_.max(e,(function(e){return e.size})).size,n=_.max(t,(function(e){return e.size})).size,s=_.all(e,(function(t){return t.size===e[0].size})),c=_.all(t,(function(e){return e.size===t[0].size}));return i=l(e,a,s)?0:l(t,n,c)?1:a<=n?0:1}function l(e,t,o){return e.length>1&&o&&t<=a}function p(e,t,o){if(!o||!o.tiles)return!1;switch(e){case 0:return _.any(o.tiles,(function(e){return e.hasLayoutDefinition(t)}));case 1:return _.any(o.tiles,(function(e){return e.hasLayoutPosition(t)}))}}function u(e){for(var t=[],o=0,r=e.tiles;o<r.length;o++){var i=r[o];i.hasLayoutDefinition(1)?i.shouldNewBadgeAppear=!1:(i.shouldNewBadgeAppear=!0,t.push(i.addLayout({id:1,position:null},1)))}return t}e.isWriteable=t,e.containsQnaSupportedModel=o,e.getDashboardModels=n,e.orderItems=s,e.containsLayout=p,e.markTilesAsNewIfNeeded=u})(o=t.DashboardUtils||(t.DashboardUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t,o=jsCommon.ArrayExtensions;!(function(e){function t(e,t){if(e)for(var o=e.length,r=0;r<o;r++)if(e[r].id===t)return e[r].contentProviderId;return null}function r(e){var t=i(e);if(t&&t.Commands&&t.Commands.length>0){var o=t.Commands[0].SemanticQueryDataShapeCommand;return{defn:o.Query,shape:o.Binding}}return null}function i(e){if(e&&e.modelQuery&&e.modelQuery.sq){var t;try{t=JSON.parse(e.modelQuery.sq)}catch(e){}if(t){var o=null;return c(t)?o=t.dataQuery:d(t)?o=t:l(t)&&(o={Commands:[{SemanticQueryDataShapeCommand:{Query:t.defn,Binding:t.shape}}]}),o}}}function a(e){return void 0===e&&(e={}),{layouts:[{id:0,position:e}]}}function n(e){var t=s(e,0);return t}function s(e,t){var r=o.extendWithId(e.$layoutConfig.layouts),i=r.withId(t);return i?i.position:null}function c(e){return e.dataQuery&&e.dataQuery.Commands&&e.dataQuery.Commands.length>0}function d(e){return e.Commands&&e.Commands.length>0}function l(e){return e.defn}e.findContentProviderId=t,e.convertToSemanticQueryWithDataShapeBinding=r,e.convertToTileDataQuery=i,e.createMasterLayoutConfig=a,e.getMasterLayoutPosition=n,e.getLayoutPosition=s})(t=e.ContractUtils||(e.ContractUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o,r=t.contracts,i=e.visuals.plugins,a="__default__",n=1;!(function(e){function t(e,t){void 0===t&&(t=1);var i=o[t];if(!i)return n;var s=r.TileType[e.type],c=i[s];if(!c&&e.composite){var d=e.composite;d&&(s=d.visual.type)}return i[s]||i[a]}var o={},s={};s[r.TileType[r.TileType.report]]=6,s[i.card.name]=2,s[i.animatedNumber.name]=2,s[i.textbox.name]=2,s[a]=3,o[1]=s,e.getRowSpan=t})(o=t.TileDefaultSizesUtils||(t.TileDefaultSizesUtils={}));
})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o,r=jsCommon.JsonExtensions,i=t.contracts.TileType;!(function(o){function a(o,r,a,n,s,c,d,l,p){var u=o.realTime,h=l.execute({dataSources:u.datasources,schema:s,config:r,additionalFilters:null,dataWindow:a}),m=c.getPinData({name:"tile"+o.id,config:{singleVisual:r},layouts:void 0},e.common.contracts.TileLayoutType.Default,u.datasources,null,null,h,null,s);m.realTimeDataWindow=a;var f=t.models.TileFactory.createTileForPinData(d,m,n),g=f.$config;if(!g)return void p.logEvent(e.telemetry.DashboardTileError,i[i.realTime],v);g.hideTitle=o.config.hideTitle,o.config=g,o.realTime.config=g.realTimeVisual;var y=o.contract;if(y.query=f.query,y.modelId=f.modelId,o.isTemporary){var b=t.ContractUtils.getMasterLayoutPosition(y),S=t.ContractUtils.getMasterLayoutPosition(f);b.width=S.width,b.height=S.height;var k={colSpan:b.width,rowSpan:b.height};o.calculateLayout(e.common.GridLayoutConstants.getDefaultGridItemViewport(k)),o.invalidateLayout()}u.singleVisualConfig=r}function n(e){if(e){var t=e.visualContainer||e.realTimeVisual;return t&&t.$visualContainer?t.$visualContainer.config.singleVisual.visualType:void 0}}function s(e,t){return o.isScriptVisualTile(e,t)||o.reportTileContainsScriptVisuals(e,t)}function c(e,t){return e&&e.type===i.composite&&t.isScriptVisual(o.getVisualType(e.config))}function d(t,o){var r=t&&t.reportTile&&t.reportTile.exploration&&t.reportTile.exploration.sections;if(!r||t.type!==i.report)return!1;for(var a=0,n=r;a<n.length;a++)for(var s=n[a],c=0,d=s.contract.visualContainers;c<d.length;c++){var l=d[c],p=e.explore.util.VisualContainerUtils.getVisualType(l);if(p&&o&&o.isScriptVisual(p))return!0}return!1}function l(e,t){return"tile_"+e.id+"_dash_"+t}function p(e,o,r){var i,a=1,n=6,s=t.TileDefaultSizesUtils.getRowSpan(r,a),c={id:a,position:{y:e,x:o,width:n,height:s}};return i=r.addLayout(c,a),r.layoutPosition.y=e,r.layoutPosition.x=o,r.layoutPosition.height=s,r.layoutPosition.width=n,i}function u(t){var o=r.tryParseJSON(t.errorDetail);if(o&&!_.isEmpty(o.DataShapes)){var i=o.DataShapes[0]["odata.error"];if(i){var a=new e.DsrClientError(i);return a.getDetails(e.common.localize)}}}var v="Invalid tile config object";o.UpdateRealTimeTile=a,o.getVisualType=n,o.tileContainsScriptVisuals=s,o.isScriptVisualTile=c,o.reportTileContainsScriptVisuals=d,o.tileTrackerFn=l,o.createDefaultPhoneByTile=p,o.getTileErrorDetailsFromQueryResultError=u})(o=t.TileUtils||(t.TileUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var o,r=e.common.contracts.ContentProviderCategory,i=jsCommon.EnumExtensions,a=t.contracts.PackageType,n=e.common.contracts.Permissions,s=e.common.contracts.PermissionArtifactType;!(function(e){function t(e,t,r,i,a,n,s,c,d){if(t=t||[],o(e,t,r,i,a,n,s,c,d)){var l=void 0;if(!_.isEmpty(e))for(var p=0,u=e;p<u.length;p++){var v=u[p];l=s.findDashboardContract(v),l&&(l.permissions=h,t=_.union(t,l.reportIds))}var m=void 0;if(!_.isEmpty(t))for(var f=0,g=t;f<g.length;f++){var y=g[f];m=n.findReportContract(y),m&&(m.permissions=h)}}}function o(e,t,o,r,i,a,n,s,l){var p=s.findPackageContract(r);return!!c(p,l)&&d(e,t,o,p.id,i,a,n)}function c(e,t){if(!e||e.packageType!==a.AppInstance)return!1;if(e.contentProviderId||e.serviceContentProviderId)return!0;var o=null;return!!e.contentProviderRefId&&(o=t.findOrganizationalContentProvider(e.contentProviderRefId),o&&o.category===r.OrganizationalTemplateApp)}function d(e,t,o,r,i,a,n){return!(_.isEmpty(e)&&_.isEmpty(t)&&_.isEmpty(o))&&(u(o,r,i)&&p(t,r,a)&&l(e,r,n))}function l(e,t,o){if(!_.isEmpty(e)){var r=_.uniq(e),i=_.filter(o.dashboards,(function(e){return e.contract&&e.contract.originalPackageId===t&&_.contains(r,e.id)}));if(_.isEmpty(i)||i.length!==r.length)return!1}return!0}function p(e,t,o){if(!_.isEmpty(e)){var r=_.uniq(e),i=_.filter(o.reports,(function(e){return e.packageId===t&&_.contains(r,e.id)}));if(_.isEmpty(i)||i.length!==r.length)return!1}return!0}function u(e,t,o){if(!_.isEmpty(e)){var r=_.uniq(e),i=_.filter(o.models,(function(e){return e.packageId===t&&_.contains(r,e.id)}));if(_.isEmpty(i)||i.length!==r.length)return!1}return!0}function v(e,t){return t===s.Workbook?i.hasFlag(e,n.ReShare):i.hasFlag(e,n.Write|n.ReShare)}var h=n.Read|n.CopyOnWrite;e.markDashboardAndReportsAsCopyableIfPartOfTemplateInstance=t,e.areArtifactsFromTemplateInstance=o,e.isPackageTemplateInstance=c,e.canReshare=v})(o=t.PermissionsUtils||(t.PermissionsUtils={}))})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){angular.module("powerbi.dataServices",[]);var o=["powerbi.common","powerbi.visualHost"];angular.module("powerbi.dataServices",o).factory("appCollection",[function(){return e.dataServices.createAppCollectionService()}]).factory("dashboardCollection",[function(){return e.dataServices.createDashboardCollectionService()}]).factory("modelCollection",[function(){return e.dataServices.createModelCollectionService()}]).factory("packageCollection",[function(){return e.dataServices.createPackageCollectionService()}]).factory("reportCollection",[function(){return e.dataServices.createReportCollectionService()}]).factory("workbookCollection",[function(){return e.dataServices.createWorkbookCollectionService()}]).factory("permissionService",["activeGroupId","impersonationService","appCollection","packageCollection","modelCollection","reportCollection","workbookCollection","dashboardCollection","telemetryService",function(t,o,r,i,a,n,s,c,d){return e.dataServices.createPermissionService(t,o,r,i,a,n,s,c,d)}]).factory("appMetadataService",["$rootScope","promiseFactory","resourcePackagesService","resourceGateService","visualPlugin","telemetryService","editableFeatureSwitchService",function(t,o,r,i,a,n,s){return e.dataServices.createAppMetadataService(t,o,r,i,a,n,s)}]).factory("modelHttpService",["syncService",function(t){return e.dataServices.createModelHttpService(t)}]).factory("reportHttpService",["syncService",function(t){return e.dataServices.createReportHttpService(t)}]).factory("workbookHttpService",["syncService",function(t){return e.dataServices.createWorkbookHttpService(t)}]).factory("dashboardHttpService",["syncService","promiseFactory","notificationToast","explorationSerializer","featureSwitchService","visualPlugin",function(t,o,r,i,a,n){return e.dataServices.createDashboardHttpService(t,o,r,i,a,n)}]).factory("reportService",["$rootScope","telemetryService","errorService","dataServiceModelMerger","dataServiceModelConverter","syncService","reportHttpService","localizationService","appMetadataService","promiseFactory","reportCollection","permissionService",function(t,o,r,i,a,n,s,c,d,l,p,u){return e.dataServices.createReportService(t,o,r,i,a,n,s,c,d,l,p,u)}]).factory("workbookService",["$rootScope","telemetryService","errorService","dataServiceModelMerger","dataServiceModelConverter","syncService","workbookHttpService","localizationService","featureSwitchService","appMetadataService","$window","promiseFactory","tutorialDataStore","$compile","localFileService","workbookCollection","permissionService",function(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f,g){return e.dataServices.createWorkbookService(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f,g)}]).factory("modelService",["$rootScope","telemetryService","errorService","dataServiceModelMerger","dataServiceModelConverter","syncService","modelHttpService","localizationService","reportService","appMetadataService","promiseFactory","dataProxy","modelCollection","permissionService",function(t,o,r,i,a,n,s,c,d,l,p,u,v,h){return e.dataServices.createModelService(t,o,r,i,a,n,s,c,d,l,p,u,v,h)}]).factory("dashboardDataService",["dashboardHttpService","promiseFactory","featureSwitchService","dataServiceModelMerger","modelService","dashboardCollection","$timeout",function(t,o,r,i,a,n,s){return e.dataServices.createDashboardDataService(t,o,r,i,a,n,s)}]).factory("dashboardSyncService",["$rootScope","dashboardDataService","dashboardHttpService","dataServiceModelConverter","dataServiceModelMerger","modelService","promiseFactory","reportService","resourceGateService","resourcePackageListenerService","resourcePackagesService","syncService","telemetryService","tutorialDataStore","userInfo","workbookService","permissionService",function(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f,g){return e.dataServices.createDashboarSyncService(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m,f,g)}]).factory("resourcePackageListenerService",["resourcePackagesService","promiseFactory","visualPlugin",function(t,o,r){return e.dataServices.createResourcePackageListenerService(t,o,r)}]).factory("tileConfigUpgraderService",["visualPlugin","telemetryService",function(e,o){return t.upgrader.createTileConfigUpgraderService(e,o)}]).factory("dataServiceModelConverter",["geolocationService","geocoder","promiseFactory","moduleLoader","telemetryService","visualPlugin","featureSwitchService","permissionService","tileConfigUpgraderService","localizationService","explorationSerializer",function(t,o,r,i,a,n,s,c,d,l,p){return e.dataServices.models.createDataServiceModelConverter(t,a,n,e.explore.services.createVisualPluginOps(n),s,o,r,i,c,d,l,p)}]).factory("dataServiceModelMerger",["dataServiceModelConverter","permissionService",function(t,o){var r=e.dataServices.models.createDataServiceModelMerger(t,o);return t.setModelMerger(r),r}]).factory("tutorialDataStore",["featureSwitchService",function(e){return t.createTutorialDataStoreService(e)}]).factory("packageService",["$rootScope","telemetryService","errorService","dataServiceModelMerger","dataServiceModelConverter","reportService","modelService","syncService","localizationService","appMetadataService","workbookService","appService","packageCollection","permissionService","promiseFactory",function(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m){return e.dataServices.createPackageService(t,o,r,i,a,n,s,c,d,l,p,u,v,h,m)}]).factory("appService",["appMetadataService","dashboardDataService","appCollection","modelService","reportService","workbookService","promiseFactory","dataServiceModelConverter","asyncFeatureSwitchService","telemetryService","modalDialogService","errorService","localizationService",function(e,o,r,i,a,n,s,c,d,l,p,u,v){return t.createAppService(e,o,r,i,a,n,s,c,d,l,p,u,v)}]).service("resourceOwnershipService",["userInfo",e.dataServices.ResourceOwnershipService])})(t=e.dataServices||(e.dataServices={}))})(powerbi||(powerbi={}));;var __awaiter=this&&this.__awaiter||function(e,t,i,o){return new(i||(i=Promise))(function(r,a){function n(e){try{c(o.next(e))}catch(e){a(e)}}function s(e){try{c(o.throw(e))}catch(e){a(e)}}function c(e){e.done?r(e.value):new i(function(t){t(e.value)}).then(n,s)}c((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return o([e,t])}}function o(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,a&&(n=a[2&i[0]?"return":i[0]?"throw":"next"])&&!(n=n.call(a,i[1])).done)return n;switch(a=0,n&&(i=[0,n.value]),i[0]){case 0:case 1:n=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,a=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(n=s.trys,!(n=n.length>0&&n[n.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!n||i[1]>n[0]&&i[1]<n[3])){s.label=i[1];break}if(6===i[0]&&s.label<n[1]){s.label=n[1],n=i;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(i);break}n[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],a=0}finally{r=n=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,a,n,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return{next:i(0),throw:i(1),return:i(2)}},__assign=this&&this.__assign||Object.assign||function(e){for(var t,i=1,o=arguments.length;i<o;i++){t=arguments[i];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},__extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}})();window.DEBUG=!1;var powerbi;!(function(e){var t;!(function(t){function i(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={show:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Settings.SetShowGridlines",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({show:h.show,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.SettingsSetShowGridlinesLoggers};return g}function o(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={snap:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Settings.SetSnapToGrid",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({snap:h.snap,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.SettingsSetSnapToGridLoggers};return g}function r(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={fromState:t,toState:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Navigation.ClickBreadcrumb",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({fromState:g.fromState,toState:g.toState,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.NavigationClickBreadcrumbLoggers};return m}function a(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={isExpanded:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Navigation.Toggle",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isExpanded:h.isExpanded,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.NavigationToggleLoggers};return g}function n(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Navigation.ClickLogo",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.NavigationClickLogoLoggers};return h}function s(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={numberOfDashboards:t,numberOfReports:i,numberOfWorkbooks:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.ContentList.ArtifactsCount",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numberOfDashboards:m.numberOfDashboards,numberOfReports:m.numberOfReports,numberOfWorkbooks:m.numberOfWorkbooks,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.ContentListArtifactsCountLoggers};return f}function c(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.ContentProvider.InitializeContentProviders",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.ContentProviderInitializeContentProvidersLoggers};return h}function l(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.DuplicateDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardDuplicateDashboardLoggers};return h}function d(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={dashboardGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"BaseDashboardEvent",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:h.dashboardGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.BaseDashboardEventLoggers};return g}function p(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={dashboardGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"BaseDashboardVerboseEvent",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:h.dashboardGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.BaseDashboardVerboseEventLoggers};return g}function u(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardGuid:t,tileCount:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"DashboardEvent",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,tileCount:g.tileCount,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardEventLoggers};return m}function v(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={favoriteId:t,groupId:i,favoriteType:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.AddFavorite",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({favoriteId:m.favoriteId,groupId:m.groupId,favoriteType:e.telemetry.FavoriteType[m.favoriteType],parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardAddFavoriteLoggers};return f}function h(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={favoriteObjectId:t,groupId:i,favoriteType:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.DeleteFavorite",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({favoriteObjectId:m.favoriteObjectId,groupId:m.groupId,favoriteType:e.telemetry.FavoriteType[m.favoriteType],parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardDeleteFavoriteLoggers};return f}function g(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={countOfFavorites:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.GetFavorites",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({countOfFavorites:h.countOfFavorites,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardGetFavoritesLoggers};return g}function m(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardGuid:t,invitationId:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.ClaimInvitation",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,invitationId:g.invitationId,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardClaimInvitationLoggers};return m}function f(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={userAgent:t,invitationId:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.ClaimInvitationRedirectToMobileLandingPage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({userAgent:g.userAgent,invitationId:g.invitationId,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardClaimInvitationRedirectToMobileLandingPageLoggers};return m}function y(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={contentProviderId:t,contentProviderKey:i,contentProviderDisplayText:o,contentProviderCategory:r,autoInstall:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.Dashboard.ContentProviderPublish",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({contentProviderId:y.contentProviderId,contentProviderKey:y.contentProviderKey,contentProviderDisplayText:y.contentProviderDisplayText,contentProviderCategory:y.contentProviderCategory,autoInstall:y.autoInstall,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.DashboardContentProviderPublishLoggers};return b}function b(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={DSID:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ContentProviderPublishDSID",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({DSID:h.DSID,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardContentProviderPublishDSIDLoggers};return g}function S(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={URL:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.CustomConfigHandler.SharePointDiscover",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({URL:h.URL,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.CustomConfigHandlerSharePointDiscoverLoggers};return g}function w(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardGuid:t,tileCount:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.DeleteDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,tileCount:g.tileCount,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardDeleteDashboardLoggers};return m}function C(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.DeleteDashboardUser",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardDeleteDashboardUserLoggers};return h}function D(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.DeleteTile",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardDeleteTileLoggers};return h}function I(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={downloadReferrer:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DownloadIOSApp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({downloadReferrer:h.downloadReferrer,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDownloadIOSAppLoggers};return g}function T(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={downloadReferrer:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DownloadCompanionApp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({downloadReferrer:h.downloadReferrer,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDownloadCompanionAppLoggers};return g}function M(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={downloadReferrer:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DownloadExcelPublisher",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({downloadReferrer:h.downloadReferrer,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDownloadExcelPublisherLoggers};return g}function k(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={downloadReferrer:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DownloadGateways",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({downloadReferrer:h.downloadReferrer,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDownloadGatewaysLoggers};return g}function P(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardGuid:t,permission:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.EditDashboardPermissions",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,permission:g.permission,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardEditDashboardPermissionsLoggers};return m}function E(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={tilesChanged:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.TileLayoutChanged",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tilesChanged:h.tilesChanged,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardTileLayoutChangedLoggers};return g}function A(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),
void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={tileId:t,workbookId:i,packageId:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.InFocusWorkbook",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileId:m.tileId,workbookId:m.workbookId,packageId:m.packageId,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardInFocusWorkbookLoggers};return f}function _(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.ReloadWorkbook",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardReloadWorkbookLoggers};return h}function R(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.CalculateWorkbook",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardCalculateWorkbookLoggers};return h}function x(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={readOnlyTileEdited:t,titleEdited:i,subTitleEdited:o,actionEdited:r,configEdited:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.Dashboard.EditTileProperties",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({readOnlyTileEdited:y.readOnlyTileEdited,titleEdited:y.titleEdited,subTitleEdited:y.subTitleEdited,actionEdited:y.actionEdited,configEdited:y.configEdited,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.DashboardEditTilePropertiesLoggers};return b}function N(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={contentEdited:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.InFocusMode.SaveTileProperties",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({contentEdited:h.contentEdited,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.InFocusModeSaveTilePropertiesLoggers};return g}function L(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={dashboardGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ExportDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:h.dashboardGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardExportDashboardLoggers};return g}function F(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={originalDashboardGuid:t,appGuid:i,dashboardGuid:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"BaseAppDashboardEvent",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({originalDashboardGuid:m.originalDashboardGuid,appGuid:m.appGuid,dashboardGuid:m.dashboardGuid,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.BaseAppDashboardEventLoggers};return f}function G(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M,k,P,E,A){void 0===S&&(S=!1),void 0===w&&(w=void 0),void 0===C&&(C=void 0),void 0===D&&(D=void 0),void 0===I&&(I=void 0),void 0===T&&(T=void 0),void 0===M&&(M=!1),void 0===k&&(k=!1),void 0===P&&(P=void 0),void 0===E&&(E=!1),void 0===A&&(A=!1);var _={isSample:t,hasResourcePackages:i,hasOnPremiseModel:o,compositeTilesCount:r,iframeTilesCount:a,imageTilesCount:n,modelTilesCount:s,ssrsTilesCount:c,workbookTilesCount:l,reportTilesCount:d,workbookTileNoImage:p,otherTileTypes:u,realTimeTilesCount:v,source:h,groupObjectId:g,originalDashboardGuid:m,appGuid:f,dashboardGuid:y,parentId:b,isError:S,errorSource:w,errorCode:C,errorMessage:D,activityName:I,activityId:T,isDebug:M,isCancelled:k,pingLatency:P,isAppInactive:E,isInCapacity:A},R={name:"PBI.Dashboard.OpenDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isSample:_.isSample,hasResourcePackages:_.hasResourcePackages,hasOnPremiseModel:_.hasOnPremiseModel,compositeTilesCount:_.compositeTilesCount,iframeTilesCount:_.iframeTilesCount,imageTilesCount:_.imageTilesCount,modelTilesCount:_.modelTilesCount,ssrsTilesCount:_.ssrsTilesCount,workbookTilesCount:_.workbookTilesCount,reportTilesCount:_.reportTilesCount,workbookTileNoImage:_.workbookTileNoImage,otherTileTypes:_.otherTileTypes,realTimeTilesCount:_.realTimeTilesCount,source:e.telemetry.OpenDashboardSource[_.source],groupObjectId:_.groupObjectId,originalDashboardGuid:_.originalDashboardGuid,appGuid:_.appGuid,dashboardGuid:_.dashboardGuid,parentId:_.parentId},{isError:_.isError,errorSource:e.telemetry.ErrorSource[_.errorSource],errorCode:_.errorCode,errorMessage:_.errorMessage,activityName:_.activityName,activityId:_.activityId,isDebug:_.isDebug,isCancelled:_.isCancelled,pingLatency:_.pingLatency,isAppInactive:_.isAppInactive,isInCapacity:_.isInCapacity})},info:_,loggers:e.telemetry.DashboardOpenDashboardLoggers};return R}function O(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={tileCount:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.LoadDashboardTileVisual",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileCount:h.tileCount,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardLoadDashboardTileVisualLoggers};return g}function z(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S){void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1),void 0===y&&(y=void 0),void 0===b&&(b=!1),void 0===S&&(S=!1);var w={visualType:t,source:i,reason:o,unsupportedVisualPinned:r,contentProviderType:a,isCustomVisual:n,widgetType:s,reportPageContainsScriptVisuals:c,parentId:l,isError:d,errorSource:p,errorCode:u,errorMessage:v,activityName:h,activityId:g,isDebug:m,isCancelled:f,pingLatency:y,isAppInactive:b,isInCapacity:S},C={name:"PBI.Dashboard.PinTile",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({visualType:w.visualType,source:e.telemetry.PinTileSource[w.source],reason:w.reason,unsupportedVisualPinned:w.unsupportedVisualPinned,contentProviderType:w.contentProviderType,isCustomVisual:w.isCustomVisual,widgetType:w.widgetType,reportPageContainsScriptVisuals:w.reportPageContainsScriptVisuals,parentId:w.parentId},{isError:w.isError,errorSource:e.telemetry.ErrorSource[w.errorSource],errorCode:w.errorCode,errorMessage:w.errorMessage,activityName:w.activityName,activityId:w.activityId,isDebug:w.isDebug,isCancelled:w.isCancelled,pingLatency:w.pingLatency,isAppInactive:w.isAppInactive,isInCapacity:w.isInCapacity})},info:w,loggers:e.telemetry.DashboardPinTileLoggers};return C}function U(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S){void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1),void 0===y&&(y=void 0),void 0===b&&(b=!1),void 0===S&&(S=!1);var w={visualType:t,source:i,reason:o,unsupportedVisualPinned:r,contentProviderType:a,smartSelection:n,namedItemType:s,storageProvider:c,parentId:l,isError:d,errorSource:p,errorCode:u,errorMessage:v,activityName:h,activityId:g,isDebug:m,isCancelled:f,pingLatency:y,isAppInactive:b,isInCapacity:S},C={name:"PBI.Dashboard.PinWorkbookTile",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({visualType:w.visualType,source:e.telemetry.PinTileSource[w.source],reason:w.reason,unsupportedVisualPinned:w.unsupportedVisualPinned,contentProviderType:w.contentProviderType,smartSelection:w.smartSelection,namedItemType:w.namedItemType,storageProvider:w.storageProvider,parentId:w.parentId},{isError:w.isError,errorSource:e.telemetry.ErrorSource[w.errorSource],errorCode:w.errorCode,errorMessage:w.errorMessage,activityName:w.activityName,activityId:w.activityId,isDebug:w.isDebug,isCancelled:w.isCancelled,pingLatency:w.pingLatency,isAppInactive:w.isAppInactive,isInCapacity:w.isInCapacity})},info:w,loggers:e.telemetry.DashboardPinWorkbookTileLoggers};return C}function B(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={errorReason:t,userSwitchedGroups:i,userIsBrowsingArchivedContent:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.InitializeContainer",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({errorReason:m.errorReason,userSwitchedGroups:m.userSwitchedGroups,userIsBrowsingArchivedContent:m.userIsBrowsingArchivedContent,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardInitializeContainerLoggers};return f}function $(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={name:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.InitializeContentProviderConfig",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({name:h.name,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardInitializeContentProviderConfigLoggers};return g}function V(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w){void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=void 0),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===y&&(y=!1),void 0===b&&(b=void 0),void 0===S&&(S=!1),void 0===w&&(w=!1);var C={numberOfEmailAddresses:t,numberOfObjectIds:i,lengthOfMessage:o,isDefaultMessage:r,isReshared:a,reshareEnabled:n,dashboardGuid:s,notifyViaEmail:c,numberOfExternalEmails:l,parentId:d,isError:p,errorSource:u,errorCode:v,errorMessage:h,activityName:g,activityId:m,isDebug:f,isCancelled:y,pingLatency:b,isAppInactive:S,isInCapacity:w},D={name:"PBI.Dashboard.InviteDashboardUsers",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numberOfEmailAddresses:C.numberOfEmailAddresses,numberOfObjectIds:C.numberOfObjectIds,lengthOfMessage:C.lengthOfMessage,isDefaultMessage:C.isDefaultMessage,isReshared:C.isReshared,reshareEnabled:C.reshareEnabled,dashboardGuid:C.dashboardGuid,notifyViaEmail:C.notifyViaEmail,numberOfExternalEmails:C.numberOfExternalEmails,parentId:C.parentId},{isError:C.isError,errorSource:e.telemetry.ErrorSource[C.errorSource],errorCode:C.errorCode,errorMessage:C.errorMessage,activityName:C.activityName,activityId:C.activityId,isDebug:C.isDebug,isCancelled:C.isCancelled,pingLatency:C.pingLatency,isAppInactive:C.isAppInactive,isInCapacity:C.isInCapacity})},info:C,loggers:e.telemetry.DashboardInviteDashboardUsersLoggers};return D}function W(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={numberOfEmailAddresses:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.SharingEmailAddressExceededLimit",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numberOfEmailAddresses:h.numberOfEmailAddresses,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardSharingEmailAddressExceededLimitLoggers};return g}function H(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.SharingEmailAddressUnsupportedGroup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardSharingEmailAddressUnsupportedGroupLoggers};return h}function j(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.SharingWithInvalidDomain",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardSharingWithInvalidDomainLoggers};return h}function q(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.SharingWithBlockedDomain",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardSharingWithBlockedDomainLoggers};return h}function Q(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.OpenShareDialog",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardOpenShareDialogLoggers};return h}function K(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.SendShareInvitation",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardSendShareInvitationLoggers};return h}function J(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={dashboardObjectId:t,messageLength:i,isDefaultMessage:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.RequestDashboardAccess",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardObjectId:m.dashboardObjectId,messageLength:m.messageLength,isDefaultMessage:m.isDefaultMessage,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardRequestDashboardAccessLoggers};return f}function Y(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={dashboardObjectId:t,kind:i,id:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.DeleteDashboardAccessRequest",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardObjectId:m.dashboardObjectId,kind:m.kind,id:m.id,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardDeleteDashboardAccessRequestLoggers};return f}function X(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.LoadDashboardUsers",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardLoadDashboardUsersLoggers};return h}function Z(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={tileType:t,tileId:i,reason:o,contentProviderId:r,contentProviderDisplayText:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.Dashboard.OpenTile",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileType:e.telemetry.ContentTypes[y.tileType],tileId:y.tileId,reason:y.reason,contentProviderId:y.contentProviderId,contentProviderDisplayText:y.contentProviderDisplayText,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.DashboardOpenTileLoggers};return b}function ee(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={settingGroupTypeChangedFrom:t,settingGroupTypeChangedTo:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.SettingGroupChanged",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({settingGroupTypeChangedFrom:g.settingGroupTypeChangedFrom,settingGroupTypeChangedTo:g.settingGroupTypeChangedTo,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardSettingGroupChangedLoggers};return m}function te(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={isForceScheduleRefreshUseITGW_Status:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ForceScheduleRefreshUseITGW",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isForceScheduleRefreshUseITGW_Status:h.isForceScheduleRefreshUseITGW_Status,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardForceScheduleRefreshUseITGWLoggers};return g}function ie(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={tileCount:t,dashboardGuid:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.RenameDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileCount:g.tileCount,dashboardGuid:g.dashboardGuid,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardRenameDashboardLoggers};return m}function oe(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1);var f={etagHash:t,permissions:i,storageProvider:o,contentProvider:r,parentId:a,isError:n,errorSource:s,errorCode:c,errorMessage:l,activityName:d,activityId:p,isDebug:u,isCancelled:v,pingLatency:h,isAppInactive:g,isInCapacity:m},y={name:"PBI.Dashboard.ViewWorkbook",
category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({etagHash:f.etagHash,permissions:f.permissions,storageProvider:f.storageProvider,contentProvider:f.contentProvider,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.DashboardViewWorkbookLoggers};return y}function re(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.WorkbookEditedInPowerBICausedPinBlock",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardWorkbookEditedInPowerBICausedPinBlockLoggers};return h}function ae(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={etagHash:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.EditWorkbook",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({etagHash:h.etagHash,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardEditWorkbookLoggers};return g}function ne(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={etagHash:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.WorkbookViewedExternallyDueToAnError",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({etagHash:h.etagHash,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardWorkbookViewedExternallyDueToAnErrorLoggers};return g}function se(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={from:t,to:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.SwitchView",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({from:g.from,to:g.to,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardSwitchViewLoggers};return m}function ce(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={dashboardGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.UpdateActiveDashboard",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:h.dashboardGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardUpdateActiveDashboardLoggers};return g}function le(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={dashboardGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.RefreshTileData",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:h.dashboardGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardRefreshTileDataLoggers};return g}function de(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={homeDashboardId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.SetHomeDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({homeDashboardId:h.homeDashboardId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardSetHomeDashboardLoggers};return g}function pe(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={homeDashboardId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DisableHomeDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({homeDashboardId:h.homeDashboardId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDisableHomeDashboardLoggers};return g}function ue(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1);var f={dashboardGuid:t,totalTiles:i,numberOfScriptTiles:o,numberOfliveReportsWithR:r,parentId:a,isError:n,errorSource:s,errorCode:c,errorMessage:l,activityName:d,activityId:p,isDebug:u,isCancelled:v,pingLatency:h,isAppInactive:g,isInCapacity:m},y={name:"PBI.Dashboard.RefreshDashboardTiles",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:f.dashboardGuid,totalTiles:f.totalTiles,numberOfScriptTiles:f.numberOfScriptTiles,numberOfliveReportsWithR:f.numberOfliveReportsWithR,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.DashboardRefreshDashboardTilesLoggers};return y}function ve(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={groupObjectId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Groups.SwitchGroup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:h.groupObjectId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.GroupsSwitchGroupLoggers};return g}function he(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={key:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ShowGettingStartedPopup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({key:h.key,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardShowGettingStartedPopupLoggers};return g}function ge(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"BaseDataSetTopLevelCustomerAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.BaseDataSetTopLevelCustomerActionLoggers};return g}function me(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.ManageDatasetsLanding",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardManageDatasetsLandingLoggers};return h}function fe(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DatasetClickScheduleRefresh",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDatasetClickScheduleRefreshLoggers};return g}function ye(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.WorkbookClickScheduleRefresh",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardWorkbookClickScheduleRefreshLoggers};return g}function be(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DatasetClickRefreshNow",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDatasetClickRefreshNowLoggers};return g}function Se(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.WorkbookClickRefreshNow",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardWorkbookClickRefreshNowLoggers};return g}function we(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DatasetClickDelete",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDatasetClickDeleteLoggers};return g}function Ce(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DatasetClickInsights",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDatasetClickInsightsLoggers};return g}function De(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DatasetClickRename",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDatasetClickRenameLoggers};return g}function Ie(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={providerId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ClickPersonalize",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({providerId:h.providerId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardClickPersonalizeLoggers};return g}function Te(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={type:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.DataModelSelected",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({type:h.type,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardDataModelSelectedLoggers};return g}function Me(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={action:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ExpandCollapseNavigatorPane",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({action:e.telemetry.NavPaneToggleAction[h.action],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardExpandCollapseNavigatorPaneLoggers};return g}function ke(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={interaction:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.OpenGetDataPage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({interaction:e.telemetry.OpenGetDataPageInteraction[h.interaction],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardOpenGetDataPageLoggers};return g}function Pe(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={action:t,section:i,numDashboards:o,numReports:r,numDatasets:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.Dashboard.ExpandCollapseNavigatorPaneSection",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({action:e.telemetry.NavPaneToggleAction[y.action],section:e.telemetry.NavPaneSection[y.section],numDashboards:y.numDashboards,numReports:y.numReports,numDatasets:y.numDatasets,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.DashboardExpandCollapseNavigatorPaneSectionLoggers};return b}function Ee(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={numDashboards:t,numReports:i,numDatasets:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.FilterNavigatorPaneItems",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numDashboards:m.numDashboards,numReports:m.numReports,numDatasets:m.numDatasets,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardFilterNavigatorPaneItemsLoggers};return f}function Ae(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.GetGroups",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardGetGroupsLoggers};return h}function _e(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S){void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1),void 0===y&&(y=void 0),void 0===b&&(b=!1),void 0===S&&(S=!1);var w={isUpdateContentPack:t,numberOfDashboards:i,numberOfReports:o,numberOfModels:r,numberOfWorkbooks:a,isMyWorkspace:n,numberOfGroupsSharedTo:s,isUserError:c,parentId:l,isError:d,errorSource:p,errorCode:u,errorMessage:v,activityName:h,activityId:g,isDebug:m,isCancelled:f,pingLatency:y,isAppInactive:b,isInCapacity:S},C={name:"PBI.Dashboard.ContentPackPublish",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isUpdateContentPack:w.isUpdateContentPack,numberOfDashboards:w.numberOfDashboards,numberOfReports:w.numberOfReports,numberOfModels:w.numberOfModels,numberOfWorkbooks:w.numberOfWorkbooks,isMyWorkspace:w.isMyWorkspace,numberOfGroupsSharedTo:w.numberOfGroupsSharedTo,isUserError:w.isUserError,parentId:w.parentId},{isError:w.isError,errorSource:e.telemetry.ErrorSource[w.errorSource],errorCode:w.errorCode,errorMessage:w.errorMessage,activityName:w.activityName,activityId:w.activityId,isDebug:w.isDebug,isCancelled:w.isCancelled,pingLatency:w.pingLatency,isAppInactive:w.isAppInactive,isInCapacity:w.isInCapacity})},info:w,loggers:e.telemetry.DashboardContentPackPublishLoggers};return C}function Re(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={numberOfContentPacksDirty:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.ContentPackDirty",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numberOfContentPacksDirty:h.numberOfContentPacksDirty,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,
isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardContentPackDirtyLoggers};return g}function xe(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){void 0===c&&(c=!1),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===y&&(y=!1);var b={isSharedWithEntireOrganization:t,numberOfDashboards:i,numberOfReports:o,numberOfModels:r,numberOfWorkbooks:a,numberOfGroupsSharedTo:n,parentId:s,isError:c,errorSource:l,errorCode:d,errorMessage:p,activityName:u,activityId:v,isDebug:h,isCancelled:g,pingLatency:m,isAppInactive:f,isInCapacity:y},S={name:"PBI.Dashboard.DeleteContentPack",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isSharedWithEntireOrganization:b.isSharedWithEntireOrganization,numberOfDashboards:b.numberOfDashboards,numberOfReports:b.numberOfReports,numberOfModels:b.numberOfModels,numberOfWorkbooks:b.numberOfWorkbooks,numberOfGroupsSharedTo:b.numberOfGroupsSharedTo,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.DashboardDeleteContentPackLoggers};return S}function Ne(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.DeleteTemplateOrganizationApp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardDeleteTemplateOrganizationAppLoggers};return h}function Le(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.ViewContentPacks",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardViewContentPacksLoggers};return h}function Fe(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.ContentPackPersonalize",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardContentPackPersonalizeLoggers};return h}function Ge(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.FirstUse",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardFirstUseLoggers};return h}function Oe(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.WorkbookPinabilityShown",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardWorkbookPinabilityShownLoggers};return h}function ze(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={state:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.GetDataSplash",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({state:e.telemetry.GetDataSplashState[h.state],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardGetDataSplashLoggers};return g}function Ue(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.GetDataSplashIntroVideo",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardGetDataSplashIntroVideoLoggers};return h}function Be(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={categoryName:t,interaction:i,prevCategoryName:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.GetDataCategorySelect",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({categoryName:m.categoryName,interaction:e.telemetry.GetDataCategorySelectInteraction[m.interaction],prevCategoryName:m.prevCategoryName,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardGetDataCategorySelectLoggers};return f}function $e(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={categoryName:t,providerName:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.GetDataProviderSelect",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({categoryName:g.categoryName,providerName:g.providerName,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardGetDataProviderSelectLoggers};return m}function Ve(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1);var f={categoryName:t,providerName:i,userLicenseCheckFailed:o,userStorageQuotaCheckFailed:r,parentId:a,isError:n,errorSource:s,errorCode:c,errorMessage:l,activityName:d,activityId:p,isDebug:u,isCancelled:v,pingLatency:h,isAppInactive:g,isInCapacity:m},y={name:"PBI.Dashboard.GetDataProviderAccordionConnect",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({categoryName:f.categoryName,providerName:f.providerName,userLicenseCheckFailed:f.userLicenseCheckFailed,userStorageQuotaCheckFailed:f.userStorageQuotaCheckFailed,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.DashboardGetDataProviderAccordionConnectLoggers};return y}function We(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={tileType:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.InFocusModeSelected",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileType:h.tileType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardInFocusModeSelectedLoggers};return g}function He(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={reason:t,comment:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.CloseUserAccount",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reason:g.reason,comment:g.comment,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardCloseUserAccountLoggers};return m}function je(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1);var f={dataClassificationUpdated:t,qnaEnabledUpdated:i,gravityEnabledUpdated:o,dashboardGuid:r,parentId:a,isError:n,errorSource:s,errorCode:c,errorMessage:l,activityName:d,activityId:p,isDebug:u,isCancelled:v,pingLatency:h,isAppInactive:g,isInCapacity:m},y={name:"PBI.Dashboard.SaveDashboardSettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dataClassificationUpdated:f.dataClassificationUpdated,qnaEnabledUpdated:f.qnaEnabledUpdated,gravityEnabledUpdated:f.gravityEnabledUpdated,dashboardGuid:f.dashboardGuid,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.DashboardSaveDashboardSettingsLoggers};return y}function qe(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.InitializeSettingsDashboardsModel",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardInitializeSettingsDashboardsModelLoggers};return h}function Qe(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.TestDataSourceConnection",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardTestDataSourceConnectionLoggers};return h}function Ke(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.GetRefreshHistoriesOnRefreshFailures",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardGetRefreshHistoriesOnRefreshFailuresLoggers};return h}function Je(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={tileId:t,modelId:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.LoadTileData",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileId:g.tileId,modelId:g.modelId,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardLoadTileDataLoggers};return m}function Ye(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={selectedFilter:t,isMyWorkspace:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.OwnershipFilterSelected",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({selectedFilter:g.selectedFilter,isMyWorkspace:g.isMyWorkspace,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardOwnershipFilterSelectedLoggers};return m}function Xe(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={initialState:t,finalState:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.App.InitialAppLoad",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({initialState:g.initialState,finalState:g.finalState,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.AppInitialAppLoadLoggers};return m}function Ze(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1),void 0===f&&(f=void 0),void 0===y&&(y=!1),void 0===b&&(b=!1);var S={groupCreated:t,groupId:i,isReadOnly:o,adminCount:r,memberCount:a,invitedMemberCount:n,hasCapacity:s,parentId:c,isError:l,errorSource:d,errorCode:p,errorMessage:u,activityName:v,activityId:h,isDebug:g,isCancelled:m,pingLatency:f,isAppInactive:y,isInCapacity:b},w={name:"PBI.GroupEditor.CreateGroup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupCreated:S.groupCreated,groupId:S.groupId,isReadOnly:S.isReadOnly,adminCount:S.adminCount,memberCount:S.memberCount,invitedMemberCount:S.invitedMemberCount,hasCapacity:S.hasCapacity,parentId:S.parentId},{isError:S.isError,errorSource:e.telemetry.ErrorSource[S.errorSource],errorCode:S.errorCode,errorMessage:S.errorMessage,activityName:S.activityName,activityId:S.activityId,isDebug:S.isDebug,isCancelled:S.isCancelled,pingLatency:S.pingLatency,isAppInactive:S.isAppInactive,isInCapacity:S.isInCapacity})},info:S,loggers:e.telemetry.GroupEditorCreateGroupLoggers};return w}function et(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.GroupEditor.ValidateGroupMembers",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.GroupEditorValidateGroupMembersLoggers};return h}function tt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.GroupEditor.GetGroupMembers",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.GroupEditorGetGroupMembersLoggers};return h}function it(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1),void 0===f&&(f=void 0),void 0===y&&(y=!1),void 0===b&&(b=!1);var S={groupUpdated:t,groupId:i,isGroupReadOnly:o,adminCount:r,memberCount:a,invitedMemberCount:n,capacityChanged:s,parentId:c,isError:l,errorSource:d,errorCode:p,errorMessage:u,activityName:v,activityId:h,isDebug:g,isCancelled:m,pingLatency:f,isAppInactive:y,isInCapacity:b},w={name:"PBI.GroupEditor.UpdateGroup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupUpdated:S.groupUpdated,groupId:S.groupId,isGroupReadOnly:S.isGroupReadOnly,adminCount:S.adminCount,memberCount:S.memberCount,invitedMemberCount:S.invitedMemberCount,capacityChanged:S.capacityChanged,parentId:S.parentId},{isError:S.isError,errorSource:e.telemetry.ErrorSource[S.errorSource],errorCode:S.errorCode,errorMessage:S.errorMessage,activityName:S.activityName,activityId:S.activityId,isDebug:S.isDebug,isCancelled:S.isCancelled,pingLatency:S.pingLatency,isAppInactive:S.isAppInactive,isInCapacity:S.isInCapacity})},info:S,loggers:e.telemetry.GroupEditorUpdateGroupLoggers};return w}function ot(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={groupUpdated:t,groupId:i,isGroupReadOnly:o,adminCount:r,memberCount:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.GroupEditor.UserLeaveGroup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupUpdated:y.groupUpdated,groupId:y.groupId,isGroupReadOnly:y.isGroupReadOnly,adminCount:y.adminCount,memberCount:y.memberCount,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.GroupEditorUserLeaveGroupLoggers};return b}function rt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.GroupEditor.DeleteGroup",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.GroupEditorDeleteGroupLoggers};return h}function at(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.GroupEditor.ValidateGroupId",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.GroupEditorValidateGroupIdLoggers};return h}function nt(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={interaction:t,context:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Quota.OpenManageStoragePage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({interaction:e.telemetry.QuotaOpenManageStorageInteraction[g.interaction],context:e.telemetry.QuotaOpenManageStorageContext[g.context],parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.QuotaOpenManageStoragePageLoggers};return m}function st(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={isPremiumUser:t,context:i,ownedUsageInMB:o,sharedUsageInMB:r,quotaLimitInMB:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.Quota.StorageUsage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isPremiumUser:y.isPremiumUser,context:e.telemetry.QuotaOpenManageStorageContext[y.context],ownedUsageInMB:y.ownedUsageInMB,sharedUsageInMB:y.sharedUsageInMB,quotaLimitInMB:y.quotaLimitInMB,parentId:y.parentId
},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.QuotaStorageUsageLoggers};return b}function ct(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1),void 0===f&&(f=void 0),void 0===y&&(y=!1),void 0===b&&(b=!1);var S={isPremiumUser:t,context:i,itemType:o,sizeInMBToDelete:r,ownedUsageInMB:a,sharedUsageInMB:n,quotaLimitInMB:s,parentId:c,isError:l,errorSource:d,errorCode:p,errorMessage:u,activityName:v,activityId:h,isDebug:g,isCancelled:m,pingLatency:f,isAppInactive:y,isInCapacity:b},w={name:"PBI.Quota.ManageStorageDelete",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isPremiumUser:S.isPremiumUser,context:e.telemetry.QuotaOpenManageStorageContext[S.context],itemType:e.telemetry.QuotaDeleteItemType[S.itemType],sizeInMBToDelete:S.sizeInMBToDelete,ownedUsageInMB:S.ownedUsageInMB,sharedUsageInMB:S.sharedUsageInMB,quotaLimitInMB:S.quotaLimitInMB,parentId:S.parentId},{isError:S.isError,errorSource:e.telemetry.ErrorSource[S.errorSource],errorCode:S.errorCode,errorMessage:S.errorMessage,activityName:S.activityName,activityId:S.activityId,isDebug:S.isDebug,isCancelled:S.isCancelled,pingLatency:S.pingLatency,isAppInactive:S.isAppInactive,isInCapacity:S.isInCapacity})},info:S,loggers:e.telemetry.QuotaManageStorageDeleteLoggers};return w}function lt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){void 0===c&&(c=!1),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===y&&(y=!1);var b={isPremiumUser:t,context:i,operation:o,ownedUsageInMB:r,sharedUsageInMB:a,quotaLimitInMB:n,parentId:s,isError:c,errorSource:l,errorCode:d,errorMessage:p,activityName:u,activityId:v,isDebug:h,isCancelled:g,pingLatency:m,isAppInactive:f,isInCapacity:y},S={name:"PBI.Quota.Exceeded",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isPremiumUser:b.isPremiumUser,context:e.telemetry.QuotaOpenManageStorageContext[b.context],operation:e.telemetry.QuotaCheckOperation[b.operation],ownedUsageInMB:b.ownedUsageInMB,sharedUsageInMB:b.sharedUsageInMB,quotaLimitInMB:b.quotaLimitInMB,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.QuotaExceededLoggers};return S}function dt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={interaction:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.OpenUpgradeAccountPage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({interaction:e.telemetry.OpenUpgradeAccountInteraction[h.interaction],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.OpenUpgradeAccountPageLoggers};return g}function pt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Privacy.InitializeSettingsModel",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.PrivacyInitializeSettingsModelLoggers};return h}function ut(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Privacy.SaveSettingsModel",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.PrivacySaveSettingsModelLoggers};return h}function vt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={esriEnabled:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Settings.EsriSaveModel",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({esriEnabled:h.esriEnabled,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.SettingsEsriSaveModelLoggers};return g}function ht(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Settings.DeleteAllDatasources",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsDeleteAllDatasourcesLoggers};return h}function gt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Settings.TakeoverDatasources",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsTakeoverDatasourcesLoggers};return h}function mt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Privacy.SendPowerBIEmail",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.PrivacySendPowerBIEmailLoggers};return h}function ft(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={settingLocale:t,clientLocale:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Locale.IncorrectLocaleSetting",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({settingLocale:g.settingLocale,clientLocale:g.clientLocale,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.LocaleIncorrectLocaleSettingLoggers};return m}function yt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={locale:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Locale.SaveLocaleSetting",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({locale:h.locale,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.LocaleSaveLocaleSettingLoggers};return g}function bt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Settings.LoadSettingsData",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.SettingsLoadSettingsDataLoggers};return h}function St(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={startingState:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Settings.EnterFullScreen",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({startingState:h.startingState,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.SettingsEnterFullScreenLoggers};return g}function wt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={fileExtension:t,possibility:i,DSID:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.LocalFile.ContentProviderLocalFileUpload",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({fileExtension:m.fileExtension,possibility:e.telemetry.LocalFileUploadPossibility[m.possibility],DSID:m.DSID,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.LocalFileContentProviderLocalFileUploadLoggers};return f}function Ct(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={isReplaced:t,isUpdateFromWorkbookFlow:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.LocalFile.ContentProviderLocalFileUploadReplace",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isReplaced:g.isReplaced,isUpdateFromWorkbookFlow:g.isUpdateFromWorkbookFlow,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.LocalFileContentProviderLocalFileUploadReplaceLoggers};return m}function Dt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={response:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.LocalFile.ContentProviderLocalFileUpload.LiveConnectPbix",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({response:h.response,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.LocalFileContentProviderLocalFileUploadLiveConnectPbixLoggers};return g}function It(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={enabled:t,from:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Preview.ConceptualModel",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({enabled:g.enabled,from:e.telemetry.From[g.from],parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.PreviewConceptualModelLoggers};return m}function Tt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Preview.FeaturesIntroductionModalLogged",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.PreviewFeaturesIntroductionModalLoggedLoggers};return h}function Mt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={modalFor:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Preview.FeaturesModalShown",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({modalFor:e.telemetry.ModalFor[h.modalFor],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.PreviewFeaturesModalShownLoggers};return g}function kt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){void 0===c&&(c=!1),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===y&&(y=!1);var b={groupObjectId:t,dashboardObjectId:i,tileObjectId:o,appId:r,originalDashboardObjectId:a,originalTileObjectId:n,parentId:s,isError:c,errorSource:l,errorCode:d,errorMessage:p,activityName:u,activityId:v,isDebug:h,isCancelled:g,pingLatency:m,isAppInactive:f,isInCapacity:y},S={name:"PBI.QRCode.QRCodeDialogShown",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:b.groupObjectId,dashboardObjectId:b.dashboardObjectId,tileObjectId:b.tileObjectId,appId:b.appId,originalDashboardObjectId:b.originalDashboardObjectId,originalTileObjectId:b.originalTileObjectId,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.QRCodeQRCodeDialogShownLoggers};return S}function Pt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){void 0===c&&(c=!1),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===y&&(y=!1);var b={groupObjectId:t,dashboardObjectId:i,tileObjectId:o,appId:r,originalDashboardObjectId:a,originalTileObjectId:n,parentId:s,isError:c,errorSource:l,errorCode:d,errorMessage:p,activityName:u,activityId:v,isDebug:h,isCancelled:g,pingLatency:m,isAppInactive:f,isInCapacity:y},S={name:"PBI.QRCode.ShortUrlCreated",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:b.groupObjectId,dashboardObjectId:b.dashboardObjectId,tileObjectId:b.tileObjectId,appId:b.appId,originalDashboardObjectId:b.originalDashboardObjectId,originalTileObjectId:b.originalTileObjectId,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.QRCodeShortUrlCreatedLoggers};return S}function Et(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1),void 0===f&&(f=void 0),void 0===y&&(y=!1),void 0===b&&(b=!1);var S={groupObjectId:t,dashboardObjectId:i,tileObjectId:o,errorStatus:r,appId:a,originalDashboardObjectId:n,originalTileObjectId:s,parentId:c,isError:l,errorSource:d,errorCode:p,errorMessage:u,activityName:v,activityId:h,isDebug:g,isCancelled:m,pingLatency:f,isAppInactive:y,isInCapacity:b},w={name:"PBI.QRCode.ShortUrlFailed",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:S.groupObjectId,dashboardObjectId:S.dashboardObjectId,tileObjectId:S.tileObjectId,errorStatus:S.errorStatus,appId:S.appId,originalDashboardObjectId:S.originalDashboardObjectId,originalTileObjectId:S.originalTileObjectId,parentId:S.parentId},{isError:S.isError,errorSource:e.telemetry.ErrorSource[S.errorSource],errorCode:S.errorCode,errorMessage:S.errorMessage,activityName:S.activityName,activityId:S.activityId,isDebug:S.isDebug,isCancelled:S.isCancelled,pingLatency:S.pingLatency,isAppInactive:S.isAppInactive,isInCapacity:S.isInCapacity})},info:S,loggers:e.telemetry.QRCodeShortUrlFailedLoggers};return w}function At(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1);var f={groupObjectId:t,reportObjectId:i,appId:o,originalReportObjectId:r,parentId:a,isError:n,errorSource:s,errorCode:c,errorMessage:l,activityName:d,activityId:p,isDebug:u,isCancelled:v,pingLatency:h,isAppInactive:g,isInCapacity:m},y={name:"PBI.QRCode.QRCodeReportDialogShown",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:f.groupObjectId,reportObjectId:f.reportObjectId,appId:f.appId,originalReportObjectId:f.originalReportObjectId,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.QRCodeQRCodeReportDialogShownLoggers};return y}function _t(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1),void 0===h&&(h=void 0),void 0===g&&(g=!1),void 0===m&&(m=!1);var f={groupObjectId:t,reportObjectId:i,appId:o,originalReportObjectId:r,parentId:a,isError:n,errorSource:s,errorCode:c,errorMessage:l,activityName:d,activityId:p,isDebug:u,isCancelled:v,pingLatency:h,isAppInactive:g,isInCapacity:m},y={name:"PBI.QRCode.ReportShortUrlCreated",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:f.groupObjectId,reportObjectId:f.reportObjectId,appId:f.appId,originalReportObjectId:f.originalReportObjectId,parentId:f.parentId},{isError:f.isError,errorSource:e.telemetry.ErrorSource[f.errorSource],errorCode:f.errorCode,errorMessage:f.errorMessage,activityName:f.activityName,activityId:f.activityId,isDebug:f.isDebug,isCancelled:f.isCancelled,pingLatency:f.pingLatency,isAppInactive:f.isAppInactive,isInCapacity:f.isInCapacity})},info:f,loggers:e.telemetry.QRCodeReportShortUrlCreatedLoggers};return y}function Rt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={groupObjectId:t,reportObjectId:i,errorStatus:o,appId:r,originalReportObjectId:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.QRCode.ReportShortUrlFailed",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({groupObjectId:y.groupObjectId,reportObjectId:y.reportObjectId,errorStatus:y.errorStatus,appId:y.appId,originalReportObjectId:y.originalReportObjectId,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.QRCodeReportShortUrlFailedLoggers};return b}function xt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={snapshotId:t,embedType:i,disabled:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.ManageEmbed.DeleteEmbedCode",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({snapshotId:m.snapshotId,embedType:m.embedType,disabled:m.disabled,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.ManageEmbedDeleteEmbedCodeLoggers};return f}function Nt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.ManageEmbed.LoadAllLiveEmbeddedResources",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.ManageEmbedLoadAllLiveEmbeddedResourcesLoggers};return h}function Lt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.AddWidget",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardAddWidgetLoggers};return h}function Ft(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),
void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={widgetType:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.WidgetSelected",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({widgetType:h.widgetType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardWidgetSelectedLoggers};return g}function Gt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Dashboard.LoadTenantContentPacks",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DashboardLoadTenantContentPacksLoggers};return h}function Ot(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.ContentList.Loaded",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.ContentListLoadedLoggers};return h}function zt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={predicate:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.ContentList.SelectSort",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({predicate:e.telemetry.SelectSort[h.predicate],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ContentListSelectSortLoggers};return g}function Ut(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.ContentList.PersistFilter",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.ContentListPersistFilterLoggers};return h}function Bt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.MostRecentlyUsedService.UpdateMRUData",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.MostRecentlyUsedServiceUpdateMRUDataLoggers};return h}function $t(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.ContentList.Search",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.ContentListSearchLoggers};return h}function Vt(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={source:t,type:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.ContentList.OpenArtifact",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({source:e.telemetry.ContentListArtifactSource[g.source],type:e.telemetry.ContentListArtifactType[g.type],parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.ContentListOpenArtifactLoggers};return m}function Wt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Marketplace.EmbeddedOpened",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.MarketplaceEmbeddedOpenedLoggers};return h}function Ht(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Marketplace.EmbeddedClosedWithAppAcquired",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.MarketplaceEmbeddedClosedWithAppAcquiredLoggers};return h}function jt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Marketplace.EmbeddedClosedWithoutAppAcquired",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.MarketplaceEmbeddedClosedWithoutAppAcquiredLoggers};return h}function qt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={isNew:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.RealTime.EditStreamingDatasetPaneOpened",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({isNew:h.isNew,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.RealTimeEditStreamingDatasetPaneOpenedLoggers};return g}function Qt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.RealTime.StreamingDatasetGalleryPaneOpened",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.RealTimeStreamingDatasetGalleryPaneOpenedLoggers};return h}function Kt(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={selectedOption:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.RealTime.StreamingDatasetGalleryOptionSelected",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({selectedOption:e.telemetry.StreamingDatasetGalleryOption[h.selectedOption],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.RealTimeStreamingDatasetGalleryOptionSelectedLoggers};return g}function Jt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.RealTime.StreamingDatasetPushInfoPaneOpened",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.RealTimeStreamingDatasetPushInfoPaneOpenedLoggers};return h}function Yt(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){void 0===s&&(s=!1),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1),void 0===g&&(g=void 0),void 0===m&&(m=!1),void 0===f&&(f=!1);var y={action:t,dateTimeColumnCount:i,numericColumnCount:o,stringColumnCount:r,realTimeType:a,parentId:n,isError:s,errorSource:c,errorCode:l,errorMessage:d,activityName:p,activityId:u,isDebug:v,isCancelled:h,pingLatency:g,isAppInactive:m,isInCapacity:f},b={name:"PBI.RealTime.AddUpdateRemoveStreamingDataset",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({action:e.telemetry.CreateUpdateDeleteAction[y.action],dateTimeColumnCount:y.dateTimeColumnCount,numericColumnCount:y.numericColumnCount,stringColumnCount:y.stringColumnCount,realTimeType:y.realTimeType,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.RealTimeAddUpdateRemoveStreamingDatasetLoggers};return b}function Xt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.RealTime.GetStreamingDataset",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.RealTimeGetStreamingDatasetLoggers};return h}function Zt(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.RealTime.GetPubNubCredentials",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.RealTimeGetPubNubCredentialsLoggers};return h}function ei(t){var i={message:t},o={name:"PBI.RealTime.LongPollError",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({message:i.message},{})},info:i,loggers:e.telemetry.RealTimeLongPollErrorLoggers};return o}function ti(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={source:t,confirmed:i,modelId:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.RowLevelSecurity.DisableRLS",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({source:e.telemetry.DisableRLSSource[m.source],confirmed:m.confirmed,modelId:m.modelId,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.RowLevelSecurityDisableRLSLoggers};return f}function ii(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.OpenAlertsEditor",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsOpenAlertsEditorLoggers};return h}function oi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){void 0===c&&(c=!1),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=void 0),void 0===u&&(u=void 0),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1),void 0===m&&(m=void 0),void 0===f&&(f=!1),void 0===y&&(y=!1);var b={createCount:t,editCount:i,toggleCount:o,createFailCount:r,editFailCount:a,toggleFailCount:n,parentId:s,isError:c,errorSource:l,errorCode:d,errorMessage:p,activityName:u,activityId:v,isDebug:h,isCancelled:g,pingLatency:m,isAppInactive:f,isInCapacity:y},S={name:"PBI.DataAlerts.SaveAlerts",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({createCount:b.createCount,editCount:b.editCount,toggleCount:b.toggleCount,createFailCount:b.createFailCount,editFailCount:b.editFailCount,toggleFailCount:b.toggleFailCount,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.DataAlertsSaveAlertsLoggers};return S}function ri(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.DeleteAlertAccept",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsDeleteAlertAcceptLoggers};return h}function ai(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.DeleteAlertCancel",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsDeleteAlertCancelLoggers};return h}function ni(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={alertId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.DataAlerts.TileBadgeClicked",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({alertId:h.alertId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DataAlertsTileBadgeClickedLoggers};return g}function si(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={source:t,action:i,alertId:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.DataAlerts.NotificationAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({source:e.telemetry.DataAlertNotificationSource[m.source],action:e.telemetry.DataAlertNotificationAction[m.action],alertId:m.alertId,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DataAlertsNotificationActionLoggers};return f}function ci(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={requestType:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.DataAlerts.Request",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestType:e.telemetry.AlertRequestType[h.requestType],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DataAlertsRequestLoggers};return g}function li(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.OpenAlertsSettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsOpenAlertsSettingsLoggers};return h}function di(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.AlertsSettingsToggle",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsAlertsSettingsToggleLoggers};return h}function pi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.AlertsSettingsEdit",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsAlertsSettingsEditLoggers};return h}function ui(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.DataAlerts.AlertsSettingsDelete",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.DataAlertsAlertsSettingsDeleteLoggers};return h}function vi(t,i,o,r,a,n,s,c,l,d,p,u){
void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.SaveSubscription",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsSaveSubscriptionLoggers};return h}function hi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.UpdateSubscription",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsUpdateSubscriptionLoggers};return h}function gi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.AddSubscription",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsAddSubscriptionLoggers};return h}function mi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.DeleteSubscription",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsDeleteSubscriptionLoggers};return h}function fi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.OpenEmailSettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsOpenEmailSettingsLoggers};return h}function yi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.EditEmailSettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsEditEmailSettingsLoggers};return h}function bi(t){var i={requestType:t},o={name:"PBI.EmailSubscriptions.Request",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestType:e.telemetry.EmailSubscriptionRequestType[i.requestType]},{})},info:i,loggers:e.telemetry.EmailSubscriptionsRequestLoggers};return o}function Si(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.OpenPane",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsOpenPaneLoggers};return h}function wi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.EmailSubscriptions.InertOrUpdateSubscriptions",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.EmailSubscriptionsInertOrUpdateSubscriptionsLoggers};return h}function Ci(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={artifactType:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.UsageMetrics.Http.GetPackage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({artifactType:e.telemetry.UsageMetricsArtifactType[h.artifactType],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.UsageMetricsHttpGetPackageLoggers};return g}function Di(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={numScriptTiles:t,numTotalTiles:i,numReportTilesWithScriptVisuals:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.LoadDashboardWithScriptVisuals",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({numScriptTiles:m.numScriptTiles,numTotalTiles:m.numTotalTiles,numReportTilesWithScriptVisuals:m.numReportTilesWithScriptVisuals,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardLoadDashboardWithScriptVisualsLoggers};return f}function Ii(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={unseenCount:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.UserNotifications.LoadNotificationPane",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({unseenCount:h.unseenCount,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.UserNotificationsLoadNotificationPaneLoggers};return g}function Ti(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={notificationCategory:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.UserNotifications.LinkClicked",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({notificationCategory:h.notificationCategory,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.UserNotificationsLinkClickedLoggers};return g}function Mi(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardGuid:t,isFirstTime:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.UserEnteredPhoneMobileAuthoringMode",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,isFirstTime:g.isFirstTime,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardUserEnteredPhoneMobileAuthoringModeLoggers};return m}function ki(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardGuid:t,resetType:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.UserDeletedMobileLayout",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,resetType:e.telemetry.MobileAuthoringResetType[g.resetType],parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardUserDeletedMobileLayoutLoggers};return m}function Pi(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={dashboardGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.UserExitsAuthoringModeWithEmptyMobileLayout",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:h.dashboardGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardUserExitsAuthoringModeWithEmptyMobileLayoutLoggers};return g}function Ei(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={parsedMessage:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.DynamicMessage.GetMessage",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parsedMessage:h.parsedMessage,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DynamicMessageGetMessageLoggers};return g}function Ai(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={userAction:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.DynamicMessage.UserAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({userAction:h.userAction,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DynamicMessageUserActionLoggers};return g}function _i(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={retryCount:t,dashboardGuid:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.RetryDashboard",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({retryCount:g.retryCount,dashboardGuid:g.dashboardGuid,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardRetryDashboardLoggers};return m}function Ri(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={dashboardCount:t,dashboardGuid:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.PreloadLinkedDashboard",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardCount:g.dashboardCount,dashboardGuid:g.dashboardGuid,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardPreloadLinkedDashboardLoggers};return m}function xi(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={resourcePackageLength:t,compositeTileHasCustomVisual:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.RegisterAndLoadResourcePackages",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({resourcePackageLength:g.resourcePackageLength,compositeTileHasCustomVisual:g.compositeTileHasCustomVisual,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardRegisterAndLoadResourcePackagesLoggers};return m}function Ni(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={pendingRequestCount:t,dashboardGuid:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.LoadDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,parentId:g.parentId},{pendingRequestCount:g.pendingRequestCount,isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardLoadDashboardLoggers};return m}function Li(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={tileIds:t,dashboardGuid:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.RecordDashboardTiles",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({tileIds:g.tileIds,dashboardGuid:g.dashboardGuid,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardRecordDashboardTilesLoggers};return m}function Fi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={resourcePackageLength:t,tileId:i,reportTileHasCustomVisual:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Dashboard.RegisterAndLoadResourcePackagesForReportTiles",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({resourcePackageLength:m.resourcePackageLength,tileId:m.tileId,reportTileHasCustomVisual:m.reportTileHasCustomVisual,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.DashboardRegisterAndLoadResourcePackagesForReportTilesLoggers};return f}function Gi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M,k,P,E,A,_,R){void 0===C&&(C=!1),void 0===D&&(D=void 0),void 0===I&&(I=void 0),void 0===T&&(T=void 0),void 0===M&&(M=void 0),void 0===k&&(k=void 0),void 0===P&&(P=!1),void 0===E&&(E=!1),void 0===A&&(A=void 0),void 0===_&&(_=!1),void 0===R&&(R=!1);var x={navigationStart:t,unloadEventStart:i,unloadEventEnd:o,redirectStart:r,redirectEnd:a,fetchStart:n,domainLookupStart:s,domainLookupEnd:c,connectStart:l,connectEnd:d,requestStart:p,responseStart:u,responseEnd:v,domLoading:h,domInteractive:g,domContentLoadedEventStart:m,domContentLoadedEventEnd:f,domComplete:y,loadEventStart:b,loadEventEnd:S,parentId:w,isError:C,errorSource:D,errorCode:I,errorMessage:T,activityName:M,activityId:k,isDebug:P,isCancelled:E,pingLatency:A,isAppInactive:_,isInCapacity:R},N={name:"PBI.App.LoadPerformanceTiming",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({navigationStart:x.navigationStart,unloadEventStart:x.unloadEventStart,unloadEventEnd:x.unloadEventEnd,redirectStart:x.redirectStart,redirectEnd:x.redirectEnd,fetchStart:x.fetchStart,domainLookupStart:x.domainLookupStart,domainLookupEnd:x.domainLookupEnd,connectStart:x.connectStart,connectEnd:x.connectEnd,requestStart:x.requestStart,responseStart:x.responseStart,responseEnd:x.responseEnd,domLoading:x.domLoading,domInteractive:x.domInteractive,domContentLoadedEventStart:x.domContentLoadedEventStart,domContentLoadedEventEnd:x.domContentLoadedEventEnd,domComplete:x.domComplete,loadEventStart:x.loadEventStart,loadEventEnd:x.loadEventEnd,parentId:x.parentId},{isError:x.isError,errorSource:e.telemetry.ErrorSource[x.errorSource],errorCode:x.errorCode,errorMessage:x.errorMessage,activityName:x.activityName,activityId:x.activityId,isDebug:x.isDebug,isCancelled:x.isCancelled,pingLatency:x.pingLatency,isAppInactive:x.isAppInactive,isInCapacity:x.isInCapacity})},info:x,loggers:e.telemetry.AppLoadPerformanceTimingLoggers};return N}function Oi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C){void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=void 0),void 0===g&&(g=void 0),void 0===m&&(m=void 0),void 0===f&&(f=void 0),void 0===y&&(y=!1),void 0===b&&(b=!1),void 0===S&&(S=void 0),void 0===w&&(w=!1),void 0===C&&(C=!1);var D={url:t,groupGUID:i,requestSize:o,numOfDashboards:r,numOfReports:a,numOfModels:n,numOfWorkbooks:s,numOfFavorites:c,start:l,end:d,parentId:p,isError:u,errorSource:v,errorCode:h,errorMessage:g,activityName:m,activityId:f,isDebug:y,isCancelled:b,pingLatency:S,isAppInactive:w,isInCapacity:C},I={name:"PBI.App.GetAppMetadata",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({url:D.url,groupGUID:D.groupGUID,requestSize:D.requestSize,numOfDashboards:D.numOfDashboards,numOfReports:D.numOfReports,numOfModels:D.numOfModels,numOfWorkbooks:D.numOfWorkbooks,numOfFavorites:D.numOfFavorites,start:D.start,end:D.end,parentId:D.parentId},{isError:D.isError,errorSource:e.telemetry.ErrorSource[D.errorSource],errorCode:D.errorCode,errorMessage:D.errorMessage,activityName:D.activityName,activityId:D.activityId,isDebug:D.isDebug,isCancelled:D.isCancelled,pingLatency:D.pingLatency,isAppInactive:D.isAppInactive,isInCapacity:D.isInCapacity})},info:D,loggers:e.telemetry.AppGetAppMetadataLoggers};return I}function zi(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={start:t,end:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.App.ParseAppMetadata",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({start:g.start,end:g.end,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.AppParseAppMetadataLoggers};return m}function Ui(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={start:t,end:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.App.AngularBootstrap",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({start:g.start,end:g.end,parentId:g.parentId},{isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.AppAngularBootstrapLoggers};return m}function Bi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={fileName:t,start:i,end:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.App.JavaScriptParse",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({fileName:m.fileName,start:m.start,end:m.end,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.AppJavaScriptParseLoggers};return f}function $i(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={artifactKind:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,
activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.ArtifactNotFound",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({artifactKind:h.artifactKind,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ArtifactNotFoundLoggers};return g}function Vi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.CreateReportDialog.Canceled",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.CreateReportDialogCanceledLoggers};return h}function Wi(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={datasetGuid:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.CreateReportDialog.Create",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({datasetGuid:h.datasetGuid,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.CreateReportDialogCreateLoggers};return g}function Hi(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.CreateReportDialog.Import",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.CreateReportDialogImportLoggers};return h}function ji(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.AppModel.InitializeContentProviders",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.AppModelInitializeContentProvidersLoggers};return h}function qi(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={action:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Apps.InstallStoreAppDialog",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({action:e.telemetry.StoreAppInstallAction[h.action],parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.AppsInstallStoreAppDialogLoggers};return g}function Qi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={appGUID:t,contentProviderCategory:i,installSource:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.Apps.InstallApp",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({appGUID:m.appGUID,contentProviderCategory:m.contentProviderCategory,installSource:e.telemetry.InstallSource[m.installSource],parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.AppsInstallAppLoggers};return f}function Ki(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.NPS.ShowDialog",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.NPSShowDialogLoggers};return h}function Ji(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={jobId:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.App.PreemptiveQueryData",time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({jobId:h.jobId,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.AppPreemptiveQueryDataLoggers};return g}function Yi(t,i,o,r,a,n,s,c,l,d,p,u,v){void 0===o&&(o=!1),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=!1),void 0===d&&(d=!1),void 0===p&&(p=void 0),void 0===u&&(u=!1),void 0===v&&(v=!1);var h={visualType:t,parentId:i,isError:o,errorSource:r,errorCode:a,errorMessage:n,activityName:s,activityId:c,isDebug:l,isCancelled:d,pingLatency:p,isAppInactive:u,isInCapacity:v},g={name:"PBI.Dashboard.LoadTileVisualTimedOut",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({visualType:h.visualType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.DashboardLoadTileVisualTimedOutLoggers};return g}function Xi(t,i,o,r,a,n,s,c,l,d,p,u,v,h){void 0===r&&(r=!1),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=!1),void 0===p&&(p=!1),void 0===u&&(u=void 0),void 0===v&&(v=!1),void 0===h&&(h=!1);var g={pendingRequestCount:t,dashboardGuid:i,parentId:o,isError:r,errorSource:a,errorCode:n,errorMessage:s,activityName:c,activityId:l,isDebug:d,isCancelled:p,pingLatency:u,isAppInactive:v,isInCapacity:h},m={name:"PBI.Dashboard.AddDashboard",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({dashboardGuid:g.dashboardGuid,parentId:g.parentId},{pendingRequestCount:g.pendingRequestCount,isError:g.isError,errorSource:e.telemetry.ErrorSource[g.errorSource],errorCode:g.errorCode,errorMessage:g.errorMessage,activityName:g.activityName,activityId:g.activityId,isDebug:g.isDebug,isCancelled:g.isCancelled,pingLatency:g.pingLatency,isAppInactive:g.isAppInactive,isInCapacity:g.isInCapacity})},info:g,loggers:e.telemetry.DashboardAddDashboardLoggers};return m}function Zi(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g){void 0===a&&(a=!1),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1),void 0===v&&(v=void 0),void 0===h&&(h=!1),void 0===g&&(g=!1);var m={artifactType:t,artifactGuid:i,source:o,parentId:r,isError:a,errorSource:n,errorCode:s,errorMessage:c,activityName:l,activityId:d,isDebug:p,isCancelled:u,pingLatency:v,isAppInactive:h,isInCapacity:g},f={name:"PBI.UsageMetrics.ViewUsageMetricsReport",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({artifactType:m.artifactType,artifactGuid:m.artifactGuid,source:m.source,parentId:m.parentId},{isError:m.isError,errorSource:e.telemetry.ErrorSource[m.errorSource],errorCode:m.errorCode,errorMessage:m.errorMessage,activityName:m.activityName,activityId:m.activityId,isDebug:m.isDebug,isCancelled:m.isCancelled,pingLatency:m.pingLatency,isAppInactive:m.isAppInactive,isInCapacity:m.isInCapacity})},info:m,loggers:e.telemetry.UsageMetricsViewUsageMetricsReportLoggers};return f}function eo(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Groups.GetCapacities",category:e.TelemetryCategory.Verbose,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.GroupsGetCapacitiesLoggers};return h}function to(t,i,o,r,a,n,s,c,l,d,p,u){void 0===i&&(i=!1),void 0===o&&(o=void 0),void 0===r&&(r=void 0),void 0===a&&(a=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===c&&(c=!1),void 0===l&&(l=!1),void 0===d&&(d=void 0),void 0===p&&(p=!1),void 0===u&&(u=!1);var v={parentId:t,isError:i,errorSource:o,errorCode:r,errorMessage:a,activityName:n,activityId:s,isDebug:c,isCancelled:l,pingLatency:d,isAppInactive:p,isInCapacity:u},h={name:"PBI.Apps.HideIntroduceAppBar",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:oo.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:v.parentId},{isError:v.isError,errorSource:e.telemetry.ErrorSource[v.errorSource],errorCode:v.errorCode,errorMessage:v.errorMessage,activityName:v.activityName,activityId:v.activityId,isDebug:v.isDebug,isCancelled:v.isCancelled,pingLatency:v.pingLatency,isAppInactive:v.isAppInactive,isInCapacity:v.isInCapacity})},info:v,loggers:e.telemetry.AppsHideIntroduceAppBarLoggers};return h}var io,oo=jsCommon.Utility;!(function(e){e[e.Report=0]="Report",e[e.QnA=1]="QnA",e[e.Url=2]="Url"})(io=t.ContentTypes||(t.ContentTypes={}));var ro;!(function(e){e[e.Report=0]="Report",e[e.QnA=1]="QnA",e[e.Exploration=2]="Exploration",e[e.Dashboard=3]="Dashboard",e[e.Workbook=4]="Workbook",e[e.Insights=5]="Insights",e[e.Widget=6]="Widget"})(ro=t.PinTileSource||(t.PinTileSource={}));var ao;!(function(e){e[e.TitleAlpabetical=0]="TitleAlpabetical",e[e.TitleReverseAlphabetical=1]="TitleReverseAlphabetical",e[e.OwnerAlphabetical=2]="OwnerAlphabetical",e[e.OwnerReverseAlphabetical=3]="OwnerReverseAlphabetical",e[e.LastAccessDate=4]="LastAccessDate",e[e.LastAccessReverseDate=5]="LastAccessReverseDate",e[e.SharedTime=6]="SharedTime",e[e.SharedReverseTime=7]="SharedReverseTime"})(ao=t.SelectSort||(t.SelectSort={}));var no;!(function(e){e[e.Expand=0]="Expand",e[e.Collapse=1]="Collapse"})(no=t.NavPaneToggleAction||(t.NavPaneToggleAction={}));var so;!(function(e){e[e.NavigatorPaneGetDataButton=0]="NavigatorPaneGetDataButton",e[e.NavigatorPaneAddDatasetButton=1]="NavigatorPaneAddDatasetButton"})(so=t.OpenGetDataPageInteraction||(t.OpenGetDataPageInteraction={}));var co;!(function(e){e[e.GetData=0]="GetData",e[e.Welcome=1]="Welcome",e[e.GroupWelcome=2]="GroupWelcome"})(co=t.GetDataSplashState||(t.GetDataSplashState={}));var lo;!(function(e){e[e.NavPane=0]="NavPane",e[e.Breadcrumb=1]="Breadcrumb",e[e.SplashPage=2]="SplashPage",e[e.GetApps=3]="GetApps"})(lo=t.GetDataCategorySelectInteraction||(t.GetDataCategorySelectInteraction={}));var po;!(function(e){e[e.Dashboards=0]="Dashboards",e[e.Reports=1]="Reports",e[e.Datasets=2]="Datasets",e[e.Groups=3]="Groups"})(po=t.NavPaneSection||(t.NavPaneSection={}));var uo;!(function(e){e[e.NavigatorBarManageStorage=0]="NavigatorBarManageStorage",e[e.DirectUrl=1]="DirectUrl"})(uo=t.QuotaOpenManageStorageInteraction||(t.QuotaOpenManageStorageInteraction={}));var vo;!(function(e){e[e.Group=0]="Group",e[e.Personal=1]="Personal"})(vo=t.QuotaOpenManageStorageContext||(t.QuotaOpenManageStorageContext={}));var ho;!(function(e){e[e.NavigatorBarManageStorage=0]="NavigatorBarManageStorage"})(ho=t.OpenUpgradeAccountInteraction||(t.OpenUpgradeAccountInteraction={}));var go;!(function(e){e[e.DeleteOwnedModel=0]="DeleteOwnedModel",e[e.DeleteOwnedWorkbook=1]="DeleteOwnedWorkbook",e[e.RemoveSharedItem=2]="RemoveSharedItem"})(go=t.QuotaDeleteItemType||(t.QuotaDeleteItemType={}));var mo;!(function(e){e[e.Unknown=0]="Unknown",e[e.AddDashboard=1]="AddDashboard",e[e.ShareDashboard=2]="ShareDashboard",e[e.AcceptInvitation=3]="AcceptInvitation",e[e.AddTile=4]="AddTile",e[e.ReportSaveAs=5]="ReportSaveAs",e[e.OpenDataset=6]="OpenDataset",e[e.GetData=7]="GetData",e[e.PublishContentPack=8]="PublishContentPack",e[e.UpdateContentPack=9]="UpdateContentPack",e[e.PersonalizeContentPack=10]="PersonalizeContentPack",e[e.CreateStreamingDataset=11]="CreateStreamingDataset",e[e.AppAutoInstall=12]="AppAutoInstall",e[e.PersonalizeApp=13]="PersonalizeApp"})(mo=t.QuotaCheckOperation||(t.QuotaCheckOperation={}));var fo;!(function(e){e[e.Duplicate=0]="Duplicate",e[e.NoDuplicate=1]="NoDuplicate",e[e.MultipleDuplicates=2]="MultipleDuplicates"})(fo=t.LocalFileUploadPossibility||(t.LocalFileUploadPossibility={}));var yo;!(function(e){e[e.Dashboard=0]="Dashboard",e[e.Report=1]="Report",e[e.AppInstance=2]="AppInstance"})(yo=t.FavoriteType||(t.FavoriteType={}));var bo;!(function(e){e[e.Settings=0]="Settings",e[e.IntroductionModal=1]="IntroductionModal",e[e.IntroductionModalClose=2]="IntroductionModalClose",e[e.PopupMessageDialog=3]="PopupMessageDialog"})(bo=t.From||(t.From={}));var So;!(function(e){e[e.IntroductionModal=0]="IntroductionModal",e[e.HelpModal=1]="HelpModal"})(So=t.ModalFor||(t.ModalFor={}));var wo;!(function(e){e[e.Create=0]="Create",e[e.Delete=1]="Delete",e[e.Update=2]="Update"})(wo=t.CreateUpdateDeleteAction||(t.CreateUpdateDeleteAction={}));var Co;!(function(e){e[e.Create=0]="Create",e[e.Update=1]="Update",e[e.Toggle=2]="Toggle",e[e.Delete=3]="Delete",e[e.Get=4]="Get"})(Co=t.AlertRequestType||(t.AlertRequestType={}));var Do;!(function(e){e[e.Create=0]="Create",e[e.Update=1]="Update",e[e.Toggle=2]="Toggle",e[e.Delete=3]="Delete",e[e.Get=4]="Get"})(Do=t.EmailSubscriptionRequestType||(t.EmailSubscriptionRequestType={}));var Io;!(function(e){e[e.Report=0]="Report",e[e.Dashboard=1]="Dashboard"})(Io=t.UsageMetricsArtifactType||(t.UsageMetricsArtifactType={}));var To;!(function(e){e[e.UnifiedNotificationPane=0]="UnifiedNotificationPane"})(To=t.DataAlertNotificationSource||(t.DataAlertNotificationSource={}));var Mo;!(function(e){e[e.OpenTile=0]="OpenTile"})(Mo=t.DataAlertNotificationAction||(t.DataAlertNotificationAction={}));var ko;!(function(e){e[e.DefaultMobileLayout=0]="DefaultMobileLayout",e[e.OriginalSerialLayout=1]="OriginalSerialLayout"})(ko=t.MobileAuthoringResetType||(t.MobileAuthoringResetType={}));var Po;!(function(e){e[e.OneDriveRefreshEnabled=0]="OneDriveRefreshEnabled",e[e.RefreshNow=1]="RefreshNow",e[e.RLSSettingsPage=2]="RLSSettingsPage",e[e.UploadOverride=3]="UploadOverride"})(Po=t.DisableRLSSource||(t.DisableRLSSource={}));var Eo;!(function(e){e[e.APIPush=0]="APIPush",e[e.PubNub=1]="PubNub"})(Eo=t.StreamingDatasetGalleryOption||(t.StreamingDatasetGalleryOption={}));var Ao;!(function(e){e[e.Dashboard=0]="Dashboard",e[e.OrgApp=1]="OrgApp",e[e.Report=2]="Report",e[e.Workbook=3]="Workbook"})(Ao=t.ContentListArtifactType||(t.ContentListArtifactType={}));var _o;!(function(e){e[e.ContentList=0]="ContentList",e[e.OrgApps=1]="OrgApps",e[e.RecentlyUsed=2]="RecentlyUsed",e[e.Favorites=3]="Favorites"})(_o=t.ContentListArtifactSource||(t.ContentListArtifactSource={}));var Ro;!(function(e){e[e.Normal=0]="Normal",e[e.EmailSubscription=1]="EmailSubscription"})(Ro=t.OpenDashboardSource||(t.OpenDashboardSource={})),t.SettingsSetShowGridlines=i,t.SettingsSetSnapToGrid=o,t.NavigationClickBreadcrumb=r,t.NavigationToggle=a,t.NavigationClickLogo=n,t.ContentListArtifactsCount=s,t.ContentProviderInitializeContentProviders=c,t.DashboardDuplicateDashboard=l,t.BaseDashboardEvent=d,t.BaseDashboardVerboseEvent=p,t.DashboardEvent=u,t.DashboardAddFavorite=v,t.DashboardDeleteFavorite=h,t.DashboardGetFavorites=g,t.DashboardClaimInvitation=m,t.DashboardClaimInvitationRedirectToMobileLandingPage=f,t.DashboardContentProviderPublish=y,t.DashboardContentProviderPublishDSID=b,t.CustomConfigHandlerSharePointDiscover=S,t.DashboardDeleteDashboard=w,t.DashboardDeleteDashboardUser=C,t.DashboardDeleteTile=D,t.DashboardDownloadIOSApp=I,t.DashboardDownloadCompanionApp=T,t.DashboardDownloadExcelPublisher=M,t.DashboardDownloadGateways=k,t.DashboardEditDashboardPermissions=P,t.DashboardTileLayoutChanged=E,t.DashboardInFocusWorkbook=A,t.DashboardReloadWorkbook=_,t.DashboardCalculateWorkbook=R,t.DashboardEditTileProperties=x,t.InFocusModeSaveTileProperties=N,t.DashboardExportDashboard=L,t.BaseAppDashboardEvent=F,t.DashboardOpenDashboard=G,t.DashboardLoadDashboardTileVisual=O,t.DashboardPinTile=z,t.DashboardPinWorkbookTile=U,t.DashboardInitializeContainer=B,t.DashboardInitializeContentProviderConfig=$,t.DashboardInviteDashboardUsers=V,t.DashboardSharingEmailAddressExceededLimit=W,t.DashboardSharingEmailAddressUnsupportedGroup=H,t.DashboardSharingWithInvalidDomain=j,t.DashboardSharingWithBlockedDomain=q,t.DashboardOpenShareDialog=Q,t.DashboardSendShareInvitation=K,t.DashboardRequestDashboardAccess=J,t.DashboardDeleteDashboardAccessRequest=Y,t.DashboardLoadDashboardUsers=X,t.DashboardOpenTile=Z,t.DashboardSettingGroupChanged=ee,t.DashboardForceScheduleRefreshUseITGW=te,t.DashboardRenameDashboard=ie,t.DashboardViewWorkbook=oe,t.DashboardWorkbookEditedInPowerBICausedPinBlock=re,t.DashboardEditWorkbook=ae,t.DashboardWorkbookViewedExternallyDueToAnError=ne,t.DashboardSwitchView=se,t.DashboardUpdateActiveDashboard=ce,t.DashboardRefreshTileData=le,t.DashboardSetHomeDashboard=de,t.DashboardDisableHomeDashboard=pe,t.DashboardRefreshDashboardTiles=ue,t.GroupsSwitchGroup=ve,t.DashboardShowGettingStartedPopup=he,t.BaseDataSetTopLevelCustomerAction=ge,t.DashboardManageDatasetsLanding=me,t.DashboardDatasetClickScheduleRefresh=fe,t.DashboardWorkbookClickScheduleRefresh=ye,t.DashboardDatasetClickRefreshNow=be,t.DashboardWorkbookClickRefreshNow=Se,t.DashboardDatasetClickDelete=we,t.DashboardDatasetClickInsights=Ce,t.DashboardDatasetClickRename=De,t.DashboardClickPersonalize=Ie,t.DashboardDataModelSelected=Te,t.DashboardExpandCollapseNavigatorPane=Me,t.DashboardOpenGetDataPage=ke,t.DashboardExpandCollapseNavigatorPaneSection=Pe,t.DashboardFilterNavigatorPaneItems=Ee,t.DashboardGetGroups=Ae,t.DashboardContentPackPublish=_e,t.DashboardContentPackDirty=Re,t.DashboardDeleteContentPack=xe,t.DashboardDeleteTemplateOrganizationApp=Ne,t.DashboardViewContentPacks=Le,t.DashboardContentPackPersonalize=Fe,t.DashboardFirstUse=Ge,t.DashboardWorkbookPinabilityShown=Oe,t.DashboardGetDataSplash=ze,t.DashboardGetDataSplashIntroVideo=Ue,t.DashboardGetDataCategorySelect=Be,t.DashboardGetDataProviderSelect=$e,t.DashboardGetDataProviderAccordionConnect=Ve,t.DashboardInFocusModeSelected=We,t.DashboardCloseUserAccount=He,t.DashboardSaveDashboardSettings=je,t.DashboardInitializeSettingsDashboardsModel=qe,t.DashboardTestDataSourceConnection=Qe,t.DashboardGetRefreshHistoriesOnRefreshFailures=Ke,t.DashboardLoadTileData=Je,t.DashboardOwnershipFilterSelected=Ye,t.AppInitialAppLoad=Xe,t.GroupEditorCreateGroup=Ze,t.GroupEditorValidateGroupMembers=et,t.GroupEditorGetGroupMembers=tt,t.GroupEditorUpdateGroup=it,t.GroupEditorUserLeaveGroup=ot,t.GroupEditorDeleteGroup=rt,t.GroupEditorValidateGroupId=at,t.QuotaOpenManageStoragePage=nt,t.QuotaStorageUsage=st,t.QuotaManageStorageDelete=ct,t.QuotaExceeded=lt,t.OpenUpgradeAccountPage=dt,t.PrivacyInitializeSettingsModel=pt,t.PrivacySaveSettingsModel=ut,t.SettingsEsriSaveModel=vt,t.SettingsDeleteAllDatasources=ht,t.SettingsTakeoverDatasources=gt,t.PrivacySendPowerBIEmail=mt,t.LocaleIncorrectLocaleSetting=ft,t.LocaleSaveLocaleSetting=yt,t.SettingsLoadSettingsData=bt,t.SettingsEnterFullScreen=St,t.LocalFileContentProviderLocalFileUpload=wt,t.LocalFileContentProviderLocalFileUploadReplace=Ct,t.LocalFileContentProviderLocalFileUploadLiveConnectPbix=Dt,t.PreviewConceptualModel=It,t.PreviewFeaturesIntroductionModalLogged=Tt,t.PreviewFeaturesModalShown=Mt,t.QRCodeQRCodeDialogShown=kt,t.QRCodeShortUrlCreated=Pt,t.QRCodeShortUrlFailed=Et,t.QRCodeQRCodeReportDialogShown=At,t.QRCodeReportShortUrlCreated=_t,t.QRCodeReportShortUrlFailed=Rt,t.ManageEmbedDeleteEmbedCode=xt,t.ManageEmbedLoadAllLiveEmbeddedResources=Nt,t.DashboardAddWidget=Lt,t.DashboardWidgetSelected=Ft,t.DashboardLoadTenantContentPacks=Gt,t.ContentListLoaded=Ot,t.ContentListSelectSort=zt,t.ContentListPersistFilter=Ut,t.MostRecentlyUsedServiceUpdateMRUData=Bt,t.ContentListSearch=$t,t.ContentListOpenArtifact=Vt,t.MarketplaceEmbeddedOpened=Wt,t.MarketplaceEmbeddedClosedWithAppAcquired=Ht,t.MarketplaceEmbeddedClosedWithoutAppAcquired=jt,t.RealTimeEditStreamingDatasetPaneOpened=qt,t.RealTimeStreamingDatasetGalleryPaneOpened=Qt,t.RealTimeStreamingDatasetGalleryOptionSelected=Kt,t.RealTimeStreamingDatasetPushInfoPaneOpened=Jt,t.RealTimeAddUpdateRemoveStreamingDataset=Yt,t.RealTimeGetStreamingDataset=Xt,t.RealTimeGetPubNubCredentials=Zt,t.RealTimeLongPollError=ei,t.RowLevelSecurityDisableRLS=ti,t.DataAlertsOpenAlertsEditor=ii,t.DataAlertsSaveAlerts=oi,t.DataAlertsDeleteAlertAccept=ri,t.DataAlertsDeleteAlertCancel=ai,t.DataAlertsTileBadgeClicked=ni,t.DataAlertsNotificationAction=si,t.DataAlertsRequest=ci,t.DataAlertsOpenAlertsSettings=li,t.DataAlertsAlertsSettingsToggle=di,t.DataAlertsAlertsSettingsEdit=pi,t.DataAlertsAlertsSettingsDelete=ui,t.EmailSubscriptionsSaveSubscription=vi,t.EmailSubscriptionsUpdateSubscription=hi,t.EmailSubscriptionsAddSubscription=gi,t.EmailSubscriptionsDeleteSubscription=mi,t.EmailSubscriptionsOpenEmailSettings=fi,t.EmailSubscriptionsEditEmailSettings=yi,t.EmailSubscriptionsRequest=bi,t.EmailSubscriptionsOpenPane=Si,t.EmailSubscriptionsInertOrUpdateSubscriptions=wi,t.UsageMetricsHttpGetPackage=Ci,t.DashboardLoadDashboardWithScriptVisuals=Di,t.UserNotificationsLoadNotificationPane=Ii,t.UserNotificationsLinkClicked=Ti,t.DashboardUserEnteredPhoneMobileAuthoringMode=Mi,t.DashboardUserDeletedMobileLayout=ki,t.DashboardUserExitsAuthoringModeWithEmptyMobileLayout=Pi,t.DynamicMessageGetMessage=Ei,t.DynamicMessageUserAction=Ai,t.DashboardRetryDashboard=_i,t.DashboardPreloadLinkedDashboard=Ri,t.DashboardRegisterAndLoadResourcePackages=xi,t.DashboardLoadDashboard=Ni,t.DashboardRecordDashboardTiles=Li,t.DashboardRegisterAndLoadResourcePackagesForReportTiles=Fi,t.AppLoadPerformanceTiming=Gi,t.AppGetAppMetadata=Oi;t.AppParseAppMetadata=zi;t.AppAngularBootstrap=Ui,t.AppJavaScriptParse=Bi,t.ArtifactNotFound=$i,t.CreateReportDialogCanceled=Vi,t.CreateReportDialogCreate=Wi,t.CreateReportDialogImport=Hi,t.AppModelInitializeContentProviders=ji;var xo;!(function(e){e[e.Add=0]="Add",e[e.Cancel=1]="Cancel"})(xo=t.StoreAppInstallAction||(t.StoreAppInstallAction={})),t.AppsInstallStoreAppDialog=qi;var No;!(function(e){e[e.AppSource=0]="AppSource",e[e.AppAutoInstallLink=1]="AppAutoInstallLink",e[e.AppArtifactAutoInstallLink=2]="AppArtifactAutoInstallLink"})(No=t.InstallSource||(t.InstallSource={})),t.AppsInstallApp=Qi,t.NPSShowDialog=Ki,t.AppPreemptiveQueryData=Ji,t.DashboardLoadTileVisualTimedOut=Yi,t.DashboardAddDashboard=Xi,t.UsageMetricsViewUsageMetricsReport=Zi,t.GroupsGetCapacities=eo,t.AppsHideIntroduceAppBar=to})(t=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.actualOpenTileEventName="actualOpenTile",e.ambientAnimationTickIntervalMs=5e3,e.analyzeInExcelEventName="analyzeInExcel",e.cancelEditWidgetEventName="cancelEditWidget",e.cancelQrGenerationEventName="cancelQrGeneration",e.configPageErrorLoadingEventName="configPageErrorLoading",e.configPageLoadedEventName="configPageLoaded",e.contentListDashboardsLoadedEvent="contentListDashboardsLoaded",e.contentListDatasetsLoadedEvent="contentListDatasetssLoaded",e.contentListFavoritesLoadedEvent="contentListFavoritesLoaded",e.contentListRecentlyUsedLoadedEvent="contentListRecentlyUsedLoaded",e.contentListReportsLoadedEvent="contentListReportsLoaded",e.contentListWorkbooksLoadedEvent="contentListWorkbooksLoaded",e.contentListPublishedAppsLoadedEvent="contentListPublishedAppsLoaded",e.dashboardContainerLoaded="dashboardContainerLoaded",e.dataSourceAccessInfoGeneratedEventName="dataSourceAccessInfoGenerated",e.datasetShowHistoryDialog="datasetShowHistoryDialog",e.deleteModelEventName="deleteModel",e.deleteReportEventName="deleteReport",e.deregisterTileFromDashboardEventName="deregisterTileFromDashboard",e.enablePowerBIASConnectorApp="asConnectorEnabled",e.enablePowerBICompanionApp="companionEnabled",e.initializeContainerWithActiveDashboardOverride="initializeContainerWithActiveDashboardOverride",e.localFileControllerInitializedEventName="localFileControllerInitialized",e.myWorkSpaceGroupId="me",e.navPaneScrollEventName="navPaneScroll",e.navigateToActiveDashboard="navigateToActiveDashboard",e.notifyDashboardOwnerInfoLoaded="dashboardOwnerInfoLoaded",e.notifyUpdateAllowQnaDataCollectionEventName="notifyUpdateAllowQnaDataCollection",e.openCreateContentPackEventName="openCreateContentPack",e.openModelEventName="openModel",e.openProviderTileEventName="openProviderTile",e.openReportEventName="openReport",e.openTileEventName="openTile",e.personalizeEventName="personalize",e.previewfeaturesModalKey="previewfeaturesModal",e.registerTileToDashboardEventName="registerTileToDashboard",e.removeTileEventName="removeTileFromGroup",e.renameDashboardEventName="renameDashboard",e.renameModelEventName="renameModel",e.reportDeletedEventName="reportDeleted",e.resizeCompletedEventName="resizeCompleted",e.scrollNavPaneToActiveDashboardEventName="scrollNavPaneToActiveDashboard",e.scrollToNavPaneListItemEventName="scrollToNavPaneListItem",e.setDashboardTileOptionsMenuVisibility="setDashboardTileOptionsMenuVisibility",e.shouldShowProviderTilesEventName="shouldShowProviderTiles",e.showConnectionSettingsDialogEventName="showConnectionSettingsDialog",e.showInsightsEventName="showInsights",e.temporaryTilePinned="temporaryTilePinned",e.upadateCarouselEventName="upadateCarousel",e.updateTileHrefEventName="updateTileHref",e.uploadFormatChosenEventName="uploadFormatChosen",e.replaceLocalWorkbookEventName="replaceLocalFile",e.dashboardTileErrorEventName="dashboardTileError",e.tileRefreshStateChangedEventName="tileRefreshStateChanged",e.removeDashboardTileErrorEventName="removeDashboardTileError",e.rowLevelSecurityAccessDeniedEventName="rowLevelSecurityAccessDenied",e.defaultPortraitPrintWidth=673,e.defaultPortraitPrintHeight=860,e.defaultLandscapePrintWidth=940,e.defaultLandscapePrintHeight=578,e.inFocusEnterEvent="inFocusEnter",e.inFocusExitEvent="inFocusExit",e.dashboardTileRepeatFinishedEvent="dashboardTileRepeatFinished",e.dashboardTileLayoutChangeEvent="dashboardTileLayoutChangeEvent",e.notifyDashboardUpdate="notifyDashboardUpdate",e.hideDashboardConnectionsDialogEventName="hideDashboardConnectionsDialog",e.mobileApplication="winApp",e.pvScriptsLoaded="exploreHostLoaded",e.openReportStarting="openReportStarting",e.openReportSucceeded="openReportSucceded",e.openReportFailed="openReportFailed",e.modelFailedGenericServiceError="modelFailedGenericServiceError",e.modelFailedGenericClientError="modelFailedGenericClientError",e.modelFailednoErrorInfo="modelFailednoErrorInfo",e.openDashboardStarting="openDashboardStarting",e.openDashboardSucceeded="openDashboardSucceeded",e.openDashboardFailed="openDashboardFailed",e.openUrlActionName="/openUrl",e.openInFocusTileActionName="/openInFocus",e.openInFocusWorkbookTileActionName="/openInFocusWorkbook",e.openInFocusRealTimeTileActionName="/openInFocusRealTime",e.hideEditorEventName="hideEditor",
e.showTileEditorEventName="showTileEditor",e.hideTileEditorEventName="hideTileEditor",e.showAlertsEditorEventName="showAlertsEditor",e.alertTitleMaxLength=250,e.hideTaskPaneSliderOnClickEventName="hideTaskPaneSliderOnClick",e.refreshTileData="refreshTileData",e.maxDashboardNameLength=30,e.deferredRenderingTileRowThreshold=5,e.deferredRenderingTileColumnThreshold=5,e.openReportFinished="OpenReportFinished",e.samplesContentProviderName="Sample Dashboard",e.tokenRefreshIntervalOffset=27e5,e.biTokenRefreshInterval=23760027e5,e.biTokenRefreshIntervalAfterFailureToGetBIToken=6e4,e.windowParentScope="windowParentScope",e.oauthResponseName="oAuthResponse",e.appLoadErrorGroupNotAccessible="#groupNotAccessible#",e.checkWelcomeStatusInterval=200,e.saveReportFromPinDialog="saveReportFromPinDialog",e.populateDashboardWithReportTiles="populateDashboardWithReportTiles",e.updateFavorites="updateFavorites",e.updateSharedWithMe="updateSharedWithMe",e.showSettingsBlade="showSettingsBlade",e.saveDashboardSettings="saveDashboardSettings",e.insightsDescriptor="insights",e.groupSwitchedEventName="GroupSwitched",e.groupAddedUpdateContextMenuEventName="GroupAddedUpdateContextMenu",e.groupDeletedEventName="GroupDeleted",e.contentPackDirtyShowNotification="contentPackDirty",e.loadDashboardFailed="loadDashboardFailed",e.usageMetrics_Report="Report",e.usageMetrics_Dashboard="Dashboard",e.usageMetrics_NavModel="NavModel";var t;!(function(e){var t;!(function(e){e.landing="landing",e.adminPortal="landing.adminPortal",e.adminPortalCapacities="landing.adminPortal.capacities",e.adminPortalCapacity="landing.adminPortal.capacities.capacity",e.appAutoinstall="landing.autoInstall",e.devTools="landing.devTools",e.home="landing.featureddashboard",e.groups="landing.groups",e.group="landing.groups.group",e.apps="landing.groups.group.apps",e.app="landing.groups.group.apps.app",e.appDashboards="landing.groups.group.apps.app.dashboards",e.appDashboard="landing.groups.group.apps.app.dashboards.dashboard",e.appAlertsEditor="landing.groups.group.apps.app.dashboards.dashboard.alerts",e.appInFocusMode="landing.groups.group.apps.app.dashboards.dashboard.infocus",e.appInFocusInsights="landing.groups.group.apps.app.dashboards.dashboard.insights",e.appDashboardQna="landing.groups.group.apps.app.dashboards.dashboard.qna",e.appDashboardQnaStart="landing.groups.group.apps.app.dashboards.dashboard.qnastart",e.appInsights="landing.groups.group.apps.app.insights",e.appInstances="landing.groups.group.apps.app.instances",e.appInstance="landing.groups.group.apps.app.instances.instance",e.appInstanceDashboards="landing.groups.group.apps.app.instances.instance.dashboards",e.appInstanceDashboard="landing.groups.group.apps.app.instances.instance.dashboards.dashboard",e.appInstanceAlertsEditor="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.alerts",e.appInstanceInFocusMode="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.infocus",e.appInstanceInFocusInsights="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.insights",e.appInstanceDashboardQna="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.qna",e.appInstanceDashboardQnaStart="landing.groups.group.apps.app.instances.instance.dashboards.dashboard.qnastart",e.contentList="landing.groups.group.contentList",e.contentListPivot="landing.groups.group.contentList.pivot",e.dashboards="landing.groups.group.dashboards",e.dashboard="landing.groups.group.dashboards.dashboard",e.dashboardReports="landing.groups.group.dashboards.dashboard.reports",e.dashboardReport="landing.groups.group.dashboards.dashboard.reports.report",e.dashboardReportPage="landing.groups.group.dashboards.dashboard.reports.report.page",e.dashboardWorkbooks="landing.groups.group.dashboards.dashboard.workbooks",e.dashboardWorkbook="landing.groups.group.dashboards.dashboard.workbooks.workbook",e.alertsEditor="landing.groups.group.dashboards.dashboard.alerts",e.inFocusMode="landing.groups.group.dashboards.dashboard.infocus",e.inFocusInsights="landing.groups.group.dashboards.dashboard.insights",e.dashboardQna="landing.groups.group.dashboards.dashboard.qna",e.dashboardQnaStart="landing.groups.group.dashboards.dashboard.qnastart",e.dashboardRequestAccess="landing.groups.group.dashboards.dashboard.requestaccess",e.dashboardShare="landing.groups.group.dashboards.dashboard.share",e.modelQna="landing.groups.group.datasets.dataset.qna",e.extendTrial="landing.groups.group.extendTrial",e.accept2017ProTrial="landing.groups.group.accept2017ProTrial",e.favorites="landing.groups.group.favorites",e.insights="landing.groups.group.insights",e.gateways="landing.groups.group.gateways",e.gateway="landing.groups.group.gateways.gateway",e.dataSource="landing.groups.group.gateways.gateway.dataSource",e.getData="landing.groups.group.getData",e.getDataCategory="landing.groups.group.getData.category",e.getDataCategoryProviderName="landing.groups.group.getData.category.providerName",e.groupWelcome="landing.groups.group.groupWelcome",e.manageEmbed="landing.groups.group.manageEmbed",e.manageStorage="landing.groups.group.manageStorage",e.publishApp="landing.groups.group.publishApp",e.publishContent="landing.groups.group.publishContent",e.recentlyViewed="landing.groups.group.recentlyViewed",e.rowLevelSecurity="landing.groups.group.rowLevelSecurity",e.settings="landing.groups.group.settings",e.settingsGroup="landing.groups.group.settings.settingsGroup",e.settingsId="landing.groups.group.settings.settingsGroup.settingsId",e.sharedWithMe="landing.groups.group.sharedWithMe",e.sharedDashboards="landing.groups.group.sharedWithMe.dashboards",e.sharedDashboard="landing.groups.group.sharedWithMe.dashboards.dashboard",e.sharedAlertsEditor="landing.groups.group.sharedWithMe.dashboards.dashboard.alerts",e.sharedInFocusMode="landing.groups.group.sharedWithMe.dashboards.dashboard.infocus",e.sharedInFocusInsights="landing.groups.group.sharedWithMe.dashboards.dashboard.insights",e.sharedDashboardQna="landing.groups.group.sharedWithMe.dashboards.dashboard.qna",e.sharedDashboardQnaStart="landing.groups.group.sharedWithMe.dashboards.dashboard.qnastart",e.sharedDashboardReports="landing.groups.group.sharedWithMe.dashboards.dashboard.reports",e.sharedDashboardReport="landing.groups.group.sharedWithMe.dashboards.dashboard.reports.report",e.sharedDashboardReportPage="landing.groups.group.sharedWithMe.dashboards.dashboard.reports.report.page",e.sharedDashboardRequestAccess="landing.groups.group.sharedWithMe.dashboards.dashboard.requestaccess",e.sharedDashboardShare="landing.groups.group.sharedWithMe.dashboards.dashboard.share",e.sharedDashboardWorkbooks="landing.groups.group.sharedWithMe.dashboards.dashboard.workbooks",e.sharedDashboardWorkbook="landing.groups.group.sharedWithMe.dashboards.dashboard.workbooks.workbook",e.viewContent="landing.groups.group.viewContent",e.workspaces="landing.workspaces"})(t=e.states||(e.states={})),e.getDataWelcome="welcome"})(t=e.navigation||(e.navigation={})),e.loadDashboardEventName="loadDashboard",e.maximumDashboardBatchSize=5,e.emailsListSeparator="; ",e.streamingDatasetModelPubNub="PubNub",e.defaultBrowserLanguageCode="browserLanguage";var i;!(function(e){e.PowerBIUserQuotaExceeded="PowerBIUserQuotaExceeded",e.PowerBIGroupQuotaExceeded="PowerBIGroupQuotaExceeded"})(i=e.quotaErrorCodes||(e.quotaErrorCodes={}));var o;!(function(e){e.OverwriteNonLocalPackageWithLocalFileError="OverwriteNonLocalPackageWithLocalFileError"})(o=e.FileUploadWarnings||(e.FileUploadWarnings={}));var r;!(function(e){e.ReportWithDisplayNameForTheModelExists="ReportWithDisplayNameForTheModelExists",e.MoreThanOneDuplicateReportFoundError="MoreThanOneDuplicateReportFoundError",e.ReplaceOriginalReportForPowerBICompanionNotSupported="ReplaceOriginalReportForPowerBICompanionNotSupported",e.ModelNotFound="PowerBIModelNotFoundException"})(r=e.pbixUploadWarnings||(e.pbixUploadWarnings={}));var a;!(function(e){e.acquireAppEventName="acquireSaasMarketplaceApp",e.initSaasMarketplaceEventName="initSaasMarketplace",e.updateHostUrl="updateUrlForSaasMarketplaceApp";var t;!(function(e){e.acquireApp="acquireApp",e.externalRedirect="externalRedirect",e.updateUrl="updateUrl",e.closeSaasMarketplace="closeSaasMarketplace",e.finishedLoadingContentProviderList="contentProvidersLoaded"})(t=e.actionTypes||(e.actionTypes={}))})(a=e.saasMarketplace||(e.saasMarketplace={}));var n;!(function(e){e.closeNpsDialog="closeNpsDialog",e.resizeNpsDialog="thankyouNpsDialog",e.renderPath="/render/powerbi/",e.displayPath="/display/powerbi/",e.puidParam="puid",e.languageParam="culture"})(n=e.nps||(e.nps={})),e.DashboardSharingSecurityGroupRequirePro="DashboardInvitationSGRequirePro",e.DashboardInvitationUnsupportedGroup="DashboardInvitationUnsupportedGroup";var s;!(function(e){e.invitationCodeQueryParam="invitationCode",e.invitationCodeQueryParamV2="i",e.invitationClaimed="invitationClaimed"})(s=e.invitation||(e.invitation={}));var c;!(function(e){e.userDismissedAction="dismissed",e.userClickedAction="clicked"})(c=e.dynamicMessaging||(e.dynamicMessaging={})),e.targetValueBlank="_blank",e.downloadPBIDesktopLink="https://go.microsoft.com/fwlink/?LinkID=521920",e.pbiAppsLink="https://go.microsoft.com/fwlink/?linkid=838948",e.refreshHistoryDialogTimeoutValue=9e6,e.configureScheduledRefreshLink="https://go.microsoft.com/fwlink/?linkid=844603";var l;!(function(e){e.skipConfirmationQueryParam="skipConfirmation"})(l=e.appAutoInstall||(e.appAutoInstall={}))})(t=e.constants||(e.constants={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.dataServices.AppUtils,r=e.common.models.ArtifactType,a=e.common.models.CollapsiblePaneExpandedWidth,n=e.common.constants,s=e.common.models,c=e.dataServices.ContractUtils.convertToSemanticQueryWithDataShapeBinding,l=e.dataServices.models.DashboardTileModel,d=e.dataServices.DashboardUtils,p=e.dataServices.constants,u=e.common.DropdownUtils,v=e.dataServices.EwaNamedItemType,h=e.common.dialogs.FeatureNotSupportedDialogBuilder,g=e.dataServices.models.IntraDomainNavigationType,m=e.dataServices.models.IsDashboardIntraDomainPrefix,f=e.dataServices.models.IsReportIntraDomainPrefix,y=e.telemetry.MobileAuthoringResetType,b=e.common.contracts.Permissions,S=jsCommon.StringExtensions,w=e.common.constants.TaskPaneCollapsiblePaneMode,C=e.dataServices.contracts.TilePublishState,D=e.dataServices.contracts.TileType,I='\n    <div class="tileErrors">\n        <div class="errorText" ng-bind="::title"></div>\n        <div ng-repeat="tileError in ::tileErrors" class="tileError">\n            <div class="tileErrorCount">\n                <pbi-icon name="error" size="small"></pbi-icon>\n                <span localize="DashboardAppBar_TileError_ErrorDialogErrorTitle" localize-fragments>\n                    <span fragment-index="0" ng-bind="::tileError.count"></span>\n                </span>\n            </div>\n            <error-details-info error-details="tileError.errorDetails"></error-details-info>\n        </div>\n        <a class="modalErrorHelpLink" target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=690865" localize="TopNav_HelpMenu_GetHelp"></a>\n    </div>\n    ';!(function(e){e[e.Normal=0]="Normal",e[e.NoDashboardsWatermark=1]="NoDashboardsWatermark",e[e.RequestAccess=2]="RequestAccess",e[e.Uninitialized=3]="Uninitialized"})(i=t.DashboardContainerControllerViewState||(t.DashboardContainerControllerViewState={}));var T=(function(){function T(t,i){var o=this;this.scope=t,this.services=i,this.scope.rootScope=i.rootScope,this.scope.refreshState=0,this.notificationIds=[],this.authorOptionsMenu=e.models.modelFactory.createAuthoringDashboardMenuItems(this.services.localizationService),this.initialize(this.services.dashboardService.dashboardContainerModel),this.initialized||(this.unregisterViewModelWatch=this.services.rootScope.$on(e.constants.dashboardContainerLoaded,(function(){o.initialize(o.services.dashboardService.dashboardContainerModel)}))),this.scope.listViewEnabled=function(){return o.services.conceptualModelSetting.isListViewEnabled()},this.scope.groupService=this.services.groupService,this.services.dashboardDataService.registerRefreshStateListener(this)}return T.createOptions=function(){return{additionalServices:["$window","contentProviderHttpService","dashboardHttpService","dashboardService","dashboardStateChangeService","dashboardWarningsService","home","errorService","featureSwitchService","modelConverter","modelMerger","navigation","promiseFactory","reportService","modelService","workbookService","settingsMetadataService","syncService","telemetryService","localizationService","overlayService","visualPlugin","groupService","notificationBar","notificationToast","viralTenantMergeHelperService","modelService","licenseEnforcementService","userInfo","dashboardDataService","fullScreen","inFocusService","permissionService","pinTileService","favorites","gridLayout","dashboardConfigurationService","modalDialogService","auditing","mostRecentlyUsedService","quota","conceptualModelSetting","appService","packageService","taskPaneSliderService","subscription","ownership","usageMetricsReport","pbiLazyLoad","dropdown","navigationHelper","viewRelatedContentService"],scopedDependencies:["explorationCapabilities"],scopedServiceRoot:!0}},T.prototype.initialize=function(t){var o=this;if(!this.initialized&&t){this.viewModel=t;var r=this.services,n=this.scope,s=n.dashboardDataService=r.dashboardDataService;n.showBreadcrumb=0===n.refreshState&&(!r.featureSwitchService.featureSwitches.breadcrumbNavigationEnabled||_.include(r.$window.location.pathname,"invite")),r.navigation.inDashboardView()&&r.dashboardWarningsService.showWarningsIfNeeded();var c=n.permissionService=r.permissionService,l=n.navigation=r.navigation,u=n.fullScreen=r.fullScreen;n.maxDashboardNameLength=e.constants.maxDashboardNameLength,n.shouldShowAuthoringDropDown=function(){var e=o.services.dashboardDataService.activeDashboard;return e&&e.canEdit},n.sharingEnabled=function(){return!c.isActiveWorkspaceIsReadOnly&&s.activeDashboard&&(s.activeDashboard.getPermissions()&b.ReShare)===b.ReShare&&!u.fullScreenMode&&e.common.containsDirective("ShareView")},n.showAddTileButton=function(){return o.isDashboardEditable()&&!u.fullScreenMode},n.showHomeDashboardButton=function(){return!r.dashboardConfigurationService.disableSetFeaturedDashboard&&!l.inAppView()&&r.conceptualModelSetting.isListViewEnabled()},n.showViewRelatedButton=function(){return!r.viewRelatedContentService.disableViewRelated&&!u.fullScreenMode},n.showUsageMetricsButton=function(){var e=o.services.licenseEnforcementService.supportsUsageMetrics();return o.services.featureSwitchService.featureSwitches.usageMetricsEnabled&&e&&o.isDashboardEditable()},n.openUsageMetricsReport=function(){return o.openUsageMetricsReport()},n.showRelatedContentPane=function(){return o.showRelatedContentPane()},n.showTileGalleryPane=function(){return o.showTileGalleryPane()},n.showShareSlider=function(){return o.showShareSlider()},n.showSubscriptionPane=function(){return o.showSubscriptionPane()},n.isEmailSubscriptionEnabled=function(){return o.isEmailSubscriptionEnabled()},n.navigateToContentList=function(){return o.navigateToContentList()},n.shareDashboard=function(e){return r.dashboardService.navigateToShareDashboard(e)},n.personalize=function(){return o.personalize()},this.scope.shouldShowUnpinTiles=function(){return d.containsLayout(1,1,s.activeDashboard)},n.getAdditionalODataFilter=function(){return r.navigation.additionalODataFilter},n.addDashboardFavorite=function(){return o.addDashboardFavorite()},n.deleteDashboardFavorite=function(){return o.deleteDashboardFavorite()},n.setHomeDashboard=function(){return o.setHomeDashboard()},n.unsetHomeDashboard=function(){return o.unsetHomeDashboard()},n.unpinAllTiles=function(){return o.unpinAll()},n.resetTiles=function(){return o.resetTilesClicked()},n.authorMenuSelectedItem=function(){return o.getAuthorMenuSelectedItem()},n.exploreContainerOptions=r.explorationCapabilities.getCapabilities(),n.showQna=function(){return o.showQna()},n.canWrite=function(){return!c.isActiveWorkspaceIsReadOnly},n.isOnHomeDashboard=r.home.isOnHomeDashboard(r.navigation.currentDashboardGUID),this.tileErrorDetails={},n.showDashboardTileErrors=!1,n.dashboardTileErrorCount=0,n.toggleTileError=function(){return o.toggleTileError()},n.showTileErrorDetails=function(){return o.showTileErrorDetails()},n.$watch("dashboardDataService.activeDashboard",(function(t){if(t){o.hideAllNotifications();var i=o.isAppInstanceDashboard(t);if(n.favoriteEnabled=!r.dashboardConfigurationService.disableDashboardFavoriteButton&&!i,n.isOnHomeDashboard=r.home.isOnHomeDashboard(r.navigation.currentDashboardGUID),r.dashboardService.updateDashboardMenuItems(n),o.services.dashboardDataService.updateIsQnaEnabled(),o.updateShouldDisplayQuestionBox(),o.resetDashboardToWebView(t),o.toggleFullScreenByViewState(),o.resetDashboardTileErrors(),t.id>=0){var a=t.contract.originalPackageId,s=o.services.groupService.activeGroup,c=s&&s.aadGroupId,l=t.contract.originalDashboardObjectId;r.mostRecentlyUsedService.updateMRU(e.models.MRUArtifactType.Dashboards,t.objectId,t.displayName,t.getPermissions(),c,l,a),n.activeDashboardId=t.id}o.notifyIfModelRefreshDisabledBySelectiveRefresh()}})),n.showMoreOptionsMenu=function(e){return o.showMoreOptionsMenu(e)},n.showMenu=function(e,t){return o.showMenu(e,t)},n.getAuthoringMenuProperties=function(e){return o.getAuthoringMenuProperties(e)},n.moreOptionsMenuSelected=function(e){return o.onDashboardMenuItemSelected(e)},n.isMoreOptionsMenuAvailable=function(){return _.any(n.moreOptionsMenu)},n.$watchGroup(["fullScreen.fullScreenMode","dashboardDataService.isQnaEnabled || navigation.inQnaView() || navigation.inQnaStartView()","isActive"],(function(e){r.dashboardDataService.activeDashboard&&o.updateShouldDisplayQuestionBox()})),r.licenseEnforcementService.createNotificationForTrial(),r.localizationService.ensureLocalization((function(){var t=r.localizationService;n.newDashboardPlaceholder=t.get("NewDashboard_Placeholder"),n.dashboardReadOnlyText=t.get("DashboardReadOnly_Tooltip"),r.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()&&r.notificationBar.notify({message:r.localizationService.get("ArchivedContent_HeaderMessage"),notificationType:e.common.NotificationBarType.Warning,actions:[{displayText:r.localizationService.get("ArchivedContent_BackToPowerBI"),linkId:1,action:function(){return n.navigation.toggleArchivedContent()}}],secondaryLink:{displayText:r.localizationService.get("LearnMore"),urlString:"https://go.microsoft.com/fwlink/p/?LinkId=522081"}}),n.errorMessageConfig={canEdit:n.canWrite(),mode:!1,titleShared:t.get("Dashboard_NoDashboardsWarningTitle_ReadOnlyMode"),titleNonShared:t.get("Dashboard_NoDashboardsWarningTitle"),contentShared:t.get("Dashboard_NoDashboardsWarningText_ReadOnlyMode"),contentNonShared:t.get("Dashboard_NoDashboardsWarningText")}})),n.getViewState=function(){return r.navigation.inRequestDashboardAccessView()?i.RequestAccess:t.dashboards.length>0?i.Normal:this.initialized?r.conceptualModelSetting.isListViewEnabled()?void 0:i.NoDashboardsWatermark:i.Uninitialized},r.home.onHomeSettingChanged.push((function(){n.isOnHomeDashboard=r.home.isOnHomeDashboard(r.navigation.currentDashboardGUID),r.dashboardService.updateDashboardMenuItems(n),1===o.viewModel.viewMode&&o.imitateMenuItemSelectionByAction(4)})),r.dashboardStateChangeService.registerDashboardContainerScope(n),n.$on(e.constants.actualOpenTileEventName,(function(e,t,i){return o.onActualOpenTile(e,t,i)})),n.$on(e.constants.updateTileHrefEventName,(function(e,t,i){return o.onUpdateTileHref(e,t,i)})),n.$watch("dashboardDataService.activeDashboard.isLoaded",(function(e){e&&r.navigation.inDashboardView()?r.dashboardWarningsService.showWarningsIfNeeded():r.dashboardWarningsService.hideDashboardWarnings()}));var v=r.rootScope,h=v.$on(p.shouldShowEnableCustomVisualsDialog,(function(e){return r.dashboardWarningsService.showWarningsIfNeeded()})),g=v.$on(e.constants.dashboardTileErrorEventName,(function(e,t,i){return o.onDashboardTileError(e,t,i)})),m=v.$on(e.constants.removeDashboardTileErrorEventName,(function(e,t,i){return o.onRemoveDashboardTileError(e,t,i)}));if(n.$on(e.constants.removeTileEventName,(function(e,t){return o.onRemoveTile(e,t)})),n.$on("$destroy",(function(){o.viewModel.viewMode=0,o.toggleFullScreenByViewState(),h(),g(),m(),o.unregisterViewModelWatch&&o.unregisterViewModelWatch(),r.dashboardStateChangeService.unregisterDashboardContainerScope(),r.dashboardDataService.unregisterRefreshStateListener(o),o.hideAllNotifications()})),this.initialized=!0,n.viewModel.dashboards&&0===n.viewModel.dashboards.length&&n.viewModel.contract.reports&&n.viewModel.contract.reports.length>0&&r.permissionService.isActiveWorkspaceIsReadOnly){var f=this.services.reportService.findReportByGUID(n.viewModel.contract.reports[0].objectId);this.services.navigationHelper.navigateToReport(f)}if(l.inSharingView()&&r.timeout((function(){r.dashboardService.navigateToShareDashboard(l.currentDashboardGUID),o.showShareSlider()})),l.inAlertsEditorView()&&r.timeout((function(){var e=n.$watch("dashboardDataService.activeDashboard.isLoaded",(function(t){if(l.inAlertsEditorView()){if(!t)return;var i=o.setAndGetActiveTile();i&&o.services.taskPaneSliderService.expandPane(w.AlertsEditor,a.Small)}e()}))})),l.inInFocusView()||l.inInFocusInsightsView())r.timeout((function(){var e=n.$watch("dashboardDataService.activeDashboard.isLoaded",(function(t){if(l.inInFocusView()||l.inInFocusInsightsView()){if(!t)return;var i=o.setAndGetActiveTile();i&&r.inFocusService.view(i,void 0,l.inInFocusInsightsView())}e()}))}));else if(this.services.navigation.inDashboardSubscription()){var y=s.activeDashboard.contract;this.services.subscription.expandPaneForDashboardSubscription({dashboardId:y.id,dashboardName:y.displayName,dashboardObjectId:y.objectId,modelIds:y.modelIds},this.services.navigation.currentSubscriptionGUID)}}},T.prototype.onStateChange=function(e,t){this.scope.refreshState=e},T.prototype.onAuthoringMenuItemSelected=function(e){var t=this;if(null!=e.action)switch(e.action){case 4:this.selectMenuItem(e);break;case 5:var i=this.services.dashboardDataService.activeDashboard;_.any(i.tiles,(function(e){return e.gridLayouts&&e.hasLayoutDefinition(1)}))?(this.markTilesAsNewIfNeeded(i),this.selectMenuItem(e)):this.getPromiseMessage(n.PhoneVersionMessage).then((function(){t.selectMenuItem(e)}))}},T.prototype.showMenu=function(e,t){var i=this,o=this.services.dropdown,r=function(t,i){t(i),o.hideAll(),e.stopPropagation()},a=t.bind(this)($(e.currentTarget)),n={menuActionSelected:function(e){return r(a.menuActionSelected.bind(i),e)},getMenuActions:function(){return a.menuActions}};o.showMenu(n,a.templateName,a.displayOptions)},T.prototype.showMoreOptionsMenu=function(e){var t=this;u.showLegacyDropdownItems(this.services.dropdown,"moreOptionsMenu",this.scope.moreOptionsMenu,"additionalMenus",(function(e){return t.scope.moreOptionsMenuSelected(e)}),{anchorElement:$(e.target),preferLeft:!0,horizontal:!1})},T.prototype.getAuthoringMenuProperties=function(e){return{displayOptions:{anchorElement:$("#anchorElementForAuthoring"),blurNeeded:!1,disableAnimation:!0,preferLeft:!0},menuActions:this.getAuthoringMenuActions(),menuActionSelected:this.onAuthoringMenuItemSelected,templateName:"appBarAuthoringMenu.html"}},T.showDashboardDoesNotExistDialog=function(t,i,o,r){e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog("ArtifactKind_Dashboard",t,i,o),r.navigateToContentListOrActiveDashboard()},T.showTileDoesNotExistDialog=function(t,i,o){e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog("ArtifactKind_Tile",t,i,o)},T.prototype.updateCurrentViewMode=function(t){var i=this.services.dashboardDataService.activeDashboard;switch(t.action){case 4:var o=_.any(this.scope.moreOptionsMenu,(function(e){return 1===e.action}));o||this.services.dashboardService.updateDashboardMenuItems(this.scope),_.remove(this.scope.moreOptionsMenu,(function(e){return 8===e.action})),this.switchLayoutStrategy(i,new s.DefaultGridLayoutStrategy,0),this.viewModel.viewMode=0;break;case 5:var r=_.any(this.scope.moreOptionsMenu,(function(e){return 8===e.action}));r||this.services.dashboardService.updateDashboardMenuItems(this.scope),_.remove(this.scope.moreOptionsMenu,(function(e){return 1===e.action})),this.raiseEnteredAuthoringModeEvent(i),this.viewModel.dashboardEditMobileDisplay=e.models.modelFactory.createDashboardEditMobileDisplay(i),this.createMobilePositionsIfNeeded(1),this.switchLayoutStrategy(i,new s.DynamicLayoutStrategy,1),this.viewModel.viewMode=1}this.toggleFullScreenByViewState()},T.prototype.unpinAll=function(){var e=this;this.getPromiseMessage(n.UnpinAllTilesMessages).then((function(){e.unpinAllTiles()}))},T.prototype.resetTilesClicked=function(){var e=this;this.getPromiseMessage(n.ResetTilesMessages).then((function(){e.resetTiles()}))},T.prototype.resetPhoneViewClicked=function(){var e=this;this.getPromiseMessage(n.ResetPhoneViewMessages).then((function(){e.resetPhoneView()}))},T.showDialogMessage=function(t,i,o,r){var a=o.defer();return i.ensureLocalization((function(){var o=t.control(),n=i.get(r.confirmButtonMessage),s=i.get(r.titleMessage),c=i.get(r.contentMessage),l=i.get(r.hrefLabel),d=r.hrefLink,p=d&&d.length>0?"inline":"none",u='<section class="duplicateDialog"></section>',v=$('<div class="message" style="display: inline"></div>').text(c),h=$('<a target="_blank"></a>').text(l).attr("href",r.hrefLink).css("display",p),g=$(u).append(v).append(h),m=[new InJs.ModalDialogAction(n,function(e,t){o.hideDialog(),a.resolve("")}),new InJs.ModalDialogAction(e.common.localize.get("ModalDialog_Cancel"),function(e,t){o.hideDialog(),a.reject()})];o.showCustomDialog(s,g,m,null,!0)})),a.promise},T.showDuplicateDashboardDialog=function(t,i,o,r){var a=r.defer();return o.ensureLocalization((function(){var r=i.control(),n=o.get("ModalDialog_Duplicate"),s=o.get("Duplicate_Dashboard"),c=o.get("Dashboard_DuplicateDialogMessage"),l='<section class="duplicateDialog"><div class="message"></div><input type="text" class="dashboardSaveAsName" /></section>',d=$(l);d.find(".message").text(c);var p=d.find(".dashboardSaveAsName");p.val(o.format("Dashboard_DuplicateDialogNameTemplate",[t]));var u=[new InJs.ModalDialogAction(n,function(e,t){var i=S.trimWhitespace(p.val());r.hideDialog(),a.resolve(i)}),new InJs.ModalDialogAction(e.common.localize.get("ModalDialog_Cancel"),function(e,t){r.hideDialog(),a.reject()})];r.showCustomDialog(s,d,u,(function(e){var t=e.parent().find('input[value = "'+n+'"]');p.focus().on("change keyup paste mouseup",(function(e){var i=S.isNullOrUndefinedOrWhiteSpaceString($(e.target).val());t.prop("disabled",i)})).on("keyup",(function(e){13!==e.which||S.isNullOrUndefinedOrWhiteSpaceString($(e.target).val())?27===e.which&&u[1].actionCallback(null,null,null):u[0].actionCallback(null,null,null)}))}),!0)})),a.promise},Object.defineProperty(T.prototype,"contentProviders",{get:function(){return this.services.contentProviderHttpService.getBuiltInContentProviders()},enumerable:!0,configurable:!0}),T.prototype.setAndGetActiveTile=function(){var e=this.services.dashboardDataService.activeDashboard,i=this.getValidTileNavState(e);return i?(this.services.dashboardService.selectDashboardTile(new l(i)),i):void t.DashboardContainerController.showTileDoesNotExistDialog(this.services.errorService,this.services.localizationService,this.services.telemetryService)},T.prototype.getValidTileNavState=function(e){var t=this.services.navigation.currentTileGUID,i=this.services.navigation.currentTileOriginalGUID;return e.findTileByObjectIdOrOriginalObjectId(t,i)},T.prototype.updateShouldDisplayQuestionBox=function(){this.scope.shouldDisplayQuestionBox=!this.scope.fullScreen.fullScreenMode&&(this.scope.dashboardDataService.isQnaEnabled||this.scope.navigation.inQnaView()||this.scope.navigation.inQnaStartView())&&this.scope.isActive},T.prototype.addDashboardFavorite=function(){var e=this.services.dashboardService.getActiveDashboard();e&&(e.isFavorite=!0,e.isFavoriteDisabled=!0,this.services.favorites.addFavorite(e).then((function(t){e.favoriteInfo=t})).finally((function(){e.isFavoriteDisabled=!1})))},T.prototype.deleteDashboardFavorite=function(){var e=this.services.dashboardService.getActiveDashboard();e&&this.services.favorites.deleteFavorite(e)},T.prototype.resetDashboardToWebView=function(e){e&&(e.gridLayoutService||(e.gridLayoutService=this.services.gridLayout),this.switchLayoutStrategy(e,new s.DefaultGridLayoutStrategy,0),this.viewModel.viewMode=0)},T.prototype.isAppInstanceDashboard=function(t){var i=t&&t.getUniquePackageId();if(!i)return!1;var o=this.services.packageService.findPackage(i);return!!o&&o.packageType===e.dataServices.contracts.PackageType.AppInstance},T.prototype.showQna=function(){this.services.navigation.showQnaView()},T.prototype.personalize=function(){this.services.dashboardDataService.activeDashboard.getPermissions()===b.CopyOnWrite&&this.scope.$emit(e.constants.personalizeEventName,this.services.dashboardDataService.activeDashboard.contract.originalPackageId)},T.prototype.onActualOpenTile=function(t,i,o){t&&t.stopPropagation&&t.stopPropagation();var r,a=this.services.telemetryService;i.contractsModel&&(r=i.contractsModel.contentProviderId);var s=e.common.findContentProviderName(this.contentProviders,r),c=a.startEvent(e.telemetry.DashboardOpenTile,null,i.report?i.report.id:i.id,"No error",r,s);switch(i.action.action){case n.openReportActionName:this.openReportTile(i,o,c);break;case e.constants.openUrlActionName:this.openUrlTile(i,c);break;case n.openInsightsActionName:case n.openInFocusActionName:this.services.inFocusService.view(i);break;case n.openWorkbookActionName:this.openWorkbookTile(i,o,c);break;case n.openQnAActionName:this.openQnaTile(i,c)}},T.prototype.onUpdateTileHref=function(e,t,i){return m(i)?void(t.intraDomainNavigationParameters=this.getDashboardNavigationParameters(t,this.getIntraDomainNavigationTargetName(i))):f(i)?void(t.intraDomainNavigationParameters=this.getReportNavigationParameters(t,this.getIntraDomainNavigationTargetName(i))):(t.intraDomainNavigationParameters=void 0,void(t.href=i))},T.prototype.onDashboardTileError=function(e,t,i){e&&e.stopPropagation&&e.stopPropagation();var o=this.services.pinTileService.pinTileScope;if(o&&o.viewModel){var r=o.viewModel;if(r.dashboardTile===t||r.reportTile===t||r.workbookTile===t)return}var a=i.message,n=this.tileErrorDetails[a]?this.tileErrorDetails[a].tileIds:null;n?n.indexOf(t.id)<0&&(n.push(t.id),this.scope.dashboardTileErrorCount++):(this.tileErrorDetails[a]={tileIds:[t.id],errorDetails:i},this.scope.dashboardTileErrorCount++)},T.prototype.onRemoveDashboardTileError=function(e,t,i){e&&e.stopPropagation&&e.stopPropagation();var o=i.message,r=this.tileErrorDetails[o]?this.tileErrorDetails[o].tileIds:null;if(!_.isEmpty(r)){var a=r.indexOf(t.id);a>=0&&(r.splice(a,1),this.scope.dashboardTileErrorCount--,_.isEmpty(r)&&delete this.tileErrorDetails[o])}},T.prototype.getDashboardNavigationParameters=function(e,t){if(e.href=void 0,t){var i=this.services.dashboardService.dashboardContainerModel.visibleDashboards,r=this.services.dashboardDataService.activeDashboard,a=r&&r.getUniquePackageId(),n=r&&o.getDashboardAppGUID(r,this.services.appService,this.services.packageService);n&&(i=_.filter(i,(function(e){return e.getUniquePackageId()===a})));var s=_.filter(i,(function(e){return e.displayName.toLowerCase()===t||e.objectId.toLowerCase()===t||e.contract.originalDashboardObjectId&&e.contract.originalDashboardObjectId.toLowerCase()===t}));if(!_.isEmpty(s)){var c=s[0];s.length>1&&a&&(c=_.find(s,(function(e){return e.getUniquePackageId()===a}))||c);var l=a;return n&&!o.isOrgAppInstance(l,this.services.appService)||(l=null),{navigationTargetGuid:c.objectId,navigationTargetOriginalGuid:c.contract.originalDashboardObjectId,navigationTargetAppGuid:n,navigationType:g.Dashboard,navigationSubPage:null,appInstance:l}}}},T.prototype.getReportNavigationParameters=function(e,t){if(e.href=void 0,t){var i=this.services.reportService.reports,r=this.services.dashboardDataService.activeDashboard,a=r&&o.getDashboardAppGUID(r,this.services.appService,this.services.packageService),n=r&&r.getUniquePackageId();
a&&(i=_.filter(i,(function(e){return e.packageId===n})));var s=_.filter(i,(function(e){return e.displayName.toLowerCase()===t||e.objectId.toLowerCase()===t||e.contract.originalReportObjectId&&e.contract.originalReportObjectId.toLowerCase()===t}));if(!_.isEmpty(s)){var c=s[0];s.length>1&&n&&(c=_.find(s,(function(e){return e.packageId===n}))||c);var l=n;return a&&!o.isOrgAppInstance(l,this.services.appService)||(l=null),{navigationTargetGuid:c.objectId,navigationTargetOriginalGuid:c.contract.originalReportObjectId,navigationTargetAppGuid:a,navigationType:g.Report,navigationSubPage:null,appInstance:l,additionalODataFilter:null}}}},T.prototype.getIntraDomainNavigationTargetName=function(e){var t=e.split("/");return t.length<3?null:decodeURIComponent(t[2]).toLowerCase()},T.prototype.openReportTile=function(t,i,o){if(this.canOpenReport(t)){o.event.info.tileType=e.telemetry.ContentTypes.Report;var r=this.services.dashboardService.findDashboard(i);if(t.report&&t.report.id){var a=void 0,n=void 0;t.action&&(a=t.action.targetSlideId,this.services.featureSwitchService.featureSwitches.usageMetricsEnabled&&this.services.usageMetricsReport.isUsageMetricsContentProvider(t.report.contentProviderId)&&(n=t.action.filter)),t.report.model=t.contractsModel,t.report.packageId=t.contract.packageId;var s=this.services;s.reportService.addReport(t.report),s.modelService.addModel(s.modelConverter.convertModel(t.report.model));var c=r&&r.objectId;s.navigationHelper.navigateToReport(t.report,s.groupService.activeGroupObjectId,a,c,n)}else{var l=r.getPermissions();if(r.isHidden||(l&b.Write)!==b.Write)return;this.services.quota.checkQuotaExceeded()||this.services.permissionService.isActiveWorkspaceIsReadOnly||this.services.navigation.navigateToDatasetByDBName(t.contractsModel.dbName,e.common.contracts.reportServer.ReportInstantiationMode.NonTemplateForExistingTile)}}o.resolve()},T.prototype.canOpenReport=function(e){if(!e.contractsModel){var t=e.contract.modelId,i=this.services.dashboardService.dashboardContainerModel.contract.models;if(!i)return!1;for(var o=i.length,r=0;r<o;r++)i[r].id===t&&(e.contractsModel=i[r])}var a=null!=e.contractsModel&&null!=e.contractsModel.vsName&&null!=e.contractsModel.dbName,n=e.contract.publishState===C.Completed;return a&&n},T.prototype.openUrlTile=function(t,i){if(!t.href&&t.intraDomainNavigationParameters){var o=t.intraDomainNavigationParameters;switch(o.navigationType){case g.Dashboard:o.navigationTargetAppGuid?this.services.navigation.navigateToAppDashboardByGUID(o.navigationTargetGuid,o.navigationTargetOriginalGuid,o.navigationTargetAppGuid,this.services.groupService.activeGroupObjectId,null,!0,o.appInstance):this.services.navigation.navigateToDashboardByGUID(o.navigationTargetGuid);break;case g.Report:this.services.navigation.navigateToReport({appGUID:o.navigationTargetAppGuid,appInstanceId:o.appInstance,reportGUID:o.navigationTargetGuid,reportOriginalGUID:o.navigationTargetOriginalGuid,groupGUID:this.services.groupService.activeGroupObjectId,reportPage:o.navigationSubPage,filter:o.additionalODataFilter})}}i.event.info.tileType=e.telemetry.ContentTypes.Url,i.resolve()},T.prototype.openWorkbookTile=function(e,t,i){var o,r=this.services.workbookService.findWorkbook(e.contract.workbookId,e.contract.packageId),a=this.services.workbookService.getWorkbookUniqueId(r);o=e.contract.$config.workbookTile.itemType===v.NamedRange||e.contract.$config.workbookTile.itemType===v.Table?e.contract.$config.workbookTile.item:e.contract.$config.workbookTile.activeSelection;var n=this.services.ownership.isResourceSharedWithMe(r);this.services.navigation.navigateToWorkbookByUrlId(a,o,n,this.services.navigation.currentDashboardGUID)},T.prototype.openQnaTile=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a,n,s,l,d,p,u=this;return __generator(this,(function(v){switch(v.label){case 0:return i.event.info.tileType=e.telemetry.ContentTypes.QnA,o=t.contract,r=o.query.modelQuery,a=o.$config,n={name:"powerbi.infonav",namespace:"powerbi.explore.infonav",dependency:{javascript:"infonav",css:["infonav"]}},[4,this.services.pbiLazyLoad.load(n)];case 1:if(v.sent(),o.type===D.report)s=a&&a.reportTile,l={modelId:o.modelId,utterance:r.utterance,openTileTelemetryEvent:i,reportPageTile:{reportId:o.reportId,sectionId:o.sectionId,pod:s&&s.pod,filters:s&&s.filters}},this.services.timeout((function(){u.services.rootScope.$emit(e.infonav.constants.openTileEventName,l)}),T.runningQueryDelayMs);else{if(d=c(o.query),p=a.visualContainer.$visualContainer,!e.helpers.VisualQueryUtil.canVisualizeQuery(d.defn,p.filters))return this.services.navigation.showQnaView(t.utterance,0,!1),[2];this.services.timeout((function(){u.services.rootScope.$emit(e.infonav.constants.openTileEventName,{modelId:o.modelId,utterance:r.utterance,openTileTelemetryEvent:i,visualContainer:p})}),T.runningQueryDelayMs)}return this.services.navigation.inQnaView()||this.services.navigation.showQnaView(),[2]}}))}))},T.prototype.onRemoveTile=function(e,t){e&&e.stopPropagation&&e.stopPropagation(),this.services.dashboardWarningsService.showWarningsIfNeeded(),this.removeTileAndUpdateTileErrorCount(t)},T.prototype.onDashboardMenuItemSelected=function(e){if(this.services.overlayService.hideAllDropdowns(),null!=e.action)switch(e.action){case 0:this.duplicateDashboard();break;case 2:this.refreshDashboard();break;case 1:this.printDashboard();break;case 3:this.setHomeDashboard();break;case 7:this.unsetHomeDashboard();break;case 6:var t=this.services.dashboardDataService.activeDashboard.objectId;this.services.settingsMetadataService.setSettings(1,t),this.services.taskPaneSliderService.expandPane(w.SettingsBlade,a.Medium);break;case 8:this.resetPhoneViewClicked()}},T.prototype.getAuthoringMenuActions=function(){return this.authorOptionsMenu},T.prototype.selectMenuItem=function(e){this.uncheckMenuItems(e),this.updateCurrentViewMode(e),e.checked=!0},T.prototype.uncheckMenuItems=function(e){for(var t=0,i=this.scope.moreOptionsMenu;t<i.length;t++){var o=i[t];o.action!==e.action?o.checked=!1:o.checked=!0}for(var r=0,a=this.authorOptionsMenu;r<a.length;r++){var o=a[r];o.action!==e.action?o.checked=!1:o.checked=!0}},T.prototype.toggleFullScreenByViewState=function(){var e=$(".enterFullScreenBtn");e.length>0&&(0===this.viewModel.viewMode?e.show():e.hide())},T.prototype.raiseEnteredAuthoringModeEvent=function(t){var i=!_.any(t.tiles,(function(e){return e.hasLayoutDefinition(1)}));this.services.telemetryService.logEvent(e.telemetry.DashboardUserEnteredPhoneMobileAuthoringMode,t.objectId,i)},T.prototype.markTilesAsNewIfNeeded=function(e){var t=[];t=d.markTilesAsNewIfNeeded(e),t.length>0&&this.applyTileLayoutChanges(e,t)},T.prototype.createMobilePositionsIfNeeded=function(t){var i=this.services.dashboardDataService.activeDashboard,o=_.filter(i.tiles,(function(e){return e.gridLayouts&&e.hasLayoutDefinition(t)}));if(_.isEmpty(o)&&!_.isEmpty(i.tiles)){var r=this.getOrderedDashboardTiles(i),a=e.models.modelFactory.createDefaultPhonePositions(r);this.applyTileLayoutChanges(i,a)}},T.prototype.getOrderedDashboardTiles=function(e){var t=d.orderItems(_.map(e.tiles,(function(e){return{getActiveLayoutPosition:function(){return e.gridLayouts[0].position},getItem:function(){return e}}})));return t},T.prototype.applyTileLayoutChanges=function(t,i){this.scope.$emit(e.common.constants.domLayoutChangedEvent),this.services.dashboardService.batchUpdateTileSizePosition(t,i)},T.prototype.switchLayoutStrategy=function(e,t,i){e.gridLayoutService.strategy=t,e.gridLayoutService.displayLayout=i,this.updateDashboardTilesWithDisplayLayout(e,i)},T.prototype.updateDashboardTilesWithDisplayLayout=function(e,t){if(e&&e.tiles)for(var i=0,o=e.tiles;i<o.length;i++){var r=o[i];r.gridLayoutContext&&r.gridLayoutContext.setActiveLayout(t),r.invalidateLayout()}},T.prototype.duplicateDashboard=function(){var t=this.services.dashboardDataService.activeDashboard,i=this.services,o=i.localizationService;i.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.AddDashboard)||T.showDuplicateDashboardDialog(t.displayName,i.errorService,o,i.promiseFactory).then((function(r){i.dashboardService.duplicateDashboard(t.contract,r).then((function(r){var a=o.get("DuplicateDashboard_Success"),n=o.format("DuplicateDashboard_Success_Details",[t.displayName]);i.notificationToast.notify({title:a,message:n,notificationType:e.common.NotificationToastType.Success})}),(function(){var r=o.get("DuplicateDashboard_Error"),a=o.format("DuplicateDashboard_Error_Details",[t.displayName]);i.notificationToast.notify({title:r,message:a,notificationType:e.common.NotificationToastType.Error})}))}))},T.prototype.setHomeDashboard=function(){this.services.home.setHomeDashboardDialog(this.services.dashboardDataService.activeDashboard,this.services.groupService.activeGroupObjectId)},T.prototype.unsetHomeDashboard=function(){this.services.home.disableHomeDashboard()},T.prototype.printDashboard=function(){this.services.$window.print(),this.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsPrint,e.telemetry.PrintType.Dashboard);var t=this.services.dashboardDataService.activeDashboard;this.services.auditing.auditEvent(t.id,e.common.contracts.AuditEntityType.Dashboard,e.common.contracts.AuditActivityType.printDashboard)},T.prototype.refreshDashboard=function(){var t=this,i=this.services.dashboardDataService.activeDashboard;if(0!==i.tiles.length){var o=this.services.notificationToast.notify({message:this.services.localizationService.get("Dashboard_RefreshStart"),notificationType:e.common.NotificationToastType.Loading}),r=this.createRefreshEvent();this.services.dashboardHttpService.refreshTileData(i.id,null,r.event).then((function(i){t.services.notificationToast.hide(o),t.services.notificationToast.notify({message:t.services.localizationService.get("Dashboard_RefreshCompletedSuccess"),notificationType:e.common.NotificationToastType.Success}),t.services.dashboardService.checkRefreshTileResponse(i.data),r.resolve()}),(function(e){t.services.notificationToast.hide(o),t.services.errorService.error(t.services.localizationService.get("Dashboard_RefreshCompletedFailure"),"Dashboard_RefreshCompletedFailure",{requestId:e.requestId,statusCode:e.status.toString()}),r.reject()}))}},T.prototype.createRefreshEvent=function(){var t=this.services.dashboardDataService.activeDashboard,i=this.services.dashboardService.getVisualCountData(),o=i.scriptVisualsCount,r=i.reportTilesWithR,a=i.totalVisualsCount;return this.services.telemetryService.startEvent(e.telemetry.DashboardRefreshDashboardTiles,t.objectId,a,o,r)},T.prototype.showRelatedContentPane=function(){var e=!this.isDashboardEditable(),t={id:this.services.dashboardDataService.activeDashboard.objectId,artifactType:r.Dashboard,displayName:this.services.dashboardDataService.activeDashboard.displayName,readOnly:e};this.services.taskPaneSliderService.expandPane(w.RelatedContent,a.Default,t)},T.prototype.isDashboardEditable=function(){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&this.services.dashboardDataService.activeDashboard&&this.services.dashboardDataService.activeDashboard.canEdit},T.prototype.showTileGalleryPane=function(){this.services.telemetryService.logEvent(e.telemetry.DashboardAddWidget),this.services.taskPaneSliderService.expandPane(w.TileGallery,a.Large)},T.prototype.showShareSlider=function(){var e=this.services;e.licenseEnforcementService.supportsSharing(!0)&&this.services.taskPaneSliderService.expandPane(w.SharingPane,a.Large)},T.prototype.openUsageMetricsReport=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,o;return __generator(this,(function(r){switch(r.label){case 0:t=this.services.dashboardDataService.activeDashboard,i=this.services.telemetryService.startEvent(e.telemetry.UsageMetricsViewUsageMetricsReport,e.constants.usageMetrics_Dashboard,t.objectId,e.constants.usageMetrics_Dashboard),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.services.usageMetricsReport.openDashboardUsageMetricsReport(t,this.services.groupService.activeGroupObjectId,i)];case 2:return r.sent(),i.resolve(),[3,4];case 3:return o=r.sent(),i.reject(e.errorDetailsHelper.getTelemetryErrorDetails(o.error)),[3,4];case 4:return[2]}}))}))},T.prototype.showSubscriptionPane=function(){var t,i=this,o=_.filter(this.viewModel.dashboards,(function(e){return e.contract.objectId===i.services.navigation.currentDashboardGUID})),r=o[0].contract,a=this.services.dashboardService.findDashboard(r.id);if(_.isEmpty(r.modelIds))return void(t=new h(this.services.modalDialogService).show("ModalDialog_EmailSubscriptionUnSupportedEmptyDashboardTitle","ModalDialog_EmailSubscriptionUnSupportedEmptyDashboardText","https://go.microsoft.com/fwlink/?linkid=845989"));if(a.getPermissions()===e.common.contracts.Permissions.CopyOnWrite)return void(t=new h(this.services.modalDialogService).show("ModalDialog_EmailSubscriptionUnSupportedDashboardContentPackTitle",this.services.featureSwitchService.featureSwitches.appsEnabled?"ModalDialog_DashboardEmailSubscriptionUnSupportedContentPackOrAppMessage":"ModalDialog_DashboardEmailSubscriptionUnSupportedContentPackMessage","https://go.microsoft.com/fwlink/?linkid=836808"));var n={dashboardName:r.displayName,dashboardId:r.id,modelIds:r.modelIds,dashboardObjectId:r.objectId};this.services.subscription.expandPaneForDashboardSubscription(n)},T.prototype.isEmailSubscriptionEnabled=function(){return this.services.featureSwitchService.featureSwitches.dashboardEmailSubscription},T.prototype.navigateToContentList=function(){this.services.navigation.navigateToContentList(this.services.groupService.activeGroupObjectId)},T.prototype.unpinAllTiles=function(){var e=this.services.dashboardDataService.activeDashboard,t=[];this.viewModel.dashboardEditMobileDisplay.dashboardPane.isPaneExpanded=!0;for(var i=this.viewModel.dashboardEditMobileDisplay.mobileDashboard.tiles,o=0,r=i;o<r.length;o++){var a=r[o];a.shouldNewBadgeAppear=!1,t.push(a.removeLayoutPosition(1))}this.applyTileLayoutChanges(e,t)},T.prototype.resetPhoneView=function(){var e=this.removeTilesLayoutDefinition(y.OriginalSerialLayout);this.applyTileLayoutChanges(this.services.dashboardDataService.activeDashboard,e);var t=this.viewModel.dashboardEditMobileDisplay.mobileDashboard.tiles;t.forEach((function(e){return e.invalidateLayout()})),this.imitateMenuItemSelectionByAction(4)},T.prototype.imitateMenuItemSelectionByAction=function(e){var t=_.find(this.authorOptionsMenu,(function(t){return t.action===e}));this.selectMenuItem(t)},T.prototype.resetTiles=function(){this.removeTilesLayoutDefinition(y.DefaultMobileLayout),this.createMobilePositionsIfNeeded(1);var e=this.viewModel.dashboardEditMobileDisplay.mobileDashboard.tiles;e.forEach((function(e){return e.invalidateLayout()}))},T.prototype.getAuthorMenuSelectedItem=function(){var e={text:"",iconClass:""},t=_.find(this.authorOptionsMenu,(function(e){return e.checked}));return t||e},T.prototype.removeTilesLayoutDefinition=function(t){for(var i=[],o=this.viewModel.dashboardEditMobileDisplay.mobileDashboard.tiles,r=0,a=o;r<a.length;r++){var n=a[r];n.shouldNewBadgeAppear=!1,n.hasLayoutDefinition(1)&&i.push(n.removeLayoutDefinition(1,!1))}return this.services.telemetryService.logEvent(e.telemetry.DashboardUserDeletedMobileLayout,this.viewModel.dashboardEditMobileDisplay.mobileDashboard.objectId,t),i},T.prototype.getPromiseMessage=function(e){var t=this.services,i=t.localizationService;return T.showDialogMessage(t.errorService,i,t.promiseFactory,e)},T.prototype.toggleTileError=function(){this.scope.showDashboardTileErrors=!this.scope.showDashboardTileErrors;var e=this.services.dashboardDataService.activeDashboard.tiles;if(this.scope.showDashboardTileErrors)_.forOwn(this.tileErrorDetails,(function(t){for(var i=t.tileIds,o=function(t){var i=_.find(e,(function(e){return e.id===t}));i&&(i.isSelected=!0)},r=0,a=i;r<a.length;r++){var n=a[r];o(n)}}));else for(var t=0,i=this.services.dashboardDataService.activeDashboard.tiles;t<i.length;t++){var o=i[t];o.isSelected=!1}},T.prototype.showTileErrorDetails=function(){var t=this.services.localizationService,i=this.scope.$new(),o=[],r=0;for(var a in this.tileErrorDetails){var n={errorDetails:this.tileErrorDetails[a].errorDetails,count:this.tileErrorDetails[a].tileIds.length};r+=n.count,o.push(n)}i.tileErrors=o,i.title=t.format("DashboardAppBar_TileError_ErrorDialogSubTitle",[e.formattingService.formatValue(r)]),this.services.modalDialogService.showLegacyWebModalDialog({dialogName:t.get("DashboardAppBar_TileError_ErrorDialogTitle"),template:I,scope:i,isDismissable:!0,dialogActions:[new InJs.ModalDialogAction(t.get("PBI_Button_Label_Close"),function(e,t){i.closeDialog()},null,"")]})},T.prototype.updateTileErrorCount=function(){var e=this;this.scope.dashboardTileErrorCount=0,this.tileErrorDetails&&_.forOwn(this.tileErrorDetails,(function(t){var i=t.tileIds;e.scope.dashboardTileErrorCount+=i.length}))},T.prototype.removeTileAndUpdateTileErrorCount=function(e){var t=this;this.tileErrorDetails&&_.forOwn(this.tileErrorDetails,(function(i,o){var r=i.tileIds,a=r.indexOf(e.id);a>=0&&r.splice(a,1),0===r.length&&delete t.tileErrorDetails[o]})),this.updateTileErrorCount()},T.prototype.notifyIfModelRefreshDisabledBySelectiveRefresh=function(){var t=this.services,i=t.dashboardDataService;t.featureSwitchService.featureSwitches.selectiveModelRefresh&&i.isActiveDashboardModelRefreshDisabled()&&this.notificationIds.push(t.notificationBar.notify({message:t.localizationService.get("Notification_InactiveModelRefreshDisabled"),notificationType:e.common.NotificationBarType.Warning,secondaryLink:{displayText:t.localizationService.get("LearnMore"),urlString:e.constants.configureScheduledRefreshLink}}))},T.prototype.hideAllNotifications=function(){for(var e=this.services.notificationBar;!_.isEmpty(this.notificationIds);)e.hide(this.notificationIds.pop());this.notificationIds=[]},T.prototype.resetDashboardTileErrors=function(){this.tileErrorDetails={},this.scope.showDashboardTileErrors=!1,this.scope.dashboardTileErrorCount=0},T})();T.runningQueryDelayMs=100,t.DashboardContainerController=T})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.ArrowPosition,o=e.common.models.TooltipTheme,r=(function(){function e(e,t,i,o,r,a,n,s,c){this.uiSref=e,this.tooltipTemplate=t,this.entity=i,this.stateOptions=o,this.customClass=r,this.beforeIcon=a,this.beforeIconSize=n,this.afterIcon=s,this.afterIconSize=c}return Object.defineProperty(e.prototype,"label",{get:function(){return this.entity.displayName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltipConfig",{get:function(){return{tooltipTitle:this.entity.displayName,tooltipArrowPosition:i.arrowTopMiddle,tooltipTheme:o.Dark}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltipTemplateConfig",{get:function(){return{tooltipTitle:this.createTemplateTooltipTitle(this.entity.displayName),tooltipArrowPosition:i.arrowTopMiddle,tooltipTheme:o.Dark}},enumerable:!0,configurable:!0}),e.prototype.createTemplateTooltipTitle=function(e){return this.tooltipTemplate.replace("{0}",e)},e})();t.BreadcrumbEntity=r})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.contracts.ContentTileType;!(function(e){e[e.Dashboards=0]="Dashboards",e[e.Reports=1]="Reports",e[e.Workbooks=2]="Workbooks",e[e.AppInstance=3]="AppInstance"})(i=t.MRUArtifactType||(t.MRUArtifactType={}));var r=(function(){function e(e,t,i){this.type=e,this.objectId=t,this.workspaceId=i,this.count=0,this.contentTileType=o.MRU}return e.prototype.getPermissions=function(){return this.permissions},e})();t.MRUModel=r})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.constants.navigation.states,o=e.common.constants.navigation.states;t.SimpleBreadcrumbs={firstSegment:[{state:i.adminPortal,labelResourceKey:"AdminPortal_Title"},{state:i.apps,labelResourceKey:"Apps_AppsTitle",icon:"my-apps",terminal:!1},{state:i.favorites,labelResourceKey:"Favorites_FavoritesTitle",icon:"favoritestar"},{state:i.recentlyViewed,labelResourceKey:"RecentlyViewed_NavPaneTitle",icon:"mru"},{state:i.settings,labelResourceKey:"TopNav_Settings"},{state:i.workspaces,labelResourceKey:"NavigationPane_Workspaces",icon:"collections"}],secondSegment:[{state:o.datasets,labelResourceKey:"NavigationPane_DatasetsTitle",strictState:!0},{state:o.streamingDatasets,labelResourceKey:"NavigationPane_DatasetsTitle",strictState:!0},{state:i.getData,labelResourceKey:"NavigationPane_GetData",terminal:!1},{state:i.gateways,labelResourceKey:"EnterpriseGateway_Title"},{state:i.manageStorage,labelResourceKey:"QuotaManagement_ManageStorage"},{state:i.manageEmbed,labelResourceKey:"TopNav_SettingsMenu_ManageEmbedCodes"},{state:i.publishApp,labelResourceKey:"CreateApp_Publish"},{state:i.insights,labelResourceKey:"InsightsPane_InsightsTitle"},{state:i.viewContent,labelResourceKey:"TopNav_SettingsMenu_ViewContentPack"}],thirdSegment:[{state:i.appDashboardQna,labelResourceKey:"SettingsDashboard_QnA_Title"},{state:i.appInFocusMode,labelResourceKey:"InFocus_Title"},{state:i.appInFocusInsights,labelResourceKey:"InsightsPane_InsightsTitle"},{state:i.dashboardQna,labelResourceKey:"SettingsDashboard_QnA_Title"},{state:i.inFocusMode,labelResourceKey:"InFocus_Title"},{state:i.inFocusInsights,labelResourceKey:"InsightsPane_InsightsTitle"},{state:i.sharedDashboardQna,labelResourceKey:"SettingsDashboard_QnA_Title"},{state:i.sharedInFocusMode,labelResourceKey:"InFocus_Title"},{state:i.sharedInFocusInsights,labelResourceKey:"InsightsPane_InsightsTitle"},{state:i.appInsights,labelResourceKey:"InsightsPane_InsightsTitle"}]}})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){function o(e,t,i,o,r,a,n,s,c,l,d,p,u,v,g,m,f,y){return new h(e,t,i,o,r,a,n,s,c,l,d,p,u,v,g,m,f,y)}var r=e.dataServices.AppUtils,a=e.common.ArrowPosition,n=t.BreadcrumbEntity,s=e.common.constants.navigation.states,c=e.dataServices.models.Dashboard,l=e.common.models.Report,d=t.SimpleBreadcrumbs,p=e.constants.navigation.states,u=e.common.models.TooltipTheme,v=e.dataServices.models.Workbook;i.createBreadcrumbFactory=o;var h=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){this.localizationService=e,this.navigationService=t,this.groupService=i,this.dashboardDataService=o,this.homeService=r,this.reportService=a,this.workbookService=n,this.modelService=s,this.permissionService=c,this.userService=l,this.asyncFeatureSwitchService=d,this.promiseFactory=p,this.ownershipService=u,this.appService=v,this.conceptualModelSetting=h,this.dataServiceModelConverter=g,this.packageService=m,this.usageMetricsReport=f,this.tooltipTemplate=this.localizationService.get("Breadcrumb_Tooltip")}return t.prototype.createCurrentBreadcrumbs=function(t){var i=this;t=t||{};var o=[];if(this.addSimpleBreadcrumbs(o,d.firstSegment))return o;if(this.navigationService.inHomeDashboardView())return this.homeService.isHomeDashboardSet?this.dashboardDataService.getDashboards().then((function(){var e=i.homeService.homeDashboard,t=e?i.dashboardDataService.findDashboardByGUID(e.dashboardObjectId):null;t&&o.push(i.createDashboardBreadcrumb(p.home,t))})):o.push(this.createEmptyFeaturedDashboardBreadcrumb()),o;if(this.navigationService.inGroupView()&&!this.navigationService.inAppsView()&&!this.navigationService.inContentListView(!0)){var a=this.promiseFactory.all([this.groupService.ensureGroupsInitialization(),this.dashboardDataService.getDashboards(),this.asyncFeatureSwitchService.getFeatureSwitches()]).then((function(){var e,t=i.dashboardDataService.activeDashboard,o=i.groupService.activeGroup;if(i.isDashboardShared(t))e=i.createSharedWithMeBreadcrumb();else if(o){var r=i.isListViewEnabled()?p.contentList:null;e=new n(r,i.tooltipTemplate,o)}return e}));this.insertBreadcrumbAsync(o,a)}if(this.addSimpleBreadcrumbs(o,d.secondSegment))return o;if(this.navigationService.inAppView()){var c=this.navigationService.currentAppGUID,l=this.navigationService.currentAppInstanceId,a=this.appService.ensureAppsInitialization().then((function(){l||(l=r.getPackageIDByOrgAppGUID(i.appService,i.packageService,c));var e=i.appService.getAppInstance(l);return i.createAppBreadcrumb(e)}));this.insertBreadcrumbAsync(o,a)}if(this.navigationService.inDashboardPath()){var a=this.dashboardDataService.getDashboards().then((function(){var e=i.dashboardDataService.activeDashboard;if(e){var t=p.dashboard;return i.navigationService.inAppInstanceView()?t=p.appInstanceDashboard:i.navigationService.inAppView()?t=p.appDashboard:i.navigationService.inSharedWithMePath()&&(t=p.sharedDashboard),i.createDashboardBreadcrumb(t,e)}}));this.insertBreadcrumbAsync(o,a)}var u=this.navigationService.inReportView();if(u||t.subsituteReportForDataset){var v=this.reportService.getReports().then((function(){var e=t.reportGUID||i.navigationService.currentReportGUID,r=i.reportService.findReport(t.reportId)||i.reportService.findReportByGUID(e)||{id:t.reportId,displayName:t.reportName,objectId:t.reportGUID};if(i.usageMetricsReport.reportBelongsToUsageMetricsContentPack(r)){var a=i.navigationService.additionalODataFilter,c=i.promiseFactory.defer(),l=i.localizationService.get("BreadCrumb_UsageMetrics_Title");return c.resolve(new n(s.report,i.tooltipTemplate,{displayName:l})),i.insertBreadcrumbAsync(o,c.promise),i.usageMetricsReport.getContentTileFromUsageMetricsFilters(a).then((function(e){var t=i.promiseFactory.defer();return t.resolve(i.createUsageMetricsBreadcrumb(e)),t.promise}))}if(r){var d=s.report;return u&&(i.navigationService.inAppInstanceView()?d=s.appInstanceReport:i.navigationService.inAppView()?d=s.appReport:i.navigationService.inSharedWithMePath()&&(d=p.sharedDashboardReport)),v=new n(d,i.tooltipTemplate,r)}}));this.insertBreadcrumbAsync(o,v)}if(this.navigationService.inWorkbookView()){var a=this.workbookService.getWorkbooks().then((function(){var e=i.navigationService.currentWorkbookURLIdentifier,t=i.workbookService.findWorkbookByUniqueId(e),o=s.workbook;if(i.navigationService.inAppView()?o=s.appWorkbook:i.navigationService.inSharedWithMePath()&&(o=p.sharedDashboardWorkbook),t)return new n(o,i.tooltipTemplate,t)}));this.insertBreadcrumbAsync(o,a)}if(this.navigationService.inDatasetView()&&!t.subsituteReportForDataset){var a=this.modelService.modelsPromise.then((function(){var e=i.navigationService.currentDatasetDBName,t=i.modelService.findModelByDBName(e);if(t)return new n(s.dataset,i.tooltipTemplate,t)}));this.insertBreadcrumbAsync(o,a)}if(this.navigationService.inPublishContentPackView()){var h=this.navigationService.contentPack,g=_.isNaN(h)?this.localizationService.get("TopNav_SettingsMenu_CreateContentPack"):this.localizationService.get("Publish_UpdateContentPack");return o.push({uiSref:p.publishContent,label:g,tooltipConfig:this.createCommonTooltipConfig(g),tooltipTemplateConfig:this.createCommonTemplateTooltipConfig(g)}),o}if(this.navigationService.inRowLevelSecurityView()){var g=this.localizationService.get("RowLevelSecurity_Title");return o.push({uiSref:p.rowLevelSecurity,label:g,tooltipConfig:this.createCommonTooltipConfig(g),tooltipTemplateConfig:this.createCommonTemplateTooltipConfig(g)}),o}if(this.addSimpleBreadcrumbs(o,d.thirdSegment))return o;if(this.navigationService.inGetDataCategoryView()){var m=e.controllers.contentProviderStore.contentProviderConstants,f=m.CategoryNameToEnumMap,y=m.categoryEnumToDisplayNameMap,b=y[f[this.navigationService.categoryName]],g=this.localizationService.get(b);o.push({uiSref:p.getDataCategory,label:g,tooltipConfig:this.createCommonTooltipConfig(g),tooltipTemplateConfig:this.createCommonTemplateTooltipConfig(g)})}if(this.navigationService.inGetDataCategoryProviderView()){var S=e.common.contracts.contentProviderManifest,w=_.find(S,{providerName:this.navigationService.providerName});if(w){var g=w.displayText;w.displayTextLocalizationKey&&(g=this.localizationService.get(w.displayTextLocalizationKey)),o.push({uiSref:p.getDataCategoryProviderName,label:g,tooltipConfig:this.createCommonTooltipConfig(g),tooltipTemplateConfig:this.createCommonTemplateTooltipConfig(g)})}}return o},t.prototype.createDashboardBreadcrumb=function(e,t){var i=!t.canEdit||this.permissionService.isActiveWorkspaceIsReadOnly?"lock":void 0;return new n(e,this.tooltipTemplate,t,(void 0),"dashboard",(void 0),(void 0),i,"mini")},t.prototype.createEmptyFeaturedDashboardBreadcrumb=function(){return this.createSimpleBreadcrumb(p.home,"NavigationPane_FeaturedDashboardTitle",null,"gauge")},t.prototype.createSharedWithMeBreadcrumb=function(){return this.createSimpleBreadcrumb(p.sharedWithMe,"NavigationPane_SharedWithMeTitle",null,"shared")},t.prototype.createAppBreadcrumb=function(e){var t,i=r.getDefaultAppArtefact(e),o=r.isOrgApp(e.providerContract);if(i)if(i instanceof c){var a=o?p.appDashboard:p.appInstanceDashboard;t=a+"({dashboardGUID:'"+i.objectId+"',dashboardOriginalGUID:'"+i.contract.originalDashboardObjectId+"'})"}else if(i instanceof l){var a=o?s.appReport:s.appInstanceReport;t=a+"({reportGUID:'"+i.objectId+"',reportOriginalGUID:'"+i.contract.originalReportObjectId+"'})"}else i instanceof v&&(t=s.appWorkbook+"({workbookURLIdentifier:'"+i.uniqueId+"'})");else t=o?p.app:p.appInstance;return new n(t,this.tooltipTemplate,e,(void 0))},t.prototype.createUsageMetricsBreadcrumb=function(e){if(e instanceof c)return new n(p.dashboard+"({dashboardGUID:'"+e.objectId+"',filter:''})",this.tooltipTemplate,e);if(e instanceof l){var t=s.report+"({reportGUID:'"+e.objectId+"',filter:''})";return new n(t,this.tooltipTemplate,e)}},t.prototype.insertBreadcrumbAsync=function(e,t){var i=e.length;e.push({label:null}),t.then((function(t){t&&(e[i]=t)}))},t.prototype.addSimpleBreadcrumbs=function(e,t){for(var i=0,o=t;i<o.length;i++){var r=o[i],a=r.strictState?this.navigationService.stateService.is(r.state):this.navigationService.stateService.includes(r.state);if(a){e.push(this.createSimpleBreadcrumb(r.state,r.labelResourceKey,r.customClass,r.icon));var n=angular.isUndefined(r.terminal)||r.terminal;if(n)return!0}}return!1},t.prototype.createSimpleBreadcrumb=function(e,t,i,o){var r=this.localizationService.get(t);return{uiSref:e,label:r,customClass:i,beforeIcon:o,beforeIconSize:"small",tooltipConfig:this.createCommonTooltipConfig(r),tooltipTemplateConfig:this.createCommonTemplateTooltipConfig(r)}},t.prototype.createCommonTooltipConfig=function(e){return{tooltipTitle:e,tooltipArrowPosition:a.arrowTopMiddle,tooltipTheme:u.Dark}},t.prototype.createCommonTemplateTooltipConfig=function(e){return{tooltipTitle:this.createTemplateTooltipTitle(e),tooltipArrowPosition:a.arrowTopMiddle,tooltipTheme:u.Dark}},t.prototype.createTemplateTooltipTitle=function(e){return this.tooltipTemplate.replace("{0}",e)},t.prototype.isListViewEnabled=function(){return this.conceptualModelSetting.isListViewEnabled()},t.prototype.isDashboardShared=function(e){return this.isListViewEnabled()&&(this.navigationService.inSharedWithMePath()||e&&this.navigationService.inDashboardPath()&&this.ownershipService.isResourceSharedWithMe(e))},t})()})(i=t.factory||(t.factory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t){switch(e){case 0:return i(t)}}function i(e){var t={items:[{type:2,text:e.get("FeedbackContextMenu_Title")},{type:0,text:e.get("FeedbackContextMenu_SubmitIdea"),href:"https://go.microsoft.com/fwlink/?linkid=833533"},{type:0,text:e.get("FeedbackContextMenu_SubmitIssue"),href:"https://go.microsoft.com/fwlink/?linkid=833535"}]};return t}e.createMenuItems=t})(t=e.NavigationBarMenuFactory||(e.NavigationBarMenuFactory={}))})(t=e.factory||(e.factory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.contracts.StorageProviderType,r=e.common.PowerBIErrorHeader;!(function(i){function a(e,t){if(e){var o=e.headers(r);if(o){if(o===i.ImageTypeNotAllowed)return{errorType:0,errorMessage:t.get("PublishContentPack_ImageTypeNotAllowed")};if(o===i.InvalidImageFormat)return{
errorType:0,errorMessage:t.get("PublishContentPack_InvalidImageFormat")};if(o.indexOf(i.TemplatePublishErrorPrefix)>=0)return{errorType:1,errorMessage:t.get("PublishContentPack_"+o)}}return h(e.error,t)}}function n(e){return!e||0===e.length}function s(e){return e&&e.length<=this.TitleSizeLimit}function c(e){return!e||0===e.length}function l(e){return e&&!t.ReportUtility.IsReportSavedAsExploration(e.contract)}function d(e,t){var i=t.findPackage(e.contract.packageId);return i&&i.contract.storageProviderType===o.Local}function p(e,t){e.publishedTo=t.publishedTo,e.listOfGroupPrincipals=t.listOfGroupPrincipals,e.isSharedToEntireOrg=t.isSharedToEntireOrg,e.providerId=t.providerId,e.displayText=t.displayText,e.iconUrl=t.iconUrl,e.description=t.description,e.publishTime=t.publishTime,e.author=t.author,e.category=t.category,e.allowCopyContent=t.allowCopyContent,e.dashboardIds=t.dashboardIds.slice(),e.reportIds=t.reportIds.slice(),e.modelIds=t.modelIds.slice(),e.workbookIds=t.workbookIds.slice()}function u(t,i,o,r,a,n,s){if(!_.isEmpty(r))return!1;if(!s||"undefined"==typeof s)return!1;if(!o||1!==o.length)return!1;if(!t||1!==t.length)return!1;if(!i||i.length<1)return!1;var c=t[0],l=c.contract.modelIds;if(!l||l.length<1||l.length>1)return!1;for(var d=!1,p=0,u=l;p<u.length;p++){var v=u[p],h=a.findModel(v),g=n.findPackage(h.contract.packageId);if(!g||!g.contentProviderId||g.contentProviderId!==e.common.constants.pbiDesktopContentProviderId)return!1;for(var m=s.datasetModels,f=0,y=m;f<y.length;f++){var b=y[f];if(b.id===v){d=!0;for(var S=0,w=b.refreshConnections;S<w.length;S++){var C=w[S];if(!C.isDMValidated&&(C.onpremGatewayRequired||_.isEmpty(C.connectionString)||C.connectionString.indexOf("Microsoft.Mashup")<0))return!1}}}}return d}function v(e,t,i){var o=_.union.apply(_,_.map(t,(function(e){return e.contract.modelIds}))),r=_.map(i,(function(e){return e.contract.modelId})),a=_.union(o,r);return _.filter(e,(function(e){return _.contains(a,e.id)}))}function h(e,t){if(e&&(e.code===i.GroupsErrorCode||e.code===i.ServicePlanErrorCode)&&e["pbi.error"].parameters[0]&&(e["pbi.error"].parameters[0].Key===i.GroupsErrorKey||e["pbi.error"].parameters[0].Key===i.ServicePlanErrorKey)){var o=e["pbi.error"].parameters[0].Value.split("[")[1].split("]")[0],r=void 0;if(o){var a=o.split(","),n=a.join("; ");r=e.code===i.GroupsErrorCode?t.format("PublishContentPack_InvalidGroupAddresses",[n]):t.format("PublishContentPack_ServicePlanInvalid",[n])}else r=t.get("PublishContentPack_GroupsValidationFailed");return{errorMessage:r,errorType:2}}}i.ImageTypeNotAllowed="ImageTypeNotAllowed",i.InvalidImageFormat="InvalidImageFormat",i.GroupsErrorCode="GroupOrPrincipalValidationFailed",i.GroupsErrorKey="FailedGroupOrPrincipals",i.ServicePlanErrorCode="PrincipalDoesNotHaveKnownOrValidServicePlan",i.ServicePlanErrorKey="FailedPrincipals",i.TemplatePublishErrorPrefix="TemplatePublishError_",i.DescriptionSizeLimit=2e3,i.TitleSizeLimit=200,i.ImageSizeLimit=65e3,i.getPublishErrorFromResult=a,i.isTitleEmpty=n,i.isTitleValid=s,i.isDescriptionEmpty=c,i.isLegacyReport=l,i.isLocalWorkbook=d,i.updateContentPack=p,i.isTemplatingAllowed=u,i.getUsedDatasets=v})(i=t.ContentPackAuthoringHelper||(t.ContentPackAuthoringHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.constants.myWorkspaceGroupId;e.dataServices.models.Workbook;!(function(e){function i(e){return t.RedirectUrlHelper.WebRedirectUrlHelper.getAppRedirectUrl(o,e)}function r(e,i){return t.RedirectUrlHelper.WebRedirectUrlHelper.getDashboardRedirectUrl(o,e.objectId,i.objectId)}function a(e,i){return t.RedirectUrlHelper.WebRedirectUrlHelper.getReportRedirectUrl(o,e.objectId,i.objectId)}function n(e,i){return t.RedirectUrlHelper.WebRedirectUrlHelper.getWorkbookRedirectUrl(o,e.objectId,i.uniqueId)}e.getAppUrl=i,e.getPublishedAppDashboardUrl=r,e.getPublishedAppReportUrl=a,e.getPublishedAppWorkbookUrl=n})(i=t.UrlHelper||(t.UrlHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants.myWorkspaceGroupId,o=jsCommon.StringExtensions,r=(function(){function t(e){this.redirectPath=e}return t.prototype.getAppRedirectUrl=function(e,t,i){var o={action:"OpenApp",groupObjectId:e,context:i,appId:t};return this.getRedirectUrl(o)},t.prototype.getDashboardRedirectUrl=function(e,t,i,o){var r={action:"OpenDashboard",context:o,groupObjectId:e,appId:t,dashboardObjectId:i};return this.getRedirectUrl(r)},t.prototype.getReportRedirectUrl=function(e,t,i,o,r){var a={action:"OpenReport",context:r,groupObjectId:e,appId:t,reportObjectId:i};return _.isEmpty(o)||(a.reportPage=o),this.getRedirectUrl(a)},t.prototype.getWorkbookRedirectUrl=function(e,t,i,o){var r={action:"OpenWorkbook",context:o,groupObjectId:e,appId:t,workbookUniqueId:i};return this.getRedirectUrl(r)},t.prototype.getTileRedirectUrl=function(e,t,i,o,r){var a={action:"OpenTile",context:r,groupObjectId:e,appId:t,dashboardObjectId:i,tileObjectId:o};return this.getRedirectUrl(a)},t.prototype.getRedirectUrl=function(t){var r=[];return(_.isEmpty(t.groupObjectId)||t.groupObjectId===i)&&r.push("groupObjectId"),_.isEmpty(t.appId)&&r.push("appId"),_.isEmpty(t.context)&&r.push("context"),r.length>0&&(t=_.omit(t,r)),o.format("{0}/{1}?{2}",e.common.httpService.frontendUri,this.redirectPath,$.param(t))},t})();r.WebRedirectUrlHelper=new r("Redirect"),r.MobileRedirectUrlHelper=new r("MobileRedirect.html"),t.RedirectUrlHelper=r})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.contracts.ContentProviderClientCategory;!(function(t){function i(t,i,o){if(t){var r=e.common.KnownContentProviderErrors[i],a=r&&r[t];if(a)return s(a,o)}}function r(e,t,i){return e.isImportOperation!==!1?t&&i.isAppCategory(t.category)?2:0:1}function a(t,i,o,r,a,n,p){var u,v=c(t,i);a.ensureLocalization((function(){if(v){var c=s(v,n),h=v.titleId||"ErrorMessage_DefaultTitle";u={message:a.get(c),title:a.get(h),errorType:c,helpLink:v.helpLink||d(i),helperText:v.helperTextId?a.get(v.helperTextId):null},l(t,u,p)}else{var g,m,f=void 0,y=e.models.contentProviderHelpLink[i]||d(i);switch(r){case 2:g="ErrorMessage_FailedToInstallApp",m=a.format("ErrorTitle_FailedToInstallApp",[o]);break;case 0:g="ErrorMessage_FailedToStorePackage",m=a.format("ErrorTitle_FailedToStorePackage",[o]);break;case 1:g="ErrorMessage_FailedToConnectWorkbook",m=a.format("ErrorTitle_FailedToConnectWorkbook",[o])}if(t.error)f=e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(t.error);else{var b=$.Deferred();b.resolve(null),f=b.promise()}f.then((function(i){u={message:i&&i.message?i.message:a.get(g),title:m,errorType:e.common.contentProviderDefaultErrorType,displayableErrorInfo:i?i.displayableErrorInfo:null,helpLink:y},l(t,u,p)}))}}))}function n(t,i,r,a,n,s,c){t!==o.Service&&t!==o.Organizational||s.$emit(e.constants.saasMarketplace.initSaasMarketplaceEventName,c);var l=e.controllers.contentProviderStore.contentProviderConstants.categoryEnumToNameMap[t],d=e.controllers.contentProviderStore.contentProviderConstants.categoryInteractionTelemetryMap[i];a.logEvent(e.telemetry.DashboardGetDataCategorySelect,l,d,this.previousSelectedCategoryName),n.showGetDataSlider(l,"",r,c)}function s(e,t){var i=e.messageId;return e.messageIdOverride&&t.featureSwitches[e.messageIdOverride.featureSwitch]&&(i=e.messageIdOverride.messageId),i}function c(t,i){if(t){var o=e.common.KnownContentProviderErrors[i];if(o){var r=t.headers(e.common.PowerBIErrorDetailsHeader);if(r){var a=u.tryParseJSON(r),n=a&&a.error&&a.error.code;return n?o[n]:void 0}}}}function l(t,i,o){o.error(i.message,i.errorType,{requestId:t?t.requestId:void 0,statusCode:t?t.status.toString():void 0,title:i.title,displayLearnMoreHelpLink:null!=i.helpLink,helpLink:i.helpLink,customErrorDialogHelperText:i.helperText,displayableErrorInfo:i.displayableErrorInfo,showAdditionalErrorInfo:null!=i.displayableErrorInfo},null,e.telemetry.ErrorSource.PowerBI)}function d(t){return t===p.excelContentProviderId?e.models.excelWorkbookUploadFailedDefaultHelpLink:e.models.contentProviderFallbackLink}var p=e.common.constants,u=jsCommon.JsonExtensions;t.getErrorMessageId=i,t.getStoreOperationType=r,t.handleStoreConfigurationError=a,t.navigateToCategoryAndProviderHelper=n})(i=t.ContentProviderStoreHelper||(t.ContentProviderStoreHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.contracts.ContentTileType,r=e.dataServices.models.Dashboard,a=e.common.models.Model,n=e.models.MRUModel,s=e.common.contracts.PublishOrRefreshStatus,c=e.common.models.Report,l=e.dataServices.models.Workbook;!(function(t){function i(e,t,i,r,a){if(e.contentTileType!==o.AppDataset){var n=d(e,t);i.openContent(e,n,r,a)}}function d(t,i){var r=t.workspaceId;return r||(r=t.contentTileType===o.Favorite?e.constants.myWorkSpaceGroupId:i.activeGroupObjectId),r}function p(e){var t=e.contentTileType;if(t!==o.AppDataset)return e instanceof l?e.uniqueId:e.objectId}function u(e){return e instanceof r?e.contract&&e.contract.originalDashboardObjectId:e instanceof c?e.contract&&e.contract.originalReportObjectId:e instanceof n?e.originalGUID:e.contentTileType===o.Favorite?e.originalObjectId:void 0}function v(e){if(e.contentTileType===o.OrgApp)return e.packageId;if(e instanceof r)return e.contract&&e.contract.originalPackageId;if(e instanceof c)return e.packageId;if(e instanceof l)return e.packageId;if(e instanceof n)return e.packageid;if(e instanceof a)return e.packageId;if(e.contentTileType===o.Favorite){var t=e;if(w(t)===o.OrgApp)return t.favoriteId}}function h(e,t){return e instanceof a?e.isNew&&e.contract.packagePublishStatus!==s.PublishError&&e.contract.packagePublishStatus!==s.RefreshError&&!y(e,t):e.isNew}function g(e,i){return!!e&&(b(e)===o.Dashboard&&i.isFavoriteDisabled(t.getObjectID(e)))}function m(e,t){var i=b(e);return!!f(i)&&(!t||!t.isListViewEnabled())}function f(e){return e===o.Dashboard}function y(e,t){if(e instanceof a){var i=t.findModel(e.contract.id,e.contract.packageId);return!!i&&i.isRefreshInProgress}return!1}function b(t){var i=t.contentTileType;if(i===o.MRU&&t instanceof e.models.MRUModel)i=S(t);else if(i===o.Favorite){var r=t;i=w(r)}return i}function S(t){switch(t.type){case e.models.MRUArtifactType.Dashboards:return o.Dashboard;case e.models.MRUArtifactType.Reports:return o.Report;case e.models.MRUArtifactType.Workbooks:return o.Workbook;case e.models.MRUArtifactType.AppInstance:return o.OrgApp}}function w(e){switch(e.favoriteType){case 1:return o.Dashboard;case 3:return o.OrgApp}}function C(i,r,a,n,s){var c,l=t.getActualType(i),d=p(i);switch(l){case o.Dashboard:c=r.findDashboardByGUID(d);break;case o.Report:c=a.findReportByGUID(d);break;case o.Workbook:c=n.findWorkbookByUniqueId(d);break;case o.OrgApp:if(i instanceof e.models.MRUModel){var u=i.packageid;c=s.getAppInstance(u)}}return c||i}function D(t,i){if(t instanceof e.dataServices.models.Dashboard)return t.id;if(t.contentTileType===o.OrgApp)return t.packageId;if(t.contentTileType===o.Favorite)return t.favoriteId;if(t instanceof n){var r=S(t);if(r===o.Dashboard){var a=i.findDashboardByGUID(t.objectId);return a&&a.id}if(r===o.OrgApp)return t.packageid}}function I(e){return T(e,e.contentTileType)}function T(e,t){switch(t){case o.Favorite:return e.favoriteType;case o.Dashboard:return 1;case o.OrgApp:return 3;case o.MRU:var i=S(e);return T(e,i)}}t.openContentTile=i,t.getGroupId=d,t.getObjectID=p,t.getOriginalObjectID=u,t.getPackageId=v,t.isNew=h,t.isFavoriteDisabled=g,t.isFavoritableContent=m,t.isFavoritableContentType=f,t.getActualType=b,t.getMRUActualType=S,t.getFavoriteActualType=w,t.getMRUOriginalContentTile=C,t.getFavoriteId=D,t.getContentFavoriteType=I})(i=t.ContentTileHelper||(t.ContentTileHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){function i(e,t,i,r,a,s,d,u,v,h){var g=c(a),m=l(g,v,h,s);return{automaticallyImport:!0,sandboxProperties:[p.AllowSameOrigin,p.AllowPopups,p.AllowScripts],providers:{blocker:g,validator:m},visualTypeOptions:n(),registerVisualConsentOptions:o(e,t,i,r,d,u)}}function o(e,t,i,o,r,a){return{consentDialogProvider:d(e,t,i,o),consentPersistencyProvider:s(r,a)}}function r(t,i){return{automaticallyImport:!0,sandboxProperties:[p.AllowSameOrigin,p.AllowPopups,p.AllowScripts],providers:{blocker:{blockedInCluster:_.noopTrue,blockedInTenant:_.noopTrue},validator:{getErrorDetails:function(){return{message:i.get("VisualContainer_EsriNotSupportedInEmbed"),errorType:1,displayableErrorInfo:[],helpLink:e.models.EsriLearnMoreUrl}}}},visualTypeOptions:n(),registerVisualConsentOptions:{consentDialogProvider:{showConsentDialog:function(){return t.reject("Esri is not supported in Embedded scenario.")}},consentPersistencyProvider:{loadConsent:function(){return t.reject("Esri is not supported in Embedded scenario.")},saveConsent:function(e){return t.reject("Esri is not supported in Embedded scenario.")}}}}}function a(e,t,i,o,r,a,d){var u=c(t),v=l(u,o,r,i);return{automaticallyImport:!0,sandboxProperties:[p.AllowSameOrigin,p.AllowPopups,p.AllowScripts],providers:{blocker:u,validator:v},visualTypeOptions:n(),registerVisualConsentOptions:{consentDialogProvider:{showConsentDialog:function(){return e.reject("Esri consent dialog is not supported in Mobile scenario.")}},consentPersistencyProvider:s(a,d)}}}function n(){return{class:e.visualHost.EsriVisual,titleKey:"EsriVisual_ToolTip",watermarkKey:"map"}}function s(t,i){return{loadConsent:function(){return t.getUserSettings().then((function(e){return!!e&&e.esriVisualEnabled}))},saveConsent:function(o){var r=i.startEvent(e.telemetry.SettingsEsriSaveModel,o);return t.updateEsriSetting(o,r).then((function(){return t.refreshUserSettings(),r.resolve(),o}))}}}function c(e){return{blockedInCluster:function(){return!e.featureSwitches.esriEnabled},blockedInTenant:function(){return!e.featureSwitches.esriVisualEnabled}}}function l(t,i,o,r){return{getErrorDetails:function(){var i;if(t.blockedInTenant()?i="SettingsEsri_OrganizationHasDisabled":o.hasConsent(e.visualHost.EsriVisual)||(i="VisualContainer_EsriNotConsented"),i)return{message:r.get(i),errorType:1,displayableErrorInfo:[],helpLink:e.models.EsriLearnMoreUrl}}}}function d(t,i,o,r){return{showConsentDialog:function(){return e.explore.controllers.EsriConsentDialogController.createAndShowEsriConsentDialog(t,i,o,r)}}}var p=e.visualHost.SandboxProperty;t.createRegisterTrustedVisualOptions=i,t.createRegisterVisualConsentOptions=o,t.createEmbedRegisterTrustedVisualOptions=r,t.createMobileVisualRegisterOptions=a,t.createConsentPersistencyProvider=s,t.createBlocker=c,t.createValidator=l,t.createConsentDialogProvider=d})(i=t.EsriVisualHelper||(t.EsriVisualHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){function i(e,t,i){if(!i.isTrustedVisual(e))return!1;for(var r=0,a=t.tiles;r<a.length;r++){var n=a[r];if(o(e,n,i))return!0}return!1}function o(e,t,i){return!!i.isTrustedVisual(e)&&(t.type===a.composite&&t.config&&t.config.visualContainer&&t.config.visualContainer.$visualContainer.config.singleVisual.visualType===e)}function r(e,t){for(var i=[],o=0,r=e.tiles;o<r.length;o++){var n=r[o],s=n.type===a.composite&&n.config&&n.config.visualContainer&&n.config.visualContainer.$visualContainer.config.singleVisual.visualType;s&&t.isTrustedVisual(s)&&i.push(s)}return t.getConsentAndLoadVisuals(i)}var a=e.dataServices.contracts.TileType;t.dashboardContainsTrustedVisual=i,t.tileContainsTrustedVisual=o,t.acquireTrustedVisuals=r})(i=t.TrustedVisualUtil||(t.TrustedVisualUtil={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(i){function o(t){var i=e.dataServices.models.AppModelIconBackgroundColors[0].color,o={emailsList:new h,displayText:t,displayName:t,description:void 0,iconUrl:void 0,dashboardIds:[],reportIds:[],workbookIds:[],modelIds:[],listOfGroupPrincipals:[],icon:f,iconColor:e.dataServices.models.AppModelIconColors[0],iconBackgroundColor:i,headerBackgroundColor:p.getAppHeaderBackgroundColor(i),defaultContentOption:1,defaultContent:void 0,isSharedToEntireOrg:!1,allowCopyContent:!0,category:u.OrganizationalApp,getPermissions:function(){return e.common.contracts.Permissions.Read|e.common.contracts.Permissions.CopyOnWrite}};return o}function r(e){return e instanceof v?{dashboardObjectId:e.objectId}:e instanceof g?{reportObjectId:e.objectId}:e instanceof m?{workbookObjectId:e.uniqueId}:void 0}function a(e,t){var i,o,r=c(e,t);e.isSharedToEntireOrg||(i=_.map(e.emailsList.validEmailsList.concat(e.emailsList.validObjectIds),(function(e){return e.toLowerCase()})),o=e.emailsList&&e.emailsList.inputUserList);var a={name:e.displayName,description:e.description,icon:r,parameterIcon:null,accessPermissions:{adUserMetadataList:o,listOfGroupsOrPrincipals:i,isSharedToEntireOrganization:e.isSharedToEntireOrg},dashboardIds:e.dashboardIds,reportIds:e.reportIds,modelIds:e.modelIds,workbookIds:e.workbookIds,contentProviderCategory:e.publishAsTemplate?u.OrganizationalTemplateApp:u.OrganizationalApp,skipUpdateIcon:!r,appSettings:{defaultAppArtifact:0===e.defaultContentOption?null:e.defaultContent,iconName:e.icon,iconColor:e.iconColor,iconBackgroundColor:e.iconBackgroundColor,headerBackgroundColor:e.headerBackgroundColor,allowCopyContent:e.allowCopyContent}};return a}function n(e){return _.isEmpty(e.objectId)||e.isFromContentPack===!0}function s(e,t){var i=!!e.icon,o=!!t&&!!t.icon,r=n(e)&&i,a=i&&!o,s=i&&o&&(e.icon!==t.icon||e.iconColor!==t.iconColor||e.iconBackgroundColor!==t.iconBackgroundColor);return r||a||s}function c(e,t){return s(e,t)?e.iconImageData:t&&e.localAppLogoImageData===t.localAppLogoImageData?void 0:e.localAppLogoImageData}function l(e,t,i){var o=e.defer(),r=$(t),a=r.find("i");if(_.isEmpty(a))o.reject();else{var n=r.width(),s=n/2,c=$("<canvas>")[0],l=c.getContext("2d"),d=getComputedStyle(a[0],":before").getPropertyValue("content");d=_.trim(d,'"');var p=getComputedStyle(a[0]).getPropertyValue("font-size");l.canvas.width=n,l.canvas.height=n,l.fillStyle=i.iconBackgroundColor,l.beginPath(),l.arc(s,s,s,0,2*Math.PI,!1),l.closePath(),l.fill(),l.fillStyle=i.iconColor,l.font=p+" PowrMDL2",l.textAlign="center",l.textBaseline="middle",l.fillText(d,s,s),o.resolve(c.toDataURL())}return o.promise}function d(e,i){e.displayName=i.displayName,e.icon=i.icon,e.iconColor=i.iconColor,e.iconBackgroundColor=i.iconBackgroundColor,e.headerBackgroundColor=i.headerBackgroundColor,e.iconImageData=i.iconImageData,e.localAppLogoImageData=i.localAppLogoImageData,e.defaultContentOption=i.defaultContentOption,e.defaultContent=i.defaultContent,e.publishAsTemplate=i.publishAsTemplate,e.emailsList=i.emailsList,t.ContentPackAuthoringHelper.updateContentPack(e,i)}var p=e.dataServices.AppUtils,u=e.common.contracts.ContentProviderCategory,v=e.dataServices.models.Dashboard,h=e.common.models.EmailsListModel,g=e.common.models.Report,m=e.dataServices.models.Workbook,f="my-apps";i.createNewAppPublishModel=o,i.createAppArtifact=r,i.createPublishOrUpdateAppModelRequest=a,i.isNewApp=n,i.hasNewIconData=s,i.getIconLogoImageData=l,i.resetAppPublishModel=d})(i=t.PublishAppHelper||(t.PublishAppHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){function i(t,i){for(var o=0,r=i;o<r.length;o++){var a=r[o];if(!a.expression&&null==a.type&&!a.restatement)return!1}return t.Version&&t.Version>=e.data.SemanticQueryVersions.Version2}t.canVisualizeQuery=i})(i=t.VisualQueryUtil||(t.VisualQueryUtil={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new o}var i=e.dataServices.TileUtils;e.createAlertRuleService=t;var o=(function(){function t(){this.cardMeasureRoleName="Values",this.gaugeMeasureRoleName="Y",this.kpiMeasureRoleName="Indicator",this.kpiGoalRoleName="Goal",this.kpiTrendRoleName="TrendLine",this.gaugeGoalRoleName="TargetValue"}return t.prototype.createAlertRule=function(t,o,r){var a=this,n=this.getQuery(t);if(n){var s=t.config.visualContainer;if(s){var c=s.elements[0].DataRoles;if(c){var l=i.getVisualType(t.config),d=this.getProjectionIndex(l,c);if(null!=d){if(l===e.visuals.plugins.kpi.name){var p=_.find(c,(function(e){return e.Name===a.kpiTrendRoleName}));p&&this.updateQuerySortOrder(n,p.Projection)}return{condition:{compareToAValue:{operator:o,columnIndex:{columnIndex:d,queryIndex:0},value:r}},queries:[n]}}}}}},t.prototype.getMeasureName=function(e){var t=e.config.visualContainer||e.config.realTimeVisual;if(t&&!_.isEmpty(t.elements)){var o=t.elements[0].DataRoles,r=t.queryMetadata,a=void 0;if(o&&r){var n=this.getProjectionIndex(i.getVisualType(e.config),o);null!=n&&(a=r.Select[n].Restatement)}return a}},t.prototype.getThresholdValue=function(t){var i=0,o=t.composite,r=o&&o.visual&&o.visual.dataViews;if(!_.isEmpty(r)){var a=r[0],n=o.visual.type;if(a)if(a.categorical&&n===e.visuals.plugins.card.name)i=a.categorical.values[0].values[0];else if(n===e.visuals.plugins.gauge.name){var s=e.data.DataRoleHelper.getMeasureIndexOfRole(a.categorical.values.grouped(),this.gaugeGoalRoleName);if(s>=0){var c=a.categorical.values[s].values;i=_.last(c)}else if(a.metadata){var l=a.metadata.objects;l&&l.axis&&l.axis.target&&(i=l.axis.target)}}else if(a.categorical&&n===e.visuals.plugins.kpi.name){var s=e.data.DataRoleHelper.getMeasureIndexOfRole(a.categorical.values.grouped(),this.kpiGoalRoleName);if(s>=0){var c=a.categorical.values[s].values;i=_.last(c)}}}return i},t.prototype.getProjectionIndex=function(t,i){var o;switch(t){case e.visuals.plugins.card.name:o=this.cardMeasureRoleName;break;case e.visuals.plugins.gauge.name:o=this.gaugeMeasureRoleName;break;case e.visuals.plugins.kpi.name:o=this.kpiMeasureRoleName}if(o){var r=_.find(i,(function(e){return e.Name===o}));if(r)return r.Projection}},t.prototype.getQuery=function(e){var t=e.contract.query.modelQuery;if(t&&t.sq){var i=jsCommon.JsonExtensions.tryParseJSON(t.sq);if(i){if(i.defn){var o=i;return{Commands:[{SemanticQueryDataShapeCommand:{Query:o.defn,Binding:o.shape}}]}}var r=void 0;return i.dataQuery?r=i.dataQuery:i.Commands&&(r=i),r}}},t.prototype.updateQuerySortOrder=function(e,t){if(e.Commands&&!_.isEmpty(e.Commands)&&e.Commands[0].SemanticQueryDataShapeCommand){var i=e.Commands[0].SemanticQueryDataShapeCommand,o=i.Query;o.OrderBy=[{Direction:2,Expression:o.Select[t]}];var r=i.Binding;r&&r.DataReduction&&r.DataReduction.Primary&&(r.DataReduction.Primary={Top:{Count:1}})}},t})();e.AlertRuleService=o})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.EnumExtensions,o=e.dataServices.contracts.PackageType,r=e.common.contracts.Permissions,a=e.common.contracts.PublishOrRefreshStatus,n=e.dataServices.constants,s=jsCommon.QueryStringUtil,c=(function(){function t(t,o,r,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D){var I=this;this.rootScope=t,this.dashboardService=o,this.dashboardDataService=r,this.modelService=n,this.telemetryService=s,this.localizationService=c,this.navigation=l,this.notificationToastService=d,this.quota=p,this.errorService=u,this.favoritesService=v,this.mostRecentlyUsedService=h,this.homeService=g,this.groupService=m,this.promiseFactory=f,this.workbookService=y,this.conceptualModelSetting=b,this.storeAppInstall=S,this.packageService=w,this.appService=C,this.lazy=D,this.pendingDatasetReadyNotification=[],this.openModel=function(t){return null!=t.contract.packagePublishStatus&&t.contract.packagePublishStatus!==a.FinishedSuccessfully&&t.contract.packagePublishStatus!==a.RefreshInProgress&&t.contract.packagePublishStatus!==a.RefreshError?void(t.contract.packagePublishStatus===a.PublishError&&I.deleteModelOnPublishFailure(t.id)):(t.isNew=t.contract.isNew=!1,void(I.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.OpenDataset)||i.hasFlag(t.getPermissions(),e.common.models.ReportPermissions.CopyOnWrite)||I.navigation.navigateToDatasetByDBName(t.dbName)))}}return t.prototype.bootstrap=function(){var t=this;this.isListViewEnabled()&&(this.rootScope.$on(e.dataServices.constants.packagePublishedSuccessfullyEventName,(function(e,i){t.showPackagedReadyToast(i)})),this.rootScope.$on(n.onDatasetAddedEventName,(function(e,i){t.handleDatasetAddedEvent(i)}))),this.rootScope.$on(n.workbook.workbookAddedEventName,(function(e,i){t.showWorkbookReadyToast(i)})),this.dashboardService.readyForConceptualModelInitializationPromise.then((function(){t.bootstrapNavigation(!0,!1).then((function(i){t.rootScope.$emit(e.constants.dashboardContainerLoaded,i)}))}))},t.prototype.bootstrapNavigation=function(t,i){var o=this,r=this.navigation,a=r.inHomeDashboardView(),n=t&&(r.inLandingContainerView()||a),c=this.promiseFactory.defer();if(t&&r.inAppView()){var l={dashboardOriginalGUID:r.currentDashboardOriginalGUID,reportOriginalGUID:r.currentReportOriginalGUID,workbookID:r.currentWorkbookURLIdentifier},d=s.getQueryStringValue(e.constants.appAutoInstall.skipConfirmationQueryParam);this.storeAppInstall.addAppAndNavigate(r.currentAppGUID,l,!!d).finally((function(){return c.resolve(null)}))}else t&&r.inWorkspacesView()?(r.navigateToWorkspaces(),c.resolve(e.constants.navigation.states.workspaces)):!this.homeService.isHomeDashboardSet||!n&&t?this.favoritesService.reloadFavorites(i).then((function(e){e.length>0?(r.navigateToFavorites(o.groupService.activeGroupObjectId),c.resolve(null)):o.isListViewEnabled()?o.mostRecentlyUsedService.getMRUModels().then((function(e){e.length>0?(r.navigateToRecentlyViewed(),c.resolve(null)):(r.navigateToContentList(o.groupService.activeGroupObjectId),c.resolve(null))})):(r.navigateToContentList(o.groupService.activeGroupObjectId),c.resolve(null))})):(r.navigateToHomeDashboard(t),c.resolve(e.constants.navigation.states.home));return c.promise},t.prototype.handleDatasetAddedEvent=function(e){var t=this.dashboardService.dashboardContainerModel.contract.models,i=!1;if(t){for(var o=t.length,r=0;r<o;r++)if(t[r].id===e.id&&t[r].packageId===e.packageId){t[r]=e,i=!0;break}i||t.push(e)}},t.prototype.showPackagedReadyToast=function(e){var t=this;this.packageService.ensurePackagesInitialization().then((function(){var i=t.packageService.findPackage(e);i&&i.packageType===o.AppInstance?t.appService.onInstanceAdded(i.contract).catch((function(){t.showDashboardOrModelNotification(e)})):t.showDashboardOrModelNotification(e)}))},t.prototype.showDashboardOrModelNotification=function(e){var t=this;this.dashboardService.getDashboards().then((function(i){var o=_.filter(i,(function(t){return t.contract.packageIds&&t.contract.packageIds.indexOf(e)>=0}));if(1===o.length&&o[0].isNew&&1===o[0].contract.packageIds.length&&!o[0].isNotified)t.notifyNewDashboardIsReady(o[0]);else{var r=t.modelService.findModelByPackageId(e);r?t.notifyNewDatasetIsReady(r,e):(t.pendingDatasetReadyNotification.push(e),t.unregisterModelWatch||(t.unregisterModelWatch=t.rootScope.$watch((function(){return t.modelService.lastUpdatedTimestamp}),(function(){t.pendingDatasetReadyNotification=_.filter(t.pendingDatasetReadyNotification,(function(e){var i=t.modelService.findModelByPackageId(e);return!i||(t.notifyNewDatasetIsReady(i,e),!1)})),_.isEmpty(t.pendingDatasetReadyNotification)&&(t.unregisterModelWatch(),t.unregisterModelWatch=null)}))))}}))},t.prototype.notifyNewDatasetIsReady=function(t,o){var a=this;if(t&&t.isNew&&!t.isHidden&&i.hasFlag(t.getPermissions(),r.All)&&t.contract.insightsSupported){var n,s={displayText:this.localizationService.get("DatasetUploadedToast_ExploreInsights"),action:function(){return __awaiter(a,void 0,e.Promise,(function(){var i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.lazy("insightsBootstrap")];case 1:return i=o.sent(),i.start(t.dbName,t.vsName,t.packageId,e.insights.constants.insightsSourceToast),[2]}}))}))}},c={displayText:this.localizationService.get("DatasetUploadedToast_ViewDataset"),action:function(){var e=a.modelService.findModel(t.id,o);a.openModel(e)}};n=this.notificationToastService.notify({title:this.localizationService.get("DatasetUploadedToast_ReadyToExploreTitle"),message:this.localizationService.get("DatasetUploadedToast_ReadyToExploreSubtitle"),notificationType:e.common.NotificationToastType.Success,actionButtons:[c],actionLinks:[s],sticky:!0});var l=this.rootScope.$on(e.constants.groupSwitchedEventName,(function(e,t,i){a.notificationToastService.hide(n),l()}))}},t.prototype.deleteModelOnPublishFailure=function(e){var t=this;this.deleteItemOnPublishFailure(this.localizationService.get("NavigationPane_ModelPublishErrorTitle"),this.localizationService.get("NavigationPane_ModelPublishErrorContent"),(function(){t.modelService.deleteModel(e)}))},t.prototype.deleteItemOnPublishFailure=function(e,t,i){var o=this,r=this.errorService.control(),a=[new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Delete"),function(e,t){r.hideDialog(),i()}),new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){r.hideDialog()})];r.showCustomDialog(e,$("<div/>").text(t),a,(function(e){e.parent().find('input[value="'+o.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)},t.prototype.notifyNewDashboardIsReady=function(t){var i=this,o={description:t.displayName,displayText:this.localizationService.get("ToastNotification_GoToDashboard"),action:function(){i.navigation.navigateToDashboardByGUID(t.objectId)}};this.notificationToastService.notify({title:this.localizationService.get("Publish_Success"),message:this.localizationService.get("NotificationMessage_NewDashboardCreatedTitle"),notificationType:e.common.NotificationToastType.Success,actionButtons:[o]}),t.isNotified=!0},t.prototype.showWorkbookReadyToast=function(t){var i=this,o=this.workbookService.findWorkbookByUniqueId(t);if(o&&o.isOwner()){var r=this.groupService.activeGroupObjectId,a={displayText:this.localizationService.get("ToastNotification_GoToWorkbook"),action:function(){i.navigation.insertGroupAndNavigateToWorkbookByUniqueId(o.uniqueId,r)}},n=this.isListViewEnabled()?"WorkbookReadyNotificationMessageV2":"WorkbookReadyNotificationMessage";this.notificationToastService.notify({title:this.localizationService.get("WorkbookReadyNotificationTitle"),message:this.localizationService.format(n,[o.displayName]),notificationType:e.common.NotificationToastType.Success,actionButtons:[a]})}},t.prototype.isListViewEnabled=function(){return this.conceptualModelSetting.isListViewEnabled()},t})();t.BootstrapService=c})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,n,s,c,l,p,u){return new d(e,t,i,o,r,a,n,s,c,l,p,u)}var o=e.common.constants,r=e.common.contracts.ContentProviderCategory,a=e.common.contracts.ContentProviderClientCategory,n=e.helpers.ContentProviderStoreHelper,s=e.common.constants.featureSwitches,c=e.telemetry.InstallSource,l=e.common.helpers.ModelConverterHelper;t.createContentProviderService=i;var d=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p){this.featureSwitchService=e,this.userInfo=t,this.localizationService=i,this.contentProviderHttpService=o,this.telemetryService=r,this.errorService=a,this.notificationToast=n,this.lazy=s,this.appService=c,this.promiseFactory=l,this.conceptualModelSetting=d,this.licenseEnforcementService=p}return t.prototype.getDataAccessInfo=function(e){if(e){var t=l.getContentProviderClientCategory(e);if(t===a.Organizational&&e.featureSwitch!==s.microsoftOrgAppEnabled)return{SID:"",DSID:""};var i=JSON.parse(e.providerConfig);return i.dataAccessInfo}},t.prototype.upgradeRequiredToConnect=function(e){if(!e)return!1;var t=l.getContentProviderClientCategory(e),i=t===a.Organizational,o=t===a.BigDataAndMore,r=i&&this.licenseEnforcementService.supportsOrgApps(),n=o&&this.licenseEnforcementService.supportsPremiumContentProviders(),s=!i&&!o,c=r||n||s;return!c},t.prototype.displayFeatureDisabledDialog=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,n,s,c;return __generator(this,(function(d){
switch(d.label){case 0:return i=l.getContentProviderClientCategory(t)===a.Organizational,o=this.appService.isAppCategory(t.category),r="UpgradeAccount_ConnectContentGenericMessage",n="UpgradeAccount_ConnectContentGenericTitle",i&&!o?(r="UpgradeAccount_ConnectContentMessage",n="UpgradeAccount_ConnectContentTitle"):o&&(r="UpgradeAccount_InstallAppMessage",n="UpgradeAccount_InstallAppTitle"),s=this.localizationService,[4,this.lazy("licenseHelper")];case 1:return c=d.sent(),c.displayFeatureDisabledErrorMessage(e.telemetry.LicenseEnforcementOperation.ConnectContentProvider,s.format(r,[e.common.constants.FreeTrialPeriod.toString(10)]),s.get(n)),[2]}}))}))},t.prototype.storeDataAccessInfo=function(t,i,s,d,p){var u=this,v=this.localizationService,h=this.notificationToast,g=this.promiseFactory.defer();return v.ensureLocalization((function(){var m,f=n.getStoreOperationType(t,i,u.appService);switch(f){case 2:m="AppModel_InstallApp";break;case 0:m="NotificationMessage_ImportingPackage";break;case 1:m="NotificationMessage_ConnectingPackage"}var y,b=h.notify({title:v.get(m),message:v.get("NotificationMessage_TakeAWhile"),notificationType:e.common.NotificationToastType.Loading}),S=t.ContentProviderIdOverride||i&&i.id||o.orgAppsContentProviderId,w=d,C=null;if(i){w=i.displayText||w;var D=l.getContentProviderClientCategory(i);D===a.Organizational?(C="OrgContent",i.featureSwitch!==o.featureSwitches.microsoftOrgAppEnabled&&(y=i.providerKey)):D===a.Service&&i.category!==r.BuiltIn?y=i.providerKey:i.id===o.groupOneDriveContentProviderId&&(C="OneDrive - Group")}C=C||w;var I=u.telemetryService,T=I.startEvent(e.telemetry.DashboardContentProviderPublish,S,i?i.providerKey:null,C,i?i.category:-1,s!==c.AppSource);t.DSID&&I.logChildEvent(T.event,e.telemetry.DashboardContentProviderPublishDSID,t.DSID),2===f&&I.logChildEvent(T.event,e.telemetry.AppsInstallApp,i&&i.providerKey,i?r[i.category]:"",s),u.contentProviderHttpService.storeConfiguration(p||0,S,t,T.event,y,i&&i.category,u.conceptualModelSetting.isAppsEnabled()).then((function(e){h.hide(b),T.resolve(),g.resolve(null)}),(function(e){h.hide(b),n.handleStoreConfigurationError(e,S,w,f,v,u.featureSwitchService,u.errorService);var t=e.data&&e.data.error&&e.data.error.code||"FailedToStoreConfiguration",i=(e.requestId,e.data&&e.data.error&&e.data.error.message||""),o=jsCommon.StringExtensions.format("Status:{0} RequestId:{1} Details:{2}",e.status.toString(),i);T.reject({errorCode:t,errorMessage:o}),g.reject()}))})),g.promise},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.constants,r=e.controllers.DashboardContainerController,a=e.dataServices.models.DashboardTileModel,n=e.constants.navigation.states,s=e.common.constants.TaskPaneCollapsiblePaneMode,c=(function(){function t(e,t,i,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S){var w=this;this.$rootScope=e,this.dashboardDataService=t,this.dashboardService=i,this.dashboardWarningsService=r,this.errorService=a,this.featureSwitchService=n,this.groupService=s,this.inFocusService=c,this.licenseEnforcementService=l,this.localizationService=d,this.modelConverter=p,this.mostRecentlyUsedService=u,this.navigation=v,this.permissionService=h,this.timeout=g,this.telemetryService=m,this.userInfo=f,this.appService=y,this.subscription=b,this.taskPaneSliderService=S,this.$rootScope.$on(o.navigation.stateChangeSuccess,(function(e,t,i,o,r){w.handleStateChange(t,i,o,r)}))}return t.prototype.registerDashboardContainerScope=function(e){this.dashboardContainerScope=e},t.prototype.unregisterDashboardContainerScope=function(){this.dashboardContainerScope=void 0},t.prototype.handleStateChange=function(t,o,a,c){var l=this;return o.dashboardGUID&&!o.hasOwnProperty("q")?this.dashboardWarningsService.showWarningsIfNeeded():this.dashboardWarningsService.hideDashboardWarnings(),a.name!==e.common.constants.navigation.states.reportPage&&a.name!==n.settingsGroup||this.subscription.collapseSubscriptionPane(),this.dashboardContainerScope&&this.dashboardService.updateDashboardMenuItems(this.dashboardContainerScope),t&&t.name===n.dashboardRequestAccess?void this.dashboardService.setAndUpdateActiveDashboard(null):void this.localizationService.ensureLocalization((function(){var d=l.dashboardService.dashboardContainerModel,p=l.dashboardDataService,u=l.navigation,v=c?c.dashboardGUID:null;if(o.groupGUID&&c.groupGUID&&o.groupGUID!==c.groupGUID)return void(p.activeDashboard=null);var h=l.dashboardService.dashboardContainerModel.findDashboardByGUID(u.currentDashboardGUID),g=l.dashboardService.dashboardContainerModel.findDashboardByGUID(v);if(l.dashboardService.checkUserNeedsProLicenseAndShowError(h,l.userInfo,l.licenseEnforcementService,l.localizationService,u,e.telemetry.LicenseEnforcementOperation.SwitchDashboards,g),l.dashboardContainerScope&&a.name!==n.dashboard&&h&&h.tiles&&p.activeDashboard&&u.currentDashboardGUID===p.activeDashboard.objectId&&l.dashboardContainerScope.$broadcast(e.constants.populateDashboardWithReportTiles),h&&u&&h.objectId!==u.currentDashboardGUID&&l.navigation.navigateToDashboardByGUID(h.objectId,0,!1),t&&t.name===n.dashboards)return void(p.activeDashboard?u.navigateToDashboardByGUID(p.activeDashboard.objectId):l.permissionService.isActiveWorkspaceIsReadOnly||!_.isEmpty(l.dashboardService.dashboardContainerModel.visibleDashboards)||l.groupService.isDataInCurrentGroup()?u.navigateToContentListOrActiveDashboard():u.navigateToGroupWelcome());if(u.currentDashboardGUID&&(!p.activeDashboard||u.currentDashboardGUID!==p.activeDashboard.objectId))if(h){h.increaseHitCount();var m=d.contract;h.isLoaded&&!h.contract.cached||l.dashboardService.loadDashboard(h.id),m.activeViewMode=e.contracts.DashboardContainerViewMode.DashboardViewer,m.activeDashboardId=h.id,h.isNew=!1,h.isFilled()?h.runLayoutIfRequired():(l.modelConverter.fillDashboardChildren(h,d.contract.models,d.contract.reports,d.contract.workbooks),h.calculateLayout(),h.applyLayout()),p.activeDashboard=h,h.id>0&&(l.dashboardWarningsService.showWarningsIfNeeded(),l.dashboardService.updateActiveDashboard(h.id,!1),l.dashboardService.logRTelemetryDashboardEvent(e.telemetry.DashboardLoadDashboardWithScriptVisuals))}else l.dashboardService.shouldNavigateToRequestAccess()?(l.mostRecentlyUsedService.removeMRU(u.currentDashboardGUID),l.navigation.navigateToRequestDashboardAccessByGUID(u.currentDashboardGUID)):(l.mostRecentlyUsedService.removeMRU(u.currentDashboardGUID),r.showDashboardDoesNotExistDialog(l.errorService,l.localizationService,l.telemetryService,l.navigation),u.navigateToActiveDashboard());u.currentDashboardGUID&&p.activeDashboard&&l.dashboardService.notifyDashboardUpdate(),l.dashboardContainerScope&&l.taskPaneSliderService.collapsePane();var f=p.selectedDashboardTile;if(f){var y=f.tileModel;y&&y.isTemporary&&l.dashboardService.removeTemporaryTile(y),l.dashboardService.clearSelectedDashboardTile()}if(l.navigation.inSharingView()&&l.timeout((function(){l.dashboardService.navigateToShareDashboard(l.navigation.currentDashboardGUID)})),l.dashboardContainerScope&&l.navigation.inAlertsEditorView()){if(!p.activeDashboard||!p.activeDashboard.isLoaded)return;var b=l.setAndGetActiveTile();b&&l.taskPaneSliderService.expandPane(s.AlertsEditor,i.Small)}if(l.navigation.inInFocusView()||l.navigation.inInFocusInsightsView()){if(!p.activeDashboard||!p.activeDashboard.isLoaded)return;var b=l.setAndGetActiveTile();b&&l.inFocusService.view(b,void 0,l.navigation.inInFocusInsightsView())}o.dashboardGUID&&!o.hasOwnProperty("q")&&l.dashboardDataService.activeDashboard&&l.dashboardWarningsService.prepareCustomVisualsForLoading(l.dashboardDataService.activeDashboard)}))},t.prototype.setAndGetActiveTile=function(){var e=this.findTileToEdit();return e?(this.dashboardService.selectDashboardTile(new a(e)),e):void r.showTileDoesNotExistDialog(this.errorService,this.localizationService,this.telemetryService)},t.prototype.findTileToEdit=function(){var e=this.navigation.currentTileGUID,t=this.navigation.currentTileOriginalGUID;return this.dashboardDataService.activeDashboard.findTileByObjectIdOrOriginalObjectId(e,t)},t})();t.DashboardStateChangeService=c})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(){return new i}e.createDashboardConfigurationService=t;var i=(function(){function e(){}return e})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.contracts.TileType,o=(function(){function t(e,t,i,o,r,a,n,s,c,l,d){this.$rootScope=e,this.telemetryService=t,this.dashboardDataService=i,this.resourceGateService=o,this.featureSwitchService=r,this.tutorialDataStore=a,this.notificationBar=n,this.resourcePackageListenerService=s,this.embedModeService=c,this.localizationService=l,this.visualPlugin=d,this.dashboardNotificationIds=[],this.embedModeService.getEmbedTypeDescription()}return t.prototype.showWarningsIfNeeded=function(){this.hideDashboardWarnings();var t=this.dashboardDataService.activeDashboard;t&&(this.telemetryService.logEvent(e.telemetry.EXLoadReportWithCustomViz,this.embedTypeDescription),this.resourceGateService.shouldShowWarning(this.getResourceIds(),t.objectId)?(this.resourceGateService.resetResourceFlag(),this.displayCustomVisualWarning()):(this.resourceGateService.setResourceFlag(),this.prepareCustomVisualsForLoading(t)))},t.prototype.hideDashboardWarnings=function(){for(var e=this.dashboardNotificationIds;e.length>0;)this.notificationBar.hide(e.pop())},t.prototype.getResourceIds=function(){var e=this.dashboardDataService.activeDashboard;return e?this.resourcePackageListenerService.getAllRequiredResourcePackageIdStrings(e):[]},t.prototype.displayCustomVisualWarning=function(){var e=this.dashboardDataService.activeDashboard;if(e)for(var t=e.tiles,o=0,r=t;o<r.length;o++){var a=r[o];if(a.type===i.composite||a.type===i.report){var n=a.contract;if(n&&n.resourcePackageIds&&n.resourcePackageIds.length>0){this.createCustomVisualWarning();break}}}},t.prototype.createCustomVisualWarning=function(){var t=this;this.telemetryService.logEvent(e.telemetry.EXLoadReportWithCustomViz,this.embedTypeDescription);var i=this.notificationBar.notify({message:this.localizationService.get("OpenDashboard_EnableCustomVisualWarningMessage"),notificationType:e.common.NotificationBarType.Warning,actions:[{displayText:this.localizationService.get("OpenDashboard_EnableCustomVisualButton"),linkId:1,action:function(){t.resourceGateService.setResourceFlag(),t.resourceGateService.addResourcePackageIdToDashboard(t.dashboardDataService.activeDashboard.objectId,t.getResourceIds()),t.notificationBar.hide(i),t.dashboardNotificationIds.splice(t.dashboardNotificationIds.indexOf(i),1),t.prepareCustomVisualsForLoading(t.dashboardDataService.activeDashboard)}}],secondaryLink:{displayText:this.localizationService.get("LearnMore"),urlString:"https://go.microsoft.com/fwlink/?LinkID=627490 "}});this.dashboardNotificationIds.push(i)},t.prototype.prepareCustomVisualsForLoading=function(t){var i=this,o=this.resourcePackageListenerService.getAllRequiredResourcePackageIdStrings(t);this.resourcePackageListenerService.getAndLoadVisualPluginsForDashboard(t).then((function(r){i.resourceGateService.shouldShowWarning(o,t.objectId)||_.isEmpty(r)||i.$rootScope.$emit(e.constants.reloadEmptyVisuals,{visualTypes:r})}))},t})();t.DashboardWarningsService=o})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.events,o=e.explore.services.events,r=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p){this.rootScope=e,this.timeout=t,this.modelConverter=i,this.explorationProxy=o,this.localizationService=r,this.telemetryService=a,this.navigation=n,this.modelService=s,this.packageService=c,this.notificationBar=l,this.errorService=d,this.userActivityContextService=p,this.initialize()}return t.prototype.initialize=function(){var t=this;this.rootScope.$on(e.dataServices.constants.packageVersionChange,(function(e,i){return t.updateReportsWithPackageInfo(t.currentLoadReportContainerArgs,e,i)}))},t.prototype.load=function(e){this.currentLoadReportContainerArgs=e,this.verifyCompatiblityAndLoadExploration(e)},t.prototype.verifyCompatiblityAndLoadExploration=function(t){var i=this,r=t.report,a=t.openExplorationTelemetryEvent;t.instantiationMode!==e.common.contracts.reportServer.ReportInstantiationMode.Exploration&&t.instantiationMode!==e.common.contracts.reportServer.ReportInstantiationMode.NonTemplateForExistingTile?this.explorationProxy.get({id:r.id,model:r.model}).then((function(e){t.exploration=e,i.setCompatibilityModeAndLoadExploration(t)}),(function(r){if(r.error&&e.helpers.ReportUtility.shouldDisplayErrorAsNotificationBar(r.error.code)){var n=t.report,s=i.modelService.findModel(n.modelId,n.packageId);i.rootScope.$emit(o.showErrorNotification.name,s,r.error,(function(){i.verifyCompatiblityAndLoadExploration(t)}))}else i.errorService.error(i.localizationService.get("ExplorationContainer_FailedToLoadReport"),"ExplorationContainer_FailedToLoadReport_DefaultDetails",{requestId:r?r.requestId:void 0},!1,e.telemetry.ErrorSource.PowerBI);i.rootScope.$emit(e.constants.openReportFinished,r&&r.error?r.error.message:"",!0),a&&a.reject({errorCode:r.error&&r.error.code?r.error.code:"FailToGetExploration",errorMessage:r.error&&r.error.message?r.error.message:null})})):this.setCompatibilityModeAndLoadExploration(t)},t.prototype.setCompatibilityModeAndLoadExploration=function(e){var t=this;this.timeout((function(){t.loadReportContainer(e)}),0),this.notifyReportUpdate(e.report.contract.packageId)},t.prototype.loadReportContainer=function(t){var o=null;this.navigation&&(o=this.navigation.additionalODataFilter);var r=t.report,a=this.modelService.findModel(r.modelId,r.packageId);a||(a=this.modelConverter.convertModel(r.model),this.modelService.addModel(a)),this.telemetryService.logEvent(e.telemetry.EXLoadReportContainer,r?r.objectId:null);var n={report:r,model:a,dashboardId:t.dashboardId,instantiationMode:t.instantiationMode,tileId:t.tileId,reportPage:t.reportPage,additionalODataFilter:o,exploration:t.exploration,openExplorationTelemetryEvent:t.openExplorationTelemetryEvent};this.rootScope.$emit(i.loadPowerViewReportEventName,n)},t.prototype.updateReportsWithPackageInfo=function(e,t,i){(this.navigation.inReportView()||this.navigation.inDatasetView())&&e&&e.report&&e.report.contract.packageId===i&&this.notifyReportUpdate(i)},t.prototype.notifyReportUpdate=function(e){if(e){var t=this.packageService.findPackage(e);if(t&&t.hasUpdate()){var i=jsCommon.StringExtensions.format(this.localizationService.get("DashboardContentPackNewVersion"),t.name);this.notificationBar.notify({message:i,hideOnStateChange:!0})}}},t})();t.ExplorationLoader=r})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=i.navigation.states,r=e.constants.navigation.states,a=(function(){function t(e,t,o,r,a,n,s,c,l,d){var p=this;this.$location=e,this.$window=t,this.$rootScope=o,this.$state=r,this.stateParams=a,this.featureSwitchService=n,this.activeGroupIdService=s,this.home=c,this.navigationStateValidator=l,this.conceptualModelSetting=d,this.navigationStateValidator.setDefaultStateCallback((function(){return p.navigateToActiveDashboard()})),o.$on(i.showSettingsViewerEventName,(function(e,t,i){return p.showSettingsSlider(t,i)})),o.$on(i.navigation.stateChangeStart,(function(e,t,i,o,r){p.navigationStateValidator.validateStateChange(e,t.name,i,o.name,r)})),this.activeGroupIdService&&this.activeGroupIdService.initialGroupIdReadyPromise&&this.activeGroupIdService.initialGroupIdReadyPromise.then((function(){p.navigationStateValidator.validateState(p.stateService.current.name)}))}return t.prototype.convertLocationOption=function(e){var t;switch(e){case 1:t=!1;break;case 0:t=!0;break;case 2:t="replace";break;default:t=!0}return t},t.prototype.navigateToReport=function(e,t,i){var o=_.cloneDeep(e);t&&s.optionalAdd(o,"initialLoad",1),this.navigateToReportInternal(o,i)},t.prototype.replaceHistoryWithDashboardAndNavigate=function(e,t,i){var o={location:this.convertLocationOption(2),inherit:!0},a=this.stateService.params;a.dashboardGUID=e,!a.groupGUID&&i.groupGUID&&(a.groupGUID=i.groupGUID),this.$window.history.replaceState({},"",this.stateService.href(r.dashboard,a)),this.$window.history.pushState({},"",this.stateService.href(t,i,o)),this.stateService.go(t,i,o)},t.prototype.replaceHistoryWithDatasetAndNavigate=function(e,t,i){var r={location:this.convertLocationOption(2),inherit:!0},a=this.stateService.params;a.datasetDBName=e,!a.groupGUID&&i.groupGUID&&(a.groupGUID=i.groupGUID),this.$window.history.replaceState({},"",this.stateService.href(o.dataset,a)),this.$window.history.pushState({},"",this.stateService.href(t,i,r)),this.stateService.go(t,i,r)},t.prototype.replaceHistoryWithGroupWelcomeAndNavigate=function(e,t,i){var o={location:this.convertLocationOption(2),inherit:!0},a=this.stateService.params;a.groupGUID=e,this.$window.history.replaceState({},"",this.stateService.href(r.groupWelcome,a)),this.$window.history.pushState({},"",this.stateService.href(t,i,o)),this.stateService.go(t,i,o)},t.prototype.replaceAndLoadCurrentState=function(e,t){var i={location:this.convertLocationOption(2),inherit:!0},o=this.stateService.params;_.extend(o,t),this.$window.history.replaceState({},"",this.stateService.href(e,o,i)),this.stateService.go(e,o,i)},t.prototype.navigateToContentListOrActiveDashboard=function(){if(this.conceptualModelSetting.isListViewEnabled()){var e=this.activeGroupIdService.activeGroupObjectId;this.navigateToContentList(e)}else this.navigateToActiveDashboard()},t.prototype.navigateToActiveDashboard=function(){this.stateService.go(r.dashboards,{groupGUID:this.activeGroupIdService.activeGroupObjectId},{inherit:!0})},t.prototype.navigateToApps=function(){this.stateService.go(r.apps,{groupGUID:e.constants.myWorkSpaceGroupId},{inherit:!0})},t.prototype.navigateToApp=function(e,t){t?this.stateService.go(r.appInstance,{appGUID:e,appInstanceId:t},{inherit:!0}):this.stateService.go(r.app,{appGUID:e},{inherit:!0})},t.prototype.toggleArchivedContent=function(e){void 0===e&&(e=null),window.initialDashboardContainer&&(window.location.href=window.location.protocol+"//"+window.location.host+"?tenantId="+window.initialDashboardContainer.previousTenantId)},t.prototype.insertGroupAndNavigateToDashboardByGUID=function(e,t,i){var o=this.inSharedWithMePath()&&this.currentDashboardGUID===e?r.sharedDashboard:r.dashboard;this.stateService.go(o,{dashboardGUID:e,groupGUID:t},{location:this.convertLocationOption(i),inherit:!0})},t.prototype.navigateToSharedDashboardByGUID=function(t,i){this.stateService.go(r.sharedDashboard,{dashboardGUID:t,groupGUID:e.constants.myWorkSpaceGroupId},{location:this.convertLocationOption(i),inherit:!0})},t.prototype.insertGroupAndNavigateToWorkbookByUniqueId=function(e,t){var i=this.inAppView()?o.appWorkbook:o.workbook,r=this.stateService.href(i,{workbookURLIdentifier:e,groupGUID:t},{inherit:!0});this.locationService.url(r)},t.prototype.navigateToGroupByGUID=function(e,t){this.stateService.go(r.group,{groupGUID:e},{location:this.convertLocationOption(t),inherit:!0})},t.prototype.resetToMyWorkspace=function(){this.navigateToGroupByGUID(e.constants.myWorkSpaceGroupId)},t.prototype.navigateToDashboardByGUID=function(e,t,i){void 0===i&&(i=!0);var o=this.inSharedWithMePath()&&this.currentDashboardGUID===e?r.sharedDashboard:r.dashboard;this.stateService.go(o,{dashboardGUID:e},{location:this.convertLocationOption(t),inherit:!0,notify:i})},t.prototype.navigateToAppDashboardByGUID=function(e,t,i,o,a,n,c){void 0===n&&(n=!0),void 0===c&&(c=null);var l={dashboardGUID:e,dashboardOriginalGUID:t,appGUID:i};s.optionalAdd(l,"groupGUID",o);var d;c?(d=r.appInstanceDashboard,s.optionalAdd(l,"appInstanceId",c)):d=r.appDashboard,this.stateService.go(d,l,{location:this.convertLocationOption(a),inherit:!0,notify:!0})},t.prototype.navigateToAppWorkbookByUniqueId=function(e,t,i,r){var a={workbookURLIdentifier:e,appGUID:t};s.optionalAdd(a,"groupGUID",i),this.stateService.go(o.appWorkbook,a,{location:this.convertLocationOption(r),inherit:!0,notify:!0})},t.prototype.navigateToHomeDashboard=function(e){var t=this;this.conceptualModelSetting.isListViewEnabled()?this.insertGroupAndNavigateToDashboardByGUID(this.home.homeDashboard.dashboardObjectId,this.home.homeDashboard.groupId):e?(this.stateService.go(r.home,{inherit:!0,notify:!1,replace:!0}),this.$rootScope.$applyAsync((function(){return t.insertGroupAndNavigateToDashboardByGUID(t.home.homeDashboard.dashboardObjectId,t.home.homeDashboard.groupId,1)}))):this.stateService.go(r.home,{inherit:!0})},t.prototype.navigateToRequestDashboardAccessByGUID=function(e,t){var i=this.inSharedWithMePath()&&this.currentDashboardGUID==e?r.sharedDashboardRequestAccess:r.dashboardRequestAccess;this.stateService.go(i,{dashboardGUID:e},{location:this.convertLocationOption(t),inherit:!0})},t.prototype.navigateToGroupWelcome=function(){this.stateService.go(r.groupWelcome,{},{inherit:!0})},t.prototype.initialLoadDatasetByDBName=function(t,i){void 0===i&&(i=e.common.contracts.reportServer.ReportInstantiationMode.Exploration),this.stateService.go(o.dataset,{datasetDBName:t,instantiationMode:i,initialLoad:1},{inherit:!0})},t.prototype.navigateToFavorites=function(e){e?this.stateService.go(r.favorites,{groupGUID:e},{inherit:!0}):this.stateService.go(r.favorites,{},{inherit:!0})},t.prototype.navigateToContentList=function(e,t,i,o,a,n,c){var l={groupGUID:e};s.optionalAdd(l,"skipWelcome",t),s.optionalAdd(l,"contentListTab",i),s.optionalAdd(l,"instantiationMode",o),s.optionalAdd(l,"onlySharedWithMe",a),s.optionalAdd(l,"q",n),this.stateService.go(r.contentList,l,{location:this.convertLocationOption(c),inherit:!0})},t.prototype.navigateToContentListParams=function(e,t,i){void 0===i&&(i=!0),_.extend(this.stateParams,e),this.stateService.go(r.contentListPivot,e,{location:this.convertLocationOption(t),inherit:!0,notify:i})},t.prototype.changeContentListPivot=function(e){var t=null;switch(e){case 0:t="dashboards";break;case 8:t="datasets";break;case 16:t="recent";break;case 2:t="reports";break;case 4:t="workbooks"}var i={pivot:t};this.stateService.go(r.contentListPivot,i,{location:this.convertLocationOption(2),inherit:!0,notify:!1})},t.prototype.navigateToEmptyFeaturedDashboard=function(){this.stateService.go(r.home,{},{inherit:!0})},t.prototype.navigateToRecentlyViewed=function(){this.stateService.go(r.recentlyViewed,{},{inherit:!0})},t.prototype.navigateToSharedWithMe=function(e){var t={};s.optionalAdd(t,"q",e),this.stateService.go(r.sharedWithMe,t,{inherit:!0})},t.prototype.navigateToWorkspaces=function(){this.stateService.go(e.constants.navigation.states.workspaces,{},{inherit:!0})},t.prototype.navigateToDashboardSubscriptionsPane=function(e,t){var i=o.dashboardSubscription;this.stateService.go(i,{dashboardGUID:e,groupGUID:t},void 0)},t.prototype.navigateToReportSubscriptionsPane=function(e){this.navigateToReportInternal(e,void 0,void 0,!0)},t.prototype.navigateToDatasetByDBName=function(t,i){void 0===i&&(i=e.common.contracts.reportServer.ReportInstantiationMode.Exploration),this.stateService.go(o.dataset,{datasetDBName:t,instantiationMode:i,reloadCount:1},{inherit:!0})},t.prototype.navigateToDatasets=function(){this.conceptualModelSetting.isListViewEnabled()?this.navigateToContentList(this.currentGroupGUID,!0,8):this.stateService.go(o.datasets)},t.prototype.navigateToStreamingDatasets=function(e){this.conceptualModelSetting.isListViewEnabled()?this.navigateToContentList(this.currentGroupGUID,!0,8,e):this.stateService.go(o.streamingDatasets,{instantiationMode:e},{inherit:!0})},t.prototype.updateReportStateNoReload=function(e,t,i){if(t||this.inReportView())return this.navigateToReportInternal(e,i,{inherit:!0,notify:!1},this.inReportSubscriptionView())},t.prototype.navigateToGateways=function(){this.stateService.go(r.gateways)},t.prototype.navigateToGatewayItem=function(e,t,i){if(void 0===i&&(i=!0),e&&t){var o=this.convertLocationOption(2);this.stateService.go(r.dataSource,{gatewayId:e,dataSourceId:t,isNavigatingFromUi:i},{location:o,inherit:!0})}else e&&!t?this.stateService.go(r.gateway,{gatewayId:e},{inherit:!0,notify:!1}):this.navigateToGateways()},t.prototype.navigateToAdminPortal=function(e){var t=5===e?r.adminPortalCapacities:r.adminPortal;this.stateService.go(t,{adminPortalSettingsTab:e},{inherit:!0})},t.prototype.navigateToAdminPortalCapacity=function(e){this.stateService.go(r.adminPortalCapacity,{capacityId:e,adminPortalSettingsTab:5},{inherit:!0})},t.prototype.navigateToAppAutoInstall=function(){this.stateService.go(r.appAutoinstall,{},{inherit:!0})},t.prototype.navigateToWorkbookByUrlId=function(e,t,i,a){void 0===i&&(i=!1);var n;n=this.inAppView()?o.appWorkbook:i?r.sharedDashboardWorkbook:a?r.dashboardWorkbook:o.workbook,a=a||this.currentDashboardGUID;var s=this.stateService.href(n,{workbookURLIdentifier:e,activeSelection:t,dashboardGUID:a},{inherit:!0});this.locationService.url(s)},t.prototype.showQnaView=function(e,t,i){var o={q:e};"filter"in jsCommon.QueryStringUtil.parseQueryString()&&(o.filter=null);var a;a=this.inQnaModelView()?r.modelQna:this.inSharedWithMePath()?r.sharedDashboardQna:this.inAppInstanceView()?r.appInstanceDashboardQna:this.inAppView()?r.appDashboardQna:r.dashboardQna,this.stateService.go(a,o,{location:this.convertLocationOption(t),inherit:!0,notify:!i})},t.prototype.showQnaStart=function(e){var t;t=this.inSharedWithMePath()?r.sharedDashboardQnaStart:this.inAppInstanceView()?r.appInstanceDashboardQnaStart:this.inAppView()?r.appDashboardQnaStart:r.dashboardQnaStart,this.stateService.go(t,{},{location:this.convertLocationOption(e),inherit:!0})},t.prototype.showInsightsPanel=function(e,t){var i=e.appGUID?r.appInsights:r.insights;this.stateService.go(i,e,{location:this.convertLocationOption(t),inherit:!0})},t.prototype.showAlertsEditor=function(e,t,i,o,a){var n={tileGUID:e,alertId:i,dashboardGUID:o};s.optionalAdd(n,"groupGUID",a),s.optionalAdd(n,"tileOriginalGUID",t),this.inAppInstanceView()?this.stateService.go(r.appInstanceAlertsEditor,n,{inherit:!0}):this.inAppView()?this.stateService.go(r.appAlertsEditor,n,{inherit:!0}):this.inSharedWithMePath()&&this.currentDashboardGUID==o?this.stateService.go(r.sharedAlertsEditor,n,{inherit:!0}):this.stateService.go(r.alertsEditor,n,{inherit:!0})},t.prototype.showInFocusMode=function(e,t,i,o,a){var n={tileGUID:e,dashboardGUID:i};s.optionalAdd(n,"groupGUID",a),s.optionalAdd(n,"tileOriginalGUID",t),s.optionalAdd(n,"dashboardOriginalGUID",o),this.inAppInstanceView()?this.stateService.go(r.appInstanceInFocusMode,n,{inherit:!0}):this.inAppView()?this.stateService.go(r.appInFocusMode,n,{inherit:!0}):this.inSharedWithMePath()&&this.currentDashboardGUID==i?this.stateService.go(r.sharedInFocusMode,n,{inherit:!0}):this.stateService.go(r.inFocusMode,n,{inherit:!0})},t.prototype.showInsightsInFocusMode=function(e,t,i,o){var a={tileGUID:e,dashboardGUID:i};s.optionalAdd(a,"groupGUID",o),s.optionalAdd(a,"tileOriginalGUID",t),this.inAppInstanceView()?this.stateService.go(r.appInstanceInFocusInsights,a,{inherit:!0}):this.inAppView()?this.stateService.go(r.appInFocusInsights,a,{inherit:!0}):this.inSharedWithMePath()&&this.currentDashboardGUID==i?this.stateService.go(r.sharedInFocusInsights,a,{inherit:!0}):this.stateService.go(r.inFocusInsights,a,{inherit:!0})},t.prototype.showSettingsSlider=function(e,t,i){var o=this.convertLocationOption(this.stateService.includes(r.settings)?2:0);this.stateService.go(t?r.settingsId:r.settingsGroup,{settingsGroup:e,settingsId:t},{location:o,inherit:!0,reload:i})},t.prototype.showPublishAppSlicer=function(e){this.stateService.go(r.publishApp,{appGUID:e},{inherit:!0})},t.prototype.showPublishedApps=function(){this.stateService.go(r.contentListPivot,{pivot:"apps"})},t.prototype.showPublishContentPackSlider=function(e){this.stateService.go(r.publishContent,{contentPackId:e},{inherit:!0})},t.prototype.showViewContentPackSlider=function(){this.stateService.go(r.viewContent,{},{inherit:!0})},t.prototype.showRowLevelSecuritySlider=function(e){this.stateService.go(r.rowLevelSecurity,{modelId:e},{inherit:!0})},t.prototype.showGetDataSlider=function(e,t,i,o,r){void 0===r&&(r=!0);var a={};a.categoryName=e,a.providerName=t,a.appsOnly=o,this.stateService.go(this.getGetDataStateNameFromParams(e,t),a,{location:this.convertLocationOption(i),inherit:!0,notify:r})},t.prototype.showDevToolsSlider=function(){this.stateService.go(r.devTools,{},{inherit:!0})},t.prototype.getGetDataStateNameFromParams=function(e,t){var i;return e||t||(e=this.categoryName,t=this.providerName),i=r.getData,e&&(i=t?r.getDataCategoryProviderName:r.getDataCategory),i},t.prototype.showManageStorageSlider=function(){this.stateService.go(r.manageStorage)},t.prototype.showManageEmbedSlider=function(){this.stateService.go(r.manageEmbed)},t.prototype.navigateBack=function(e){void 0===e&&(e=-1),this.$window.history.go(e)},t.prototype.navigateForward=function(){this.$window.history.forward()},t.prototype.inAdminPortalView=function(){return this.stateService.includes(r.adminPortal)},t.prototype.inAppsDetailView=function(){return this.stateService.is(r.apps)},t.prototype.inAppsView=function(){return this.stateService.includes(r.apps)},t.prototype.inAppView=function(){return this.stateService.includes(r.app)},t.prototype.inAppInstanceView=function(){return this.stateService.includes(r.appInstance)},t.prototype.inAppDetailView=function(){return this.stateService.is(r.app)||this.stateService.is(r.appInstance)},t.prototype.inGroupView=function(){return this.stateService.includes(r.groups)},t.prototype.inLandingContainerView=function(){return this.stateService.is(r.landing)},t.prototype.inDashboardSubscription=function(){return this.stateService.includes(o.dashboardSubscription)},t.prototype.inDashboardView=function(){var e=this.stateService.includes(r.dashboards)&&!this.stateService.includes(r.dashboardReports)&&!this.stateService.includes(r.dashboardWorkbook),t=this.stateService.includes(r.sharedDashboard)&&!this.stateService.includes(r.sharedDashboardReports)&&!this.stateService.includes(r.sharedDashboardWorkbooks);return this.conceptualModelSetting.isListViewEnabled()?e||t||this.stateService.includes(r.appDashboards)||this.stateService.includes(r.appInstanceDashboards):e||t||this.stateService.is(r.landing)},t.prototype.inDashboardPath=function(){return this.conceptualModelSetting.isListViewEnabled()?this.stateService.includes(r.dashboards)||this.stateService.includes(r.appDashboards)||this.stateService.includes(r.appInstanceDashboards)||this.stateService.includes(r.sharedDashboard):this.stateService.includes(r.dashboards)||this.stateService.is(r.landing)},t.prototype.inHomeDashboardView=function(){return this.stateService.includes(r.home)},t.prototype.inFavoritesView=function(){return this.stateService.includes(r.favorites)},t.prototype.inCapacitySettingsView=function(){return this.stateService.includes(r.adminPortalCapacities)},t.prototype.inContentListView=function(e){return!!this.stateService.includes(r.contentList)&&(!e||"true"===this.stateService.params.onlySharedWithMe)},t.prototype.inSharedWithMePath=function(){return this.stateService.includes(r.sharedWithMe)||this.inContentListView(!0)},t.prototype.inSharedWithMeView=function(){return this.stateService.is(r.sharedWithMe)||this.inContentListView(!0)},t.prototype.inPublishContentPackView=function(){return this.stateService.includes(r.publishContent)},t.prototype.inViewContentPackView=function(){return this.stateService.includes(r.viewContent)},t.prototype.inRowLevelSecurityView=function(){return this.stateService.includes(r.rowLevelSecurity)},t.prototype.inDashboardDetailView=function(){return this.stateService.is(r.dashboard)||this.stateService.is(r.appDashboard)||this.stateService.is(r.appInstanceDashboard)||this.stateService.is(r.sharedDashboard)},t.prototype.inGroupWelcomeView=function(){return this.stateService.is(r.groupWelcome)},t.prototype.inQnaView=function(){
return this.stateService.includes(r.dashboardQna)||this.stateService.includes(r.sharedDashboardQna)||this.stateService.includes(r.appInstanceDashboardQna)||this.stateService.includes(r.appDashboardQna)},t.prototype.inQnaModelView=function(){return this.stateService.includes(r.modelQna)},t.prototype.inQnaStartView=function(){return this.stateService.includes(r.dashboardQnaStart)||this.stateService.includes(r.sharedDashboardQnaStart)||this.stateService.includes(r.appInstanceDashboardQnaStart)||this.stateService.includes(r.appDashboardQnaStart)},t.prototype.inExtendTrial=function(){return this.stateService.includes(r.extendTrial)},t.prototype.inAccept2017ProTrial=function(){return this.stateService.includes(r.accept2017ProTrial)},t.prototype.inInsightsView=function(){return this.stateService.includes(r.insights)||this.stateService.includes(r.appInsights)},t.prototype.inRecentlyViewedView=function(){return this.stateService.includes(r.recentlyViewed)},t.prototype.inReportView=function(){return this.stateService.includes(o.reports)||this.stateService.includes(o.appReports)||this.stateService.includes(o.appInstanceReports)||this.stateService.includes(r.sharedDashboardReports)||this.stateService.includes(r.dashboardReports)},t.prototype.inReportDetailView=function(){return this.stateService.includes(o.report)||this.stateService.includes(o.appReport)||this.stateService.includes(o.appInstanceReport)||this.stateService.includes(r.sharedDashboardReport)||this.stateService.includes(r.dashboardReport)},t.prototype.inReportSubscriptionView=function(){return this.stateService.includes(o.reportSubscription)},t.prototype.inDatasetView=function(){return this.stateService.includes(o.dataset)},t.prototype.inManageDatasetView=function(){return this.stateService.is(o.datasets)},t.prototype.inManageStreamingDatasetView=function(){return this.stateService.is(o.streamingDatasets)},t.prototype.inGatewaysView=function(){return this.stateService.includes(r.gateways)},t.prototype.inDatasetDetailView=function(){return this.stateService.includes(o.dataset)},t.prototype.inWorkbookView=function(){return this.stateService.includes(o.workbook)||this.stateService.includes(o.appWorkbook)||this.stateService.includes(r.dashboardWorkbook)||this.stateService.includes(r.sharedDashboardWorkbook)},t.prototype.inWorkspacesView=function(){return this.stateService.includes(e.constants.navigation.states.workspaces)},t.prototype.inGetDataView=function(){return this.stateService.includes(r.getData)},t.prototype.inGetDataCategoryView=function(){return this.stateService.includes(r.getDataCategory)},t.prototype.inGetDataCategoryProviderView=function(){return this.stateService.includes(r.getDataCategoryProviderName)},t.prototype.inSharingView=function(){return this.stateService.includes(r.sharedDashboardShare)||this.stateService.includes(r.dashboardShare)},t.prototype.inAlertsEditorView=function(){return this.stateService.includes(r.alertsEditor)||this.stateService.includes(r.appAlertsEditor)||this.stateService.includes(r.appInstanceAlertsEditor)||this.stateService.includes(r.sharedAlertsEditor)},t.prototype.inInFocusView=function(){return this.stateService.includes(r.inFocusMode)||this.stateService.includes(r.appInFocusMode)||this.stateService.includes(r.appInstanceInFocusMode)||this.stateService.includes(r.sharedInFocusMode)},t.prototype.inInFocusInsightsView=function(){return this.stateService.includes(r.inFocusInsights)||this.stateService.includes(r.appInFocusInsights)||this.stateService.includes(r.appInstanceInFocusInsights)||this.stateService.includes(r.sharedInFocusInsights)},t.prototype.inFullPageSliderView=function(){return this.stateService.current.data&&this.stateService.current.data.fullPageSlider},t.prototype.inContentSliderView=function(){return this.stateService.current.data&&this.stateService.current.data.contentSlider},t.prototype.inManageStorageView=function(){return this.stateService.includes(r.manageStorage)},t.prototype.inSettingsView=function(){return this.stateService.includes(r.settings)},t.prototype.inManageEmbedView=function(){return this.stateService.includes(r.manageEmbed)},t.prototype.inRequestDashboardAccessView=function(){return this.stateService.includes(r.dashboardRequestAccess)||this.stateService.includes(r.sharedDashboardRequestAccess)},t.prototype.inReportEmbedView=function(){return!1},t.prototype.navigateToReportInternal=function(e,t,i,a){var n,s=_.extend({location:this.convertLocationOption(t),inherit:!0,notify:!0},i);return n=e.appGUID?e.appInstanceId?o.appInstanceReportPage:o.appReportPage:a||e.subscriptionGUID?o.reportSubscription:e.dashboardGUID?this.inSharedWithMePath()&&e.dashboardGUID==this.currentDashboardGUID?r.sharedDashboardReportPage:r.dashboardReportPage:o.reportPage,this.stateService.go(n,e,s)},Object.defineProperty(t.prototype,"contentListTab",{get:function(){var e=+this.stateService.params.contentListTab;return _.isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentDatasetDBName",{get:function(){return this.stateService.params.datasetDBName},set:function(e){this.stateService.params.datasetDBName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentGroupGUID",{get:function(){return this.stateService.params.groupGUID},set:function(e){this.stateService.params.groupGUID=e,this.stateParams.groupGUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentDashboardGUID",{get:function(){return this.stateService.params.dashboardGUID},set:function(e){this.stateService.params.dashboardGUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentDashboardOriginalGUID",{get:function(){return this.stateService.params.dashboardOriginalGUID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentAppGUID",{get:function(){return this.stateService.params.appGUID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentAppInstanceId",{get:function(){return parseInt(this.stateService.params.appInstanceId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTileGUID",{get:function(){return this.stateService.params.tileGUID},set:function(e){this.stateService.params.tileGUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTileOriginalGUID",{get:function(){return this.stateService.params.tileOriginalGUID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentAlertId",{get:function(){return parseInt(this.stateService.params.alertId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentReportGUID",{get:function(){return this.stateService.params.reportGUID},set:function(e){this.stateService.params.reportGUID=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentReportOriginalGUID",{get:function(){return this.stateService.params.reportOriginalGUID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentWorkbookURLIdentifier",{get:function(){return this.stateService.params.workbookURLIdentifier},set:function(e){this.stateService.params.workbookURLIdentifier=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentWorkbookActiveSelection",{get:function(){return this.stateService.params.activeSelection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentReportPage",{get:function(){return this.stateService.params.reportPage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentSubscriptionGUID",{get:function(){return this.stateService.params.subscriptionGUID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentInviteId",{get:function(){return this.stateService.params.inviteid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentInviteObjectId",{get:function(){return this.stateService.params.inviteoid},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentAdminPortalSettingsTab",{get:function(){return this.stateService.params.adminPortalSettingsTab},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"instantiationMode",{get:function(){return this.stateService.params.instantiationMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"categoryName",{get:function(){return this.stateService.params.categoryName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appsOnly",{get:function(){return this.stateService.params.appsOnly},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"providerName",{get:function(){return this.stateService.params.providerName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"settingsGroup",{get:function(){return this.stateService.params.settingsGroup},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"settingsId",{get:function(){return this.stateService.params.settingsId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentCapacityId",{get:function(){return this.stateService.params.capacityId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"gatewayId",{get:function(){return parseInt(this.stateService.params.gatewayId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataSourceId",{get:function(){return parseInt(this.stateService.params.dataSourceId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"qnaQuery",{get:function(){return this.stateService.params.q},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"searchText",{get:function(){return this.stateService.params.q},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"insightsDataGUID",{get:function(){return this.stateService.params.dataGUID},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"insightsSource",{get:function(){return this.stateService.params.insightsSource},enumerable:!0,configurable:!0}),t.prototype.resetInsightsSource=function(){this.stateService.go(this.stateService.current.name,{insightsSource:null},{location:this.convertLocationOption(2),inherit:!0,notify:!1})},Object.defineProperty(t.prototype,"contentPack",{get:function(){var e=parseInt(this.stateService.params.contentPackId);return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contentPackProviderKey",{get:function(){var e=this.stateService.params.contentPackProviderKey;return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rowLevelSecurityModelId",{get:function(){var e=parseInt(this.stateService.params.modelId);return isNaN(e)?void 0:e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"additionalODataFilter",{get:function(){return this.stateService.params.filter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"collapseNavigation",{get:function(){return this.stateService.params.collapseNavigation},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stateService",{get:function(){return this.$state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"locationService",{get:function(){return this.$location},enumerable:!0,configurable:!0}),t})();t.Navigation=a;var n=(function(){function e(e,t){this.promiseFactory=t,this.locationService=e}return e.prototype.navigateToReport=function(e,t,i){this.currentReportGUID=e.reportGUID,this.currentReportPage=e.reportPage,this.currentReportOriginalGUID=e.reportOriginalGUID,this.currentAppGUID=e.appGUID,this.currentAppInstanceId=e.appInstanceId,this.currentGroupGUID=e.groupGUID},e.prototype.replaceHistoryWithDashboardAndNavigate=function(e,t,i){this.currentDashboardGUID=e},e.prototype.replaceHistoryWithDatasetAndNavigate=function(e,t,i){},e.prototype.replaceHistoryWithGroupWelcomeAndNavigate=function(e,t,i){},e.prototype.replaceAndLoadCurrentState=function(e,t){},e.prototype.navigateToContentListOrActiveDashboard=function(){},e.prototype.navigateToActiveDashboard=function(){},e.prototype.navigateToGroupByGUID=function(e,t){},e.prototype.navigateToDatasets=function(){},e.prototype.navigateToStreamingDatasets=function(e){},e.prototype.navigateToDashboardByGUID=function(e,t,i){this.currentDashboardGUID=e},e.prototype.navigateToAppDashboardByGUID=function(e,t,i,o,r,a,n){void 0===a&&(a=!0),void 0===n&&(n=null),this.currentDashboardGUID=e,this.currentDashboardOriginalGUID=t,this.currentAppGUID=i,_.isEmpty(o)||(this.currentGroupGUID=o)},e.prototype.navigateToAppWorkbookByUniqueId=function(e,t,i,o){this.currentWorkbookURLIdentifier=e,this.currentAppGUID=t,_.isEmpty(i)||(this.currentGroupGUID=i)},e.prototype.navigateToHomeDashboard=function(){},e.prototype.insertGroupAndNavigateToDashboardByGUID=function(e,t,i){this.currentDashboardGUID=e},e.prototype.navigateToSharedDashboardByGUID=function(e,t){this.currentDashboardGUID=e},e.prototype.insertGroupAndNavigateToWorkbookByUniqueId=function(e,t,i){},e.prototype.navigateToApps=function(){},e.prototype.navigateToApp=function(e){this.currentAppGUID=e},e.prototype.navigateToFavorites=function(){},e.prototype.navigateToContentList=function(e){},e.prototype.navigateToContentListParams=function(e,t,i){},e.prototype.changeContentListPivot=function(e){},e.prototype.navigateToEmptyFeaturedDashboard=function(){},e.prototype.navigateToRecentlyViewed=function(){},e.prototype.navigateToSharedWithMe=function(e){},e.prototype.navigateToWorkspaces=function(){},e.prototype.navigateToRequestDashboardAccessByGUID=function(e,t){},e.prototype.navigateToReportSubscriptionsPane=function(e){},e.prototype.navigateToDashboardSubscriptionsPane=function(e,t){},e.prototype.resetToMyWorkspace=function(){},e.prototype.updateReportStateNoReload=function(e,t,i){return this.promiseFactory.resolve(null)},e.prototype.initialLoadDatasetByDBName=function(e,t){},e.prototype.initialLoadReportByGUID=function(e,t,i,o){},e.prototype.navigateToDatasetByDBName=function(e,t){},e.prototype.navigateToGroupWelcome=function(){},e.prototype.navigateToWorkbookByUrlId=function(e,t,i,o){},e.prototype.toggleArchivedContent=function(e){},e.prototype.navigateToGateways=function(){},e.prototype.navigateToAdminPortal=function(e){},e.prototype.navigateToAdminPortalCapacity=function(e){},e.prototype.navigateToAppAutoInstall=function(){},e.prototype.showQnaView=function(e,t,i){},e.prototype.showQnaStart=function(e){},e.prototype.showInsightsPanel=function(e,t){},e.prototype.showShareSlider=function(e){},e.prototype.showAlertsEditor=function(e,t,i,o,r){},e.prototype.showInFocusMode=function(e,t,i,o,r){},e.prototype.showInsightsInFocusMode=function(e,t,i,o){},e.prototype.showSettingsSlider=function(e,t){},e.prototype.showPublishAppSlicer=function(e){},e.prototype.showPublishedApps=function(){},e.prototype.showPublishContentPackSlider=function(e){},e.prototype.showViewContentPackSlider=function(){},e.prototype.showGetDataSlider=function(e,t,i){},e.prototype.showDevToolsSlider=function(){},e.prototype.showAuthorCustomTileSlider=function(){},e.prototype.showRowLevelSecuritySlider=function(e){},e.prototype.getGetDataStateNameFromParams=function(e,t){return""},e.prototype.showManageStorageSlider=function(e){},e.prototype.showManageEmbedSlider=function(){},e.prototype.inContentSliderView=function(){return!1},e.prototype.inFullPageSliderView=function(){return!1},e.prototype.navigateBack=function(e){},e.prototype.navigateForward=function(){},e.prototype.resetInsightsSource=function(){},e.prototype.inAdminPortalView=function(){return!1},e.prototype.inAppView=function(){return!1},e.prototype.inAppInstanceView=function(){return!1},e.prototype.inAppDetailView=function(){return!1},e.prototype.inAppsDetailView=function(){return!1},e.prototype.inAppsView=function(){return!1},e.prototype.inDatasetView=function(){return!1},e.prototype.inManageDatasetView=function(){return!1},e.prototype.inManageStreamingDatasetView=function(){return!1},e.prototype.inDatasetDetailView=function(){return!1},e.prototype.inGroupView=function(){return!1},e.prototype.inLandingContainerView=function(){return!1},e.prototype.inDashboardView=function(){return!1},e.prototype.inDashboardSubscription=function(){return!1},e.prototype.inDashboardPath=function(){return!1},e.prototype.inDashboardDetailView=function(){return!1},e.prototype.inGroupWelcomeView=function(){return!1},e.prototype.inRecentlyViewedView=function(){return!1},e.prototype.inSharedWithMePath=function(){return!1},e.prototype.inSharedWithMeView=function(){return!1},e.prototype.inReportView=function(){return!1},e.prototype.inReportSubscriptionView=function(){return!1},e.prototype.inFavoritesView=function(){return!1},e.prototype.inContentListView=function(){return!1},e.prototype.inHomeDashboardView=function(){return!1},e.prototype.inReportDetailView=function(){return!1},e.prototype.inWorkbookView=function(){return!1},e.prototype.inQnaView=function(){return!1},e.prototype.inQnaModelView=function(){return!1},e.prototype.inQnaStartView=function(){return!1},e.prototype.inExtendTrial=function(){return!1},e.prototype.inAccept2017ProTrial=function(){return!1},e.prototype.inInsightsView=function(){return!1},e.prototype.inGetDataView=function(){return!1},e.prototype.inGetDataCategoryView=function(){return!1},e.prototype.inGetDataCategoryProviderView=function(){return!1},e.prototype.inPublishContentPackView=function(){return!1},e.prototype.inViewContentPackView=function(){return!1},e.prototype.inSharingView=function(){return!1},e.prototype.inInFocusView=function(){return!1},e.prototype.inInFocusInsightsView=function(){return!1},e.prototype.inManageStorageView=function(){return!1},e.prototype.inSettingsView=function(){return!1},e.prototype.inGatewaysView=function(){return!1},e.prototype.inManageEmbedView=function(){return!1},e.prototype.inRequestDashboardAccessView=function(){return!1},e.prototype.inReportEmbedView=function(){return!1},e.prototype.inRowLevelSecurityView=function(){return!1},e.prototype.inAlertsEditorView=function(){return!1},e.prototype.inWorkspacesView=function(){return!1},e.prototype.inCapacitySettingsView=function(){return!1},e.prototype.navigateToGatewayItem=function(e,t){},e})();t.MockNavigation=n;var s;!(function(e){function t(e,t,i){angular.isDefined(i)&&(e[t]=i)}e.optionalAdd=t})(s=t.NavigationHelper||(t.NavigationHelper={}))})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g,m,f,y,b){return new s(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g,m,f,y,b)}var o,r=e.dataServices.constants,a=jsCommon.EnumExtensions,n=e.common.contracts.PublishOrRefreshStatus;!(function(e){e[e.Dashboard=1]="Dashboard",e[e.Report=2]="Report",e[e.Dataset=3]="Dataset"})(o=t.DeleteContentPackMessageType||(t.DeleteContentPackMessageType={})),t.createNavigationActions=i;var s=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){this.$rootScope=e,this.contentPackService=t,this.dashboardService=i,this.errorService=o,this.featureSwitchService=r,this.groupService=a,this.localizationService=n,this.modalDialogService=s,this.modelService=c,this.navigation=l,this.notificationToast=d,this.packageService=p,this.quota=u,this.reportService=v,this.telemetryService=h,this.workbookService=g,this.ownershipService=m,this.lazy=f,this.navigationHelper=y,this.pendingDatasetReadyNotification=[]}return t.prototype.initialize=function(){var t=this;this.$rootScope.$on(e.constants.openReportEventName,(function(e,i){e.stopPropagation(),e.preventDefault();var o=t.reportService.findReport(i);t.openReport(o)})),this.$rootScope.$on(e.constants.deleteReportEventName,(function(e,i){e.stopPropagation(),e.preventDefault(),t.deleteReport(i)})),this.$rootScope.$on(e.constants.deleteModelEventName,(function(e,i,o,r){e.stopPropagation(),e.preventDefault();var a=t.modelService.findModel(i,o);a&&a.isUsedByContentPack?t.contentPackService.showDialogOnModelDeleteInContentPack(i):t.deleteModel(i,o,r)})),this.$rootScope.$on(e.constants.renameModelEventName,(function(e,i,o,r){e.stopPropagation(),e.preventDefault(),t.modelService.renameModel(i,o,r)})),this.$rootScope.$on(e.constants.showInsightsEventName,(function(i,o,r){return __awaiter(t,void 0,e.Promise,(function(){var t,a;return __generator(this,(function(n){switch(n.label){case 0:return i.stopPropagation(),i.preventDefault(),t=this.modelService.findModel(o,r),[4,this.lazy("insightsBootstrap")];case 1:return a=n.sent(),a.start(t.dbName,t.vsName,r,e.insights.constants.insightsSourceToast),[2]}}))}))})),this.$rootScope.$on(e.constants.replaceLocalWorkbookEventName,(function(i,o){i.stopPropagation(),i.preventDefault(),t.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.GetData)||t.workbookService.replaceLocalWorkbook(o)})),this.$rootScope.$on(r.workbook.viewWorkbookEventName,(function(e,i,o){e.stopPropagation(),e.preventDefault();var r=t.workbookService.findWorkbook(i,o);t.viewWorkbook(r)})),this.$rootScope.$on(e.dataServices.constants.workbook.removeWorkbookEventName,(function(e,i,o){e.stopPropagation(),e.preventDefault();var r=t.workbookService.findWorkbook(i.id,i.packageId);r&&r.isUsedByContentPack?t.contentPackService.showDialogOnWorkbookRemoveInContentPack(i.id):t.removeWorkbook(r,o)})),this.$rootScope.$on(e.dataServices.constants.packagePublishedSuccessfullyEventName,(function(e,i){var o=t.findDashboardsByPackageId(i);if(1===o.length&&o[0].isNew&&1===o[0].contract.packageIds.length&&!o[0].isNotified)t.notifyNewDashboardIsReady(o[0]);else{var r=t.modelService.findModelByPackageId(i);r?t.notifyNewDatasetIsReady(r,i):(t.pendingDatasetReadyNotification.push(i),t.unregisterModelWatch||(t.unregisterModelWatch=t.$rootScope.$watch((function(){return t.modelService.lastUpdatedTimestamp}),(function(){t.pendingDatasetReadyNotification=_.filter(t.pendingDatasetReadyNotification,(function(e){var i=t.modelService.findModelByPackageId(e);return!i||(t.notifyNewDatasetIsReady(i,e),!1)})),_.isEmpty(t.pendingDatasetReadyNotification)&&(t.unregisterModelWatch(),t.unregisterModelWatch=null)}))))}}))},t.prototype.openReport=function(e){return e.isNew=!1,null!=e.packagePublishStatus&&e.packagePublishStatus!==n.FinishedSuccessfully&&e.packagePublishStatus!==n.RefreshInProgress&&e.packagePublishStatus!==n.RefreshError?void(e.packagePublishStatus===n.PublishError&&this.deleteReportOnPublishFailure(e.id)):void this.navigationHelper.navigateToReport(e)},t.prototype.openModel=function(t){return null!=t.contract.packagePublishStatus&&t.contract.packagePublishStatus!==n.FinishedSuccessfully&&t.contract.packagePublishStatus!==n.RefreshInProgress&&t.contract.packagePublishStatus!==n.RefreshError?void(t.contract.packagePublishStatus===n.PublishError&&this.deleteModelOnPublishFailure(t.id)):(t.isNew=t.contract.isNew=!1,void(this.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.OpenDataset)||a.hasFlag(t.getPermissions(),e.common.models.ReportPermissions.CopyOnWrite)||this.navigation.navigateToDatasetByDBName(t.dbName)))},t.prototype.viewWorkbook=function(e){if(e.isNew=!1,this.featureSwitchService.featureSwitches.embedFullFidelityWorkbooks){var t=this.workbookService.getWorkbookUniqueId(e),i=this.ownershipService.isResourceSharedWithMe(e);this.navigation.navigateToWorkbookByUrlId(t,null,i)}else this.$rootScope.$emit(r.workbook.openWorkbookContextMenuEventName,e)},t.prototype.deleteItemOnPublishFailure=function(e,t,i){var o=this,r=this.errorService.control(),a=[new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Delete"),function(e,t){r.hideDialog(),i()}),new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){r.hideDialog()})];r.showCustomDialog(e,$("<div/>").text(t),a,(function(e){e.parent().find('input[value="'+o.localizationService.get("PBI_Button_Label_Cancel")+'"]').focus()}),!0)},t.prototype.deleteModelOnPublishFailure=function(e){var t=this;this.deleteItemOnPublishFailure(this.localizationService.get("NavigationPane_ModelPublishErrorTitle"),this.localizationService.get("NavigationPane_ModelPublishErrorContent"),(function(){t.modelService.deleteModel(e)}))},t.prototype.findDashboardsByPackageId=function(e){return _.filter(this.dashboardService.dashboards,(function(t){return t.contract.packageIds&&t.contract.packageIds.indexOf(e)>=0}))},t.prototype.deleteReport=function(e){var t=this,i=this.$rootScope.$new(),o=this.errorService.control(),r=[new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Delete"),function(i,r){o.hideDialog();var a=t.reportService.findReport(e);t.reportService.deleteReport(e),a&&a.objectId===t.navigation.currentReportGUID&&t.navigation.navigateToActiveDashboard()}),new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){o.hideDialog()})],a=this.reportService.findReport(e);i.message=this.localizationService.format("Report_DeleteConfirmationMessage",[a.displayName]);var n,s,c=this.dashboardService.hasTileForReportandSection(void 0,e);c&&(n=jsCommon.ModalDialogNotificationType.Warning,s=this.localizationService.get("PinLiveReport_DeleteReportWarning"));var l={dialogName:this.localizationService.get("Report_DeleteConfirmationTitle"),isDismissable:!0,scope:i,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",focusOnFirstButton:!0,dialogActions:r,notificationType:n,notificationText:s};this.modalDialogService.showLegacyWebModalDialog(l)},t.prototype.deleteModel=function(e,t,i){var r,a,n=this,s=this.errorService.control(),c=[new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Delete"),function(i,o){s.hideDialog();var r=!!n.reportService.findReportByGUID(n.navigation.currentReportGUID),a=n.modelService.findModel(e,t),c=a?a.dbName:null,l=n.navigation;n.modelService.deleteModel(e,t),(n.reportService.currentActiveReport&&n.reportService.currentActiveReport.id===e||r&&!n.reportService.findReport(n.reportService.currentActiveReport.id)||l.inInsightsView()&&l.insightsDataGUID===c||l.inRowLevelSecurityView()&&l.rowLevelSecurityModelId===a.id)&&l.navigateToActiveDashboard()}),new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){s.hideDialog()})],l=this.modelService.findModel(e,t);switch(i){case o.Dashboard:r=this.localizationService.get("Dashboard_DeleteConfirmationTitle"),a=this.localizationService.get("Dashboard_DeleteOrgAppContentPack");break;case o.Report:r=this.localizationService.get("Report_DeleteConfirmationTitle"),a=this.localizationService.get("Report_DeleteOrgAppContentPack");break;case o.Dataset:r=this.localizationService.get("Model_DeleteConfirmationTitle"),a=this.localizationService.get("Model_DeleteOrgAppContentPack");break;default:r=this.localizationService.get("Model_DeleteConfirmationTitle"),a=this.localizationService.format("Model_DeleteConfirmationMessage",[l.displayName])}s.showCustomDialog(r,$("<div/>").text(a),c,(function(e){e.parent().find('input[value="'+n.localizationService.get("PBI_Button_Label_Cancel")+'"]').focus()}),!0)},t.prototype.deleteReportOnPublishFailure=function(e){var t=this;this.deleteItemOnPublishFailure(this.localizationService.get("NavigationPane_ReportPublishErrorTitle"),this.localizationService.get("NavigationPane_ReportPublishErrorContent"),(function(){t.reportService.deleteReport(e)}))},t.prototype.removeWorkbook=function(e,t){var i,r,a=this;switch(t){case o.Dashboard:i="Dashboard_DeleteConfirmationTitle",r="Dashboard_DeleteConfirmationTitle";break;default:i="Workbook_RemoveConfirmationTitle",r=e.isOwner()?this.packageService.isLocalWorkbook(e.packageId)?"Workbook_RemoveOwnedLocalConfirmationMessage":"Workbook_RemoveOwnedRemoteConfirmationMessage":e.isPersonalized()?"Workbook_RemovePersonalizedConfirmationMessage":"Workbook_RemoveInOrgPackConfirmationMessage"}var n=this.localizationService.get(i),s=this.localizationService.get(r),c=this.errorService.control(),l=[new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Remove"),function(t,i){c.hideDialog(),a.workbookService.removeWorkbook(e.id,e.packageId,a.packageService.getWorkbookStorageProvider(e.packageId),a.packageService.getWorkbookContentProvider(e.packageId));var o=a.workbookService.currentActiveWorkbook;o&&o.id===e.id&&o.packageId===e.packageId&&a.navigation.navigateToActiveDashboard()}),new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){c.hideDialog()})];c.showCustomDialog(n,$("<div/>").text(s),l,(function(e){e.parent().find('input[value="'+a.localizationService.get("PBI_Button_Label_Cancel")+'"]').focus()}),!0)},t.prototype.notifyNewDashboardIsReady=function(t){var i=this,o={description:t.displayName,displayText:this.localizationService.get("ToastNotification_GoToDashboard"),action:function(){i.navigation.navigateToDashboardByGUID(t.objectId)}};this.notificationToast.notify({title:this.localizationService.get("Publish_Success"),message:this.localizationService.get("NotificationMessage_NewDashboardCreatedTitle"),notificationType:e.common.NotificationToastType.Success,actionButtons:[o]}),t.isNotified=!0},t.prototype.notifyNewDatasetIsReady=function(t,i){var o=this,r=this.dashboardService.getActiveDashboard();if(t&&t.isNew&&!t.isHidden&&(t.getPermissions()&Permissions.All)===Permissions.All&&t.contract.insightsSupported&&r&&!r.isUsedByContentPack){var a,n={displayText:this.localizationService.get("DatasetUploadedToast_ExploreInsights"),action:function(){return __awaiter(o,void 0,e.Promise,(function(){var o;return __generator(this,(function(r){switch(r.label){case 0:return[4,this.lazy("insightsBootstrap")];case 1:return o=r.sent(),o.start(t.dbName,t.vsName,i,e.insights.constants.insightsSourceToast),[2]}}))}))}},s={displayText:this.localizationService.get("DatasetUploadedToast_ViewDataset"),action:function(){var e=o.modelService.findModel(t.id,i);o.openModel(e)}};a=this.notificationToast.notify({title:this.localizationService.get("DatasetUploadedToast_ReadyToExploreTitle"),message:this.localizationService.get("DatasetUploadedToast_ReadyToExploreSubtitle"),notificationType:e.common.NotificationToastType.Success,actionButtons:[s],actionLinks:[n],sticky:!0})}},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=(function(){function t(e,t,i,o,r,a){this.$rootScope=e,this.$document=t,this.telemetryService=i,this.localizationService=o,this.modalDialogService=r,this.tutorialDataStore=a}return t.prototype.showModal=function(t){var i=this,o=null,r=null;if(t){r=e.telemetry.ModalFor.IntroductionModal;var a=this.telemetryService.startEvent(e.telemetry.PreviewFeaturesIntroductionModalLogged);this.tutorialDataStore.setKey(e.constants.previewfeaturesModalKey,!0,a),o=[new InJs.ModalDialogAction(this.localizationService.get("PreviewFeaturesModal_TryItNow"),function(){i.setUserPreference(!0),s.closeDialog()}),new InJs.ModalDialogAction(this.localizationService.get("PreviewFeaturesModal_MaybeLater"),function(){i.setUserPreference(!1),s.closeDialog()})]}else r=e.telemetry.ModalFor.HelpModal,o=[new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Close"),function(){s.closeDialog()})];var n=this.telemetryService.startEvent(e.telemetry.PreviewFeaturesModalShown,r),s=this.modalDialogService.showLegacyWebModalDialog({dialogName:"",template:"<preview-features-modal></preview-features-modeal>",dialogActions:o,scope:this.$rootScope.$new(!0),dialogCssClass:"previewFeaturesModal",isDismissable:!1,onCloseDialog:function(){n.resolve()}})},t.prototype.showFeedbackModal=function(){var t=null;t=[new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Close"),function(){o.closeDialog()})];var o=this.modalDialogService.showLegacyWebModalDialog({dialogName:"",template:"<preview-feedback-modal></preview-feedback-modal>",dialogActions:t,scope:this.$rootScope.$new(!0),dialogCssClass:"previewFeedbackModal",isDismissable:!1}),r=this.telemetryService.startEvent(e.telemetry.PreviewConceptualModel,!1,e.telemetry.From.IntroductionModal);this.tutorialDataStore.setKey(i.previewConceptualModelKey,!1,r)},t.prototype.setUserPreference=function(t){
var o=this.telemetryService.startEvent(e.telemetry.PreviewConceptualModel,t,e.telemetry.From.IntroductionModal);this.tutorialDataStore.setKey(i.previewConceptualModelNewKey,t,o)},t})();t.PreviewFeaturesModalService=o})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t=e.dataServices.AppUtils,i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.helpers,r=e.common.constants.navigation.states,a=e.errorDetailsHelper,n=e.dataServices.models.Dashboard,s=e.controllers.DashboardContainerController,c=e.dataServices.models.DashboardTileModel,l=e.dataServices.constants,d=e.dataServices.models.getDashboardGuidFromUrl,p=e.constants.navigation.states,u=e.dataServices.contracts.PackageType,v=e.common.models.Report,h=e.dataServices.TileUtils,g=e.common.contracts.Permissions,m=e.explore.services,f=e.common.constants.TaskPaneCollapsiblePaneMode,y=e.dataServices.models.Workbook,b=10,S=2e3,w=3,C=(function(){function C(t,i,o,r,a,n,s,c,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M,k,P,E,A,_,R,x,N,L,F,G,O,z,U,B,$,V,W,H,j,q,Q,K,J){var Y=this;this.$location=t,this.rootScope=i,this.navigation=o,this.timeout=r,this.telemetryService=a,this.errorService=n,this.modelMerger=s,this.modelConverter=c,this.syncService=d,this.dashboardConfigurationService=p,this.dashboardDataService=u,this.dashboardHttpService=v,this.dashboardSyncService=h,this.dashboardWarningsService=g,this.fullScreen=m,this.localizationService=f,this.promiseFactory=y,this.reportService=b,this.modelHttpService=S,this.viralTenantMergeHelperService=w,this.groupService=C,this.featureSwitchService=D,this.modelService=I,this.licenseEnforcementService=T,this.userInfo=M,this.contentProviderHttpService=k,this.storageUsageService=P,this.appMetadataService=E,this.permissionService=A,this.workbookService=_,this.notificationBar=R,this.notificationToastService=x,this.resourcePackagesService=N,this.userSettingsService=L,this.visualPluginService=F,this.invitationService=G,this.resourcePackageGateService=O,this.home=z,this.packageService=U,this.inFocusService=B,this.userActivityContextService=$,this.mostRecentlyUsedService=V,this.appService=W,this.editableFeatureSwitchService=H,this.conceptualModelSetting=j,this.taskPaneSliderService=q,this.fileSaver=Q,this.navigationHelper=K,this.lazy=J,this.temporayObjectID=function(e){return"TEMP_ID"+e},this.temporaryDashboardId=-100,this.temporaryTileId=-100,this.dashboardCacheLimit=5,this.modelIdsForTileRefresh=[],this.readyForConceptualModelInitializationDeferred=this.promiseFactory.defer(),this.readyForConceptualModelInitializationPromise=this.readyForConceptualModelInitializationDeferred.promise,this.dashboardsOwnersMergedDeferred=this.promiseFactory.defer(),this.dashboardsDeferred=this.promiseFactory.defer(),this.loadAndInitializeDashboardsOnInvitation(),this.mergeDashboardOwnerInfoOnPageLoad(),this.updateActiveDashboardPromise=void 0,this.dashboardSyncService.beforeDashboardDeleting=function(e){Y.beforeDashboardDeletingHandler(e)},this.dashboardSyncService.afterDashboardDeleting=function(e){Y.afterDashboardDeletingHandler(e)};var X=this.rootScope.$on(e.constants.renameDashboardEventName,(function(e,t,i){return Y.renameDashboard(t,i)})),Z=this.rootScope.$on(e.constants.groupSwitchedEventName,(function(e,t,i,o){return Y.onGroupSwitched(t,i,o)})),ee=this.rootScope.$on(e.constants.notifyDashboardUpdate,(function(e){return Y.notifyDashboardUpdate()})),te=this.rootScope.$on(l.onDashboardShallowEditEventName,(function(e,t,i){return Y.onDashboardShallowEdit(t,i)})),ie=this.rootScope.$on(l.addOrUpdateDashboardEventName,(function(e,t,i){return Y.addOrUpdateDashboard(t,i)})),oe=this.rootScope.$on(l.mergeDashboardContainerModelsReportsAndPackagesEventName,(function(t,i){return e.contracts.mergeDashboardContainerModelsReportsAndPackages(i,Y.dashboardContainerModel.contract)})),re=this.rootScope.$on(l.updateDashboardContainerEventName,(function(e,t){return Y.updateDashboardContainer(t)})),ae=this.rootScope.$on(e.dataServices.constants.packageVersionChange,(function(e,t){return Y.updateDashboardWithPackageInfo(e,t)}));this.rootScope.$on("$destroy",(function(){ee(),Z(),X(),ae(),te(),ie(),oe(),re(),ae()}))}return C.prototype.getDashboards=function(){return this.dashboardsDeferred.promise.then((function(e){return e.dashboards}))},C.prototype.dashboardsOwnersMergedPromise=function(){return this.dashboardsOwnersMergedDeferred.promise},C.prototype.updateCachedContainer=function(){var e=null,t=this.dashboardDataService.dashboards;e=_.map(t,(function(e){var t=__assign({},e.contract);return t.tiles=_.map(t.tiles,(function(e){var t=__assign({},e);return t.config&&t.config.indexOf("imageTile")>0&&(e.config=null),e.$config&&!e.$config.workbookTile&&(e.$config=null),e.$action=null,t.tileDataSet=null,t})),t.cached=!0,t.hitCount=e.hitCount,t}));var i=_.sortBy(_.filter(e,(function(e){return e.tiles&&e.tiles.length>0&&e.hitCount>0})),(function(e){return 0-e.hitCount}));return i&&i.length>this.dashboardCacheLimit&&i.splice(this.dashboardCacheLimit),i},C.prototype.mergeDashboardOwnerInfoOnPageLoad=function(){var e=this;this.userInfo.userMetadataPromise.then((function(t){if(t)return e.appMetadataService.getAppMetadata().finally((function(){e.mergeDashboardOwnerInfo(t),e.dashboardsOwnersMergedDeferred.resolve(null)}))}))},C.prototype.mergeDashboardOwnerInfo=function(t){if(t&&t.dashboardOwnerInfo){for(var i=0,o=t.dashboardOwnerInfo;i<o.length;i++){var r=o[i],a=this.findDashboard(r.dashboardId);a&&this.modelMerger.mergeDashboardOwnerInfo(a,r)}this.rootScope.$emit(e.constants.notifyDashboardOwnerInfoLoaded)}},C.prototype.setQnaEnabled=function(e,t){var i=this.dashboardContainerModel,o=i.findDashboard(e);o&&(o.qnaEnabled=t,this.dashboardDataService.updateIsQnaEnabled())},C.prototype.getActiveDashboard=function(){return this.dashboardDataService.activeDashboard},C.prototype.renameDashboard=function(t,i){var o=this;if(this.isDashboardNameValid(t,i)){var r=this.dashboardContainerModel,a=r.findDashboard(i),n=a.contract.displayName;if(n!==t){var s=this.telemetryService,c=s.startEvent(e.telemetry.DashboardRenameDashboard,angular.isUndefined(a.tiles)||!a.tiles?0:a.tiles.length,a.objectId);a.displayName=a.contract.displayName=t,this.dashboardHttpService.renameDashboard(a.contract,t,c.event).then((function(){a&&a.isUsedByContentPack&&o.rootScope.$emit(e.constants.contentPackDirtyShowNotification,i,e.dataServices.models.ContentPackItems.Dashboard),c.resolve()}),(function(t){t.status!==e.HttpStatusCode.Unauthorized&&(o.errorService.error(o.localizationService.get("Dashboard_FailToRenameDashboardMessage"),"Dashboard_FailToRenameDashboard",{requestId:t.requestId,statusCode:t.status.toString()}),a.displayName=n,a.contract.displayName=n),c.reject()}))}}},C.prototype.addDashboard=function(t,i){var o=this,r=void 0!==i;if(!this.storageUsageService.checkQuotaExceeded(this.dashboards,e.telemetry.QuotaCheckOperation.AddDashboard)&&this.isDashboardNameValid(t,null)){var n=this.telemetryService,s=n.startEvent(e.telemetry.DashboardAddDashboard,null,null),c={objectId:this.temporayObjectID(this.temporaryDashboardId),id:this.temporaryDashboardId--,displayName:t,version:"",tiles:[],permissions:g.All,isHidden:!1},l=this.modelConverter.convertDashboard(c);l.displayName=t,l.id=c.id,l.isLoaded=!0,r&&(l.isNew=!0,l.isNotified=!1),this.dashboardDataService.addDashboard(l),r||(this.navigation.navigateToDashboardByGUID(c.objectId,1),this.rootScope.$emit(e.constants.scrollNavPaneToActiveDashboardEventName)),this.dashboardHttpService.addDashboard(c,s.event).then((function(t){var a,n,d,p=t.data;o.dashboardContainerModel.cacheTemporaryDashBoardMapping(c.objectId,p.objectId),c.id=p.id,l.id=p.id,c.objectId=p.objectId,o.groupService.activeGroup.aadGroupId===e.constants.myWorkSpaceGroupId?(a=o.userInfo.name,n=o.userInfo.givenName,d=o.userInfo.surname):(n=o.groupService.activeGroup.displayName,a=o.groupService.activeGroup.contract.mailNickname);var u={dashboardId:c.id,emailAddress:a,givenName:n,familyName:d};o.modelMerger.mergeDashboardOwnerInfo(l,u),o.userInfo.addOrUpdateDashboardOwnerInfoCache(u),o.rootScope.$emit(e.constants.notifyDashboardOwnerInfoLoaded),o.dashboardWarningsService.showWarningsIfNeeded(),o.updateActiveDashboard(p.id,void 0,null,i);var v=s.event.info;v.pendingRequestCount=t.pendingRequestCount,v.dashboardGuid=c.objectId,s.resolve(),r||o.navigation.inContentListView()||(o.mostRecentlyUsedService.updateMRU(e.models.MRUArtifactType.Dashboards,c.objectId,c.displayName,c.permissions),o.navigation.navigateToDashboardByGUID(c.objectId,0))}),(function(e){o.errorService.error(o.localizationService.get("Dashboard_FailToCreateDashboardMessage"),"Dashboard_FailToCreateDashboard",{requestId:e.requestId,statusCode:e.status.toString()}),s.event.info.pendingRequestCount=e.pendingRequestCount,s.reject(a.getTelemetryErrorDetails(e.error))}))}},C.prototype.addOrUpdateDashboard=function(e,t){this.modelConverter.fillDashboardContainerDashboard(this.dashboardContainerModel,e);var i=this.dashboardContainerModel.visibleDashboards;t&&1===i.length&&this.inContentListViews()&&this.navigationHelper.navigateToDashboard(i[0]),this.dashboardContainerModel.calculateLayout(),this.dashboardContainerModel.applyLayout()},C.prototype.preloadLinkedDashboards=function(t){var i=this,o=this.promiseFactory.defer(),r=this.dashboardDataService,n=this.featureSwitchService.featureSwitches.preloadLinkedDashboardEnabled;if(!n)return o.reject(),o.promise;var s=r.findDashboard(t);if(!s||!s.isLoaded||_.isEmpty(s.tiles))return o.reject(),o.promise;for(var c=_.indexBy(r.dashboards,(function(e){return e.objectId.toLowerCase()})),l=[],p=0,u=s.tiles;p<u.length;p++){var v=u[p],h=v&&v.action;if(h&&h.action===e.constants.openUrlActionName){var g=d(h.targetUrl);if(g){var m=c[g.toLowerCase()];if(m&&!m.isLoaded&&(l.push(m.id),l.length>=b))break}}}if(0===l.length)return o.resolve(null),o.promise;l=_.uniq(l);var f=this.telemetryService.startEvent(e.telemetry.DashboardPreloadLinkedDashboard,l.length,s.objectId);return this.dashboardHttpService.batchGetDashboards(this.promiseFactory,l,f.event).then((function(e){i.updateDashboardContainer(e.data),o.resolve(null),f.resolve()}),(function(e){o.reject(),f.reject(a.getTelemetryErrorDetails(e?e.error:null,e?e.status:null))})),o.promise},C.prototype.addOrUpdateTile=function(e,t,i){this.dashboardSyncService.addOrUpdateTile(e,t,i)},C.prototype.selectDashboardTile=function(e){e.tileModel.isSelected=!0,this.dashboardDataService.selectedDashboardTile=e},C.prototype.clearSelectedDashboardTile=function(){var e=this.dashboardDataService.selectedDashboardTile;null!=e&&(e.isSelected=!1,this.dashboardDataService.selectedDashboardTile=null)},C.prototype.batchUpdateTileSizePosition=function(t,i){var o=this,r=this.telemetryService.startEvent(e.telemetry.DashboardTileLayoutChanged,i.length),a=this.dashboardHttpService.batchUpdateTileSizePosition(this.promiseFactory,t.contract,i,r.event);return a&&a.then((function(){r.resolve(),t&&t.isUsedByContentPack&&o.rootScope.$emit(e.constants.contentPackDirtyShowNotification,t.id,e.dataServices.models.ContentPackItems.Dashboard)}),(function(){r.reject()})),a},C.prototype.promptForDeleteDashboard=function(e,t){var i=this,o=this.errorService.control(),r=[new InJs.ModalDialogAction(t?this.localizationService.get("ModalDialogButtonText_Delete"):this.localizationService.get("ModalDialogButtonText_Remove"),function(r,a){o.hideDialog(),i.deleteDashboardInternal(e,t)}),new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){o.hideDialog()})],a=this.findDashboard(e),n=t?this.localizationService.get("Dashboard_DeleteConfirmationTitle"):this.localizationService.get("Dashboard_RemoveConfirmationTitle"),s=this.localizationService.format(t?"Dashboard_DeleteConfirmationMessage":"Dashboard_RemoveConfirmationMessage",[a.displayName]);o.showCustomDialog(n,$("<div/>").text(s),r,(function(e){e.parent().find('input[value="'+i.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)},C.prototype.exportDashboard=function(t,i){var o,r=this,a=this.dashboardContainerModel,n=_.filter(a.dashboards,(function(e){return e.id===t}))[0];if(n){o=n.contract;var s="dashboardpackage.zip",c=this.telemetryService,l=c.startEvent(e.telemetry.DashboardExportDashboard,o.objectId),d=this.dashboardHttpService.exportDashboard(o,i,l.event);if(d){var p=this.notificationToastService.notify({title:this.localizationService.get("NotificationMessage_ExportingPackage"),notificationType:e.common.NotificationToastType.Loading});d.then((function(e){l.resolve(),r.notificationToastService.hide(p),r.fileSaver.saveAs(e.data,s)}),(function(t){t.status!==e.HttpStatusCode.Unauthorized&&r.errorService.error(r.localizationService.get("Dashboard_FailToExportDashboardMessage"),"Dashboard_FailToExportDashboard",{requestId:t.requestId,statusCode:t.status.toString()}),l.reject()}))}}else this.errorService.error(this.localizationService.get("Dashboard_FailToExportDashboardMessage"),"Dashboard_FailToExportDashboard")},C.prototype.hideDashboard=function(t,i){var o=t.getDashboardIndex(i),r=this.getDashboardContractIndex(t.contract,i);if(!(o<0||r<0)){var a=t.dashboards,n=a[o],s=n.getPermissions();n.isSharedFromSecurityGroup&&(s===g.Read||s===g.ReadReshare);n.contract.isHidden=!0,n.isHidden=!0,this.dashboardDataService.dropDashboardfromMemoryIfNotActive(i),this.afterDashboardDeletingHandler(i),this.navigateAfterDashboardDelete(t,i),this.mostRecentlyUsedService.removeMRU(n.contract.objectId),this.navigation.inSharedWithMeView()&&this.rootScope.$emit(e.constants.updateSharedWithMe)}},C.prototype.navigateAfterDashboardDelete=function(e,t){var i=this,o=this.dashboardDataService.activeDashboard;if(o&&t===o.id&&this.inArtefactView()){var r=_.isEmpty(e.visibleDashboards);this.rootScope.$applyAsync((function(){if(i.shouldShowListView()||r)i.dashboardDataService.activeDashboard=null,e.contract.activeDashboardId=null,i.navigation.navigateToContentListOrActiveDashboard();else{var o=i.findNextDashboard(t,i.dashboardContainerModel);o&&i.navigationHelper.navigateToDashboard(o)}}))}},C.prototype.deleteDashboardInternal=function(t,i){var o=this,r=this.dashboardContainerModel,a=r.findDashboard(t),n=this.telemetryService,s=n.startEvent(e.telemetry.DashboardDeleteDashboard,a.objectId,angular.isUndefined(a.tiles)||!a.tiles?0:a.tiles.length);this.beforeDashboardDeletingHandler(t);var c=this.dashboards.filter((function(e){return e.id===t}));if(0===c.length)return void s.resolve();var l=a.getPermissions(),d=a.isSharedFromSecurityGroup&&(l===g.Read||l===g.ReadReshare),p=c[0].contract;i?this.dashboardDataService.deleteDashboardAtServerSide(t,s).then((function(){a&&(a.isUsedByContentPack&&o.rootScope.$emit(e.constants.contentPackDirtyShowNotification,a.id,e.dataServices.models.ContentPackItems.Dashboard),o.afterDashboardDeletingHandler(t))}),(function(t){t&&t.status!==e.HttpStatusCode.Unauthorized&&o.errorService.error(o.localizationService.get("Dashboard_FailToDeleteDashboardMessage"),"Dashboard_FailToDeleteDashboard",{requestId:t.requestId,statusCode:t.status.toString()})})):this.invitationService.deleteUser(r.userId,t,s.event).then((function(e){s.resolve(),p&&o.modelService.removeModels(p.modelIds),o.tryResetHome(t)}),(function(e){o.errorService.error(o.localizationService.get("Dashboard_FailToRemoveDashboardMessage"),"Dashboard_FailToRemoveDashboard",{requestId:e.requestId,statusCode:e.status.toString()}),s.reject()})),d?this.hideDashboard(r,t):(this.dashboardDataService.deleteDashboard(t),this.syncService.stopMonitoringDashboard(t),this.navigateAfterDashboardDelete(r,t),this.mostRecentlyUsedService.removeMRU(p.objectId))},C.prototype.inArtefactView=function(){var e=this.navigation;return e.inDashboardView()||e.inReportView()||e.inWorkbookView()||e.inDatasetView()},C.prototype.inContentListViews=function(){var e=this.navigation;return e.inContentListView()||e.inFavoritesView()||e.inRecentlyViewedView()||e.inGroupWelcomeView()||e.inLandingContainerView()},C.prototype.tryResetHome=function(t){var i=this.home;i.getHomeDashboard(null).then((function(t){t.data?(i.homeDashboard.dashboardId=t.data.dashboardId,i.homeDashboard.groupId=t.data.groupId||e.constants.myWorkSpaceGroupId,i.homeDashboard.dashboardObjectId=t.data.dashboardObjectId):i.resetHomeAtClientSide()}),(function(e){}))},C.prototype.deleteTile=function(e,t){this.dashboardDataService.deleteTile(e,t)},C.prototype.duplicateDashboard=function(t,i){var o=this,r=this.promiseFactory.defer(),a=this.telemetryService.startEvent(e.telemetry.DashboardDuplicateDashboard);return this.dashboardHttpService.duplicateDashboard(t,i,a.event).then((function(e){var t=e.data;o.dashboardHttpService.addDashboardRequestToBatch(o.promiseFactory,e.data.id).done((function(i){o.dashboardSyncService.addOrUpdateDashboard(i),o.dashboardWarningsService.showWarningsIfNeeded(),o.updateActiveDashboard(t.id,!0),o.navigation.navigateToDashboardByGUID(t.objectId,0),a.resolve(),r.resolve(e.data)}),(function(){a.reject(),r.reject()}))}),(function(){a.reject(),r.reject()})),r.promise},C.prototype.findDashboard=function(e){return this.dashboardDataService.findDashboard(e)},C.prototype.findDashboardByGUID=function(e){return this.dashboardDataService.findDashboardByGUID(e)},C.prototype.findDashboardsByPackageId=function(e){var t=this.dashboardDataService.dashboards;return t?_.filter(t,(function(t){return!(!t.contract||!t.contract.originalPackageId)&&t.contract.originalPackageId===e})):null},Object.defineProperty(C.prototype,"dashboards",{get:function(){return this.dashboardDataService.dashboards},enumerable:!0,configurable:!0}),C.prototype.hasTileForReportandSection=function(e,t){var i,o=this.dashboardContainerModel.dashboards;return void 0!==e?i=_.filter(o,(function(t){return _.find(t.tiles,(function(t){return t.reportTile&&t.contract&&t.contract.sectionId===e}))})):void 0!==t&&(i=_.filter(o,(function(e){return _.find(e.tiles,(function(e){return e.reportTile&&e.contract&&e.contract.reportId===t}))}))),!!(i&&i.length>0)},C.prototype.initializeDashboardContainerModel=function(e,t){var i=this.dashboardContainerModel,o=i.contract;this.modelConverter.updateDashboardContainerContract(o,e),this.modelConverter.fillDashboardContainerDashboards(i,o),this.dashboardDataService.registerDashboards(this.dashboardContainerModel.dashboards),this.dashboardDataService.activeDashboard=i.findDashboard(o.activeDashboardId);var r=this.dashboardDataService.activeDashboard;if(r&&(r.isLoaded=!0),this.navigation.currentDashboardGUID){var a=this.findDashboardByGUID(this.navigation.currentDashboardGUID);a&&(a.isHidden=!1,a.contract.isHidden=!1)}return _.isEmpty(i.visibleDashboards)&&!this.permissionService.isActiveWorkspaceIsReadOnly?void this.setupNavigationWhenNoDashboardExists():void this.dashboardSyncService.clearSeenDashboards()},C.prototype.notifyDashboardUpdate=function(){var e=this.dashboardDataService,t=e.activeDashboard;if(t.hasUpdate){var i=_.find(this.dashboardContainerModel.contract.packages,(function(e){return e.id===t.contract.originalPackageId}));if(!i){var o=this.packageService.findPackage(t.contract.originalPackageId);o&&(i=o.contract)}if(i){var r=i.name,a=jsCommon.StringExtensions.format(this.localizationService.get("DashboardContentPackNewVersion"),r);this.notificationBar.notify({message:a,hideOnStateChange:!0})}}},C.prototype.loadDashboard=function(t){var i=this,o=this.promiseFactory.defer(),r=[],a=0,n=0;for(a=0;a<w;a++)r.push(this.timeout((function(){i.loadDashboardInternal(t).then((function(e){o.resolve(e);for(var t=r.length,a=0;a<t;a++)a!==n&&i.timeout.cancel(r[a])}),(function(t){n++>=w-1&&(o.reject(t),i.rootScope.$emit(e.constants.loadDashboardFailed))}))}),a*C.loadDashboardTimeout));return o.promise},C.prototype.loadDashboardInternal=function(t){var i=this,o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(e.telemetry.DashboardLoadDashboard,null,null);return this.userActivityContextService.pushParentContext(r.event),this.dashboardHttpService.getDashboards(this.promiseFactory,[t],null).then((function(e){if(e.length>0&&e[0].data){var n=e[0],s=n.data;i.registerAndLoadResourcePackages(s).finally((function(){i.updateDashboardContainer([s]);var e=i.findDashboard(t);o.resolve(e),e&&(r.event.info.dashboardGuid=e.objectId),r.event.info.pendingRequestCount=n.pendingRequestCount,r.resolve(),i.userActivityContextService.popParentContext(r.event)}))}else{if(_.isEmpty(e))o.reject(),r.reject();else{var c=e[0];o.reject(c),r.event.info.pendingRequestCount=c.pendingRequestCount,r.reject(a.getTelemetryErrorDetails(c.error))}i.userActivityContextService.popParentContext(r.event)}})).catch((function(e){angular.isArray(e)&&(e=e[0]),o.reject(e),r.reject(),i.userActivityContextService.popParentContext(r.event)})),o.promise},C.prototype.notifyReadOnly=function(e,t){t?this.dashboardHttpService.notifyReadOnly(e,t):this.dashboardHttpService.notifyReadOnly(e)},C.prototype.onDashboardShallowEdit=function(e,t){if(e){var i=t.isHidden&&!e.isHidden,o=!t.isHidden&&e.isHidden;this.dashboardDataService.updateIsQnaEnabled(),i?this.hideDashboard(this.dashboardContainerModel,e.id):o&&1===this.dashboardContainerModel.visibleDashboards.length&&!this.inArtefactView()&&this.navigation.navigateToDashboardByGUID(e.objectId)}},C.prototype.registerAndUpdateTile=function(e,t,i){var o=i.findDashboard(e),r=$.map(t.resourcePackageIds,(function(e){return e.toString()})),a=this.resourcePackageGateService.shouldShowWarning(r,this.dashboardDataService.activeDashboard.objectId);if(this.modelConverter.resolveTilePackage(t,this.packageService.packages),t.resourcePackageIds&&t.resourcePackageIds.length>0)for(var n=t.resourcePackageIds.length,s=0;s<n;++s)this.dashboardSyncService.addOrUpdateCustomVisualTile(t.resourcePackageIds[s],o,t,a);else this.addOrUpdateTile(o,t,i.contract.models)},C.prototype.getSelectedDashboardTile=function(){var e=this.dashboardDataService.selectedDashboardTile;if(e&&e.isSelected)return e},C.prototype.updateDashboardWithPackageInfo=function(t,i){var o,r=this.dashboardContainerModel.dashboards;r&&(o=_.filter(r,(function(e){if(e.contract&&e.contract.originalPackageId)return e.contract.originalPackageId===i}))),_.isEmpty(o)||this.modelConverter.setDashboardsHasUpdate(o),this.navigation.inDashboardView()&&this.rootScope.$emit(e.constants.notifyDashboardUpdate)},C.prototype.setActiveDashboardId=function(t,i,o){var r=this;void 0===i&&(i=!1),void 0===o&&(o=null);var a=this.findDashboard(t),n=this.telemetryService.startEvent(e.telemetry.DashboardUpdateActiveDashboard,a.objectId);this.dashboardHttpService.setActiveDashboardId(t,o,n.event).then((function(e){i?r.dashboardHttpService.refreshTileData(t,r.modelIdsForTileRefresh,n.event).then((function(e){r.checkRefreshTileResponse(e.data),n.resolve()}),(function(e){n.reject()})):n.resolve(),r.preloadLinkedDashboardPromise&&r.timeout.cancel(r.preloadLinkedDashboardPromise),r.preloadLinkedDashboardPromise=r.timeout((function(){r.preloadLinkedDashboards(t)}),S)}),(function(e){n.reject()}))},C.prototype.refreshTileData=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r=this;return __generator(this,(function(n){switch(n.label){case 0:return t>0?(this.refreshTileDataPromise&&(this.timeout.cancel(this.refreshTileDataPromise),this.refreshTileDataPromise=null),!i||_.find(this.modelIdsForTileRefresh,(function(e){return e===i}))?[3,2]:[4,this.allowQueryRefreshForModel(i)]):[3,3];case 1:if(o=n.sent(),o&&this.modelIdsForTileRefresh.push(i),_.isEmpty(this.modelIdsForTileRefresh))return[2];n.label=2;case 2:this.refreshTileDataPromise=this.timeout((function(){var i=r.findDashboard(t),o=r.telemetryService.startEvent(e.telemetry.DashboardRefreshTileData,i.objectId);r.dashboardHttpService.refreshTileData(t,r.modelIdsForTileRefresh,o.event).then((function(e){r.checkRefreshTileResponse(e.data),r.dashboardDataService.onDashboardTileRefreshStarted(t),o.resolve()}),(function(e){o.reject(a.getTelemetryErrorDetails(e.error))})),r.modelIdsForTileRefresh=[]}),C.refreshTileDataDelayMs),n.label=3;case 3:return[2]}}))}))},C.prototype.allowQueryRefreshForModel=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:return e=_.first(this.modelService.findModels(t)),e?e.isRefreshDisabledDueToInactivity()?[2,!1]:[4,this.licenseEnforcementService.supportsQueryRefresh(t)]:[2,!1];case 1:return[2,i.sent()]}}))}))},C.prototype.updateActiveDashboard=function(e,t,i,o){var r=this;if(void 0===t&&(t=!1),e>0){this.updateActiveDashboardPromise&&this.timeout.cancel(this.updateActiveDashboardPromise),this.groupService.activeGroup.lastViewedDashboard=e;var a=this.groupService.activeGroupObjectId;i&&!_.find(this.modelIdsForTileRefresh,(function(e){return e===i}))&&this.modelIdsForTileRefresh.push(i);var n=this.findDashboard(e);this.syncService.monitorDashboards(n?[n.contract]:[],null),this.updateActiveDashboardPromise=this.timeout((function(){return r.groupService.activeGroupObjectId!==a?void(r.updateActiveDashboardPromise=void 0):(r.setActiveDashboardId(e,t,r.modelIdsForTileRefresh),r.modelIdsForTileRefresh=[],o&&(o.dashboardId=e,r.pinTileWithoutNotification(o)),void(r.updateActiveDashboardPromise=void 0))}),C.updateActiveDashboardDelayMs)}},C.prototype.setAndUpdateActiveDashboard=function(e){if(this.dashboardDataService.activeDashboard=e,e){e.isLoaded&&!e.contract.cached||this.loadDashboard(e.id);var t=e.id;this.setActiveDashboardId(t)}},C.prototype.updateGroupsAppMetadata=function(t){var i=this.dashboardContainerModel,o=i.contract;this.modelConverter.updateDashboardContainerContractFromBasicDashboardContainer(o,t),this.modelConverter.fillDashboardContainerDashboardsFromBasicDashboardContainer(i,o),this.dashboardDataService.registerDashboards(i.dashboards),this.dashboardDataService.activeDashboard=i.findDashboard(t.activeDashboardId);var r=this.dashboardDataService.activeDashboard;r&&(r.isLoaded=!0),i.calculateLayout(),i.applyLayout(),this.syncService.monitorWorkspace(r?[r.contract]:[],t.userDashboardListVersion),this.telemetryService.logEvent(e.telemetry.DashboardInitializeContainer,"",!0,this.viralTenantMergeHelperService.viewingDataFromMergedViralTenant())},C.prototype.updateDashboardMenuItems=function(t){t.moreOptionsMenu=e.models.modelFactory.createDashboardMenuItems(this.localizationService,this.featureSwitchService,this.home,this.permissionService,this.fullScreen,this.dashboardConfigurationService,this.conceptualModelSetting,this.dashboardDataService.activeDashboard,this.navigation)},C.prototype.logRTelemetryDashboardEvent=function(e){var t=this.getVisualCountData(),i=t.scriptVisualsCount,o=t.reportTilesWithR;if(0!==i||0!==o){var r=this.dashboardDataService.activeDashboard.tiles.length;this.telemetryService.logEvent(e,i,r,o)}},C.prototype.getVisualCountData=function(){var e={totalVisualsCount:0,scriptVisualsCount:0,reportTilesWithR:0},t=this.dashboardDataService.activeDashboard,i=this.visualPluginService,o=t&&t.tiles;if(o){for(var r=0,a=o;r<a.length;r++){var n=a[r];h.isScriptVisualTile(n,i)?e.scriptVisualsCount++:h.reportTileContainsScriptVisuals(n,i)&&e.reportTilesWithR++}e.totalVisualsCount=o.length}return e},C.prototype.checkRefreshTileResponse=function(t){if(t&&!_.isEmpty(t.tileErrors))for(var i=0,o=t.tileErrors;i<o.length;i++){var r=o[i];r.errorResponse.error.code===e.common.constants.cloudRLSAccessDeniedErrorCode&&this.rootScope.$emit(e.constants.rowLevelSecurityAccessDeniedEventName,r.modelIds)}},C.prototype.registerAndLoadResourcePackages=function(t){var i=this.promiseFactory.defer(),o=t.dashboards;if(o)for(var r=0,a=o;r<a.length;r++){var n=a[r],s=this.getAllRequiredResourcePackages(n);if(s&&0!==s.length&&this.resourcePackageGateService.shouldShowWarning(s,n.objectId))return i.reject(null),i.promise}var c=t.resourcePackages;if(c&&c.length>0){for(var l=[],d=!1,p=0,u=c;p<u.length;p++){var v=u[p];if(!this.resourcePackagesService.getPackageById(v.id)){var h=0===v.type,g=m.isRegisteredResourcePackage(v);h&&(d=!0),(h||g)&&this.resourcePackagesService.registerPackages([v]),h&&l.push(this.visualPluginService.ensurePlugin(v,!1))}}return this.telemetryService.logEvent(e.telemetry.DashboardRegisterAndLoadResourcePackages,c?c.length:0,d),this.promiseFactory.allSettled(l)}return i.resolve(null),i.promise},C.prototype.getAllRequiredResourcePackages=function(t){var i=[],o="";if(t&&t.tiles){for(var r=0,a=t.tiles;r<a.length;r++){var n=a[r];o=o.concat(n.id.toString(),",");var s=n.resourcePackageIds;if(s&&0!==s.length)for(var c=0,l=s;c<l.length;c++){var d=l[c];i.push(d.toString())}}this.telemetryService.logEvent(e.telemetry.DashboardRecordDashboardTiles,o.length>0?o.substr(0,o.length-1):o,t.objectId)}return i},C.prototype.loadDashboardContainer=function(e,t,i){var o=this,r=this.promiseFactory.defer();return this.appMetadataService.getAppMetadata().then((function(a){var n=o.initializeDashboardContainer(a,e,t,i);o.registerAndLoadResourcePackages(a).finally((function(){return r.resolve(n)}))}),(function(){o.dashboardHttpService.getDashboardContainer(e).then((function(a){a.data.models&&(o.modelService.mergeDatasetCollection(a.data.models),o.dashboardDataService.updateActiveDashboardModels()),a.data.featureSwitches&&o.editableFeatureSwitchService.registerFeatureSwitches(a.data.featureSwitches),o.userSettingsService.getUserSettings().then((function(e){a.data.userSettings=e.contract}));var n=o.initializeDashboardContainer(a.data,e,t,i);o.registerAndLoadResourcePackages(a.data).finally((function(){return r.resolve(n)}))}),(function(e){r.reject()}))})),r.promise},C.prototype.getDashboardContractIndex=function(e,t){for(var i=e.dashboards,o=0,r=i.length;o<r;o++)if(i[o].id===t)return o;return-1},C.prototype.findNextDashboard=function(e,t){for(var i=t.dashboards.length,o=t.getDashboardIndex(e),r=0;r<i;r++){var a=(o+1+r)%i;if(a===o)return null;var n=t.dashboards[a];if(!n.isHidden)return n}},C.prototype.initializeContainer=function(t,i){var o=this,r=this.telemetryService.startEvent(e.telemetry.DashboardInitializeContainer,"",!1,this.viralTenantMergeHelperService.viewingDataFromMergedViralTenant());initializeContainerStartTime&&(r.event.time=initializeContainerStartTime.getTime());var a={dashboards:[],activeViewMode:e.contracts.DashboardContainerViewMode.DashboardViewer,activityPane:e.staticContract.getActivityPaneContract()},n=this.dashboardContainerModel=this.modelConverter.convertDashboardContainer(a);n.calculateLayout(),n.applyLayout(),this.loadDashboardContainer(r.event,t,i).then((function(t){o.dashboardsDeferred.resolve(o),o.dashboardDataService.resolveDashboardDeferred(),t.deferEmitDashboardContainerLoadedEvent||o.rootScope.$emit(e.constants.dashboardContainerLoaded),r.resolve()}),(function(){r.reject(),o.dashboardsDeferred.reject(),o.dashboardDataService.rejectDashboardDeferred()}))},C.prototype.initializeDashboardContainer=function(t,i,r,a){if(window.initialDashboardContainer||(window.initialDashboardContainer=t),t.downloadCenterLinkEnabled?(e.models.PowerBICompanionModel.enabled=!0,e.models.PowerBICompanionModel.downloadLink=o.powerBICompanionHelper.getDownloadCenterLink(t.downloadCenterX64Link,t.downloadCenterX86Link),this.rootScope.$emit(e.constants.enablePowerBICompanionApp)):t.companionAppEnabled&&(e.models.PowerBICompanionModel.enabled=!0,e.models.PowerBICompanionModel.downloadLink=o.powerBICompanionHelper.getDownloadLink(),this.rootScope.$emit(e.constants.enablePowerBICompanionApp)),jsCommon.Utility.is64BitOperatingSystem()&&(e.models.PowerBIConnectorModel.downloadLink=t.downloadCenterX64ConnectorLink,this.rootScope.$emit(e.constants.enablePowerBIASConnectorApp)),e.models.PowerBIOnPremGatewayModel.downloadLink=t.downloadOnpremGatewayLink,this.featureSwitchService.featureSwitches.homeDashboardEnabled&&t.homeDashboardId!==-1){var n=!this.navigation.currentGroupGUID||this.navigation.currentGroupGUID===e.constants.myWorkSpaceGroupId,s=this.navigation.inLandingContainerView()||this.navigation.inHomeDashboardView(),c=r||!_.isEmpty(a);n&&s&&!c&&(t.homeGroupId?this.groupService.activeGroupObjectId=t.homeGroupId:this.groupService.isMyWorkspace()&&(this.groupService.activeGroupObjectId=e.constants.myWorkSpaceGroupId),r||(r=t.homeDashboardId)),this.home.homeDashboard.dashboardId=t.homeDashboardId,
this.home.homeDashboard.groupId=t.homeGroupId||e.constants.myWorkSpaceGroupId}this.initializeDashboardContainerModel(t,i);var l=t.dashboards,d=_.find(l,(function(e){return e.id===t.activeDashboardId}));d||!l||_.isEmpty(this.dashboardContainerModel.visibleDashboards)||(d=l[0],t.activeDashboardId=d.id),this.syncService.monitorDashboards(d?[d]:[],t.userDashboardListVersion);var p=this.findDashboard(this.home.homeDashboard.dashboardId);p&&(this.home.homeDashboard.dashboardObjectId=p.objectId);var u=!1;return window.appLoadError&&window.appLoadError.error===e.constants.appLoadErrorGroupNotAccessible&&(u=!0),this.navigateToActiveDashboard(t,i,r,a,u)},C.prototype.isAllowedMobileUserAgent=function(){for(var e=["iphone","ipad","android"],t=["windows phone"],i=navigator.userAgent.toLowerCase(),o=0;o<t.length;o++)if(i.indexOf(t[o])!==-1)return!1;for(var o=0;o<e.length;o++)if(i.indexOf(e[o])!==-1)return!0;return!1},C.prototype.loadAndInitializeDashboardsOnInvitation=function(){var t=this,i=this.$location.search();if(jQuery.isEmptyObject(i))return void this.initializeContainer();var o,r,a,n,s,c,l=i[e.constants.invitation.invitationCodeQueryParam],d=i[e.constants.invitation.invitationCodeQueryParamV2];if(_.isEmpty(l)){if(_.isEmpty(d))return void this.initializeContainer();try{var p=decodeURIComponent(d),u=JSON.parse(atob(p));o=u.tenantId,r=u.code,a=u.redirectedFromSignup,n=u.extShare,s=u.dashboardId,c=jsCommon.QueryStringUtil.addOrUpdateQueryString(e.constants.invitation.invitationCodeQueryParamV2,d)}catch(e){return void this.initializeContainer()}}else{var v=decodeURIComponent(l),h=v.split("|");if(h.length<2)return void this.initializeContainer();o=h[0],r=h[1],a=_.any(h,(function(e){return"redirectedFromSignup"===e})),n=_.any(h,(function(e){return"extshare"===e}));var g=_.without(h,"extshare").join("|");c=jsCommon.QueryStringUtil.addOrUpdateQueryString(e.constants.invitation.invitationCodeQueryParam,g)}if(n&&"/invite"!==this.$location.path()&&(location.href="/invite"+c),_.isEmpty(r))_.isEmpty(s)?this.initializeContainer():this.initializeContainer(void 0,s);else{var m=this.telemetryService,f=m.startEvent(e.telemetry.DashboardClaimInvitation,"",r);this.invitationService.claimInvite(o,r,a,f.event).then((function(i){var o=parseInt(i.data,10),a=window.location;t.isAllowedMobileUserAgent()&&!n&&(m.logEvent(e.telemetry.DashboardClaimInvitationRedirectToMobileLandingPage,navigator.userAgent,r),window.location.href=a.protocol+"//"+a.host+"/mobilelandingpage"+a.search),t.initializeContainer(o);var s=t.dashboardContainerModel.findDashboard(o);f.event.info.dashboardGuid=s?s.objectId:"",f.resolve()}),(function(i){var o=i.headers(e.common.PowerBIErrorHeader);if(o===e.constants.quotaErrorCodes.PowerBIUserQuotaExceeded||o===e.constants.quotaErrorCodes.PowerBIGroupQuotaExceeded){var r=o===e.constants.quotaErrorCodes.PowerBIUserQuotaExceeded,a=t.storageUsageService;a.showQuotaExceedDialog();var n=a.getUsage(t.dashboards);m.logEvent(e.telemetry.QuotaExceeded,t.userInfo.isPremiumUser,r?e.telemetry.QuotaOpenManageStorageContext.Personal:e.telemetry.QuotaOpenManageStorageContext.Group,e.telemetry.QuotaCheckOperation.AcceptInvitation,n.ownedUsage,n.sharedUsage,a.quotaLimitInMB)}else{var s=o||"DashboardInvitationInvalidRequest";t.localizationService.ensureLocalization((function(){var i=t.localizationService.get(s);t.errorService.error(i,"DashboardInvitationInvalidRequest",{title:t.localizationService.get("DashboardInvitationErrorTitle")},!1,e.telemetry.ErrorSource.PowerBI),f.reject({errorCode:s,errorSource:"DashboardInvitationInvalidRequest"!==s?e.telemetry.ErrorSource.User:e.telemetry.ErrorSource.PowerBI})}))}t.initializeContainer()})).finally((function(){t.rootScope.$emit(e.constants.invitation.invitationClaimed)}))}},C.prototype.navigateToActiveDashboard=function(e,t,i,o,r){var a=this,n={deferEmitDashboardContainerLoadedEvent:!1},s=this.dashboardContainerModel,c=s.findDashboard(e.activeDashboardId),l=this.conceptualModelSetting.isAppsEnabled(),d=c,p=void 0!==i?s.findDashboard(i):s.findDashboardByGUID(o),u=this.navigation,v=u.currentDashboardGUID,h=u.currentReportGUID,g=u.currentWorkbookURLIdentifier,m=u.currentDatasetDBName,f=l&&u.currentAppGUID,y=l&&u.currentAppInstanceId,b=l&&u.currentDashboardOriginalGUID,S=l&&u.currentReportOriginalGUID,w=!0;if(this.featureSwitchService.featureSwitches.permissionCenterEnabled){var C;return this.lazy("permissionNavigation").then((function(e){return C=e,a.lazy("permissionData")})).then((function(e){if(C.inManagePermissionsView()){var t=C.permissionArtifact,i=C.permissionArtifactGUID;e.setActivePermissionArtifact(t,i).then((function(){return C.navigateToManagePermissions(t,i)}))}})),n}if(this.shouldTriggerAppAutoInstall(e))return this.readyForConceptualModelInitializationDeferred.resolve(null),n.deferEmitDashboardContainerLoadedEvent=!0,n;if(p)d=p;else{if(!u.inReportView()&&!u.inQnaView()&&(v||f&&b))return this.navigateToDashboardOnInitialLoad(),n;if(h||f&&S)return this.navigateToReportOnInitialLoad(),w=!1,n;if(!g||u.inAppView()&&!l)if(f&&u.inAppDetailView()){if(w=!!u.inAppInstanceView()&&!!y,!w)return this.navigateToDefaultAppArtefact(f),n}else m&&(w=!1,this.handleStateChangeForDataset(m));else w=!1}if(!d)return _.isEmpty(s.visibleDashboards)&&!this.permissionService.isActiveWorkspaceIsReadOnly&&this.setupNavigationWhenNoDashboardExists(),n;if(w=r||w&&(v!==d.objectId||!u.inDashboardDetailView())){if(this.tryToNavigateToNonDashboard(d,i,l,f))return n;if(this.shouldShowListView()){if(!i||!d||d.objectId===this.home.homeDashboard.dashboardObjectId)return this.readyForConceptualModelInitializationDeferred.resolve(null),n.deferEmitDashboardContainerLoadedEvent=!0,n;this.navigationToDashboard(d)}else this.home.homeDashboard.dashboardId===i?u.navigateToHomeDashboard(!0):this.navigationToDashboard(d)}return n},C.prototype.handleStateChangeForDataset=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i;return __generator(this,(function(o){switch(o.label){case 0:return e=this.navigation,[4,this.licenseEnforcementService.supportsDataset(t,!0)];case 1:return i=o.sent(),i&&(e.inQnaModelView()?e.replaceHistoryWithDatasetAndNavigate(e.currentDatasetDBName,p.modelQna,{q:e.qnaQuery}):e.initialLoadDatasetByDBName(e.currentDatasetDBName)),[2]}}))}))},C.prototype.shouldTriggerAppAutoInstall=function(t){var i=this.navigation,o=i.currentAppGUID;if(!i.inAppView()||!o||this.groupService.activeGroupObjectId!==e.constants.myWorkSpaceGroupId||!this.conceptualModelSetting.isAppsEnabled())return!1;var r=_.find(t.apps,(function(e){return e.providerKey===o}));if(!r)return!0;var a=r.providerId,n=_.find(t.packages,(function(e){return(e.contentProviderRefId===a||e.serviceContentProviderId===a||e.contentProviderId===a)&&e.packageType===u.AppInstance}));return null==n},C.prototype.navigateToDefaultAppArtefact=function(e,i){var o=this,a=this.appService,s=this.packageService;this.promiseFactory.all([a.ensureAppsInitialization(),s.ensurePackagesInitialization()]).then((function(){if(i=i||t.getPackageIDByOrgAppGUID(a,s,e)){var c=o.appService.getAppInstance(i),l=t.getDefaultAppArtefact(c);if(l){var d=o.navigation,u=o.groupService.activeGroupObjectId,h=!t.isOrgApp(c.providerContract);l instanceof n?d.replaceAndLoadCurrentState(h?p.appInstanceDashboard:p.appDashboard,{appGUID:e,appInstanceId:i,dashboardGUID:l.objectId,dashboardOriginalGUID:l.contract.originalDashboardObjectId,groupGUID:u}):l instanceof v?d.replaceAndLoadCurrentState(h?r.appInstanceReport:r.appReport,{appGUID:e,appInstanceId:i,reportGUID:l.objectId,reportOriginalGUID:l.contract.originalReportObjectId,groupGUID:u}):l instanceof y&&d.replaceAndLoadCurrentState(r.appWorkbook,{appGUID:e,appInstanceId:i,workbookURLIdentifier:l.uniqueId,groupGUID:u})}}}))},C.prototype.tryToNavigateToNonDashboard=function(t,i,o,r){var a=this,n=this.navigation;if(n.inGetDataView())return!0;if(n.inQnaView()){var s=n.inAppView()?p.appDashboardQna:p.dashboardQna;return n.replaceHistoryWithDashboardAndNavigate(t.objectId,s,{q:n.qnaQuery}),!0}if(n.inInsightsView()){var s=n.inAppView()?p.appInsights:p.insights;return n.replaceHistoryWithDashboardAndNavigate(t.objectId,s,{dataGUID:n.insightsDataGUID,groupGUID:n.currentGroupGUID,insightsSource:null,appGUID:n.currentAppGUID}),!0}return n.inManageStorageView()?(this.navigateToManageStoragePage(t.objectId),!0):n.inSettingsView()?(n.showSettingsSlider(n.settingsGroup,n.settingsId),!0):!!n.inGatewaysView()||(n.inFavoritesView()?(n.navigateToFavorites(this.groupService.activeGroupObjectId),!0):n.inRecentlyViewedView()?(n.navigateToRecentlyViewed(),!0):n.inSharedWithMePath()?(n.navigateToSharedWithMe(),!0):n.inAppsDetailView()&&o?(n.navigateToApps(),!0):n.inExtendTrial()?(this.lazy("licenseHelper").then((function(t){return t.displayDialogToExtendTrial(e.telemetry.LicenseEnforcementOperation.EmailLink)})),!0):n.inAccept2017ProTrial()?(this.acceptTrialAndRefresh(),!0):this.shouldShowListView()&&n.inManageDatasetView()?(n.navigateToDatasets(),!0):this.shouldShowListView()&&n.inManageStreamingDatasetView()?(n.navigateToStreamingDatasets(0),!0):this.shouldShowListView()&&n.inContentListView()?(n.navigateToContentListParams({groupGUID:n.currentGroupGUID}),!0):n.inCapacitySettingsView()?(this.featureSwitchService.featureSwitches.adminCapacityEnabled?this.navigateToCapacitySettings():this.navigationToDashboard(t),!0):n.inAdminPortalView()&&this.userInfo?(this.userInfo.userMetadataPromise.then((function(e){e.isTenantAdmin||a.featureSwitchService.featureSwitches.adminCapacityEnabled?n.replaceHistoryWithGroupWelcomeAndNavigate(a.groupService.activeGroupObjectId,p.adminPortal,{adminPortalSettingsTab:0}):a.navigationToDashboard(t)}),(function(){a.navigationToDashboard(t)})),!0):!!n.inManageEmbedView()&&(this.navigateToManageEmbedPage(t.objectId),!0))},C.prototype.acceptTrialAndRefresh=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.licenseEnforcementService.accept2017ProTrial()];case 1:return e.sent(),this.navigation.navigateToFavorites(this.groupService.activeGroupObjectId),window.location.reload(!0),[2]}}))}))},C.prototype.navigateToCapacitySettings=function(){this.navigation.currentCapacityId?this.navigation.navigateToAdminPortalCapacity(this.navigation.currentCapacityId):this.navigation.navigateToAdminPortal(5)},C.prototype.navigateToDashboardOnInitialLoad=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,o,r,a,n;return __generator(this,(function(l){switch(l.label){case 0:return t=this.navigation,i=this.appService,o=this.packageService,t.currentDashboardGUID||t.currentDashboardOriginalGUID&&t.currentAppGUID&&this.conceptualModelSetting.isAppsEnabled()?[4,this.promiseFactory.all([i.ensureAppsInitialization(),o.ensurePackagesInitialization()])]:[2];case 1:return l.sent(),r=this.navigationHelper,r.ensureDashboardGUID(),(a=this.findDashboardByGUID(t.currentDashboardGUID))?((t.inInFocusView()||t.inInFocusInsightsView()||t.inAlertsEditorView())&&(r.ensureTileGUID(),n=a.findTileByObjectIdOrOriginalObjectId(t.currentTileGUID,t.currentTileOriginalGUID),n&&this.selectDashboardTile(new c(n))),[4,this.checkUserNeedsProLicenseAndShowError(a,this.userInfo,this.licenseEnforcementService,this.localizationService,t,e.telemetry.LicenseEnforcementOperation.InitialDashboardLoad)]):[3,3];case 2:return l.sent(),this.setAndUpdateActiveDashboard(a),this.groupService.activeGroup&&(this.groupService.activeGroup.lastViewedDashboard=a?a.id:-1),[3,4];case 3:this.shouldNavigateToRequestAccess()?(t.navigateToRequestDashboardAccessByGUID(t.currentDashboardGUID,2),this.setAndUpdateActiveDashboard(null)):s.showDashboardDoesNotExistDialog(this.errorService,this.localizationService,this.telemetryService,t),l.label=4;case 4:return[2]}}))}))},C.prototype.navigateToReportOnInitialLoad=function(){return __awaiter(this,void 0,e.Promise,(function(){var e,t,i,o,r,a;return __generator(this,(function(n){switch(n.label){case 0:return e=this.navigation,t=this.appService,i=this.packageService,o=this.reportService,[4,this.promiseFactory.all([t.ensureAppsInitialization(),i.ensurePackagesInitialization(),o.ensureReportsInitialization()])];case 1:return n.sent(),this.navigationHelper.ensureReportGUID(),r=e.currentReportGUID,[4,this.licenseEnforcementService.supportsReport(r)];case 2:return a=n.sent(),a&&e.navigateToReport({groupGUID:this.groupService.activeGroupObjectId,reportGUID:r,reportOriginalGUID:e.currentReportOriginalGUID,appGUID:e.currentAppGUID,appInstanceId:e.currentAppInstanceId,reportPage:e.currentReportPage,dashboardGUID:e.currentDashboardGUID,subscriptionGUID:e.currentSubscriptionGUID},!0),[2]}}))}))},C.prototype.navigationToDashboard=function(t){this.checkUserNeedsProLicenseAndShowError(t,this.userInfo,this.licenseEnforcementService,this.localizationService,this.navigation,e.telemetry.LicenseEnforcementOperation.ShareDashboard),this.navigation.insertGroupAndNavigateToDashboardByGUID(t.objectId,this.groupService.activeGroupObjectId,2),this.setAndUpdateActiveDashboard(t),this.groupService.activeGroup&&(this.groupService.activeGroup.lastViewedDashboard=t?t.id:-1)},C.prototype.navigateToActiveDashboardAfterGroupSwitch=function(e,i,o){var r=this.dashboardContainerModel.findDashboard(i);if(r&&r.isHidden&&(r=null),r||(o&&s.showDashboardDoesNotExistDialog(this.errorService,this.localizationService,this.telemetryService,this.navigation),_.isEmpty(this.dashboardContainerModel.visibleDashboards)||(r=this.dashboardContainerModel.visibleDashboards[0])),this.setAndUpdateActiveDashboard(r),r){var a=this.navigation.currentTileGUID,n=this.navigation.currentTileOriginalGUID,c=r.objectId,l=r.contract;if(this.navigation.inAlertsEditorView())this.navigation.showAlertsEditor(a,n,this.navigation.currentAlertId,c,this.groupService.activeGroupObjectId);else if(this.navigation.inInFocusView())this.navigation.showInFocusMode(a,n,c,l.originalDashboardObjectId,this.groupService.activeGroupObjectId);else if(this.navigation.inInFocusInsightsView())this.navigation.showInsightsInFocusMode(a,n,c,this.groupService.activeGroupObjectId);else if(this.home.isHomeDashboardSet&&r.id===this.home.homeDashboard.dashboardId)this.navigation.insertGroupAndNavigateToDashboardByGUID(this.home.homeDashboard.dashboardObjectId,this.home.homeDashboard.groupId,1);else{var d=t.getDashboardAppGUID(r,this.appService,this.packageService);d?this.navigation.navigateToAppDashboardByGUID(c,l.originalDashboardObjectId,d,this.groupService.activeGroupObjectId):this.navigation.replaceAndLoadCurrentState(p.dashboard,{groupGUID:this.groupService.activeGroupObjectId,dashboardGUID:r.objectId})}}else this.dashboardContainerModel.dashboards.length>0||this.groupService.isDataInCurrentGroup()?this.navigation.replaceAndLoadCurrentState(p.dashboards,{groupGUID:this.groupService.activeGroupObjectId}):this.navigation.replaceAndLoadCurrentState(p.groupWelcome,{groupGUID:this.groupService.activeGroupObjectId})},C.prototype.navigateToManageStoragePage=function(t){var i=!0;this.groupService.activeGroup&&(i=this.groupService.activeGroup.isMyWorkspace),this.telemetryService.logEvent(e.telemetry.QuotaOpenManageStoragePage,e.telemetry.QuotaOpenManageStorageInteraction.DirectUrl,i?e.telemetry.QuotaOpenManageStorageContext.Personal:e.telemetry.QuotaOpenManageStorageContext.Group),this.navigation.replaceHistoryWithDashboardAndNavigate(t,p.manageStorage,{groupGUID:this.groupService.activeGroupObjectId})},C.prototype.navigateToManageEmbedPage=function(e){this.navigation.replaceHistoryWithDashboardAndNavigate(e,p.manageEmbed,{groupGUID:this.groupService.activeGroupObjectId})},C.prototype.onGroupSwitched=function(e,t,i){var o=this;this.updateGroupsAppMetadata(e);var r=this.navigation,a=r.currentReportGUID,n=r.currentWorkbookURLIdentifier,c=r.currentDatasetDBName,l=r.currentDashboardGUID;if(l){var d=this.findDashboardByGUID(l);d&&d.id?this.navigation.inSharingView()?this.timeout((function(){o.navigateToShareDashboard(l)})):this.navigateToActiveDashboardAfterGroupSwitch(e,d.id):a||n||c||(this.mostRecentlyUsedService.removeMRU(l),s.showDashboardDoesNotExistDialog(this.errorService,this.localizationService,this.telemetryService,this.navigation),this.navigateToActiveDashboardAfterGroupSwitch(e,this.groupService.activeGroup.lastViewedDashboard))}else a||n||c||(this.shouldShowListView()||this.shouldStayOnCurrentState()?t?this.navigateToActiveDashboardAfterGroupSwitch(e,this.groupService.activeGroup.lastViewedDashboard,t):this.shouldStayOnCurrentState()||i||this.navigation.replaceAndLoadCurrentState(p.contentList,{groupGUID:r.currentGroupGUID}):this.navigateToActiveDashboardAfterGroupSwitch(e,this.groupService.activeGroup.lastViewedDashboard,t));this.userInfo.userMetadataPromise.then((function(e){o.mergeDashboardOwnerInfo(e)}))},C.prototype.shouldStayOnCurrentState=function(){return this.navigation.inFavoritesView()||this.navigation.inRecentlyViewedView()||this.navigation.inAppsView()},C.prototype.setupNavigationWhenNoDashboardExists=function(){var t=this.navigation;if(t.inCapacitySettingsView())this.featureSwitchService.featureSwitches.adminCapacityEnabled?this.navigateToCapacitySettings():t.navigateToContentListOrActiveDashboard();else{if(t.inGetDataView())return;if(t.inManageStorageView())this.navigateToManageStoragePage(null);else if(t.inManageEmbedView())this.navigateToManageEmbedPage(null);else if(t.inSettingsView())t.showSettingsSlider(t.settingsGroup,t.settingsId);else{if(t.inGatewaysView())return;if(t.inFavoritesView())t.navigateToFavorites(this.groupService.activeGroupObjectId);else if(t.inRecentlyViewedView())t.navigateToRecentlyViewed();else if(t.inExtendTrial())this.lazy("licenseHelper").then((function(t){return t.displayDialogToExtendTrial(e.telemetry.LicenseEnforcementOperation.EmailLink)}));else if(t.inAccept2017ProTrial())this.acceptTrialAndRefresh();else if(_.isEmpty(this.reportService.copyAndEditReports)&&_.isEmpty(this.modelService.copyAndEditModels)&&_.isEmpty(this.workbookService.copyAndEditWorkbooks)&&!this.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()&&window.initialDashboardContainer&&jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(window.initialDashboardContainer.previousTenantId)){var i=this.featureSwitchService.featureSwitches;i.ignoreGettingStartedPopups?t.navigateToContentListOrActiveDashboard():t.replaceHistoryWithGroupWelcomeAndNavigate(this.groupService.activeGroupObjectId,p.getDataCategory,{groupGUID:this.groupService.activeGroupObjectId,categoryName:e.constants.navigation.getDataWelcome})}else if(this.navigation.inReportView())t.navigateToReport({groupGUID:this.groupService.activeGroupObjectId,reportGUID:t.currentReportGUID,reportOriginalGUID:t.currentReportOriginalGUID,appGUID:t.currentAppGUID,appInstanceId:t.currentAppInstanceId,reportPage:t.currentReportPage,dashboardGUID:t.currentDashboardGUID,subscriptionGUID:t.currentSubscriptionGUID},!0);else if(t.inDatasetView()&&!t.inQnaModelView())t.initialLoadDatasetByDBName(t.currentDatasetDBName);else{if(t.inWorkbookView()||t.inAppsView()||t.inAppView())return;t.navigateToContentListOrActiveDashboard()}}}},C.prototype.shouldNavigateToRequestAccess=function(){return(this.navigation.inDashboardDetailView()||this.navigation.inRequestDashboardAccessView())&&window.initialDashboardContainer&&window.initialDashboardContainer.accessRequestInfo&&window.initialDashboardContainer.accessRequestInfo.dashboardObjectId&&window.initialDashboardContainer.accessRequestInfo.dashboardObjectId===this.navigation.currentDashboardGUID},C.prototype.shouldShowListView=function(){return this.conceptualModelSetting.isListViewEnabled()},C.prototype.updateDashboard=function(){var e=this.findDashboardByGUID(this.navigation.currentDashboardGUID);e&&!e.isFilled()&&(this.modelConverter.fillDashboardChildren(e,this.dashboardContainerModel.contract.models,this.reportService.getReportContracts(),this.workbookService.workbooks),e.calculateLayout(),e.applyLayout())},C.prototype.updateDashboardContainer=function(t){if(t){for(var i=this.dashboardContainerModel,o=i.contract,r=this.modelConverter,a=function(i,a){var s=t[i],c=s.dashboards[0],l=c.id,d=n.findDashboard(l);d.contract=c,n.modelMerger.mergeDashboard(d,c,s.models,s.reports,s.workbooks),d.contract.cached&&!c.cached&&(d.contract.cached=!1);var p=t[i].packages||[],u=t[i].models||[];if(r.setDashboardIsSample(d,p),r.setDashboardHasOnPremiseModel(d,u),d.contract.tiles){var h=t[i].reports||[];d.contract.tiles.map((function(e){r.resolveTilePackage(e,p)}));for(var g=0;g<d.tiles.length;g++){var m=d.tiles[g];m.invalidateLayout();var f=r.getTileReport(m.contract.reportId,h);f&&(m.report=m.report||new v(f),r.fillReport(m.report,f))}}d.isLoaded=!0,e.contracts.mergeDashboardContainerModelsReportsAndPackages(s,o),n.reportService.mergeReportCollection(s.reports),n.modelService.mergeDatasetCollection(s.models),n.packageService.mergePackageCollection(s.packages),n.workbookService.mergeWorkbookCollection(s.workbooks)},n=this,s=0,c=t.length;s<c;s++)a(s,c);var l=this.modelMerger;l.mergeModelContentProviderId(o.models,o.packages),this.updateDashboard(),this.dashboardDataService.updateActiveDashboardModels()}var d=t.map((function(e){return e.dashboards[0]})),p=_.find(d,(function(e){return t[0].activeDashboardId}));this.syncService.monitorDashboards(p?[p]:[],t[0].userDashboardListVersion)},C.prototype.notifyForAddTile=function(t,i){var o=this,r=void 0===t?this.dashboardDataService.activeDashboard:this.dashboardDataService.findDashboard(t),a=r.contract,n=this.dashboardHttpService;if(r.getPermissions()===g.CopyOnWrite)return void this.rootScope.$emit(e.constants.personalizeEventName,r.contract.originalPackageId);if(e.dataServices.DashboardUtils.isWriteable(a)){if(!this.storageUsageService.checkQuotaExceeded(this.dashboards,e.telemetry.QuotaCheckOperation.AddTile,!0)){var s=function(){o.navigation.navigateToDashboardByGUID(r.objectId)},c={displayText:r.displayName,action:s},l={displayText:this.localizationService.get("ToastNotification_GoToDashboard"),action:s};return this.notificationToastService.notify({title:i?this.localizationService.get("PinLiveReport_NotificationMessage"):this.localizationService.get("PinTile_Success"),message:this.localizationService.get("PinTile_Success_DefaultDetails"),actionButtons:[l],actionLinks:[c]})}}else n.notifyReadOnly(a.id,!0)},C.prototype.pinTileWithoutNotification=function(t){if(!this.storageUsageService.checkQuotaExceeded(this.dashboards,e.telemetry.QuotaCheckOperation.AddTile)){var i=this.dashboardContainerModel,o=t.report;if(o){var r=this.reportService.findReport(o.id);r||(r=this.modelConverter.convertReport(o),this.reportService.addReport(r))}var a,n=this.modelConverter.convertTile(t.tile,i.contract.models,this.reportService.getReportContracts(),this.workbookService.getWorkbookContracts());t.showNotification&&(a=this.notifyForAddTile(t.dashboardId,t.isLiveReport));var s=null!=t.dashboardId?this.findDashboard(t.dashboardId):this.dashboardDataService.activeDashboard;if(s)if(n.contract.resourcePackageIds&&this.resourcePackageGateService.addResourcePackageIdToDashboard(s.objectId,n.contract.resourcePackageIds),this.addTileToDashboard(n,s),t.isTemporaryTile){var l=new c(n);this.selectDashboardTile(l),this.rootScope.$emit(e.constants.temporaryTilePinned)}else this.saveTile(n,s,t.parentEvent,a)}},C.prototype.addTileToDashboard=function(e,t){var i=t.contract;i.tiles||(i.tiles=[]);var o=t.tiles;if(e.contract.id=this.temporaryTileId--,i.tiles.push(e.contract),e.report&&e.report.id&&i.reportIds){var r=i.reportIds.indexOf(e.report.id);r===-1&&i.reportIds.push(e.report.id)}if(e.contract&&e.contract.workbookId&&i.workbookIds){var a=e.contract.workbookId,n=i.workbookIds.indexOf(a);n===-1&&i.workbookIds.push(a)}o.push(e),t.calculateLayout(),t.applyLayout()},C.prototype.saveTemporaryTile=function(e,t){this.saveTile(e,this.dashboardDataService.activeDashboard,t)},C.prototype.saveTile=function(t,i,o,r){var n=this;this.dashboardHttpService.addTile(i.contract,t.contract,this.dashboardContainerModel.contract.models,this.reportService.getReportContracts(),o.event).then((function(r){t.id=t.contract.id=r.data.id,t.contract.objectId=r.data.objectId,t&&t.contractsModel&&r&&r.data&&r.data.model&&(t.contractsModel.vsName=t.contractsModel.vsName||r.data.model.vsName,t.contractsModel.dbName=t.contractsModel.dbName||r.data.model.dbName),t.contract.workbookId&&n.dashboardSyncService.onTilesAddedOrUpdated(i.contract.id,[t.id]),t.invalidateLayout();var a=!!t.contract.modelId&&!_.any(i.tiles,(function(e){return e.contract.modelId===t.contract.modelId&&e!==t}));a&&n.updateDashboardToken(i),i&&i.isUsedByContentPack&&n.rootScope.$emit(e.constants.contentPackDirtyShowNotification,i.id,e.dataServices.models.ContentPackItems.Dashboard),o.resolve()}),(function(s){var c,l;s.status===e.HttpStatusCode.RequestEntityTooLarge?(c=n.localizationService.get("PinTile_Error_TooLarge"),l=n.localizationService.get("PinTile_Error_TooLargeDetails")):(c=n.localizationService.get("PinTile_Error"),l=n.localizationService.get("PinTile_Error_DefaultDetails")),r&&n.notificationToastService.hide(r),n.notificationToastService.notify({title:c,message:l,notificationType:e.common.NotificationToastType.Error}),n.removeTileFromDashboard(t,i),o.reject(a.getTelemetryErrorDetails(s.error))}))},C.prototype.updateDashboardToken=function(e){var t=this,i=this.promiseFactory.defer();return this.dashboardHttpService.getDashboards(this.promiseFactory,[e.id]).then((function(o){var r=o[0].data;r&&(t.modelMerger.mergeDashboardShallow(e,r.dashboards[0]),t.dashboardDataService.updateActiveDashboardModels(),i.resolve(null))}),(function(){return i.reject()})),i.promise},C.prototype.removeTemporaryTile=function(e){this.removeTileFromDashboard(e,this.dashboardDataService.activeDashboard)},C.prototype.navigateToShareDashboard=function(t){return __awaiter(this,void 0,e.Promise,(function(){var o;return __generator(this,(function(r){switch(r.label){case 0:if(this.viralTenantMergeHelperService.viewingDataFromMergedViralTenant())this.viralTenantMergeHelperService.displayFeatureDisabledErrorMessage("ArchivedContent_ErrorMessageSharing");else if(this.storageUsageService.checkQuotaExceeded(this.dashboards,e.telemetry.QuotaCheckOperation.ShareDashboard))return[2];return[4,this.checkUserNeedsProLicenseAndShowError(this.dashboardContainerModel.findDashboardByGUID(t),this.userInfo,this.licenseEnforcementService,this.localizationService,this.navigation,e.telemetry.LicenseEnforcementOperation.ShareDashboard)];case 1:return o=r.sent(),o||this.taskPaneSliderService.expandPane(f.SharingPane,i.Large),[2]}}))}))},C.prototype.checkUserNeedsProLicenseAndShowError=function(t,i,o,r,a,n,s){return void 0===s&&(s=null),__awaiter(this,void 0,e.Promise,(function(){var i,r,a;return __generator(this,(function(c){switch(c.label){case 0:return t?(r=o.supportsDashboard,r?[4,o.supportsDashboard(t.contract,n,!0)]:[3,2]):[2,!1];case 1:r=c.sent(),c.label=2;case 2:return(i=r)?[3,5]:(a=s,a?[4,o.supportsDashboard(s.contract,n,!1)]:[3,4]);case 3:a=c.sent(),c.label=4;case 4:a?this.navigationHelper.navigateToDashboard(s):this.navigation.navigateToContentList(e.constants.myWorkSpaceGroupId),c.label=5;case 5:return[2,i]}}))}))},C.prototype.removeTileFromDashboard=function(e,t){var i=t.contract.tiles,o=_.findIndex(i,{id:e.id});o!==-1&&i.splice(o,1);var r=t.tiles,a=r.indexOf(e);a!==-1&&r.splice(a,1)},C.prototype.isDashboardNameValid=function(e,t){return!_.isEmpty(e)},C.prototype.beforeDashboardDeletingHandler=function(e){this.navigateAfterDashboardDelete(this.dashboardContainerModel,e)},C.prototype.afterDashboardDeletingHandler=function(t){this.tryResetHome(t),this.navigation.inFavoritesView()&&this.rootScope.$emit(e.constants.updateFavorites)},C.prototype.isAlertingEnabled=function(){return!0},C.prototype.isInFocusModeEnabled=function(){return!0},C})();C.updateActiveDashboardDelayMs=500,C.refreshTileDataDelayMs=500,C.loadDashboardTimeout=3e4,e.DashboardService=C})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,a,n){return new r(e,t,i,o,a,n)}var o=e.dataServices.AppUtils;t.createNavigationHelper=i;var r=(function(){function e(e,t,i,o,r,a){this.navigation=e,this.appService=t,this.packageService=i,this.activeGroupId=o,this.dashboardDataService=r,this.reportService=a}return e.prototype.navigateToDashboard=function(e,t){if(e&&e.contract){var i,r=e.objectId,a=e.contract.originalDashboardObjectId;a&&(i=o.getDashboardAppGUID(e,this.appService,this.packageService)),i?this.navigation.navigateToAppDashboardByGUID(r,a,i,t):t?this.navigation.insertGroupAndNavigateToDashboardByGUID(r,t):this.navigation.navigateToDashboardByGUID(r)}},e.prototype.navigateToReport=function(e,t,i,r,a){if(e&&e.contract){var n,s,c=e.objectId,l=e.contract.originalReportObjectId;if(l){n=o.getResourceAppGUID(e,this.appService,this.packageService);var d=e.packageId;s=n&&!o.isOrgAppInstance(d,this.appService)?d:null}this.navigation.navigateToReport({appGUID:n,appInstanceId:s,reportGUID:c,reportOriginalGUID:l,groupGUID:t||this.activeGroupId.activeGroupObjectId,reportPage:i,dashboardGUID:r,filter:a})}},e.prototype.ensureDashboardGUID=function(){var e=this.navigation;if(e.inDashboardView()&&e.inAppView()&&!e.currentDashboardGUID){var t=e.currentAppInstanceId||o.getPackageIDByOrgAppGUID(this.appService,this.packageService,e.currentAppGUID),i=this.dashboardDataService.retrieveDashboardForApp(t,e.currentDashboardOriginalGUID);e.currentDashboardGUID=i&&i.objectId}},e.prototype.ensureTileGUID=function(){var e=this.navigation;if((e.inInFocusView()||e.inInFocusInsightsView()||e.inAlertsEditorView())&&e.inAppView()&&!e.currentTileGUID){var t=this.dashboardDataService.findDashboardByGUID(e.currentDashboardGUID);if(t){var i=t.findTileByObjectIdOrOriginalObjectId(null,e.currentTileOriginalGUID);e.currentTileGUID=i&&i.objectId}}},e.prototype.ensureReportGUID=function(){var e=this.navigation;if(e.inReportView()&&e.inAppView()&&!e.currentReportGUID){var t=e.currentAppInstanceId||o.getPackageIDByOrgAppGUID(this.appService,this.packageService,e.currentAppGUID),i=this.reportService.retrieveReportForApp(t,e.currentReportOriginalGUID);e.currentReportGUID=i&&i.objectId}},e})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={})),define("powerBI/services/publishApp",["require","exports"],(function(e,t){"use strict";function i(e,t,i,r,a,n,s,c,l){return new o(e,t,i,r,a,n,s,c,l)}t.create=i;var o=(function(){function e(e,t,i,o,r,a,n,s,c){this.promiseFactory=e,this.contentPackService=t,this.errorService=i,this.localizationService=o,this.modelConverter=r,this.appService=a,this.syncService=n,this.groupService=s,this.publishAppHttp=c,this.publishedApps=[],this.publishedAppsDeferred=e.defer(),this.syncService.addContentPackRefreshListener(this),this.groupService.addGroupChangedHandler(this),this.loadPublishedApps()}return e.prototype.onContentPackDeleted=function(e){_.remove(this.publishedApps,(function(t){return t.providerId===e}))},e.prototype.onGroupChanged=function(){this.publishedApps=[],this.loadPublishedApps()},e.prototype.addPublishedApp=function(e){this.findPublishedApp(e.objectId)||this.publishedApps.push(e)},e.prototype.findPublishedApp=function(e){return _.find(this.publishedApps,(function(t){return t.objectId===e}))},e.prototype.getPublishedAppsForCurrentGroup=function(){return this.publishedAppsDeferred?this.publishedAppsDeferred.promise:this.promiseFactory.resolve(this.publishedApps)},e.prototype.deletePublishedApp=function(e,t){var i=this,o=_.find(this.publishedApps,(function(e){return e.providerContract.providerKey===t}));if(!o)return this.promiseFactory.reject();var r=this.promiseFactory.defer();return _.pull(this.publishedApps,o),this.publishAppHttp.deleteApp(e,t).then((function(){i.contentPackService.removeContentPacks([o.providerId]),i.contentPackService.markItemsUsedByContentPack(),r.resolve(null)}),(function(){i.publishedApps.push(o),r.reject()})),r.promise},e.prototype.publishOrUpdateApp=function(e,t,i){return t.objectId?this.publishAppHttp.updateApp(e,t,i):this.publishAppHttp.publishApp(e,t,i)},e.prototype.loadPublishedApps=function(){var e=this;this.publishedAppsDeferred&&this.publishedAppsDeferred.reject();
var t=this.publishedAppsDeferred=this.promiseFactory.defer();this.groupService.ensureGroupsInitialization().then((function(i){e.contentPackService.getContentPacksForCurrentGroup().then((function(i){if(e.publishedAppsDeferred===t){var o=_.filter(i,(function(t){return e.appService.isAppCategory(t.providerContract.category)}));e.publishedApps=o.map((function(t){return e.modelConverter.convertAppPublishModel(t.providerContract)})),t.resolve(e.publishedApps),e.publishedAppsDeferred=null}}),(function(){t.reject()}))}),(function(){t.reject()}))},e})()}));var common=powerbi.common,services=powerbi.services;angular.module("powerbi.components",[]),angular.module("powerbi.controllers",[]),angular.module("powerbi.directives",[]),angular.module("powerbi.filters",[]);var modules=["angularFileUpload","powerbi.common","powerbi.common.directives","powerbi.connectivity","powerbi.components","powerbi.controllers","powerbi.directives","powerbi.filters","powerbi.visualHost","powerbi.dataServices","ui.router","ngSanitize"];powerbi.explore&&(modules.push("powerbi.explore"),modules.push("powerbi.infonavbootstrap")),powerbi.insights&&modules.push("powerbi.insights"),powerbi.settings&&(modules.push("powerbi.settings"),modules.push("powerbi.settings.components")),powerbi.userNotifications&&modules.push("powerbi.userNotifications"),powerbi.capacityAdmin&&(modules.push("powerbi.capacityAdmin"),modules.push("powerbi.capacityAdmin.components")),angular.module("powerbi",modules).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(new RegExp(e.aHrefSanitizationWhitelist().source+"|^s*(data):"))}]).config(["lazyProvider",function(e){var t=e.factories;t.insightsBootstrap={source:{javascript:"powerBI/services/insightsBootstrap"},ng:["insightsService","modelService","navigation","telemetryService","notificationToast","localizationService","appService"],fn:function(e,t,i,o,r,a,n,s){return e.create(t,i,o,r,a,n,s)}},t.insightsRuntime={source:{javascript:"powerBI/proxies/insightsHttpRuntime"},ng:["promiseFactory","syncService","featureSwitchService"],fn:function(e,t,i,o){return e.create(common.httpService,t,i,o)}},t.permissionNavigation={source:{javascript:"PermissionsDataServices/services/permissionNavigation"},ng:["$location","$window","$rootScope","$state","featureSwitchService"],fn:function(e,t,i,o,r,a){return e.create(t,i,o,r,a)}},t.permissionHttp={source:{javascript:"PermissionsDataServices/proxies/permissionHttp"},fn:function(e){return e.create()}},t.permissionData={source:{javascript:"PermissionsDataServices/services/permissionData"},ng:["dashboardDataService","reportService","modelService","workbookService","promiseFactory","telemetryService"],modular:["permissionHttp"],fn:function(e,t,i,o,r,a,n,s){return e.create(t,i,o,r,a,n,s)}},t.publishAppHttp={source:{javascript:"powerBI/proxies/publishAppHttp"},fn:function(e){return e.create()}},t.publishApp={source:{javascript:"powerBI/services/publishApp"},ng:["promiseFactory","contentPackService","errorService","localizationService","modelConverter","appService","syncService","groupService"],modular:["publishAppHttp"],fn:function(e,t,i,o,r,a,n,s,c,l){return e.create(t,i,o,r,a,n,s,c,l)}}}]).factory("syncService",["$timeout","promiseFactory","delayedQueryResultHandler","telemetryService","asyncFeatureSwitchService","pageVisibilityService",function(e,t,i,o,r,a){var n=common.createSyncService(e,t),s=powerbi.createDelayedQueryResultResolver(n,e,o);return i.setQueryResolver(s),r.getFeatureSwitches().then((function(e){e.autoPausedSyncService&&a.register(n)})),n}]).factory("userSettingsHttpService",[function(){return powerbi.createUserSettingsHttpService()}]).factory("favoritesHttp",["syncService","notificationToast",function(e,t){return powerbi.createFavoritesHttpService(e,t)}]).factory("settingsMetadataHttpService",[function(){return powerbi.createSettingsMetadataHttpService()}]).factory("o365ApplicationLauncherService",(function(){return powerbi.createO365ApplicationLauncherService()})).factory("refreshService",["modelHttpService","datasetsService","$rootScope","notificationToast","gatewaysMetadataService","featureSwitchService","promiseFactory","selectGatewayService","localizationService","modalDialogService",function(e,t,i,o,r,a,n,s,c,l){return powerbi.createRefreshService(e,t,i,o,r,a,n,s,c,l)}]).factory("geolocationService",powerbi.visuals.services.createGeolocation).factory("tileDisplay",["errorService",function(e){return powerbi.createTileDisplayService(e)}]).factory("modelConverter",["telemetryService","errorService","visualPlugin","promiseFactory","geolocationService","dataServiceModelConverter","localizationService",function(e,t,i,o,r,a,n){return powerbi.models.createModelConverter(e,t,i,o,r,a,n)}]).factory("contentProviderHttpService",["featureSwitchService","activeGroupId",function(e,t){return powerbi.common.createContentProviderHttpService(e,t)}]).factory("contentProviderService",["featureSwitchService","userInfo","localizationService","contentProviderHttpService","telemetryService","errorService","notificationToast","lazy","appService","promiseFactory","conceptualModelSetting","licenseEnforcementService",function(e,t,i,o,r,a,n,s,c,l,d,p){return powerbi.services.createContentProviderService(e,t,i,o,r,a,n,s,c,l,d,p)}]).factory("alertHttpService",["promiseFactory","telemetryService","errorService","localizationService",function(e,t,i,o){return powerbi.createAlertHttpService(e,t,i,o)}]).factory("subscriptionsHttp",["promiseFactory","telemetryService",function(e,t){return powerbi.createSubscriptionsHttpService(e,t)}]).factory("alertRuleService",powerbi.createAlertRuleService).factory("realTimeDataHttp",[function(){return powerbi.createRealTimeDataHttpService()}]).factory("powerBIDesktopLauncher",[function(){return common.powerBIDesktopLauncher}]).factory("realTimeLongPollData",["$timeout","tabularDataCache","realTimeDataHttp","telemetryService","promiseFactory",function(e,t,i,o,r){return services.createRealTimeLongPollDataService(e,t,i,o,r,{enableDataRefresh:!0})}]).factory("realTimePubNubData",["promiseFactory","realTimeDataHttp","tabularDataCache","telemetryService","moduleLoader","$timeout",function(e,t,i,o,r,a){return services.createRealTimePubNubDataService(e,t,i,o,r,a)}]).factory("realTimeData",["$rootScope","modelService","realTimeLongPollData","realTimePubNubData","tabularDataCache","pageVisibilityService",function(e,t,i,o,r,a){var n=services.createRealTimeDataService(e,t,i,o,r);return a.register(n),n}]).factory("realTimeModel",["conceptualSchemaProxy","errorService","localizationService","modelService","promiseFactory","realTimeDataHttp","telemetryService","$timeout",function(e,t,i,o,r,a,n,s){return services.createRealTimeModelService(e,t,i,o,r,a,n,s)}]).factory("modelMerger",["modelConverter","dataServiceModelMerger","permissionService",function(e,t,i){var o=powerbi.models.createModelMerger(e,t,i);return e.setModelMerger(o),o}]).factory("navigationStateValidator",["$timeout","impersonationService","permissionService","reportService",function(e,t,i,o){return services.createNavigationStateValidator(e,t,i,o)}]).factory("conceptualModelSetting",["featureSwitchService","tutorialDataStore",function(e,t){return powerbi.createConceptualModelSetting(e,t)}]).service("navigation",["$location","$window","$rootScope","$state","$stateParams","featureSwitchService","activeGroupId","home","navigationStateValidator","conceptualModelSetting",services.Navigation]).service("navigationActions",["$rootScope","contentPackService","dashboardService","errorService","featureSwitchService","groupService","localizationService","modalDialogService","modelService","navigation","notificationToast","packageService","quota","reportService","telemetryService","workbookService","ownership","lazy","navigationHelper",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y){return services.createNavigationActions(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y)}]).service("navigationHelper",["navigation","appService","packageService","activeGroupId","dashboardDataService","reportService",function(e,t,i,o,r,a){return services.createNavigationHelper(e,t,i,o,r,a)}]).factory("fullScreen",["$rootScope","navigation","$document",function(e,t,i){return services.createFullScreenService(e,t,i)}]).factory("historyDialogService",["$rootScope","$compile",function(e,t){return powerbi.createHistoryDialogService(e,t)}]).factory("groupService",["$location","$rootScope","$timeout","telemetryService","errorService","localizationService","groupHttp","activeGroupId","featureSwitchService","userInfo","reportService","modelService","promiseFactory","navigation","workbookService","packageService","lazy","appMetadataService","home","appService",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){var S={location:e,rootScope:t,timeout:i,telemetryService:o,errorService:r,localizationService:a,groupHttpService:n,activeGroupIdService:s,featureSwitchService:c,userInfo:l,appService:b,reportService:d,modelService:p,promiseFactory:u,navigation:v,workbookService:h,packageService:g,lazy:m,appMetadataService:f,home:y};return powerbi.createGroupService(S)}]).factory("groupContextMenuService",["$window","$rootScope","errorService","groupHttp","groupService","localizationService","modalDialogService","navigation","promiseFactory","taskPaneSliderService","telemetryService",function(e,t,i,o,r,a,n,s,c,l,d){var p={rootScope:t,$window:e,errorService:i,groupHttp:o,groupService:r,localizationService:a,modalDialogService:n,navigation:s,promiseFactory:c,taskPaneSliderService:l,telemetryService:d};return powerbi.createGroupContextMenuService(p)}]).factory("scriptVisuals",["featureSwitchService","localizationService","userInfo","visualPlugin","embedModeService",function(e,t,i,o,r){return powerbi.explore.services.createScriptVisualsService(o,e,t,i,r)}]).factory("embed",["$location","promiseFactory","featureSwitchService","dataReaderProvider","explorationSerializer","conceptualSchemaProxy","dataProxy","displayNameService","visualPlugin","aggrOps","telemetryService","scriptVisuals","activeGroupId",function(e,t,i,o,r,a,n,s,c,l,d,p,u){var v=powerbi.explore.services.createVisualPluginOps(c),h=powerbi.explore.services.createVisualRelationshipService(c,v),g=powerbi.explore.services.createSortService(s,i,c),m=powerbi.explore.services.createFilterGenerator(common.createEventBridge(),c,l,h,{getSelectedHostFilters:function(){return null}},d,p),f=powerbi.data.transforms.createTransformPluginService(),y=powerbi.explore.services.createVisualQueryGenerator({dataReaders:o,displayNameService:s,featureSwitchService:i,plugin:c,pluginOps:v,sortService:g,aggrOps:l,filterGenerator:m,transformPluginService:f,telemetryService:d});return powerbi.explore.services.createEmbedService(e,t,r,a,y,n,c,s,m,u)}]).factory("dynamicMessagingDataHttp",[function(){return powerbi.createDynamicMessagingDataHttpService()}]).service("dynamicMessagingData",["dynamicMessagingDataHttp","userNotificationInfo","userInfo","telemetryService","localizationService","asyncFeatureSwitchService",function(e,t,i,o,r,a){return powerbi.createDynamicMessagingDataService(e,t,i,o,r,a)}]).service("dashboardStateChangeService",["$rootScope","dashboardDataService","dashboardService","dashboardWarningsService","errorService","featureSwitchService","groupService","inFocusService","licenseEnforcementService","localizationService","modelConverter","mostRecentlyUsedService","navigation","permissionService","$timeout","telemetryService","userInfo","appService","subscription","taskPaneSliderService",services.DashboardStateChangeService]).service("dashboardConfigurationService",(function(){return services.createDashboardConfigurationService()})).service("dashboardWarningsService",["$rootScope","telemetryService","dashboardDataService","resourceGateService","featureSwitchService","tutorialDataStore","notificationBar","resourcePackageListenerService","embedModeService","localizationService","visualPlugin",services.DashboardWarningsService]).service("dashboardService",["$location","$rootScope","navigation","$timeout","telemetryService","errorService","modelMerger","modelConverter","syncService","dashboardConfigurationService","dashboardDataService","dashboardHttpService","dashboardSyncService","dashboardWarningsService","fullScreen","localizationService","promiseFactory","reportService","modelHttpService","viralTenantMergeHelperService","groupService","featureSwitchService","modelService","licenseEnforcementService","userInfo","contentProviderHttpService","storageUsageService","appMetadataService","permissionService","workbookService","notificationBar","notificationToast","resourcePackagesService","userSettingsService","visualPlugin","invitationService","resourceGateService","home","packageService","inFocusService","userActivityContextService","mostRecentlyUsedService","appService","editableFeatureSwitchService","conceptualModelSetting","taskPaneSliderService","fileSaver","navigationHelper","lazy",powerbi.DashboardService]).service("explorationLoader",["$rootScope","$timeout","modelConverter","explorationProxy","localizationService","telemetryService","navigation","modelService","packageService","notificationBar","errorService","userActivityContextService",services.ExplorationLoader]).factory("contentPackService",["$rootScope","appService","errorService","telemetryService","modelConverter","syncService","contentProviderHttpService","localizationService","navigation","dashboardService","featureSwitchService","userInfo","lazy","notificationToast","reportService","modelService","permissionService","workbookService","promiseFactory","quota","modalDialogService","groupService","licenseEnforcementService",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C){return powerbi.createContentPackService(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C)}]).factory("tenantContentPackService",["telemetryService","featureSwitchService","contentProviderHttpService","promiseFactory","modelConverter",function(e,t,i,o,r){return powerbi.createTenantContentPackSerivce(e,t,i,o,r)}]).factory("storageUsageService",["$rootScope","telemetryService","errorService","dashboardHttpService","localizationService","featureSwitchService","reportService","modelService","promiseFactory","navigation","userInfo","groupService","workbookService","lazy","permissionService",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h){return powerbi.createStorageUsageService(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h)}]).factory("quota",["storageUsageService","dashboardService",function(e,t){return services.createQuota(e,t)}]).factory("usageMetricsHttp",["$http","promiseFactory","telemetryService","activeGroupId","httpRequestWorker",function(e,t,i,o,r){var a=new common.HttpService(e,t,i,o,r);return powerbi.createUsageMetricsHttpService(i,t,a)}]).factory("groupHttp",["telemetryService","activeGroupId",function(e,t){return powerbi.createGroupHttpService(e,t)}]).factory("tutorialPopup",["telemetryService","userInfo","tutorialDataStore","applicationOptions","featureSwitchService","localizationService","navigation","conceptualModelSetting","rtl","appMetadataService","groupHttp",function(e,t,i,o,r,a,n,s,c,l,d){return powerbi.createTutorialPopupService(e,t,i,o,r,a,n,s,c,l,d)}]).factory("userSettingsService",["telemetryService","modelConverter","promiseFactory","userSettingsHttpService","errorService","localizationService","appMetadataService","networkAvailability","$rootScope",function(e,t,i,o,r,a,n,s,c){return powerbi.createUserSettingsService(e,t,i,o,r,a,n,s,c)}]).factory("settingsMetadataService",["promiseFactory","settingsMetadataHttpService","telemetryService",function(e,t,i){return powerbi.createSettingsMetadataService(e,t,i)}]).factory("licenseCheckStrategyFactory",["featureSwitchService","userInfo","reportService","modelService","lazy","localizationService",function(e,t,i,o,r,a){return new powerbi.LicenseCheckStrategyFactory(e,t,i,o,r,a)}]).factory("licenseEnforcementService",["analyzeInExcel","licenseCheckStrategyFactory","$rootScope","userInfo","lazy","checkUnsavedService","userNotificationInfo",function(e,t,i,o,r,a,n){return powerbi.createLicenseEnforcementSevice(e,t,i,o,r,a,n)}]).factory("pinTileService",["$rootScope","errorService","telemetryService","localizationService","modalDialogService","modelConverter","visualPlugin","themeService","visualStylePresetService","userSettingsService","reportService","modelService","workbookService","dashboardService","packageService","explorationSerializer","promiseFactory","moduleLoader","featureSwitchService","usageMetricsReport",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){return powerbi.createPinTileService(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b)}]).service("previewFeaturesModalService",["$rootScope","$document","telemetryService","localizationService","modalDialogService","tutorialDataStore",services.PreviewFeaturesModalService]).factory("inFocusService",["$rootScope","telemetryService","modelConverter","modelService","reportService","localizationService","visualPlugin",function(e,t,i,o,r,a,n){return services.createInFocusService(e,t,i,o,r,a,n)}]).factory("home",["$rootScope","errorService","localizationService","notificationToast","telemetryService","promiseFactory",function(e,t,i,o,r,a){return services.createHome(e,t,i,o,r,a)}]).service("bootstrapService",["$rootScope","dashboardService","dashboardDataService","modelService","telemetryService","localizationService","navigation","notificationToast","storageUsageService","errorService","favorites","mostRecentlyUsedService","home","groupService","promiseFactory","workbookService","conceptualModelSetting","storeAppInstall","packageService","appService","lazy",services.BootstrapService]).factory("checkSigninService",[function(){return new common.DefaultCheckSigninService}]).factory("qrCodeService",["$rootScope","$compile","promiseFactory","localizationService","dashboardHttpService","reportHttpService","errorService","modalDialogService","telemetryService","moduleLoader",function(e,t,i,o,r,a,n,s,c,l){return powerbi.createQRCodeService(e,t,i,o,r,a,n,s,c,l)}]).factory("ownership",["packageService",function(e){return powerbi.createOwnershipService(e)}]).factory("filterPersistenceService",["promiseFactory","userSettingsService","telemetryService",function(e,t,i){return services.createFilterPersistenceService(e,t,i)}]).factory("mostRecentlyUsedService",["promiseFactory",function(e){return services.createMostRecentlyUsedServicePlaceholder(e)}]).factory("printService",["$rootScope",function(e){return powerbi.createPrintService(e)}]).factory("pageVisibilityService",["telemetryService","$document",function(e,t){return powerbi.createPageVisibilityService({logPageInactiveToTelemetry:!0},e,t)}]).factory("invitationService",["promiseFactory","telemetryService",function(e,t){return powerbi.createInvitationService(e,t)}]).factory("pageTitle",["localizationService","navigation","dashboardService","reportService","workbookService","$window","$rootScope",function(e,t,i,o,r,a,n){return services.createPageTitleService(e,t,i,o,r,a,n)}]).factory("shareSliderService",["navigation","$rootScope","taskPaneSliderService","licenseEnforcementService",function(e,t,i,o){return services.createShareSliderService(e,t,i,o)}]).factory("favorites",["telemetryService","favoritesHttp","activeGroupId","promiseFactory","dashboardService","$rootScope","featureSwitchService","notificationToast","localizationService","errorService","permissionService","appMetadataService","navigation","tutorialDataStore","dataClassificationService","appService","mostRecentlyUsedService",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){return powerbi.createFavoritesService(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m)}]).factory("usageMetricsReport",["usageMetricsHttp","navigation","localizationService","notificationToast","dashboardService","errorService","reportService","promiseFactory","packageService","modelService","moduleLoader",function(e,t,i,o,r,a,n,s,c,l,d){return services.createUsageMetricsReportService(e,t,i,o,r,a,n,s,c,l,d)}]).factory("contentList",["telemetryService","dashboardService","reportService","navigation","modelService","analyzeInExcel","workbookService","contentPackService","localizationService","packageService","errorService","$rootScope","modalDialogService","exportToPowerPoint","refreshService","permissionService","settingsMetadataService","$location","$window","favorites","shareSliderService","groupService","appService","promiseFactory","mostRecentlyUsedService","dataServiceModelConverter","conceptualModelSetting","dashboardDataService","taskPaneSliderService","ownership","usageMetricsReport","lazy",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M,k,P,E,A,_){return powerbi.createContentListService(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M,k,P,E,A,_)}]).factory("visualPlugin",["asyncFeatureSwitchService","promiseFactory","resourceLoader","telemetryService",function(e,t,i,o){return powerbi.createDashboardVisualPluginService(e,t,i,o,{tooltipsEnabled:!0})}]).factory("visualStylePresetService",(function(){return powerbi.visualHost.services.createVisualStylePresetService()})).factory("exportStaticReportProxy",["promiseFactory","errorService","localizationService",function(e,t,i){return powerbi.proxies.createExportStaticReportProxy(e,t,i)}]).factory("exportStaticExplorationService",["exportStaticReportProxy","notificationToast","localizationService",function(e,t,i){return services.createExportStaticExplorationService(e,t,i)}]).factory("breadcrumbFactory",["localizationService","navigation","groupService","dashboardDataService","home","reportService","workbookService","modelService","permissionService","userInfo","asyncFeatureSwitchService","promiseFactory","ownership","appService","conceptualModelSetting","dataServiceModelConverter","packageService","usageMetricsReport",powerbi.models.factory.createBreadcrumbFactory]).factory("storeAppInstall",["appService","navigation","promiseFactory","contentProviderService","contentProviderHttpService","errorService","localizationService","telemetryService","quota","modalDialogService","$rootScope","activeGroupId","dataServiceModelConverter",function(e,t,i,o,r,a,n,s,c,l,d,p,u){return services.createStoreAppInstallService(e,t,i,o,r,a,n,s,c,l,d,p,u)}]).factory("httpRequestWorker",["promiseFactory","telemetryService","localizationService","errorService","$timeout","$window","embedModeService","checkSigninService","clusterUriRetriever","httpUriRedirector","urlInterceptor","userActivityContextService","logger",function(e,t,i,o,r,a,n,s,c,l,d,p,u){return powerbi.common.createHttpRequestWorker(e,t,i,o,r,a,n,null,s,c,l,d,p,u)}]).factory("trustedVisual",["promiseFactory","featureSwitchService","localizationService","resourceLoader","visualSandbox","visualConsent","approvedResourceService","$rootScope","errorService","modalDialogService","userSettingsService","telemetryService",function(e,t,i,o,r,a,n,s,c,l,d,p){var u=powerbi.visualHost.createTrustedVisualService(e,p,a,n,r,o);return u.registerTrustedVisual([powerbi.visualHost.EsriVisual],powerbi.helpers.EsriVisualHelper.createRegisterTrustedVisualOptions(e,s,c,l,t,i,d,p,u,a)),u.registerTrustedVisual([powerbi.visualHost.VisioVisual,powerbi.visualHost.VisioDFVisual],powerbi.explore.utils.VisioVisualHelper.createVisioVisualRegisterOptions()),u}]).run(["$http","$rootScope","promiseFactory","telemetryService","errorService","activeGroupId","featureSwitchService","checkSigninService","clusterUriRetriever","httpUriRedirector","urlInterceptor","expiredTokenSink","$window","$timeout","logger","embedModeService","httpRequestWorker",function(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m){powerbi.common.localize=common.createLocalizationService(o,i),powerbi.common.httpService=new common.HttpService(e,i,o,a,m),powerbi.common.featureSwitchService=n,powerbi.notifyDashboardContainerReady=function(e){t.$emit(powerbi.dataServices.constants.initialDashboardContainerReadyEventName,e)},powerbi.logBootstrapInfo=function(e){o.logEvent(powerbi.telemetry.AppAngularBootstrap,e.start,e.end)},powerbi.visuals&&powerbi.explore.services.VisualHostServices.initialize(powerbi.common.localize)}]).run(["groupService",function(e){}]).run(["licenseEnforcementService",function(e){}]).run(["printService",function(e){}]).run(["pageVisibilityService",function(e){}]).run(["dynamicMessagingData",function(e){}]).run(["scopedProvider",function(e){e.register("exportData",{services:["promiseFactory","notificationToast","localizationService","conceptualSchemaProxy","featureSwitchService","visualPlugin","displayNameService","aggrOps"],scopedServices:["exportVisualData","filterRestatement","drillToDetails","visualPluginOps"],fn:function(e,t,i,o,r,a,n,s,c,l,d,p){return powerbi.createExportDataService(e,t,i,o,a,p,c,r,n,s,l,d)}})}]);var powerbi;!(function(e){function t(t,i){void 0===i&&(i=[]);var o="powerbi.controllers."+t;i.push(e.controllers[t]),angular.module("powerbi.controllers").controller(o,i)}function i(e,t){var i=_.camelCase(t);return e.get(i)}function o(t){var i=[{name:"AlertsEditor",blockType:2,consumerHostFlags:8},{name:"AppArtifactsList",blockType:2,consumerHostFlags:8},{name:"AppChannelHeader",blockType:2,consumerHostFlags:8},{name:"AppContainer",blockType:2,consumerHostFlags:8},{name:"AppLogo",blockType:2,consumerHostFlags:8},{name:"AppPlaceholder",blockType:2,consumerHostFlags:8},{name:"AppsContainer",blockType:2,consumerHostFlags:8},{name:"BackgroundImage",dependencies:["localizationService"],blockType:1,consumerHostFlags:232},{name:"Breadcrumbs",blockType:2,consumerHostFlags:8},{name:"CollapsiblePane",blockType:1,consumerHostFlags:232},{name:"CompositeTile",blockType:1,consumerHostFlags:232},{name:"ContentListContainerV2",blockType:2,consumerHostFlags:8},{name:"ContentListGallery",blockType:2,consumerHostFlags:8},{name:"ContentProvider",dependencies:["$timeout"],blockType:1,consumerHostFlags:8},{name:"ContentProviderChildTile",blockType:1,consumerHostFlags:8},{name:"ContentProviderConfiguration",dependencies:["$timeout","$window","$rootScope","localizationService","navigation","contentProviderService"],blockType:1,consumerHostFlags:8},{name:"ContentProviderEventTile",blockType:1,consumerHostFlags:8},{name:"ContentProviderLinkTile",blockType:1,consumerHostFlags:8},{name:"ContentProviderLocalFile",blockType:1,consumerHostFlags:8},{name:"ContentProviderLocalFileTile",dependencies:["localFileService","quota","promiseFactory"],blockType:1,consumerHostFlags:8},{name:"ContentProviderNormalTile",blockType:1,consumerHostFlags:8},{name:"ContentProviderSplash",dependencies:["telemetryService","navigation"],blockType:1,consumerHostFlags:8},{name:"ContentProviderStore",blockType:1,consumerHostFlags:8},{name:"ContentProviderTileBody",blockType:1,consumerHostFlags:8},{name:"ContentProviderTileBrowser",dependencies:["$timeout","$window","navigation","telemetryService","localizationService","viralTenantMergeHelperService","userInfo","quota","contentProviderService","rtl","windowMetrics"],blockType:1,consumerHostFlags:8},{name:"ContentDatasetActions",blockType:2,consumerHostFlags:8},{name:"ContentTile",blockType:2,consumerHostFlags:8},{name:"ContentRow",blockType:2,consumerHostFlags:8},{name:"ContentHeader",blockType:2,consumerHostFlags:8},{name:"ContentRowContainer",blockType:2,consumerHostFlags:8},{name:"ContentTileContainer",blockType:2,consumerHostFlags:8},{name:"ContentTileOptionsMenu",blockType:2,consumerHostFlags:8},{name:"ContextMenu",dependencies:["rtl","windowMetrics"],blockType:1,consumerHostFlags:232},{name:"CreateGroupBlade",blockType:2,consumerHostFlags:8},{name:"EditGroupBlade",blockType:2,consumerHostFlags:8},{name:"ViewGroupBlade",blockType:2,consumerHostFlags:8},{name:"CustomValidator",dependencies:["$timeout"],blockType:1,consumerHostFlags:8},{name:"CustomValidatorSynchronizer",blockType:1,consumerHostFlags:8},{name:"Dashboard",dependencies:["telemetryService","gridLayout","userActivityContextService","appService","packageService","$timeout","groupService"],blockType:1,consumerHostFlags:232},{name:"DashboardContainer",blockType:1,consumerHostFlags:232},{name:"DashboardEditMobileDisplay",blockType:2,consumerHostFlags:8},{name:"DashboardNavigationPaneListItem",blockType:1,consumerHostFlags:8},{name:"DashboardPane",blockType:2,consumerHostFlags:8},{name:"DashboardPrinter",dependencies:["$rootScope","$compile","featureSwitchService","localizationService"],blockType:1,consumerHostFlags:72},{name:"DashboardTile",blockType:1,consumerHostFlags:232},{name:"DashboardTileList",blockType:2,consumerHostFlags:8},{name:"DashboardTileOpenOptions",blockType:1,consumerHostFlags:72},{name:"DashboardTileOptionsMenu",blockType:1,consumerHostFlags:72},{name:"ClassificationLabel",blockType:2,consumerHostFlags:72},{name:"DatasetIconContainer",blockType:2,consumerHostFlags:8},{name:"DatasetNavigationPaneListItem",blockType:1,consumerHostFlags:8},{name:"DevToolsView",blockType:1,consumerHostFlags:8},{name:"EditIframeWidget",dependencies:["featureSwitchService","explorationSerializer"],blockType:1,consumerHostFlags:8},{name:"EditImageWidget",dependencies:["featureSwitchService","explorationSerializer"],blockType:1,consumerHostFlags:8},{name:"EditTextWidget",blockType:1,consumerHostFlags:8},{name:"EditVideoWidget",blockType:1,consumerHostFlags:8},{name:"ErrorPlaceholder",blockType:2,consumerHostFlags:72},{name:"ExcelUploadFormat",blockType:1,consumerHostFlags:8},{name:"ExplorationContainer",blockType:1,consumerHostFlags:330},{name:"ExploreCanvasPrinter",dependencies:["$rootScope","$compile","featureSwitchService","localizationService"],blockType:1,consumerHostFlags:8},{name:"ExploreCompatibilityContainer",dependencies:["$window"],blockType:1,consumerHostFlags:330},{name:"ExportDataDialog",blockType:2,consumerHostFlags:330},{name:"FavoritesContainer",blockType:2,consumerHostFlags:8},{name:"FeaturedDashboardContainer",blockType:2,consumerHostFlags:8},{name:"FullScreenControls",dependencies:["fullScreen","navigation"],blockType:1,consumerHostFlags:72},{name:"FlyoutToggle",dependencies:["$window"],blockType:1,consumerHostFlags:8},{name:"GroupActions",blockType:2,consumerHostFlags:8},{name:"GroupIcon",blockType:2,consumerHostFlags:72},{name:"GroupList",blockType:2,consumerHostFlags:8},{name:"GroupNavigationPaneListItem",blockType:1,consumerHostFlags:8},{name:"GroupSwitcher",blockType:2,consumerHostFlags:8},{name:"GroupSwitcherV2",blockType:2,consumerHostFlags:8},{name:"HistoryDialog",blockType:1,consumerHostFlags:8},{name:"IframeTile",dependencies:["$window","networkAvailability","localizationService"],blockType:1,consumerHostFlags:232},{name:"ImageTile",blockType:1,consumerHostFlags:232},{name:"InFocus",dependencies:["promiseFactory"],blockType:1,consumerHostFlags:232},{name:"Insights",blockType:1,consumerHostFlags:72},{name:"InstallStoreAppDialog",blockType:2,consumerHostFlags:8},{name:"InsufficientLicenseBar",blockType:2,consumerHostFlags:8},{name:"IntroduceAppBar",blockType:2,consumerHostFlags:8},{name:"IntroduceAppDialog",blockType:2,consumerHostFlags:8},{name:"LandingContainer",blockType:1,consumerHostFlags:72},{name:"LoadNotificationDialog",blockType:1,consumerHostFlags:8},{name:"LocalFileBrowser",dependencies:["localizationService","errorService","featureSwitchService","$timeout"],blockType:1,consumerHostFlags:8},{name:"MakeACopyDialog",blockType:2,consumerHostFlags:8},{name:"ManageDatasets",blockType:1,consumerHostFlags:8},{name:"ManageEmbedView",blockType:1,consumerHostFlags:8},{name:"ManageStorageView",blockType:1,consumerHostFlags:8},{name:"MarketplaceHost",blockType:2,consumerHostFlags:8},{name:"MetadataContainer",blockType:2,consumerHostFlags:8},{name:"ModelTile",blockType:1,consumerHostFlags:232},{name:"NavigationBar",blockType:1,consumerHostFlags:8},{name:"NavigationPane",blockType:1,consumerHostFlags:8},{name:"NavigationPaneV2",blockType:2,consumerHostFlags:8},{name:"NavPaneFlyoutButton",blockType:2,consumerHostFlags:8},{name:"NpsHost",blockType:1,consumerHostFlags:8},{name:"O365ApplicationLauncher",blockType:1,consumerHostFlags:8},{name:"OnLoad",blockType:1,consumerHostFlags:232},{name:"PbiDataLoaderSpinner",dependencies:["localizationService","$timeout"],
blockType:1,consumerHostFlags:72},{name:"PinTileDialog",dependencies:["$timeout"],blockType:1,consumerHostFlags:8},{name:"PopupNotificationDialog",blockType:2,consumerHostFlags:8},{name:"PreviewFeaturesModal",blockType:2,consumerHostFlags:8},{name:"PreviewFeedbackModal",blockType:2,consumerHostFlags:8},{name:"PrintableImage",blockType:2,consumerHostFlags:232},{name:"ProgressDialog",blockType:2,consumerHostFlags:8},{name:"ProviderTile",blockType:1,consumerHostFlags:8},{name:"PublishContentPackView",blockType:1,consumerHostFlags:8},{name:"PublishTenantContentPackView",blockType:1,consumerHostFlags:8},{name:"PubNubEditor",blockType:2,consumerHostFlags:8},{name:"QnaContainer",blockType:1,consumerHostFlags:72},{name:"QrCodeDialog",blockType:1,consumerHostFlags:8},{name:"QrCodeProgressDialog",blockType:1,consumerHostFlags:8},{name:"QuickAccessPane",dependencies:[],blockType:2,consumerHostFlags:8},{name:"RealTimeBlade",blockType:2,consumerHostFlags:8},{name:"RealTimeTile",blockType:2,consumerHostFlags:232},{name:"RealTimeTileVisualizationDesign",blockType:2,consumerHostFlags:8},{name:"RecentlyViewedContainer",blockType:2,consumerHostFlags:8},{name:"RefreshStatus",blockType:1,consumerHostFlags:8},{name:"RefreshWelcome",blockType:1,consumerHostFlags:8},{name:"RelatedContentBlade",blockType:2,consumerHostFlags:8},{name:"RelatedContentDatasetRow",blockType:2,consumerHostFlags:8},{name:"ReportNavigationPaneListItem",blockType:1,consumerHostFlags:8},{name:"ReportTile",blockType:1,consumerHostFlags:232},{name:"RequestDashboardAccess",blockType:1,consumerHostFlags:8},{name:"RequestDashboardAccessModal",blockType:1,consumerHostFlags:8},{name:"SelectButton",blockType:2,consumerHostFlags:8},{name:"SelectTileFilter",blockType:2,consumerHostFlags:8},{name:"SelectArtifactFilter",blockType:2,consumerHostFlags:8},{name:"SelectDatasetDialog",blockType:2,consumerHostFlags:8},{name:"SelectTileSort",blockType:2,consumerHostFlags:8},{name:"SettingsCommunications",blockType:2,consumerHostFlags:8},{name:"SettingsCloseAccount",blockType:1,consumerHostFlags:8},{name:"SettingsAlerts",blockType:2,consumerHostFlags:8},{name:"SettingsBlade",blockType:2,consumerHostFlags:8},{name:"SettingsDashboard",blockType:1,consumerHostFlags:8},{name:"SettingsDashboardBlade",blockType:2,consumerHostFlags:8},{name:"SettingsDashboards",blockType:1,consumerHostFlags:8},{name:"SettingsDataset",blockType:1,consumerHostFlags:8},{name:"SettingsDatasetFeaturedQuestions",blockType:1,consumerHostFlags:8},{name:"SettingsDatasets",blockType:1,consumerHostFlags:8},{name:"SettingsEsri",blockType:1,consumerHostFlags:8},{name:"SettingsGeneral",blockType:1,consumerHostFlags:8},{name:"SettingsLanguage",blockType:1,consumerHostFlags:8},{name:"SettingsPlugins",blockType:1,consumerHostFlags:8},{name:"SettingsPreviewFeatures",blockType:2,consumerHostFlags:8},{name:"SettingsPrivacy",blockType:1,consumerHostFlags:8},{name:"SettingsPublishedContent",blockType:1,consumerHostFlags:8},{name:"SettingsSubscriptions",blockType:2,consumerHostFlags:8},{name:"SettingsViewer",blockType:1,consumerHostFlags:8},{name:"SettingsWorkbookBlade",blockType:2,consumerHostFlags:8},{name:"SettingsWorkbooks",blockType:1,consumerHostFlags:8},{name:"SharedWithMeContainer",blockType:2,consumerHostFlags:8},{name:"SharePointUrlInput",blockType:1,consumerHostFlags:8},{name:"SharePointUrlModal",blockType:1,consumerHostFlags:8},{name:"ShareView",blockType:1,consumerHostFlags:8},{name:"SharedByColumn",blockType:2,consumerHostFlags:8},{name:"SsrsTile",blockType:1,consumerHostFlags:232},{name:"StreamingDataSample",blockType:2,consumerHostFlags:8},{name:"StreamingDatasetEditor",blockType:2,consumerHostFlags:8},{name:"StreamingDatasetGallery",blockType:2,consumerHostFlags:8},{name:"StreamingDatasetPushInfo",blockType:2,consumerHostFlags:8},{name:"SubscriptionPane",blockType:2,consumerHostFlags:8},{name:"TaskPaneSlider",blockType:1,consumerHostFlags:72},{name:"Then",blockType:4,consumerHostFlags:8},{name:"Tile",blockType:1,consumerHostFlags:232},{name:"TileEditor",dependencies:["$compile"],blockType:1,consumerHostFlags:8},{name:"TileGallery",blockType:1,consumerHostFlags:8},{name:"UsageBar",blockType:1,consumerHostFlags:8},{name:"UsageBarMenuItem",dependencies:["quota","modelService","workbookService","groupService","featureSwitchService"],blockType:1,consumerHostFlags:8},{name:"UserGroupHeader",blockType:1,consumerHostFlags:8},{name:"UserInfoContainer",blockType:1,consumerHostFlags:232},{name:"UserNotifications",blockType:2,consumerHostFlags:8},{name:"ViewContentPack",blockType:1,consumerHostFlags:8},{name:"ViewTenantContentPackView",blockType:1,consumerHostFlags:8},{name:"WarningBar",blockType:1,consumerHostFlags:232},{name:"WaterMarkMessage",blockType:1,consumerHostFlags:72},{name:"WorkbookAppBar",blockType:1,consumerHostFlags:72},{name:"WorkbookContainer",blockType:1,consumerHostFlags:72},{name:"WorkbookContainer",blockType:1,consumerHostFlags:72},{name:"WorkbookDiscoverabilityToast",blockType:1,consumerHostFlags:72},{name:"WorkbookNavigationPaneListItem",blockType:1,consumerHostFlags:8},{name:"WorkbookNavigationPaneListItem",blockType:1,consumerHostFlags:8},{name:"WorkbookTile",dependencies:["networkAvailability","localizationService"],blockType:1,consumerHostFlags:232},{name:"WorkspacesContainer",dependencies:[],blockType:2,consumerHostFlags:8}];e.common.registerBuildingBlocksForHost(t,i,{componentsTarget:"powerbi.components",componentsMap:e.components,directivesTarget:"powerbi.directives",directivesMap:e.directives,filtersTarget:"powerbi.filters",filtersMap:e.filters})}e.registerController=t,e.getService=i,e.registerBuildingBlocksForHost=o})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(e){e[e.APIPush=1]="APIPush",e[e.PubNub=2]="PubNub",e[e.Link=3]="Link"})(i=t.StreamingDatasetOptionType||(t.StreamingDatasetOptionType={}));var o;!(function(t){function o(e){return[{text:e.get("DatasetContextMenu_Rename"),action:4},{text:e.get("DatasetContextMenu_Personalize"),action:9},{text:e.get("DatasetContextMenu_Delete"),action:7},{text:e.get("DatasetContextMenu_ManageRefresh"),action:6},{text:e.get("DatasetContextMenu_RefreshNow"),action:5},{text:e.get("DashboardContextMenu_RefreshInfo"),action:13},{text:e.get("DatasetContextMenu_AnalyzeInExcel"),action:8},{text:e.get("DashboardContextMenu_CreateReport"),action:1,iconClass:"pbi-glyph-create-report"},{text:e.get("DatasetContextMenu_GetInsights"),action:2},{text:e.get("DatasetContextMenu_GettingInsights"),action:11},{text:e.get("DatasetContextMenu_ViewInsights"),action:12},{text:e.get("DatasetContextMenu_GranularSecurity"),action:3},{text:e.get("DatasetContextMenu_DatasetSettings"),action:10},{text:e.get("StreamingDatasetModel_APIInfo"),action:14,iconClass:"pbi-glyph-info"},{text:e.get("StreamingDatasetModel_Edit"),action:15,iconClass:"pbi-glyph-edit"},{text:e.get("StreamingDatasetModel_Delete"),action:16,iconClass:"pbi-glyph-delete"},{text:e.get("DatasetContextMenu_DownloadDataset"),action:17}]}function r(e,i){var o=_.filter(t.rowMenuActions(i),(function(t){return _.any(e,(function(e){return e===t.action}))}));return o}function a(t,o){var r=[{displayName:o.get("StreamingDataset_API"),type:i.APIPush,cssClass:"real-time-push-api"},{displayName:e.constants.streamingDatasetModelPubNub,type:i.PubNub,cssClass:"real-time-pubnub"}];return t.featureSwitches.realTimeASAEnabled&&r.push({displayName:o.get("StreamingDataset_ASA"),type:i.Link,cssClass:"real-time-asa",link:"https://go.microsoft.com/fwlink/?LinkID=808648"}),r}t.rowMenuActions=o,t.customizeRowMenuActions=r,t.getStreamingDatasetOptions=a})(o=t.DatasetsMenuFactory||(t.DatasetsMenuFactory={}))})(i=t.factory||(t.factory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(t){var i;!(function(t){function i(t,i,o,r){return r=r||0,{enabled:!0,isExpanded:!0,emailNotificationEnabled:!0,frequency:0,isNew:!0,measureName:i,operator:0,tileName:t,title:o,thresholdValue:r.toString(),alertFailureState:e.AlertFailureState.None}}t.createEmptyAlert=i})(i=t.AlertsModelFactory||(t.AlertsModelFactory={}))})(t=e.factory||(e.factory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.DashboardFormat=0]="DashboardFormat",e[e.ReportFormat=1]="ReportFormat"})(t=e.TileDialogPreviewFormats||(e.TileDialogPreviewFormats={}));var i;!(function(e){e[e.User=0]="User",e[e.Group=1]="Group"})(i=e.DashboardAccessInfoKind||(e.DashboardAccessInfoKind={}));var o;!(function(e){e[e.Report=0]="Report"})(o=e.ExternalConnectionContainerType||(e.ExternalConnectionContainerType={}));var r;!(function(e){e[e.Model=0]="Model"})(r=e.ExternalConnectionType||(e.ExternalConnectionType={}));var a;!(function(e){e[e.Dashboard=1]="Dashboard",e[e.Report=2]="Report",e[e.Workbook=3]="Workbook"})(a=e.LandingView||(e.LandingView={}));var n;!(function(e){e[e.DashboardViewer=0]="DashboardViewer",e[e.QnaVisualization=1]="QnaVisualization"})(n=e.DashboardContainerViewMode||(e.DashboardContainerViewMode={}));var s;!(function(e){e[e.Unknown=0]="Unknown",e[e.OneTimeOnly=1]="OneTimeOnly",e[e.Daily=2]="Daily",e[e.Weekly=4]="Weekly",e[e.Monthly=8]="Monthly",e[e.MonthlyDays=16]="MonthlyDays",e[e.AfterDataRefresh=32]="AfterDataRefresh"})(s=e.FrequencyType||(e.FrequencyType={}));var c;!(function(e){e[e.Unused=0]="Unused",e[e.First=1]="First",e[e.Second=2]="Second",e[e.Third=4]="Third",e[e.Fourth=8]="Fourth",e[e.Last=16]="Last"})(c=e.FrequencyRelativeInterval||(e.FrequencyRelativeInterval={}));var l;!(function(e){e[e.Unknown=0]="Unknown",e[e.AtSpecifiedTime=1]="AtSpecifiedTime",e[e.Seconds=2]="Seconds",e[e.Minutes=4]="Minutes",e[e.Hours=8]="Hours"})(l=e.FrequencySubdayType||(e.FrequencySubdayType={}));var d;!(function(e){e[e.Popup=0]="Popup",e[e.NotificationPane=1]="NotificationPane",e[e.NotificationBar=2]="NotificationBar"})(d=e.DynamicMessageNotificationType||(e.DynamicMessageNotificationType={}));var p;!(function(e){e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High"})(p=e.DynamicMessageNotificationLevel||(e.DynamicMessageNotificationLevel={}));var u;!(function(e){e[e.OpenLink=0]="OpenLink",e[e.EnablePreviewFeatures=1]="EnablePreviewFeatures"})(u=e.DynamicMessageActionType||(e.DynamicMessageActionType={}))})(t=e.contracts||(e.contracts={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t;!(function(e){function t(){return[{id:0,iconClass:"pbi-glyph-barchart"},{id:1,iconClass:"pbi-glyph-paintbrush"}]}function i(e){return[{type:0,text:e.get("Realtime_VisualizationDesign")},{type:1,text:e.get("TileEditorPane_TileDetailsTabHeader")}]}function o(e){var t=e.localizationService;return[{iconClass:"pbi-glyph-securityalert",show:e.showWebContent,itemClass:"webContentIcon",tooltip:function(){return t.get("WebContentWarning_Widget")},action:2,hasBadge:!1},{iconClass:"pbi-glyph-warning",show:e.showWarning,itemClass:"warningIcon",tooltip:e.warningToolTipSetter,action:1,hasBadge:!1},{iconClass:"pbi-glyph-bell",show:e.showNotifications,itemClass:"notifications",tooltip:function(){return t.get("Alerts_NotificationTooltip")},action:0,badgeValueSetter:e.badgeTextSetter,hasBadge:!0},{iconClass:"pbi-glyph-realtime",show:e.showRealTime,itemClass:"",tooltip:function(){return t.get("Realtime_IconHoverText")},hasBadge:!1}]}e.realTimeConfigTabs=t,e.getRealTimeTileEditHeaderTabs=i,e.getDashboardTileIcons=o})(t=e.TileOptionsFactory||(e.TileOptionsFactory={}))})(t=e.factory||(e.factory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.AllContent=0]="AllContent",e[e.MyContent=1]="MyContent",e[e.SharedWithMe=2]="SharedWithMe"})(t=e.OwnershipFilterMenuFilter||(e.OwnershipFilterMenuFilter={}));var i=(function(){function e(){}return e})();e.NavigationPaneModel=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.Then=function(){return function(e,t){if("function"==typeof t){var i=_.drop(arguments,2);return i.unshift(e),t.apply(null,i)}return e}}})(t=e.filters||(e.filters={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/providerTile.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.ProviderTileController)}return t})();t.ProviderTile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i){return new r(e,t,i)}var o;!(function(e){e[e.None=0]="None",e[e.FitToContent=1]="FitToContent",e[e.FitToWidth=2]="FitToWidth"})(o=t.FullScreenFitStyle||(t.FullScreenFitStyle={})),t.createFullScreenService=i;var r=(function(){function t(t,i,r){var a=this;this._rootScope=t,this._navigation=i,this._document=r.get(0),this._document.addEventListener("fullscreenchange",(function(e){a.updateFullScreenFromBrowser()})),this._document.addEventListener("webkitfullscreenchange",(function(e){a.updateFullScreenFromBrowser()})),this._document.addEventListener("MSFullscreenChange",(function(e){a.updateFullScreenFromBrowser()})),this._document.addEventListener("mozfullscreenchange",(function(e){a.updateFullScreenFromBrowser()})),this._fullScreenModeEnabled=!1,this._fullScreenModeSupported=this.fullScreenSupportedViews()||this._navigation.inReportEmbedView(),this.fitStyle=o.None,this._rootScope.$on(e.common.constants.navigation.stateChangeStart,(function(t,i,o,r,n){a._fullScreenModeEnabled&&i&&!a.forceFullScreen()&&i.name!==e.constants.navigation.states.dashboard&&i.name!==e.constants.navigation.states.dashboardReportPage&&i.name!==e.constants.navigation.states.sharedDashboardReportPage&&i.name!==e.common.constants.navigation.states.reportPage&&i.name!==e.common.constants.navigation.states.report&&i.name!==e.common.constants.navigation.states.dataset&&i.name!==e.constants.navigation.states.inFocusMode&&i.name!==e.constants.navigation.states.inFocusInsights&&t.preventDefault()})),this._rootScope.$on(e.common.constants.navigation.stateChangeSuccess,(function(){a._fullScreenModeSupported=a.fullScreenSupportedViews()})),this.forceFullScreen()&&(this.fullScreenMode=!0)}return t.prototype.fullScreenPreviousPage=function(){this._rootScope.$emit(e.explore.constants.explorationPreviousPageEvent)},t.prototype.fullScreenNextPage=function(){this._rootScope.$emit(e.explore.constants.explorationNextPageEvent)},t.prototype.fullScreenSupportedViews=function(){return this._navigation.inDashboardDetailView()||this._navigation.inReportDetailView()||this._navigation.inDatasetDetailView()||this._navigation.inInFocusView()||this._navigation.inInFocusInsightsView()},t.prototype.forceFullScreen=function(){return null!=this._navigation.locationService&&null!=this._navigation.locationService.search().chromeless},t.prototype.updateFullScreenFromBrowser=function(){var e=this,t=this._document,i=null!=(t.fullScreenElement||t.msFullscreenElement||t.mozFullScreenElement||t.webkitFullscreenElement);i!==this.fullScreenMode&&this._rootScope.$applyAsync((function(){e.fullScreenMode=i}))},Object.defineProperty(t.prototype,"fullScreenModeSupported",{get:function(){return this._fullScreenModeSupported},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullScreenMode",{get:function(){return this._fullScreenModeEnabled},set:function(e){if(this._fullScreenModeSupported||this.forceFullScreen()){var i=$("html"),r=$("body");if(i.length<=0||r.length<=0)return;if(e){r.addClass(t.fullScreenCSSClass);var a=i.get(0);if(a){var n=a.requestFullscreen||a.msRequestFullscreen||a.webkitRequestFullscreen||a.mozRequestFullScreen;n&&n.call(a)}}else{r.removeClass(t.fullScreenCSSClass);var s=$(".enterFullScreenBtn");s.length>0&&s.blur(),this.fitStyle=o.None;var c=this._document,l=c.exitFullscreen||c.msExitFullscreen||c.webkitExitFullscreen||c.mozCancelFullScreen;l&&l.call(c)}this._fullScreenModeEnabled=e}},enumerable:!0,configurable:!0}),t})();r.fullScreenCSSClass="fullScreen"})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=e.dataServices.contracts.TileType,r=2e4,a=(function(){function t(t,o,r,a){var n=this;this.telemetryService=t,this.userActivityContextService=o,this.timeoutService=r,this.scope=a,this.hasResolved=!1,this.tileIdsToWait=[],this.tileIdsAlreadyLoaded=[],this.timeOutMap={},this.unsubcribeTileRepeatFinishedEvent=a.$on(e.constants.dashboardTileRepeatFinishedEvent,(function(){return n.onDashboardTileRepeatFinishedEvent()})),this.unsubscribeTileVisualLoadedEvent=a.$on(i.tileVisualLoadedEventName,(function(e,t){return n.onDashbardTileVisualLoadedEvent(e,t)}))}return t.prototype.recordOpenDashboardEvent=function(t,i,o){!t||this.openDashboardTelemetryEvent||this.hasResolved||(this.dashboardModel=t,this.openDashboardTelemetryEvent=this.telemetryService.startActivity(this.scope,e.telemetry.DashboardOpenDashboard,t.isSample,!1,t.hasOnPremiseModel,0,0,0,0,0,0,0,0,0,0,this.getDashboardOpenSource(),o,t.contract&&t.contract.originalDashboardObjectId,i,t.objectId),t.isLoaded&&_.isEmpty(t.tiles)&&this.resolveOpenDashboardTelemetry(t,!1))},t.prototype.forceResolve=function(){this.resolveOpenDashboardTelemetry(this.dashboardModel,!0)},t.prototype.getDashboardOpenSource=function(){var t=jsCommon.QueryStringUtil.getQueryStringValue("openDashboardSource");return"email"===t?e.telemetry.OpenDashboardSource.EmailSubscription:e.telemetry.OpenDashboardSource.Normal},t.prototype.onDashboardTileRepeatFinishedEvent=function(){var t=this,i=this.dashboardModel;if(this.openDashboardTelemetryEvent){for(var o=0,a=function(i){if(i.shouldBeIncludedInTelemetryMeasurement){o++;var a=i.id;if(!_.contains(n.tileIdsAlreadyLoaded,a)){n.tileIdsToWait.push(a),n.cancelVisualLoadTimeout(a);var s=i.composite&&i.composite.visual&&i.composite.visual.type;n.timeOutMap[a]=n.timeoutService((function(){t.telemetryService.logEvent(e.telemetry.DashboardLoadTileVisualTimedOut,s),t.removeTileIdFromWaitlist(a)}),r)}}},n=this,s=0,c=i.tiles;s<c.length;s++){var l=c[s];a(l)}this.loadDashboardTileTelemetryEvent=this.telemetryService.startChildEvent(this.openDashboardTelemetryEvent.event,e.telemetry.DashboardLoadDashboardTileVisual,o),this.tileRepeatFinishedEventRaised=!0,_.isEmpty(this.tileIdsToWait)&&this.resolveOpenDashboardTelemetry(this.dashboardModel,!1)}},t.prototype.onDashbardTileVisualLoadedEvent=function(e,t){e.stopPropagation(),this.removeTileIdFromWaitlist(t),this.cancelVisualLoadTimeout(t)},t.prototype.cancelVisualLoadTimeout=function(e){var t=this.timeOutMap[e];t&&(this.timeoutService.cancel(t),delete this.timeOutMap[e])},t.prototype.removeTileIdFromWaitlist=function(e){this.tileRepeatFinishedEventRaised?_.pull(this.tileIdsToWait,e):this.tileIdsAlreadyLoaded.push(e),this.tileRepeatFinishedEventRaised&&_.isEmpty(this.tileIdsToWait)&&this.resolveOpenDashboardTelemetry(this.dashboardModel,!1)},t.prototype.resolveOpenDashboardTelemetry=function(e,i){if(this.openDashboardTelemetryEvent){var o=t.countTileTypes(e);if(this.openDashboardTelemetryEvent.event){var r=this.openDashboardTelemetryEvent.event.info;r&&(r.hasResourcePackages=o.hasResourcePackages,r.compositeTilesCount=o.composite,r.iframeTilesCount=o.iframe,r.imageTilesCount=o.image,r.modelTilesCount=o.model,r.ssrsTilesCount=o.ssrs,r.workbookTilesCount=o.workbook,r.reportTilesCount=o.report,r.workbookTileNoImage=o.workbookNoImage,r.otherTileTypes=o.unknown,r.realTimeTilesCount=o.realTime,i&&(r.isCancelled=!0))}this.loadDashboardTileTelemetryEvent&&this.loadDashboardTileTelemetryEvent.resolve(),this.openDashboardTelemetryEvent.resolve(),this.openDashboardTelemetryEvent=null,this.loadDashboardTileTelemetryEvent=null,this.hasResolved=!0,this.unsubcribeTileRepeatFinishedEvent(),this.unsubscribeTileVisualLoadedEvent()}},t.countTileTypes=function(e){var i={composite:0,iframe:0,image:0,model:0,realTime:0,ssrs:0,workbook:0,workbookNoImage:0,report:0,unknown:0,hasResourcePackages:!1};if(_.isEmpty(e.tiles))return i;for(var o=0,r=e.tiles;o<r.length;o++){var a=r[o];t.incTileTypeCount(a,i),!i.hasResourcePackages&&a&&a.contract&&!_.isEmpty(a.contract.resourcePackageIds)&&(i.hasResourcePackages=!0)}return i},t.incTileTypeCount=function(e,t){switch(e.type){case o.composite:t.composite++;break;case o.iframe:t.iframe++;break;case o.image:t.image++;break;case o.realTime:t.realTime++;break;case o.model:t.model++;break;case o.ssrs:t.ssrs++;break;case o.workbook:e.workbook?e.workbook.hasImages()&&t.workbook++:t.workbookNoImage++;break;case o.report:t.report++;break;default:t.unknown++}},t})();t.DashboardTelemetryHelper=a})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=jsCommon.FreezeUtility,i=(function(){function e(e,t,i){void 0===t&&(t=!1),this.columnName=e,this.reverse=t,this.toAngularFilter=i,this.toAngularFilter=i||this.toAngularFilterDefault}return e.prototype.toAngularFilterDefault=function(){var e=_.camelCase(this.columnName);return this.reverse?"-"+e:"+"+e},e})();e.SortPredicate=i;var o;!(function(e){e.TitleAlphabeticalPredicate=new i("displayName"),e.TitleReverseAlphabeticalPredicate=new i("displayName",(!0)),e.OwnerAlphabeticalPredicate=new i("ownerFullname"),e.OwnerReverseAlphabeticalPredicate=new i("ownerFullname",(!0)),e.LastAccessDatePredicate=new i("lastAccess"),e.LastAccessReverseDatePredicate=new i("lastAccess",(!0)),e.SharedTimePredicate=new i("sharedTime"),e.SharedReverseTimePredicate=new i("sharedTime",(!0)),e.OwnerInfoAlphabeticalPredicate=new i("ownerInfo"),e.OwnerInfoReverseAlphabeticalPredicate=new i("ownerInfo",(!0)),(function(){t.deepFreeze(e.TitleAlphabeticalPredicate),t.deepFreeze(e.TitleReverseAlphabeticalPredicate),t.deepFreeze(e.OwnerAlphabeticalPredicate),t.deepFreeze(e.OwnerReverseAlphabeticalPredicate),t.deepFreeze(e.LastAccessDatePredicate),t.deepFreeze(e.LastAccessReverseDatePredicate),t.deepFreeze(e.SharedTimePredicate),t.deepFreeze(e.SharedReverseTimePredicate),t.deepFreeze(e.OwnerInfoAlphabeticalPredicate),t.deepFreeze(e.OwnerInfoReverseAlphabeticalPredicate)})()})(o=e.ArtifactSortPredicates||(e.ArtifactSortPredicates={}));var r;!(function(e){function i(e,t){switch(t){case 8:return a(e);case 16:return n(e);case 64:return s(e);case 128:return c(e);default:return r(e)}}function r(e){return g(e),d}function a(e){return m(e),p}function n(e){return f(e),u}function s(e){return y(e),v}function c(e){return b(e),h}function l(e,t){var i;switch(e){case o.TitleAlphabeticalPredicate:i=t.get("Sort_Title_Alpabetical_Asc");break;case o.TitleReverseAlphabeticalPredicate:i=t.get("Sort_Title_Alpabetical_Desc");break;case o.OwnerAlphabeticalPredicate:case o.OwnerInfoAlphabeticalPredicate:i=t.get("Sort_Owner_Alpabetical_Asc");break;case o.OwnerReverseAlphabeticalPredicate:case o.OwnerInfoReverseAlphabeticalPredicate:i=t.get("Sort_Owner_Alpabetical_Desc");break;case o.LastAccessDatePredicate:i=t.get("Sort_Last_Access_Date_Asc");break;case o.LastAccessReverseDatePredicate:i=t.get("Sort_Last_Access_Date_Desc");break;case o.SharedTimePredicate:i=t.get("Sort_Shared_Time_Asc");break;case o.SharedReverseTimePredicate:i=t.get("Sort_Shared_Time_Desc")}return{predicate:e,title:i}}var d,p,u,v,h,g=_.once((function(e){d=[l(o.TitleAlphabeticalPredicate,e),l(o.TitleReverseAlphabeticalPredicate,e),l(o.OwnerAlphabeticalPredicate,e),l(o.OwnerReverseAlphabeticalPredicate,e)],t.deepFreeze(d)})),m=_.once((function(e){p=[l(o.TitleAlphabeticalPredicate,e),l(o.TitleReverseAlphabeticalPredicate,e)],t.deepFreeze(p)})),f=_.once((function(e){u=[l(o.LastAccessReverseDatePredicate,e),l(o.TitleAlphabeticalPredicate,e),l(o.TitleReverseAlphabeticalPredicate,e)],t.deepFreeze(u)})),y=_.once((function(e){v=[l(o.SharedReverseTimePredicate,e),l(o.SharedTimePredicate,e),l(o.TitleAlphabeticalPredicate,e),l(o.TitleReverseAlphabeticalPredicate,e),l(o.OwnerAlphabeticalPredicate,e),l(o.OwnerReverseAlphabeticalPredicate,e)],t.deepFreeze(v)})),b=_.once((function(e){h=[l(o.TitleAlphabeticalPredicate,e),l(o.TitleReverseAlphabeticalPredicate,e),l(o.OwnerInfoAlphabeticalPredicate,e),l(o.OwnerInfoReverseAlphabeticalPredicate,e)],t.deepFreeze(h)}));e.createPredicates=i,e.createDefaultPredicates=r})(r=e.SelectTileSortItemsFactory||(e.SelectTileSortItemsFactory={}))})(t=e.factory||(e.factory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.tileModel=this.services.dashboardDataService.selectedDashboardTile.tileModel,this.openAlertsEditorEvent=this.services.telemetryService.logEvent(e.telemetry.DataAlertsOpenAlertsEditor),this.isUpdating=!1,this.isLoading=!0;var r=this.tileModel;this.services.alertHttpService.getAllAlerts(this.openAlertsEditorEvent,r.contract.id).then((function(t){var i=o.services.alertRuleService.getMeasureName(r),a=_.sortBy(t,(function(e){return e.createdDateTimeUtc})).reverse(),n=_.map(a,(function(e){return o.services.modelConverter.convertAlertsEditorPane(e,r,i)}));o.viewModel=new e.models.AlertsEditorModel(n,r,i,o.services.localizationService),o.expandAlertIfRequired(),o.isLoading=!1}))}return t.createOptions=function(){return{additionalServices:["dashboardService","alertRuleService","dashboardDataService","localizationService","alertHttpService","modelConverter","promiseFactory","navigation","errorService","telemetryService","taskPaneSliderService","navigationHelper"]}},t.prototype.cancel=function(){if(!this.isLoading&&this.hasChangesToSave()){var e=this.services.errorService.control();e.showPrompt(this.services.localizationService.get("Alerts_CancelDialogTitle"),this.services.localizationService.get("Alerts_CancelDialogMessage"),this.getCancelModalActionsArray(e))}else this.closePane()},t.prototype.hasChangesToSave=function(){var e=this.viewModel.alerts;if(e)for(var t=0;t<e.length;t++){var i=e[t];if(i&&(i.isNew||i.enabled!==i.contract.enabled||this.isAlertDirty(t)))return!0}return!1},t.prototype.getCancelModalActionsArray=function(e){var t=this;return[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_Save"),function(i,o){e.hideDialog(),t.saveChangesAndExit(),t.scope.$root.$digest()}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_DontSave"),function(){e.hideDialog(),t.closePane(),t.scope.$root.$digest()}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_Cancel"),function(t,i){e.hideDialog()})]},t.prototype.closePane=function(){var e=this.services;e.dashboardService.clearSelectedDashboardTile(),e.taskPaneSliderService.collapsePane(),e.navigationHelper.navigateToDashboard(e.dashboardService.getActiveDashboard())},t.prototype.saveChangesAndExit=function(){var t=this,i=this.services.telemetryService.startChildEvent(this.openAlertsEditorEvent,e.telemetry.DataAlertsSaveAlerts,0,0,0,0,0,0);this.isUpdating=!0;for(var o=this.viewModel.alerts,r=[],a=[],n=[],s=0;s<o.length;s++){var c=o[s];if(this.resetAlertFailureStates(c),c.isNew||this.isAlertDirty(s)){var l=parseFloat(c.thresholdValue),d=this.services.alertRuleService.createAlertRule(this.tileModel,c.operator,l);if(!d)return;var p=this.services.modelConverter.convertAlertModelToContract(c,this.tileModel,d);c.contract=p,c.isNew?r.unshift(c):a.push(c)}else c.enabled!==c.contract.enabled&&n.push(c)}i.event.info.createCount=r.length,i.event.info.editCount=a.length,i.event.info.toggleCount=n.length,this.services.promiseFactory.all([this.createAlerts(r,i.event),this.editAlerts(a,i.event),this.toggleAlerts(n,i.event)]).then((function(e){t.isUpdating=!1,i.resolve(),_.every(e,(function(e){return e}))&&t.closePane()}))},t.prototype.addNewAlert=function(){for(var e=0,t=this.viewModel.alerts;e<t.length;e++){var i=t[e];i.isExpanded=!1}this.viewModel.addNewEmptyAlert(this.services.alertRuleService.getThresholdValue(this.tileModel))},t.prototype.removeAlert=function(e,t){e&&e.stopPropagation&&e.stopPropagation();var i=this.viewModel.alerts[t];if(i){this.resetAlertFailureStates(i);var o=this.services.errorService.control();o.showPrompt(this.services.localizationService.get("Alerts_DeleteDialogTitle"),this.services.localizationService.get("Alerts_DeleteDialogMessage"),this.getDeleteModalActionsArray(o,i,t))}},t.prototype.getDeleteModalActionsArray=function(t,i,o){var r=this;return[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(a,n){t.hideDialog(),i.contract&&!i.isNew?(r.services.telemetryService.logChildEvent(r.openAlertsEditorEvent,e.telemetry.DataAlertsDeleteAlertAccept),r.services.alertHttpService.deleteAlert(i.contract.id,r.openAlertsEditorEvent).then((function(t){return t?void r.viewModel.alerts.splice(o,1):void(i.alertFailureState=e.models.AlertFailureState.Delete)}))):(r.viewModel.alerts.splice(o,1),r.scope.$digest())}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(i,o){r.services.telemetryService.logChildEvent(r.openAlertsEditorEvent,e.telemetry.DataAlertsDeleteAlertCancel),t.hideDialog()})]},t.prototype.moreOptionsMenuSelected=function(e){var t=e.action;if(null!=t)switch(t){case 0:this.collapseAllAlerts()}},t.prototype.isAlertDirty=function(e){var t=this.alertForm;if(t)return t["alertForm"+e].$dirty},t.prototype.isValidTitle=function(t){var i=t.title?t.title.length:0;return i>0&&i<=e.constants.alertTitleMaxLength},t.prototype.isValidThreshold=function(e){return jQuery.isNumeric(e.thresholdValue)},t.prototype.createAlerts=function(t,i){for(var o=this,r=this.services.promiseFactory.defer(),a=[],n=0,s=t;n<s.length;n++){var c=s[n];a.push(this.services.alertHttpService.createAlert(c.contract,this.openAlertsEditorEvent))}return this.updateAlerts(t,a,r,(function(t,r){for(var a=0,n=0;n<r.length;n++)r[n]!==-1?(o.resetAlertFailureStates(t[n]),t[n].contract.id=r[n],t[n].isNew=!1,i.info.createFailCount=a):(t[n].alertFailureState=e.models.AlertFailureState.Create,a++);return 0===a})),r.promise},t.prototype.editAlerts=function(e,t){for(var i=this,o=this.services.promiseFactory.defer(),r=[],a=0,n=e;a<n.length;a++){var s=n[a];r.push(this.services.alertHttpService.updateAlert(s.contract,this.openAlertsEditorEvent))}return this.updateAlerts(e,r,o,(function(e,o){var r=i.getFailureCount(e,o);return t.info.editFailCount=r,0===r})),o.promise},t.prototype.toggleAlerts=function(e,t){for(var i=this,o=this.services.promiseFactory.defer(),r=[],a=0,n=e;a<n.length;a++){var s=n[a];r.push(this.services.alertHttpService.toggleAlert(s.contract.id,s.enabled,this.openAlertsEditorEvent))}return this.updateAlerts(e,r,o,(function(e,o){var r=i.getFailureCount(e,o);return t.info.toggleFailCount=r,0===r})),o.promise},t.prototype.updateAlerts=function(e,t,i,o){i&&(_.isEmpty(t)?i.resolve(!0):this.services.promiseFactory.all(t).then((function(t){if(o){var r=o(e,t);i.resolve(r)}})))},t.prototype.getFailureCount=function(t,i){for(var o=0,r=0;r<i.length;r++)i[r]?this.resetAlertFailureStates(t[r]):(t[r].alertFailureState=e.models.AlertFailureState.Update,o++);return o},t.prototype.collapseAllAlerts=function(){for(var e=0,t=this.viewModel.alerts;e<t.length;e++){var i=t[e];i.isExpanded=!1}},t.prototype.expandAlertIfRequired=function(){var e=this.services.navigation.currentAlertId;if(e){var t=_.find(this.viewModel.alerts,(function(t){return t.contract&&t.contract.id===e}));t&&(t.isExpanded=!0)}},t.prototype.resetAlertFailureStates=function(t){t.alertFailureState=e.models.AlertFailureState.None},t})();t.AlertsEditorController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.AlertsEditor={controller:e.common.createController(e.controllers.AlertsEditorController),templateUrl:"components/alertsEditor/alertsEditor.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.helpers.ContentTileHelper,o=(function(){function t(e,t){this.services=t}return t.createOptions=function(){return{additionalServices:["contentList","modelService","groupService"]}},t.prototype.canOpenTile=function(t){
return t.contentTileType!==e.common.contracts.ContentTileType.AppDataset},t.prototype.openContentTile=function(e){this.canOpenTile(e)&&i.openContentTile(e,this.services.groupService,this.services.contentList,this.viewModel.appGUID,this.viewModel.packageId)},t.prototype.toggle=function(){this.viewModel.expanded=!this.viewModel.expanded},t.prototype.isNew=function(e){return i.isNew(e,this.services.modelService)},t.prototype.canShowOptionsMenu=function(e){return this.services.contentList.canShowTileOptions(e)},t})();t.AppArtifactsListController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.AppArtifactsList={templateUrl:"components/appArtifactsList/appArtifactsList.html",bindings:{viewModel:"<"},controller:e.common.createController(e.controllers.AppArtifactsListController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.AppUtils,o=(function(){function e(e,t){this.services=t,this.appIndexLabel=t.localizationService.get("AppHeader_Index_Title")}return e.createOptions=function(){return{additionalServices:["localizationService","navigation"]}},e.prototype.$onInit=function(){var e=this.viewModel;this.reports=e.reportIds,this.dashboards=e.dashboardIds,this.workbooks=e.workbookIds,this.datasets=e.modelIds,this.enableNavigation=!!e.contentTileType},e.prototype.navigateToApp=function(){if(this.enableNavigation){var e=this.viewModel,t=i.isOrgApp(e.providerContract)?void 0:e.packageId;this.services.navigation.navigateToApp(e.providerContract.providerKey,t)}},e.prototype.getAppTitle=function(){var e=this.viewModel;if(e&&e.displayName)return e.displayName},e.prototype.getHeaderFontColor=function(){var e=this.viewModel;return i.getAppHeaderFontColor(e.iconBackgroundColor)},e.prototype.hasAppLogoImage=function(){return i.hasAppLogoImage(this.viewModel)},e})();t.AppChannelHeaderController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.AppChannelHeader={templateUrl:"components/appChannelHeader/appChannelHeader.html",bindings:{viewModel:"<"},controller:e.common.createController(e.controllers.AppChannelHeaderController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.AppUtils,o="pbi-glyph-gauge",r="pbi-glyph-barchart",a="pbi-glyph-excel",n="pbi-glyph-database",s=(function(){function t(e,t){this.services=t,this.searchText=""}return t.createOptions=function(){return{additionalServices:["appService","dataClassificationService","modelConverter","navigation","packageService","promiseFactory","mostRecentlyUsedService"]}},t.prototype.$onInit=function(){var e=this,t=this.services.appService,i=this.services.packageService;this.services.promiseFactory.all([i.ensurePackagesInitialization(),t.ensureAppsInitialization()]).then((function(o){_.isEqual(o,[i,t])&&e.initHelper()}))},t.prototype.initHelper=function(){var t=this,o=this.services.appService,r=this.services.navigation.currentAppGUID,a=this.services.navigation.currentAppInstanceId;a||(a=i.getPackageIDByOrgAppGUID(o,this.services.packageService,r)),this.installedApp=this.services.appService.getAppInstance(a),this.services.dataClassificationService.isEnabledAsync().then((function(e){return t.loadArtifactsLists(e)})),this.services.mostRecentlyUsedService.updateMRU(e.models.MRUArtifactType.AppInstance,this.installedApp.objectId,this.installedApp.displayName,this.installedApp.getPermissions(),void 0,void 0,this.installedApp.packageId)},t.prototype.loadArtifactsLists=function(e){var t=this.installedApp,i=[];i.push(this.createDashboardsArtifactList(t,e)),i.push(this.createReportsArtifactList(t)),i.push(this.createWorkbooksArtifactList(t)),i.push(this.createDatasetArtifactList(t)),this.artifactLists=i},t.prototype.inAppArtifactsListView=function(){return this.services.navigation.inAppDetailView()},t.prototype.isEmptyList=function(e){return 0===e.artifacts.length},t.prototype.updateExpandedState=function(){this.artifactLists&&(this.artifactLists[0].expanded=this.artifactLists[1].expanded=this.artifactLists[2].expanded=!0,this.artifactLists[3].expanded=!1)},t.prototype.createDashboardsArtifactList=function(e,t){return{title:"App_DashboardList_Title",className:o,expanded:!0,isDataClassificationEnabled:t,artifacts:e.dashboards,appGUID:e.providerContract.providerKey,packageId:e.packageId}},t.prototype.createReportsArtifactList=function(e){return{title:"App_ReportList_Title",className:r,expanded:!0,isDataClassificationEnabled:!1,artifacts:e.reports,appGUID:e.providerContract.providerKey,packageId:e.packageId}},t.prototype.createWorkbooksArtifactList=function(e){return{title:"App_WorkbookList_Title",className:a,expanded:!0,isDataClassificationEnabled:!1,artifacts:e.workbooks,appGUID:e.providerContract.providerKey,packageId:e.packageId}},t.prototype.createDatasetArtifactList=function(e){var t=this,i=_.map(e.models,(function(e){return t.services.modelConverter.convertAppDataset(e.contract)}));return{title:"App_DatasetList_Title",className:n,expanded:!1,isDataClassificationEnabled:!1,artifacts:i,appGUID:e.providerContract.providerKey,packageId:e.packageId}},t})();t.AppContainerController=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.AppContainer={templateUrl:"components/appContainer/appContainer.html",controller:e.common.createController(e.controllers.AppContainerController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.AppUtils,o=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["clusterUriRetriever"]}},e.prototype.hasAppLogoImage=function(){return i.hasAppLogoImage(this.viewModel)},e.prototype.getAppLogoImageUrlStyle=function(){return i.getAppLogoImageUrlStyle(this.viewModel,this.services.clusterUriRetriever)},e})();t.AppLogoController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.AppLogo={templateUrl:"components/appLogo/appLogo.html",bindings:{viewModel:"<",size:"@"},controller:e.common.createController(e.controllers.AppLogoController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.AppPlaceholder={templateUrl:"components/appPlaceholder/appPlaceholder.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentProviderClientCategory,o=e.common.contracts.ContentTileType,r=e.common.contracts.Permissions,a=(function(){function a(e,t){this.services=t,this.searchText=""}return a.createOptions=function(){return{additionalServices:["$window","appService","promiseFactory","groupService","localizationService","navigation","telemetryService","userInfo","featureSwitchService"]}},a.prototype.$onInit=function(){var e=this;this.getAppTile=this.getPlaceHolderTile(),this.providers=[],this.initializeWatermark(),this.services.promiseFactory.all([this.services.appService.ensureAppsInitialization(),this.services.groupService.groupSwitchPromise()]).then((function(){return e.loadApplicationInstances()})),this.insufficientLicenseBarConfig={content:this.services.localizationService.get("UpgradeAccount_AppTopBarMessage")},this.listener={onInstanceInstalled:function(){return e.loadApplicationInstances()},onInstanceUninstalled:function(){return e.loadApplicationInstances()},onInstanceUpdated:function(){return e.loadApplicationInstances()},onInstancesReset:function(){return e.loadApplicationInstances()}},this.services.appService.subscribeToInstanceEvents(this.listener)},a.prototype.$onDestroy=function(){this.services.appService.unsubscribeToInstanceEvents(this.listener)},a.prototype.onSearchTextChange=function(){this.ensureSearchTelemetry(),this.filterProviders()},a.prototype.resolveSearchTelemetry=function(){this.searchTelemetry&&(this.searchTelemetry.resolve(),this.searchTelemetry=null)},a.prototype.hasSufficientLicense=function(){return this.services.userInfo.isPremiumUser||!this.services.featureSwitchService.featureSwitches.pseudoLocEnabled},a.prototype.loadApplicationInstances=function(){this.providers=this.services.appService.appInstances,this.filterProviders(),this.isLoaded=!0},a.prototype.filterProviders=function(){var e=this,t=this.searchText.toLocaleLowerCase();this.filteredProviders=_(this.providers).filter((function(i){return e.containsSubstring(i.displayName,t)})).value(),this.updateWatermark()},a.prototype.updateWatermark=function(){this.showWatermarkConfig=_.isEmpty(this.filteredProviders),this.watermarkConfig=this.searchText?this.emptySearchWatermarkConfig:this.emptyAppsWatermarkConfig},a.prototype.containsSubstring=function(e,t){return!!e&&_.contains(e.toLocaleLowerCase(),t)},a.prototype.ensureSearchTelemetry=function(){this.searchTelemetry||_.isEmpty(this.searchText)||(this.searchTelemetry=this.services.telemetryService.startEvent(e.telemetry.ContentListSearch))},a.prototype.initializeWatermark=function(){var t=this;this.emptyAppsWatermarkConfig={canEdit:!0,mode:!0,imgClass:"empty-apps-img",titleNonShared:this.services.localizationService.get("AppModel_NoAppsWarningTitle"),contentNonShared:this.services.localizationService.get("AppModel_NoAppsWarningContent"),linkText:this.services.localizationService.get("AppModel_NoAppsWarningLinkText"),linkAction:function(){return t.services.$window.open(e.constants.pbiAppsLink,"_blank")},btnLabelKey:"Get_App_Label",btnClick:function(){return t.getApp()}},this.emptySearchWatermarkConfig={canEdit:!0,mode:!0,imgClass:"empty-search-img",linkDescription:this.services.localizationService.get("ContentList_EmptySearchResults_SearchRedirectDescription"),linkText:this.services.localizationService.get("AppModel_SearchInAppSource"),linkAction:function(){return t.getApp()}}},a.prototype.getApp=function(){e.helpers.ContentProviderStoreHelper.navigateToCategoryAndProviderHelper(i.Organizational,t.contentProviderStore.contentProviderConstants.getAppsInteraction,0,this.services.telemetryService,this.services.navigation,this.services.rootScope,!0)},a.prototype.getPlaceHolderTile=function(){return{contentTileType:o.AppPlaceHolder,displayName:this.services.localizationService.get("Get_App_Description"),getPermissions:function(){return r.None}}},a})();t.AppsContainerController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.AppsContainer={templateUrl:"components/appsContainer/appsContainer.html",controller:e.common.createController(e.controllers.AppsContainerController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.$scope=e,this.services=t,this.breadcrumbs=[],this.breadcrumbFilter=function(e){return!_.isEmpty(_.trim(e.label))&&null!=e.tooltipConfig&&null!=e.tooltipTemplateConfig},this.setBreadcrumbs=function(){i.breadcrumbs=i.services.breadcrumbFactory.createCurrentBreadcrumbs()||[]},this.setReportBreadreadcrumb=function(e,t){i.services.navigation.inReportView()&&t.guid===i.services.navigation.currentReportGUID&&(i.breadcrumbs=i.services.breadcrumbFactory.createCurrentBreadcrumbs({reportId:t.id,reportGUID:t.guid,reportName:t.displayName,subsituteReportForDataset:!0})||[])}}return t.createOptions=function(){return{additionalServices:["breadcrumbFactory","telemetryService","navigation"]}},t.prototype.$onInit=function(){this.setBreadcrumbs(),this.unregisterStateChange=this.$scope.$on(e.common.constants.navigation.stateChangeSuccess,this.setBreadcrumbs),this.unregisterGroupSwitch=this.services.rootScope.$on(e.constants.groupSwitchedEventName,this.setBreadcrumbs),this.unreigsterReportChange=this.services.rootScope.$on(e.common.constants.currentActiveReportInfoChangedEventName,this.setReportBreadreadcrumb)},t.prototype.$onDestroy=function(){this.unregisterGroupSwitch(),this.unregisterStateChange(),this.unreigsterReportChange()},t.prototype.getTemplate=function(e,t){return t||_.isEmpty(_.trim(e.uiSref))?"components/breadcrumbs/breadcrumbLabel.html":"components/breadcrumbs/breadcrumbLink.html"},t.prototype.logTelemetry=function(t){var i=this.services.navigation.stateService.current.name;this.services.telemetryService.logEvent(e.telemetry.NavigationClickBreadcrumb,i,t)},t})();t.BreadcrumbsController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.Breadcrumbs={templateUrl:"components/breadcrumbs/breadcrumbs.html",controller:e.common.createController(e.controllers.BreadcrumbsController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.ArtifactType,o=e.common.models.CollapsiblePaneExpandedWidth,r=e.models.factory.DatasetsMenuFactory,a=e.common.dialogs.FeatureNotSupportedDialogBuilder,n=e.common.contracts.Permissions,s=e.common.contracts.PublishOrRefreshStatus,c=e.common.contracts.RealTimeMode,l=e.common.constants.TaskPaneCollapsiblePaneMode,d=(function(){function d(e,t){this.deleteEnabled=!0,this.viewRelatedEnabled=!0,this.scope=e,this.services=t,this.menuSelected=!1,this.initialize()}return d.createOptions=function(){return{additionalServices:["analyzeInExcel","appService","contentPackService","dashboardService","errorService","featureSwitchService","groupService","historyDialogService","insightsService","localizationService","modalDialogService","modelService","navigation","ownership","packageService","realTimeModel","refreshService","quota","telemetryService","settingsMetadataService","overlayService","taskPaneSliderService","downloadReport","lazy"]}},d.prototype.initialize=function(){this.services.telemetryService.logEvent(e.telemetry.DashboardManageDatasetsLanding),this.modelDashboards={},this.streamingDatasetActions={},this.datasetMenuActions=this.createFileMenuActions(),this.isOrgApp=!1,this.rowId=_.uniqueId("datasetMenu")},d.prototype.onDestroy=function(){this.modalDialogPromise&&this.modalDialogPromise.pending&&this.modalDialogPromise.reject("ContentDatasetActionsController destroyed")},d.prototype.isPackagePublishInProgress=function(e){return e===s.PublishInProgress},d.prototype.canCreateReport=function(e){return!((e.getPermissions()&n.CopyOnWrite)===n.CopyOnWrite)},d.prototype.canDownloadPbix=function(t){return t.contentProviderId===e.common.constants.pbiDesktopContentProviderId&&_.isEmpty(t.contract.onPremModelConnectionString)&&(t.getPermissions()&n.All)===n.All&&this.services.featureSwitchService.featureSwitches.datasetDownloadPbix},d.prototype.canRefreshNow=function(e){return(!e.contract||null==e.contract.originalModelId)&&(e.getPermissions()&n.Write)===n.Write},d.prototype.canScheduleRefresh=function(e){return(!e.contract||null==e.contract.originalModelId)&&((e.getPermissions()&n.Write)===n.Write&&null!==e.contract.onPremModelConnectionString)},d.prototype.datasetMenuActionSelected=function(e){switch(e.action){case 8:this.analyzeInExcel(this.activeModel);break;case 7:case 16:this.delete(this.activeModelContract);break;case 2:case 11:case 12:this.getInsights(this.activeModelContract);break;case 3:this.granularSecurity(this.activeModelContract);break;case 4:this.rename(this.activeModelContract);break;case 10:this.navigateToSettingsPage(this.activeModelContract);break;case 9:this.personalizeDataset(this.activeModel);break;case 15:this.showStreamingDatasetEditorPane(this.activeModel.id);break;case 14:this.showStreamingDatasetPushInfoPane(this.activeModel.id);break;case 1:this.createReport(this.activeModel);break;case 17:this.downloadPbix(this.activeModel)}this.services.overlayService.hideAllDropdowns()},d.prototype.streamingDatasetActionSelected=function(e,t){this.setActiveModel(e),this.datasetMenuActionSelected(t)},d.prototype.getDashboardsForModel=function(e){return this.modelDashboards[e.id]||(this.modelDashboards[e.id]=_(this.services.dashboardService.dashboards).filter((function(t){return t.contract.modelIds&&t.contract.modelIds.indexOf(e.id)>=0})).map((function(e){return e.displayName})).value().join(this.services.localizationService.get("ListJoin_Separator"))),this.modelDashboards[e.id]},d.prototype.getStreamingDatasetActions=function(e){if((e.getPermissions()&n.All)===n.All){if(this.streamingDatasetActions[e.realTimeMode])return this.streamingDatasetActions[e.realTimeMode];var t=[];return t.push(15),this.addDeleteToMenuActions(t,!0),e.realTimeMode===c.PersistAndCache&&t.push(1),e.realTimeMode!==c.PubNubCacheOnly&&t.push(14),this.streamingDatasetActions[e.realTimeMode]=r.customizeRowMenuActions(t,this.services.localizationService)}return[]},d.prototype.getModelType=function(t){return t.realTimeMode===c.PubNubCacheOnly?e.constants.streamingDatasetModelPubNub:this.services.localizationService.get("StreamingDataset_API")},d.prototype.showStreamingDatasetGalleryPane=function(){this.services.realTimeModel.setSelected(null),this.services.featureSwitchService.featureSwitches.realTimePubNubEnabled?this.services.taskPaneSliderService.expandPane(l.StreamingDatasetGallery):this.services.taskPaneSliderService.expandPane(l.StreamingDatasetEditor)},d.prototype.showOptions=function(e){this.menuSelected=!0,this.setActiveModel(e),this.customizeMenuActions(e,this.activeModelPackage)},d.prototype.createReport=function(t){return null!=t.contract.packagePublishStatus&&t.contract.packagePublishStatus!==s.FinishedSuccessfully&&t.contract.packagePublishStatus!==s.RefreshInProgress&&t.contract.packagePublishStatus!==s.RefreshError?void(t.contract.packagePublishStatus===s.PublishError&&this.deleteModelOnPublishFailure(t.id)):(t.isNew=t.contract.isNew=!1,void(this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.OpenDataset)||((t.getPermissions()&e.common.models.ReportPermissions.CopyOnWrite)===e.common.models.ReportPermissions.CopyOnWrite?this.scope.$emit(e.constants.personalizeEventName,t.packageId):this.services.navigation.navigateToDatasetByDBName(t.dbName))))},d.prototype.downloadPbix=function(e){this.services.downloadReport.downloadModel({id:e.id.toString(),filename:e.displayName})},d.prototype.refreshNow=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickRefreshNow,t.contentProviderId),this.services.refreshService.tryRefreshNow(this.services.telemetryService,this.services.errorService,t,"datasets")},d.prototype.refreshSchedule=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickScheduleRefresh,t.contentProviderId),this.services.navigation.showSettingsSlider("datasets",t.dbName)},d.prototype.viewRelatedContent=function(){var e={id:this.viewModel.id.toString(),artifactType:i.Model,displayName:this.viewModel.displayName};this.services.taskPaneSliderService.expandPane(l.RelatedContent,o.Default,e)},d.prototype.setActiveModel=function(e){this.activeModel=e,this.activeModelContract=e.contract,this.activeModelPackage=this.services.packageService.findPackage(this.activeModelContract.packageId)},d.prototype.deleteModelOnPublishFailure=function(e){var t=this;this.deleteItemOnPublishFailure(this.services.localizationService.get("NavigationPane_ModelPublishErrorTitle"),this.services.localizationService.get("NavigationPane_ModelPublishErrorContent"),(function(){t.services.modelService.deleteModel(e)}))},d.prototype.deleteItemOnPublishFailure=function(e,t,i){var o=this,r=this.services.errorService.control(),a=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(e,t){r.hideDialog(),i()}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){r.hideDialog()})];r.showCustomDialog(e,$("<div/>").text(t),a,(function(e){e.parent().find('input[value="'+o.services.localizationService.get("ModalDialogButtonText_No")+'"]').focus()}),!0)},d.prototype.getInsights=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i;return __generator(this,(function(o){switch(o.label){case 0:return this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickInsights,t.contentProviderId),this.services.taskPaneSliderService.isPaneExpanded&&this.services.taskPaneSliderService.collapsePane(),[4,this.services.lazy("insightsBootstrap")];case 1:return i=o.sent(),i.start(t.dbName,t.vsName,t.packageId,e.insights.constants.insightsSourceNavigationPane),[2]}}))}))},d.prototype.showStreamingDatasetEditorPane=function(e){this.services.realTimeModel.setSelected(e),this.services.taskPaneSliderService.expandPane(l.StreamingDatasetEditor)},d.prototype.granularSecurity=function(e){6===e.contentProviderId?this.cloudRlsNotSupportedDialog():this.services.navigation.showRowLevelSecuritySlider(e.id)},d.prototype.cloudRlsNotSupportedDialog=function(){this.modalDialogPromise=new a(this.services.modalDialogService).show("ModalDialog_CloudRlsUnSupportedTypeTitle","ModalDialog_CloudRlsUnSupportedTypeMessage","https://go.microsoft.com/fwlink/?LinkID=733530")},d.prototype.rename=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickRename,t.contentProviderId),this.services.settingsMetadataService.setSettings(4,t.dbName),this.services.taskPaneSliderService.expandPane(l.SettingsBlade,o.Medium)},d.prototype.navigateToSettingsPage=function(e){this.services.navigation.showSettingsSlider("datasets",e.dbName)},d.prototype.delete=function(i){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickDelete,i.contentProviderId);var o=i.id,r=i.packageId,a=this.services.modelService.findModel(o,r);a&&a.isUsedByContentPack?this.services.contentPackService.showDialogOnModelDeleteInContentPack(o):this.deleteModel(o,r,this.isOrgApp?t.DeleteContentPackMessageType.Dataset:null)},d.prototype.deleteModel=function(e,i,o){var r,a,n=this,s=this.services.modelService.findModel(e,i),c=this.services.errorService.control(),l=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(t,o){c.hideDialog(),s&&s.realTimeMode?n.services.realTimeModel.deleteModel(e):n.services.modelService.deleteModel(e,i)}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){c.hideDialog()})];switch(o){case t.DeleteContentPackMessageType.Dataset:r=this.services.localizationService.get("Model_DeleteConfirmationTitle"),a=this.services.localizationService.get("Model_DeleteOrgAppContentPack");break;default:s&&s.realTimeMode?(r=this.services.localizationService.get("StreamingDatasetModel_DeleteConfirmationTitle"),a=this.services.localizationService.format("StreamingDatasetModel_DeleteConfirmationMessage",[s.displayName])):(r=this.services.localizationService.get("Model_DeleteConfirmationTitle"),a=this.services.localizationService.format("Model_DeleteConfirmationMessage",s?[s.displayName]:[]))}c.showCustomDialog(r,$("<div/>").text(a),l,(function(e){e.parent().find('input[value="'+n.services.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)},d.prototype.customizeMenuActions=function(e,t){var i=this.services.featureSwitchService,o=this.services.localizationService,a=[],s=e.contract;if((e.getPermissions()&n.CopyOnWrite)===n.CopyOnWrite){var c=this.services.appService.getAppInstance(e.packageId);null==c&&(a.push(9),this.addDeleteToMenuActions(a),this.isOrgApp=!0)}if(this.services.ownership.permissionsArePersonalized(e.getPermissions(),t)&&(this.addDeleteToMenuActions(a),this.isOrgApp=!1),(e.getPermissions()&n.All)===n.All&&(this.isOrgApp=!1,a.push(10),a.push(4),this.addDeleteToMenuActions(a),s.onPremModelConnectionString||s.directQueryMode&&a.push(10)),i){if(this.services.analyzeInExcel.isAnalyzeInExcelSupported(i,e.getPermissions())&&a.push(8),s.insightsSupported&&((e.getPermissions()&n.Read)===n.Read||this.services.ownership.permissionsArePersonalized(e.getPermissions(),t))){var l=this.findInsightAction(s);a.push(l)}if((e.getPermissions()&n.All)===n.All&&(6===s.contentProviderId||7===s.contentProviderId)&&!s.onPremModelConnectionString){var d=this.services.groupService.activeGroup;(d.isMyWorkspace||d.contract.isOwner||!d.contract.isReadOnly)&&a.push(3)}}this.canDownloadPbix(e)&&a.push(17),this.datasetMenuActions=r.customizeRowMenuActions(a,o)},d.prototype.findInsightAction=function(e){var t=this.services.insightsService.getInsightsStatus(e);switch(t){case 2:return 12;case 1:return 11;default:return 2}},d.prototype.analyzeInExcel=function(t){var i=this.services.modelService.findModel(t.id,t.packageId);i&&(this.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsAnalyzeInExcel,"Dataset Navigation Pane List",i.contentProviderId,i.contract.modelFeatures,i.dbName),this.services.analyzeInExcel.startAnalyzeInExcel(i))},d.prototype.personalizeDataset=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardClickPersonalize,t.contentProviderId),this.scope.$emit(e.constants.personalizeEventName,t.packageId)},d.prototype.createFileMenuActions=function(){var e=this.services.localizationService;return r.rowMenuActions(e)},d.prototype.showStreamingDatasetPushInfoPane=function(t){this.services.telemetryService.logEvent(e.telemetry.RealTimeStreamingDatasetPushInfoPaneOpened),this.services.realTimeModel.setSelected(t),this.services.taskPaneSliderService.expandPane(l.StreamingDatasetPushInfo)},d.prototype.addDeleteToMenuActions=function(e,t){void 0===t&&(t=!1),this.deleteEnabled&&(t?e.push(16):e.push(7))},d})();t.ContentDatasetActionsController=d})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentDatasetActions={templateUrl:"components/contentDatasetActions/contentDatasetActions.html",controller:e.common.createController(e.controllers.ContentDatasetActionsController),bindings:{deleteEnabled:"<?",viewModel:"=",viewRelatedEnabled:"<?",streamingDataset:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.helpers.ContentTileHelper,o=e.common.contracts.ContentTileType,r=e.common.utils.DateFormatter,a=e.common.contracts.GroupType,n=e.common.models.Model,s=e.common.helpers.ModelConverterHelper,c=e.common.contracts.PublishOrRefreshStatus,l=e.common.contracts.RealTimeMode,d=new Date(1),p=(function(){function t(e,t){var r=this;this.inViewport=!1,this.isFavoriting=!1,this.isTileActionsVisible=!1,this.setOwnerPhoto=function(){},this.openContentTile=function(){r.viewModel.contentTileType===o.Workspace&&r.openWorkspace(),i.openContentTile(r.viewModel,r.services.groupService,r.services.contentList)},this.unfavoriteContentTile=function(){var e=r.viewModel;r.services.contentList.removeFavorite(e)},this.favoriteContentTile=function(){r.isFavoriting=!0;var e=i.getGroupId(r.viewModel,r.services.groupService);r.services.contentList.addFavorite(r.viewModel,e).finally((function(){r.isFavoriting=!1}))},this.scope=e,this.services=t,this.hasGroupIconSet=!1,this.hasUserIconSet=!1,this.hasOwnerPhotoSet=!1,this.hasOwnerPhoto=!1,this.streamingDataset=!1,this.apiAccessType=this.services.localizationService.get("ContentList_Datasets_Dashes"),this.dashboardTitle=this.services.localizationService.get("Favorites_Dashboard")}return t.createOptions=function(){return{additionalServices:["contentList","groupService","localizationService","modelService","navigation","ownership","storageUsageService","userInfo","dashboardService","reportService","workbookService","appService","licenseEnforcementService"]}},t.prototype.$onInit=function(){8===this.tabType&&this.initializeDatasetMetadata(this.viewModel)},t.prototype.getTileTypeName=function(){if(this.viewModel&&this.viewModel.contentTileType)return o[this.viewModel.contentTileType].toLowerCase()},t.prototype.getOwnerNameOrMailForDashboard=function(){if(this.viewModel){if(this.viewModel.ownerFullname)return this.viewModel.ownerFullname;if(this.viewModel instanceof e.dataServices.models.Dashboard)return this.viewModel.ownerMail}},t.prototype.onceInViewport=function(){this.inViewport=!0},t.prototype.setUserPhoto=function(){var e=this;this.isMyWorkspace=!0,this.services.userInfo.getUserPhoto().then((function(t){e.hasUserIconSet=!0,e.userIcon=t})),this.groupName=this.getGroupName()},t.prototype.setGroupIcon=function(e){var t=this;this.isMyWorkspace=!1,this.services.userInfo.findGroupIcon(e).then((function(e){t.groupIcon=e,t.hasGroupIconSet=!0})),this.groupName=this.getGroupName(e)},t.prototype.getGroupName=function(e){var t=this.services.ownership;if(t.isResourceShareableWithMe(this.viewModel)&&t.isResourceSharedWithMe(this.viewModel))return this.services.localizationService.get("NavigationPane_SharedWithMe");if(this.isMyWorkspace)return this.services.localizationService.get("NavigationPane_Groups_MyWorkspace");var i=_.find(this.services.groupService.groups,(function(t){return t.aadGroupId===e}));return i?i.displayName:""},t.prototype.openWorkspace=function(){var t=this.viewModel;t.aadGroupId!==this.services.groupService.activeGroup.aadGroupId?t.isMyWorkspace||this.services.licenseEnforcementService.supportsGroups()?this.services.navigation.navigateToGroupByGUID(t.aadGroupId):this.services.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.SwitchGroups):this.services.navigation.navigateToContentList(t.aadGroupId,!1,null,null,!1)},t.prototype.canShowOptionsMenu=function(){return this.services.contentList.canShowTileOptions(this.viewModel)},t.prototype.publishInProgress=function(){return this.services.contentList.publishInProgress(this.viewModel)},t.prototype.canUnFavorite=function(){if(i.isFavoritableContent(this.viewModel))return this.services.contentList.isFavorite(this.viewModel)},t.prototype.canFavorite=function(){if(i.isFavoritableContent(this.viewModel))return!this.services.contentList.isFavorite(this.viewModel)},t.prototype.isFavoriteDisabled=function(){return!!this.isFavoriting||i.isFavoriteDisabled(this.viewModel,this.services.contentList)},t.prototype.convertRefreshTimeToJsDateTime=function(e){var t=s.convertRefreshTimeToJsDateTime(e);return!t||t.getFullYear()>3e3?this.services.localizationService.get("ManageDatasets_NextRefresh_NA"):t.toLocaleString()},t.prototype.getPrettyDate=function(e){return r.getPrettyRelativeDate(e,this.services.localizationService)},t.prototype.getPrettySharedDate=function(e){var t=s.convertRefreshTimeToJsDateTime(e);return t<d?this.services.localizationService.get("SharedWithMe_SharedTime_Older"):this.getPrettyDate(t)},t.prototype.getLocalizedDate=function(e){return jsCommon.DateExtensions.GetFullDateWithTime(this.services.localizationService.currentLanguageLocale,e)},t.prototype.initializeDatasetMetadata=function(e){null!=e&&(e.realTimeMode&&e.realTimeMode===l.CacheOnly?(this.streamingDataset=!0,this.apiAccessType=this.services.localizationService.get("ContentList_Datasets_Streaming")):e.realTimeMode&&e.realTimeMode===l.PersistAndCache?(this.streamingDataset=!0,this.apiAccessType=this.services.localizationService.get("ContentList_Datasets_Hybrid")):e.realTimeMode&&e.realTimeMode===l.PubNubCacheOnly?(this.streamingDataset=!0,this.apiAccessType=this.services.localizationService.get("ContentList_Datasets_Streaming")):e.contract.pushDataVersion&&(this.apiAccessType=this.services.localizationService.get("ContentList_Datasets_Push")))},t.prototype.isNew=function(){return this.viewModel instanceof n?this.viewModel.isNew&&this.viewModel.contract.packagePublishStatus!==c.PublishError&&this.viewModel.contract.packagePublishStatus!==c.RefreshError&&!this.isRefreshInProgress():this.viewModel.isNew},t.prototype.isRefreshInProgress=function(){if(this.viewModel instanceof n){var e=this.services.modelService.findModel(this.viewModel.contract.id,this.viewModel.contract.packageId);return!!e&&e.isRefreshInProgress}return!1},t.prototype.toggleTileActionsVisibility=function(e){e.stopPropagation(),this.isTileActionsVisible=!this.isTileActionsVisible},t.prototype.initializeMruRow=function(){this.viewModel.workspaceId===e.constants.myWorkSpaceGroupId?this.setUserPhoto():this.setGroupIcon(this.viewModel.workspaceId),
this.isItemAvailable=!!this.getOriginalContentTileOrViewModel()},t.prototype.initializeFavoriteRow=function(){this.viewModel.workspaceId?this.setGroupIcon(this.viewModel.workspaceId):this.setUserPhoto()},t.prototype.getOriginalContentTileOrViewModel=function(){var e=this.services;return i.getMRUOriginalContentTile(this.viewModel,e.dashboardService,e.reportService,e.workbookService,e.appService)},t.prototype.getActualContentType=function(){return i.getActualType(this.viewModel)},t.prototype.navigateToGroup=function(){var e=this.services.ownership.isResourceShareableWithMe(this.viewModel)&&this.services.ownership.isResourceSharedWithMe(this.viewModel);this.services.navigation.navigateToContentList(this.viewModel.workspaceId,!0,null,null,e)},t.prototype.getOwnershipTextForWorkspace=function(){if(this.viewModel.contentTileType===o.Workspace){var e=this.viewModel;return e.contract.isOwner||e.isMyWorkspace?this.services.localizationService.get("GroupEditor_RoleOptions_Admin"):this.services.localizationService.get("GroupEditor_RoleOptions_Member")}},t.prototype.getGroupTypeTextForWorkspace=function(){if(this.viewModel.contentTileType===o.Workspace){var e=this.viewModel;switch(e.contract.groupType){case a.Unknown:return"";case a.SecurityGroup:return this.services.localizationService.get("ContentList_Workspaces_GroupType_SecurityGroup");case a.DistributionList:return this.services.localizationService.get("ContentList_Workspaces_GroupType_DistributionList");case a.EmailEnabledSecurityGroup:return this.services.localizationService.get("ContentList_Workspaces_GroupType_EmailEnabledSecurityGroup");case a.O365Group:return this.services.localizationService.get("ContentList_Workspaces_GroupType_O365Group")}}},t.prototype.hasCapacity=function(){var e=this.viewModel.workspaceId;this.viewModel.contentTileType!==o.Dashboard||e||(e=this.viewModel.ownerGroupObjectId);var t=this.services.groupService.getGroup(e);return t&&!!t.capacity},t})();t.ContentTileController=p})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentTile={restrict:"E",templateUrl:"components/contentTile/contentTile.html",bindings:{viewModel:"<",inViewport:"<?disableLazyLoading"},controller:e.common.createController(e.controllers.ContentTileController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentRow={templateUrl:"components/contentRow/contentRow.html",bindings:{viewModel:"<",tabType:"<",inViewport:"<?disableLazyLoading",isDataClassificationEnabled:"<"},controller:e.common.createController(e.controllers.ContentTileController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.ContentHeader={templateUrl:"components/contentHeader/contentHeader.html",bindings:{tabType:"<",isDataClassificationEnabled:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.factory.ArtifactSortPredicates,o=e.common.constants,r=e.common.dialog.MessageDialogBuilder,a=e.models.OwnershipFilterMenuFilter,n=e.common.contracts.PermissionArtifactType,s=e.dataServices.PermissionsUtils,c=e.telemetry.SelectSort,l=e.common.constants.TaskPaneCollapsiblePaneMode,d=e.common.contracts.ContentTileType,p=(function(){function t(o,n){var s=this;this.services=n,this.sortPredicateMap={},this.allTypes=d.Dashboard|d.Report|d.Workbook,this.dashboards=[],this.reports=[],this.workbooks=[],this.datasets=[],this.dashboardCount=0,this.reportCount=0,this.workbookCount=0,this.datasetCount=0,this.searchText="",this.sortPredicate=i.TitleAlphabeticalPredicate,this.typeFilter=this.allTypes,this.ownership=a.AllContent,this.galleryViewModel={},this.filteredDashboards=[],this.filteredReports=[],this.filteredWorkbooks=[],this.filteredDatasets=[],this.initializeArtifacts=function(){var e=s.services.contentList,t=e.getDashboards().then((function(e){return s.dashboards=e,e})),i=e.getReports().then((function(e){return s.reports=e,e})),o=e.getWorkbooks().then((function(e){return s.workbooks=e,e})),r=e.getDatasets().then((function(e){return s.datasets=e,e})),a=s.services.promiseFactory.all([t,i,o,r]);s.dashboardsLoadedDefer=s.services.promiseFactory.defer(),s.reportsLoadedDefer=s.services.promiseFactory.defer(),s.workbooksLoadedDefer=s.services.promiseFactory.defer(),s.datasetLoadedDefer=s.services.promiseFactory.defer(),s.contentListDataReadyPromise=a.then(s.navigateToGetDataPageIfEmptyContent),a.then((function(){return s.updateArtifacts()})),s.groupService.ensureGroupsInitialization().then((function(){var e=s.services.groupService.activeGroup;s.groupName=e.displayName,s.updateShouldDisplayIntroduceAppBar()})),s.setCanManageDatasets(),s.initOnAppMetadata()},this.mapResourceOwnerFullnames=function(){s.services.resourceOwnershipService.mapReportOwnerFullnames(s.reports,s.dashboards,s.groupService.activeGroupObjectId,s.groupName),s.services.resourceOwnershipService.mapWorkbookOwnerFullnames(s.workbooks,s.dashboards,s.groupService.activeGroupObjectId,s.groupName)},this.startTelemetry=function(){s.scope.$on(e.constants.contentListDashboardsLoadedEvent,(function(){s.dashboardsLoadedDefer.resolve(null)})),s.scope.$on(e.constants.contentListReportsLoadedEvent,(function(){s.reportsLoadedDefer.resolve(null)})),s.scope.$on(e.constants.contentListWorkbooksLoadedEvent,(function(){s.workbooksLoadedDefer.resolve(null)})),s.scope.$on(e.constants.contentListDatasetsLoadedEvent,(function(){s.datasetLoadedDefer.resolve(null)}));var t=s.telemetryService.startActivity(s.scope,e.telemetry.ContentListLoaded);if(s.telemetryService.logEvent(e.telemetry.ContentListArtifactsCount,s.dashboards?s.dashboards.length:-1,s.reports?s.reports.length:-1,s.workbooks?s.workbooks.length:-1),s.listViewEnabled){var i=void 0;switch(s.activeTab){case 0:i=s.dashboardsLoadedDefer.promise;break;case 2:i=s.reportsLoadedDefer.promise;break;case 4:i=s.workbooksLoadedDefer.promise;break;case 8:i=s.datasetLoadedDefer.promise}i&&i.then((function(){t.resolve(),s.groupService.resolveGroupSwitchTelemetry()}))}else s.services.promiseFactory.all([s.dashboardsLoadedDefer.promise,s.reportsLoadedDefer.promise,s.workbooksLoadedDefer.promise]).then((function(){t.resolve(),s.groupService.resolveGroupSwitchTelemetry()}))},this.navigateToGetDataPageIfEmptyContent=function(i){if(_.every(i,_.isEmpty)&&!s.navigation.stateService.params[t.skipWelcome]){var o={groupGUID:s.services.groupService.activeGroupObjectId};s.services.navigation.replaceAndLoadCurrentState(e.constants.navigation.states.groupWelcome,o)}},this.resolveTelemetry=function(e,t,i){return 0===s[t]&&s[i].resolve(null),e},this.searchProperties=function(e){var t=s.searchText.toLocaleLowerCase();return s.containsSubstring(e.displayName,t)||s.containsSubstring(e.ownerFullname,t)},this.setCanManageDatasets=function(){s.services.groupService.ensureGroupsInitialization().then((function(){s.canManageDatasets=!s.services.groupService.activeGroup.contract.isReadOnly||s.services.groupService.activeGroup.contract.isOwner}))},this.selectSort=function(t){s.sortPredicate=t,s.filterArtifacts(s.activeTab);var i=s.sortPredicateMap[t.toAngularFilter()];s.services.telemetryService.logEvent(e.telemetry.ContentListSelectSort,i),s.persistFilter()},this.ownershipPredicate=function(e){return s.ownership===a.AllContent||s.ownership===a.SharedWithMe&&s.ownershipService.isResourceSharedWithMe(e)||s.ownership===a.MyContent&&!s.ownershipService.isResourceSharedWithMe(e)},this.onSearchTextChange=function(){s.filterArtifacts(s.activeTab),s.ensureSearchTelemetry()},this.ensureSearchTelemetry=function(){s.searchTelemetry||_.isEmpty(s.searchText)||(s.searchTelemetry=s.telemetryService.startEvent(e.telemetry.ContentListSearch))},this.resolveSearchTelemetry=function(){s.searchTelemetry&&(s.searchTelemetry.resolve(),s.searchTelemetry=null)},this.isVisible=function(e){return s.services.contentList.isVisible(e)},this.emptySharedDashboards={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptySharedWithMeTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptySharedWithMeMessage"),imgClass:"empty-shared-with-me-img"},this.emptyDashboards={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptyDashboardsTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptyDashboardsMessage"),imgClass:"empty-dashboards-img"},this.emptyReports={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptyReportsTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptyReportsMessage"),imgClass:"empty-reports-img"},this.emptyWorkbooks={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptyWorkbooksTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptyWorkbooksMessage"),imgClass:"empty-workbooks-img"},this.emptyDatasets={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptyDatasetsTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptyDatasetsMessage"),imgClass:"empty-datasets-img"},this.emptySearch={canEdit:!0,mode:!1,linkDescription:this.services.localizationService.get("ContentList_EmptySearchResults_SearchRedirectDescription"),linkText:this.services.localizationService.format("SearchIn",[this.services.localizationService.get("NavigationPane_SharedWithMe")]),linkAction:function(){return s.switchWorkspaceFromEmptySearch()},imgClass:"empty-search-img"},this.scope=o,this.navigation=n.navigation,this.localizationService=n.localizationService,this.errorService=n.errorService,this.groupService=n.groupService,this.telemetryService=n.telemetryService,this.groupHttp=n.groupHttp,this.ownershipService=n.ownership,this.rootScope=n.rootScope,this.modalDialogService=n.modalDialogService,this.userActivityContextService=n.userActivityContextService,this.modelService=n.modelService,this.listViewEnabled=n.featureSwitchService.featureSwitches.listViewEnabled,this.userMetadataLoaded=!1,this.setActiveTab(this.getCurrentTab()),this.initializeArtifacts();var c=this.services.contentList.subscribeDashboards((function(){return s.updateArtifacts()})),l=this.services.contentList.subscribeReports((function(){return s.updateArtifacts()})),p=this.services.contentList.subscribeWorkbooks((function(){return s.updateArtifacts()})),u=this.services.contentList.subscribeModels((function(){return s.updateArtifacts()}));this.createReportDialogBuilder=new e.dialogs.CreateReportDialogBuilder(n.telemetryService,n.navigation,n.usageMetricsReport,n.modalDialogService,n.modelService),this.messageDialogBuilder=new r(this.services.modalDialogService);var v=this.rootScope.$on(e.constants.groupSwitchedEventName,this.initializeArtifacts);this.services.dataClassificationService.isEnabledAsync().then((function(e){s.dataClassificationEnabled=e}));var h=this.services.rootScope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,i,o,r){return s.handleStateChange(t,i,o,r)}));this.unregisterListeners=function(){s.services.contentList.unsubscribeDashboards(c),s.services.contentList.unsubscribeReports(l),s.services.contentList.unsubscribeWorkbooks(p),s.services.contentList.unsubscribeModels(u),h(),v()}}return t.createOptions=function(){return{additionalServices:["$rootScope","appMetadataService","appService","conceptualModelSetting","contentList","groupService","navigation","permissionService","promiseFactory","ownership","localizationService","telemetryService","errorService","groupHttp","modalDialogService","resourceOwnershipService","filterPersistenceService","featureSwitchService","userActivityContextService","modelService","realTimeModel","overlayService","dataClassificationService","userInfo","quota","taskPaneSliderService","packageService","usageMetricsReport","notificationToast","tutorialDataStore"]}},t.prototype.$onInit=function(){var e=this;this.sortPredicateMap[i.TitleAlphabeticalPredicate.toAngularFilter()]=c.TitleAlpabetical,this.sortPredicateMap[i.TitleReverseAlphabeticalPredicate.toAngularFilter()]=c.TitleReverseAlphabetical,this.sortPredicateMap[i.OwnerAlphabeticalPredicate.toAngularFilter()]=c.OwnerAlphabetical,this.sortPredicateMap[i.OwnerReverseAlphabeticalPredicate.toAngularFilter()]=c.OwnerReverseAlphabetical,1===this.services.navigation.instantiationMode&&this.showStreamingDatasetGalleryPane(),this.processSharedWithMeParameter(),this.services.userInfo.userMetadataPromise.finally((function(){e.userMetadataLoaded=!0})),this.initialized=!0},t.prototype.$onDestroy=function(){this.unregisterListeners()},Object.defineProperty(t.prototype,"showSpinner",{get:function(){return this.isOnlySharedWithMe()?this.dashboardsArePresent&&(!this.userMetadataLoaded||!this.initialized):!this.initialized},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isActiveWorkspaceReadOnly",{get:function(){return this.services.permissionService.isActiveWorkspaceIsReadOnly},enumerable:!0,configurable:!0}),t.prototype.isOnlySharedWithMe=function(){return this.services.navigation.inContentListView(!0)},t.prototype.processSharedWithMeParameter=function(){this.navigation.searchText&&(this.searchText=this.navigation.searchText),this.isOnlySharedWithMe()?(this.setActiveTab(0),this.ownership=a.SharedWithMe,this.sortPredicate=i.OwnerAlphabeticalPredicate):(this.setActiveTab(this.getCurrentTab()),this.ownership=a.MyContent,this.sortPredicate=i.TitleAlphabeticalPredicate)},t.prototype.handleStateChange=function(e,t,i,o){this.processSharedWithMeParameter()},t.prototype.updateShouldDisplayIntroduceAppBar=function(){var t=this;this.shouldDisplayIntroduceAppBar=this.isAppsEnabled()&&!this.services.groupService.isMyWorkspace()&&!this.isActiveWorkspaceReadOnly&&!this.services.tutorialDataStore.getKey(o.HideIntroduceAppBarKey),this.shouldDisplayIntroduceAppBar&&!this.introduceAppBarConfig&&(this.introduceAppBarConfig={title:this.services.localizationService.get("AppModel_IntroduceAppAndAppWorkspaces"),content:this.services.localizationService.get("AppModel_IntroduceAppDescriptionInWorkspace"),learnMoreText:this.services.localizationService.get("LearnMore"),closeBarCallback:function(){var i=t.telemetryService.startEvent(e.telemetry.AppsHideIntroduceAppBar);t.services.tutorialDataStore.setKey(o.HideIntroduceAppBarKey,!0,i),t.shouldDisplayIntroduceAppBar=!1,t.introduceAppBarConfig=null}})},t.prototype.containsSubstring=function(e,t){return!!e&&_.contains(e.toLocaleLowerCase(),t)},t.prototype.$postLink=function(){this.contentListDataReadyPromise.then(this.startTelemetry)},t.prototype.initOnAppMetadata=function(){var e=this;this.services.appMetadataService.getAppMetadata().then((function(){e.initialized=!0}))},t.prototype.getNumberOfShownItems=function(){var e=0;return this.shouldHideType(d.Dashboard)||(e+=this.dashboardCount),this.shouldHideType(d.Report)||(e+=this.reportCount),this.shouldHideType(d.Workbook)||(e+=this.workbookCount),e},t.prototype.shouldHideType=function(e){return 0===(this.typeFilter&e)},t.prototype.persistFilter=function(){this.services.filterPersistenceService.setFilter(this.navigation.currentGroupGUID,{contentTileType:this.typeFilter,ownershipFilter:this.ownership,sortPredicate:this.sortPredicate.toAngularFilter()})},t.prototype.switchWorkspaceFromEmptySearch=function(){this.services.navigation.navigateToSharedWithMe(this.searchText)},t.prototype.setActiveTab=function(e){this.activeTab=e,e!==this.getCurrentTab()&&this.services.navigation.changeContentListPivot(e),this.updateSortPredicates(),this.updateArtifacts()},t.prototype.getCurrentTab=function(){var e=this.services.navigation.stateService.params[t.pivot];switch(e){case"dashboards":return 0;case"datasets":return 8;case"recent":return 16;case"reports":return 2;case"workbooks":return 4}return this.services.navigation.contentListTab||0},t.prototype.updateSortPredicates=function(){this.sortPredicates=e.models.factory.SelectTileSortItemsFactory.createPredicates(this.localizationService,this.activeTab)},t.prototype.updateArtifacts=function(){this.services.promiseFactory.all([this.contentListDataReadyPromise,this.groupService.ensureGroupsInitialization(),this.services.contentList.dashboardsOwnersMergedPromise(),this.services.appService.ensureAppsInitialization()]).then(this.mapResourceOwnerFullnames),this.filterArtifacts(this.activeTab)},t.prototype.filterArtifacts=function(e){switch(e){case 0:this.filterDashboards();break;case 2:this.filterReports();break;case 4:this.filterWorkbooks();break;case 8:this.filterDatasets()}this.updateGalleryViewModel()},t.prototype.filterDashboards=function(){var e=this,t=_(this.dashboards).filter((function(t){return e.isVisible(t)&&e.ownershipPredicate(t)}));this.dashboardsArePresent=t.any(),this.filteredDashboards=this.filterSearchTextAndSort(t).value(),this.dashboardCount=this.filteredDashboards.length},t.prototype.filterReports=function(){var e=this,t=_(this.reports).filter((function(t){return e.services.contentList.isPackageReadyToUse(t)&&e.isVisible(t)&&e.ownershipPredicate(t)&&!e.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack(t.contract)}));this.reportsArePresent=t.any(),this.filteredReports=this.filterSearchTextAndSort(t).value(),this.reportCount=this.filteredReports.length},t.prototype.filterWorkbooks=function(){var e=this,t=_(this.workbooks).filter((function(t){return e.isVisible(t)&&e.ownershipPredicate(t)}));this.workbooksArePresent=t.any(),this.filteredWorkbooks=this.filterSearchTextAndSort(t).value(),this.workbookCount=this.filteredWorkbooks.length},t.prototype.filterDatasets=function(){var e=_(this.datasets).filter(this.isVisible);this.datasetsArePresent=e.any(),this.filteredDatasets=this.filterSearchTextAndSort(e).value(),this.datasetCount=this.filteredDatasets.length},t.prototype.filterSearchTextAndSort=function(e){var t=this,i=e.filter(this.searchProperties).sortBy((function(e){return e.hasOwnProperty(t.sortPredicate.columnName)?e[t.sortPredicate.columnName].toLocaleLowerCase():""}));return this.sortPredicate.reverse&&(i=i.reverse()),i},t.prototype.updateGalleryViewModel=function(){var t=this;switch(this.galleryViewModel.tabType=this.activeTab,this.galleryViewModel.collapsiblePaneMode=this.collapsiblePaneMode,this.activeTab){case 0:this.galleryViewModel.getTiles=function(){return t.filteredDashboards},this.galleryViewModel.finishLoadEvent=e.constants.contentListDashboardsLoadedEvent;break;case 2:this.galleryViewModel.getTiles=function(){return t.filteredReports},this.galleryViewModel.finishLoadEvent=e.constants.contentListReportsLoadedEvent;break;case 4:this.galleryViewModel.getTiles=function(){return t.filteredWorkbooks},this.galleryViewModel.finishLoadEvent=e.constants.contentListWorkbooksLoadedEvent;break;case 8:this.galleryViewModel.getTiles=function(){return t.filteredDatasets},this.galleryViewModel.finishLoadEvent=e.constants.contentListDatasetsLoadedEvent}},t.prototype.getNumberOfShownTabItems=function(){var e=0;switch(this.activeTab){case 0:return e+=this.dashboardCount;case 2:return e+=this.reportCount;case 4:return e+=this.workbookCount;case 8:return e+=this.datasetCount;default:return e}},t.prototype.addDashboard=function(){var t=this;this.services.overlayService.hideAllDropdowns();var i=this.services.localizationService;e.explore.controllers.showSaveAsDialog(this.services.errorService,i,i.get("ContentList_CreateDashboard_DialogTitle"),i.get("ContentList_CreateDashboard_DialogDetails"),i.get("ContentList_CreateDashboard_DialogButton")).then((function(e){t.services.contentList.addDashboard(e)}),(function(){}))},t.prototype.addReport=function(){this.services.overlayService.hideAllDropdowns(),this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.OpenDataset)||this.createReportDialogBuilder.show()},t.prototype.showStreamingDatasetGalleryPane=function(){this.services.overlayService.hideAllDropdowns(),this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.CreateStreamingDataset)||(this.services.realTimeModel.setSelected(null),this.services.featureSwitchService.featureSwitches.realTimePubNubEnabled?this.services.taskPaneSliderService.expandPane(l.StreamingDatasetGallery):this.services.taskPaneSliderService.expandPane(l.StreamingDatasetEditor))},t.prototype.addChannel=function(){var t=this,i=_.filter(this.dashboards,(function(e){return!e.contract.isHidden&&s.canReshare(e.getPermissions(),n.Dashboard)})),o=_.filter(this.reports,(function(e){return s.canReshare(t.services.permissionService.getReportEffectivePermissions(e.contract),n.Report)})),a=_.filter(this.workbooks,(function(e){return s.canReshare(t.services.permissionService.getWorkbookEffectivePermissions(e.contract),n.Workbook)})),c=_.filter(e.helpers.ContentPackAuthoringHelper.getUsedDatasets(this.datasets,i,o),(function(e){return!e.contract.isHidden&&s.canReshare(t.services.permissionService.getModelEffectivePermissions(e.contract),n.Dataset)}));if(_.isEmpty(i)&&_.isEmpty(o)&&_.isEmpty(a)&&_.isEmpty(c)){var l=new r(this.services.modalDialogService);l.show("PublishAppConfirmDialog",{titleText:this.services.localizationService.get("AppModel_CannotCreateTitle"),messageText:this.services.localizationService.get("AppModel_CannotCreatContent"),okButtonText:this.services.localizationService.get("PBI_Button_Label_Close"),hideCancelButton:!0})}else this.services.navigation.showPublishAppSlicer()},t.prototype.isAppsEnabled=function(){return this.services.conceptualModelSetting.isAppsEnabled()},t.prototype.getWatermarkConfig=function(){switch(this.activeTab){case 0:return this.internalGetWatermarkMessage("Dashboard");case 2:return this.internalGetWatermarkMessage("Report");case 4:return this.internalGetWatermarkMessage("Workbook");case 8:return this.internalGetWatermarkMessage("Dataset")}},t.prototype.internalGetWatermarkMessage=function(e){var t=_.camelCase(e);return 0!==this[t+"Count"]||_.isEmpty(this.searchText)?this[t+"sArePresent"]?void 0:"dashboard"===t&&this.isOnlySharedWithMe()?this.emptySharedDashboards:this["empty"+e+"s"]:this.emptySearch},t})();p.skipWelcome="skipWelcome",p.pivot="pivot",t.ContentListContainerV2Controller=p})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentListContainerV2={templateUrl:"components/contentListContainerV2/contentListContainerV2.html",controller:e.common.createController(e.controllers.ContentListContainerV2Controller),bindings:{collapsiblePaneMode:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.disableLazyLoading=!1,this.shouldShowAddDashboardBtn=function(){i.services.groupService.ensureGroupsInitialization().then((function(){i.showAddDashboardBtn=!i.services.groupService.activeGroup.contract.isReadOnly||i.services.groupService.activeGroup.contract.isOwner}))},this.scope=e,this.services=t,this.shouldShowAddDashboardBtn()}return t.createOptions=function(){return{additionalServices:["contentList","localizationService","errorService","groupService"]}},t.prototype.activeAddDashboard=function(){var t=this,i=this.services.localizationService;e.explore.controllers.showSaveAsDialog(this.services.errorService,i,i.get("ContentList_CreateDashboard_DialogTitle"),i.get("ContentList_CreateDashboard_DialogDetails"),i.get("ContentList_CreateDashboard_DialogButton")).then((function(e){t.services.contentList.addDashboard(e)}),(function(){}))},t})();t.ContentTileContainerController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.ContentListGalleryViewModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t="dashboardsGallery",i="reportsGallery",o="workbooksGallery",r="datasetsGallery",a="recentlyUsedGallery",n="sharedWithMeGallery",s="favoritesGallery",c=(function(){function e(e,t){this.services=t}return Object.defineProperty(e.prototype,"galleryContainerStyle",{get:function(){switch(this.viewModel.tabType){case 0:return t;case 2:return i;case 4:return o;case 8:return r;case 16:return a;case 64:return n;case 128:return s}},enumerable:!0,configurable:!0}),e})();e.ContentListGalleryController=c})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentListGallery={templateUrl:"components/contentListGallery/contentListGallery.html",bindings:{viewModel:"<",isDataClassificationEnabled:"<"},controller:e.common.createController(e.controllers.ContentListGalleryController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentTileContainer={templateUrl:"components/contentTileContainer/contentTileContainer.html",controller:e.common.createController(e.controllers.ContentTileContainerController),transclude:{title:"?sectionTitle"},bindings:{getTiles:"&tiles",collapsiblePaneMode:"<",finishLoadEvent:"@",disableLazyLoading:"<?",placeHolderTile:"<?"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentRowContainer={templateUrl:"components/contentRowContainer/contentRowContainer.html",controller:e.common.createController(e.controllers.ContentTileContainerController),bindings:{getTiles:"&tiles",tabType:"<",collapsiblePaneMode:"<",finishLoadEvent:"@",disableLazyLoading:"<?",isDataClassificationEnabled:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.isDataClassificationFeatureEnabled=t.featureSwitchService.featureSwitches.dataClassificationEnabled,this.dataClassificationService=t.dataClassificationService}return e.createOptions=function(){return{additionalServices:["featureSwitchService","dataClassificationService"]}},e.prototype.$onInit=function(){this.updateDataClassificationById(this.classificationId)},e.prototype.$onChanges=function(e){e.classificationId&&this.updateDataClassificationById(e.classificationId.currentValue)},e.prototype.updateDataClassificationById=function(e){var t=this;this.dataClassificationService.getDataClassificationsAsync().then((function(i){t.dataClassification=_.find(i,(function(t){return void 0!==e&&t.id===e}))||_.find(i,(function(e){return e.default}))}))},e})();e.DataClassificationLabelController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ClassificationLabel={templateUrl:"components/dataClassificationLabel/dataClassificationLabel.html",controller:e.common.createController(e.controllers.DataClassificationLabelController),bindings:{classificationId:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.factory.ArtifactSortPredicates,o=e.models.ContentListGalleryViewModel,r=e.telemetry.SelectSort,a=(function(){function t(t,r){var a=this;this.services=r,this.sortPredicateMap={},this.selectSort=function(t){a.sortPredicate=t;var i=a.sortPredicateMap[t.toAngularFilter()];a.services.telemetryService.logEvent(e.telemetry.ContentListSelectSort,i),a.filterArtifacts()},this.onSearchTextChange=function(){a.filterArtifacts(),a.ensureSearchTelemetry()},this.listener={onFavoriteAdded:function(){return a.updateArtifacts()},onFavoriteDeleted:function(){return a.updateArtifacts()},onFavoritesReset:function(){return a.updateArtifacts()}},this.services.favorites.subscribe(this.listener),this.searchText="",this.sortPredicate=i.TitleAlphabeticalPredicate,this.sortPredicates=e.models.factory.SelectTileSortItemsFactory.createPredicates(this.services.localizationService,128),this.galleryViewModel=new o,this.galleryViewModel.getTiles=function(){return a.filteredFavorites},this.galleryViewModel.tabType=128,this.galleryViewModel.finishLoadEvent=e.constants.contentListFavoritesLoadedEvent,this.services.dataClassificationService.isEnabledAsync().then((function(e){a.isDataClassificationEnabled=e})),this.services.favorites.reloadFavorites(!0).then((function(e){return a.updateArtifacts()})),this.allFavoritesCache=this.services.favorites.favoritesCache,this.filteredFavorites=this.allFavoritesCache||[]}return t.createOptions=function(){return{additionalServices:["dataClassificationService","favorites","localizationService","telemetryService"]}},t.prototype.$onInit=function(){this.sortPredicateMap[i.TitleAlphabeticalPredicate.toAngularFilter()]=r.TitleAlpabetical,this.sortPredicateMap[i.TitleReverseAlphabeticalPredicate.toAngularFilter()]=r.TitleReverseAlphabetical,this.sortPredicateMap[i.OwnerInfoAlphabeticalPredicate.toAngularFilter()]=r.OwnerAlphabetical,this.sortPredicateMap[i.OwnerInfoReverseAlphabeticalPredicate.toAngularFilter()]=r.OwnerReverseAlphabetical,this.emptySearchWatermarkConfig={canEdit:!0,mode:!1,contentNonShared:this.services.localizationService.get("ContentList_EmptySearchResults"),imgClass:"empty-search-img"}},t.prototype.$onDestroy=function(){this.services.favorites.unsubscribe(this.listener)},t.prototype.ensureSearchTelemetry=function(){this.searchTelemetry||_.isEmpty(this.searchText)||(this.searchTelemetry=this.services.telemetryService.startEvent(e.telemetry.ContentListSearch))},t.prototype.resolveSearchTelemetry=function(){this.searchTelemetry&&(this.searchTelemetry.resolve(),this.searchTelemetry=null)},Object.defineProperty(t.prototype,"initialized",{get:function(){return!!this.allFavoritesCache},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showEmptyFavoritesWatermark",{get:function(){return this.initialized&&_.isEmpty(this.allFavoritesCache)},enumerable:!0,configurable:!0}),t.prototype.updateArtifacts=function(e){this.allFavoritesCache=this.services.favorites.favoritesCache,this.filterArtifacts()},t.prototype.filterArtifacts=function(){var e=this,t=_(this.allFavoritesCache).filter((function(t){return e.containsSearchText(t)})).sortBy((function(t){return t.hasOwnProperty(e.sortPredicate.columnName)?t[e.sortPredicate.columnName].toLocaleLowerCase():""}));this.sortPredicate.reverse&&(t=t.reverse()),this.filteredFavorites=t.value(),this.showEmptySearchWatermarkConfig=!_.isEmpty(this.allFavoritesCache)&&!!this.searchText&&_.isEmpty(this.filteredFavorites)},t.prototype.containsSearchText=function(e){var t=this.searchText.toLocaleLowerCase();return this.containsSubstring(e.displayName,t)||this.containsSubstring(e.ownerInfo,t)},t.prototype.containsSubstring=function(e,t){return!!e&&_.contains(e.toLocaleLowerCase(),t)},t})();t.FavoritesContainerController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.FavoritesContainer={templateUrl:"components/favoritesContainer/favoritesContainer.html",bindings:{collapsiblePaneMode:"<"},controller:e.common.createController(e.controllers.FavoritesContainerController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.services=t}return t.createOptions=function(){return{additionalServices:["dashboardService","home","localizationService","mostRecentlyUsedService","navigation","telemetryService"]}},t.prototype.$onInit=function(){var i=this;this.services.mostRecentlyUsedService.getMRUModels().then((function(o){for(var r=[],a=0,n=o;a<n.length;a++){var s=n[a];if(s.type===e.models.MRUArtifactType.Dashboards){var c=i.services.dashboardService.findDashboardByGUID(s.objectId);c&&(s.packageid=c.id,r.push(s))}}i.dashboards=_.sortBy(r,(function(e){return e.count})).reverse().slice(0,t.NumberOfDashboards),i.watermarkConfig.contentNonShared=i.hasDashboards()?i.services.localizationService.get("FeaturedDashboard_Message"):i.services.localizationService.get("FeaturedDashboard_EmptyMessage")})),this.watermarkConfig={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("FeaturedDashboard_Title"),imgClass:"empty-dashboards-img"}},t.prototype.hasDashboards=function(){return!_.isEmpty(this.dashboards);
},t.prototype.selectDashboard=function(e){this.selectedDashboard=e},t.prototype.setHomeDashboard=function(){if(this.selectedDashboard){var t=this.selectedDashboard;this.services.telemetryService.logEvent(e.telemetry.DashboardSetHomeDashboard,"MFU"),this.services.home.setHomeDashboard(t.packageid,t.objectId,t.displayName,t.workspaceId),this.services.navigation.insertGroupAndNavigateToDashboardByGUID(t.objectId,t.workspaceId,1)}},t})();i.NumberOfDashboards=5,t.FeaturedDashboardContainerController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.FeaturedDashboardContainer={templateUrl:"components/featuredDashboardContainer/featuredDashboardContainer.html",controller:e.common.createController(e.controllers.FeaturedDashboardContainerController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.GroupLinkType,o=e.common.dialog.MessageDialogBuilder,r=(function(){function r(e,t){this.services=t,this.dropdownOrientation="horizontal",this.allowUnpublishApp=!1}return r.createOptions=function(){return{additionalServices:["$rootScope","errorService","groupHttp","groupService","localizationService","modalDialogService","navigation","promiseFactory","telemetryService","userInfo","viralTenantMergeHelperService","groupContextMenuService","conceptualModelSetting","notificationToast","permissionService","lazy"]}},r.prototype.$onInit=function(){this.items=this.buildContextMenu(this.group),this.messageDialogBuilder=new o(this.services.modalDialogService)},r.prototype.$onChanges=function(e){(e.group||e.allowUnpublishApp)&&(this.items=this.buildContextMenu(this.group))},r.prototype.onGroupNavigationPaneMenuItemSelected=function(e,o){switch(e.action){case t.GroupNavigationPaneMenuAction.EditGroup:this.services.groupContextMenuService.performActionWithNonUrlGroupLinkType(i.EditGroup,o);break;case t.GroupNavigationPaneMenuAction.ViewGroup:this.services.groupContextMenuService.performActionWithNonUrlGroupLinkType(i.ViewGroup,o);break;case t.GroupNavigationPaneMenuAction.LeaveGroup:this.services.groupContextMenuService.performActionWithNonUrlGroupLinkType(i.LeaveGroup,o);break;case t.GroupNavigationPaneMenuAction.UnpublishApp:this.unpublishApp()}},r.prototype.buildContextMenu=function(e){var o=this,r=e.metadata,a=[],n=0,s=!0;return r?r.contextMenuItemList.forEach((function(e){if(0===n&&r.contextMenuSeparatorPosition===-1)s=!1;else if(n++===r.contextMenuSeparatorPosition){var c={type:DropDownMenuItemType.Separator};a.push(c),s=!1}var l;if(!s)switch(e.linkType){case i.EditGroup:l=t.GroupNavigationPaneMenuAction.EditGroup;break;case i.ViewGroup:l=t.GroupNavigationPaneMenuAction.ViewGroup;break;case i.LeaveGroup:l=t.GroupNavigationPaneMenuAction.LeaveGroup}var d={text:o.getMenuItemText(e.linkType),labelClass:"groupMenuItem",action:l,href:s?e.url:void 0,type:DropDownMenuItemType.Item};a.push(d)})):(a.push({text:this.getMenuItemText(i.EditGroup),labelClass:"groupMenuItem",action:t.GroupNavigationPaneMenuAction.EditGroup,type:DropDownMenuItemType.Item}),a.push({text:this.getMenuItemText(i.LeaveGroup),labelClass:"groupMenuItem",action:t.GroupNavigationPaneMenuAction.LeaveGroup,type:DropDownMenuItemType.Item})),this.allowUnpublishApp&&this.services.conceptualModelSetting.isAppsEnabled()&&this.appendUnpublishAppItem(a),a},r.prototype.appendUnpublishAppItem=function(e){var o=this;this.services.groupService.groupSwitchPromise().then((function(){o.group===o.services.groupService.activeGroup&&(o.services.groupService.isMyWorkspace()||o.services.permissionService.isActiveWorkspaceIsReadOnly||o.services.lazy("publishApp").then((function(r){r.getPublishedAppsForCurrentGroup().then((function(r){_.isEmpty(r)||(o.publishedApp=r[0],e.push({text:o.getMenuItemText(i.UnpublishApp),labelClass:"groupMenuItem",action:t.GroupNavigationPaneMenuAction.UnpublishApp,type:DropDownMenuItemType.Item}))}))})))}))},r.prototype.unpublishApp=function(){var i=this;this.messageDialogBuilder.show("unpublishAppConfirmationDialog",{titleText:this.services.localizationService.get("AppModel_UnpublishingAppTitle"),messageText:this.services.localizationService.get("AppModel_UnpublishingAppMessage"),okButtonText:this.services.localizationService.get("Unpublish"),cancelButtonText:this.services.localizationService.get("PBI_Button_Label_Close")}).then((function(o){if(0===o){i.unpublishAppInProgress=!0;var r=i.services.notificationToast.notify({message:i.services.localizationService.get("AppModel_UnpublishingAppToastMessage"),notificationType:e.common.NotificationToastType.Loading});i.services.lazy("publishApp").then((function(o){o.deletePublishedApp(void 0,i.publishedApp.objectId).then((function(){i.services.notificationToast.hide(r),i.services.notificationToast.notify({message:i.services.localizationService.get("AppModel_UnpublishingAppSuccessToastMessage"),notificationType:e.common.NotificationToastType.Success}),_.remove(i.items,(function(e){return e.action===t.GroupNavigationPaneMenuAction.UnpublishApp})),i.publishedApp=null}),(function(){i.services.notificationToast.hide(r),i.services.notificationToast.notify({message:i.services.localizationService.get("App_Delete_FailedMessage"),notificationType:e.common.NotificationToastType.Error})})).finally((function(){i.unpublishAppInProgress=!1}))}))}}))},r.prototype.getMenuItemText=function(e){return this.services.groupContextMenuService.getTextForGroupLinkType(e)},r})();t.GroupActionsController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.GroupActions={templateUrl:"components/groupActions/groupActions.html",controller:e.common.createController(e.controllers.GroupActionsController),bindings:{group:"<",dropdownOrientation:"@?",allowUnpublishApp:"<?",unpublishAppInProgress:"=?"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.scope=e,this.services=t}return t.createOptions=function(){return{additionalServices:["userInfo"]}},t.prototype.$onInit=function(){this.updatePhoto(),this.updatePlaceholder()},t.prototype.$onChanges=function(e){e.group&&(this.updatePhoto(),this.updatePlaceholder())},t.prototype.updatePlaceholder=function(){this.placeholder=this.isMyWorkspace()?"user":"group"},t.prototype.updatePhoto=function(){var e=this;this.isMyWorkspace()?this.services.userInfo.getUserPhoto().then((function(t){e.src=t.substring(4,t.length-1)})):this.group?this.src=this.group.icon:this.src=null},t.prototype.isMyWorkspace=function(){return this.group&&this.group.aadGroupId===e.common.constants.myWorkspaceGroupId},t})();t.GroupIconController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.GroupIcon={templateUrl:"components/groupIcon/groupIcon.html",bindings:{group:"<",placeholderSize:"@"},controller:e.common.createController(e.controllers.GroupIconController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.constants.TaskPaneCollapsiblePaneMode,r=(function(){function t(t,i){var o=this;this.services=i,this.groupService=i.groupService;var r=this.services.$rootScope.$on(e.constants.groupDeletedEventName,(function(e){e.stopPropagation(),o.updateGroupList()}));this.services.$rootScope.$on(e.common.constants.scopeDestroyEventName,(function(){r()}))}return t.createOptions=function(){return{additionalServices:["$rootScope","groupService","userInfo","navigation","viralTenantMergeHelperService","taskPaneSliderService","licenseEnforcementService"]}},t.prototype.$onChanges=function(e){(e.activeGroup||e.isExpanded&&this.isExpanded)&&this.updateGroupList()},t.prototype.isGroupSelected=function(e){return!!this.activeGroup&&this.activeGroup.aadGroupId===e.aadGroupId},t.prototype.switchGroup=function(t){this.toggleGroupListPane(!1),t.aadGroupId!==this.activeGroup.aadGroupId?t.isMyWorkspace||this.isGroupFeatureEnabled()?this.services.navigation.navigateToGroupByGUID(t.aadGroupId):this.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.SwitchGroups):this.services.navigation.navigateToContentList(t.aadGroupId,!1,null,null,!1)},t.prototype.toggleGroupListPane=function(e){this.onToggled&&this.onToggled({isExpanded:e})},t.prototype.addGroup=function(){this.services.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()?this.services.viralTenantMergeHelperService.displayFeatureDisabledErrorMessage("ArchivedContent_ErrorMessageGroup"):this.isGroupFeatureEnabled()?this.services.taskPaneSliderService.expandPane(o.GroupEditorCreate,i.Large):this.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.CreateGroups)},t.prototype.isActiveGroup=function(e){return e===this.activeGroup},t.prototype.updateGroupList=function(){this.myWorkspace=this.groupService.groups[0],this.groups=_(this.groupService.groups).filter((function(e){return!e.isMyWorkspace})).sortBy((function(e){return e.displayName})).value()},t.prototype.isGroupFeatureEnabled=function(){return this.services.licenseEnforcementService.supportsGroups()},t})();t.GroupListController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.GroupList={templateUrl:"components/groupList/groupList.html",controller:e.common.createController(e.controllers.GroupListController),bindings:{activeGroup:"<",isExpanded:"<",onToggled:"&"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.controllers.EmailsList,o=e.errorDetailsHelper,r=e.common.contracts.GroupMembershipStatus,a=(function(){function t(e,t){this.scope=e,this.services=t,this.readOnlyGroupEnabled=this.services.featureSwitchService.featureSwitches.readOnlyGroupEnabled,this.capacityEnabled=this.services.featureSwitchService.featureSwitches.groupCapacity,this.availableCapacities=[]}return t.prototype.isEmailListChanged=function(){var e=this.model.originalDisplayMemberList,t=this.model.displayMemberList;if(e.length!==t.length)return!0;var i=this.contractGroupMembersToArray(e),o=this.contractGroupMembersToArray(t),r=_.difference(i,o);return!_.isEmpty(r)},t.prototype.add=function(){this.model.invalidEmailAddressesErrorMessage="",this.model.notExitingEmailAddressesErrorMessage="",this.model.emailsList.validationTrigger()&&(this.isAddingMembers=!0,this.validateEmailAddresses())},t.prototype.removeMember=function(e){if(this.isMemberTheOnlyAdmin(e)){var t=this.services.errorService.control(),i=this.services.localizationService;t.showPrompt("",i.get("GroupEditor_TheOnlyAdmin_Message"),[new InJs.ModalDialogAction(i.get("ModalDialogButtonText_Ok"),function(e,i){t.hideDialog()})])}else this.model.emailsList.isDirty=!1,this.model.displayMemberList=_.filter(this.model.displayMemberList,(function(t){return t.userPrincipalName!==e.userPrincipalName}))},t.prototype.getGroupMembers=function(){var t=this;this.isLoadingGroupMembers=!0;var i=this.services.telemetryService.startEvent(e.telemetry.GroupEditorGetGroupMembers),r=this.group.aadGroupId;this.services.groupHttp.getGroupMembers(r,i.event).then((function(e){var o=_.sortBy(t.mapFromMemberContractListToMemberModelList(e.data),(function(e){return e.userPrincipalName}));t.model.originalDisplayMemberList=o,t.model.displayMemberList=_.cloneDeep(o),i.resolve()}),(function(e){i.reject(o.getTelemetryErrorDetails(e.error,e.status)),t.services.errorService.error(t.services.localizationService.get("GroupEditor_FailedGetGroupMembers_Message"),"FailedToGetGroupMembers",{requestId:e.requestId,statusCode:e.status.toString()})})).finally((function(){t.isLoadingGroupMembers=!1}))},t.prototype.validateEmailAddresses=function(){var t=this;if(this.model.emailsList.validEmailsList=_.unique(_.map(this.model.emailsList.validEmailsList,(function(e){return e.toLowerCase()}))),this.model.emailsList.validEmailsList=_.difference(this.model.emailsList.validEmailsList,_.map(this.model.displayMemberList,(function(e){return e.userPrincipalName.toLowerCase()}))),this.model.emailsList.validEmailsList.length>0){var i=_.map(this.model.emailsList.validEmailsList,(function(e){return{userPrincipalName:e,membershipStatus:r.Member}})),a=this.services.telemetryService.startEvent(e.telemetry.GroupEditorValidateGroupMembers);this.services.domainHelperService.getVerifiedDomains().then((function(e){t.services.groupHttp.validateGroupMembers(i,a.event).then((function(i){for(var o=[],r={},n=0,s=i.data;n<s.length;n++){var c=s[n],l=c.userPrincipalName.split("@");l[1].toUpperCase()in e.verifiedDomains?r[c.userPrincipalName]=1:o.push(c)}t.displayValidationErrors(o);var d=t.contractGroupMembersToArray(o),p=_.difference(t.model.emailsList.validEmailsList,d);t.model.displayMemberList=_.union(t.model.displayMemberList,_.map(p,(function(e){return{userPrincipalName:e,role:e in r?2:0,invitationSent:!1}}))),t.model.emailsList.isDirty=!1,a.resolve()}),(function(e){a.reject(o.getTelemetryErrorDetails(e.error,e.status)),t.services.errorService.error(t.services.localizationService.get("GroupEditor_FailedValidateMembers_Message"),"FailedToValidateMembers",{requestId:e.requestId,statusCode:e.status.toString()})}))}),(function(e){a.reject(o.getTelemetryErrorDetails(e.error,e.status))})).finally((function(){t.isAddingMembers=!1}))}else this.displayValidationErrors([]),this.setEmailsListContent(""),this.model.emailsList.isDirty=!1,this.isAddingMembers=!1},t.prototype.setEmailsListContent=function(t){this.model.emailsList.inputUserList=i.emailsToUsers(t.split(e.constants.emailsListSeparator))},t.prototype.resetEmailsListControl=function(e){this.model.invalidEmailAddressesErrorMessage="",this.displayValidationErrors(e)},t.prototype.mapFromMemberModelListToMemberContractList=function(e){return _.map(e,(function(e){var t=1===e.role?r.MemberAndOwner:r.Member;return 2===e.role&&(t=r.Pending),{userPrincipalName:e.userPrincipalName,membershipStatus:t}}))},t.prototype.mapFromMemberContractListToMemberModelList=function(e){var t=this;return _.map(e,(function(e){return{userPrincipalName:e.userPrincipalName,role:t.convertMemberRole(e),invitationSent:e.membershipStatus===r.Pending}}))},t.prototype.getAccessControlOption=function(){var e=this.model.accessControlOption;if(null!=e){var t=_.find(this.model.accessControlOptions,{key:e});return t.value}},t.prototype.getPrivacyOption=function(){var e=this.model.privacyOption;if(null!=e){var t=_.find(this.model.privacyOptions,{key:e});return t.value}},t.prototype.cancel=function(){this.services.taskPaneSliderService.collapsePane()},t.prototype.isMemberTheOnlyAdmin=function(e){if(1===e.role){var t=_.filter(this.model.displayMemberList,(function(e){return 1===e.role}));return 1===t.length&&t[0].userPrincipalName.toLowerCase()===e.userPrincipalName.toLowerCase()}return!1},t.prototype.toggleCapacity=function(){this.model.capacity?this.model.capacity=null:this.model.capacity=_.first(this.availableCapacities)},t.prototype.canEditCapacity=function(){return!_.isEmpty(_.filter(this.availableCapacities,(function(e){return!e.disabled})))},t.prototype.getInCapacityMessage=function(){if(this.capacityEnabled&&this.model.capacity)return this.services.localizationService.format("GroupEditor_IsOnCapacityMessage",[this.model.capacity.name])},t.prototype.toggleAdvancedMode=function(){this.isAdvancedModeExpanded=!this.isAdvancedModeExpanded},t.prototype.getToggleTooltipConfig=function(){var t="GroupEditor_CapacityToggleEnabledTooltip";return this.canEditCapacity()||(t="GroupEditor_CapacityToggleDisabledTooltip"),{tooltipDelay:100,tooltipAnchorElementSelector:".capToggle input",tooltipLocalizeDescription:t,tooltipArrowPosition:e.common.ArrowPosition.arrowTopMiddle}},t.prototype.loadCapacities=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,o,r=this;return __generator(this,(function(a){switch(a.label){case 0:if(!this.capacityEnabled)return[2];this.isLoadingCapacities=!0,a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.services.groupHttp.getAvailableGroupCapacities()];case 2:return t=a.sent(),t&&t.status===e.HttpStatusCode.OK&&(this.availableCapacities=_.map(t.data,(function(e){return r.convertCapacity(e)}))),this.model.capacity&&!_.find(this.availableCapacities,(function(e){return r.model.capacity.id.toLowerCase()===e.id.toLowerCase()}))&&(i=this.model.capacity,i.disabled=!0,this.availableCapacities.push(i)),[3,5];case 3:return o=a.sent(),[3,5];case 4:return this.isLoadingCapacities=!1,[7];case 5:return[2]}}))}))},t.prototype.convertCapacity=function(e){if(e)return{id:e.capacityObjectId,name:e.displayName}},t.prototype.displayValidationErrors=function(e){this.model.invalidEmailAddressesErrorMessage=this.model.emailsList.hasValidationError?this.model.emailsList.errorMessage:"";var t=this.arrayStringsToSeparatorTerminatedString(this.contractGroupMembersToArray(e));this.model.notExitingEmailAddressesErrorMessage=_.isEmpty(t)?"":this.services.localizationService.format("GroupEditor_Email_Address_DoNotExist",[t]),this.setEmailsListContent(t)},t.prototype.arrayStringsToSeparatorTerminatedString=function(t){var i=t.join(e.constants.emailsListSeparator).toLowerCase();return _.isEmpty(i)||_.endsWith(i,e.constants.emailsListSeparator)||(i+=e.constants.emailsListSeparator),i},t.prototype.convertMemberRole=function(e){switch(e.membershipStatus){case r.Pending:return 2;case r.Member:return 0;case r.MemberAndOwner:case r.Owner:return 1;default:return 0}},t.prototype.contractGroupMembersToArray=function(e){var t=_.map(e,(function(e){return e.userPrincipalName.toLowerCase()}));return t},t})();t.GroupEditorBaseController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.errorDetailsHelper,o=/[^a-zA-Z0-9_-]/g,r=(function(t){function r(i,o){var r=t.call(this,i,o)||this,a=new e.models.Group(null);return r.model=new e.models.GroupEditorModel(a),r.scope.$watch("this.model.emailsList.emailAddresses",(function(e,t){t!==e&&(e||(r.model.invalidEmailAddressesErrorMessage="",r.model.notExitingEmailAddressesErrorMessage=""))}),!0),r.capacityTutorialPromise=r.processCapacities(),r}return __extends(r,t),r.createOptions=function(){return{additionalServices:["domainHelperService","errorService","featureSwitchService","groupHttp","groupService","localizationService","navigation","telemetryService","modalDialogService","taskPaneSliderService","tutorialPopup"]}},r.prototype.$onDestory=function(){this.capacityTutorialPromise=null},Object.defineProperty(r.prototype,"canSave",{get:function(){return this.model.groupName&&this.model.groupId&&0===this.groupValidationStatus&&!this.isValidatingGroupId&&!this.isAddingMembers&&!this.isLoadingGroupMembers},enumerable:!0,configurable:!0}),r.prototype.save=function(){var t=this;this.isSaving=!0;var o=this.mapFromMemberModelListToMemberContractList(this.model.displayMemberList),r={displayName:this.model.groupName,mailNickname:this.model.groupId,isPublic:0===this.model.privacyOption,isReadOnly:1===this.model.accessControlOption,members:o,capacityObjectId:this.model.capacity&&this.model.isCapacityEnabled&&this.model.capacity.id},a=_.filter(r.members,(function(t){return t.membershipStatus!==e.common.contracts.GroupMembershipStatus.Member})).length,n=this.services.telemetryService,s=n.startEvent(e.telemetry.GroupEditorCreateGroup,!1,"",r.isReadOnly,a,r.members.length-a,_.filter(this.model.displayMemberList,(function(e){return 2===e.role})).length,!!r.capacityObjectId);this.services.groupHttp.addGroup(r,s.event).then((function(i){if(_.isEmpty(i.data.group.objectId))t.resetEmailsListControl(i.data.invalidMembers),s.event.info.groupCreated=!1,s.resolve();else{t.services.groupService.addGroup(i.data.group);var o=t.services.groupService.getGroup(i.data.group.objectId);t.services.groupService.switchGroup(o,!1,s),t.services.navigation.navigateToGroupWelcome(),s.event.info.groupId=i.data.group.objectId,s.event.info.groupCreated=!0,s.resolve(),t.services.rootScope.$emit(e.constants.groupAddedUpdateContextMenuEventName,i.data.group.objectId),t.services.taskPaneSliderService.collapsePane()}}),(function(e){s.reject(i.getTelemetryErrorDetails(e.error,e.status)),t.services.errorService.error(t.services.localizationService.get("GroupEditor_FailedCreateGroup_Message"),"FailedToCreateGroup",{requestId:e.requestId,statusCode:e.status.toString()})})).finally((function(){t.isSaving=!1}))},r.prototype.groupNameKeyUp=function(e){_.isEmpty(this.model.groupName)?(this.isEditingGroupId=!1,this.model.groupId="",this.groupValidationStatus=0):this.isEditingGroupId||(this.model.groupId=this.model.groupName.replace(o,"").toLowerCase(),this.checkGroupIdAvailability())},r.prototype.editGroupId=function(){this.isEditingGroupId=!0},r.prototype.hasGroupIdInvalidCharacters=function(){var e=this.model.groupId.match(o);null!==e&&(this.groupValidationStatus=3)},r.prototype.groupIdKeyUp=function(){this.groupValidationStatus=0,this.hasGroupIdInvalidCharacters(),3!==this.groupValidationStatus&&this.checkGroupIdAvailability()},r.prototype.checkGroupIdAvailability=function(){var e=this;if(!this.validateGroupIdPromise&&!_.isEmpty(this.model.groupId)&&this.model.groupId!==this.validatedGroupId){var t=this.model.groupId,i=function(){e.validateGroupIdPromise=null,e.validatedGroupId=t,e.checkGroupIdAvailability()};this.validateGroupIdPromise=this.validateGroupId(t),this.validateGroupIdPromise.then(i,i)}},r.prototype.validateGroupId=function(t){var o=this,r=this.services.telemetryService.startEvent(e.telemetry.GroupEditorValidateGroupId);this.isValidatingGroupId=!0;var a=this.services.groupHttp.validateGroupId(t,r.event);return a.then((function(e){o.groupValidationStatus=e.data?0:1,r.resolve()}),(function(e){o.groupValidationStatus=2,r.reject(i.getTelemetryErrorDetails(e.error))})).finally((function(){o.isValidatingGroupId=!1})),a},r.prototype.processCapacities=function(){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.loadCapacities()];case 1:return i.sent(),_.isEmpty(this.availableCapacities)||(this.model.capacity=_.first(this.availableCapacities),this.model.isCapacityEnabled=!0,t=e.createGroupCapacitySettingsTutorialModel(this.services.localizationService),this.services.tutorialPopup.startTutorial(t)),[2]}}))}))},r})(t.GroupEditorBaseController);t.CreateGroupBladeController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.CreateGroupBlade={controller:e.common.createController(e.controllers.CreateGroupBladeController),templateUrl:"components/groupEditor/create/createGroupBlade.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.errorDetailsHelper,o=(function(t){function o(e,i){return t.call(this,e,i)||this}return __extends(o,t),o.createOptions=function(){return{additionalServices:["domainHelperService","errorService","featureSwitchService","groupHttp","groupService","localizationService","navigation","telemetryService","modalDialogService","taskPaneSliderService","tutorialPopup"]}},o.prototype.$onInit=function(){var t=this;this.group=this.parameters.group||this.services.groupService.activeGroup,this.model=new e.models.GroupEditorModel(this.group),this.originalCapacity=this.model.capacity,this.scope.$watch("this.model.emailsList.emailAddresses",(function(e,i){i!==e&&(e||(t.model.invalidEmailAddressesErrorMessage="",t.model.notExitingEmailAddressesErrorMessage=""))}),!0),0!==this.model.privacyOption||this.model.isAdmin||(this.editNonAdmin=!0),this.oldGroupName=this.model.groupName,this.getGroupMembers(),this.loadCapacities()},Object.defineProperty(o.prototype,"canSave",{get:function(){return!this.isAddingMembers&&!this.isLoadingGroupMembers&&!this.isLoadingCapacities},enumerable:!0,configurable:!0}),o.prototype.compareGroupMemberByUserPrincipalName=function(e,t){return e.userPrincipalName>t.userPrincipalName?1:e.userPrincipalName===t.userPrincipalName?0:-1},o.prototype.prepareMemberOperations=function(e,t,i,o){for(var r=this.model.displayMemberList.sort(this.compareGroupMemberByUserPrincipalName),a=this.model.originalDisplayMemberList.sort(this.compareGroupMemberByUserPrincipalName),n=0,s=r.length,c=0,l=a.length;n<s||c<l;){var d=r[n],p=a[c],u=void 0;switch(u=void 0===d?1:void 0===p?-1:this.compareGroupMemberByUserPrincipalName(d,p)){case-1:e.push(d),n++;break;case 0:n++,c++,1===d.role&&0===p.role?i.push(d):0===d.role&&1===p.role&&o.push(d);break;case 1:t.push(p),c++}}},o.prototype.save=function(){var e=this;if(this.originalCapacity&&!this.model.isCapacityEnabled){var t=this.services.localizationService,i=this.services.errorService.control(),o=[new InJs.ModalDialogAction(t.get("GroupEditor_ConfirmRemoveCapacityButton"),function(t,o){e.saveInternal(),i.hideDialog()}),new InJs.ModalDialogAction(t.get("ModalDialogButtonText_Cancel"),function(t,o){e.model.capacity=e.originalCapacity,e.model.isCapacityEnabled=!0,i.hideDialog()})],r=t.get("GroupEditor_ConfirmRemoveCapacityTitle"),a=t.get("GroupEditor_ConfirmRemoveCapacityText"),n="<div>"+a+' <a href="https://go.microsoft.com/fwlink/?linkid=845343">'+t.get("UsersNotifications_LearnMore")+"</a></div>",s=$(n);i.showCustomDialog(r,s,o,(function(e){e.parent().find('input[value="'+t.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)}else this.saveInternal()},o.prototype.saveInternal=function(){var t=this;if(this.isSaving=!0,0===_.filter(this.model.displayMemberList,(function(e){return 1===e.role})).length){var o=this.services.errorService,r=o.control();return r.showPrompt("",this.services.localizationService.get("GroupEditor_TheOnlyAdmin_Message"),[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Ok"),function(e,t){r.hideDialog()})]),void(this.isSaving=!1)}var a=[],n=[],s=[],c=[];this.prepareMemberOperations(a,n,s,c);var l={displayName:this.oldGroupName!==this.model.groupName?this.model.groupName:"",isReadOnly:this.model.accessControlOption===this.originalAccessControlOption?null:1===this.model.accessControlOption,capacityObjectId:this.model.capacity&&this.model.isCapacityEnabled?this.model.capacity.id:null},d=_.filter(this.model.displayMemberList,(function(e){return 1===e.role})).length,p=this.services.telemetryService,u=p.startEvent(e.telemetry.GroupEditorUpdateGroup,!1,this.group.contract.objectId,l.isReadOnly,d,this.model.displayMemberList.length-d,_.filter(this.model.displayMemberList,(function(e){return 2===e.role})).length,this.originalCapacity===this.model.capacity);this.services.groupHttp.updateGroup(this.group.aadGroupId,l,this.mapFromMemberModelListToMemberContractList(a),this.mapFromMemberModelListToMemberContractList(n),this.mapFromMemberModelListToMemberContractList(s),this.mapFromMemberModelListToMemberContractList(c),u.event).then((function(i){var o=_.filter(i.data,(function(t){return t.membershipStatus!==e.common.contracts.GroupMembershipStatus.Pending}));if(o&&0===o.length){t.group.displayName=t.model.groupName,t.group.contract.isReadOnly=1===t.model.accessControlOption,t.group.capacity=t.model.capacity;var r=e.session.UserInfoUtils.getEmailAddressForReceivingMail();_.filter(n,(function(e){return e.userPrincipalName&&r&&e.userPrincipalName.toLowerCase()===r.toLowerCase()})).length>0&&(t.services.groupService.removeGroup(t.group.aadGroupId),t.services.groupService.activeGroupObjectId===t.group.aadGroupId&&t.services.navigation.navigateToGroupByGUID(e.constants.myWorkSpaceGroupId)),u.event.info.groupUpdated=!0,u.resolve(),t.services.taskPaneSliderService.collapsePane()}else u.event.info.groupUpdated=!1,u.resolve(),t.resetEmailsListControl(o)}),(function(e){u.reject(i.getTelemetryErrorDetails(e.error,e.status)),t.services.errorService.error(t.services.localizationService.get("GroupEditor_FailedUpdateGroup_Message"),"FailedToUpdateGroup",{requestId:e.requestId,statusCode:e.status.toString()})})).finally((function(){t.isSaving=!1}))},o.prototype.deleteGroup=function(){var e=this,t=this.services.localizationService,i=this.services.errorService.control(),o=[new InJs.ModalDialogAction(t.get("ModalDialogButtonText_Delete"),function(t,o){e.deleteGroupInternal(),i.hideDialog()}),new InJs.ModalDialogAction(t.get("ModalDialogButtonText_Cancel"),function(e,t){i.hideDialog()})],r=this.services.localizationService.get("GroupEditor_AreYouSureYouWantToDeleteGroup_Title"),a=this.services.localizationService.get("GroupEditor_AreYouSureYouWantToDeleteGroup_Message");i.showCustomDialog(r,$("<div/>").text(a),o,(function(t){t.parent().find('input[value="'+e.services.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)},o.prototype.deleteGroupInternal=function(){var t=this;this.isDeletingGroup=!0;var o=this.services.telemetryService,r=o.startEvent(e.telemetry.GroupEditorDeleteGroup),a=this.services.errorService.control(),n=this.services.rootScope.$new(),s={dialogName:null,scope:n,template:'<spinner></spinner><span localize="GroupEditor_WaitDeleteGroup"></span>',containerCssClass:"deleteGroup",isDismissable:!1};this.services.modalDialogService.showLegacyWebModalDialog(s),this.services.groupHttp.deleteGroup(this.group.aadGroupId,r.event).then((function(i){a.hideDialog(),r.resolve(),t.services.taskPaneSliderService.collapsePane(),t.services.groupService.removeGroup(t.group.aadGroupId),t.services.groupService.activeGroupObjectId===t.group.aadGroupId&&t.services.navigation.navigateToGroupByGUID(e.constants.myWorkSpaceGroupId)}),(function(e){r.reject(i.getTelemetryErrorDetails(e.error,e.status)),a.hideDialog(),t.services.errorService.error(t.services.localizationService.get("GroupEditor_FailedDeleteGroup_Message"),"FailedToDeleteGroup",{requestId:e.requestId,statusCode:e.status.toString()})})).finally((function(){t.isDeletingGroup=!1}))},o})(t.GroupEditorBaseController);t.EditGroupBladeController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.EditGroupBlade={controller:e.common.createController(e.controllers.EditGroupBladeController),bindings:{parameters:"<"},templateUrl:"components/groupEditor/edit/editGroupBlade.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(t){function i(e,i){return t.call(this,e,i)||this}return __extends(i,t),i.createOptions=function(){return{additionalServices:["errorService","featureSwitchService","groupHttp","groupService","localizationService","telemetryService","taskPaneSliderService"]}},i.prototype.$onInit=function(){this.group=this.parameters.group||this.services.groupService.activeGroup,this.model=new e.models.GroupEditorModel(this.group),this.getGroupMembers()},i})(t.GroupEditorBaseController);t.ViewGroupBladeController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ViewGroupBlade={controller:e.common.createController(e.controllers.ViewGroupBladeController),bindings:{parameters:"<"},templateUrl:"components/groupEditor/view/viewGroupBlade.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.services=t,this.groupService=t.groupService}return e.createOptions=function(){return{additionalServices:["groupService","navigation"]}},e.prototype.navigateToWorkspaces=function(){this.onToggled({isExpanded:!1}),this.services.navigation.navigateToWorkspaces()},e})();e.GroupSwitcherController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.GroupSwitcher={templateUrl:"components/groupSwitcher/groupSwitcher.html",controller:e.common.createController(e.controllers.GroupSwitcherController),bindings:{onToggled:"&"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.constants.TaskPaneCollapsiblePaneMode,r=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,
this.userInfo=t.userInfo,this.groupService=t.groupService,this.isExpanded=!1,this.userInfo.getUserPhoto().then((function(e){i.userPhoto=e}))}return t.createOptions=function(){return{additionalServices:["groupService","userInfo","navigation","viralTenantMergeHelperService","taskPaneSliderService","licenseEnforcementService"]}},t.prototype.$onChanges=function(e){e.canExpand&&e.canExpand.currentValue&&this.toggleGroupSwitcherPane(!0)},t.prototype.getGroups=function(){for(var e,t=[],i=this.groupService.groups,o=0,r=i.length;o<r;o++)i[o].isMyWorkspace?e=i[o]:t.push(i[o]);var a=[];a.push(e),t=_.sortBy(t,(function(e){return e.displayName}));for(var o=0,r=t.length;o<r;o++)a.push(t[o]);return a},t.prototype.isGroupSelected=function(e){return this.groupService.activeGroup&&this.groupService.activeGroup.aadGroupId===e.aadGroupId},t.prototype.switchGroup=function(t){t.aadGroupId!==this.services.groupService.activeGroupObjectId?t.isMyWorkspace||this.isGroupFeatureEnabled()?(this.services.navigation.navigateToGroupByGUID(t.aadGroupId),this.onGroupSelected&&this.onGroupSelected()):this.services.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.SwitchGroups):this.services.navigation.navigateToContentList(t.aadGroupId,!1,null,null,!1)},t.prototype.toggleGroupSwitcherPane=function(e){this.isExpanded=void 0===e?!(this.isExpanded&&this.canExpand):e,this.onToggled&&this.onToggled({isExpanded:this.isExpanded})},t.prototype.addGroup=function(){this.services.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()?this.services.viralTenantMergeHelperService.displayFeatureDisabledErrorMessage("ArchivedContent_ErrorMessageGroup"):this.isGroupFeatureEnabled()?this.services.taskPaneSliderService.expandPane(o.GroupEditorCreate,i.Large):this.services.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.CreateGroups)},t.prototype.isGroupFeatureEnabled=function(){return this.services.licenseEnforcementService.supportsGroups()},t})();t.GroupSwitcherV2Controller=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.GroupSwitcherV2={templateUrl:"components/groupSwitcherV2/groupSwitcherV2.html",controller:e.common.createController(e.controllers.GroupSwitcherV2Controller),bindings:{onGroupSelected:"&",onToggled:"&",canExpand:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.services=t}return t.createOptions=function(){return{additionalServices:["localizationService","modalDialogService"]}},t.prototype.$onInit=function(){this.titleText=this.services.localizationService.format("App_AutoInstall_AddDialogTitle",[this.app.displayText]),this.appsLink=e.constants.pbiAppsLink},t.prototype.ok=function(){this.services.modalDialogService.close(0)},t.prototype.cancel=function(){this.services.modalDialogService.close(1)},t})();t.InstallStoreAppDialogController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.InstallStoreAppDialog={templateUrl:"components/installStoreAppDialog/installStoreAppDialog.html",bindings:{app:"<"},controller:e.common.createController(e.controllers.InstallStoreAppDialogController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.telemetryService=e,this.modalDialogService=t}return t.prototype.show=function(t){var i=this,o={app:t},r={dialogName:"storeAppInstall",definitionTemplateCachePath:"components/installStoreAppDialog/installStoreAppDialogDefinition.html",bindings:o},a=this.modalDialogService.showWebModalDialog(r);return a.then((function(t){var o=0===t?e.telemetry.StoreAppInstallAction.Add:e.telemetry.StoreAppInstallAction.Cancel;i.telemetryService.logEvent(e.telemetry.AppsInstallStoreAppDialog,o)})),a},t})();t.InstallStoreAppDialogBuilder=i})(t=e.dialogs||(e.dialogs={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.services=t}return t.createOptions=function(){return{additionalServices:["$window","licenseEnforcementService","userInfo"]}},t.prototype.$onInit=function(){this.content=this.config&&this.config.content},t.prototype.upgrade=function(){return this.config&&this.config.upgradeCallback?void this.config.upgradeCallback():void this.services.$window.open("https://go.microsoft.com/fwlink/?linkid=847283","_blank")},t.prototype.startTrial=function(){return this.config&&this.config.startTrialCallback?void this.config.startTrialCallback():void this.services.licenseEnforcementService.showTrialDialog(e.telemetry.LicenseEnforcementOperation.ConnectApps)},t.prototype.showTrialButton=function(){var e=this.services.userInfo;return!e.userFreeTrialExpired&&!e.userHasFreeTrial&&!e.isPremiumUser},t})();t.InsufficientLicenseBarController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.InsufficientLicenseBar={templateUrl:"components/insufficientLicenseBar/insufficientLicenseBar.html",bindings:{config:"<?"},controller:e.common.createController(e.controllers.InsufficientLicenseBarController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.services=t,this.showIntroduceAppBar=this.services.conceptualModelSetting.isAppsEnabled()}return t.createOptions=function(){return{additionalServices:["conceptualModelSetting","localizationService"]}},t.prototype.$onInit=function(){this.title=this.config&&this.config.title?this.config.title:this.services.localizationService.get("AppModel_IntroduceApp"),this.content=this.config&&this.config.content?this.config.content:this.services.localizationService.get("AppModel_IntroduceAppDescription"),this.learnMoreText=this.config&&this.config.learnMoreText?this.config.learnMoreText:this.services.localizationService.get("AppModel_WhatAreApps"),this.learnMoreLink=this.config&&this.config.learnMoreLink?this.config.learnMoreLink:e.constants.pbiAppsLink},t.prototype.hideBar=function(){this.showIntroduceAppBar=!1,this.config&&this.config.closeBarCallback&&this.config.closeBarCallback()},t})();t.IntroduceAppBarController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.IntroduceAppBar={templateUrl:"components/introduceAppBar/introduceAppBar.html",bindings:{config:"<?"},controller:e.common.createController(e.controllers.IntroduceAppBarController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.ArrowPosition,o=e.common.models.TooltipTheme,r="AppModel_ConvertApp",a="LearnMore",n=(function(){function t(e,t){this.services=t,this.learnMoreTooltipConfig={tooltipLocalizeDescription:"LearnMore",tooltipArrowPosition:i.arrowTopMiddle,tooltipTheme:o.Dark}}return t.createOptions=function(){return{additionalServices:["$window","modalDialogService"]}},t.prototype.$onInit=function(){this.okButtonTextLocId=0===this.config.mode?a:r},t.prototype.ok=function(){this.services.modalDialogService.close(0)},t.prototype.learnMoreAboutApps=function(){this.services.$window.open(e.constants.pbiAppsLink,"_blank")},t})();t.IntroduceAppDialogController=n})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.IntroduceAppDialog={templateUrl:"components/introduceAppDialog/introduceAppDialog.html",bindings:{config:"<"},controller:e.common.createController(e.controllers.IntroduceAppDialogController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.modalDialogService=e}return e.prototype.show=function(e,t){var i={config:t},o={dialogName:e,definitionTemplateCachePath:"components/introduceAppDialog/introduceAppDialogDefinition.html",bindings:i};return this.modalDialogService.showHostModalDialog(o)},e})();e.IntroduceAppDialogBuilder=t})(t=e.dialog||(e.dialog={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["localizationService","modalDialogService"]}},e.prototype.$onInit=function(){var e=this.services.localizationService,t=_.map(this.dashboards,(function(t){return e.format("PersonalizeOrgApp_Dashboard",[t.displayName])})),i=_.map(this.models,(function(t){return e.format("PersonalizeOrgApp_Dataset",[t.displayName])})),o=_.map(this.reports,(function(t){return e.format("PersonalizeOrgApp_Report",[t.displayName])}));this.itemNames=t.concat(o).concat(i)},e.prototype.save=function(){this.services.modalDialogService.close(0)},e.prototype.cancel=function(){this.services.modalDialogService.close(1)},e})();e.MakeACopyDialogController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.MakeACopyDialog={templateUrl:"components/makeACopyDialog/makeACopyDialog.html",bindings:{titleKey:"<",messageKey:"<",itemsIntroKey:"<",dashboards:"<",reports:"<",models:"<"},controller:e.common.createController(e.controllers.MakeACopyDialogController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.modalDialogService=e}return e.prototype.show=function(e,t,i,o,r,a,n){var s={titleKey:t,messageKey:i,itemsIntroKey:o,dashboards:r,reports:a,models:n},c={dialogName:e,definitionTemplateCachePath:"components/makeACopyDialog/makeACopyDialogDefinition.html",bindings:s};return this.modalDialogService.showWebModalDialog(c)},e})();e.MakeACopyDialogBuilder=t})(t=e.dialogs||(e.dialogs={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentProviderClientCategory,o="marketplaceActive",r=1e4,a="iframe#marketplaceFrame",n="{{saasMarketplaceUrl}}",s='<iframe name="marketplaceFrame" id="marketplaceFrame" sandbox="allow-scripts allow-popups allow-forms allow-same-origin" src="'+n+'"></iframe>',c=(function(){function c(e,t){this.services=t,this.iFrameLoadedOrTimeout=!1}return c.createOptions=function(){return{additionalServices:["$element","$rootScope","$timeout","$window","activeGroupId","applicationOptions","asyncFeatureSwitchService","localizationService","navigation","telemetryService"]}},c.prototype.$onInit=function(){var t=this;this.services.asyncFeatureSwitchService.getFeatureSwitches().then((function(i){i.saasMarketplace&&(t.listener=function(e){return t.receiveMessage(e)},t.marketplaceConnectListener=t.services.rootScope.$on(e.constants.saasMarketplace.initSaasMarketplaceEventName,(function(e,i){t.marketplaceIframe||t.init(i)})))}))},c.prototype.$onDestroy=function(){this.destroyIframeListener(),this.marketplaceConnectListener&&this.marketplaceConnectListener()},c.prototype.init=function(e){var o=supportedSaasMarketplaceRedirects.split(";").map((function(e){return e.toLowerCase()})),r=this.services.navigation.stateService.params.saasMarketplace;if(r&&_.indexOf(o,r.toLowerCase())>=0?this.redirectRoot=r:this.redirectRoot=saasMarketplaceUrlOrigin,this.redirectRoot){this.marketplaceIframe=null;var a=this.services.navigation.providerName,n=t.contentProviderStore.contentProviderConstants.CategoryNameToEnumMap[this.services.navigation.categoryName],s=t.contentProviderStore.contentProviderConstants.saasMarketplacePublicCategory;n===i.Organizational&&(s=t.contentProviderStore.contentProviderConstants.saasMarketplacePrivateCategory);var c=this.services.localizationService.currentLanguageLocale,l="/embed/"+c;if(a)l+="/product/power-bi/"+a+"?product=power-bi";else if(n){var d=t.contentProviderStore.contentProviderConstants.saasMarketplacePrivateCategory;l+="/marketplace?product=power-bi&showPrivateApps="+(s===d?"true":"false")}else l+="/marketplace?product=power-bi&showPrivateApps=false";this.saasMarketplaceUrl=this.redirectRoot+l,this.hostData={},this.hostData.accessToken=window.powerBIAccessToken,this.hostData.correlationId=this.services.telemetryService.root.id,this.hostData.context={groupId:this.services.activeGroupId.headerActiveGroupObjectId};var p=this.services.applicationOptions.cpcode;p&&(this.hostData.context.cpcode=p),e===!0?this.hostData.backendUrlOverride=clusterUri+"/v1.0/orgapp":this.hostData.backendUrlOverride=clusterUri,this.connectToMarketplace()}},c.prototype.initListener=function(){this.services.$window.addEventListener("message",this.listener)},c.prototype.connectToMarketplace=function(){var e=this;this.initListener(),this.removeMarketplaceIframe();var t=$(s.replace(n,this.saasMarketplaceUrl)),i=this.services.$element;i.addClass(o).append(t);var r=i.find(a);r.load((function(){e.marketplaceIframe=r[0].contentWindow,e.postInitialMarketplaceContext()}))},c.prototype.removeMarketplaceIframe=function(){this.services.$element.find(a).remove()},c.prototype.disconnectMarketplace=function(){this.services.$element.removeClass(o),this.removeMarketplaceIframe()},c.prototype.postInitialMarketplaceContext=function(){var t=this;this.marketplaceIframe&&(this.iFrameLoadedOrTimeout=!1,this.marketplaceOpenEvent=this.services.telemetryService.startEvent(e.telemetry.MarketplaceEmbeddedOpened),this.services.$timeout((function(){!t.iFrameLoadedOrTimeout&&t.marketplaceOpenEvent&&(t.iFrameLoadedOrTimeout=!0,t.marketplaceOpenEvent.reject({errorCode:"Timeout",errorMessage:"Timeout after "+r.toString()+" ms"}))}),r),this.marketplaceIframe.postMessage({msgType:"loadMarketplace",hostData:this.hostData},"*"))},c.prototype.destroyIframeListener=function(){this.services.$window.removeEventListener("message",this.listener),this.disconnectMarketplace(),this.marketplaceIframe=null},c.prototype.receiveMessage=function(t){if(t&&t.origin&&!(this.services.$window.location.href.indexOf(t.origin)>=0)){!this.marketplaceIframe&&t.source&&(this.marketplaceIframe=t.source);var i=t.data;if(i&&i.msgType){var o=e.constants.saasMarketplace.actionTypes;switch(i.msgType){case o.acquireApp:i.data&&i.data.applicationId&&i.data.category&&(this.destroyIframeListener(),this.services.telemetryService.logEvent(e.telemetry.MarketplaceEmbeddedClosedWithAppAcquired),this.services.rootScope.$emit(e.constants.saasMarketplace.updateHostUrl,i.data.applicationId,i.data.category),this.services.rootScope.$emit(e.constants.saasMarketplace.acquireAppEventName,i.data.applicationId,i.data.category));break;case o.externalRedirect:break;case o.updateUrl:i.data&&i.data.applicationId&&i.data.category&&this.services.rootScope.$emit(e.constants.saasMarketplace.updateHostUrl,i.data.applicationId,i.data.category);break;case o.closeSaasMarketplace:this.destroyIframeListener(),this.services.telemetryService.logEvent(e.telemetry.MarketplaceEmbeddedClosedWithoutAppAcquired),this.services.navigation.showGetDataSlider();break;case o.finishedLoadingContentProviderList:!this.iFrameLoadedOrTimeout&&this.marketplaceOpenEvent&&(this.iFrameLoadedOrTimeout=!0,this.marketplaceOpenEvent.resolve())}}}},c})();t.MarketplaceHostController=c})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.MarketplaceHost={controller:e.common.createController(e.controllers.MarketplaceHostController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.NavigationPaneExpandSettingKey="NavExpanded";var i=5,o=(function(){function o(e,t){var i=this;this.shouldShowGetDataBtn=function(){i.groupService.ensureGroupsInitialization().then((function(){i.showGetDataBtn=!i.groupService.activeGroup.contract.isReadOnly||i.services.groupService.activeGroup.contract.isOwner}))},this.getExpandButtonTitle=function(){return i.isExpanded?i.services.localizationService.get("NavigationPane_Minimize"):i.services.localizationService.get("NavigationPane_Expand")},this.services=t,this.navigation=t.navigation,this.home=t.home,this.groupService=t.groupService,this.rootScope=t.rootScope,this.shouldShowGetDataBtn()}return o.createOptions=function(){return{additionalServices:["conceptualModelSetting","navigation","home","groupService","telemetryService","localizationService","$rootScope","userSettingsService","featureSwitchService"]}},o.prototype.$onInit=function(){var t=this;this.rootScope.$on(e.constants.groupSwitchedEventName,(function(){return t.shouldShowGetDataBtn()})),this.initializeIsExpanded()},o.prototype.navigateToApps=function(){this.onGroupSwitcherToggled(!1),this.services.navigation.navigateToApps()},o.prototype.navigateToFavorites=function(){this.onGroupSwitcherToggled(!1),this.services.navigation.navigateToFavorites()},o.prototype.navigateToRecentlyViewed=function(){this.onGroupSwitcherToggled(!1),this.services.navigation.navigateToRecentlyViewed()},o.prototype.navigateToOnlySharedWithMe=function(){this.onGroupSwitcherToggled(!1),this.services.navigation.navigateToSharedWithMe()},o.prototype.navigateToGetData=function(){this.onGroupSwitcherToggled(!1),this.services.telemetryService.logEvent(e.telemetry.DashboardOpenGetDataPage,e.telemetry.OpenGetDataPageInteraction.NavigatorPaneAddDatasetButton),this.services.navigation.showGetDataSlider()},o.prototype.navigateToWorkspaces=function(){this.onGroupSwitcherToggled(!1),this.services.navigation.navigateToWorkspaces()},o.prototype.isOnApps=function(){return this.services.navigation.inAppsView()},o.prototype.isOnFavorites=function(){return this.services.navigation.inFavoritesView()},o.prototype.isOnRecentlyViewed=function(){return this.services.navigation.inRecentlyViewedView()},o.prototype.isOnSharedWithMe=function(){return this.services.navigation.inSharedWithMePath()},o.prototype.isOnWorkspace=function(){return!(this.isOnSharedWithMe()||this.isOnRecentlyViewed()||this.isOnFavorites()||this.isOnApps()||this.isOnWorkspaces())},o.prototype.isOnWorkspaces=function(){return this.services.navigation.inWorkspacesView()},o.prototype.isAppsEnabled=function(){return this.services.conceptualModelSetting.isAppsEnabled()},o.prototype.onToggleClicked=function(){this.toggleNavigationPane(),this.onGroupSwitcherToggled(!1);var i=this.services.telemetryService.startEvent(e.telemetry.NavigationToggle,this.isExpanded);this.services.userSettingsService.updateExtendedSettings(t.NavigationPaneExpandSettingKey,this.isExpanded,i)},o.prototype.onGroupSwitcherToggled=function(e){void 0===e&&(e=!this.isGroupSwitcherExpanded),this.isGroupSwitcherExpanded=e,e&&!this.isExpanded&&this.toggleNavigationPane(!0)},Object.defineProperty(o.prototype,"shouldShowLargeGroupList",{get:function(){return this.groupService.groups.length>i},enumerable:!0,configurable:!0}),o.prototype.toggleNavigationPane=function(e){this.isExpanded=void 0===e?!this.isExpanded:e;var t={isExpanded:this.isExpanded};this.onToggled&&this.onToggled(t)},o.prototype.initializeIsExpanded=function(){var e=this,i=this.services.navigation.collapseNavigation;void 0!==i?(this.isExpanded="true"!==i.toLowerCase(),this.toggleNavigationPane(this.isExpanded)):this.services.userSettingsService.getExtendedSettingByKey(t.NavigationPaneExpandSettingKey).then((function(t){null!=t&&_.isBoolean(t)&&(e.isExpanded=t),e.toggleNavigationPane(e.isExpanded)}))},o})();t.NavigationPaneV2Controller=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.NavigationPaneV2={templateUrl:"components/navigationPaneV2/navigationPaneV2.html",controller:e.common.createController(e.controllers.NavigationPaneV2Controller),bindings:{onToggled:"&",isExpanded:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.factory.ArtifactSortPredicates,o=e.helpers.ContentTileHelper,r=5,a=(function(){function e(e,t){this.services=t,this.oldExpandedState=!1,this.isExpanded=!1,this.items=[],this.showRecent=!0,this.sortPredicate=i.TitleAlphabeticalPredicate}return e.createOptions=function(){return{additionalServices:["contentList","favorites","groupService","mostRecentlyUsedService"]}},e.prototype.$onInit=function(){var e=this;this.showRecent||(this.favoritesListener={onFavoriteAdded:void 0,onFavoriteDeleted:void 0,onFavoritesReset:function(){return e.loadFavorites()}},this.services.favorites.subscribe(this.favoritesListener))},e.prototype.$onDestroy=function(){this.favoritesListener&&this.services.favorites.unsubscribe(this.favoritesListener)},e.prototype.openContent=function(e){o.openContentTile(e,this.services.groupService,this.services.contentList),this.isExpanded=!1},e.prototype.mouseDownToggle=function(){this.oldExpandedState=this.isExpanded},e.prototype.navigateToArea=function(){this.isExpanded=!1,this.navigateTo()},e.prototype.toggleFlyout=function(){this.oldExpandedState||(this.showRecent?this.loadRecents():this.loadFavorites(),this.isExpanded=!0)},e.prototype.getActualType=function(e){return o.getActualType(e)},e.prototype.loadFavorites=function(){var e=this,t=this.services.favorites.favoritesCache;t&&(this.items=_(t).sortBy((function(t){return t.hasOwnProperty(e.sortPredicate.columnName)?t[e.sortPredicate.columnName].toLocaleLowerCase():""})).take(r).value())},e.prototype.loadRecents=function(){var e=this;this.services.mostRecentlyUsedService.getMRUModels().then((function(t){e.items=_(t).take(r).value()}))},e})();t.NavPaneFlyoutButtonController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.NavPaneFlyoutButton={templateUrl:"components/navPaneFlyoutButton/navPaneFlyoutButton.html",controller:e.common.createController(e.controllers.NavPaneFlyoutButtonController),bindings:{icon:"@",label:"@",navigateTo:"&",onToggled:"&",showRecent:"<?"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["modalDialogService"]}},e.prototype.ok=function(){this.services.modalDialogService.close(0)},e.prototype.close=function(){this.services.modalDialogService.close(1)},e})();e.PopupNotificationDialogController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.PopupNotificationDialog={templateUrl:"components/popupNotificationDialog/popupNotificationDialog.html",bindings:{config:"<"},controller:e.common.createController(e.controllers.PopupNotificationDialogController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.modalDialogService=e}return e.prototype.show=function(e,t){var i={config:t},o={dialogName:e,definitionTemplateCachePath:"components/popupNotificationDialog/popupNotificationDialogDefinition.html",bindings:i};return this.modalDialogService.showHostModalDialog(o)},e})();e.PopupNotificationDialogBuilder=t})(t=e.dialog||(e.dialog={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.imageLoaded=!1,this.scope.$watch((function(){return i.source}),(function(e){e&&!i.disableAnimation&&(i.imageLoaded=!1)}))}return t.createOptions=function(){return{additionalServices:["localizationService"]}},t.prototype.onLoad=function(){this.imageLoaded=!0},t.prototype.onError=function(){this.scope.$emit(e.common.constants.tileErrorEventName,this.services.localizationService.get("Tile_ErrorText"))},t})();t.PrintableImageController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.PrintableImage={controller:e.common.createController(e.controllers.PrintableImageController),bindings:{source:"@",disableAnimation:"<?"},templateUrl:"components/printableImage/printableImage.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.localizationService=t.localizationService}return e.createOptions=function(){return{additionalServices:["localizationService"]}},e.prototype.$onInit=function(){this.tabs=[{icon:"favoritestar",title:this.localizationService.get("Favorites_NavPaneTitle"),text:this.localizationService.get("PreviewFeaturesModal_Favorites_Description"),learnMoreUrl:"https://go.microsoft.com/fwlink/?LinkId=798640"},{icon:"collections",title:this.localizationService.get("PreviewFeaturesModal_ContentView"),text:this.localizationService.get("PreviewFeaturesModal_ContentView_Description"),learnMoreUrl:"https://go.microsoft.com/fwlink/?LinkId=798641"},{icon:"database",title:this.localizationService.get("NavigationPane_ManageDatasets"),text:this.localizationService.get("PreviewFeaturesModal_ManageDatasets_Description"),learnMoreUrl:"https://go.microsoft.com/fwlink/?LinkId=798642"}],this.activeTab=_.first(this.tabs)},e.prototype.selectTab=function(e){this.activeTab=e},e.prototype.isTabSelected=function(e){return this.activeTab.icon===e.icon},e})();e.PreviewFeaturesModalController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.PreviewFeaturesModal={templateUrl:"components/previewFeaturesModal/previewFeaturesModal.html",controller:e.common.createController(e.controllers.PreviewFeaturesModalController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.PreviewFeedbackModal={templateUrl:"components/previewFeedbackModal/previewFeedbackModal.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){e.ProgressDialog={templateUrl:"components/progressDialog/progressDialog.html",bindings:{titleKey:"<",messageKey:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.modalDialogService=e,this.promiseFactory=t}return e.prototype.show=function(e,t,i){var o={titleKey:t,messageKey:i},r=this.promiseFactory.defer(),a={dialogName:e,definitionTemplateCachePath:"components/progressDialog/progressDialogDefinition.html",bindings:o,onDialogDisplayed:r,isDismissable:!1};return this.modalDialogService.showWebModalDialog(a),r.promise},e.prototype.hide=function(){this.modalDialogService.close(void 0)},e})();e.ProgressDialogBuilder=t})(t=e.dialogs||(e.dialogs={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.$scope=e,this.services=t,this.paneExpanded=!1,this.dashboardsExpanded=!0,this.reportsExpanded=!0,this.workbooksExpanded=!0,this.datasetsExpanded=!0,this.isInitialized=!1,this.groupService=t.groupService,this.navigation=t.navigation}return t.createOptions=function(){return{additionalServices:["contentList","groupService","localizationService","navigation","navigationActions","ownership","promiseFactory","quota","permissionService","usageMetricsReport"]}},Object.defineProperty(t.prototype,"isActiveWorkspaceReadOnly",{get:function(){return this.services.permissionService.isActiveWorkspaceIsReadOnly},enumerable:!0,configurable:!0}),t.prototype.openItem=function(e){this.closeMenus(),this.services.contentList.openContent(e,this.services.navigation.currentGroupGUID)},t.prototype.openModel=function(e){this.closeMenus(),this.services.navigationActions.openModel(e)},t.prototype.togglePane=function(){this.paneExpanded=!this.paneExpanded,this.paneExpanded&&!this.isInitialized&&this.initialize()},t.prototype.toggleDashboards=function(){this.dashboardsExpanded=!this.dashboardsExpanded},t.prototype.toggleReports=function(){this.reportsExpanded=!this.reportsExpanded},t.prototype.toggleWorkbooks=function(){this.workbooksExpanded=!this.workbooksExpanded},t.prototype.toggleDatasets=function(){this.datasetsExpanded=!this.datasetsExpanded},t.prototype.navigateToContentList=function(){this.closeMenus(),this.services.navigation.navigateToContentList(this.groupService.activeGroupObjectId,!1,null,null,!1)},t.prototype.initialize=function(){var t=this;this.updateCurrentObject(),this.updateObjects(),this.services.navigationActions.initialize(),this.reportListener=this.services.contentList.subscribeReports((function(){return t.updateState()})),this.dashboardListener=this.services.contentList.subscribeDashboards((function(){return t.updateState()})),this.modelListener=this.services.contentList.subscribeModels((function(){return t.updateState()})),this.workbookListener=this.services.contentList.subscribeWorkbooks((function(){return t.updateState()})),this.$scope.$root.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,i,o,r,a){return t.updateCurrentObject()})),this.$scope.$root.$on(e.constants.groupSwitchedEventName,(function(){t.updateCurrentObject(),t.updateObjects()})),this.isInitialized=!0},t.prototype.$onDestroy=function(){this.unregisterListeners()},t.prototype.updateState=function(){this.updateObjects(),this.updateCurrentObject()},t.prototype.unregisterListeners=function(){this.isInitialized&&(this.services.contentList.unsubscribeReports(this.reportListener),this.services.contentList.unsubscribeDashboards(this.dashboardListener),this.services.contentList.unsubscribeModels(this.modelListener),this.services.contentList.unsubscribeWorkbooks(this.workbookListener))},t.prototype.updateCurrentObject=function(){this.services.navigation.inDashboardView()?this.currentObjectId=this.services.navigation.currentDashboardGUID:this.services.navigation.inWorkbookView()?this.currentObjectId=this.services.navigation.currentWorkbookURLIdentifier:this.services.navigation.inReportView()?this.currentObjectId=this.services.navigation.currentReportGUID:this.services.navigation.inDatasetView()?this.currentObjectId=this.services.navigation.currentDatasetDBName:this.currentObjectId=null},t.prototype.updateObjects=function(){this.updateDashboards(),this.updateDatasets(),this.updateReports(),this.updateWorkbooks()},t.prototype.updateReports=function(){var e=this;this.services.contentList.getReports().then((function(t){return e.reports=e.filterItems(t)}))},t.prototype.updateDashboards=function(){var e=this;this.services.contentList.getDashboards().then((function(t){return e.dashboards=e.filterItems(t)}))},t.prototype.updateDatasets=function(){var e=this;this.services.contentList.getDatasets().then((function(t){return e.datasets=e.filterItems(t)}))},t.prototype.updateWorkbooks=function(){var e=this;this.services.contentList.getWorkbooks().then((function(t){return e.workbooks=e.filterItems(t)}))},t.prototype.filterItems=function(t){var i=this;return _(t).filter((function(t){return i.services.contentList.isPackageReadyToUse(t)&&(t.contentTileType===e.common.contracts.ContentTileType.Dataset||!i.services.ownership.isResourceSharedWithMe(t))&&i.services.contentList.isVisible(t)&&!i.services.usageMetricsReport.contentTileBelongsToUsageMetricsContentPack(t)})).sortBy((function(e){return e.displayName.toLocaleLowerCase()})).value()},t})();t.QuickAccessPaneController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.QuickAccessPane={templateUrl:"components/quickAccessPane/quickAccessPane.html",controller:e.common.createController(e.controllers.QuickAccessPaneController),bindings:{selected:"<",closeMenus:"&"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.models.CollapsiblePaneExpandedWidth,r=e.common.constants.TaskPaneCollapsiblePaneMode;!(function(e){e[e.SelectDataset=0]="SelectDataset",e[e.VisualizationDesign=1]="VisualizationDesign"})(i=t.ConfigLevel||(t.ConfigLevel={}));var a=(function(){function e(e,t){var o=this;this.scope=e,this.services=t;var r=this.services.modelService,a=this.services.dashboardService.getSelectedDashboardTile();if(a){this.selectedTile=a.tileModel,r.modelsPromise.then((function(){o.models=r.streamingModels}));var n=this.selectedTile.realTime.config.$visualContainer.config.singleVisual;this.stage=n?i.VisualizationDesign:i.SelectDataset}}return e.createOptions=function(){return{additionalServices:["dashboardService","localizationService","modelConverter","modelService","navigation","taskPaneSliderService"]
}},e.prototype.navigateToManageDatasets=function(e){var t=e?1:0;this.services.navigation.navigateToStreamingDatasets(t)},e.prototype.next=function(){this.stage===i.VisualizationDesign?this.services.taskPaneSliderService.expandPane(r.TileEditor,o.Large):this.stage++},e.prototype.prev=function(){this.stage===i.SelectDataset?this.services.taskPaneSliderService.expandPane(r.TileGallery,o.Large):(this.clearSelectedTileModel(),this.stage--)},e.prototype.nextValid=function(){return this.stage===i.SelectDataset?null!=this.selectedModel:this.stage===i.VisualizationDesign?!this.hasVisualConfigError&&null!=this.selectedTile.realTime.singleVisualConfig:void 0},e.prototype.cancel=function(){this.services.dashboardService.removeTemporaryTile(this.selectedTile),this.services.taskPaneSliderService.collapsePane()},e.prototype.selectModel=function(e){this.selectedModel&&this.selectedTile&&this.selectedTile.realTime.unsubscribe(),this.selectedModel=e,this.selectedTile.realTime.setModelId(e.id)},e.prototype.getBreadCrumb=function(){var e=this.services.localizationService,t=jsCommon.StringExtensions.format,o=e.get("Realtime_AddStreamingDataSubTitle"),r=e.get("BreadCrumb_Separator");if(this.stage===i.VisualizationDesign){var a=e.get("Realtime_VisualizationDesign");o=t("{0} {1} {2}",o,r,a)}return o},e.prototype.clearSelectedTileModel=function(){var e=this.selectedTile,t=e&&e.realTime;t&&(e.realTime=this.services.modelConverter.convertRealTimeTile(e.contract),e.realTime.copyRealTimeModelDependencies(t),e.realTime.hideVisual=!0)},e})();t.RealTimeBladeController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.RealTimeBlade={controller:e.common.createController(e.controllers.RealTimeBladeController),templateUrl:"components/realTimeBlade/realTimeBlade.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.contracts.TileType,o=(function(){function t(e,t){this.services=t,this.scope=e}return t.createOptions=function(){return{additionalServices:["dataProxy","realTimeData","conceptualSchemaProxy","telemetryService","modelService"],scopedDependencies:["visualQueryGenerator"]}},t.prototype.$onInit=function(){var e=this,t=this.services;this.viewModel.setRealTimeModelDependencies(t.dataProxy,t.visualQueryGenerator,t.conceptualSchemaProxy,t.realTimeData,t.modelService),this.viewModel.onErrorDelegate=function(){return e.onErrorChanged()},this.viewModel.initialize()},t.prototype.$onDestroy=function(){var e=this.services,t=e.realTimeData,i=this.viewModel;i&&i.realTimeModelId&&t.unsubscribe(i.realTimeModelId,i)},t.prototype.onErrorChanged=function(){var t=this.viewModel;t&&(t.isError?(this.services.telemetryService.logEvent(e.telemetry.DashboardTileError,i[i.realTime],t.errorText),this.scope.$emit(e.common.constants.tileErrorEventName,t.errorText,t.errorDetails)):this.scope.$emit(e.common.constants.clearTileErrorEventName))},t})();t.RealTimeTileController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.RealTimeTile={bindings:{viewModel:"="},controller:e.common.createController(e.controllers.RealTimeTileController),templateUrl:"components/realTimeTile/realTimeTile.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.data.DataViewObjectDefinitions,o=e.dataServices.constants.SingleValueRealTimeWindow,r=e.dataServices.constants.MultipleValueRealTimeWindow,a=e.dataServices.constants.RealTimeIntervals,n=e.explore.viewModels.FieldWellViewModelFactory,s=e.visuals.plugins,c=e.explore.util.PropertyPaneUtils,l=e.visuals.StandardObjectProperties,d=e.data.SQExprBuilder,p=e.models.factory.TileOptionsFactory,u=e.dataServices.TileUtils,v=e.explore.viewModels.ViewModelFactory,h=e.explore.util.VisualContainerUtils,g="labelDisplayUnits",m="labelPrecision",f="labels",y=10,b=[s.card,s.realTimeLineChart,s.clusteredBarChart,s.clusteredColumnChart,s.gauge],S=[s.realTimeLineChart,s.clusteredBarChart,s.clusteredColumnChart],w=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.supportedVisualTypes=v.getAvailableVisualTypes(b),this.times=a,this.timeLabels=this.getTimeLabels(),this.maxPrecisionValue=y,this.onRoleBucketEntryChanged=function(e){i.updateRoleBucketEntries(e)}}return t.createOptions=function(){return{additionalServices:["aggrOps","featureSwitchService","geoTaggingAnalyzerService","localizationService","modelMerger","promiseFactory","visualPlugin","telemetryService"],scopedDependencies:["pinVisual","visualQueryGenerator"],scopedServiceRoot:!0}},t.prototype.$onInit=function(){var t=this,i=this.tile.realTime.singleVisualConfig,o=i&&i.visualType;this.activeVisual=this.getActiveVisualType(o);var r=this.services;this.visualAuthoringService=e.explore.services.createVisualAuthoringCore(r.visualPlugin,r.geoTaggingAnalyzerService,r.aggrOps,r.featureSwitchService);var a=this.scope.$watch("$ctrl.tile.realTime.schema",(function(e,i,o){e&&(t.setUpVisualOptions(),a())}))},t.prototype.onVisualChanged=function(){this.clearRealTimeTile();var e=!1;!this.originalSourceContext&&this.tile.realTime.singleVisualConfig&&this.saveVisualConfig(),this.originalSourceContext&&(this.activeVisual.plugin.name===this.originalSourceContext.visualType?(this.restoreVisualConfig(),this.tile.realTime.hideVisual=!1):(this.releaseAllBoundProperties(),this.shouldCreateNewVisual=!0,e=!0)),this.setUpVisualOptions(e)},t.prototype.activateTab=function(e){this.activeTab=e},t.prototype.setUpVisualOptions=function(e){void 0===e&&(e=!1),this.showCardFormattingOptions?this.setUpCardFormattingOptions():this.setUpChartOptions(e),this.setUpRoleBuckets(e)},t.prototype.properties=function(){if(this.conceptualProperties)return this.conceptualProperties;var t=this.tile&&this.tile.realTime.schema;if(t){var i=t.schema(e.dataServices.constants.RealTimeDataSourceName).entities,o=i[0].properties;return this.conceptualProperties=_.map(o,(function(e){return _.extend(e,{value:e.name,isHidden:!1})})),this.conceptualProperties}},t.prototype.updateRoleBucketEntries=function(e){if(e){var t=this.selectedRoleEntry.selectedProperty,i=this.tryAuthorVisualConfig(e,t);if(!i)return this.selectedRoleEntry.hasError=!0,void(this.hasErrors=!0);var o=this.tile.realTime.singleVisualConfig;this.originalSourceContext&&(o.conversionSourceContext=this.originalSourceContext),this.tile.realTime.hideVisual=!1,this.updateRealTimeTile();var r=this.selectedRoleBucket;this.releaseBoundProperty(t,r),this.bindAvailableProperty(e,r),this.disableDeleteRolePropertyButton=this.disableDeletePropertyButton(),this.selectedRoleEntry.hasError=!1,this.hasErrors=this.hasRoleEntryErrors()}},t.prototype.addNewRoleProperty=function(e){var t=this.getAvailableRoleProperties(e);_.isEmpty(t)||e.roleEntries.push({selectedProperty:null})},t.prototype.deleteRoleProperty=function(e,t){_.pull(t.roleEntries,e);var i=e.selectedProperty;if(!i)return e.hasError=!0,!1;this.releaseBoundProperty(i,t);var o=this.tile.realTime.singleVisualConfig,r=this.removeProjection(o,i,t.role);return r?(e.hasError=!1,this.updateRealTimeTile(),this.originalSourceContext&&(o.conversionSourceContext=this.originalSourceContext)):e.hasError=!0,this.disableDeleteRolePropertyButton=this.disableDeletePropertyButton(),this.hasErrors=this.hasRoleEntryErrors(),r},t.prototype.clickedEntry=function(e,t){this.selectedRoleEntry=e,this.selectedRoleBucket=t},t.prototype.enableAddMoreButton=function(e){var t=this;if(_.isEmpty(this.getAvailableRoleProperties(e)))return!1;var i=e.roleEntries.length,o=e.roleProperties.length;if(i===o)return!1;if(_.any(e.roleEntries,(function(e){return!e.selectedProperty})))return!1;var r=this.getValidMappingConditions();if(_.isEmpty(r))return!1;var a=e.role,n=_.find(this.getRoleEntryCounts(),{roleName:a}).roleCount,s=n+1;return _.some(r,(function(e){return t.satisfiesCondition(s,e[a])}))},t.prototype.updateRealTimeTile=function(){var e=this.tile.realTime.singleVisualConfig;if(e){var t=this.services;u.UpdateRealTimeTile(this.tile,e,this.getTimeWindow(),this.model,this.tile.realTime.schema,t.pinVisual,t.visualPlugin,t.visualQueryGenerator,t.telemetryService)}},t.prototype.updateCardFormatting=function(e){void 0===e&&(e=!0);var t=this.tile.realTime.singleVisualConfig;if(t){t.objects||(t.objects={});var o=i.ensure(t.objects,f,null),r=this.config.displayUnit;o.properties[g]=i.encodePropertyValue(r.value,r.type);var a=this.config.precision||0;o.properties[m]=i.encodePropertyValue(a,l.labelPrecision.type),e&&this.updateRealTimeTile()}},Object.defineProperty(t.prototype,"showCardFormattingOptions",{get:function(){return this.activeVisual&&this.activeVisual.plugin===s.card},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"showTimeWindow",{get:function(){return this.activeVisual&&_.contains(S,this.activeVisual.plugin)},enumerable:!0,configurable:!0}),t.prototype.disableDeletePropertyButton=function(){for(var e=[],t=0,i=this.roleBuckets;t<i.length;t++){var o=i[t];e.push.apply(e,this.getBoundRoleProperties(o))}return 1===e.length},t.prototype.getBoundRoleProperties=function(e){return _.filter(e.roleProperties,{isHidden:!0})},t.prototype.getAvailableRoleProperties=function(e){return _.filter(e.roleProperties,{isHidden:!1})},t.prototype.setUpRoleBuckets=function(e){var t=this;void 0===e&&(e=!1);var i=this.activeVisual,o=h.getDataRolesForVisualPlugin(i.plugin),r=n.createEmptyBuckets(o);this.roleBuckets=[];for(var a=this.tile.realTime.singleVisualConfig,s=a&&a.query&&a.query.projections,c=function(i,a){var n=o[i],c=_.filter(l.properties(),(function(e){return t.isPropertyCompatible(e,n)})),d=_.assign({},r[i],{roleProperties:_.cloneDeep(c),roleEntries:[]});if(null!=s&&!e){var p=s[n.name]&&s[n.name].all();if(null!=p)for(var u=0,v=p;u<v.length;u++){var h=v[u],g=l.getProjectionName(h);l.bindAvailableProperty(g,d),d.roleEntries.push({selectedProperty:g})}}l.roleBuckets.push(d)},l=this,d=0,p=o.length;d<p;d++)c(d,p);this.disableDeleteRolePropertyButton=this.disableDeletePropertyButton()},t.prototype.isPropertyCompatible=function(t,i){var o=t.kind;if(i.kind===e.VisualDataRoleKind.Grouping&&1===o)return!1;if(i.kind===e.VisualDataRoleKind.Measure&&0===o)return!1;var r=i.requiredTypes;return!(!_.isEmpty(r)&&!e.ValueType.isCompatibleTo(t.type,r))},t.prototype.tryAuthorVisualConfig=function(t,i){var o=this.activeVisual;if(o){var r=this.tile.realTime.schema,a=_.first(r.schema(e.dataServices.constants.RealTimeDataSourceName).entities),n=this.selectedRoleBucket,s=n.role,c=this.buildExpr(t,a.name,n),l=this.tile.realTime.singleVisualConfig;return this.shouldCreateNewVisual||!l?this.createNewVisualConfig({addExpr:c,schema:r,targetRole:s,visualType:this.activeVisual.plugin.name}):this.updateVisualConfig({addExpr:c,removePropName:i,schema:r,targetRole:s,singleVisual:l})}},t.prototype.hasRoleEntryErrors=function(){for(var e=0,t=this.roleBuckets;e<t.length;e++){var i=t[e];if(_.any(i.roleEntries,{hasError:!0}))return!0}return!1},t.prototype.createNewVisualConfig=function(e){var t=this.visualAuthoringService.create({visualType:e.visualType,schema:e.schema,expr:e.addExpr,targetRole:e.targetRole});return!(!t||!t.singleVisual)&&(this.tile.realTime.singleVisualConfig=t.singleVisual,this.shouldCreateNewVisual=!1,this.showCardFormattingOptions&&this.updateCardFormatting(!1),!0)},t.prototype.updateVisualConfig=function(e){if(e.removePropName){var t=this.removeProjection(e.singleVisual,e.removePropName,e.targetRole);if(!t)return!1}return this.visualAuthoringService.add({schema:e.schema,expr:e.addExpr,targetRole:e.targetRole},{singleVisual:e.singleVisual})},t.prototype.buildExpr=function(t,i,o){var r=null,a=this.getProperty(t,o.roleProperties);if(!a)return r;var n=a.kind,s=0===n?d.columnRef:d.measureRef,c=d.entity(e.dataServices.constants.RealTimeDataSourceName,i);return r=s(c,t)},t.prototype.getProperty=function(e,t){return _.find(t,{value:e})},t.prototype.releaseAllBoundProperties=function(){for(var e=0,t=this.conceptualProperties;e<t.length;e++){var i=t[e];i.isHidden=!1}},t.prototype.releaseBoundProperty=function(e,t){var i=this.getProperty(e,t.roleProperties);null!=i&&(i.isHidden=!1)},t.prototype.bindAvailableProperty=function(e,t){var i=this.getProperty(e,t.roleProperties);i&&(i.isHidden=!0)},t.prototype.satisfiesCondition=function(e,t){var i=1/0,o=t&&t.max;return _.isNumber(o)&&(i=o),e<=i},t.prototype.getValidMappingConditions=function(){for(var e=this.activeVisual.plugin.name,t=this.getDataViewMappingConditions(e),i=this.getRoleEntryCounts(),o=[],r=0,a=t;r<a.length;r++){for(var n=a[r],s=!0,c=0,l=i;c<l.length;c++){var d=l[c],p=n[d.roleName];if(!this.satisfiesCondition(d.roleCount,p)){s=!1;break}}s&&o.push(n)}return o},t.prototype.getDataViewMappingConditions=function(e){var t=this.services.visualPlugin.capabilities(e),i=t.dataViewMappings[0];return i.conditions},t.prototype.getRoleEntryCounts=function(){for(var e=[],t=0,i=this.roleBuckets;t<i.length;t++){var o=i[t];e.push({roleName:o.role,roleCount:o.roleEntries.length})}return e},t.prototype.getTimeWindow=function(){var e=this.config,t=e&&e.timeWindow,i=e&&e.timeWindowGranularityOption&&e.timeWindowGranularityOption.timeWindow,r=this.getActiveVisualDataWindow();if(!t||!i)return r;switch(i){case 2:r=60*t*1e3;break;case 1:r=1e3*t;break;default:r=o}return r},t.prototype.getActiveVisualDataWindow=function(){var e=_.contains(S,this.activeVisual.plugin)?r:o;return e},t.prototype.getActiveVisualType=function(e){var t=_.find(this.supportedVisualTypes,(function(t){return t.plugin.name===e}));return t||(t=this.supportedVisualTypes[0]),t},t.prototype.setUpChartOptions=function(e){var t=this.tile.realTime.config,i=t&&t.dataWindow;!e&&i||(i=this.getActiveVisualDataWindow());var o,r=i/1e3,a=!1;r<60?o={timeWindow:r,timeWindowGranularityOption:_.find(this.timeLabels,(function(e){return 1===e.timeWindow}))}:r<=3600?o={timeWindow:r/60,timeWindowGranularityOption:_.find(this.timeLabels,(function(e){return 2===e.timeWindow}))}:(o={timeWindow:60,timeWindowGranularityOption:_.find(this.timeLabels,(function(e){return 2===e.timeWindow}))},a=!0),this.config=o,a&&this.updateRealTimeTile()},t.prototype.setUpCardFormattingOptions=function(){if(_.isEmpty(this.tabs)&&(this.tabs=p.realTimeConfigTabs(),this.activeTab=this.tabs[0]),!this.config||!this.config.displayUnit){var e=c.getDisplayUnits(),t=c.getDisplayNames(e);this.displayUnits=_.map(t,(function(e){return _.extend(e,{type:l.labelDisplayUnits.type})}));var i=this.displayUnits[0],o=0;this.config={displayUnit:i,precision:o}}var r=this.tile.realTime.singleVisualConfig,a=r&&r.objects,n=a&&a[f]&&a[f][0].properties;if(n){var s=n[g],d=s&&s.value,i=_.find(this.displayUnits,{value:""+d});i&&(this.config.displayUnit=i),s=n[m],this.config.precision=s&&s.value}},t.prototype.getTimeLabels=function(){var e=this.services.localizationService;return[{timeWindow:1,value:e.get("Realtime_SecondsInterval")},{timeWindow:2,value:e.get("Realtime_MinutesInterval")}]},t.prototype.saveVisualConfig=function(){var e=this.tile.realTime.singleVisualConfig;e&&(this.originalSourceContext={objects:e.objects,query:e.query,visualType:e.visualType})},t.prototype.restoreVisualConfig=function(){var e=this.tile.realTime.singleVisualConfig,t=this.originalSourceContext;e&&t&&(e.visualType=t.visualType,e.query=t.query,e.objects=t.objects,this.updateRealTimeTile())},t.prototype.removeProjection=function(e,t,i){var o=this,r=e&&e.query&&e.query.projections&&e.query.projections[i].all();if(_.isEmpty(r))return!1;var a=_.findIndex(r,(function(e){return o.getProjectionName(e)===t}));return a!==-1&&this.visualAuthoringService.remove({index:a,role:i},{singleVisual:e})},t.prototype.getProjectionName=function(t){var i=t&&t.queryRef;if(i)return e.data.tabular.normalizedName(i)},t.prototype.clearRealTimeTile=function(){this.tile.realTime.hideVisual=!0;var e=this.tile.config.realTimeVisual;e.heading1=null,e.heading2=null,e.heading3=null},t})();t.RealTimeTileVisualizationDesignController=w})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.RealTimeTileVisualizationDesign={bindings:{tile:"<",model:"<",hasErrors:"="},controller:e.common.createController(e.controllers.RealTimeTileVisualizationDesignController),templateUrl:"components/realTimeTileVisualizationDesign/realTimeTileVisualizationDesign.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.factory.ArtifactSortPredicates,o=e.models.ContentListGalleryViewModel,r=e.telemetry.SelectSort,a=20,n=(function(){function t(t,r){var n=this;this.services=r,this.recentlyUsedArtifacts=[],this.sortPredicateMap={},this.filteredRecentlyUsedArtifacts=[],this.searchText="",this.sortPredicate=i.LastAccessReverseDatePredicate,this.showWatermarkConfig=!1,this.selectSort=function(t){n.sortPredicate=t;var i=n.sortPredicateMap[t.toAngularFilter()];n.services.telemetryService.logEvent(e.telemetry.ContentListSelectSort,i),n.updateRecentlyUsedArtifacts()},this.services.mostRecentlyUsedService.getMRUModels().then((function(t){for(var i=Math.min(t.length,a),o=function(i){var o=t[i];o.displayDoNotExistDialogAndRemove=function(){var t=n.getArtifactLocStringValue(o.type);e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog(t,n.services.errorService,n.services.localizationService,n.services.telemetryService),n.services.mostRecentlyUsedService.removeMRU(o.objectId,o.workspaceId),_.remove(n.recentlyUsedArtifacts,(function(e){return e.objectId===o.objectId&&e.workspaceId===o.workspaceId})),n.updateRecentlyUsedArtifacts()},n.recentlyUsedArtifacts.push(o)},r=0;r<i;r++)o(r);n.filteredRecentlyUsedArtifacts=n.recentlyUsedArtifacts,n.updateRecentlyUsedArtifacts()})),this.galleryViewModel=new o,this.galleryViewModel.getTiles=function(){return n.filteredRecentlyUsedArtifacts},this.galleryViewModel.tabType=16,this.galleryViewModel.finishLoadEvent=e.constants.contentListRecentlyUsedLoadedEvent,this.dataClassificationEnabled=!1,this.sortPredicates=e.models.factory.SelectTileSortItemsFactory.createPredicates(this.services.localizationService,16)}return t.createOptions=function(){return{additionalServices:["dataClassificationService","errorService","localizationService","mostRecentlyUsedService","telemetryService"]}},t.prototype.$onInit=function(){this.sortPredicateMap=(e={},e[i.TitleAlphabeticalPredicate.toAngularFilter()]=r.TitleAlpabetical,e[i.TitleReverseAlphabeticalPredicate.toAngularFilter()]=r.TitleReverseAlphabetical,e[i.LastAccessReverseDatePredicate.toAngularFilter()]=r.LastAccessReverseDate,e),this.emptySearchWatermarkConfig={canEdit:!0,mode:!1,contentNonShared:this.services.localizationService.get("ContentList_EmptySearchResults"),imgClass:"empty-search-img"},this.emptyRecentWatermarkConfig={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptyRecentTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptyRecentMessage"),imgClass:"empty-recent-img"};var e},t.prototype.ensureSearchTelemetry=function(){this.searchTelemetry||_.isEmpty(this.searchText)||(this.searchTelemetry=this.services.telemetryService.startEvent(e.telemetry.ContentListSearch)),this.updateRecentlyUsedArtifacts()},t.prototype.resolveSearchTelemetry=function(){this.searchTelemetry&&(this.searchTelemetry.resolve(),this.searchTelemetry=null)},t.prototype.searchProperties=function(e,t){return this.containsSubstring(e.displayName,t.toLocaleLowerCase())},t.prototype.compareDates=function(e,t){return e>t?-1:e<t?1:0},t.prototype.containsSubstring=function(e,t){return!!e&&_.contains(e.toLocaleLowerCase(),t)},t.prototype.updateRecentlyUsedArtifacts=function(){var e=this,t=_.filter(this.recentlyUsedArtifacts,(function(t){return e.searchProperties(t,e.searchText)}));switch(this.sortPredicate){case i.TitleAlphabeticalPredicate:t.sort((function(e,t){return e.displayName.localeCompare(t.displayName)}));break;case i.TitleReverseAlphabeticalPredicate:t.sort((function(e,t){return t.displayName.localeCompare(e.displayName)}));break;case i.LastAccessReverseDatePredicate:default:t.sort((function(t,i){return e.compareDates(t.lastAccess,i.lastAccess)}))}this.filteredRecentlyUsedArtifacts=t,this.updateWatermark()},t.prototype.updateWatermark=function(){this.showWatermarkConfig=_.isEmpty(this.filteredRecentlyUsedArtifacts),this.showWatermarkConfig&&(this.watermarkConfig=_.isEmpty(this.searchText)?this.emptyRecentWatermarkConfig:this.emptySearchWatermarkConfig)},t.prototype.getArtifactLocStringValue=function(t){switch(t){case e.models.MRUArtifactType.Dashboards:return"ArtifactKind_Dashboard";case e.models.MRUArtifactType.Reports:return"ArtifactKind_Report";case e.models.MRUArtifactType.Workbooks:return"ArtifactKind_Workbook";case e.models.MRUArtifactType.AppInstance:return"Artifact_InstalledApp";default:return""}},t})();t.RecentlyViewedContainerController=n})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.RecentlyViewedContainer={templateUrl:"components/recentlyViewedContainer/recentlyViewedContainer.html",controller:e.common.createController(e.controllers.RecentlyViewedContainerController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.ArtifactType,o=e.common.contracts.ContentTileType,r=jsCommon.EnumExtensions,a=e.common.contracts.Permissions,n=(function(){function e(e,t){this.services=t,this.dashboards=[],this.reports=[],this.models=[]}return e.createOptions=function(){return{additionalServices:["analyzeInExcel","contentList","dashboardService","featureSwitchService","groupService","localizationService","modelService","navigation","permissionService","reportService","taskPaneSliderService"]}},e.prototype.$onInit=function(){switch(this.viewModel.artifactType){case i.Dashboard:this.retrieveRelatedItemsToDashboard();break;case i.Model:this.retrieveRelatedItemsToModel();break;case i.Report:this.retrieveRelatedItemsToReport()}},e.prototype.analyzeInExcel=function(e){this.services.contentList.analyzeContentInExcel(e)},e.prototype.canAnalyzeInExcel=function(e){return this.services.analyzeInExcel.isAnalyzeInExcelSupported(this.services.featureSwitchService,e.getPermissions())},e.prototype.canRunInsights=function(e){if(this.viewModel.readOnly)return!1;var t=this.services.contentList.getModels(e),i=_.first(t);return i&&i.contract.insightsSupported&&r.hasFlag(i.getPermissions(),a.Read)},e.prototype.canShare=function(e){var t=r.hasFlag(e.getPermissions(),a.ReShare),i=this.services.groupService.getGroup(e.workspaceId);return i?!this.services.permissionService.isGroupWorkspaceReadOnly(i.contract.isReadOnly,i.contract.isOwner)&&t:t},e.prototype.canWriteTo=function(e){if(this.viewModel.readOnly)return!1;var t=e.getPermissions();return r.hasFlag(t,a.All)||r.hasFlag(t,a.ReadWrite)},e.prototype.close=function(){this.services.taskPaneSliderService.collapsePane()},e.prototype.hasItems=function(e){return!_.isEmpty(e)},e.prototype.openContent=function(e){this.services.contentList.openContent(e,e.workspaceId)},e.prototype.openSettings=function(e){this.services.contentList.showRename(e)},e.prototype.runInsights=function(e){this.services.contentList.runInsights(e),this.close()},e.prototype.shareContentTile=function(e){this.services.contentList.shareContent(e,e.workspaceId)},e.prototype.tooltipForSettings=function(e){return e===o.Dashboard?this.services.localizationService.get("ContentTileOptions_Settings"):this.services.localizationService.get("ContentTileOptions_Rename")},e.prototype.retrieveRelatedItemsToDashboard=function(){var e=this.services.dashboardService.findDashboardByGUID(this.viewModel.id);if(e){for(var t=0,i=e.contract.reportIds;t<i.length;t++){var o=i[t],r=this.services.reportService.findReport(o);r&&this.reports.push(r)}if(!this.viewModel.readOnly)for(var a=0,n=e.contract.modelIds;a<n.length;a++){var s=n[a],c=this.services.modelService.findModel(s);c&&this.models.push(c)}}},e.prototype.retrieveRelatedItemsToModel=function(){var e=this,t=+this.viewModel.id;this.services.contentList.getDashboards().then((function(i){for(var o=0,r=i;o<r.length;o++){var a=r[o];_.find(a.contract.modelIds,(function(e){return e===t}))&&e.dashboards.push(a)}})),this.services.contentList.getReports().then((function(i){for(var o=0,r=i;o<r.length;o++){var a=r[o];a.modelId===t&&e.reports.push(a)}}))},e.prototype.retrieveRelatedItemsToReport=function(){var e=this,t=this.services.reportService.findReportByGUID(this.viewModel.id);if(t&&(this.services.contentList.getDashboards().then((function(i){for(var o=0,r=i;o<r.length;o++){var a=r[o];_.find(a.contract.reportIds,(function(e){return e===t.id}))&&e.dashboards.push(a)}})),!this.viewModel.readOnly)){var i=this.services.modelService.findModel(t.modelId);i&&this.models.push(i)}},e})();t.RelatedContentBladeController=n})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.RelatedContentBlade={controller:e.common.createController(e.controllers.RelatedContentBladeController),bindings:{viewModel:"<"},templateUrl:"components/relatedContentBlade/relatedContentBlade.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["localizationService"]}},e.prototype.convertRefreshTimeToJsDateTime=function(e){var t=i.convertRefreshTimeToJsDateTime(e);return this.services.localizationService.format("RelatedContentBlade_LastRefresh",[t.toLocaleString()])},e})();t.RelatedContentDatasetRowController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.RelatedContentDatasetRow={controller:e.common.createController(e.controllers.RelatedContentDatasetRowController),bindings:{viewModel:"<"},templateUrl:"components/relatedContentDatasetRow/relatedContentDatasetRow.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.$scope=e,this.services=t,this.dropdownOpen=!1}return t.createOptions=function(){return{additionalServices:["$document","overlayService"]}},t.prototype.toggleDropdown=function(t){var i=this,o=this.services.$document.find(t.delegateTarget),r=o.find(".js-anchor"),a=this.services.overlayService.getOverlayElement(this.overlayName);this.services.overlayService.toggleDropdown(t,{anchorElement:r,element:a,preferLeft:!0,horizontal:!1}),this.dropdownOpen=!this.dropdownOpen,this.dropdownOpen&&a.on(e.common.constants.OverlayCloseEventName,(function(){i.$scope.$applyAsync((function(){a.off(e.common.constants.OverlayCloseEventName),i.dropdownOpen=!1}))}))},t})();t.SelectButtonController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SelectButton={transclude:!0,bindings:{overlayName:"@"},templateUrl:"components/selectButton/selectButton.html",controller:e.common.createController(e.controllers.SelectButtonController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.PermissionArtifactType,o=(function(){function e(e,t){this.Dashboard=i.Dashboard,this.Report=i.Report,this.Workbook=i.Workbook,this.Dataset=i.Dataset,this.overlayService=t.overlayService}return e.createOptions=function(){return{additionalServices:["overlayService"]}},e.prototype.isSelectedType=function(e){return(this.selectedType&e)===e},Object.defineProperty(e.prototype,"showContentFilter",{get:function(){return this._showContentFilter},enumerable:!0,configurable:!0}),e})();t.SelectArtifactFilterController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SelectArtifactFilter={bindings:{selectedType:"<",selectType:"&onSelectType"},templateUrl:"components/selectArtifactFilter/selectArtifactFilter.html",controller:e.common.createController(e.controllers.SelectArtifactFilterController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.utils.DateFormatter,o=(jsCommon.DOMConstants,(function(){function e(e,t){this.services=t,this.hasModels=!1}return e.createOptions=function(){return{additionalServices:["localizationService","modalDialogService","modelService","navigation"]}},e.prototype.$onInit=function(){this.searchString="",this.tableConfig={data:null,hideHeader:!1},this.tableConfig.data=this.tableConfig.filteredData=this.models,this.hasModels=this.models.length>0},e.prototype.getLastRefreshDate=function(e){return i.getPrettyRelativeDate(new Date(e.lastRefreshEpochTime),this.services.localizationService)},e.prototype.selectModel=function(e){this.selectedDataset=this.selectedDataset!==e?e:null},e.prototype.itemKeydown=function(e,t){13!==e.keyCode&&32!==e.keyCode||(this.selectModel(t),e.preventDefault())},e.prototype.onSearchStringChanged=function(){var e=this.searchString.toLocaleLowerCase();this.tableConfig.filteredData=_.filter(this.tableConfig.data,(function(t){return _.contains(t.displayName.toLocaleLowerCase(),e)})),_.contains(this.tableConfig.filteredData,this.selectedDataset)||(this.selectedDataset=null)},e.prototype.confirm=function(){this.selectedDataset&&this.services.modalDialogService.close({selectedDataset:this.selectedDataset,openGetData:!1})},e.prototype.cancel=function(){this.services.modalDialogService.close({openGetData:!1})},e.prototype.importDataset=function(){this.services.modalDialogService.close({openGetData:!0})},e})());t.SelectDatasetDialogController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SelectDatasetDialog={templateUrl:"components/selectDatasetDialog/selectDatasetDialog.html",bindings:{titleLabel:"<",descriptionLabel:"<",confirmLabel:"<",cancelLabel:"<",models:"<"},controller:e.common.createController(e.controllers.SelectDatasetDialogController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.modalDialogService=e,this.modelService=t}return e.prototype.show=function(e,t,i,o,r,a){var n={titleLabel:t,descriptionLabel:i,confirmLabel:o,cancelLabel:r,models:_.filter(this.modelService.copyAndEditModels,a)},s={dialogName:e,definitionTemplateCachePath:"components/selectDatasetDialog/selectDatasetDialogDefinition.html",bindings:n};return this.modalDialogService.showWebModalDialog(s)},e})();e.SelectDatasetDialogBuilder=t})(t=e.dialogs||(e.dialogs={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentTileType,o=e.models.OwnershipFilterMenuFilter,r=(function(){function e(e,t){this.OwnerAll=o.AllContent,this.OwnerMine=o.MyContent,this.OwnerShared=o.SharedWithMe,this.Dashboard=i.Dashboard,this.Report=i.Report,this.Workbook=i.Workbook,this.overlayService=t.overlayService}return e.createOptions=function(){return{additionalServices:["overlayService"]}},e.prototype.isSelectedType=function(e){return(this.selectedType&e)===e},e.prototype.isSelectedOwner=function(e){return this.selectedOwnership===e},e})();t.SelectTileFilterController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SelectTileFilter={bindings:{selectedType:"<",selectedOwnership:"<",selectType:"&onSelectType",selectOwner:"&onSelectOwnership"},templateUrl:"components/selectTileFilter/selectTileFilter.html",controller:e.common.createController(e.controllers.SelectTileFilterController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.$scope=e,this.overlayService=t.overlayService,this.loc=t.localizationService}return t.createOptions=function(){return{additionalServices:["overlayService","localizationService"]}},t.prototype.$onInit=function(){
this.updateDropdownItems(),this.updateTitle()},t.prototype.$onChanges=function(e){e.predicates&&this.updateDropdownItems(),e.selectedPredicate&&this.updateTitle()},t.prototype.updateDropdownItems=function(){this.dropdownItems=_.isEmpty(this.predicates)?e.models.factory.SelectTileSortItemsFactory.createDefaultPredicates(this.loc):this.predicates,_.find(this.dropdownItems,{predicate:this.selectedPredicate})||this.onSelect()(this.dropdownItems[0].predicate)},t.prototype.updateTitle=function(){var e=_.find(this.dropdownItems,{predicate:this.selectedPredicate});e&&(this.title=e.title)},t.prototype.select=function(e){this.onSelect()(e),this.overlayService.hideAllDropdowns()},t.prototype.isSelected=function(e){return this.selectedPredicate===e},t})();t.SelectTileSortController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SelectTileSort={bindings:{selectedPredicate:"<",onSelect:"&",predicates:"<?"},templateUrl:"components/selectTileSort/selectTileSort.html",controller:e.common.createController(e.controllers.SelectTileSortController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e.AllSharedOwnerObjectId="";var t=(function(){function t(i,o,r){i?(this.userObjectId=i.ownerUserObjectId,this.groupObjectId=i.ownerGroupObjectId,this.fullname=i.ownerFullname,this.mail=i.ownerMail,this.objectId=t.getDashboardOwnerId(i),this.name=this.fullname||this.mail,this.userInfoService=o):(this.objectId=e.AllSharedOwnerObjectId,this.name=r?r.get("SharedBy_AllShared"):"All Shared")}return t.getDashboardOwnerId=function(e){return e.ownerUserObjectId||e.ownerGroupObjectId},Object.defineProperty(t.prototype,"icon",{get:function(){return this.iconString||!this.userInfoService||this.photoRequestSent||this.getIcon(this.userInfoService),this.iconString},enumerable:!0,configurable:!0}),t.prototype.isUser=function(){return null!=this.userObjectId},t.prototype.getIcon=function(e){var t=this,i=this.isUser()?e.findOrGetUserPhoto(this.userObjectId):e.getGroupIcon(this.groupObjectId);i.then((function(e){t.iconString=e})),this.photoRequestSent=!0},t})();e.OwnerInfo=t})(t=e.sharedByColumn||(e.sharedByColumn={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.sharedByColumn.OwnerInfo,o=(function(){function e(e,t){var o=this;this.dashboardToOwnerInfo={},this.services=t,this.defaultOwnerInfos=[new i((void 0),(void 0),this.services.localizationService)],this.ownerInfos=this.defaultOwnerInfos,this.services.dashboardService.dashboardsOwnersMergedPromise().finally((function(){o.updateOwnerInfos(),o.ownerInfoMerged=!0}))}return e.createOptions=function(){return{additionalServices:["dashboardService","localizationService","userInfo"]}},Object.defineProperty(e.prototype,"showSpinner",{get:function(){return!this.ownerInfoMerged},enumerable:!0,configurable:!0}),e.prototype.$onChanges=function(e){e.sharedDashboards&&this.updateOwnerInfos()},e.prototype.getOrCreateOwnerInfo=function(e){var t=i.getDashboardOwnerId(e);if(t)return this.dashboardToOwnerInfo[t]||(this.dashboardToOwnerInfo[t]=new i(e,this.services.userInfo)),this.dashboardToOwnerInfo[t]},e.prototype.updateOwnerInfos=function(){var e=this,t=_.map(this.sharedDashboards,(function(t){return e.getOrCreateOwnerInfo(t)}));t=_(t).compact().uniq("objectId").sortBy((function(e){return e.name.toLocaleLowerCase()})).value(),this.ownerInfos=this.defaultOwnerInfos.concat(t)},e})();t.SharedByColumnController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SharedByColumn={templateUrl:"components/sharedByColumn/sharedByColumn.html",controller:e.common.createController(e.controllers.SharedByColumnController),bindings:{sharedDashboards:"<",selectedOwner:"<",onSelectedOwnerChanged:"&"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.factory.ArtifactSortPredicates,o=e.dataServices.models.Dashboard,r=e.models.OwnershipFilterMenuFilter,a=e.common.models.Report,n=e.telemetry.SelectSort,s=e.common.contracts.ContentTileType,c=e.dataServices.models.Workbook,l=(function(){function t(t,n){var l=this;if(this.services=n,this.sortPredicateMap={},this.allTypes=s.Dashboard|s.Report|s.Workbook,this.allDashboards=[],this.sharedDashboardsAll=[],this.sharedDashboardsPrefiltered=[],this.sharedDashboardsFiltered=[],this.dashboardCount=0,this.searchText="",this.sortPredicate=i.TitleAlphabeticalPredicate,this.typeFilter=this.allTypes,this.ownership=r.SharedWithMe,this.galleryViewModel={},this.initializeArtifacts=function(){var e=l.services.contentList,t=e.getDashboards();l.dashboardsLoadedDefer=l.services.promiseFactory.defer(),l.contentListDataReadyPromise=t.then((function(e){l.allDashboards=e,l.updateArtifacts()})),l.groupService.ensureGroupsInitialization(),l.services.contentList.dashboardsOwnersMergedPromise(),l.initOnAppMetadata()},this.onSortPredicateChanged=function(t){l.sortPredicate=t;var i=l.sortPredicateMap[t.toAngularFilter()];l.services.telemetryService.logEvent(e.telemetry.ContentListSelectSort,i),l.filterArtifacts(!1),l.persistFilter()},this.onSearchTextChange=function(){l.selectedSharedByOwner=e.models.sharedByColumn.AllSharedOwnerObjectId,l.filterArtifacts(!0),l.ensureSearchTelemetry()},this.startTelemetry=function(){l.scope.$on(e.constants.contentListDashboardsLoadedEvent,(function(){l.dashboardsLoadedDefer.resolve(null)}));var t=l.telemetryService.startActivity(l.scope,e.telemetry.ContentListLoaded);l.telemetryService.logEvent(e.telemetry.ContentListArtifactsCount,l.allDashboards?l.allDashboards.length:-1,0,0),l.dashboardsLoadedDefer.promise.then((function(){t.resolve(),l.groupService.resolveGroupSwitchTelemetry()}))},this.resolveTelemetry=function(e,t,i){return 0===l[t]&&l[i].resolve(null),e},this.ensureSearchTelemetry=function(){l.searchTelemetry||_.isEmpty(l.searchText)||(l.searchTelemetry=l.telemetryService.startEvent(e.telemetry.ContentListSearch))},this.resolveSearchTelemetry=function(){l.searchTelemetry&&(l.searchTelemetry.resolve(),l.searchTelemetry=null)},this.isVisible=function(e){if(e.isHidden)return!1;if(!l.services.conceptualModelSetting.isAppsEnabled())return!0;var t;switch(e.contentTileType){case s.Dashboard:e instanceof o&&(t=e.contract.originalPackageId);break;case s.Report:e instanceof a&&(t=e.contract.packageId);break;case s.Workbook:e instanceof c&&(t=e.contract.packageId)}return!t||!l.services.contentList.isAppInstance(t)},this.emptySharedDashboards={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptySharedWithMeTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptySharedWithMeMessage"),imgClass:"empty-shared-with-me-img"},this.emptySearch={canEdit:!0,mode:!1,linkDescription:this.services.localizationService.get("ContentList_EmptySearchResults_SearchRedirectDescription"),linkText:this.services.localizationService.format("SearchIn",[this.services.localizationService.get("NavigationPane_Groups_MyWorkspace")]),linkAction:function(){return l.switchWorkspaceFromEmptySearch()},imgClass:"empty-search-img"},this.scope=t,this.navigation=n.navigation,this.localizationService=n.localizationService,this.groupService=n.groupService,this.telemetryService=n.telemetryService,this.groupHttp=n.groupHttp,this.ownershipService=n.ownership,this.rootScope=n.rootScope,this.modalDialogService=n.modalDialogService,this.userActivityContextService=n.userActivityContextService,this.selectedSharedByOwner=e.models.sharedByColumn.AllSharedOwnerObjectId,this.groupService.activeGroupObjectId!==e.constants.myWorkSpaceGroupId){var d=_.find(this.groupService.groups,(function(e){return e.isMyWorkspace})),p=this.services.telemetryService.startEvent(e.telemetry.GroupsSwitchGroup,d.aadGroupId);this.groupService.switchGroup(d,!1,p,!0).then((function(){l.services.navigation.navigateToSharedWithMe(),l.groupSwitchComplete=!0}))}else this.groupSwitchComplete=!0;this.initializeArtifacts();var u={onDashboardAdded:function(e){return l.updateArtifacts()},onDashboardDeleted:function(e){return l.updateArtifacts()},onDashboardsReset:function(){return l.updateArtifacts()}};this.services.dashboardDataService.subscribe(u);var v=this.rootScope.$on(e.constants.updateSharedWithMe,(function(){return l.updateArtifacts()}));this.createReportDialogBuilder=new e.dialogs.CreateReportDialogBuilder(n.telemetryService,n.navigation,n.usageMetricsReport,n.modalDialogService,n.modelService);var h=this.rootScope.$on(e.constants.groupSwitchedEventName,this.initializeArtifacts);this.services.dataClassificationService.isEnabledAsync().then((function(e){l.dataClassificationEnabled=e}));var g=this.services.rootScope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,i,o,r){return l.handleStateChange(t,i,o,r)}));this.scope.$on(e.common.constants.scopeDestroyEventName,(function(){l.services.dashboardDataService.unsubscribe(u),v(),h(),g()}))}return t.createOptions=function(){return{additionalServices:["$window","$rootScope","appMetadataService","conceptualModelSetting","contentList","groupService","navigation","promiseFactory","ownership","localizationService","telemetryService","groupHttp","modalDialogService","filterPersistenceService","userActivityContextService","modelService","dataClassificationService","userInfo","dashboardDataService","usageMetricsReport"]}},t.prototype.$onInit=function(){this.activeTab=64,this.updateSortPredicates(),this.updateGalleryViewModel(),this.sortPredicateMap[i.TitleAlphabeticalPredicate.toAngularFilter()]=n.TitleAlpabetical,this.sortPredicateMap[i.TitleReverseAlphabeticalPredicate.toAngularFilter()]=n.TitleReverseAlphabetical,this.sortPredicateMap[i.OwnerAlphabeticalPredicate.toAngularFilter()]=n.OwnerAlphabetical,this.sortPredicateMap[i.OwnerReverseAlphabeticalPredicate.toAngularFilter()]=n.OwnerReverseAlphabetical,this.sortPredicateMap[i.SharedTimePredicate.toAngularFilter()]=n.SharedTime,this.sortPredicateMap[i.SharedReverseTimePredicate.toAngularFilter()]=n.SharedReverseTime,this.processSharedWithMeParameter(),this.initialized=!0},Object.defineProperty(t.prototype,"showSpinner",{get:function(){return!this.initialized||!this.groupSwitchComplete},enumerable:!0,configurable:!0}),t.prototype.processSharedWithMeParameter=function(){this.navigation.searchText&&(this.searchText=this.navigation.searchText),this.sortPredicate=i.SharedReverseTimePredicate},t.prototype.handleStateChange=function(e,t,i,o){this.processSharedWithMeParameter()},t.prototype.initOnAppMetadata=function(){var e=this;this.services.appMetadataService.getAppMetadata().then((function(){e.initialized=!0}))},t.prototype.updateArtifacts=function(){var e=this;this.sharedDashboardsAll=_(this.allDashboards).filter((function(t){return e.ownershipService.isResourceSharedWithMe(t)})).filter((function(t){return e.isVisible(t)})).value(),this.dashboardsArePresent=!_.isEmpty(this.sharedDashboardsAll),this.filterArtifacts(!0)},t.prototype.filterArtifacts=function(t){var i=this,o=_(this.sharedDashboardsAll);this.searchText&&(o=o.filter((function(e){return i.containsSearchText(e)}))),t&&(this.sharedDashboardsPrefiltered=o.value()),this.selectedSharedByOwner!==e.models.sharedByColumn.AllSharedOwnerObjectId&&(o=o.filter((function(t){return i.selectedSharedByOwner===e.models.sharedByColumn.OwnerInfo.getDashboardOwnerId(t)}))),o=o.sortByOrder(this.sortPredicate.columnName,!this.sortPredicate.reverse),this.sharedDashboardsFiltered=o.value(),this.dashboardCount=this.sharedDashboardsFiltered.length,this.hasResults=this.dashboardCount>0},t.prototype.containsSearchText=function(e){var t=this.searchText.toLocaleLowerCase();return this.containsSubstring(e.displayName,t)||this.containsSubstring(e.ownerFullname,t)},t.prototype.onSelectedOwnerChanged=function(e){this.selectedSharedByOwner=e,this.filterArtifacts(!1)},t.prototype.containsSubstring=function(e,t){return!!e&&_.contains(e.toLocaleLowerCase(),t)},t.prototype.$postLink=function(){this.contentListDataReadyPromise.then(this.startTelemetry)},t.prototype.persistFilter=function(){this.services.filterPersistenceService.setFilter(this.navigation.currentGroupGUID,{contentTileType:this.typeFilter,ownershipFilter:this.ownership,sortPredicate:this.sortPredicate.toAngularFilter()})},t.prototype.switchWorkspaceFromEmptySearch=function(){this.services.navigation.navigateToContentList(e.constants.myWorkSpaceGroupId,!0,null,null,!1,this.searchText)},t.prototype.updateSortPredicates=function(){this.sortPredicates=e.models.factory.SelectTileSortItemsFactory.createPredicates(this.localizationService,64)},t.prototype.updateGalleryViewModel=function(){var t=this;this.galleryViewModel.tabType=64,this.galleryViewModel.collapsiblePaneMode=this.collapsiblePaneMode,this.galleryViewModel.getTiles=function(){return t.sharedDashboardsFiltered},this.galleryViewModel.finishLoadEvent=e.constants.contentListDashboardsLoadedEvent},t.prototype.getNumberOfShownTabItems=function(){return this.dashboardCount},t.prototype.getWatermarkConfig=function(){return _.isEmpty(this.searchText)||0!==this.dashboardCount?this.dashboardsArePresent?void 0:this.emptySharedDashboards:this.emptySearch},t.prototype.shouldShowWatermark=function(){return!this.showSpinner&&(!_.isEmpty(this.searchText)&&0===this.dashboardCount||!this.dashboardsArePresent)},t})();t.SharedWithMeContainerController=l})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SharedWithMeContainer={templateUrl:"components/sharedWithMeContainer/sharedWithMeContainer.html",controller:e.common.createController(e.controllers.SharedWithMeContainerController),bindings:{collapsiblePaneMode:"<"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.JsonExtensions,o=e.common.contracts.RealTimeMode,r=e.common.constants.TaskPaneCollapsiblePaneMode,a=(function(){function t(e,t){this.scope=e,this.services=t,this.initialize()}return t.createOptions=function(){return{additionalServices:["realTimeModel","taskPaneSliderService"]}},t.prototype.back=function(){this.services.taskPaneSliderService.expandPane(r.StreamingDatasetGallery)},t.prototype.cancel=function(){this.scope.$emit(e.constants.hideTileEditorEventName)},t.prototype.next=function(){var e=this.realTimeModel,t=e.definition;t.dataSourceType=1,t.mode=o.PubNubCacheOnly,t.externalCredentials=JSON.stringify(this.viewModel),this.services.taskPaneSliderService.expandPane(r.StreamingDatasetEditor)},t.prototype.initialize=function(){var e=this,t=this.services.realTimeModel;t.getSelected().then((function(o){o&&o.definition?(e.realTimeModel=o,e.viewModel=i.tryParseJSON(o.definition.externalCredentials)):e.realTimeModel=t.getAndSelectEmptyModel()}))},t})();t.PubNubEditorController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.PubNubEditor={controller:e.common.createController(e.controllers.PubNubEditorController),templateUrl:"components/streamingDataset/pubNubEditor/pubNubEditor.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=/\\/gi,i=/"/gi,o=(function(){function e(e,t){this.scope=e,this.services=t,this.apiExamples=[{id:1,title:"Raw"},{id:2,title:"cURL"},{id:3,title:"PowerShell"}],this.activeExample=this.apiExamples[0],this.mockValues={},this.mockValues[2]='"'+(new Date).toISOString()+'"',this.mockValues[1]=98.6,this.mockValues[0]='"AAAAA555555"'}return e.prototype.escapeCharacters=function(e){return e+="",e.replace(t,"\\\\").replace(i,'\\"')},e.prototype.hasColumns=function(){var e=this.viewModel&&this.viewModel.columns;return e&&e.length>0&&!_.isEmpty(e[0].name)},e.prototype.showExample=function(e){this.activeExample=e},e})();e.StreamingDataSampleController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.StreamingDataSample={bindings:{viewModel:"<",showHeader:"<",url:"&"},controller:e.common.createController(e.controllers.StreamingDataSampleController),templateUrl:"components/streamingDataset/streamingDataSample/streamingDataSample.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.JsonExtensions,o=e.common.contracts.RealTimeMode,r=e.common.constants.TaskPaneCollapsiblePaneMode,a=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.realTimeMode=o,this.validateColumnName=function(e){var t=e?e.trim():"";return _.filter(i.viewModel.definition.columns,(function(e){return e.name&&e.name.trim()===t})).length<=1},this.isLoadingColumnTypes=!1,this.warningText=null,this.initialize()}return t.createOptions=function(){return{additionalServices:["featureSwitchService","localizationService","realTimeModel","telemetryService","realTimePubNubData","taskPaneSliderService"]}},Object.defineProperty(t.prototype,"canSave",{get:function(){return!this.isSaving&&1!==this.viewModel.definition.columns.length&&!this.isLoading},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLoading",{get:function(){return!this.viewModel||this.isLoadingColumnTypes},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"toggleStateText",{get:function(){var e=this.viewModel&&this.viewModel.definition.mode!==o.CacheOnly?"ToggleSwitchOn":"ToggleSwitchOff";return this.services.localizationService.get(e)},enumerable:!0,configurable:!0}),t.prototype.cancel=function(){this.scope.$emit(e.constants.hideTileEditorEventName)},t.prototype.columnUpdated=function(e){e&&this.addNewColumn()},t.prototype.removeColumn=function(e){_.remove(this.viewModel.definition.columns,e)},t.prototype.save=function(){var t,i=this,a=this.viewModel.definition,n=this.services.realTimeModel;this.isSaving=!0,a.columns.pop(),t=this.viewModel.isNew?n.createModel(a).then((function(){a.mode===o.PubNubCacheOnly?i.scope.$emit(e.constants.hideTileEditorEventName):i.services.taskPaneSliderService.expandPane(r.StreamingDatasetPushInfo)})):n.updateModel(a).then((function(){i.scope.$emit(e.constants.hideTileEditorEventName)})),t.catch((function(){i.addNewColumn()})).finally((function(){i.isSaving=!1}))},t.prototype.back=function(){this.services.taskPaneSliderService.expandPane(this.from)},t.prototype.initialize=function(){var t=this,i=this.services,r=i.realTimeModel;r.getSelected().then((function(a){a=a?a:r.getAndSelectEmptyModel();var n=a.definition,s=n&&n.columns;s&&s.length>0&&_.isEmpty(s[s.length-1].name)&&n.columns.pop(),i.telemetryService.logEvent(e.telemetry.RealTimeEditStreamingDatasetPaneOpened,!a),t.viewModel=a,t.localizeValues(),t.historicalAnalysisEnabled=t.viewModel.definition.mode!==o.PubNubCacheOnly,t.detectPubNubColumnsIfNeeded(),t.addNewColumn()}),(function(){t.scope.$emit(e.constants.hideTileEditorEventName)}))},t.prototype.detectPubNubColumnsIfNeeded=function(){var e=this,t=this.viewModel.definition,r=this.services,a=r.realTimePubNubData,n=r.localizationService;if(this.warningText=null,t.mode===o.PubNubCacheOnly&&(this.viewModel.isNew||_.isEmpty(t.columns))){var s=i.tryParseJSON(t.externalCredentials);if(!s)return;this.isLoadingColumnTypes=!0;var c=this.scope.streamingDatasetForm;a.detectPubNubColumnsDefinition(s).then((function(i){t.columns=i,e.addNewColumn(),c.$setDirty()}),(function(){e.warningText=n.get("StreamingDataSetEditor_PubNubDataDetectionTimedOut")})).finally((function(){e.isLoadingColumnTypes=!1}))}},t.prototype.addNewColumn=function(){this.viewModel.definition.columns.push({name:null,dataType:0})},t.prototype.localizeValues=function(){var e=this.services.localizationService;this.viewModel.isNew?(this.header=e.get("StreamingDatasetEditor_NewDataset"),this.buttonText="Create_ButtonText"):(this.header=e.get("StreamingDatasetEditor_EditDataset"),this.buttonText="Done_ButtonText"),this.columnPlaceholder=e.get("StreamingDatasetEditor_ColumnPlaceholder"),this.namePlaceholder=e.get("StreamingDatasetEditor_DatasetPlaceholder"),this.dataTypes=[{displayName:e.get("StreamingDatasetEditor_Text"),value:0},{displayName:e.get("StreamingDatasetEditor_Number"),value:1},{displayName:e.get("StreamingDatasetEditor_DateTime"),value:2}]},t})();t.StreamingDatasetEditorController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.StreamingDatasetEditor={bindings:{from:"="},controller:e.common.createController(e.controllers.StreamingDatasetEditorController),templateUrl:"components/streamingDataset/streamingDatasetEditor/streamingDatasetEditor.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.models.factory.DatasetsMenuFactory,o=e.models.factory.StreamingDatasetOptionType,r=e.common.constants.TaskPaneCollapsiblePaneMode,a=(function(){function t(t,o){this.scope=t,this.services=o,o.telemetryService.logEvent(e.telemetry.RealTimeStreamingDatasetGalleryPaneOpened),this.streamingDatasetOptions=i.getStreamingDatasetOptions(this.services.featureSwitchService,this.services.localizationService),this.selectedOption=this.streamingDatasetOptions[0]}return t.createOptions=function(){return{additionalServices:["localizationService","realTimeModel","telemetryService","featureSwitchService","taskPaneSliderService"]}},t.prototype.cancel=function(){this.scope.$emit(e.constants.hideTileEditorEventName)},t.prototype.isLinkTypeSelected=function(){return this.selectedOption&&this.selectedOption.type===o.Link},t.prototype.next=function(){var t,i;switch(this.services.realTimeModel.setSelected(null),this.selectedOption.type){case o.APIPush:t=e.telemetry.StreamingDatasetGalleryOption.APIPush,i=r.StreamingDatasetEditor;break;case o.PubNub:t=e.telemetry.StreamingDatasetGalleryOption.PubNub,i=r.PubNubEditor}this.services.telemetryService.logEvent(e.telemetry.RealTimeStreamingDatasetGalleryOptionSelected,t),this.services.taskPaneSliderService.expandPane(i)},t.prototype.selectOption=function(e){this.selectedOption=e},t})();t.StreamingDatasetGalleryController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.StreamingDatasetGallery={controller:e.common.createController(e.controllers.StreamingDatasetGalleryController),templateUrl:"components/streamingDataset/streamingDatasetGallery/streamingDatasetGallery.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.services.realTimeModel.getSelected().then((function(e){o.viewModel=e}),(function(){o.scope.$emit(e.constants.hideTileEditorEventName)}))}return t.createOptions=function(){return{additionalServices:["realTimeModel"]}},t.prototype.close=function(){this.scope.$emit(e.constants.hideTileEditorEventName)},t})();t.StreamingDatasetPushInfoController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.StreamingDatasetPushInfo={controller:e.common.createController(e.controllers.StreamingDatasetPushInfoController),templateUrl:"components/streamingDataset/streamingDatasetPushInfo/streamingDatasetPushInfo.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.openAlertsSettingsEvent=this.services.telemetryService.logEvent(e.telemetry.DataAlertsOpenAlertsSettings);var r=this.services.localizationService,a=r.currentLanguageLocale;this.columns=[{displayName:r.get("AlertsSettings_AlertTitle"),predicateName:"alertTitle"},{displayName:r.get("AlertsSettings_DashboardName"),predicateName:"dashboardName"},{displayName:r.get("AlertsSettings_CreatedDate"),predicateName:"alertCreatedDate"}],this.services.alertHttpService.getAllAlerts(this.openAlertsSettingsEvent).then((function(e){for(var t=[],i=_.groupBy(e,(function(e){return e.group?e.group.id:-1})),r=Object.keys(i),n=0,s=r;n<s.length;n++){var c=s[n];t.push({alerts:_.map(i[c],(function(e){return o.services.modelConverter.convertSettingsAlerts(a,e)})),title:i[c][0].group?i[c][0].group.displayName:o.services.localizationService.get("AlertsSettings_MyWorkspace")})}o.viewModel=t}))}return t.createOptions=function(){return{additionalServices:["alertHttpService","localizationService","modelConverter","navigation","telemetryService","errorService"]}},t.prototype.order=function(e,t){e.reverse=e.sortPredicate===t&&!e.reverse,e.sortPredicate=t},t.prototype.toggleAlert=function(t){this.services.telemetryService.logChildEvent(this.openAlertsSettingsEvent,e.telemetry.DataAlertsAlertsSettingsToggle),this.services.alertHttpService.toggleAlert(t.contract.id,t.enabled,this.openAlertsSettingsEvent)},t.prototype.editAlert=function(t){this.services.telemetryService.logChildEvent(this.openAlertsSettingsEvent,e.telemetry.DataAlertsAlertsSettingsEdit);var i=t.contract,o=i.tile.objectId,r=i.tile.originalTileObjectId,a=i.id,n=i.dashboard.objectId,s=i.group?i.group.objectId:e.constants.myWorkSpaceGroupId;this.services.navigation.showAlertsEditor(o,r,a,n,s)},t.prototype.deleteAlert=function(t){this.services.telemetryService.logChildEvent(this.openAlertsSettingsEvent,e.telemetry.DataAlertsAlertsSettingsDelete);var i=this.services.errorService.control();i.showPrompt(this.services.localizationService.get("Alerts_DeleteDialogTitle"),this.services.localizationService.get("Alerts_DeleteDialogMessage"),this.getModalActionsArray(i,t))},t.prototype.getModalActionsArray=function(t,i){var o=this;return[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(r,a){t.hideDialog(),o.services.telemetryService.logChildEvent(o.openAlertsSettingsEvent,e.telemetry.DataAlertsDeleteAlertAccept),o.services.alertHttpService.deleteAlert(i.contract.id,o.openAlertsSettingsEvent).then((function(e){if(e)for(var t=0,r=o.viewModel;t<r.length;t++){var a=r[t];_.remove(a.alerts,(function(e){return e.contract.id===i.contract.id}))}}))}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(i,r){o.services.telemetryService.logChildEvent(o.openAlertsSettingsEvent,e.telemetry.DataAlertsDeleteAlertCancel),t.hideDialog()})]},t})();t.SettingsAlertsController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsAlerts={controller:e.common.createController(e.controllers.SettingsAlertsController),templateUrl:"components/settingsAlerts/settingsAlertsView.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=(function(){function t(e,t){this.tutorialDataStore=t.tutorialDataStore,this.telemetryService=t.telemetryService,this.previewFeaturesModalService=t.previewFeaturesModalService}return t.createOptions=function(){return{additionalServices:["telemetryService","tutorialDataStore","previewFeaturesModalService"]}},t.prototype.$onInit=function(){var e=this;this.tutorialDataStore.onReady((function(){e.previewModel=e.startingPreviewModel=e.tutorialDataStore.hasKey(i.previewConceptualModelNewKey)}))},t.prototype.applyChanges=function(){if(!this.isClean()){this.startingPreviewModel=this.previewModel;var t=this.telemetryService.startEvent(e.telemetry.PreviewConceptualModel,this.previewModel,e.telemetry.From.Settings);this.tutorialDataStore.setKey(i.previewConceptualModelNewKey,this.previewModel,t)}},t.prototype.isClean=function(){return this.previewModel===this.startingPreviewModel},t.prototype.discardChanges=function(){this.previewModel=this.startingPreviewModel},t.prototype.showTourModal=function(e){e.preventDefault(),this.previewFeaturesModalService.showModal(!1)},t})();t.SettingsPreviewFeaturesController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsPreviewFeatures={templateUrl:"components/settingsPreviewFeatures/settingsPreviewFeatures.html",controller:e.common.createController(e.controllers.SettingsPreviewFeaturesController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(t,i){var o=this;this.services=i,this.userNotifications={notifications:[],dismissNotification:function(t){o.services.userNotificationInfo.dismissNotification(t.contract),t.contract.notificationCategory===e.userNotifications.contracts.NotificationCategory.DynamicMessage&&o.services.dynamicMessagingData.postData(e.constants.dynamicMessaging.userDismissedAction)},showDismissAllDialog:function(){o.confirmDismissAll()},showLoadMore:!1,disableLoadMore:!1,loadingData:!0,loadMoreNotification:function(){o.userNotifications.disableLoadMore=!0,o.userNotifications.loadingData=!0,o.services.userNotificationInfo.getNextPageData()},performAction:function(e){o.navigateToState(e)},loadIcon:function(e){o.services.userNotificationInfo.loadIcon(e.contract)},moreOptionsMenu:[{text:this.services.localizationService.get("UsersNotifications_Options"),type:DropDownMenuItemType.Title},{action:0,text:this.services.localizationService.get("UsersNotifications_DismissAll"),type:DropDownMenuItemType.Item}],menuEnabled:!1},this.mapUserNotifications(),this.services.userNotificationInfo.registerNotificationsUpdatedListener((function(){o.mapUserNotifications()})),t.$watch((function(){return o.services.userNotificationInfo.hidePaneOnClick}),(function(e){t.$applyAsync((function(){e&&o.hideNotifications()}))}))}return t.createOptions=function(){return{additionalServices:["$window","asyncFeatureSwitchService","errorService","promiseFactory","telemetryService","localizationService","userNotificationInfo","navigation","lazy","userNotificationTileFilterService","dynamicMessagingData"]}},t.prototype.moreOptionsMenuSelected=function(e){var t=e.action;if(null!=t)switch(t){case 0:this.userNotifications.showDismissAllDialog()}},t.prototype.hideNotifications=function(){if(this.services.userNotificationInfo.userNotifications)if(this.services.userNotificationTileFilterService.tileId){var e=_.filter(this.userNotifications.notifications,(function(e){return!e.seen}));if(!_.isEmpty(e)){var t=_.map(e,(function(e){return e.contract.id}));this.services.userNotificationInfo.updateSeenNotifications(t)}}else this.services.userNotificationInfo.userNotifications.unseenCount>0&&this.services.userNotificationInfo.updateLastSeenDate();this.services.userNotificationTileFilterService.tileId=null,this.services.userNotificationInfo.showPane=!1},t.prototype.navigateToState=function(t){var i,o,r=e.userNotifications.contracts;switch(t.actionType){case 0:this.services.navigation.insertGroupAndNavigateToDashboardByGUID(t.actionPath[0],e.constants.myWorkSpaceGroupId);break;case 1:this.displayDialogToExtendTrial();break;case 2:var a=t.actionPath;o=a[2],i=a[3],this.services.navigation.showInFocusMode(a[1],i,a[0],o,e.constants.myWorkSpaceGroupId),t.contract.message.filterProperties&&t.contract.message.filterProperties.UserDataAlertRuleId&&this.services.telemetryService.logEvent(e.telemetry.DataAlertsNotificationAction,e.telemetry.DataAlertNotificationSource.UnifiedNotificationPane,e.telemetry.DataAlertNotificationAction.OpenTile,parseInt(t.contract.message.filterProperties.UserDataAlertRuleId,10));break;case 3:var n=t.actionPath;o=n[3],i=n[4],this.services.navigation.showInFocusMode(n[2],i,n[1],o,n[0]),t.contract.message.filterProperties&&t.contract.message.filterProperties.UserDataAlertRuleId&&this.services.telemetryService.logEvent(e.telemetry.DataAlertsNotificationAction,e.telemetry.DataAlertNotificationSource.UnifiedNotificationPane,e.telemetry.DataAlertNotificationAction.OpenTile,parseInt(t.contract.message.filterProperties.UserDataAlertRuleId,10));break;case 4:this.services.navigation.insertGroupAndNavigateToDashboardByGUID(t.actionPath[0],t.actionPath[1]);break;case 5:t.contract.notificationCategory===r.NotificationCategory.DynamicMessage&&this.services.dynamicMessagingData.postData(e.constants.dynamicMessaging.userClickedAction),
this.services.$window.open(t.actionPath[0],"_blank")}this.services.telemetryService.logEvent(e.telemetry.UserNotificationsLinkClicked,r.NotificationCategory[t.contract.notificationCategory]),this.services.userNotificationInfo.hidePaneOnClick=!0},t.prototype.displayDialogToExtendTrial=function(){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.services.lazy("licenseHelper")];case 1:return t=i.sent(),t.displayDialogToExtendTrial(e.telemetry.LicenseEnforcementOperation.NotificationBar),[2]}}))}))},t.prototype.mapUserNotifications=function(){if(this.userNotifications.notifications=[],this.services.userNotificationInfo.userNotifications){var t=this.services.userNotificationInfo.userNotifications.notifications.filter((function(e){return null==e.notificationType||1===e.notificationType}));if(this.services.userNotificationTileFilterService.tileId&&(t=this.services.userNotificationTileFilterService.filterNotifications(t)),!_.isEmpty(t))for(var i=this.services.localizationService,o=0,r=t;o<r.length;o++){var a=r[o],n=new e.userNotifications.models.UserNotificationModel(a,i);this.userNotifications.notifications.push(n)}this.userNotifications.showLoadMore=this.userNotifications.notifications.length<this.services.userNotificationInfo.userNotifications.totalCount,this.userNotifications.disableLoadMore=!1,this.userNotifications.loadingData=!1}},t.prototype.confirmDismissAll=function(){var e=this,t=this.services.errorService,i=t.control(),o=[new InJs.ModalDialogAction(this.services.localizationService.get("UsersNotifications_DismissAll"),function(t,o){e.services.userNotificationInfo.dismissAll(),i.hideDialog()}),new InJs.ModalDialogAction(this.services.localizationService.get("UsersNotifications_Cancel"),function(e,t){i.hideDialog()})],r=this.services.localizationService.get("UsersNotifications_DismissAllConfirmation"),a=this.services.localizationService.get("UsersNotifications_ConfirmDismissAll");i.showCustomDialog(r,$("<div/>").text(a),o,(function(t){t.parent().find('input[value="'+e.services.localizationService.get("UsersNotifications_Cancel")+'"]').focus()}),!0)},t})();t.UserNotificationController=i})(i=t.userNotifications||(t.userNotifications={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.UserNotifications={templateUrl:"components/userNotifications/userNotificationsView.html",controller:e.common.createController(e.controllers.userNotifications.UserNotificationController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.searchText="",this.onSearchTextChange=function(){i.ensureSearchTelemetry(),i.updateGroupList()},this.resolveSearchTelemetry=function(){i.searchTelemetry&&(i.searchTelemetry.resolve(),i.searchTelemetry=null)},this.services=t}return t.createOptions=function(){return{additionalServices:["groupService","localizationService","telemetryService"]}},t.prototype.$onInit=function(){var t=this;this.services.groupService.ensureGroupsInitialization().then((function(){return t.updateGroupList()})),this.unregisterGroupDeletedEvent=this.services.rootScope.$on(e.constants.groupDeletedEventName,(function(e,i){e.stopPropagation(),t.updateGroupList()})),this.watermarkConfig={canEdit:!0,mode:!1,contentNonShared:this.services.localizationService.get("ContentList_EmptySearchResults"),imgClass:"empty-search-img"},this.initialized=!0},t.prototype.$onDestroy=function(){this.unregisterGroupDeletedEvent()},t.prototype.containsSubstring=function(e,t){return!!e&&_.contains(e.toLocaleLowerCase(),t)},t.prototype.ensureSearchTelemetry=function(){this.searchTelemetry||_.isEmpty(this.searchText)||(this.searchTelemetry=this.services.telemetryService.startEvent(e.telemetry.ContentListSearch))},t.prototype.updateGroupList=function(){var e=this,t=_(this.services.groupService.groups);if(this.searchText){var i=this.searchText.toLocaleLowerCase();t=t.filter((function(t){return e.containsSubstring(t.displayName,i)}))}this.groups=t.sortBy((function(e){return e.displayName})).sortBy((function(e){return!e.isMyWorkspace})).value(),this.updateWatermark()},t.prototype.updateWatermark=function(){this.showWatermarkConfig=_.isEmpty(this.groups)},t})();t.WorkspacesContainerController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.WorkspacesContainer={templateUrl:"components/workspacesContainer/workspacesContainer.html",controller:e.common.createController(e.controllers.WorkspacesContainerController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.Permissions,o=e.common.contracts.RealTimeMode,r=(function(){function r(e,i,o,r,a){this.telemetryService=e,this.navigation=i,this.usageMetricsReport=o,this.selectDatasetDialogBuilder=new t.SelectDatasetDialogBuilder(r,a)}return r.prototype.canCreateReport=function(e){var t=e.realTimeMode&&(e.realTimeMode===o.CacheOnly||e.realTimeMode===o.PubNubCacheOnly);return!e.isHidden&&(e.contract.permissions&i.CopyOnWrite)!==i.CopyOnWrite&&!t&&!this.usageMetricsReport.modelBelongsToUsageMetricsContentPack(e)},r.prototype.show=function(){var t=this,i=this.selectDatasetDialogBuilder.show("CreateReportDialog","DashboardContextMenu_CreateReport","CreateReport_Description","CreateReport_Create","PBI_Button_Label_Close",(function(e){return t.canCreateReport(e)}));return i.then((function(i){return i?void(i.openGetData?(t.telemetryService.logEvent(e.telemetry.CreateReportDialogImport),t.navigation.showGetDataSlider()):i.selectedDataset?(t.telemetryService.logEvent(e.telemetry.CreateReportDialogCreate,i.selectedDataset.dbName),t.navigation.navigateToDatasetByDBName(i.selectedDataset.dbName)):t.telemetryService.logEvent(e.telemetry.CreateReportDialogCanceled)):void t.telemetryService.logEvent(e.telemetry.CreateReportDialogCanceled)})),i},r})();t.CreateReportDialogBuilder=r})(t=e.dialogs||(e.dialogs={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=(function(){function t(e,t){this.services=t,this.scope=e,this.scope.$on(i.tileAddedToMobileSimulatorEventName,(function(){$(i.dashboardSelector).animate({scrollTop:$(i.tileContainerSelector).height()},"slow")}))}return t.createOptions=function(){return{additionalServices:["telemetryService"]}},t.prototype.$onDestroy=function(){for(var e=this.viewModel.mobileDashboard.tiles,t=0,i=e;t<i.length;t++){var o=i[t];o.gridLayoutContext&&o.gridLayoutContext.setActiveLayout(0),o.invalidateLayout()}this.raiseExitMobileAuthoringEmptyIfNeeded()},t.prototype.pinnedTiles=function(){return _.filter(this.viewModel.mobileDashboard.tiles,(function(e){return e.hasLayoutPosition(1)}))},t.prototype.raiseExitMobileAuthoringEmptyIfNeeded=function(){var t=this.viewModel.mobileDashboard.tiles,i=_.any(t,(function(e){return e.hasLayoutPosition(1)})),o=_.any(t,(function(e){return e.hasLayoutDefinition(1)}));!i&&o&&this.services.telemetryService.logEvent(e.telemetry.DashboardUserExitsAuthoringModeWithEmptyMobileLayout,this.viewModel.mobileDashboard.objectId)},t})();t.DashboardEditMobileDisplayController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.DashboardEditMobileDisplay={templateUrl:"components/dashboardEditMobileDisplay/dashboardEditMobileDisplay.html",bindings:{viewModel:"="},controller:e.common.createController(e.controllers.DashboardEditMobileDisplayController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.prototype.toggle=function(){this.viewModel.isPaneExpanded=!this.viewModel.isPaneExpanded},e})();e.DashboardPaneController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.DashboardPane={templateUrl:"components/dashboardPane/dashboardPane.html",bindings:{viewModel:"="},controller:e.common.createController(e.controllers.DashboardPaneController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=e.common.GridLayoutConstants,r=e.dataServices.TileUtils,a=(function(){function e(e,t){this.scope=e,this.services=t,this.currentUnpinedTileList=this.getLastUnpinnedTiles()}return e.createOptions=function(){return{additionalServices:["dashboardService"]}},e.prototype.shouldShowUnpinnedTileList=function(){return!_.isEmpty(this.unpinnedTiles())},e.prototype.unpinnedTiles=function(){return this.prepareCurrentUnpinedTileList(),this.currentUnpinedTileList},e.prototype.getLastUnpinnedTiles=function(){return this.viewModel?_.filter(this.viewModel.tiles,(function(e){return!e.hasLayoutPosition(1)})):[]},e.prototype.prepareCurrentUnpinedTileList=function(){var e=this.getLastUnpinnedTiles(),t=_.map(e,(function(e){return e.id})),i=_.map(this.currentUnpinedTileList,(function(e){return e.id})),r=this.findTileListDiff(t,i,e),a=this.findTileListDiff(i,t,this.currentUnpinedTileList);_.remove(this.currentUnpinedTileList,(function(e){return _.contains(a,e)}));for(var n=0,s=r;n<s.length;n++){var c=s[n];this.currentUnpinedTileList.push(c),c.calculateLayout({height:o.defaultGridHeight,width:o.defaultGridWidth})}},e.prototype.findTileListDiff=function(e,t,i){var o=_.difference(e,t);return _.filter(i,(function(e){return _.contains(o,e.id)}))},e.prototype.tileTrackerFn=function(e){return r.tileTrackerFn(e,this.viewModel.objectId)},e.prototype.addTileToMobile=function(e){var t=this.findVacantRow(),o=1,a=[];e.shouldNewBadgeAppear=!1,a.push(r.createDefaultPhoneByTile(t,o,e)),this.scope.$emit(i.domLayoutChangedEvent),this.services.dashboardService.batchUpdateTileSizePosition(this.viewModel,a),this.scope.$emit(i.tileAddedToMobileSimulatorEventName)},e.prototype.findVacantRow=function(){var e;e=1;for(var t=_.filter(this.viewModel.tiles,(function(e){return e.hasLayoutPosition(1)})),i=0,o=t;i<o.length;i++){var r=o[i],a=r.gridLayouts[1].position;e<a.y+a.height&&(e=a.y+a.height)}return e},e})();t.DashboardTileListController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.DashboardTileList={templateUrl:"components/dashboardTileList/dashboardTileList.html",bindings:{viewModel:"<"},controller:e.common.createController(e.controllers.DashboardTileListController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["errorService"]}},e.prototype.seeErrorDetails=function(){var e=this.errorText,t=this.errorText,i=this.errorDetails.displayableErrorInfo;if(this.errorDetails&&i)for(var o=0,r=i.length;o<r;o++){var a=i[o];if(a.errorInfoValue){e=a.errorInfoKey,t=a.errorInfoValue;break}}this.services.errorService.error(t,"Tile_FailedToDisplay",{title:e,helpLink:this.errorDetails.helpLink})},e})();e.ErrorPlaceholderController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ErrorPlaceholder={bindings:{errorText:"=",errorDetails:"=?"},templateUrl:"components/errorPlaceholder/errorPlaceholder.html",controller:e.common.createController(e.controllers.ErrorPlaceholderController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=e.common.contracts.PublishOrRefreshStatus,r=(function(){function t(e,t){var i=this;this.services=t,this.refreshDatasetModel={},e.$watch((function(){return i.viewModel.currentRefreshStartingTime}),(function(){i.updateDatasetMetadata()}))}return t.createOptions=function(){return{additionalServices:["refreshService","modelConverter","localizationService","historyDialogService","modelService","packageService"]}},t.prototype.$onInit=function(){this.datasetMetadata=this.getDatasetMetadata(this.viewModel)},t.prototype.showHistoryDialog=function(){this.services.historyDialogService.showHistoryDialog(this.refreshDatasetModel)},t.prototype.getDatasetMetadata=function(o,r){var a=this,n=this.services.refreshService,s=this.services.modelConverter,c=this.services.localizationService,l=this.services.historyDialogService,d=[],p=function(i){o.contentProviderId=i.contentProviderId,o.onPremModelConnectionString=i.onPremModelConnectionString,o.directQueryMode=i.directQueryMode,o.currentRefreshStartingTime=i.currentRefreshStartingTime,o.refreshSchedule=i.refreshSchedule,o.refreshHistories=i.refreshHistories,o.insightsSupported=i.insightsSupported,o.storageProviderType=i.storageProviderType,d=o.onPremModelConnectionString?t.addRefreshInfoForOnPremAnalysisServicesToMetadata(r):o.directQueryMode?t.addRefreshInfoForDirectQueryModel(r):t.addRefreshStatusToMetadata(s,i,c,l,a.refreshDatasetModel,r),n.isModelRefreshInProgress(i)?t.updateMetadataValue(r,"refreshInProgress",e.common.models.ContextMenuItemMetadataType.Text,(function(){return c.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_RefreshInProgress")})):t.deleteMetadataItem(r,"refreshInProgress",e.common.models.ContextMenuItemMetadataType.Text)},u=this.services.modelService.findModel(o.id,o.packageId);return u&&(this.setMissingPropertiesOnContractModelFromPackage(u),p(u.contract),this.refreshDatasetModel.dataset=i.convertModelToDataset(u.contract)),d},t.addRefreshInfoForOnPremAnalysisServicesToMetadata=function(i){var o=[],r=e.common.localize.get("SettingsDataset_DisableEntireRefreshPageErrorMessage_OnPremAnalysisServicesScheduleInfo");return o.push({name:"OnPremASRefreshInfo",type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return r}}),t.updateMetadataValue(i,"OnPremASRefreshInfo",e.common.models.ContextMenuItemMetadataType.Text,(function(){return r})),o},t.addRefreshInfoForDirectQueryModel=function(i){var o=[],r=e.common.localize.get("SettingsDataset_DisableEntireRefreshPageErrorMessage_DirectQueryScheduleInfo");return o.push({name:"DirectQueryRefreshInfo",type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return r}}),t.updateMetadataValue(i,"DirectQueryRefreshInfo",e.common.models.ContextMenuItemMetadataType.Text,(function(){return r})),o},t.addRefreshStatusToMetadata=function(r,a,n,s,c,l){var d,p,u=[],v=i.convertRefreshTimeToJsDateTime(a.lastRefreshTime),h=!1;a.lastRefreshStatus===o.RefreshError?(d=e.common.models.ContextMenuItemMetadataType.Action,p=n.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshFailed",[""+v]),h=!0):a.lastRefreshStatus===o.PublishError?(d=e.common.models.ContextMenuItemMetadataType.Action,p=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastPackagePublishFailed")):(d=e.common.models.ContextMenuItemMetadataType.Text,p=n.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshSucceeded",[""+v])),u.push({name:"lastRefreshStatus",type:d,isWarning:h,value:function(){return p},actionOnClick:function(){s.showHistoryDialog(c)},actionText:function(){return p}}),t.updateMetadataValue(l,"lastRefreshStatus",d,(function(){return p}),h,void 0,void 0,void 0,(function(){s.showHistoryDialog(c)}));var g=t.isModelScheduledRefreshEnabled(a),m=t.doesStorageSourceAllowRefresh(a),f=t.isStorageSourceRefreshEnabled(a);if(m)if(f&&g){var y=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NextRefresh")+i.convertRefreshTimeToJsDateTime(a.nextRefreshTime);t.showNextRefresh(y,u,l)}else if(!f&&g){var y=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NotOneDriveNextScheduled")+i.convertRefreshTimeToJsDateTime(a.nextRefreshTime);t.showNextRefresh(y,u,l)}else if(f&&!g){var y=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_OneDriveEnabledRefreshNotEnabled");t.showRefreshDisabled(y,u,l)}else{var y=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NotOneDriveAndScheduleRefreshNotEnabled");t.showRefreshDisabled(y,u,l)}else if(g){var y=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NextRefresh")+i.convertRefreshTimeToJsDateTime(a.nextRefreshTime);t.showNextRefresh(y,u,l)}else{var y=n.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_RefreshNotEnabled");t.showRefreshDisabled(y,u,l)}return u},t.isModelScheduledRefreshEnabled=function(t){return t.refreshSchedule.refreshEnabled!==!1&&(t.contentProviderId===e.controllers.ContentProviderIds.salesforce||t.isAllDataSourcesSupportedForRefresh!==!1)},t.updateMetadataValue=function(e,t,i,o,r,a,n,s,c,l){if(void 0===r&&(r=!1),e){for(var d=void 0,p=0,u=e.length;p<u;p++){var v=e[p];if(v.name===t){d=v;break}}d?(d.value=o,d.isWarning=r,d.linkText=a,d.linkUrl=n,d.linkTitle=s,d.actionOnClick=c,d.type=i,d.infoTooltipConfig=l):e.push({name:t,type:i,value:o,linkText:a,linkUrl:n,linkTitle:s,linkTarget:"_blank",actionOnClick:c,isWarning:r,infoTooltipConfig:l})}},t.deleteMetadataItem=function(e,t,i){if(e){for(var o=void 0,r=0,a=e.length;r<a;r++){var n=e[r];if(n.name===t&&n.type===i){o=r;break}}o&&e.splice(o,1)}},t.getNextRefreshTimeName=function(){var e="nextRefreshTime";return e},t.getRefreshScheduleNotSetupName=function(){var e="refreshScheduleNotSetUp";return e},t.showNextRefresh=function(i,o,r){var a=t.getNextRefreshTimeName();t.deleteMetadataItem(r,"refreshScheduleNotSetUp",e.common.models.ContextMenuItemMetadataType.Text),o.push({name:a,type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return i}}),t.updateMetadataValue(r,a,e.common.models.ContextMenuItemMetadataType.Text,(function(){return i})),t.deleteMetadataItem(r,t.getRefreshScheduleNotSetupName(),e.common.models.ContextMenuItemMetadataType.Text)},t.doesStorageSourceAllowRefresh=function(t){return t.storageProviderType===e.common.contracts.StorageProviderType.OneDrive||t.storageProviderType===e.common.contracts.StorageProviderType.SharePoint},t.isStorageSourceRefreshEnabled=function(e){return e.isPackageRefreshEnabled},t.prototype.updateDatasetMetadata=function(){this.getDatasetMetadata(this.viewModel,this.datasetMetadata)},t.showRefreshDisabled=function(i,o,r){var a=t.getRefreshScheduleNotSetupName();t.deleteMetadataItem(r,t.getNextRefreshTimeName(),e.common.models.ContextMenuItemMetadataType.Text),o.push({name:a,type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return i}}),t.updateMetadataValue(r,a,e.common.models.ContextMenuItemMetadataType.Text,(function(){return i}))},t.prototype.setMissingPropertiesOnContractModelFromPackage=function(e){var t=this.services.packageService.findPackage(e.packageId);t&&(void 0===e.contract.storageProviderType&&(e.contract.storageProviderType=t.contract.storageProviderType),e.contract.isPackageRefreshEnabled=t.contract.IsRefreshEnabled)},t})();t.MetadataContainerController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.MetadataContainer={templateUrl:"components/metadataContainer/metadataContainer.html",controller:e.common.createController(e.controllers.MetadataContainerController),bindings:{viewModel:"="}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=e.common.contracts.PublishOrRefreshStatus,r=e.common.contracts.ContentTileType,a=e.common.contracts.Permissions,n=(function(){function n(e,t){this.services=t,this.canShowNew=!0}return n.createOptions=function(){return{additionalServices:["localizationService","modelService","telemetryService","errorService","ownership","modelHttpService","dashboardService","reportService","workbookService","conceptualModelSetting"]}},n.prototype.$onInit=function(){this.initViewModelContract(),this.icon=this.isViewModelShared()?e.models.NavigationPaneListItemIcon.Shared:e.models.NavigationPaneListItemIcon.None,this.tooltipConfig={tooltipLocalizeDescription:"NavigationPane_RefreshError",tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft}},n.prototype.isShared=function(){return(!this.services.conceptualModelSetting.isListViewEnabled()||!this.viewModel.contentTileType||this.viewModel.contentTileType===r.Favorite)&&(this.viewModelContract?this.icon===e.models.NavigationPaneListItemIcon.Shared&&this.viewModelContract.packagePublishStatus!==o.PublishError&&this.viewModelContract.lastRefreshStatus!==o.RefreshError:this.icon===e.models.NavigationPaneListItemIcon.Shared)},n.prototype.isNew=function(){return this.viewModelContract?this.canShowNew&&this.viewModel.isNew&&this.viewModelContract.packagePublishStatus!==o.PublishError&&this.viewModelContract.packagePublishStatus!==o.RefreshError&&!this.isRefreshInProgress():this.canShowNew&&this.viewModel.isNew},n.prototype.isPublishError=function(){return!!this.viewModelContract&&this.getPackagePublishStatus()===o.PublishError},n.prototype.showIcon=function(){if(this.viewModelContract){var t=this.services.modelService.findModel(this.viewModelContract.id,this.viewModelContract.packageId);if(t)return t.packagePublishStatus!==e.common.contracts.PublishOrRefreshStatus.PublishError&&t.contract.lastRefreshStatus!==e.common.contracts.PublishOrRefreshStatus.RefreshError}return!1},n.prototype.showRefreshError=function(){if(this.viewModelContract){var t=this.services.modelService.findModel(this.viewModelContract.id,this.viewModelContract.packageId);if(t)return t.packagePublishStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError||t.contract.lastRefreshStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError}return!1},n.prototype.isRefreshInProgress=function(){if(this.viewModelContract){var e=this.services.modelService.findModel(this.viewModelContract.id,this.viewModelContract.packageId);return!!e&&e.isRefreshInProgress}return!1},n.prototype.getPackagePublishStatus=function(){var t=this.services.modelService.findModel(this.viewModelContract.id,this.viewModelContract.packageId);return t?t.packagePublishStatus:e.common.contracts.PublishOrRefreshStatus.FinishedSuccessfully},n.prototype.showRefreshErrorDialog=function(){var t=this,i=this.services.telemetryService,r=i.startEvent(e.telemetry.DashboardGetRefreshHistoriesOnRefreshFailures);this.viewModelContract.lastRefreshStatus===o.RefreshError&&this.viewModelContract.packagePublishStatus===o.RefreshError?this.services.modelHttpService.getModelRefreshHistories(this.viewModelContract.id.toString(),r.event).then((function(e){t.processModelAndPackageRefreshHistories(r,e)}),(function(e){t.processModelAndPackageRefreshHistories(r)})):this.viewModelContract.lastRefreshStatus===o.RefreshError?this.services.modelHttpService.getModelRefreshHistories(this.viewModelContract.id.toString(),r.event).then((function(e){t.displaySuccessHistoryResult(e.data),r.resolve()}),(function(e){t.displayErrorHistoryResult(),r.reject()})):this.viewModelContract.packagePublishStatus===o.RefreshError&&this.services.modelHttpService.getPackageRefreshHistories(this.viewModelContract.packageId.toString(),r.event).then((function(e){t.displaySuccessHistoryResult(e.data),r.resolve()}),(function(e){t.displayErrorHistoryResult(),r.reject()}))},n.prototype.isViewModelShared=function(){return this.viewModel.contentTileType===r.Favorite?this.viewModel.permissions===a.Read||this.viewModel.permissions===a.ReadReshare:this.services.ownership.isResourceSharedWithMe(this.viewModel)},n.prototype.displaySuccessHistoryResult=function(e){if(_.isEmpty(e));else{var i=t.SettingsDatasetController.getFriendlyErrorMessage(e[0].serviceExceptionJson),o=this.parseAdditionalErrorInfo(e[0].serviceExceptionJson);this.services.errorService.errorNoDefaultAdditionalErrorInfo(i,"RefreshFailure",{displayableErrorInfo:o})}},n.prototype.displayErrorHistoryResult=function(){this.services.errorService.error(this.services.localizationService.get("RefreshError_Unknown"),"RefreshFailure_FailedToGetHistories")},n.prototype.parseAdditionalErrorInfo=function(e){var i=t.SettingsDatasetController.convertErrorDetailsJson(e),o=[];return i.forEach((function(e){o.push({errorInfoKey:e.Name,errorInfoValue:e.Value})})),o},n.prototype.processModelAndPackageRefreshHistories=function(e,t){var o=this;this.services.modelHttpService.getPackageRefreshHistories(this.viewModelContract.packageId.toString(),e.event).then((function(r){var a;if(!t||_.isEmpty(t.data)||t.data[0].isSuccessful)a=!1;else if(_.isEmpty(r.data)||r.data[0].isSuccessful)a=!0;else{var n=i.convertRefreshTimeToJsDateTime(t.data[0].endTime).getTime(),s=i.convertRefreshTimeToJsDateTime(r.data[0].endTime).getTime();a=n>s}a?o.displaySuccessHistoryResult(t.data):o.displaySuccessHistoryResult(r.data),e.resolve()}),(function(){t?(o.displaySuccessHistoryResult(t.data),e.resolve()):(o.displayErrorHistoryResult(),e.reject())}))},n.prototype.initViewModelContract=function(){var e=this.viewModel;switch(e.contentTileType){case r.Dashboard:case r.Report:e.modelIds&&e.packageIds&&e.modelIds.length>0&&e.packageIds.length>0&&(this.viewModelContract=this.services.modelService.findModel(this.viewModel.modelIds[0],this.viewModel.packageIds[0]));break;case r.Workbook:var t=this.viewModel,i=this.services.workbookService.findWorkbookByUniqueId(t.uniqueId);this.viewModelContract=this.services.modelService.findModel(i.modelId,i.packageId);break;default:this.viewModelContract=this.viewModel.contract}},n})();t.DatasetIconContainerController=n})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.DatasetIconContainer={templateUrl:"components/datasetIconContainer/datasetIconContainer.html",controller:e.common.createController(e.controllers.DatasetIconContainerController),bindings:{viewModel:"=",refreshRelated:"=",canShowNew:"<?"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.scope=e,this.services=t}return t.createOptions=function(){return{additionalServices:["localizationService","settingsMetadataService","modelService","dashboardService","reportService","workbookService","contentList","taskPaneSliderService"]}},t.prototype.$onInit=function(){var t=this;this.settingsType=this.services.settingsMetadataService.getSettingsType(),this.artifactObjectId=this.services.settingsMetadataService.getArtifactObjectId(),this.saveButtonText=this.services.localizationService.get("SettingsBlade_Save"),this.isSaving=!1,this.isWorkbook=!1,this.scope.$on(e.constants.hideTaskPaneSliderOnClickEventName,(function(e){return t.cancel()})),this.prepareToPopulateSettings()},t.prototype.$postLink=function(){window.setTimeout((function(){var e=angular.element(document.getElementsByClassName("nameInput"));e.focus()}),100)},t.prototype.prepareToPopulateSettings=function(){switch(this.settingsType){case 1:var e=this.services.dashboardService.findDashboardByGUID(this.artifactObjectId);this.artifactLabel=this.services.localizationService.get("SettingsBlade_DashboardName"),this.artifact=e,this.isSettingsPane=!0,this.ownerInfo=e.ownerFullname,this.ownerMail=e.ownerMail,this.populateDisplayName(e.displayName);break;case 2:var t=this.services.reportService.findReportByGUID(this.artifactObjectId);this.artifactLabel=this.services.localizationService.get("SettingsBlade_ReportName"),this.artifact=t,this.isSettingsPane=!1,this.populateDisplayName(t.displayName);break;case 3:var i=this.services.workbookService.findWorkbookByUniqueId(this.artifactObjectId);this.artifactLabel=this.services.localizationService.get("SettingsBlade_WorkbookName"),this.artifact=i,this.isSettingsPane=!1,this.isWorkbook=!0,this.populateDisplayName(i.displayName);break;case 4:var o=this.services.modelService.findModelByDBName(this.artifactObjectId);this.artifactLabel=this.services.localizationService.get("SettingsBlade_ModelName"),this.artifact=o,this.isSettingsPane=!1,this.populateDisplayName(o.displayName)}},t.prototype.saveModelName=function(t){switch(this.isSaving=!0,this.saveButtonText=this.services.localizationService.get("GroupEditor_WaitForSave"),this.settingsType){case 1:var i=this.services.dashboardService.findDashboardByGUID(this.artifactObjectId);this.services.dashboardService.renameDashboard(t,i.id),this.scope.$broadcast(e.constants.saveDashboardSettings);break;case 2:var o=this.services.reportService.findReportByGUID(this.artifactObjectId);this.services.reportService.renameReport(t,o.id);break;case 3:var r=this.services.workbookService.findWorkbookByUniqueId(this.artifactObjectId);this.services.workbookService.renameWorkbook(t,r.id,r.packageId);break;case 4:var a=this.services.modelService.findModelByDBName(this.artifactObjectId);this.services.modelService.renameModel(t,a.id,a.packageId)}this.unselectTileAndHideTaskPane()},t.prototype.cancel=function(){this.artifact.displayName=this.oldDisplayName,this.unselectTileAndHideTaskPane()},t.prototype.unselectTileAndHideTaskPane=function(){this.artifact.isContentTileSelected=!1,this.services.taskPaneSliderService.collapsePane()},t.prototype.isDisabled=function(){return this.scope.settingsForm&&!this.scope.settingsForm.$dirty&&this.scope.dashboardSettingsForm&&!this.scope.dashboardSettingsForm.$dirty||this.isSaving||this.artifact&&""===this.artifact.displayName},t.prototype.constructArtifactName=function(e){return this.isSettingsPane||this.isWorkbook?this.services.localizationService.format("SettingsBlade_SettingsFor",[e]):this.services.localizationService.format("SettingsBlade_SettingRename",[e])},t.prototype.populateDisplayName=function(e){this.oldDisplayName=e,this.artifactName=this.constructArtifactName(e),this.displayName=e},t})();t.SettingsBladeController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsBlade={controller:e.common.createController(e.controllers.SettingsBladeController),templateUrl:"components/settingsBlade/settingsBlade.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Subscriptions=0]="Subscriptions"})(t=e.SettingsCommunicationsSubgroupType||(e.SettingsCommunicationsSubgroupType={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e.createOptions=function(){return{additionalServices:[]}},e})();e.SettingsCommunicationsController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsCommunications={bindings:{viewModel:"<"},controller:e.common.createController(e.controllers.SettingsCommunicationsController),templateUrl:"components/settingsCommunications/settingsCommunications.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.ArtifactType,o=e.common.models.CollapsiblePaneExpandedWidth,r=e.helpers.ContentTileHelper,a=e.common.contracts.ContentTileType,n=jsCommon.EnumExtensions,s=e.common.contracts.Permissions,c=e.common.constants.TaskPaneCollapsiblePaneMode,l=(function(){function t(i,o){var r=this;this.viewRelated=!0,this.canRewrite=function(e){return n.hasFlag(e,s.All)||n.hasFlag(e,s.ReadWrite)},this.canExportPowerPoint=function(e){return!1},this.canRefreshNow=function(){var e=r.viewModel;return(e.contentTileType===a.AppDataset||e.contentTileType===a.Workbook)&&r.services.contentList.canRefreshNow(e)},this.isExportAllowed=function(e){if(e===a.Dashboard){var i=r.services.$location.search()[t.isDasboardExportAllowedQueryString];return i&&"1"===i}return!1},this.canEditWorkbook=function(t){return t===a.Workbook&&r.viewModel instanceof e.dataServices.models.Workbook&&r.viewModel.isEditable()},this.canReplaceWorkbook=function(e){return e===a.Workbook&&r.services.contentList.canReplaceWorkbook(r.viewModel)},this.canOpenUsageMetricsReport=function(e){var t=r.services.licenseEnforcementService.supportsUsageMetrics();return r.services.featureSwitchService.featureSwitches.usageMetricsEnabled&&t&&n.hasFlag(r.viewModel.getPermissions(),s.All)&&(e===a.Dashboard||e===a.Report)},this.unfavoriteContentTile=function(e){r.services.contentList.removeFavorite(r.viewModel)},this.deleteContentTile=function(t){
var i=r.viewModel;switch(t){case a.Dashboard:n.hasFlag(i.getPermissions(),s.All)||n.hasFlag(i.getPermissions(),s.ReadWrite)?r.services.contentList.deleteContent(i,!0):n.hasFlag(i.getPermissions(),s.CopyOnWrite)?r.services.contentList.identifyAndDeleteContent(i):r.services.contentList.deleteContent(i,!1);break;case a.Report:(i.getPermissions()&e.common.models.ReportPermissions.CopyOnWrite)===e.common.models.ReportPermissions.CopyOnWrite?r.services.contentList.identifyAndDeleteContent(i):r.services.contentList.deleteContent(i);break;case a.Workbook:case a.OrgApp:r.services.contentList.identifyAndDeleteContent(i)}},this.contentTileRename=function(e){r.services.overlayService.hideAllDropdowns(),r.services.contentList.showRename(r.viewModel)},this.refreshNow=function(){r.services.contentList.refreshNow(r.viewModel)},this.scheduleRefresh=function(){r.services.contentList.scheduleRefresh(r.viewModel)},this.exportDashboard=function(e){r.services.contentList.exportDashboard(r.viewModel)},this.editWorkbook=function(e){r.services.contentList.editWorkbook(r.viewModel)},this.replaceWorkbook=function(e){r.services.contentList.replaceWorkbook(r.viewModel)},this.favoriteContentTile=function(e){var t=r.viewModel.workspaceId||r.services.groupService.activeGroupObjectId;r.services.contentList.addFavorite(r.viewModel,t)},this.scope=i,this.services=o}return t.createOptions=function(){return{additionalServices:["$location","activeGroupId","analyzeInExcel","conceptualModelSetting","contentList","favorites","featureSwitchService","groupContextMenuService","groupService","impersonationService","localizationService","navigation","overlayService","permissionService","quota","taskPaneSliderService","userInfo","licenseEnforcementService"]}},t.prototype.$onInit=function(){this.tileType=this.viewModel.contentTileType,this.deleteEnabled=!(this.services.navigation.inAppDetailView()||this.services.navigation.inRecentlyViewedView()),this.viewRelated=this.services.navigation.inContentListView()&&!this.services.navigation.inSharedWithMeView()},t.prototype.canUnFavorite=function(){return!!this.isFavoritable()&&this.services.contentList.isFavorite(this.viewModel)},t.prototype.canFavorite=function(){return!!this.isFavoritable()&&!this.services.contentList.isFavorite(this.viewModel)},t.prototype.isFavoritable=function(){return this.inListView?r.isFavoritableContent(this.viewModel,this.services.conceptualModelSetting):r.isFavoritableContent(this.viewModel)},t.prototype.isFavoriteDisabled=function(){return r.isFavoriteDisabled(this.viewModel,this.services.contentList)},t.prototype.canShare=function(e,t){var i=this;if(t!==a.Dashboard&&t!==a.Favorite)this.canShareTile=!1;else{var o,r=n.hasFlag(e.getPermissions(),s.ReShare),c=void 0;c=t===a.Favorite?e.workspaceId:this.services.groupService.activeGroupObjectId,c?this.services.groupService.ensureGroupsInitialization().then((function(){o=i.services.groupService.getGroup(i.viewModel.workspaceId),o?i.canShareTile=!i.services.permissionService.isGroupWorkspaceReadOnly(o.contract.isReadOnly,o.contract.isOwner)&&r:i.canShareTile=r})):this.canShareTile=r}},t.prototype.canPersonalize=function(){var t=this.viewModel;if(this.services.navigation.inAppDetailView())return!1;var i=n.hasFlag(t.getPermissions(),s.CopyOnWrite);return e.helpers.ContentTileHelper.getActualType(t)===a.Workbook&&i&&n.hasFlag(t.getPermissions(),s.All)||i},t.prototype.canAnalyzeInExcel=function(){var e=this.viewModel;switch(e.contentTileType){case a.Report:case a.AppDataset:return this.services.analyzeInExcel.isAnalyzeInExcelSupported(this.services.featureSwitchService,e.getPermissions());default:return!1}},t.prototype.canRunInsights=function(){var e=this.viewModel;if(e.contentTileType===a.Report||e.contentTileType===a.AppDataset){var t=this.services.contentList.getModels(e),i=t&&t[0];return i&&i.contract.insightsSupported&&n.hasFlag(i.getPermissions(),s.Read)}return!1},t.prototype.runInsights=function(){this.services.contentList.runInsights(this.viewModel)},t.prototype.canScheduleRefresh=function(){var e=this.viewModel;return(e.contentTileType===a.AppDataset||e.contentTileType===a.Workbook)&&this.services.contentList.canScheduleRefresh(this.viewModel)},t.prototype.viewRelatedContent=function(){var e=this.viewModel.contentTileType===a.Dashboard?i.Dashboard:i.Report,t={id:this.viewModel.objectId,artifactType:e,displayName:this.viewModel.displayName,workspaceId:this.viewModel.workspaceId};this.services.taskPaneSliderService.expandPane(c.RelatedContent,o.Default,t)},t.prototype.shareContentTile=function(t,i){var o;o=i===a.Favorite?t.workspaceId:this.services.groupService.activeGroupObjectId,this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.ShareDashboard)||(o||(o=e.constants.myWorkSpaceGroupId),this.services.contentList.shareContent(t,o))},t.prototype.tooltipForSettings=function(e){return e===a.Dashboard?this.services.localizationService.get("ContentTileOptions_Settings"):this.services.localizationService.get("ContentTileOptions_Rename")},t.prototype.personalize=function(){this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.PersonalizeContentPack)||this.services.contentList.personalizeContent(this.viewModel)},t.prototype.analyzeInExcel=function(){this.services.contentList.analyzeContentInExcel(this.viewModel)},t.prototype.exportToPowerPoint=function(){var e=this.services;e.licenseEnforcementService.supportsExportToPowerPoint(!0)&&this.services.contentList.exportToPowerPoint(this.viewModel)},t.prototype.openUsageMetricsReport=function(){var e=this.viewModel,t=this.viewModel.workspaceId||this.services.groupService.activeGroupObjectId;this.services.contentList.openUsageMetricsReport(e,t)},t.prototype.getIconForGroupContextMenuItem=function(e){return this.services.groupContextMenuService.getIconNameForGroupLinkType(e.linkType)},t.prototype.getTooltipForGroupContextMenuItem=function(e){return this.services.groupContextMenuService.getTextForGroupLinkType(e.linkType)},t.prototype.onGroupContextMenuItemSelected=function(e){this.services.groupContextMenuService.performActionWithGroupContextMenuItem(e,this.viewModel)},t})();l.isDasboardExportAllowedQueryString="exportallowed",t.ContentTileOptionsMenuController=l})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ContentTileOptionsMenu={templateUrl:"components/contentTileOptionsMenu/contentTileOptionsMenu.html",controller:e.common.createController(e.controllers.ContentTileOptionsMenuController),bindings:{deleteEnabled:"<?",viewModel:"=",inListView:"<?"}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.models.ContentPackItems,o=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.isLoading=!0,this.scope.$on(e.constants.saveDashboardSettings,(function(){return o.applyChanges()}))}return t.createOptions=function(){return{additionalServices:["localizationService","settingsMetadataService","modelService","dashboardService","reportService","workbookService","modelConverter","errorService","dashboardHttpService","telemetryService","dataClassificationService","featureSwitchService"]}},t.prototype.$onInit=function(){var e=this,t=this.services.localizationService;this.scope.qnaEnabled=this.viewModel.qnaEnabled,this.scope.gravityEnabled=this.viewModel.gravityEnabled,this.scope.onDataClassificationIdChanged=function(){return e.onDataClassificationIdChanged()},this.services.featureSwitchService.featureSwitches.dataClassificationEnabled&&this.services.dataClassificationService.getDataClassificationsAsync().then((function(t){e.scope.dataClassifications=t,t.length&&(e.scope.defaultDataClassification=_.find(t,(function(e){return e.default})),e.scope.dataClassificationId=e.viewModel.dataClassificationId?e.viewModel.dataClassificationId:e.scope.defaultDataClassification.id)})),this.services.settingsMetadataService.getSettings().then((function(t){e.settingsModel=e.services.modelConverter.convertSettingsMetadata(t),e.isLoading=!1,e.settingsModel&&e.settingsModel.dashboards&&e.settingsModel.dashboards.dashboards&&(e.settingsDashboardModel=_.find(e.settingsModel.dashboards.dashboards,(function(t){return t.dashboardId===e.viewModel.id})),null==e.scope.qnaEnabled&&(e.scope.qnaEnabled=e.settingsDashboardModel.hasQnaSupportedModel))}),(function(){e.services.errorService.error(t.get("SettingsGeneral_Error_FailedToLoad"),"SettingsGeneral_Error_FailedToLoad")}))},t.prototype.qnaTooltip=function(e){return e?this.services.localizationService.get("SettingsBlade_QnAEnabled_Tooltip"):this.services.localizationService.get("SettingsBlade_QnADisabled_Tooltip")},t.prototype.gravityTooltip=function(e){return e?this.services.localizationService.get("SettingsBlade_GravityEnabled_Tooltip"):this.services.localizationService.get("SettingsBlade_GravityDisabled_Tooltip")},t.prototype.setQnADirty=function(){this.isQnaDirty=!0},t.prototype.applyChanges=function(){var t=this,o=this.scope,r=this.dashboardSettingsForm;if(r.$dirty){var a=this.settingsDashboardModel,n=a.dashboardId,s=o.qnaEnabled,c=o.gravityEnabled,l=o.dataClassificationId,d=this.services.telemetryService.startEvent(e.telemetry.DashboardSaveDashboardSettings,!1,!1,!1,a.objectId),p=this.getUpdatedDashboardSetting();this.services.dashboardHttpService.updateDashboardSetting(n,p,d.event).then((function(){var o=t.services.dashboardService.findDashboard(n);if(o&&o.isUsedByContentPack&&t.services.rootScope.$emit(e.constants.contentPackDirtyShowNotification,o.id,i.Dashboard),t.scope.qnaEnabled!==a.qnaEnabled&&(a.qnaEnabled=s,t.services.dashboardService.setQnaEnabled(a.dashboardId,s),d.event.info.qnaEnabledUpdated=!0),t.scope.gravityEnabled!==a.gravityEnabled){a.gravityEnabled=c,d.event.info.gravityEnabledUpdated=!0;var r=t.services.dashboardService.dashboardContainerModel.findDashboard(a.dashboardId);r&&(r.contract.gravityEnabled=r.gravityEnabled=c)}if(t.scope.dataClassificationId!==a.dataClassificationId){a.dataClassificationId=l,d.event.info.dataClassificationUpdated=!0;var p=t.services.dashboardService.dashboardContainerModel.findDashboard(a.dashboardId);p&&(p.contract.dataClassificationId=l,p.dataClassificationId=l)}d.resolve()}),(function(e){d.reject(),t.services.errorService.error(t.services.localizationService.get("SettingsDashboards_Error_FailedToSaveDashboards"),"SettingsDashboards_Error_FailedToSaveDashboards",{requestId:e.requestId,statusCode:e.status.toString()})}))}},t.prototype.getUpdatedDashboardSetting=function(){var e=this.settingsDashboardModel;return _.omit({qnaEnabled:this.scope.qnaEnabled!==e.qnaEnabled?this.scope.qnaEnabled:null,gravityEnabled:this.scope.gravityEnabled!==e.gravityEnabled?this.scope.gravityEnabled:null,dataClassificationId:this.scope.dataClassificationId!==e.dataClassificationId?this.scope.dataClassificationId:null},(function(e){return null===e}))},t.prototype.onDataClassificationIdChanged=function(){this.scope.isNonDefaultDataClassificationSelected=this.scope.dataClassificationId!==this.scope.defaultDataClassification.id},t})();t.SettingsDashboardBladeController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsDashboardBlade={controller:e.common.createController(e.controllers.SettingsDashboardBladeController),templateUrl:"components/settingsDashboardBlade/settingsDashboardBlade.html",bindings:{viewModel:"=",dashboardSettingsForm:"="}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.services=t,this.sortType="name",this.sortReverse=!0,this.isLoading=!0}return t.createOptions=function(){return{additionalServices:["localizationService","navigation","telemetryService","subscriptionsHttp","modelConverter","errorService","groupService","subscription","explorationProxy","dashboardHttpService"]}},t.prototype.$onInit=function(){var t=this;this.openSubscriptionSettingsEvent=this.services.telemetryService.logEvent(e.telemetry.EmailSubscriptionsOpenEmailSettings),this.services.subscriptionsHttp.getAllSubscriptions(this.openSubscriptionSettingsEvent).then((function(e){var i=t.services.groupService.activeGroup.displayName;t.viewModel=t.services.modelConverter.convertSettingsCommunications(e,i),t.viewModel&&t.viewModel.columnsHeader&&t.sort(t.viewModel.columnsHeader[0].predicateName)}),(function(i){i.ErrorCode!==e.HttpStatusCode.Unauthorized.toString()&&t.services.errorService.error(t.services.localizationService.get("SettingsGeneral_Error_FailedToLoad"),"SettingsGeneral_Error_FailedToLoad",{requestId:i.RequestId})})).finally((function(){t.isLoading=!1})),this.watermarkConfig={canEdit:!0,mode:!1,titleNonShared:this.services.localizationService.get("ContentList_EmptySubscriptionsTitle"),contentNonShared:this.services.localizationService.get("ContentList_EmptySubscriptionsMessage"),imgClass:"empty-emailsubscriptions-img"}},t.prototype.editSubscription=function(e){var t=this;if(this.isEditingInReport(e))this.services.explorationProxy.get({id:e.reportInfo.reportId}).then((function(e){t.services.subscription.expandPaneForReportSubscription({currentSection:e.sections[0],report:e.report,sections:e.sections,modelId:e.report.modelId})}),(function(e){t.services.errorService.error(t.services.localizationService.get("SettingsGeneral_Error_FailedToLoad"),"SettingsGeneral_Error_FailedToLoad",{requestId:e.requestId})}));else{var i=e.dashboardInfo;this.services.dashboardHttpService.getDashboardContainerByObjectId(i.dashboardObjectId).then((function(e){if(e&&e.data){var o=e.data,r=_.map(o.models,(function(e){return e.id}));t.services.subscription.expandPaneForDashboardSubscription({dashboardId:i.dashboardId,dashboardName:i.displayName,dashboardObjectId:i.dashboardObjectId,modelIds:r})}}))}},t.prototype.isEditingInReport=function(e){return!!e.reportInfo},t.prototype.getSubscriptionsCount=function(e){var t=e.subscriptions.length;return 1===t?this.services.localizationService.get("SettingsCommunication_CountOfSubscription"):this.services.localizationService.format("SettingsCommunication_CountOfSubscriptions",[t])},t.prototype.getTypeLabel=function(e){return e.reportInfo?this.services.localizationService.get("SettingsCommunication_Report"):e.dashboardInfo?this.services.localizationService.get("SettingsCommunication_Dashboard"):void 0},t.prototype.getArtifactDisplayName=function(e){return e.reportInfo?e.reportInfo.displayName:e.dashboardInfo?e.dashboardInfo.displayName:void 0},t.prototype.sort=function(e){var t=this;this.sortReverse=!this.sortReverse,this.sortType=e,this.viewModel.subscriptions.sort((function(i,o){var r=t.getProperty(i,e),a=t.getProperty(o,e),n=r>a;return t.sortReverse&&(n=r<a),n?1:-1}))},t.prototype.getTooltipConfig=function(e){return{tooltipDescription:this.getArtifactDisplayName(e)||""}},t.prototype.getWaterMarkConfig=function(){return this.watermarkConfig},t.prototype.getProperty=function(e,t){return"count"===t?e.subscriptions.length:(e.reportInfo||e.dashboardInfo)[t]},t})();t.SettingsSubscriptionsController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsSubscriptions={bindings:{viewModel:"<"},controller:e.common.createController(e.controllers.SettingsSubscriptionsController),templateUrl:"components/settingsSubscriptions/settingsSubscriptions.html"}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=e.common.models.ContextMenuItemMetadataType,r=(function(){function r(e,t){this.scope=e,this.services=t}return r.createOptions=function(){return{additionalServices:["refreshService","errorService","telemetryService","localizationService","workbookService","modelService","packageService","historyDialogService","featureSwitchService","ownership","permissionService"]}},r.prototype.$onInit=function(){this.workbookModel=this.viewModel,this.model=new e.models.WorkbookNavigationPaneListItemModel(this.workbookModel),this.refreshDatasetModel={},this.workbookModel&&(this.model.metadata=this.getWorkbookMetadata(this.workbookModel.contract))},r.addLastRefreshForNonModelWorkbook=function(t,o){var a=i.convertRefreshTimeToJsDateTime(t),n=e.common.localize.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshSucceeded",[""]);return r.addInfoForWorkbook("WorkbookIsUpToDate",""+a,o,null,n.toLocaleUpperCase())},r.addRefreshInfoForNotSupportedModelWorkbook=function(t){var i=e.common.localize.get("WorkbookContextMenu_NotSupportedModel_RefreshNotSupported");return r.addInfoForWorkbook("WorkbookIsUpToDate",i,t)},r.updateMetadataValue=function(e,t,i,o,r,a,n,s,c,l,d){if(void 0===r&&(r=!1),e){for(var p=void 0,u=0,v=e;u<v.length;u++){var h=v[u];if(h.name===t){p=h;break}}p?(p.value=o,p.isWarning=r,p.linkText=a,p.linkUrl=n,p.linkTitle=s,p.actionOnClick=c,p.type=i,p.infoTooltipConfig=l,p.label=d):e.push({name:t,type:i,value:o,linkText:a,linkUrl:n,linkTitle:s,linkTarget:"_blank",actionOnClick:c,isWarning:r,infoTooltipConfig:l,label:d})}},r.addInfoForWorkbook=function(e,t,i,a,n){var s=[];return s.push({name:e,type:o.Text,label:n,value:function(){return t},infoTooltipConfig:a}),r.updateMetadataValue(i,e,o.Text,(function(){return t}),null,null,null,null,null,a,n),s},r.addSpoFileName=function(t,i,o){var a=[],n=e.common.localize.get("WorkbookContextMenu_SpoFileName"),s=t.substring(t.lastIndexOf("/")+1);return a.push({name:"spoFileNameAndLink",type:e.common.models.ContextMenuItemMetadataType.Link,value:function(){return""},label:n.toLocaleUpperCase(),linkText:function(){return s},linkUrl:function(){return i},linkTitle:function(){return t},linkTarget:"_blank"}),r.updateMetadataValue(o,"spoFileNameAndLink",e.common.models.ContextMenuItemMetadataType.Link,(function(){return""}),!1,(function(){return s}),(function(){return i}),(function(){return t}),void 0,void 0,n.toLocaleUpperCase()),a},r.addExcelLocalFileInfo=function(t,i,o,a,n){var s;return n?(s=e.common.localize.format(t,[""]),r.addInfoForWorkbook(o,n,i,a,s.toLocaleUpperCase())):(s=e.common.localize.get(t),r.addInfoForWorkbook(o,s,i,a))},r.prototype.getWorkbookMetadata=function(e,a){var n=this,s=this.services.localizationService,c=this.services.historyDialogService,l=[],d=this.services.workbookService.findWorkbook(e.id,e.packageId);if(this.services.packageService.isLocalWorkbook(this.workbookModel.packageId)){l=l.concat(r.addExcelLocalFileInfo("WorkbookContextMenu_LocalFileName",a,"localFileName",o.Text,this.workbookModel.contract.sourceFilePath)),l=l.concat(r.addExcelLocalFileInfo("WorkbookContextMenu_Source",a,"FileSource",o.Text,this.services.localizationService.get("WorkbookContextMenu_Source_LocalFile")));var p=this.services.packageService.findPackage(this.workbookModel.packageId);if(p){var u=""+i.convertRefreshTimeToJsDateTime(p.lastRefreshTime);l=l.concat(r.addExcelLocalFileInfo("WorkbookContextMenu_LocalFile_LastUpdateTime",a,"localFileLastUpdated",o.Text,u))}return l}d.contract.sourceFilePath&&(l=l.concat(r.addSpoFileName(d.contract.sourceFilePath,d.viewUrl,a))),d.isOwner()&&(l=l.concat(r.addExcelLocalFileInfo("WorkbookContextMenu_Source",a,"FileSource",o.Text,this.services.localizationService.get("WorkbookContextMenu_Source_SharePointOneDrive"))));var v=this.services.modelService.findModel(this.workbookModel.modelId,this.workbookModel.packageId);if(!v){var p=this.services.packageService.findPackage(this.workbookModel.packageId);return p&&(l=l.concat(r.addLastRefreshForNonModelWorkbook(p.lastRefreshTime,a))),l}if(!this.workbookModel.contract.isPowerPivotVersionSupportsRefresh)return l=r.addRefreshInfoForNotSupportedModelWorkbook(a);var h=v.contract,g=function(e){h.contentProviderId=e.contentProviderId,h.onPremModelConnectionString=e.onPremModelConnectionString,h.directQueryMode=e.directQueryMode,h.refreshSchedule=e.refreshSchedule,h.refreshHistories=e.refreshHistories,h.storageProviderType=e.storageProviderType,l=l.concat(t.DatasetNavigationPaneListItemController.addRefreshStatusToMetadata(null,e,s,c,n.refreshDatasetModel,a))};return g(h),this.refreshDatasetModel.dataset=i.convertModelToDataset(h),l},r})();t.SettingsWorkbookBladeController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SettingsWorkbookBlade={controller:e.common.createController(e.controllers.SettingsWorkbookBladeController),templateUrl:"components/settingsWorkbookBlade/settingsWorkbookBlade.html",bindings:{viewModel:"="}}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.contracts,o=i.FrequencyType,r=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.openSubscriptionPaneEvent=this.services.telemetryService.logEvent(e.telemetry.EmailSubscriptionsOpenPane),this.subscriptionInfo=this.services.subscription.getInfo(),this.isLoading=!0,this.isUpdating=!1;var r=!1,a=this.isReportSubscription();if(r=a?this.services.licenseEnforcementService.supportsReportEmailSubscription(!0):this.services.licenseEnforcementService.supportsDashboardEmailSubscription(!0),!r)return void this.closePane();this.subscriptionPaneHelper=e.helpers.createSubscriptionPaneHelper(a),this.subscriptionPaneHelper.getAllSubscriptions(this.services.subscriptionsHttp,this.subscriptionInfo,this.openSubscriptionPaneEvent).then((function(e){o.viewModel=o.convertSubscriptionsToViewModel(e)}),(function(t){t.ErrorCode!==e.HttpStatusCode.Unauthorized.toString()&&o.services.errorService.error(o.services.localizationService.get("SubscriptionPane_Error_FailedToLoadSubscriotions"),"SubscriptionPane_Error_FailedToLoadSubscriotions",{requestId:t.RequestId})})).finally((function(){o.isLoading=!1}));var n=this.services.modelService.getModelContracts();if(a)this.models=[_.find(n,(function(e){return e.id===o.subscriptionInfo.reportInfo.modelId}))];else{var s=this.subscriptionInfo.dashboardInfo.modelIds;this.models=_.map(s,(function(e){return _.find(n,(function(t){return t.id===e}))}))}this.refreshSchedules=this.getRefreshSchedules(this.subscriptionInfo)}return t.createOptions=function(){return{additionalServices:["promiseFactory","subscription","subscriptionsHttp","telemetryService","modelService","userInfo","errorService","localizationService","navigation","groupService","notificationToast","licenseEnforcementService"]}},t.prototype.isDraftSubscription=function(e){return 3===e.state},t.prototype.saveChangesAndExit=function(){var t=this;this.isUpdating=!0;var i=this.services.telemetryService.logEvent(e.telemetry.EmailSubscriptionsInertOrUpdateSubscriptions),o=this.services.telemetryService.startChildEvent(i,e.telemetry.EmailSubscriptionsSaveSubscription),r=(this.viewModel.report||this.viewModel.dashboard).subscriptions,a=_.filter(r,(function(e){return 3===e.state})),n=_.filter(r,(function(e){return 1===e.state&&3!==e.previousState})),s=_.filter(r,(function(e){return 2===e.state}));if(_.isEmpty(a)&&_.isEmpty(n)&&_.isEmpty(s))return void this.closePane();var c,l=_.size(a);_.isEmpty(a)||(c=this.addSubscriptions(a)),_.isEmpty(n)||(c=this.deleteSubscriptions(c,n)),_.isEmpty(s)||(c=this.updateSubscriptions(c,s)),c?c.then((function(){o.resolve();var i=t.services.localizationService;if(l>0){var r=i.get("SubscriptionPane_EmailSaveNotificationTitle"),a=i.get("SubscriptionPane_SingleEmailSaveNotification");l>1&&(a=i.get("SubscriptionPane_MultipleEmailSaveNotification")),t.services.notificationToast.notify({title:r,message:a,notificationType:e.common.NotificationToastType.Success})}t.closePane()}),(function(e){t.services.errorService.error(t.services.localizationService.get("SettingsGeneral_Error_FailedToLoad"),"SettingsGeneral_Error_FailedToLoad",{requestId:e.RequestId}),o.reject()})).finally((function(){t.errorRequestId&&t.services.errorService.error(t.services.localizationService.get("SubscriptionPane_Error_FailedToInsertOrUpdateSubscriptions"),"SubscriptionPane_Error_FailedToInsertOrUpdateSubscriptions",{requestId:t.errorRequestId}),t.isUpdating=!1})):(this.closePane(),o.resolve(),this.isUpdating=!1)},t.prototype.addNewSubscription=function(){for(var e=this.getNewSubscription(),t=this.getCurrentSubscriptions(),i=0,o=t;i<o.length;i++){var r=o[i];r.expanded=!1}t.unshift(e)},t.prototype.cancel=function(){this.closePane()},t.prototype.changeSubscriptionToUpdatedState=function(e){3!==e.state&&(e.state=2)},t.prototype.getSubscriptionName=function(e){return this.subscriptionPaneHelper.getSubscriptionName(e)},t.prototype.removeSubscription=function(e){e.previousState=e.state,e.state=1},t.prototype.isSubscriptionDeleted=function(e){return 1===e.state},t.prototype.undoRemoveSubscription=function(e){e.state=e.previousState},t.prototype.navigate=function(){this.closePane();var e=this.services.navigation;if(e.inReportView()||e.inDashboardView())e.showSettingsSlider("communications");else if(this.isReportSubscription()){var t=this.subscriptionInfo.reportInfo.report;e.navigateToReportSubscriptionsPane({groupGUID:this.services.groupService.activeGroup.aadGroupId,reportGUID:t.objectId,reportOriginalGUID:t.originalReportObjectId})}else e.navigateToDashboardSubscriptionsPane(this.subscriptionInfo.dashboardInfo.dashboardObjectId,this.services.groupService.activeGroup.aadGroupId)},t.prototype.canShowSchedule=function(){return this.getHighestFrequencyAllowed()!==(o.Daily|o.AfterDataRefresh)},t.prototype.getAllowedFrequencies=function(){return this.subscriptionPaneHelper.getAllowedFrequencies(this.viewModel)},t.prototype.canAddSubscription=function(){return this.subscriptionPaneHelper.canAddSubscription(this.viewModel)},t.prototype.getSubscriptionSubtitle=function(){return this.subscriptionPaneHelper.getInitialSubscriptionSubTitle(this.viewModel)},t.prototype.isReportSubscription=function(){return!!this.subscriptionInfo.reportInfo},t.prototype.getRefreshSchedules=function(e){var t=this;if(this.subscriptionInfo.reportInfo)return[this.services.modelService.getModelRefreshSchedule(this.subscriptionInfo.reportInfo.modelId)];var i=this.subscriptionInfo.dashboardInfo.modelIds;return _.map(i,(function(e){return t.services.modelService.getModelRefreshSchedule(e)}))},t.prototype.convertSubscriptionsToViewModel=function(e){for(var t=[],i=this.services.subscription.getCurrentSubscriptionGUID(),r=this.getNewSubscription(),a=this.subscriptionInfo,n=a.reportInfo,s=function(e){var o=void 0;if(n){var s=_.filter(n.sections,(function(t){return t.id===e.sections[0].sectionId}));o=s&&s[0]}var l={id:e.id,expirationTime:e.expirationTime,objectId:e.objectId,enabled:e.enabled,expanded:!1,selectedFrequency:e.schedule.type,selectedSlide:o,dashboardId:a.dashboardInfo&&a.dashboardInfo.dashboardId,subscriptionName:c.getInitialSubscriptionName(),state:0,previousState:0,schedule:{type:e.schedule.type,interval:e.schedule.interval,subdayType:e.schedule.subdayType,subdayTimes:e.schedule.subdayTimes,relativeInterval:e.schedule.relativeInterval,recurrenceFactor:e.schedule.recurrenceFactor,localTimeZoneId:e.schedule.localTimeZoneId,startDate:e.schedule.startDate,endDate:e.schedule.endDate,scheduleId:e.schedule.id},users:e.users};i&&i.toLowerCase()===e.objectId.toLowerCase()&&(l.expanded=!0,r=l),t.push(l)},c=this,l=0,d=e;l<d.length;l++){var p=d[l];s(p)}_.isEmpty(t)&&t.unshift(r);var u,v=this.services.navigation.inReportView(),h=this.services.navigation.inDashboardView(),g=this.services.localizationService;u=v||h?g.get("EmailSnapshot_ManageAllSubscription"):_.isEmpty(r.selectedSlide)?g.get("EmailSnapshot_EditInDashboard"):g.get("EmailSnapshot_EditInReport");var m=[];return this.canShowSchedule()&&(m.push({label:g.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Daily"),frequencyType:o.Daily|o.AfterDataRefresh}),m.push({label:g.get("SettingsDataset_ScheduleRefresh_RefreshFrequency_Weekly"),frequencyType:o.Weekly|o.AfterDataRefresh})),this.subscriptionPaneHelper.getSubscriptionViewModel(u,t,m,this.subscriptionInfo,r)},t.prototype.getInitialSubscriptionName=function(){return this.subscriptionPaneHelper.getInitialSubscriptionName(this.subscriptionInfo)},t.prototype.getCurrentSubscriptions=function(){return this.subscriptionPaneHelper.getCurrentSubscriptions(this.viewModel)},t.prototype.getHighestFrequencyAllowed=function(){return this.subscriptionPaneHelper.getHighestFrequencyAllowed(this.models,this.refreshSchedules)},t.prototype.getNewSubscription=function(){return this.subscriptionPaneHelper.getNewSubscription(this.subscriptionInfo,this.refreshSchedules)},t.prototype.getSubscription=function(e){return this.refreshSchedules=this.getRefreshSchedules(this.subscriptionInfo),this.subscriptionPaneHelper.convertViewModelToContract(e,this.refreshSchedules)},t.prototype.addSubscriptions=function(t){for(var i,o=this,r=function(t){var r=a.services.telemetryService.startEvent(e.telemetry.EmailSubscriptionsAddSubscription);i?i.then((function(){return r.resolve(),o.services.subscriptionsHttp.createSubscription(o.getSubscription(t),r.event)}),(function(e){r.reject(),o.errorRequestId=e.RequestId})):i=a.services.subscriptionsHttp.createSubscription(a.getSubscription(t),r.event)},a=this,n=0,s=t;n<s.length;n++){var c=s[n];r(c)}return i},t.prototype.deleteSubscriptions=function(t,i){for(var o=this,r=function(i){var r=a.services.telemetryService.startEvent(e.telemetry.EmailSubscriptionsDeleteSubscription);t?t.then((function(){return r.resolve(),o.services.subscriptionsHttp.deleteSubscription(i.id,r.event)}),(function(e){r.reject(),o.errorRequestId=e.RequestId})):t=a.services.subscriptionsHttp.deleteSubscription(i.id,r.event)},a=this,n=0,s=i;n<s.length;n++){var c=s[n];r(c)}return t},t.prototype.updateSubscriptions=function(t,i){for(var o=this,r=function(i){var r=a.services.telemetryService.startEvent(e.telemetry.EmailSubscriptionsUpdateSubscription);t?t.then((function(){return r.resolve(),o.services.subscriptionsHttp.updateSubscription(o.getSubscription(i),r.event)}),(function(e){r.reject(),o.errorRequestId=e.RequestId})):t=a.services.subscriptionsHttp.updateSubscription(a.getSubscription(i),r.event)},a=this,n=0,s=i;n<s.length;n++){var c=s[n];r(c)}return t},t.prototype.closePane=function(){this.services.subscription.collapseSubscriptionPane(),this.services.navigation.inReportView()||this.services.navigation.inDashboardView()||this.services.navigation.showSettingsSlider("communications",void 0,!0)},t})();t.SubscriptionPaneController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.SubscriptionPane={templateUrl:"components/subscriptionPane/subscriptionPane.html",controller:e.common.createController(e.controllers.SubscriptionPaneController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e){return e?new n:new s}function o(t,i){var o=t.schedule,r={id:t.id,objectId:t.objectId,enabled:t.enabled,expirationTime:t.expirationTime,schedule:{type:t.selectedFrequency,interval:o&&o.interval||0,subdayType:o&&o.subdayType||e.contracts.FrequencySubdayType.Unknown,recurrenceFactor:o&&o.recurrenceFactor||0,relativeInterval:e.contracts.FrequencyRelativeInterval.Unused,localTimeZoneId:o&&o.localTimeZoneId||i&&i.length>0&&i[0].localTimeZoneId,startDate:o&&o.startDate,endDate:o&&o.endDate,id:o&&o.scheduleId},users:t.users};return r}function r(e,t){var i=a.AfterDataRefresh,o=a.Daily;if(!_.isEmpty(e))for(var r=0,n=e.length;r<n;r++){var s=e[r];if(s.directQueryMode?o=a.Weekly:_.isEmpty(s.onPremModelConnectionString)?s.isPackageRefreshEnabled&&(o=!t[r].isDaily||s.refreshSchedule&&s.refreshSchedule.refreshEnabled?a.Weekly:a.Daily):o=a.Daily,o===a.Weekly)break}return o|i}var a=e.contracts.FrequencyType;t.createSubscriptionPaneHelper=i;var n=(function(){function e(){}return e.prototype.getAllowedFrequencies=function(e){return e.report.allowedFrequency},e.prototype.getSubscriptionName=function(e){return e.selectedSlide.displayName},e.prototype.getAllSubscriptions=function(e,t,i){return e.getReportSubscription(t.reportInfo.report.id,i)},e.prototype.getHighestFrequencyAllowed=function(e,t){return r(e,t)},e.prototype.getNewSubscription=function(e,t,i){
var o=e.reportInfo;return{enabled:!0,expanded:!0,selectedSlide:o.currentSection,selectedFrequency:this.getHighestFrequencyAllowed(t,i),state:3,previousState:0,subscriptionName:this.getInitialSubscriptionName(e)}},e.prototype.getInitialSubscriptionName=function(e){return e.reportInfo.currentSection?e.reportInfo.currentSection.displayName:""},e.prototype.updateSubscription=function(e,t){e.sections=[{sectionId:t.selectedSlide.id}]},e.prototype.getInitialSubscriptionSubTitle=function(e){return e.report.reportName},e.prototype.getCurrentSubscriptions=function(e){return e.report.subscriptions},e.prototype.getSubscriptionViewModel=function(e,t,i,o,r){return{editMessage:e,report:{subscriptions:t,allowedFrequency:i,reportName:o.reportInfo.report.displayName,slides:o.reportInfo.sections,currentSubscription:r}}},e.prototype.convertViewModelToContract=function(e,t){var i=o(e,t);return this.updateSubscription(i,e),i},e.prototype.canAddSubscription=function(e){return!0},e})(),s=(function(){function e(){}return e.prototype.getAllowedFrequencies=function(e){return e.dashboard.allowedFrequency},e.prototype.getSubscriptionName=function(e){return e.subscriptionName},e.prototype.getAllSubscriptions=function(e,t,i){return e.getDashboardSubscription(t.dashboardInfo.dashboardId,i)},e.prototype.getNewSubscription=function(e,t,i){var o=e.dashboardInfo.dashboardId;return{enabled:!0,expanded:!0,dashboardId:o,selectedFrequency:this.getHighestFrequencyAllowed(t,i),state:3,previousState:0,subscriptionName:this.getInitialSubscriptionName(e)}},e.prototype.getHighestFrequencyAllowed=function(e,t){return r(e,t)},e.prototype.getInitialSubscriptionName=function(e){return e.dashboardInfo.dashboardName},e.prototype.updateSubscription=function(e,t){e.dashboards=[{dashboardId:t.dashboardId}]},e.prototype.getInitialSubscriptionSubTitle=function(e){return e.dashboard.dashboardName},e.prototype.getCurrentSubscriptions=function(e){return e.dashboard.subscriptions},e.prototype.getSubscriptionViewModel=function(e,t,i,o,r){return{editMessage:e,dashboard:{subscriptions:t,allowedFrequency:i,dashboardName:o.dashboardInfo.dashboardName,currentSubscription:r}}},e.prototype.convertViewModelToContract=function(e,t){var i=o(e,t);return this.updateSubscription(i,e),i},e.prototype.canAddSubscription=function(e){return _.isEmpty(e.dashboard.subscriptions)},e})()})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.ArrowPosition,o=e.common.models.TooltipTheme,r=(function(){function e(e,t){this.services=t}return e.createOptions=function(){return{additionalServices:["modalDialogService"]}},e.prototype.close=function(){this.services.modalDialogService.close()},e.prototype.exportData=function(){this.services.modalDialogService.close({dataType:this.viewModel.dataType,format:this.convertStringToExportResultFormat(this.viewModel.dataFormat)})},e.prototype.update=function(e){this.viewModel.isCsvFormatDisabled=e===this.viewModel.options[1]},e.prototype.isDataTypeDisabled=function(e){return e===this.viewModel.options[1]&&(this.viewModel.isUnderlyingDisabled||this.viewModel.dataFormat===1..toString())},e.prototype.getTooltipConfigForDataType=function(e){if(!this.isDataTypeDisabled(e))return{tooltipDisable:!0};var t;return t=this.viewModel.isUnderlyingDisabled&&!this.viewModel.isExlFormatDisabled?"UnderlyingData_UnsupportedDataTooltipDescription":"SupportOnlyExlFormat_ToolTipDescription",{tooltipArrowPosition:i.arrowTopMiddle,tooltipDelay:100,tooltipLocalizeTitle:"UnderlyingData_Title",tooltipLocalizeDescription:t,tooltipTheme:o.Dark,isTooltipForModalDialog:!0}},e.prototype.convertStringToExportResultFormat=function(e){return e===(0).toString()?1:0},e})();t.ExportDataDialogController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){t.ExportDataDialog={templateUrl:"components/exportDataDialog/exportDataDialog.html",bindings:{viewModel:"<"},controller:e.common.createController(e.controllers.ExportDataDialogController)}})(t=e.components||(e.components={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){this.modalDialogService=e,this.localizationService=t}return t.prototype.show=function(t,i){var o=e.viewModels.ExportDataDialogViewModelFactory.create(this.localizationService,t,i),r={viewModel:o},a={dialogName:"ExportDataDialog",definitionTemplateCachePath:"components/exportDataDialog/exportDataDialogDefinition.html",bindings:r};return this.modalDialogService.showWebModalDialog(a)},t})();t.ExportDataDialogBuilder=i})(t=e.dialogs||(e.dialogs={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){function t(e,t,i){var o=0===t;return{options:[e.get("ModalDialog_ExportDataSummarized"),e.get("ModalDialog_ExportDataUnderlying")],dataType:0,dataFormat:o?(0).toString():1..toString(),isExlFormatDisabled:!o,isUnderlyingDisabled:!i,isCsvFormatDisabled:!1,exportXlsxUnsupportedType:t}}e.create=t})(t=e.ExportDataDialogViewModelFactory||(e.ExportDataDialogViewModelFactory={}))})(t=e.viewModels||(e.viewModels={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){var t=this;this.scope=e,e.togglePane=function(){return t.togglePane()}}return e.prototype.togglePane=function(){var e=this.scope.viewModel;this.setCollapsePane(e.isExpanded!==!0)},e.prototype.setCollapsePane=function(e){var t=this.scope.viewModel;t.isExpanded=e},e})();e.CollapsiblePaneController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=e.common.helpers,r=e.common.contracts.ConfigurationPageType,a=e.helpers.ContentProviderStoreHelper,n=jsCommon.DOMConstants,s=(function(){function t(t,r,s){void 0===s&&(s=navigator.userAgent);var c=this;this.scope=t,this.scope.showIFrame=!0,this.services=r;var l=r.errorService;this.modalDialog=l.control(),this.lastContentProviderContract=null,this.userAgent=s,this.scope.showLoadNotification=function(){return c.showLoadNotification()},this.scope.hideLoadNotification=function(){return c.hideLoadNotification()};var d=this.scope.$watch("viewModel",(function(e){c.scope.initConfigurationPage(e)}));this.scope.initConfigurationPage=function(t,i){t&&e.common.localize.ensureLocalization((function(){return c.initConfigurationPage(t,i)}))},this.scope.$on(i.scopeDestroyEventName,(function(){return d()}));var p=this.services.$window,u=function(t){var r;try{r=JSON.parse(t.data)}catch(e){}if(r&&t.origin===i.hostOrigin){var n=r;if(n)switch(n.message){case i.contentProviderStoreCloseModalDialogMessage:c.scope.unloadContentProviderFrame();break;case i.contentProviderStoreMashupContentProviderLoadedMessage:c.scope.hideLoadingUI();break;case i.contentProviderStoreShowLoadNotificationMessage:c.showLoadNotification();break;case i.contentProviderStoreHideLoadNotificationMessage:c.hideLoadNotification()}var s=r;if(s&&(s.ImportCancelled||s.IsBlockingOperation||s.BlockingOperationAborted)){if(s.ImportCancelled)return c.hideModalDialog(),c.services.navigation.navigateBack(),void c.scope.$apply();if(s.IsBlockingOperation)return void c.services.timeout((function(){var e=c,t=new Array,o='<span class="pbi-spinner"></span><span>{{upload}}</span>';o=o.replace("{{upload}}",c.services.localizationService.get("ExternalContentViewer_Upload"));var r=$(o);t[0]=new InJs.ModalDialogAction(c.services.localizationService.get("ExternalContentViewer_Cancel"),function(t){e.hideModalDialog();var o=e.contentProviderFrame[0].contentWindow;o.postMessage(JSON.stringify({ImportCancelled:!0}),i.hostOrigin)}),c.isModalDialogShown=!0,c.modalDialog.showCustomDialog(c.services.localizationService.get("ExternalContentViewer_UploadInProgress"),r,t,(function(){}),!1)}),0);if(s.BlockingOperationAborted)return void c.services.timeout((function(){c.hideModalDialog()}),0)}var d=r;if(d&&(d.ErrorMessage||d.ErrorType||d.RequestId||d.StatusCode||d.ErrorCode)){var u=d.ErrorCode,v=d.ErrorMessage,h=d.ErrorType;if(u){if(d.ErrorCode===e.constants.pbixUploadWarnings.ModelNotFound)return c.services.telemetryService.logEvent(e.telemetry.LocalFileContentProviderLocalFileUploadLiveConnectPbix,u),void c.services.errorService.infoCustom(c.services.localizationService.get("UploadPowerBICompanion_PublishDesignerWarning"),c.services.localizationService.get("UploadPowerBICompanion_AccessDatasetWarning"));var g=a.getErrorMessageId(u,i.excelContentProviderId,c.services.featureSwitchService);g&&(v=c.services.localizationService.get(g),h=g)}return c.hideModalDialog(),void l.error(v,h,{requestId:d.RequestId,statusCode:d.StatusCode})}var m=r;m&&(m.DSID||m.SID)&&(c.hideModalDialog(),c.scope.$emit(e.constants.dataSourceAccessInfoGeneratedEventName,m,c.lastContentProviderContract));var f=r;f&&f.CompanionAppDownloadLinkClicked&&c.services.dashboardHttpService.getDashboardContainer(void 0).then((function(e){e.data.companionAppEnabled&&(p.location.href=o.powerBICompanionHelper.getDownloadLink()),e.data.downloadCenterLinkEnabled&&(p.location.href=o.powerBICompanionHelper.getDownloadCenterLink(e.data.downloadCenterX64Link,e.data.downloadCenterX86Link))}),(function(e){}));var y=r;y&&y.SampleWorkbookDownloadLinkClicked&&(p.location.href=o.powerBIExcelHelper.getDownloadLink())}};p.addEventListener(n.messageEventName,u,!1),this.scope.$on(i.scopeDestroyEventName,(function(){p.removeEventListener(n.messageEventName,u,!1)}))}return t.createOptions=function(){return{additionalServices:["$window","dashboardHttpService","errorService","contentProviderHttpService","featureSwitchService","navigation","telemetryService","localizationService","modalDialogService"]}},t.prototype.showLoadNotification=function(){if(!this.isLoadNotificationShown){var e=this.scope.$new(!0),t={containerCssClass:"notificationDialog",dialogCssClass:"notificationDialog",dialogName:null,template:"<load-notification-dialog></load-notification-dialog>",scope:e,isDismissable:!1};this.scope.showIFrame=!1,this.services.modalDialogService.showLegacyWebModalDialog(t),this.isLoadNotificationShown=!0,this.scope.$applyAsync()}},t.prototype.hideLoadNotification=function(){if(this.isLoadNotificationShown){this.scope.showIFrame=!0;var e=this.services.errorService.control();e.hideDialog(),this.isLoadNotificationShown=!1,this.scope.$applyAsync(),this.executeWorkaroundForEdgeBrowser()}},t.prototype.executeWorkaroundForEdgeBrowser=function(){var e=this;this.isEdgeBrowser()&&this.services.timeout((function(){e.changeIFrameHeight(!0),e.services.timeout((function(){e.changeIFrameHeight(!1)}),0)}),0)},t.prototype.isEdgeBrowser=function(){var e=this.userAgent.toLowerCase();return e.indexOf(" edge/")>-1},t.prototype.changeIFrameHeight=function(e){var t=$("iframe.contentProviderDialogFrame"),i=t.height(),o=e?i+1:i-1;t.css("height",o)},t.prototype.initConfigurationPage=function(o,a){var n=this;this.scope.viewModel=null,this.lastContentProviderContract=o;var s=this.services.telemetryService,c=s.startEvent(e.telemetry.DashboardInitializeContentProviderConfig,o.displayText);if(o.id in t.ContentProviderFramesCache){var l=t.ContentProviderFramesCache[o.id];return void this.scope.loadContentProviderFrame(l,a)}if(o.id<0&&o.id===this.lastContentProviderContract.id){var d="/providers/comingsoon",p=$(t.ContentProviderFrameTemplate.replace("{{configPageUrl}}",t.addLanguageToUrl(d)));return t.ContentProviderFramesCache[o.id]=p,void this.scope.loadContentProviderFrame(p,a)}if(o.configurationPageUrl){if(o.id===this.lastContentProviderContract.id){var u=o.configurationPageUrl,v="";v=a?i.contentProviderStoreRenderAsModalDialogMode:i.contentProviderStoreRenderAsFullScreenMode;var h=jsCommon.QueryStringUtil.parseQueryString();h[v]="1",u=jsCommon.QueryStringUtil.addOrUpdateQueryStringToUrl(u,h),h.unmin&&(u+="&unmin=true"),o.isService&&o.providerKey&&(u+="&providerKey="+o.providerKey),u=this.addQueryParameters(u);var p=$(t.ContentProviderFrameTemplate.replace("{{configPageUrl}}",u));this.scope.loadContentProviderFrame(p,a)}}else this.services.contentProviderHttpService.getConfiguration(o.id,r.FullConfigurationFlow,c.event).then((function(e){if(e.data&&null!=e.data.ConfigurationPageUrl){if(o.id===n.lastContentProviderContract.id){var i=jsCommon.QueryStringUtil.parseQueryString(),r=jsCommon.QueryStringUtil.addOrUpdateQueryStringToUrl(e.data.ConfigurationPageUrl,i);r=n.addQueryParameters(r);var a=$(t.ContentProviderFrameTemplate.replace("{{configPageUrl}}",r));t.ContentProviderFramesCache[o.id]=a,n.scope.loadContentProviderFrame(a)}c.resolve()}else n.errorInitializingConfigPage(e,c)}),(function(e){n.errorInitializingConfigPage(e,c)}))},t.prototype.addQueryParameters=function(t){var o=jsCommon.QueryStringUtil.parseQueryString();if(o[e.common.constants.navigation.getDataForceConnect]){var r=btoa(JSON.stringify(o));t+="&"+i.navigation.getDataMashupUrlParams+"="+r}return t},t.prototype.errorInitializingConfigPage=function(t,i){this.scope.$emit(e.constants.configPageErrorLoadingEventName),this.services.errorService.error(this.services.localizationService.get("ContentProvider_GetConfigurationFailed"),"ContentProvider_GetConfigurationFailed",{requestId:t.requestId,statusCode:t.status.toString()}),i.reject()},t.prototype.hideModalDialog=function(){this.isModalDialogShown&&(this.modalDialog.hideDialog(),this.isModalDialogShown=!1)},t.addLanguageToUrl=function(e){var t=jsCommon.QueryStringUtil.getQueryStringValue("language");if(!_.isEmpty(t)){var i=e.indexOf("?")===-1?"?":"&";return e+i+"language="+encodeURIComponent(t)}return e},t})();s.ContentProviderFramesCache={},s.ContentProviderFrameTemplate='<iframe name="contentProviderDialogFrame" class="contentProviderDialogFrame contentProviderIFrame" sandbox="allow-scripts allow-popups allow-same-origin allow-forms" src="{{configPageUrl}}"></iframe>',t.ContentProviderController=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i;!(function(e){e[e.Welcome=0]="Welcome",e[e.GetData=1]="GetData",e[e.GroupWelcome=2]="GroupWelcome"})(i=t.ContentProviderSplashState||(t.ContentProviderSplashState={}));var o=(function(){function i(e,t){var i=this;this.scope=e,this.services=t,this.scope.featureSwitchOrgAppsEnabled=this.services.featureSwitchService.featureSwitches.orgAppsEnabled||this.services.featureSwitchService.featureSwitches.microsoftOrgAppEnabled,this.scope.showServicesTile=!this.services.featureSwitchService.featureSwitches.serviceAppsDisabled,this.scope.getCurrentGroupName=function(){return i.getCurrentGroupName()},this.scope.getSplashTitleForCurrentGroup=function(){return i.getSplashTitleForCurrentGroup()},this.scope.showIntroductionVideoModal=function(){return i.showIntroductionVideoModal()},this.scope.listViewEnabled=function(){return i.services.conceptualModelSetting.isListViewEnabled()},this.scope.navigateToContentList=function(){return i.navigateToContentList()},this.scope.inGroupWelcomeView=function(){return i.services.navigation.inGroupWelcomeView()},this.scope.navigateToCategory&&this.scope.navigateToCategoryAndProvider||(this.scope.navigateToCategory=function(e,t){return i.navigateToCategoryAndProvider(e,"",t)},this.scope.navigateToCategoryAndProvider=function(e,t,o){return i.navigateToCategoryAndProvider(e,t,o)},this.scope.isMyWorkspace=function(){return i.isMyWorkspace()})}return i.createOptions=function(){return{additionalServices:["featureSwitchService","groupService","localizationService","navigation","telemetryService","modalDialogService","conceptualModelSetting"]}},i.prototype.navigateToContentList=function(){this.services.navigation.navigateToContentList(this.services.groupService.activeGroupObjectId,!0)},i.prototype.getCurrentGroupName=function(){return this.services.groupService.activeGroup?this.services.groupService.activeGroup.displayName:""},i.prototype.getSplashTitleForCurrentGroup=function(){return this.services.groupService.activeGroup.isMyWorkspace?this.services.localizationService.get("GetData_GetData"):this.services.localizationService.format("Groups_Splash_Title",[this.getCurrentGroupName()])},i.prototype.isMyWorkspace=function(){return this.services.groupService.activeGroup.isMyWorkspace},i.prototype.navigateToCategoryAndProvider=function(i,o,r){var a=t.contentProviderConstants.categoryEnumToNameMap[i],n=t.contentProviderConstants.categoryInteractionTelemetryMap[r];this.services.telemetryService.logEvent(e.telemetry.DashboardGetDataCategorySelect,a,n,""),this.services.navigation.showGetDataSlider(a,o,0)},i.prototype.showIntroductionVideoModal=function(){var t=this.services.telemetryService.startEvent(e.telemetry.DashboardGetDataSplashIntroVideo),i={dialogName:this.services.localizationService.get("GetData_PowerBI_In_60_Seconds"),templateUrl:"views/contentProviderStore/contentProviderSplashIntroVideoModal.html",scope:this.scope.$new(!0),dialogCssClass:"introVideo",onCloseDialog:function(){return t.resolve()}};this.services.modalDialogService.showLegacyWebModalDialog(i)},i})();t.ContentProviderSplashController=o})(i=t.contentProviderStore||(t.contentProviderStore={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i,o=e.common.constants,r=e.common.contracts.ContentProviderCategory,a=e.common.contracts.ContentProviderClientCategory,n=e.common.contracts.ContentProviderConfigurationUIStyle,s=jsCommon.DateExtensions,c="local-file";!(function(t){t.CategoryNameToEnumMap={files:a.File,services:a.Service,samples:a.Sample,bigdata:a.BigDataAndMore,myorg:a.Organizational,learn:a.Learn},t.categoryEnumToNameMap={},t.categoryEnumToNameMap[a.File]="files",t.categoryEnumToNameMap[a.Sample]="samples",t.categoryEnumToNameMap[a.Service]="services",t.categoryEnumToNameMap[a.BigDataAndMore]="bigdata",t.categoryEnumToNameMap[a.Organizational]="myorg",t.categoryEnumToNameMap[a.Learn]="learn",t.categoryEnumToDisplayNameMap={},t.categoryEnumToDisplayNameMap[a.File]="GetData_Files",t.categoryEnumToDisplayNameMap[a.Sample]="GetData_Samples",t.categoryEnumToDisplayNameMap[a.Service]="GetData_Services",t.categoryEnumToDisplayNameMap[a.BigDataAndMore]="GetData_BigDataAndMore",t.categoryEnumToDisplayNameMap[a.Organizational]="GetData_MyOrganization",t.categoryEnumToDisplayNameMap[a.Learn]="GetData_AddYourContent",t.categoryInteractionTelemetryMap={breadcrumb:e.telemetry.GetDataCategorySelectInteraction.Breadcrumb,navPane:e.telemetry.GetDataCategorySelectInteraction.NavPane,splashPage:e.telemetry.GetDataCategorySelectInteraction.SplashPage,getApps:e.telemetry.GetDataCategorySelectInteraction.GetApps},t.getAppsInteraction="getApps",t.saasMarketplacePublicCategory="public",t.saasMarketplacePrivateCategory="private",t.salesforceAppName="salesforce"})(i=t.contentProviderConstants||(t.contentProviderConstants={}));var l=1999,d=(function(){function t(t,r){var a=this;this.fullScreenConfig=!1,this.shouldHideTilesForSalesforceReports=!1,this.scope=t,this.services=r,this.scope.featureSwitchOrgAppsEnabled=this.services.featureSwitchService.featureSwitches.orgAppsEnabled||this.services.featureSwitchService.featureSwitches.microsoftOrgAppEnabled,this.isOneGBUploadFileSizeEnabled=this.services.featureSwitchService.featureSwitches.oneGBUploadFileSizeEnabled,this.viewModel=new e.models.contentProviderStore.ContentProviderStoreModel,this.viewModel.searchBoxVisible=!0,this.scope.viewModel=this.viewModel,this.scope.navigateToHome=function(){return a.services.navigation.navigateToContentListOrActiveDashboard()},this.scope.navigateToGetData=function(){a.viewModel.searchKeyword="",a.services.navigation.showGetDataSlider("","",0)},this.scope.navigateToCategory=function(e,t){return a.navigateToCategoryAndProvider(e,"",t)},this.scope.navigateToCategoryAndProvider=function(e,t,i){return a.navigateToCategoryAndProvider(e,t,i)},this.scope.getCategoryDisplayName=function(e){return a.getCategoryDisplayName(e)},this.previousSelectedCategoryName="",this.scope.isSplashState=function(){if(a.fullScreenConfig)return!1;var t=a.scope.viewModel;return!t.selectedCategory&&!t.selectedContentProviderTile&&!t.searchKeyword||a.useNewSaasMarketplace()||a.services.navigation.stateService.params[e.common.constants.navigation.getDataForceConnect]},this.scope.$watch((function(){return a.viewModel.searchKeyword}),(function(e,t){t||(a.previousCategory=a.viewModel.selectedCategory),e?a.viewModel.selectedCategory=null:a.previousCategory&&(a.viewModel.selectedCategory=a.previousCategory),a.refreshTileList()}));var n=this.services.rootScope.$on(e.constants.saasMarketplace.updateHostUrl,(function(e,t,i){a.updateUrlFromSaasMarketplace(t,i)})),s=this.services.rootScope.$on(e.constants.saasMarketplace.acquireAppEventName,(function(e,t,i){a.acquireAppFromSaasMarketplace(t,i)}));this.scope.$on(e.constants.dataSourceAccessInfoGeneratedEventName,(function(e,t,i,o,r){return a.storeDataAccessInfo(e,t,i,o,r)})),this.scope.$root.$on(e.constants.openCreateContentPackEventName,(function(e){return a.openCreateContentPack(e)})),this.scope.$on(o.navigation.stateChangeSuccess,(function(o,r,n,s,l){n.providerName!==c&&(t.isLocalFileSelected=!1,a.shouldShowProviderTiles=!0),a.services.navigation.stateService.is(e.constants.navigation.states.getData)&&(a.viewModel.searchKeyword=""),l.categoryName===n.categoryName&&i.categoryEnumToNameMap[a.viewModel.selectedCategory]===n.categoryName||a.scope.viewModel.searchKeyword||a.updateSelectedCategory(),a.fullScreenConfig=!1})),this.scope.$on(o.contentProviderStoreConfigurationUIVisibilityChangedEventName,(function(e,t,i){a.viewModel.searchBoxVisible=!t||i})),this.scope.showProviderTiles=function(){return a.shouldShowProviderTiles&&!a.shouldHideTilesForSalesforceReports},this.loadContentProviders(),this.updateSelectedCategory(),t.isLocalFileSelected=!1,this.shouldShowProviderTiles=!0,t.$on(o.localFileSelectedEventName,(function(e,i){return t.localFileSelected(i)})),t.$on(e.constants.shouldShowProviderTilesEventName,(function(){a.shouldShowProviderTiles=!0})),t.localFileSelected=function(e){t.selectedLocalFile=e,t.isLocalFileSelected=!0,a.shouldShowProviderTiles=!1,t.$applyAsync()},t.$on("$destroy",(function(){s(),n()}))}return t.createOptions=function(){return{additionalServices:["$window","$timeout","$sce","errorService","conceptualModelSetting","contentProviderService","contentProviderHttpService","modelConverter","navigation","notificationToast","localizationService","telemetryService","applicationOptions","featureSwitchService","modalDialogService","userInfo","quota","$sanitize","appService"]}},t.prototype.updateUrlFromSaasMarketplace=function(e,t){var o=this.findTileModelFromSaasMarktplaceData(e,t);if(o){var r=i.categoryEnumToNameMap[o.clientCategory];this.viewModel.selectedCategory=o.clientCategory,this.services.navigation.showGetDataSlider(r,o.providerName,2,!1)}},t.prototype.acquireAppFromSaasMarketplace=function(t,o){var r=this;if(!this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.GetData)){var a=this.findTileModelFromSaasMarktplaceData(t,o);if(a)if(a.authentication&&a.authentication.oAuth&&a.authenticationInitializationInProgress&&!a.authentication.oAuth.oAuthEndpoint){var s=e.common.httpService.powerbiRequestOptions();s.telemetryDescription="GetAuthorization: "+a.contract.providerName,e.common.httpService.get(a.authentication.oAuth.endpointRetrievalAPI,s).then((function(e){a.authentication.oAuth.oAuthEndpoint=e.data,a.authenticationInitializationDeferred.resolve(e.data)}),(function(e){a.authenticationInitializationDeferred.resolve("")})).finally((function(){a.authenticationInitializationInProgress=!1,r.fullScreenConfig=a.contract.configurationUIstyle===n.FullScreen,r.shouldHideTilesForSalesforceReports=r.useNewSaasMarketplace(),r.scope.isLocalFileSelected=!1,a.providerName===i.salesforceAppName&&r.promptToConnectFromSaasMarketplaceForSalesforce(a.title,(function(){return r.services.rootScope.$emit(e.common.constants.contentProviderStoreConnectEventName,a)}))}))}else a.providerName===i.salesforceAppName?(a.authenticationInitializationInProgress=!1,this.fullScreenConfig=a.contract.configurationUIstyle===n.FullScreen,this.shouldHideTilesForSalesforceReports=this.useNewSaasMarketplace(),this.scope.isLocalFileSelected=!1,this.promptToConnectFromSaasMarketplaceForSalesforce(a.title,(function(){return r.services.rootScope.$emit(e.common.constants.contentProviderStoreConnectEventName,a)}))):(a.authenticationInitializationInProgress=!1,this.services.rootScope.$emit(e.common.constants.contentProviderStoreConnectEventName,a))}},t.prototype.promptToConnectFromSaasMarketplaceForSalesforce=function(e,t){var i='<div class="header"><div class="icon content-provider-salesforce-small"></div><div class="title"><span localize="GetData_ConnectTo"></span>'+e+'</div></div><div class="message"><span localize= "SPZA_SalesforceAuthDialog_Message" > </span></div>',o=this.scope.$new(),r=[new InJs.ModalDialogAction(this.services.localizationService.get("SignInButton"),function(){o.closeDialog(),t()}),new InJs.ModalDialogAction(this.services.localizationService.get("AuthDialog_CancelButtonText"),function(){o.closeDialog()})],a={dialogName:null,isDismissable:!0,template:i,dialogCssClass:"salesforceConnectDialog",scope:o,dialogActions:r};this.services.modalDialogService.showLegacyWebModalDialog(a)},t.prototype.findTileModelFromSaasMarktplaceData=function(e,t){for(var o=0,r=this.viewModel.contentProviderTiles;o<r.length;o++){var n=r[o];if(n.contract.providerKey&&jsCommon.StringExtensions.equalIgnoreCase(e,n.contract.providerKey)&&(t===i.saasMarketplacePrivateCategory&&n.clientCategory===a.Organizational||t===i.saasMarketplacePublicCategory&&n.clientCategory!==a.Organizational))return n}},t.prototype.useNewSaasMarketplace=function(){return this.services.featureSwitchService.featureSwitches.saasMarketplace&&!this.services.navigation.stateService.params[e.common.constants.navigation.getDataForceConnect]&&(this.scope.viewModel.selectedCategory===a.Organizational||this.scope.viewModel.selectedCategory===a.Service)},t.prototype.refreshTileList=function(){this.scope.configPageLoaded=!1,this.scope.$root.$emit(o.contentProviderStoreTileListRefreshEventName,this.viewModel.selectedCategory,this.viewModel.searchKeyword)},t.prototype.navigateToCategoryAndProvider=function(t,o,r){if(this.viewModel.selectedCategory!==t||this.viewModel.selectedContentProviderTile||this.services.featureSwitchService.featureSwitches.saasMarketplace){this.viewModel.searchKeyword="",this.shouldHideTilesForSalesforceReports=!1;var a=this.scope.isSplashState()&&this.services.featureSwitchService.featureSwitches.saasMarketplace?2:0;e.helpers.ContentProviderStoreHelper.navigateToCategoryAndProviderHelper(t,r,a,this.services.telemetryService,this.services.navigation,this.services.rootScope),this.previousSelectedCategoryName=i.categoryEnumToNameMap[t]}},t.prototype.openCreateContentPack=function(e){null!=e&&e.stopPropagation(),this.services.navigation.showPublishContentPackSlider()},t.prototype.storeDataAccessInfo=function(t,i,o,r,a){t.stopPropagation();var n=this.services.contentProviderService;if(n.upgradeRequiredToConnect(o))return void n.displayFeatureDisabledDialog(o);var s=this.scope.activeDashboard;this.services.contentProviderService.storeDataAccessInfo(i,o,e.telemetry.InstallSource.AppSource,a,s?s.contract.id:0),this.navigateAfterConnect(o),r||this.scope.$apply()},t.prototype.navigateAfterConnect=function(e){var t=this.services;e&&t.conceptualModelSetting.isAppsEnabled()&&t.appService.isAppCategory(e.category)?t.navigation.navigateToApps():t.navigation.navigateToContentListOrActiveDashboard()},t.prototype.loadContentProviders=function(){var t=this,i=this.services;i.timeout((function(){var o=i.telemetryService,a=o.startEvent(e.telemetry.ContentProviderInitializeContentProviders);t.viewModel.hasContentProviderLoaded=!1;var n=i.contentProviderHttpService;n.getContentProviders(a.event).then((function(e){var o=e.data;t.viewModel.contentProviderTiles=[];var a=i.featureSwitchService.featureSwitches,s=n.getNonBuiltInContentProviders(o,i.applicationOptions.cpcode),c=n.getFilteredBuiltinContentProviders(s.filter((function(e){return null!==e.providerKey}))),l=o.filter((function(e){return e.category===r.Organizational||i.conceptualModelSetting.isAppsEnabled()&&e.category===r.OrganizationalApp}));t.loadServiceContentProviders(s),c=t.filterBuiltInsBasedOnServiceContentProviderOverrides(c),t.loadBuiltInContentProviders(c),(a.templatePublishEnabled||a.templatePublishFlightingWorkAroundEnabled)&&t.loadOrganizationalTemplateContentProviders(o),t.loadOrganizationalProviders(l),t.moveContentPacksIntoGroupings(),i.timeout((function(){t.refreshTileList()})),t.viewModel.hasContentProviderLoaded=!0}),(function(e){t.viewModel.hasContentProviderLoaded=!0,i.errorService.error(i.localizationService.get("ErrorMessage_FailedLoadContentProviders"),"FailedLoadContentProviders",{requestId:e.requestId,statusCode:e.status.toString()}),a.reject()}))}),l)},t.prototype.loadOrganizationalTemplateContentProviders=function(e){var t=this;this.loadServiceContentProviders(e.filter((function(e){return e.category===r.OrganizationalTemplate||t.services.conceptualModelSetting.isTemplateAppsEnabled()&&e.category===r.OrganizationalTemplateApp})),"/providers/organizationaltemplate/")},t.prototype.loadBuiltInContentProviders=function(e){for(var t=this.services.modelConverter,i=0,o=e.length;i<o;i++){var r=e[i],a=t.convertContentProviderContractToContentProviderTileModel(r),n="";r.displayTextLocalizationKey&&(a.title=this.services.localizationService.get(r.displayTextLocalizationKey)),a.usePBIDesktop&&a.learnMoreUrl&&(n='<a href="'+a.learnMoreUrl+'" target="_blank">'+this.services.localizationService.get("LearnMore")+"</a>"),a.descriptionTrustedHtml=this.decodeContentProviderHTML(a.descriptionLocalizationKey,a.finePrint,n),this.viewModel.contentProviderTiles.push(a)}},t.prototype.loadServiceContentProviders=function(e,t){void 0===t&&(t="/providers/mashUp/");for(var i=this.services.modelConverter,o=0,r=e.length;o<r;o++){var a=e[o];a.configurationUIstyle=n.ModalDialog,a.isService=!0,a.providerName||(a.providerName=a.providerKey),!a.id&&a.providerId&&(a.id=a.providerId),a.configurationPageUrl||(a.configurationPageUrl=t+a.providerName+"/?contentProviderId="+a.providerId),(null==a.iconUrl||_.isEmpty(a.iconUrl))&&(a.iconCSSClass="content-provider-placeholder");var c=i.convertContentProviderContractToContentProviderTileModel(a);a.displayTextLocalizationKey&&(c.title=this.services.localizationService.get(a.displayTextLocalizationKey));try{var l=JSON.parse(a.providerConfig)}catch(e){continue}if(l){var d=this.services.$sanitize(l.description);c.descriptionTrustedHtml=this.services.$sce.trustAsHtml(d),c.publisher=l.author,c.publishDate=s.deserializeDate(l.creationTime),c.learnMoreUrl=l.learnMoreUrl,l.displayText&&(c.title=l.displayText),l.urlPath&&(c.providerName=l.urlPath,c.contract.configurationPageUrl=t+l.urlPath+"/?contentProviderId="+a.providerId),l.providerKeyToOverride&&(c.providerKeyToOverride=l.providerKeyToOverride)}this.viewModel.contentProviderTiles.push(c)}},t.prototype.loadOrganizationalProviders=function(e){for(var t=this.services.modelConverter,i=0,o=e.length;i<o;i++){var r=e[i];null==r.iconUrl&&(r.iconCSSClass="content-provider-placeholder"),r.configurationUIstyle=n.DirectConnect,r.disableDetailPane=!1,r.providerName=e[i].providerKey;var a=t.convertContentProviderContractToContentProviderTileModel(r),c=JSON.parse(e[i].providerConfig);if(c){var l=this.services.$sanitize(c.description);a.descriptionTrustedHtml=this.services.$sce.trustAsHtml(l),a.publisher=c.author,a.emailAddress=c.emailAddress,a.emailAddressAsLink="mailto:"+c.emailAddress,a.publishDate=s.deserializeDate(c.creationTime)}this.viewModel.contentProviderTiles.push(a)}},t.prototype.filterBuiltInsBasedOnServiceContentProviderOverrides=function(e){for(var t=[],i=0,o=this.viewModel.contentProviderTiles;i<o.length;i++){var r=o[i];r.providerKeyToOverride&&t.push(r.providerKeyToOverride)}if(0===t.length)return e;for(var a=[],n=0,s=e;n<s.length;n++){for(var c=s[n],l=!1,d=0,p=t;d<p.length;d++){
var u=p[d];c.providerKey&&jsCommon.StringExtensions.equalIgnoreCase(u,c.providerKey)&&(l=!0)}l||a.push(c)}return a},t.prototype.moveContentPacksIntoGroupings=function(){var e=this.services.modelConverter,t=e.groupContentProviderTileModels(this.viewModel.contentProviderTiles);this.viewModel.contentProviderTiles=t},t.prototype.decodeContentProviderHTML=function(e,t,i){var o=[["apos","'"],["amp","&"],["lt","<"],["gt",">"]],r=i?this.services.localizationService.format(e,[i]):this.services.localizationService.get(e),a=this.services.localizationService.get(t)||"",n=null;if(r){for(var s=0,c=o.length;s<c;++s)r=r.replace(new RegExp("&"+o[s][0]+";","g"),o[s][1]),a=a.replace(new RegExp("&"+o[s][0]+";","g"),o[s][1]);n=this.services.$sce.trustAsHtml(r+(a?"<br/><br/><i>"+a+"</i>":""))}return n},t.prototype.updateSelectedCategory=function(){var t=this,o=this.services.navigation.categoryName,r=i.CategoryNameToEnumMap,a=r[o];this.viewModel.selectedCategory=a,this.viewModel.searchKeyword="",this.previousCategory=null,this.useNewSaasMarketplace()?this.services.rootScope.$emit(e.constants.saasMarketplace.initSaasMarketplaceEventName,this.services.navigation.appsOnly):this.services.$timeout((function(){t.refreshTileList(),t.services.navigation.providerName||(t.viewModel.selectedContentProviderTile=null)}))},t.prototype.getCategoryDisplayName=function(e){return this.services.localizationService?this.services.localizationService.get(i.categoryEnumToDisplayNameMap[e]):""},t})();t.ContentProviderStoreController=d})(i=t.contentProviderStore||(t.contentProviderStore={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentProviderClientCategory,o=e.controllers.contentProviderStore.contentProviderConstants,r=(function(){function t(i,o){var r=this;this.scope=i,this.services=o,this.scope.loadingElement=this.services.$element.find("#loadingId"),this.isOneGBUploadFileSizeEnabled=this.services.featureSwitchService.featureSwitches.oneGBUploadFileSizeEnabled,i.closeLoadingDialog=function(){r.fileUploadingDeferred&&r.fileUploadingDeferred.reject(),r.scope.loadingElement.hide(),r.completeUploading()},this.scope.$on(e.constants.uploadFormatChosenEventName,(function(i,o){r.scope.$emit(e.constants.shouldShowProviderTilesEventName),r.scope.shouldChooseFormat=!1;var a=t.ExcelContentProviderFileUploadingReplaceEndPointTemplate;r.uploadFormat=o,a+=r.uploadFormat===e.models.UploadFormat.ImportData?t.ScenarioImport:t.ScenarioView,r.processUploadingFile(t.ExcelContentProviderId,a,"UploadExcelFile",r.fileExtension,"UploadReplace_WorkbookExistsDetailedMessage")})),this.init()}return t.createOptions=function(){return{additionalServices:["promiseFactory","$window","telemetryService","localizationService","storageUsageService","featureSwitchService","applicationOptions","modelService","workbookService","errorService","refreshService","navigation","packageService","$element","modelHttpService","datasetsService","localFileService","upload"]}},t.prototype.init=function(){this.scope.shouldChooseFormat=!1;var i=this.scope.selectedFile;this.fullFilename=i.name;var o=i.name.split(".");if(this.fileExtension=o.pop().toLowerCase(),this.filename=this.fileExtension?o.join("."):i.name,this.scope.isUpdateFromElementFlow)return this.fileExtension!==t.xlsmFileExtension&&this.fileExtension!==t.xlsxFileExtension?void this.showDialog("UnsupportedFileType_Title","UnsupportedFileType_Message","UnsupportedFileType_OK"):(this.uploadFormat=e.models.UploadFormat.ViewExcel,this.elementIdToUpdate=this.scope.elementToUpdate.packageId,void this.processUpdatingWorkbook());var r=this.services.featureSwitchService.featureSwitches;this.scope.isFullFidelityLocalFileEnabled=r.fullFidelityExcelEnabled&&(r.ffxlLocalFilesEnabled||this.services.applicationOptions.isE2ERun),this.scope.isFullFidelityLocalFileEnabled&&this.isExcelFile()?this.scope.shouldChooseFormat=!0:(this.scope.$emit(e.constants.shouldShowProviderTilesEventName),this.uploadFormat=e.models.UploadFormat.ImportData,this.fileExtension===t.xlsxFileExtension||this.fileExtension===t.xlsmFileExtension?this.processUploadingFile(t.ExcelContentProviderId,t.ExcelContentProviderFileUploadingReplaceEndPointTemplate,"UploadExcelFile",this.fileExtension,"UploadReplace_DatasetExistsDetailedMessage"):this.fileExtension===t.pbiFileExtension?this.processUploadingFile(t.PowerBIDesignerContentProviderId,t.PowerBIDesignerContentProviderFileUploadingReplaceEndPointTemplate,"PBI.Providers.PBIFileUpload",this.fileExtension,"UploadReplace_DatasetExistsDetailedMessage"):this.fileExtension===t.csvFileExtension?this.processUploadingFile(t.CsvDesignerContentProviderId,t.CsvContentProviderFileUploadingEndPointTemplate,"PBI.Providers.CSVFileUpload",this.fileExtension,"UploadReplace_DatasetExists"):this.showDialog("UnsupportedFileType_Title","UnsupportedFileType_Message","UnsupportedFileType_OK"))},t.prototype.isExcelFile=function(){return this.fileExtension===t.xlsxFileExtension||this.fileExtension===t.xlsmFileExtension},t.prototype.completeUploading=function(){return this.scope.isUpdateFromElementFlow?void this.services.workbookService.finishReplacingLocalWorkbook():void this.navigateToFiles()},t.prototype.navigateToFiles=function(){this.scope.$emit(e.constants.shouldShowProviderTilesEventName);var t=0,r=o.categoryEnumToNameMap[i.File];this.services.navigation.showGetDataSlider(r,void 0,t)},t.prototype.showErrorMessageWhenUploadLimitExceeds=function(e,i){var o,r;e===t.ExcelContentProviderId?(r="https://go.microsoft.com/fwlink/?LinkId=626823",o=this.isOneGBUploadFileSizeEnabled?"UploadExcel_UploadLimit_LocalFile_OneGB":"UploadExcel_UploadLimit_LocalFile"):o=e===t.PowerBIDesignerContentProviderId?this.isOneGBUploadFileSizeEnabled?"UploadPowerBICompanion_UploadLimit_LocalFile_OneGB":"UploadPowerBICompanion_UploadLimit_LocalFile":this.isOneGBUploadFileSizeEnabled?"UploadCSV_UploadLimit_LocalFile_OneGB":"UploadCSV_UploadLimit_LocalFile",i&&(i.event.info.uploadCompleted=!1,i.reject({errorCode:"SizeLimitExceeded"})),this.showDialog("GetData_FileSizeTooLarge_Title",o,null,r)},t.prototype.replaceFile=function(t,i,o,r){var a,n,s=JSON.parse(t),c=s.PackageId,l=void 0,d=void 0,p=void 0,u=void 0,v=void 0;this.uploadFormat===e.models.UploadFormat.ViewExcel?(a=_.find(this.services.workbookService.editAndReShareWorkbooks,(function(e){return e&&e.packageId.toString()===c})),n=a,l="UpdatingYourFile",d="NotificationMessage_TakeAWhile",p="WorkbookUpdatedNotificationTitle",u="WorkbookUpdatedNotificationMessage",v=n?n.displayName:null):l="RefreshingData",o.resolve(),r&&(r.event.info.uploadCompleted=!0,r.resolve()),c&&this.services.refreshService.refreshNow(this.services.telemetryService,this.services.errorService,c,i,l,d,p,u,v),this.services.navigation.navigateToContentListOrActiveDashboard()},t.prototype.uploadFileWithoutReplacing=function(i,o,r,a,n){n&&(n.event.info.uploadCompleted=!0,n.resolve());var s=JSON.parse(i);s.ContentProviderIdOverride=o;var c;switch(o){case t.ExcelContentProviderId:c=t.ExcelContentProviderDisplayName;break;case t.PowerBIDesignerContentProviderId:c=t.PowerBIDesignerContentProviderDisplayName;break;case t.CsvDesignerContentProviderId:c=t.CsvDesignerContentProviderDisplayName}s&&(s.DSID||s.SID)&&(a.event.info.DSID=s.DSID,a.resolve(),s.isImportOperation=this.uploadFormat===e.models.UploadFormat.ImportData,r.$emit(e.constants.dataSourceAccessInfoGeneratedEventName,s,null,!0,c))},t.prototype.showErrorWhenUploadFileFails=function(i,o,r,a,n){var s=i.headers(e.common.PowerBIErrorHeader);if(this.fileUploadingDeferred&&this.fileUploadingDeferred.reject(s),s===e.constants.FileUploadWarnings.OverwriteNonLocalPackageWithLocalFileError){var c=this.services.localizationService.format("UploadLocalFile_OverwriteNonLocalPackageWithLocalFileError",[this.fullFilename]);this.showFormattedDialog("UploadLocalFile_OverwriteNonLocalPackageWithLocalFileError_Title",c,null,"https://go.microsoft.com/fwlink/?linkid=846198")}else o===t.ExcelContentProviderId?this.uploadFormat===e.models.UploadFormat.ViewExcel?this.isReplace?this.services.workbookService.postReplaceWorkbookErrorMessage(i):this.services.workbookService.postUploadWorkbookErrorMessage(i):this.postErrorMessage("UploadExcel_PublishWorkbookFailed",s,"UploadExcel_PublishWorkbookFailed",i.requestId,i.status.toString()):o===t.PowerBIDesignerContentProviderId?this.showPbixWarnings(s,a,r,o,n)||this.postErrorMessage("UploadPowerBICompanion_PublishDesignerFailed",s,"UploadPowerBICompanion_PublishDesignerFailed",i.requestId,i.status.toString(),!0):this.postErrorMessage("UploadCSV_PublishFileFailed",s,"UploadCSV_PublishFileFailed",i.requestId,i.status.toString(),!0);this.completeUploading()},t.prototype.showPbixWarnings=function(i,o,r,a,n){var s=this,c=e.constants.pbixUploadWarnings,l="https://go.microsoft.com/fwlink/?linkid=842740";if(i===c.ReportWithDisplayNameForTheModelExists){var d=this.services.errorService.control(),p=this.createPromptAction(this.services.localizationService.get("UploadReplace_ReplaceButton"),d,(function(){s.beginUploadReplace(t.PowerBIDesignerContentProviderFileUploadingReplaceEndPointTemplate,s.scope,a,s.scope.selectedFile,o,n,r)})),u=this.createCancelPromptAction(d,o,r),v=[p,u];this.requestInputForHandlingDuplicates(d,"UploadPowerBICompanion_PublishDesignerWarning","UploadPowerBICompanion_ReplaceReportWarning",v,"UploadReplace_CancelButton",l)}else if(i===c.MoreThanOneDuplicateReportFoundError){var h=this.services.localizationService.format("UploadPowerBICompanion_ReplaceReportsWarning",[this.fullFilename]);this.showFormattedDialog("UploadPowerBICompanion_PublishDesignerWarning",h,null,l)}else if(i===c.ReplaceOriginalReportForPowerBICompanionNotSupported)this.showDialog("UploadPowerBICompanion_PublishDesignerWarning","UploadPowerBICompanion_UnsupportedReplaceReportWarning",null,l);else{if(i!==c.ModelNotFound)return!1;this.showDialog("UploadPowerBICompanion_PublishDesignerWarning","UploadPowerBICompanion_AccessDatasetWarning",null,l)}return this.services.telemetryService.logChildEvent(o.event,e.telemetry.LocalFileContentProviderLocalFileUploadLiveConnectPbix,i),!0},t.prototype.uploadFile=function(t,i,o,r,a,n,s,c){var l=this,d=this.isOneGBUploadFileSizeEnabled?e.common.constants.oneGBFileUploadLimitInByte:e.common.constants.fileUploadLimitInByte;if(r.size>d)return this.showErrorMessageWhenUploadLimitExceeds(o,c),a.reject(),void this.completeUploading();this.fileUploadingDeferred=this.services.promiseFactory.defer(),this.scope.loadingElement.show(),this.fileUploadingDeferred.promise.then((function(e){l.scope.loadingElement.hide(),l.completeUploading(),s?l.replaceFile(e,o,a,c):l.uploadFileWithoutReplacing(e,o,i,a,c)}),(function(e){e?(a.reject(),c&&(c.event.info.uploadCompleted=!1,c.reject({errorCode:e}))):(a.resolve(),c&&(c.event.info.uploadCompleted=!1,c.resolve())),l.scope.loadingElement.hide(),l.completeUploading()}));var p=e.common.httpService.powerbiRequestOptions(a.event,n);p.retryCount=0,p.headers[e.common.constants.uploadFileSizeHeaderName]=r.size.toString(),this.services.upload.post(jsCommon.StringExtensions.format(t,encodeURIComponent(r.name)),[r],p).then((function(e){l.fileUploadingDeferred.resolve(e.data)}),(function(e){l.showErrorWhenUploadFileFails(e,o,c,a,n)}))},t.prototype.postErrorMessage=function(t,i,o,r,a,n){var s=JSON.stringify({ErrorCode:i,ErrorMessage:this.services.localizationService.get(t),ErrorType:o,RequestId:r,StatusCode:a,HasError:n});this.services.$window.postMessage(s,e.common.constants.hostOrigin)},t.prototype.processUpdatingWorkbook=function(){this.scope.uploadingMessage=this.services.localizationService.format("GetData_UploadingFile",[this.fullFilename]);var i,o=this.services.telemetryService.startEvent(e.telemetry.LocalFileContentProviderLocalFileUpload,this.fileExtension,e.telemetry.LocalFileUploadPossibility.Duplicate,null);i=this.services.telemetryService.startChildEvent(o.event,e.telemetry.ProvidersExcelWorkbookUpload,e.models.HostType[e.models.HostType.Local],jsCommon.FileUtils.getFileExtension(this.fullFilename),this.scope.selectedFile.size,!1,this.uploadFormat,1);var r=t.ExcelContentProviderFileUploadingReplaceEndPointTemplate+t.ScenarioView;this.beginUploadReplace(r,this.scope,t.ExcelContentProviderId,this.scope.selectedFile,o,"UploadExcelFile",i)},t.prototype.processUploadingFile=function(t,i,o,r,a){var n,s=this,c=this.services.telemetryService.startEvent(e.telemetry.LocalFileContentProviderLocalFileUpload,r,null,null);this.isExcelFile()&&(n=this.services.telemetryService.startChildEvent(c.event,e.telemetry.ProvidersExcelWorkbookUpload,e.models.HostType[e.models.HostType.Local],jsCommon.FileUtils.getFileExtension(this.fullFilename),this.scope.selectedFile.size,!1,this.uploadFormat,null));var l,d;if(this.uploadFormat===e.models.UploadFormat.ViewExcel){this.scope.uploadingMessage=this.services.localizationService.format("GetData_UploadingFile",[this.fullFilename]);var p=_.filter(this.services.workbookService.editAndReShareWorkbooks,(function(e){return!!(e&&e.displayName&&s.services.packageService.isLocalWorkbook(e.packageId))&&s.fullFilename.toLowerCase()===e.displayNameWithExtension.toLowerCase()}));l=p?p.length:0,this.elementIdToUpdate=l>0?p[0].packageId:null}else this.scope.uploadingMessage=this.services.localizationService.format("GetData_ImportingFile",[this.fullFilename]),d=_.filter(this.services.modelService.editableModels,(function(e){return e.contract.contentProviderId===t&&e.displayName.toLowerCase()===s.filename.toLowerCase()})),l=d?d.length:0;var u=this.services.errorService.control(),v=[];if(n&&(n.event.info.existingWorkbooks=l),l>0)if(1===l)if(c.event.info.possibility=e.telemetry.LocalFileUploadPossibility.Duplicate,this.uploadFormat===e.models.UploadFormat.ImportData&&d[0].cloudRlsEnabled&&!this.services.featureSwitchService.featureSwitches.cloudRlsRoleMembershipEnabled){var h="UploadReplace_CloudRlsTitle",g="UploadReplace_CloudRlsEnabledDatasetExistsMessage";v.push(this.createPromptAction(this.services.localizationService.get("UploadReplace_ReplaceButton"),u,(function(){var r=d[0];r&&!s.services.featureSwitchService.featureSwitches.cloudRlsRoleMembershipEnabled&&(s.services.telemetryService.logEvent(e.telemetry.RowLevelSecurityDisableRLS,e.telemetry.DisableRLSSource.UploadOverride,!0,r.id),s.services.modelHttpService.disableRlsModel(r.id,c.event).then((function(e){s.updatePackageRefreshEnabled(r,i,s.scope,t,s.scope.selectedFile,o,n,c)}),(function(e){s.showErrorWhenUploadFileFails(e,t,n,c,o)})))}))),v.push(this.createCancelPromptAction(u,c,n)),this.requestInputForHandlingDuplicates(u,h,g,v,"UploadReplace_CancelButton")}else{var h=this.uploadFormat===e.models.UploadFormat.ViewExcel?"UploadReplace_WorkbookExistsTitle":"UploadReplace_DatasetExistsTitle";v.push(this.createPromptAction(this.services.localizationService.get("UploadReplace_ReplaceButton"),u,(function(){s.beginUploadReplace(i,s.scope,t,s.scope.selectedFile,c,o,n)}))),v.push(this.createCancelPromptAction(u,c,n)),this.requestInputForHandlingDuplicates(u,h,a,v,"UploadReplace_CancelButton")}else{n&&(n.event.info.uploadCompleted=!1,n.resolve());var h=this.uploadFormat===e.models.UploadFormat.ViewExcel?"UploadReplace_MultipleWorkbookExistsTitle":"UploadReplace_MultipleDatasetExistsTitle",m=this.uploadFormat===e.models.UploadFormat.ViewExcel?"UploadReplace_MultipleWorkbookExists":"UploadReplace_MultipleDatasetExists";c.event.info.possibility=e.telemetry.LocalFileUploadPossibility.MultipleDuplicates,c.resolve(),v.push(this.createPromptAction(this.services.localizationService.get("UploadReplace_GotIt"),u,(function(){}))),this.requestInputForHandlingDuplicates(u,h,m,v,"UploadReplace_GotIt")}else{c.event.info.possibility=e.telemetry.LocalFileUploadPossibility.NoDuplicate,this.isReplace=!1;var f=i+"&duplicateDatasetBehavior=FailOnDuplicate";this.uploadFile(f,this.scope,t,this.scope.selectedFile,c,o,!1,n)}},t.prototype.requestInputForHandlingDuplicates=function(e,t,i,o,r,a){var n=this,s=this.services.localizationService.get(t),c=this.services.localizationService.get(i).replace("{0}",'"'+this.fullFilename+'"');a=a||"https://go.microsoft.com/fwlink/?LinkID=616803";var l='<a href="'+a+'" target="_blank">'+this.services.localizationService.get("LearnMore")+"</a>";e.showCustomDialog(s,angular.element("<div/>").text(c).append("&nbsp;"+l),o,(function(e){e.parent().find('input[value="'+n.services.localizationService.get(r)+'"]').focus()}),!1)},t.prototype.createCancelPromptAction=function(e,t,i){return this.createPromptAction(this.services.localizationService.get("UploadReplace_CancelButton"),e,(function(){t.resolve(),i&&(i.event.info.uploadCompleted=!1,i.resolve())}))},t.prototype.createPromptAction=function(e,t,i){var o=this;return new InJs.ModalDialogAction(e,function(e,r){t.hideDialog(),i(),o.completeUploading()})},t.prototype.updatePackageRefreshEnabled=function(e,t,i,o,r,a,n,s){var c=this;this.services.datasetsService.updatePackageRefreshEnabled(e.packageId,!0,s.event).then((function(e){c.beginUploadReplace(t,i,o,r,s,a,n)}),(function(e){c.showErrorWhenUploadFileFails(e,o,n,s,a)}))},t.prototype.beginUploadReplace=function(t,i,o,r,a,n,s){s&&(s.event.info.uploadCompleted=!0),this.services.telemetryService.logEvent(e.telemetry.LocalFileContentProviderLocalFileUploadReplace,!0,this.scope.isUpdateFromElementFlow),this.uploadFormat===e.models.UploadFormat.ViewExcel&&(t+="&packageId="+this.elementIdToUpdate.toString()),this.isReplace=!0;var c=t+"&duplicateDatasetBehavior=ReplaceExistingDuplicate";this.uploadFile(c,i,o,r,a,n,!0,s)},t.prototype.showDialog=function(e,t,i,o){var r=this.services.localizationService.get(t);this.showFormattedDialog(e,r,i,o)},t.prototype.showFormattedDialog=function(e,t,i,o){var r=this.services.errorService.control(),a=this.services.localizationService.get(e),n=i?this.services.localizationService.get(i):null,s={label:this.services.localizationService.get("LearnMore"),url:o||"https://go.microsoft.com/fwlink/?LinkId=624514"};r.showMessage(a,t,n,s)},t})();r.ExcelContentProviderId=6,r.ExcelContentProviderDisplayName="Excel Workbook",r.PowerBIDesignerContentProviderId=7,r.CsvDesignerContentProviderId=60,r.PowerBIDesignerContentProviderDisplayName="Power BI Desktop File",r.CsvDesignerContentProviderDisplayName="CSV File",r.CsvContentProviderFileUploadingEndPointTemplate="/powerbi/providers/csv/uploadAndConfigure?documentName={0}",r.PowerBIDesignerContentProviderFileUploadingReplaceEndPointTemplate="/powerbi/providers/pbi/uploadReplaceAndConfigure?documentName={0}",r.ExcelContentProviderFileUploadingReplaceEndPointTemplate="/powerbi/providers/excel/uploadReplaceAndConfigure?documentName={0}",r.ScenarioImport="&scenario=Import",r.ScenarioView="&scenario=View",r.xlsxFileExtension="xlsx",r.xlsmFileExtension="xlsm",r.csvFileExtension="csv",r.pbiFileExtension="pbix",t.ContentProviderLocalFileController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){var i=this;this.registerValidator=function(e){return i.validators.push(e),function(){_.remove(i.validators,(function(t){return t===e}))}},this.synchronizeValidation=function(){i.validators.forEach((function(e){return e()}))},this.validators=[]}return e})();e.CustomValidatorSynchronizerController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.constants,r=e.dataServices.models.ContentPackItems,a=e.services.FullScreenFitStyle,n=e.common.constants.TaskPaneCollapsiblePaneMode,s=e.dataServices.TileUtils,c=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.scope.scrollbarsConfig={ignoreOverlay:!1,ignoreMobile:!1},this.scope.tileTrackerFn=function(e){return s.tileTrackerFn(e,o.scope.viewModel.objectId)},this.scope.useCustomScrollbar=function(){return 0!==o.scope.displayLayout&&1===o.scope.mobileLayout},this.scope.fullScreen=this.services.fullScreen,this.scope.permissionServices=this.services.permissionService,this.scope.showReloadDashboard=!1,this.scope.filteredTiles=function(){return o.filteredTiles()},this.scope.removeTileFromMobileView=function(e){return o.removeTileFromMobile(e)},this.scope.canEditTiles=function(){return o.canEditTiles()},this.scope.gridLayoutChangeHandler=function(e){return o.onGridLayoutChanged(e)};var r=this.services.rootScope.$on(e.constants.openTileEventName,(function(e,t){return o.onOpenTile(e,t)})),n=this.services.rootScope.$on(e.constants.temporaryTilePinned,(function(e){return o.beginTemporaryTileFlow(e)})),c=this.scope.$on(e.constants.removeTileEventName,(function(e,t){return o.onRemoveTile(e,t)})),l=this.services.rootScope.$on(e.constants.loadDashboardFailed,(function(){o.scope.showReloadDashboard=!0})),d=this.scope.$on(e.constants.refreshTileData,(function(e,t){var i=o.services.dashboardDataService.activeDashboard;i&&o.services.dashboardService.refreshTileData(i.id,t)})),p=function(){switch(o.scope.fullScreen.fitStyle){case a.FitToContent:o.scope.scaleDashboard();break;case a.FitToWidth:o.scope.scaleDashboard(!0)}};$(this.services.$window).on("resize",p),this.scope.$on("$destroy",(function(){o.scope.onDestroy&&o.scope.onDestroy(),r(),c(),n(),d(),l(),$(o.services.$window).off("resize",p)})),this.scope.reloadActiveDashboard=function(){return o.reloadActiveDashboard()},this.services.dashboardDataService.InEditMobileLayoutMode=this.scope.inEditMobileLayoutMode,this.scope.$watch("viewModel.isLoaded",(function(t){t&&e.helpers.TrustedVisualUtil.acquireTrustedVisuals(o.scope.viewModel,o.services.trustedVisual).then((function(e){return o.reloadTrustedVisuals(e)}))}))}return t.createOptions=function(){return{additionalServices:["dashboardDataService","dashboardHttpService","dashboardService","errorService","modalDialogService","modelConverter","navigation","telemetryService","userSettingsService","visualPlugin","$element","localizationService","fullScreen","permissionService","$window","featureSwitchService","promiseFactory","trustedVisual","taskPaneSliderService"]}},t.prototype.reloadTrustedVisuals=function(t){_.isEmpty(t)||(this.services.visualPlugin.ensureTrustedVisualPlugins(t),this.services.rootScope.$emit(e.constants.reloadEmptyVisuals,{visualTypes:t.map((function(e){return e.name}))}))},t.prototype.onOpenTile=function(t,i){t&&t.stopPropagation&&t.stopPropagation();var o=this.scope.viewModel;this.scope.$emit(e.constants.actualOpenTileEventName,i,o.id)},t.prototype.beginTemporaryTileFlow=function(e){e&&e.stopPropagation&&e.stopPropagation();var t=n.TileEditor,o=this.services,r=o.dashboardDataService.selectedDashboardTile;r&&r.tileModel.realTime&&(t=n.RealTimeBlade),this.services.taskPaneSliderService.expandPane(t,i.Large)},t.prototype.onRemoveTile=function(t,i){var o=this,a=this.scope.viewModel,n=a.contract,s=this.services.telemetryService.startEvent(e.telemetry.DashboardDeleteTile);this.deleteTile(i.id),this.services.dashboardHttpService.deleteTile(n,i.id,s.event).then((function(){a&&(o.updateDashboardContract(i,a),a.isUsedByContentPack&&o.services.rootScope.$emit(e.constants.contentPackDirtyShowNotification,a.id,r.Dashboard),a.hasModel(i.contract.modelId)||o.services.dashboardService.updateDashboardToken(a),s.resolve())}),(function(){s.reject()}))},t.prototype.updateDashboardContract=function(e,t){if(t&&e.report){var i=e.report.id,o=_.filter(t.tiles,(function(e){if(e.report)return e.report.id===i}));if(o&&0===o.length&&t.contract.reportIds){var r=t.contract.reportIds.indexOf(i);r!==-1&&this.services.modelConverter.updateDashboardsReportContract(r,t.contract)}}if(t&&e.contract&&e.contract.workbookId){var a=e.contract.workbookId,o=_.filter(t.tiles,(function(e){return!!e.contract&&e.contract.workbookId===a}));if(o&&0===o.length&&t.contract.workbookIds){var n=t.contract.workbookIds.indexOf(a);n!==-1&&this.services.modelConverter.removeDashboardsWorkbookContract(n,t.contract)}}},t.prototype.deleteTile=function(e){var t=this.scope.viewModel;this.services.dashboardDataService.deleteTile(t.id,e)},t.prototype.canEditDashboard=function(e){return e.canEdit&&!this.services.permissionService.isActiveWorkspaceIsReadOnly&&!this.services.fullScreen.fullScreenMode},t.prototype.canEditTiles=function(){return this.scope.viewModel.canEdit&&!this.scope.permissionServices.isActiveWorkspaceIsReadOnly&&!this.scope.fullScreen.fullScreenMode},t.prototype.onGridLayoutChanged=function(t){return this.scope.$emit(e.common.constants.domLayoutChangedEvent),this.services.dashboardService.batchUpdateTileSizePosition(this.scope.viewModel,t)},t.prototype.filteredTiles=function(){var e=this.scope.viewModel&&this.scope.viewModel.tiles;if(_.isEmpty(e))return[];this.scope.enableStrategySwap&&this.swapLayoutIfNeeded();var t=this.scope.displayLayout||0;return 0===t?e:_.filter(e,(function(e){return e.hasLayoutPosition(t)}))},t.prototype.swapLayoutIfNeeded=function(){var t=this.scope.viewModel.gridLayoutService;if(t){var i=this.scope.viewModel,r=_.any(i.tiles,(function(e){return e.hasLayoutDefinition(1)}));(t.strategy instanceof e.dataServices.models.PhonePortraitTileLayoutStrategy&&r||t.strategy.isDynamic()&&!r)&&this.scope.$emit(o.needStrategySwapEventName)}},t.prototype.removeTileFromMobile=function(e){if(1===this.scope.displayLayout&&e.gridLayoutContext){var t=[];t.push(e.removeLayoutPosition()),this.services.dashboardService.batchUpdateTileSizePosition(this.scope.viewModel,t)}},t.prototype.reloadActiveDashboard=function(){this.scope.showReloadDashboard=!1,this.services.dashboardService.loadDashboard(this.scope.viewModel.id)},t})();t.DashboardController=c})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.scope=e,this.services=t,this.initialize()}return e.createOptions=function(){return{additionalServices:["errorService","navigation","telemetryService","localizationService"]}},e.prototype.initialize=function(){var e=this;this.scope.switchToDashboardView=function(){return e.switchToDashboardView()}},e.prototype.switchToDashboardView=function(){this.services.navigation.navigateBack()},e})();e.DevToolsViewController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e){var t=this;this.scope=e,this.scope.chooseFormat=function(e){return t.chooseFormat(e)},this.scope.inProgress=!1}return t.prototype.chooseFormat=function(t){this.scope.inProgress=!0,this.scope.$emit(e.constants.uploadFormatChosenEventName,t)},t})();t.ExcelUploadFormatController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=e.common.constants,o=(function(){function e(e,t){var i=this;this.scope=e,this.services=t,this.scope.$on("$destroy",(function(){i.unRegisterDirtyStateNavigationHandler()}))}return e.prototype.unRegisterDirtyStateNavigationHandler=function(){this.reportChangedEventHandler&&(this.resetRouteChangeListeners(),this.reportChangedEventHandler())},e.prototype.registerDirtyStateNavigationHandler=function(){var e=this;this.unRegisterDirtyStateNavigationHandler(),this.reportChangedEventHandler=this.services.rootScope.$on(i.onReportChangedEventName,(function(t,o){e.resetRouteChangeListeners(),e.reportChanged=o&&(e.scope.viewModel.isEditing||1===e.services.viewModeState.getMode()),e.services.checkUnsavedService.setReportSavedState(o),e.reportChanged&&(e.routeStateChangeEvent=e.services.rootScope.$on(i.navigation.stateChangeStart,(function(t,o,r,a,n){a.name!==i.navigation.states.report&&a.name!==i.navigation.states.reports&&a.name!==i.navigation.states.reportPage&&a.name!==i.navigation.states.dashboardReport&&a.name!==i.navigation.states.dashboardReports&&a.name!==i.navigation.states.dashboardReportPage&&a.name!==i.navigation.states.dataset&&a.name!==i.navigation.states.datasets&&a.name!==i.navigation.states.sharedDashboardReports&&a.name!==i.navigation.states.sharedDashboardReports&&a.name!==i.navigation.states.sharedDashboardReportPage&&a.name!==i.navigation.states.reportSubscription||(e.showSavePrompt(o,r),t.preventDefault())})))}))},e.prototype.resetRouteChangeListeners=function(){this.routeStateChangeEvent&&(this.routeStateChangeEvent(),this.routeStateChangeEvent=null)},e.prototype.navigateAway=function(e,t){var i=this;this.services.rootScope.$applyAsync((function(){e&&e.name&&i.services.navigation.stateService.go(e.name,t)}))},e.prototype.showSavePrompt=function(e,t,i,o){},e.prototype.getSaveDialogTemplate=function(){var e=this,t="";return this.services.localizationService.ensureLocalization((function(){t='<div class="explorationSaveDialog"><div class="title">'+e.services.localizationService.get("ReportContainer_UnsavedChangeWarningTitle")+'</div><div class="message">'+e.services.localizationService.get("ReportContainer_UnsavedChangeWarningMessage")+"</div></div>"})),$(t)},e})();t.ExplorationContainerBaseController=o})(i=t.controllers||(t.controllers={}))})(t=e.common||(e.common={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.ArrayExtensions,o=e.common.constants,r=e.common.events,a=e.dataServices.models.ContentPackItems,n=e.explore.contracts.DataSource,s=e.errorDetailsHelper,c=e.explore.services.events,l=e.explore.constants.explorationClearedEventName,d=e.explore.constants.explorationLoadedEventName,p=e.explore.util.ExplorationTrustedVisualUtil,u=e.common.dialogs.FeatureNotSupportedDialogBuilder,v=jsCommon.JsonExtensions,h=e.common.constants.onReportChangedEventName,g=e.common.contracts.Permissions,m=e.explore.constants.pinVisualContainerEventName,f=e.explore.ScopeUtils,y=e.explore.util.ScriptVisualsUtil,b=e.explore.SectionUtils,S=e.explore.viewModels.ViewModelFactory,w=e.explore.viewModels,C=e.explore.util.VisualContainerUtils,D=e.dialogs.ExportDataDialogBuilder,I=(function(t){function I(i,a){var n=t.call(this,i,a)||this;n.changeToEditMode=function(t){var i=n.scope.viewModel,r=t?1:0;n.services.viewModeState.setMode(r),t&&(i.taskPane.isPaneExpanded=!0,i.visualizationPane.isPaneExpanded=!0),n.displayCustomVisualWarning(t);var a=y.getVisualStasInExploration(n.exploration,n.services.scriptVisuals);t||n.logRTelemetry(e.telemetry.EXLoadReportWithScriptVis,a),n.services.rootScope.$emit(e.common.constants.navigation.stateChangeStart,{},{},{name:o.navigation.states.reportPage},{}),i.isNavPaneCollapsed=!t,n.services.eventBridge.publishToChannel(c.changeViewMode,r)},n.scope.$on("destroy",(function(){n.modalDialogPromise&&n.modalDialogPromise.pending&&n.modalDialogPromise.reject("ExplorationContainerController destroyed")})),n.scope.$on(e.explore.constants.exploreCanvasVisualRendered,(function(){n.resolveOpenExplorationTelemetryEvent()})),n.scope.viewModeState=n.services.viewModeState,n.isSaveDialogOpened=!1,n.warningBarNotified=!1,f.defineDataSourcesOnScopeLegacy(n.scope,n.services.dataSources);var s=w.createFieldListViewModelFactory(w.createFieldListMenuItemFactory(n.services.localizationService,n.services.featureSwitchService),w.createFieldListPropertyTemplateGenerator(),n.services.localizationService,n.services.featureSwitchService);n.scope.fieldListConfig={viewModelFactory:s,alwaysHasActiveItem:!0},n.initialize(n.scope.viewModel),n.unregisterViewModelWatch=n.scope.$watch("viewModel",(function(e){n.initialize(e)}));var l=n.services.rootScope.$on(r.loadPowerViewReportEventName,(function(e,t){e.stopPropagation(),n.onLoadPowerViewReport(t)})),d=n.services.rootScope.$on(r.refreshReportData,(function(e){e.stopPropagation(),n.onRefreshReportData()})),p=n.services.eventBridge.setBubblingScope(i).subscribe(c.saveExploration,(function(e,t){return n.save(e,t)})).subscribe(c.saveAsExploration,(function(e,t){return n.saveAs(e,t)})).subscribe(c.generateReportQR,(function(e){return n.generateQR(e)})).subscribe(c.refreshExploration,(function(e){return n.refresh(e)})).subscribe(c.deleteVisual,(function(e,t){return n.deleteVisual(e,t)})).subscribe(c.deleteCustomVisuals,(function(e){return n.deleteCustomVisuals(e)})).subscribe(c.pauseQueriesChanged,(function(e){return n.pauseQueriesChanged(e)})).subscribe(c.showErrorNotification,(function(e,t){
return n.showErrorNotification(e,t)})).subscribe(c.exportToPowerPoint,(function(e){return n.exportToPowerPoint(e)})).subscribe(c.exportAsImage,(function(e){return n.exportAsImage(e)})),u=n.services.eventBridge.createChannelSubscriptionManager().subscribe(c.sectionChanged,(function(e,t){return n.onSectionChange(t)})).subscribe(c.requestViewModeChange,(function(e,t){return n.onRequestViewModeChange(t)})).subscribe(c.addCustomVisual,(function(e,t){return n.onAddCustomVisual(e,t)})).subscribe(c.saveKeyPressedEvent,(function(e){return n.saveOnKeypress(e)})).subscribe(c.deleteSectionInitiated,(function(e,t){return n.onDeleteSection(t)})).subscribe(c.addVisualContainer,(function(e,t){return n.onAddVisualContainer(e,t)})).subscribe(c.importVisual,(function(e){return n.importVisual(e)})).subscribe(c.visualRelationshipsModeChanged,(function(e){n.services.viewModeState.updateConfig((function(e){e.showRelationships=!e.showRelationships}))})).subscribe(c.exportVisualData,(function(e,t){return n.exportVisualData(e,t)})).subscribe(c.popOutModeChanged,(function(){var e=!!n.services.popOut.getPoppedOutVisualContainer();!!n.isPopOutMode===e||n.isActiveSectionTransient?n.isPopOutMode=e:(n.isPopOutMode=e,n.updateNavigationPaneVisibility())})).subscribe(c.createBasicShape,(function(e,t){return n.onCreateBasicShape(e,t)})).subscribe(c.createTextbox,(function(e){return n.onCreateTextbox(e)})).subscribe(c.refreshExploration,(function(e){return n.refresh(e)})).subscribe(c.deleteCustomVisual,(function(e,t){return n.onDeleteCustomVisual(t)})).subscribe(c.newQueryCacheResultAvailable,(function(e,t){return n.onNewQueryCacheResultAvailable(e,t)}));n.services.pinVisual.setHandler({pinVisual:function(e){n.pinVisual(e)}}),n.services.connectionSetupService=e.explore.services.createConnectionSetupService(n.services.conceptualSchemaProxy,n.services.dataProxy,n.services.visualAuthoring,n.services.visualQueryGenerator),$(window).on(jsCommon.DOMConstants.beforeUnload,(function(){return n.onWindowUnload()}));var v=n.services.rootScope.$on(e.constants.saveReportFromPinDialog,(function(t,i){n.saveAsInternalWithName(i).then((function(){var t=n.services.reportService.findReport(n.reportId);t||n.services.reportService.addReport(n.services.modelConverter.convertReport({id:n.reportId,permissions:e.common.contracts.Permissions.All|e.common.contracts.Permissions.Explore})),t=n.services.reportService.findReport(n.reportId),t.isNew=!0,n.services.pinTileService.setSavedReport(t)}))})),h=n.services.rootScope.$on(c.showErrorNotification.name,(function(e,t,i,o){n.showErrorNotificationWithModel(i,t,o)}));n.scope.fullScreen=n.services.fullScreen,n.scope.featureSwitchService=n.services.featureSwitchService,n.scope.isFooterVisible=function(){return n.isFooterVisible()},n.scope.isVisualizationPaneVisible=function(){return n.isVisualizationPaneVisible()},n.scope.$watch("fullScreen.fullScreenMode",(function(e){n.onFullScreenChange(e)}));var g=n.scope.$on(o.navigation.stateChangeSuccess,(function(e,t,i,o,r){return n.handleStateChange(e,t,i,o,r)}));return n.scope.$on("$destroy",(function(){n.removeKeyHandler(),l(),g(),v(),h(),n.unregisterViewModelWatch&&n.unregisterViewModelWatch(),d(),p.unsubscribeAll(),u.unsubscribeAll()})),n.embedTypeDescription=n.services.embedModeService.getEmbedTypeDescription(),n}return __extends(I,t),I.createOptions=function(){return{additionalServices:["checkUnsavedService","conceptualSchemaProxy","dashboardService","dataProxy","embedModeService","errorService","explorationProxy","explorationSerializer","exportStaticExplorationService","exportToPowerPoint","featureSwitchService","fullScreen","gatewaysMetadataService","groupService","linguisticSchemaProxy","localizationService","modalDialogService","modelConverter","modelHttpService","moduleLoader","navigation","notificationBar","notificationToast","overlayService","packageService","pbiLazyLoad","permissionService","pinTileService","promiseFactory","qrCodeService","reportService","modelService","resourceGateService","resourcePackagesService","selectGatewayService","quota","telemetryService","themeService","userInfo","visualStylePresetService","auditing","mostRecentlyUsedService","trustedVisual","subscription","usageMetricsReport","activeGroupId","licenseEnforcementService","viewRelatedContentService"],scopedServiceRoot:!0,scopedDependencies:["canvasKeyHandler","clipboard","colorPicker","dataSources","deleteVisual","drillToDetails","eventBridge","explorationCapabilities","explorationNavigation","exportData","filterGenerator","formFactor","importVisual","layoutAuthoring","modelChangeHandler","pinVisual","popOut","registeredResourceReferences","resourceLoader","resourceRegistration","scriptVisuals","selection","sort","undoRedo","viewModeState","visualAuthoring","visualPlugin","visualQueryGenerator"]}},I.prototype.isFooterVisible=function(){var e=this.scope.viewModel;return!!e&&(e.options.showNavContentPane&&!this.services.viewModeState.getConfig().displayOptions.hideNavigationPane)},I.prototype.isVisualizationPaneVisible=function(){var e=this.scope.viewModel;return!!e&&(e.options.showVisualizationPane&&!this.services.viewModeState.getConfig().displayOptions.hideVisualizationPane)},I.prototype.showOptionsDialog=function(t){var i=this,o="exportDataDialog",r=[{name:this.services.localizationService.get("ModalDialog_ExportDataFormatXL"),action:function(){return 1===i.services.exportData.getExportDataToExcelUnsupportedType(t.visualConfig,i.scope.viewModel.datasetModel)?void(i.modalDialogPromise=new u(i.services.modalDialogService).show("ExlFormat_UnsupportedDatasetDialogTitle","ExlFormat_ToolTipDescription_AsOnPrem","https://go.microsoft.com/fwlink/?linkid=834313")):void i.exportVisualDataToFile(t,1,0)}},{name:this.services.localizationService.get("ModalDialog_ExportDataFormatCsv"),action:function(){i.exportVisualDataToFile(t,0,0)}}];this.services.modalDialogService.showActionSelectionDialog(this.services.localizationService.get("ModalDialog_ExportDataTitle"),this.services.localizationService.get("ModalDialog_ExportDataText"),o,r,this.services.localizationService.get("ModalDialogButtonText_Export"),this.services.localizationService.get("PBI_Button_Label_Cancel")),this.services.telemetryService.logEvent(e.telemetry.EXExportVisualDataDialogShown)},I.prototype.showExportDataDialogFromVisual=function(t,i){var o,r=this,a=new D(this.services.modalDialogService,this.services.localizationService),n=this.services.exportData.getExportDataToExcelUnsupportedType(t.visualConfig,this.scope.viewModel.datasetModel);0===n&&(o=this.services.drillToDetails.getDetailsTableTargetMeasure(t.visualConfig));var s=!!o;a.show(n,s).then((function(e){e&&r.exportVisualDataToFile(t,e.format,e.dataType,o)})),i&&this.services.telemetryService.logEvent(e.telemetry.EXExportVisualDataDialogFromVisualIsShown)},I.prototype.isVisualInSeeRecordsMode=function(e){return C.hasGroupByItems(e)},I.prototype.exportVisualData=function(e,t){e.stopPropagation();var i=this.services.featureSwitchService.featureSwitches,o=this.services.explorationCapabilities.getCapabilities();i.exportVisualToExcelEnabled&&!o.disableExportToExcel?this.isVisualInSeeRecordsMode(t.visualConfig.query)?this.showOptionsDialog(t):i.enableExportDataNewDialog?this.showExportDataDialogFromVisual(t,!0):this.exportVisualDataToFile(t,0,0):this.exportVisualDataToFile(t,0,0)},I.prototype.exportVisualDataToFile=function(t,i,o,r){var a,n=this.services.dataSources.get(),s=this.services,c=s.userInfo.isPremiumUser,l=s.telemetryService.startEvent(e.telemetry.EXExportVisualData,t.visualConfig.visualType,e.telemetry.ExportVisualSource.Report,!1,i,c,this.isVisualInSeeRecordsMode(t.visualConfig.query),o),d=1===o;a=0===i?s.exportData.exportVisualDataToCsv(t.visualTitle,t.dataViewSource,n,t.visualConfig,t.transformActions,t.additionalFilters):s.exportData.exportVisualDataToExcel(t.visualTitle,n,t.visualConfig,t.additionalFilters,d,r),a.then((function(e){l.event.info.isPartialResult=e.isPartialResult,l.resolve()}),(function(e){l.reject({errorCode:e.error.toString()})})),this.services.auditing.auditEvent(this.reportId,e.common.contracts.AuditEntityType.Report,e.common.contracts.AuditActivityType.exportReportTile)},I.prototype.exportToPowerPoint=function(e){if(e.stopPropagation(),this.services.licenseEnforcementService.supportsExportToPowerPoint(!0)){var t=this.services.reportService.findReport(this.reportId),i={reportId:this.reportId,filename:t.displayName,reportSectionsNumber:this.exploration&&this.exploration.sections?this.exploration.sections.length:void 0};this.services.exportToPowerPoint.exportToPowerPoint(i)}},I.prototype.exportAsImage=function(e){e.stopPropagation();var t=this.services.reportService.findReport(this.reportId),i=this.services.explorationNavigation.getCurrentSection().name;this.services.exportStaticExplorationService.exportToPng(t.displayName,t.objectId,i)},I.prototype.onDeleteSection=function(t){var i=this;if(t.supportMinervaDialog){var o=t.sectionIndex,r=this.services.rootScope.$new(),a=this.scope.viewModel,n=this.services.errorService.control(),s=[new InJs.ModalDialogAction(this.services.localizationService.get("ExplorationNavigationTab_Delete"),function(t,r){n.hideDialog(),i.services.rootScope.$emit(e.explore.constants.deleteSectionEvent,o)}),new InJs.ModalDialogAction(this.services.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){n.hideDialog()})];r.message=this.services.localizationService.get("ExplorationNavigationTab_DeleteWarningMessage");var c=a&&a.exploration&&a.exploration.sections&&a.exploration.sections[o]&&a.exploration.sections[o].contract?a.exploration.sections[o].contract.id:void 0,l=void 0;this.services.dashboardService.hasTileForReportandSection&&(l=this.services.dashboardService.hasTileForReportandSection(c));var d=void 0,p=void 0;l&&(d=jsCommon.ModalDialogNotificationType.Warning,p=this.services.localizationService.get("PinLiveReport_DeleteSectionWarning"));var u={dialogName:this.services.localizationService.get("ExplorationNavigationTab_DeleteWarningTitle"),isDismissable:!0,scope:r,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",dialogActions:s,notificationType:d,notificationText:p};this.services.modalDialogService.showLegacyWebModalDialog(u)}},I.prototype.onNewQueryCacheResultAvailable=function(t,i){var o=this.scope.viewModel.exploration,r=this.services.explorationCapabilities.getCapabilities();o&&!r.disableCacheUpdates&&(this.visualContainerQueryUpdater||(this.visualContainerQueryUpdater=new e.helpers.VisualContainerQueryUpdater(o.contract.id,this.services.explorationProxy)),this.visualContainerQueryUpdater.onNewQueryCacheResultAvailable(i)),t.stopPropagation&&t.stopPropagation()},I.prototype.initialize=function(e){if(this.scope.explorationContainerOptions&&this.services.explorationCapabilities.setCapabilities(this.scope.explorationContainerOptions),e){e.showSpinner=!0,e.options||(e.options=this.services.explorationCapabilities.getCapabilities());var t=e.options;this.explorationNotificationIds=[];var i=this.services.featureSwitchService;this.services.viewModeState.updateConfig((function(e){e.supportsPinning=!t.visualContainerOptions.disablePin,e.supportsDeletion=!0,e.supportsExportData=!t.disableExport&&i.featureSwitches.exportDataEnabled})),e.shouldHideFilterPane&&(e.options.showVisualizationPane=!1),e.options.showAppBar=!e.shouldHideAppBar&&t.showAppBar,this.isPopOutMode&&this.services.popOut.clearPopOut(),this.updateNavigationPaneVisibility(),e.shouldHideTileMenu&&(e.options.visualContainerOptions.hideHeader=!0),e.options.overrideDisplayOption=e.overrideDisplayOption||e.options.overrideDisplayOption,e.options.disableViewRelatedContent=this.services.viewRelatedContentService.disableViewRelated}},I.prototype.notifyIfModelRefreshDisabledBySelectiveRefresh=function(){var t=this.services;if(t.featureSwitchService.featureSwitches.selectiveModelRefresh){var i=this.scope.viewModel.datasetModel;if(i&&i.isRefreshDisabledDueToInactivity()){var o={notificationName:"inactiveModelRefreshDisabled",notificationId:t.notificationBar.notify({message:t.localizationService.get("Notification_InactiveModelRefreshDisabled"),notificationType:e.common.NotificationBarType.Warning,secondaryLink:{displayText:t.localizationService.get("LearnMore"),urlString:e.constants.configureScheduledRefreshLink}})};this.addNotification(o)}}},I.prototype.deleteVisual=function(e,t){var i=this.services.rootScope.$new(),o=this.scope.viewModel.exploration.contract;i.deleteVisualService=this.services.deleteVisual,i.errorService=this.services.errorService,i.explorationContract=o,i.customVisuals=[t.visual],i.deleteVisualButtonText=this.services.localizationService.get("DeleteVisual_Delete");var r=this.getCustomVisualContainerCount(t.visual);r>0?i.deleteVisualWarningText=this.services.localizationService.format("DeleteVisual_CustomVisualUsedMessage",[r]):i.deleteVisualWarningText=this.services.localizationService.format("DeleteVisual_CustomVisualNotUsedMessage",[r]);var a={dialogName:this.services.localizationService.get("DeleteVisual_DialogHeader"),isDismissable:!0,scope:i,template:"<delete-visual-warning-dialog></delete-visual-warning-dialog>",dialogCssClass:"deleteVisualWarning"};this.services.modalDialogService.showLegacyWebModalDialog(a),e.stopPropagation()},I.prototype.deleteCustomVisuals=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a;return __generator(this,(function(n){switch(n.label){case 0:return i=this.services.rootScope.$new(),o=this.scope.viewModel.exploration.contract,i.deleteVisualService=this.services.deleteVisual,i.errorService=this.services.errorService,i.localizationService=this.services.localizationService,i.modalDialogService=this.services.modalDialogService,i.explorationContract=o,r={selectedVisualCount:0,customVisuals:[]},r.customVisuals=S.getCustomVisualTypes(this.services.visualPlugin.getConvertibleVisuals()),this.getCustomVisualsTileCounts(r.customVisuals),i.viewModel=r,t.stopPropagation(),[4,this.services.pbiLazyLoad.load(e.explore.modules.ExploreUIShellModule)];case 1:return n.sent(),a={dialogName:this.services.localizationService.get("DeleteVisuals_DialogHeader"),isDismissable:!0,scope:i,template:"<delete-custom-visuals-dialog></delete-custom-visuals-dialog>",dialogCssClass:"deleteCustomVisuals"},this.services.modalDialogService.showLegacyWebModalDialog(a),[2]}}))}))},I.prototype.importVisual=function(e){var t=this.services.rootScope.$new();t.importVisualService=this.services.importVisual,t.errorService=this.services.errorService,t.explorationContract=this.scope.viewModel.exploration.contract;var i={dialogName:this.services.localizationService.get("ImportVisual_CautionDialogHeader"),isDismissable:!0,scope:t,template:"<import-visual-warning-dialog></import-visual-warning-dialog>",dialogCssClass:"importVisualWarning"};this.services.modalDialogService.showLegacyWebModalDialog(i),e.stopPropagation()},I.prototype.onAddCustomVisual=function(e,t){this.services.undoRedo.clear();var o=this.scope.viewModel.exploration.contract.resourcePackages;o?o.withName(t.name)||o.push(t):o=this.scope.viewModel.exploration.contract.resourcePackages=i.createWithName(),this.services.resourcePackagesService.registerPackages([t]),e.stopPropagation()},I.prototype.onDeleteCustomVisual=function(e){var t=[];this.scope.viewModel.exploration.sections.forEach((function(i){i.contract.visualContainers.forEach((function(i){i.config.singleVisual.visualType===e.visual.name&&t.push(i)}))})),this.services.visualAuthoring.deleteVisualContainers(t,this.scope.viewModel.exploration),this.services.rootScope.$emit(o.onReportChangedEventName,!0)},I.prototype.onCreateTextbox=function(e){this.onAddVisualContainer(e,{visualType:"textbox",telemetrySource:4})},I.prototype.onCreateBasicShape=function(e,t){this.services.visualAuthoring.addVisualContainerBasicShape(this.scope.viewModel.exploration.exploreCanvas,t.shapeType,null)},I.prototype.onAddVisualContainer=function(t,i){e.explore.util.CanvasVisualsUtility.addVisualContainerToCanvas(i,this.scope.viewModel.exploration.exploreCanvas,this.services.dataSources.get(),this.services.visualAuthoring,this.services.telemetryService),t.stopPropagation&&t.stopPropagation()},I.prototype.onWindowUnload=function(){if(this.reportChanged&&1===this.services.viewModeState.getMode())return this.services.localizationService.get("ReportContainer_WindowUnload")},I.prototype.onFullScreenChange=function(e){if(this.scope.viewModel&&this.scope.viewModel.options){var t=this.scope.viewModel.options;e?(this.services.navigation.inReportDetailView()&&1===this.services.viewModeState.getMode()&&this.onRequestViewModeChange(0),this.oldOptions=_.cloneDeep(this.scope.viewModel.options),t.visualContainerOptions.showPin=!1,t.showAppBar=!1,t.showTaskPane=!1,t.showVisualizationPane=!this.services.navigation.inReportEmbedView(),this.isReportInEmbedView=this.services.navigation.inReportEmbedView(),this.updateNavigationPaneVisibility(!1)):this.oldOptions&&(this.services.explorationCapabilities.setCapabilities(this.oldOptions),t=this.services.explorationCapabilities.getCapabilities(),t.visualContainerOptions.disablePin=!this.scope.viewModel.canEdit,this.oldOptions=null)}},I.prototype.showUnsupportedVisualSaveError=function(){this.services.errorService.infoCustom(this.services.localizationService.get("ExploreCompatibility_UnsupportedVisualSaveErrorTitle"),this.services.localizationService.get("ExploreCompatibility_UnsupportedVisualSaveErrorMessage"))},I.prototype.showSavePrompt=function(t,i,o,r){var a=this,n=this.services.errorService.control();_.isFunction(r)||(r=_.noop);var s=[new InJs.ModalDialogAction(this.services.localizationService.get("ReportContainer_Save"),function(o,s){if(n.hideDialog(),a.isSaveDialogOpened=!1,e.helpers.ReportUtility.HasUnsupportedExploreVisuals(a.scope.viewModel.exploration.contract,a.services.visualPlugin))a.showUnsupportedVisualSaveError();else{var c=a.services.promiseFactory.defer();a.triggerSaveOrSaveAs(c),c.promise.then((function(){r(),a.navigateAway(t,i)})).finally((function(){a.hideSaveMask()}))}}),new InJs.ModalDialogAction(this.services.localizationService.get("ReportContainer_Dontsave"),function(e,o){r(),n.hideDialog(),a.services.rootScope.$emit(h,!1),a.navigateAway(t,i),a.isSaveDialogOpened=!1}),new InJs.ModalDialogAction(this.services.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){n.hideDialog(),a.isSaveDialogOpened=!1})];this.isSaveDialogOpened===!1&&(n.showCustomDialog(null,this.getSaveDialogTemplate(),s,null,!0,null,null,null,(function(){a.isSaveDialogOpened=!1})),this.isSaveDialogOpened=!0)},I.prototype.removeKeyHandler=function(){this.currentKeyHandler&&($(window).off("keydown",this.currentKeyHandler),this.currentKeyHandler=void 0)},I.prototype.addKeyHandler=function(){var e=this;this.currentKeyHandler||(this.currentKeyHandler=function(t){if(e.scope.viewModel&&e.scope.viewModel.exploration&&!$(t.target).is(jsCommon.DOMConstants.EditableTextElements)&&!$(t.target).is(jsCommon.DOMConstants.EditableNumericElements))return e.services.canvasKeyHandler.onKeyDown(t,e.scope.viewModel.exploration.exploreCanvas)},$(window).on("keydown",this.currentKeyHandler))},I.prototype.handleStateChange=function(e,t,i,o,r){this.scope.viewModel.showSpinner=!0,this.hideAllExplorationWarnings();var a=this.services.navigation.inReportView()||this.services.navigation.inDatasetView();a||(this.removeKeyHandler(),this.clearExploration()),this.services.overlayService.hideAllDropdowns()},I.prototype.pinVisual=function(t){if(t){var i=this.services.explorationNavigation.getCurrentSection().name;t.reportId=this.reportId;var o=this.services.dataSources.get();o.length>0&&(t.modelId=o[0].id,t.packageId=this.packageId);var r,a=this.getReportContract();a&&this.services.featureSwitchService.featureSwitches.usageMetricsEnabled&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack(a)&&(r=this.services.navigation.additionalODataFilter),t.action={action:e.common.constants.openReportActionName,targetSlideId:i,filter:r},this.services.rootScope.$emit(m,t)}},I.prototype.onSectionChange=function(e){var t=this.services.navigation;t.updateReportStateNoReload({appGUID:t.currentAppGUID,appInstanceId:t.currentAppInstanceId,reportGUID:t.currentReportGUID,reportOriginalGUID:t.currentReportOriginalGUID,groupGUID:this.services.groupService.activeGroupObjectId,reportPage:e.name,dashboardGUID:t.currentDashboardGUID},!1,2);var i=this.scope.viewModel.exploration.contract;this.services.layoutAuthoring.updateExplorationActiveSectionIndex(i,e.name,this.services.navigation.currentReportGUID,this.services.groupService.activeGroupObjectId);var o=this.services.explorationNavigation.getCurrentSection(),r=o&&o.transient;!!this.isActiveSectionTransient==!!r||this.isPopOutMode?this.isActiveSectionTransient=r:(this.isActiveSectionTransient=r,this.updateNavigationPaneVisibility())},I.prototype.logRTelemetry=function(e,t){this.scope.viewModel.options.disableLogRTelemetry||this.services.telemetryService.logEvent(e,t.totalVisualsCount,t.scriptVisualsUniqueIds.length,JSON.stringify(t.scriptVisualsUniqueIds),this.services.userInfo.userLicense())},I.prototype.onRequestViewModeChange=function(e){var t=this,i=1===e;i&&!this.scope.viewModel.canEdit||(this.reportChanged?this.showSavePrompt({},o.navigation.states.reportPage,"",(function(){t.changeToEditMode(i)})):this.changeToEditMode(i))},I.prototype.hideAllExplorationWarnings=function(){for(var e=this.explorationNotificationIds;e.length>0;)this.services.notificationBar.hide(e.pop().notificationId);this.explorationNotificationIds=[]},I.prototype.hideExplorationWarning=function(e){for(var t=this.explorationNotificationIds,i=0,o=t;i<o.length;i++){var r=o[i];if(e&&r.notificationName===e){this.services.notificationBar.hide(r.notificationId),t.splice(t.indexOf(r),1);break}}this.explorationNotificationIds=t},I.prototype.isNotificationShown=function(e){for(var t=this.explorationNotificationIds,i=0,o=t;i<o.length;i++){var r=o[i];if(e&&r.notificationName===e)return r.notificationId}},I.prototype.addNotification=function(e){e&&(this.isNotificationShown(e.notificationName)&&this.hideExplorationWarning(e.notificationName),this.explorationNotificationIds.push(e))},I.prototype.createCustomVisualWarningHelper=function(t,i){var o=this;if(this.scope.viewModel.options.customVisualsAlwaysEnabled)t&&this.onEnsureCustomViz(t.resourcePackages,i);else if(!this.warningBarNotified){this.warningBarNotified=!0,this.services.telemetryService.logEvent(e.telemetry.EXLoadReportWithCustomViz,this.embedTypeDescription);var r={notificationName:"lastEnableCustomVizNotifyId",notificationId:this.services.notificationBar.notify({message:this.services.localizationService.get("OpenReport_EnableCustomVisualWarningMessage"),notificationType:e.common.NotificationBarType.Warning,actions:[{displayText:this.services.localizationService.get("OpenReport_EnableCustomVisualButton"),linkId:1,action:function(){o.services.resourceGateService.addResourcePackageIdToDashboard(t.id.toString(),t.resourcePackages.map((function(e){return e.id.toString()}))),o.onEnsureCustomViz(t.resourcePackages,i)}}],secondaryLink:{displayText:this.services.localizationService.get("LearnMore"),urlString:"https://go.microsoft.com/fwlink/?LinkID=627490"}})};this.addNotification(r)}},I.prototype.createCustomVisualWarning=function(e,t){this.services.resourceGateService.shouldShowWarning(e.resourcePackages.map((function(e){return e.id.toString()})),e.id.toString())?this.createCustomVisualWarningHelper(this.exploration,t):this.onEnsureCustomViz(e.resourcePackages,t)},I.prototype.updateNavigationPaneVisibility=function(e){void 0===e&&(e=!0),e&&(this.isPopOutMode||this.isActiveSectionTransient?this.oldOptions=_.cloneDeep(this.scope.viewModel.options):this.oldOptions&&(this.services.explorationCapabilities.setCapabilities(this.oldOptions),this.oldOptions=null));var t=!this.isPopOutMode&&!this.isActiveSectionTransient&&this.services.explorationCapabilities.getCapabilities().showNavContentPane;this.scope.viewModel.options.showNavContentPane=!this.scope.viewModel.shouldHideSlideBar&&t},I.prototype.displayCustomVisualWarning=function(e){if(this.exploration&&this.exploration.resourcePackages&&this.exploration.resourcePackages.length>0)if(!e&&this.exploration.sections)for(var t=this.exploration.sections,i=0,o=t;i<o.length;i++){var r=o[i];if(r.visualContainers){var a=r.visualContainers;if(this.containsCustomVisual(a)){this.createCustomVisualWarning(this.exploration,e);break}}}else this.createCustomVisualWarning(this.exploration,e)},I.prototype.containsCustomVisual=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];if(o.config&&o.config.singleVisual&&o.config.singleVisual.visualType){var r=o.config.singleVisual.visualType;if(this.resourcePackageContainsCustomVisual(r))return!0}}return!1},I.prototype.getCustomVisualContainerCount=function(e){var t=0;return this.scope.viewModel.exploration.contract.sections.forEach((function(i){i.visualContainers.forEach((function(i){i.config.singleVisual.visualType===e.name&&++t}))})),t},I.prototype.getCustomVisualsTileCounts=function(e){var t=this;e.forEach((function(e){e.tileCount=0,t.scope.viewModel.exploration.contract.sections.forEach((function(t){for(var i=0,o=t.visualContainers;i<o.length;i++){var r=o[i];r.config.singleVisual.visualType===e.plugin.name&&(e.tileCount+=1)}})),e.tileCountMessage=t.services.localizationService.format("DeleteVisual_AssociatedTiles",[e.tileCount]),e.selected=!1}))},I.prototype.resourcePackageContainsCustomVisual=function(e){if(this.exploration&&this.exploration.resourcePackages)for(var t=this.exploration.resourcePackages,i=0,o=t;i<o.length;i++){var r=o[i];if(r.name===e)return!0}return!1},I.prototype.notifyForSave=function(t,i,o){var r=this;this.services.localizationService.ensureLocalization((function(){r.services.notificationToast.notify({title:r.services.localizationService.get(t),message:r.services.localizationService.get(o),notificationType:e.common.NotificationToastType.Success})}))},I.prototype.triggerSaveOrSaveAs=function(t){var i=this;if(this.reportId){var o,r=this.services.telemetryService.startEvent(e.telemetry.EXSaveExploration,!1);return this.showSaveMask(),this.prepareToSave(),this.services.explorationProxy.save(this.originalExploration,this.scope.viewModel.exploration.contract,this.reportId).then((function(e){return e||t.reject(),o=e,i.services.linguisticSchemaProxy.save(e.reportId)})).then((function(){i.lastLoadedReport.contract.hasExploration=!0,i.onSaveSuccessCommon(o),i.notifyForSave("SaveReport_Success",0,"SaveReport_Success_DefaultDetails");var n=i.services.reportService.findReport(i.reportId);n&&n.isUsedByContentPack&&i.services.rootScope.$emit(e.constants.contentPackDirtyShowNotification,i.reportId,a.Report),r.resolve(),t.resolve(null)}),(function(e){i.showError(e,i.services.localizationService.get("ExplorationContainer_FailedToSaveReport"),"ExplorationContainer_FailedToSaveReportDefaultDetails"),r.reject(s.getTelemetryErrorDetails(e?e.error:null,e?e.httpStatusCode:null)),t.reject()}))}return this.saveAsInternal().then((function(){i.notifyForSave("SaveReport_Success",0,"SaveReport_Success_DefaultDetails"),t.resolve(null)}),(function(){t.reject()}))},I.prototype.saveOnKeypress=function(e){if(this.scope.viewModel.canEdit){var t=this.scope.viewModel.options,i={overrideSaveRouting:this.services.explorationCapabilities.getCapabilities().overrideSaveRouting};0!==this.scope.viewModeState.getMode()||t.disableSaveOnKeyPress?this.save(e,i):this.saveAs(e,i)}},I.prototype.refresh=function(t){var i={changes:[],isSchemaChangeListComplete:!1};this.services.modelChangeHandler.applyChange({change:this.services.promiseFactory.resolve(i),leaveUndo:!0}),this.hideExplorationWarning("lastErrorNotifyId"),t&&t.stopPropagation&&t.stopPropagation();var o=y.getVisualStasInExploration(this.exploration,this.services.scriptVisuals);this.logRTelemetry(e.telemetry.EXExplorationRefresh,o)},I.prototype.prepareToSave=function(){},I.prototype.save=function(t,i){var o=this;if(!i||!i.overrideSaveRouting){if(this.reportId)if(e.helpers.ReportUtility.HasUnsupportedExploreVisuals(this.scope.viewModel.exploration.contract,this.services.visualPlugin))this.showUnsupportedVisualSaveError();else{var r,n=this.services.telemetryService.startEvent(e.telemetry.EXSaveExploration,!1);this.showSaveMask(),this.prepareToSave(),this.services.explorationProxy.save(this.originalExploration,this.scope.viewModel.exploration.contract,this.reportId).then((function(e){return e||o.services.promiseFactory.reject(),r=e,o.services.linguisticSchemaProxy.save(e.reportId)})).then((function(){o.lastLoadedReport.contract.hasExploration=!0,o.onSaveSuccessCommon(r),o.notifyForSave("SaveReport_Success",0,"SaveReport_Success_DefaultDetails");var t=o.services.reportService.findReport(o.reportId);t&&t.isUsedByContentPack&&o.services.rootScope.$emit(e.constants.contentPackDirtyShowNotification,o.reportId,a.Report),n.resolve()}),(function(e){o.showError(e,o.services.localizationService.get("ExplorationContainer_FailedToSaveReport"),"ExplorationContainer_FailedToSaveReportDefaultDetails"),n.reject(s.getTelemetryErrorDetails(e?e.error:null,e?e.httpStatusCode:null))})).finally((function(){o.hideSaveMask()}))}else this.saveAsInternal().then((function(){o.notifyForSave("SaveReport_Success",0,"SaveReport_Success_DefaultDetails")}),(function(){}));this.services.overlayService.hideAllDropdowns(),t.stopPropagation&&t.stopPropagation()}},I.prototype.generateQR=function(e){this.services.qrCodeService.showDialogForReport(this.scope,this.services.explorationNavigation.getCurrentExploration().report,this.scope.viewModel.displayName,this.services.groupService.activeGroupObjectId,this.services.navigation.currentReportPage,this.services.navigation.currentAppGUID)},I.prototype.saveAs=function(t,i){var o=this;i&&i.overrideSaveRouting||this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.ReportSaveAs)||(this.saveAsInternal(i.saveAsWithoutPrompt).then((function(){o.notifyForSave("SaveReport_Success",0,"SaveReport_Success_DefaultDetails")}),(function(){})),this.services.overlayService.hideAllDropdowns(),t.stopPropagation&&t.stopPropagation())},I.prototype.synchronizeExplorationIds=function(e,t){t.id=e.id,t.reportId=e.reportId,b.synchronizeSectionsIds(e.sections,t.sections)},I.prototype.onSaveSuccessCommon=function(e){this.synchronizeExplorationIds(e,this.scope.viewModel.exploration.contract);var t={featureUsage:{}},i=this.services.explorationSerializer,o=i.serializeExploration(e,t);this.originalExploration=i.deserializeExploration(o,[],!0),this.sendTelemetryForCapabilities(t),this.services.rootScope.$emit(h,!1)},I.prototype.confirmSaveAs=function(t,i){var r=this;this.showSaveMask();var a,n=this.services.telemetryService.startEvent(e.telemetry.EXSaveExploration,!0),c=this.services,l=this.scope.viewModel.exploration.contract.reportId;this.prepareToSave();var d=this.services.dataSources.get();this.services.explorationProxy.saveAs(this.scope.viewModel.exploration.contract,t,d[0].id,this.packageId).then((function(e){e&&e.reportId||i.reject(),a=e;var t=r.services.linguisticSchemaProxy;if(l){var o=t.getSchema(l);t.setSchema(e.reportId,o)}return t.save(e.reportId)})).then((function(){var s=c.navigation;if(r.scope.viewModel.displayName=t,r.reportId=a.reportId,r.reportGUID=a.report.objectId,r.onSaveSuccessCommon(a),r.services.usageMetricsReport.isUsageMetricsContentProvider&&r.services.usageMetricsReport.isUsageMetricsContentProvider(r.scope.viewModel.datasetModel.contentProviderId))r.scope.viewModel.options.showTaskPane=!0,r.scope.viewModel.options.showVisualizationPane=!0,r.services.reportService.mergeReportCollection([a.report]),r.services.modelService.mergeDatasetCollection([a.report.model]),s.navigateToReport({groupGUID:c.groupService.activeGroupObjectId,reportGUID:a.report.objectId,reportPage:s.currentReportPage,filter:null});else{var l={id:r.reportId,displayName:t,guid:r.reportGUID};s.updateReportStateNoReload({reportGUID:r.reportGUID,groupGUID:c.groupService.activeGroupObjectId,reportPage:s.currentReportPage
},!0).then((function(){return c.rootScope.$emit(o.currentActiveReportInfoChangedEventName,l)})),r.updateReportInfo(l),c.mostRecentlyUsedService.updateMRU(e.models.MRUArtifactType.Reports,r.reportGUID,t,a.report.permissions)}n.resolve(),i.resolve(a)}),(function(e){r.showError(e,r.services.localizationService.get("ExplorationContainer_FailedToSaveReport"),"ExplorationContainer_FailedToSaveReportDefaultDetails"),n.reject(s.getTelemetryErrorDetails(e?e.error:null,e?e.httpStatusCode:null)),i.reject()}))},I.prototype.updateReportInfo=function(e){var t=this.scope&&this.scope.viewModel&&this.scope.viewModel.exploration&&this.scope.viewModel.exploration.contract&&this.scope.viewModel.exploration.contract.report;t&&(t.id=e.id,t.objectId=e.guid,t.displayName=e.displayName)},I.prototype.saveAsInternal=function(t){var i=this,o=this.services.promiseFactory.defer();return t?this.confirmSaveAs(void 0,o):e.explore.controllers.showSaveAsDialog(this.services.errorService,this.services.localizationService).then((function(e){i.confirmSaveAs(e,o)}),(function(){o.reject()})),o.promise.finally((function(){i.hideSaveMask()})),o.promise},I.prototype.saveAsInternalWithName=function(e){var t=this,i=this.services.promiseFactory.defer();return e||i.reject(),this.confirmSaveAs(e,i),i.promise.finally((function(){t.hideSaveMask()})),i.promise},I.prototype.loadModelAndNotifyIfFailed=function(){var t=this,i=this.services.telemetryService.startActivity(this.scope,e.telemetry.EXLoadExplorationSchema),o=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(o).then((function(){i.resolve()})).catch((function(o){var r={errorCode:t.getErrorInfoCode(o)};t.rejectOpenExplorationTelemetryEvent(r),i.reject(r),o&&o.serviceError&&e.helpers.ReportUtility.shouldDisplayErrorAsNotificationBar(o.serviceError.errorCode)?t.services.eventBridge.publishBubbling(t.scope,c.showErrorNotification,{code:o.serviceError.errorCode,"pbi.error":{code:o.serviceError.errorCode,parameters:[],details:o.serviceError.errorDetails}}):e.explore.util.handleConceptualSchemaError(o,t.services.errorService,t.services.localizationService.get("ExplorationContainer_FailedToLoadModel"),"ExplorationContainer_FailedToLoadModel_DefaultDetails")}))},I.prototype.loadLinguisticSchemaAndNotifyIfFailed=function(e){var t=this;this.services.linguisticSchemaProxy.init(e.reportId,e.reportHasLinguisticSchema).catch((function(e){return t.showError(e,t.services.localizationService.get("ExplorationContainer_FailedToLoadReport"),"ExplorationContainer_FailedToLoadReport_DefaultDetails")}))},I.prototype.initializeExploration=function(t,i,o,r,a,n,c,l,u,v){return __awaiter(this,void 0,e.Promise,(function(){var h,g,m,f,y,w=this;return __generator(this,(function(C){switch(C.label){case 0:return this.warningBarNotified=!1,this.services.visualPlugin.removeAllCustomVisuals(),this.services.resourceGateService.setResourceFlag(),h=this.scope.viewModel.options,r?(this.scope.viewModel.showSpinner=!1,g={width:e.explore.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:e.explore.constants.ExploreCanvasConstants.DefaultCanvasHeight,dataSources:e.explore.contracts.createDataSourceArray(),sections:[{name:"ReportSection",displayName:void 0,visualContainers:[],filters:[],size:{displayOption:1,width:e.explore.constants.ExploreCanvasConstants.DefaultWidescreenWidth,height:e.explore.constants.ExploreCanvasConstants.DefaultWidescreenHeight}}]},b.fillDefaultSectionDisplayNames(g,this.services.localizationService),[4,this.addODataFilterFromQuery(g,l)]):[3,2];case 1:return C.sent(),this.scope.viewModel.exploration=S.convertExploration(g,this.services.formFactor.getCurrentLayout()),this.services.telemetryService.logEvent(e.telemetry.EXInitExploration,v,n&&n.directQueryMode===!0,n&&!_.isEmpty(n.onPremModelConnectionString)),this.setSectionStatus(0),this.setVisualTheme(),this.setDataSource(n),this.tryAddJsonFilters(g,u),this.services.explorationNavigation.loadExploration(g),h.disableLinguisticSchemaInitialization||this.loadLinguisticSchemaAndNotifyIfFailed(g),this.scope.$broadcast(d),this.setupConnection(n),this.loadModelAndNotifyIfFailed(),b.gotoSection(this.scope.viewModel,0,this.services.selection,this.services.explorationNavigation,this.services.formFactor.getCurrentLayout()),this.resolveOpenExplorationTelemetryEventWhenNoVisualContainers(),[3,3];case 2:this.scope.viewModel.showSpinner=!0,m=function(t){return __awaiter(w,void 0,e.Promise,(function(){var r,s,c,g,m,f,y=this;return __generator(this,(function(w){switch(w.label){case 0:for(h.disableLinguisticSchemaInitialization||this.loadLinguisticSchemaAndNotifyIfFailed(t),r=0,s=t.sections;r<s.length;r++)c=s[r],_.isNumber(this.scope.viewModel.options.overrideDisplayOption)?c.size.displayOption=this.scope.viewModel.options.overrideDisplayOption:null!=this.scope.viewModel.options.defaultDisplayOption&&0===c.size.displayOption&&(c.size.displayOption=this.scope.viewModel.options.defaultDisplayOption);return i?g=b.findSectionIndexForSectionName(t,i):o?g=b.findSectionIndexForSectionName(t,o):_.isNumber(t.activeSectionIndex)&&(g=t.activeSectionIndex),null==g&&(g=0),b.fillDefaultSectionDisplayNames(t,this.services.localizationService),[4,this.addODataFilterFromQuery(t,l)];case 1:return w.sent(),this.setSectionStatus(g),this.setVisualTheme(t.theme),m=this.services.explorationSerializer.serializeExploration(t),this.originalExploration=this.services.explorationSerializer.deserializeExploration(m,[],!0),this.scope.viewModel.exploration=S.convertExploration(t,this.services.formFactor.getCurrentLayout(),g),this.services.telemetryService.logEvent(e.telemetry.EXInitExploration,v,n&&n.directQueryMode===!0,n&&!_.isEmpty(n.onPremModelConnectionString)),this.setDataSource(n),this.tryAddJsonFilters(t,u),this.loadModelAndNotifyIfFailed(),this.changeToEditMode(a),this.scope.viewModel.showSpinner=!1,this.services.explorationNavigation.loadExploration(t),p.acquireTrustedVisuals(t,this.services.trustedVisual).then((function(e){return y.reloadTrustedVisuals(e)})),this.scope.$broadcast(d),b.gotoSection(this.scope.viewModel,g,this.services.selection,this.services.explorationNavigation,this.services.formFactor.getCurrentLayout()),this.resolveOpenExplorationTelemetryEventWhenNoVisualContainers(),this.setupConnection(n),this.services.rootScope.$emit(e.constants.openReportFinished,"",!1),this.services.navigation.inReportSubscriptionView()&&this.services.subscription.expandPaneForReportSubscription({currentSection:this.services.explorationNavigation.getCurrentSection(),report:this.services.explorationNavigation.getCurrentExploration().report,modelId:this.services.explorationNavigation.getCurrentExploration().dataSources[0].id,sections:this.services.explorationNavigation.getCurrentExploration().sections},this.services.navigation.currentSubscriptionGUID),f=this.getReportContract(),f&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack(f)&&(this.scope.viewModel.options.showTaskPane=!1,this.scope.viewModel.options.showVisualizationPane=!1),[2]}}))}))},this.exploration=c,c?this.initializeCustomTheme(c).then((function(e){return m(e)})):(f=this.services.telemetryService.startEvent(e.telemetry.EXFetchExploration,v),y={id:t,model:n},this.services.explorationProxy.get(y).then((function(e){return w.exploration=e,w.initializeCustomTheme(e)})).then((function(e){m(e),f.resolve()}),(function(t){w.showError(t,w.services.localizationService.get("ExplorationContainer_FailedToLoadReport"),"ExplorationContainer_FailedToLoadReport_DefaultDetails"),w.scope.viewModel.showSpinner=!1,w.services.rootScope.$emit(e.constants.openReportFinished,t&&t.error?t.error.message:"",!0),f.reject(),w.rejectOpenExplorationTelemetryEvent(s.getTelemetryErrorDetails(t&&t.error))}))),C.label=3;case 3:return[2]}}))}))},I.prototype.getErrorInfoCode=function(t){if(t){if(t.serviceError)return t.serviceError.errorCode?t.serviceError.errorCode:e.constants.modelFailedGenericServiceError;if(t.clientError)return t.clientError.code?t.clientError.code:e.constants.modelFailedGenericClientError}return e.constants.modelFailednoErrorInfo},I.prototype.setupConnection=function(e){if(!_.isEmpty(e.onPremModelConnectionString)){var t=this.services.dataSources.get();this.services.connectionSetupService.setup(t)}},I.prototype.onEnsureCustomViz=function(t,i){var o=this;if(this.services.telemetryService.logEvent(e.telemetry.EXEnableCustomViz,this.embedTypeDescription),this.services.resourceGateService.setResourceFlag(),this.services.resourcePackagesService.registerPackages(t),!i){var r=this.getVisualTypeUsageTable();t=_.filter(t,(function(e){return r[e.name]}))}this.services.visualPlugin.ensurePlugins(t).finally((function(){o.services.eventBridge.publishToChannel(e.explore.services.events.visualPluginsChanged);var i=_.chain(t).filter((function(e){return 0===e.type})).map((function(e){return e.name})).value();_.isEmpty(i)||o.services.rootScope.$emit(e.constants.reloadEmptyVisuals,{visualTypes:i})})),this.hideExplorationWarning("lastEnableCustomVizNotifyId"),this.hideExplorationWarning("lastErrorNotifyId")},I.prototype.getVisualTypeUsageTable=function(){for(var e=this.scope.viewModel.exploration.contract.sections,t={},i=0,o=e;i<o.length;i++)for(var r=o[i],a=r.visualContainers,n=0,s=a;n<s.length;n++){var c=s[n],l=c.config.singleVisual.visualType;t[l]=!0}return t},I.prototype.pauseQueriesChanged=function(e){var t=!this.scope.viewModeState.getConfig().pauseQueryExecution;this.scope.viewModeState.updateConfig((function(e){e.pauseQueryExecution=t})),t?this.services.dataProxy.stopCommunication(o.dsrDataReaderType):this.services.dataProxy.resumeCommunication(o.dsrDataReaderType),e.stopPropagation()},I.prototype.tryAddJsonFilters=function(t,i){var o=this;if(i&&_.isArray(i)){var r=this.services.dataSources.get();this.services.conceptualSchemaProxy.get(r).then((function(r){for(var a=e.explore.jsonFilter.createJSONFilterParser(o.services.promiseFactory),n=[],s=0,c=i;s<c.length;s++){var l=c[s],d=a.tryCreateFilterContainer(t,r,l);if(!d)return;n.push(d)}if(n&&n.length>0){t.filters=t.filters||[];for(var p=0,u=n;p<u.length;p++){var v=u[p];t.filters.push(v)}}}))}},I.prototype.addODataFilterFromQuery=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a,n,s,c,l,d,p,u;return __generator(this,(function(v){switch(v.label){case 0:return i?[4,this.loadODataFilterDependencies()]:[3,2];case 1:if(v.sent(),!e.explore.odata)return[2];if(o=void 0,r=this.services.featureSwitchService.featureSwitches,a=this.services.reportService.findReport&&this.services.reportService.findReport(t.reportId).contract,(r.multipleODataPredicates||r.usageMetricsEnabled&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack(a))&&(o={supportMultiplePredicates:!0}),n=e.explore.odata.createODataFilterParser(o),s=n.tryGetFilters(i),_.isEmpty(s))return[2];for(t.filters||(t.filters=[]),c=0,l=s;c<l.length;c++)d=l[c],t.filters.push(d);p=this.services.explorationCapabilities,u=p.getCapabilities(),u.visualContainerOptions.disableQueryCacheUpdates=!0,this.services.explorationCapabilities.setCapabilities(u),v.label=2;case 2:return[2]}}))}))},I.prototype.loadODataFilterDependencies=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return e=this.services.moduleLoader,[4,this.services.promiseFactory.all([e.require({javascript:"odataFilterParser"}),e.require({javascript:"odataExplore"})])];case 1:return t.sent(),[2]}}))}))},I.prototype.setSectionStatus=function(e){this.scope.viewModel.sectionStatus.currentSectionNumber=e},I.prototype.setVisualTheme=function(e){this.scope.themeName=e,this.services.colorPicker.setDataColors(this.services.themeService.getDataColors(e))},I.prototype.initializeCustomTheme=function(t){var i=this;if(t&&t.theme){var o=e.explore.services.loadRegisteredResourceAsDecodedString(this.services.promiseFactory,this.services.resourceLoader,t.resourcePackages,t.theme);return o.then((function(e){if(e){var o=v.tryParseJSON(e);o&&i.services.themeService.addCustomTheme(t.theme,o)}return t})).catch((function(){return t}))}return this.services.promiseFactory.resolve(t)},I.prototype.setDataSource=function(t){this.packageId=t.packageId;var i=this.scope.viewModel.exploration.contract,r=i.dataSources;if(!r.withId(t.id)){var a=e.explore.constants.DefaultSchemaName;if(r.push({type:o.dsrDataReaderType,id:t.id,name:a,dsr:{schemaName:a,vsName:t.vsName,dbName:t.dbName,modelId:t.id}}),this.services.featureSwitchService.featureSwitches.reportMeasures&&null!=i.id){var n=e.explore.constants.ExplorationSchemaName;r.push({type:e.explore.dataReaderPlugins.ExplorationDataReaderType,id:i.id,name:n,extends:a,exploration:{schemaName:n,extends:a,getModelExtensions:function(){return i.modelExtensions}}})}}this.services.dataSources.set(r)},I.prototype.showError=function(t,i,o){this.services.errorService.error(i,o,{requestId:t?t.requestId:void 0},!1,e.telemetry.ErrorSource.PowerBI)},I.prototype.clearExploration=function(){this.originalExploration=null,this.scope.viewModel.exploration=null,this.setSectionStatus(-1),this.services.dataSources.set(null),this.legacyReportExists=!1,this.services.eventBridge.publishToChannel(c.explorationUnloaded),this.scope.$broadcast(l)},I.prototype.showSaveMask=function(){this.scope.viewModel.showMask=!0},I.prototype.hideSaveMask=function(){this.scope.viewModel.showMask=!1},I.prototype.canWrite=function(e){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&e&&e.canWrite},I.prototype.canExplore=function(e,t){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&e&&e.contract&&(e.canExplore||this.canWrite(e))&&(t.getPermissions()&g.Write)===g.Write},I.prototype.canCopy=function(e){return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&e&&e.canCopy},I.prototype.isReportFromPbix=function(e){return e&&e.contract&&e.contract.isFromPbix},I.prototype.reloadTrustedVisuals=function(t){t&&t.length>0&&(this.services.visualPlugin.ensureTrustedVisualPlugins(t),this.services.eventBridge.publishToChannel(e.explore.services.events.visualPluginsChanged),this.services.rootScope.$emit(e.constants.reloadEmptyVisuals,{visualTypes:t.map((function(e){return e.name}))}))},I.prototype.resolveOpenExplorationTelemetryEventWhenNoVisualContainers=function(){this.scope.viewModel.exploration.exploreCanvas&&!_.isEmpty(this.scope.viewModel.exploration.exploreCanvas.visualContainers)||this.resolveOpenExplorationTelemetryEvent()},I.prototype.resolveOpenExplorationTelemetryEvent=function(){this.openExplorationTelemetryEvent&&(this.openExplorationTelemetryEvent.resolve(),this.openExplorationTelemetryEvent=null)},I.prototype.rejectOpenExplorationTelemetryEvent=function(e){this.openExplorationTelemetryEvent&&(this.openExplorationTelemetryEvent.reject(e),this.openExplorationTelemetryEvent=null)},I.prototype.setOpenExplorationTelemetryEvent=function(e){this.resolveOpenExplorationTelemetryEvent(),this.openExplorationTelemetryEvent=e},I.prototype.onLoadPowerViewReport=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a,n,s,c,l,d,p=this;return __generator(this,(function(u){switch(u.label){case 0:return[4,this.services.activeGroupId.initialGroupPermissionReadyPromise];case 1:return u.sent(),this.registerDirtyStateNavigationHandler(),this.services.rootScope.$emit(h,!1),i=t.instantiationMode!==e.common.contracts.reportServer.ReportInstantiationMode.None,t.report.objectId&&(o=this.services.groupService.activeGroupObjectId,r=t.report.contract.originalReportObjectId,i=!1,a=!1,this.services.reportService.findReportByGUID&&(n=this.services.reportService.findReportByGUID(t.report.objectId),a=n&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack(n.contract)),a||this.services.mostRecentlyUsedService.updateMRU(e.models.MRUArtifactType.Reports,t.report.objectId,t.report.displayName,t.report.getPermissions(),o,r,t.report.packageId)),this.clearExploration(),this.addKeyHandler(),s=t.instantiationMode!==e.common.contracts.reportServer.ReportInstantiationMode.None,this.reportId=i?void 0:t.report.id,this.packageId=t.model.packageId,this.lastLoadedReport=t.report,this.legacyReportExists=!e.helpers.ReportUtility.IsReportSavedAsExploration(t.report.contract),this.scope.viewModel.displayName=i?void 0:t.report.contract.displayName,this.scope.viewModel.canEdit=this.canExplore(t.report,t.model),this.scope.viewModel.canCopy=this.canCopy(t.report),this.scope.viewModel.canWrite=this.canWrite(t.report),this.services.viewModeState.setMode(s?1:0),this.scope.viewModel.taskPane.isPaneExpanded=s,this.scope.viewModel.visualizationPane.isPaneExpanded=s,this.scope.viewModel.isNavPaneCollapsed=!s,this.scope.viewModel.datasetModel=t.model,this.scope.viewModel.reportPermission=t.report.getPermissions(),this.scope.viewModel.isReportFromPbix=this.isReportFromPbix(t.report),c=this.scope.viewModel.datasetModel,l=this.services.packageService.findPackage(this.packageId),l&&(c.packagePublishStatus=l.publishOrRefreshStatus,c.contract.isPackageRefreshEnabled=l.contract.IsRefreshEnabled),d=this.scope.viewModel.options,d.visualContainerOptions.disablePin=!this.scope.viewModel.canEdit,this.services.viewModeState.updateConfig((function(e){e.supportsExportData=!d.disableExport&&p.services.featureSwitchService.featureSwitches.exportDataEnabled})),this.setOpenExplorationTelemetryEvent(t.openExplorationTelemetryEvent),[4,this.initializeExploration(t.report.id,t.reportPage,t.report.activeSlideId,i,s,t.report.model,t.exploration,t.additionalODataFilter,t.additionalJsonFilters,t.report.objectId)];case 2:return u.sent(),this.services.selection.clearSelection(),this.services.undoRedo.setHandler(e.explore.util.ExploreUndoRedoHandlerUtility.createUndoRedoHandler(this.scope.viewModel,this.services.timeout,this.services.selection,this.services.drillToDetails,this.services.formFactor,this.services.explorationSerializer,this.services.explorationNavigation,this.services.linguisticSchemaProxy,this.services.eventBridge,this.services.visualPlugin,this.services.registeredResourceReferences)),this.services.clipboard.setHandler(e.explore.util.ExploreClipboardHandlerUtility.createClipboardHandler(this.scope.viewModel,this.services.explorationSerializer,this.services.selection,this.services.visualAuthoring,this.services.visualPlugin,this.services.filterGenerator,this.services.formFactor,this.services.visualStylePresetService)),this.notifyIfModelRefreshDisabledBySelectiveRefresh(),[2]}}))}))},I.prototype.showErrorNotification=function(e,t){if(t.code){var i=this.scope.viewModel.datasetModel;this.showErrorNotificationWithModel(t,i)}e.stopPropagation()},I.prototype.showErrorNotificationWithModel=function(e,t,i){var o=this;t.contract.creatorUser?this.notifyError(e,t,i):this.services.modelHttpService.getModel(t.id,t.packageId,this.services.telemetryService.root).then((function(r){r.data.creatorUser&&(t.contract.creatorUser=r.data.creatorUser,o.notifyError(e,t,i))}))},I.prototype.notifyError=function(e,t,i){var o=this;i||(i=function(){o.refresh()}),this.requiresGatewayInfo(e.code)?this.services.gatewaysMetadataService.getModelDataSources(t.id).then((function(r){var a=o.services.selectGatewayService.getSelectedGateway(r);o.notify(e,t,a,i)}),(function(r){o.notify(e,t,null,i)})):this.notify(e,t,null,i)},I.prototype.notify=function(e,t,i,o){var r=this.getErrorNotificationParameter(e,t,i,o);if(r){var a={notificationName:"lastErrorNotifyId",notificationId:this.services.notificationBar.notify(r)};this.addNotification(a)}},I.prototype.requiresGatewayInfo=function(t){return t===e.DM_GWPipeline_Client_GatewayUnreachable},I.prototype.getErrorNotificationParameter=function(t,i,o,r){var a=this,n=t.code,s=i.contract.creatorUser,c=s.emailAddress;c.match(e.common.controllers.EmailsList.emailValidator)||(c=s.AlternateEmailAddress);var l,d,p=c===e.session.UserInfoUtils.getUPN();switch(n){case e.DMTS_NoGatewayWithAllDatasourcesToBindError:var u=this.getServerName(t),v=this.getDatabaseName(t);l=this.services.localizationService.format("ExplorationContainer_Notification_DMTS_NoGatewayWithAllDatasourcesToBindError_Message",[u,v]),d={displayText:this.services.localizationService.get("ExplorationContainer_Notification_DMTS_NoGatewayWithAllDatasourcesToBindError_ActionText"),urlString:e.models.learnMoreAboutEnterpriseGatewaysHelpLink};break;case e.DMTS_MultipleGatewaysWithAllDatasourcesToBindError:l=p?this.services.localizationService.get("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_Message"):this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[s.givenName]),d=p?{displayText:this.services.localizationService.get("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_ActionText"),action:function(){a.services.selectGatewayService.bindModelToGateway(i.id,(function(){r(),a.hideExplorationWarning("lastErrorNotifyId")}),(function(){a.services.errorService.error(a.services.localizationService.get("ExplorationContainer_FailedToBindToGatewayMessage"),"ExplorationContainer_FailedToBindToGateway")}),(function(){}))}}:{displayText:this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_ActionText",[s.givenName]),urlString:"mailto:"+c};break;case e.DMTS_DatasourceHasNoCredentialError:l=p?this.services.localizationService.get("ExplorationContainer_Notification_CredentialsRequired_Message"):this.services.localizationService.get("ExplorationContainer_Notification_CredentialsRequired_NotOwner_Message"),d=p?{displayText:this.services.localizationService.get("ExplorationContainer_Notification_CredentialsRequired_ActionText"),action:function(){a.services.navigation.showSettingsSlider("datasets",i.dbName)}}:{displayText:this.services.localizationService.get("ExplorationContainer_Notification_CredentialsRequired_NotOwner_ActionText"),urlString:"mailto:"+c};break;case e.DM_GWPipeline_Client_GatewayUnreachable:if(p){var h=this.getContactInfo(o);l=h?this.services.localizationService.format("ExplorationContainer_Notification_DM_GWPipeline_Client_GatewayUnreachable_WithContactInfo",[h]):this.services.localizationService.get("ExplorationContainer_Notification_DM_GWPipeline_Client_GatewayUnreachable")}else l=this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[s.givenName]);d=p?{displayText:this.services.localizationService.get("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_ActionText"),action:function(){a.services.selectGatewayService.bindModelToGateway(i.id,(function(){r(),a.hideExplorationWarning("lastErrorNotifyId")}),(function(){a.services.errorService.error(a.services.localizationService.get("ExplorationContainer_FailedToBindToGatewayMessage"),"ExplorationContainer_FailedToBindToGateway")}),(function(){}))}}:{displayText:this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_ActionText",[s.givenName]),urlString:"mailto:"+c};break;case e.DM_GWPipeline_Gateway_DataSourceConnectionError:l=p?this.services.localizationService.get("ExplorationContainer_Notification_DMTS_DatasourceConnectionError_Message"):this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[s.givenName]),d=null;break;case e.RS_CannotRetrieveModel:l=this.services.localizationService.get("DsrError_CanNotRetrieveModelMessage"),d=null;break;case e.RS_AccessDeniedDueToRLSGroup:l=this.services.localizationService.get("DsrError_NoPermissionDueToRLSGroupMessage"),d=null;break;case e.RS_AccessDenied:l=this.services.localizationService.get("DsrError_NoPermissionToViewMessage"),d=null;break;case e.DMTS_UserNotFoundInADGraphError:l=this.services.localizationService.format("ExplorationContainer_Notification_DMTS_UserNotFoundInADGraphError_Message",[s.givenName]),d=null;break;case e.DMTS_UserLostPermissionToDatasourceError:case e.DM_GWPipeline_Gateway_ImpersonationError:l=p?this.services.localizationService.get("ExplorationContainer_Notification_DMTS_UserLostPermissionToDatasourceError_Message"):this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[s.givenName]),d=p?{displayText:this.services.localizationService.get("ExplorationContainer_Notification_DMTS_UserLostPermissionToDatasourceError_ActionText"),action:function(){a.services.selectGatewayService.bindModelToGateway(i.id,(function(){a.refresh(),a.hideExplorationWarning("lastErrorNotifyId")}),(function(){a.services.errorService.error(a.services.localizationService.get("ExplorationContainer_FailedToBindToGatewayMessage"),"ExplorationContainer_FailedToBindToGateway")}),(function(){}))}}:{displayText:this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_ActionText",[s.givenName]),urlString:"mailto:"+c};break;case e.DM_GWPipeline_Gateway_DataSourceAccessError:l=p?this.services.localizationService.get("ExplorationContainer_Notification_DMTS_DatasourceAccessError_Message"):this.services.localizationService.format("ExplorationContainer_Notification_DMTS_MultipleGatewaysWithAllDatasourcesToBindError_NotOwner_Message",[s.givenName]),d=null;break;case e.DM_GWPipeline_Gateway_InvalidMashupConnectionString:case e.DM_GWPipeline_Gateway_DatabaseLoginError:case e.DM_GWPipeline_Gateway_SqlTimeoutException:case e.DM_GWPipeline_Gateway_AdomdTimeoutException:case e.DM_GWPipeline_Gateway_InvalidObjectNameException:case e.DM_GWPipeline_Gateway_ConnectionBrokenException:case e.DM_GWPipeline_Gateway_MemoryError:case e.DM_GWPipeline_Gateway_MissingStructureError:case e.DM_GWPipeline_Gateway_UnprocessedStructureError:case e.DM_GWPipeline_Gateway_ModelLoadError:case e.DM_GWPipeline_Gateway_CancellationError:case e.DM_GWPipeline_Gateway_QueryExecutionError:case e.DM_GWPipeline_Gateway_RecalculationRequiredError:case e.DM_GWPipeline_Gateway_AdomdConnectError:case e.DM_GWPipeline_Gateway_MashupDataAccessError:default:l=this.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+n),d=null}if(l)return{message:l,notificationType:e.common.NotificationBarType.Error,secondaryLink:d}},I.prototype.getContactInfo=function(t){if(t){var i=e.settings.models.GatewayModelConverter.getGatewayAnnotation(t);if(i){var o=i.gatewayContactInformation,r="";if(o)for(var a=0,n=0,s=o;n<s.length;n++){var c=s[n];r+=c,a<o.length-1&&(r+="; "),a++}return r}}return""},I.prototype.getServerName=function(e){if(e["pbi.error"]){var t=e["pbi.error"].details;if(t&&t.length>0)return t[0].detail.value}return""},I.prototype.getDatabaseName=function(e){if(e["pbi.error"]){var t=e["pbi.error"].details;if(t&&t.length>1)return t[1].detail.value}return""},I.prototype.sendTelemetryForCapabilities=function(t){t.featureUsage&&(t.featureUsage.hasVisualRelationships&&this.services.telemetryService.logEvent(e.telemetry.EXSavedExplorationWithVisualRelationships),t.featureUsage.hasShowAllEnabled&&this.services.telemetryService.logEvent(e.telemetry.EXSavedExplorationWithShowAllEnabled))},I.prototype.onRefreshReportData=function(){var t=n.dataReaderDataSources(n.queried(this.services.dataSources.get(),null));t&&(this.services.dataProxy.clearCache(o.dsrDataReaderType,t),this.services.eventBridge.publishToChannel(e.explore.services.events.visualContainerChanged,{affectContainer:function(){return!0}}))},I.prototype.getReportContract=function(){return this.scope&&this.scope.viewModel&&this.scope.viewModel.exploration&&this.scope.viewModel.exploration.contract&&this.scope.viewModel.exploration.contract.report},I})(e.common.controllers.ExplorationContainerBaseController);t.ExplorationContainerController=I})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.explore.services.createVisualQueryGenerator,o=e.explore.viewModels,r=e.common.NotificationToastType,a=e.common.contracts.Permissions,n=e.explore.ScopeUtils,s=e.explore.services,c=e.dataServices.models.TileFactory,l=e.dataServices.contracts.TileType,d=(function(){function t(t,r){var a=this;this.scope=t,this.services=r;var s=this.initializeSection("InFocusSection","InFocusSection");t.viewModel=e.models.inFocusViewModelFactory.createInFocus(s,r.filterGenerator,this.services.formFactor.getCurrentLayout()),t.hide=function(){return a.exitAndHide()},t.updateTile=function(e){return a.updateTile(e)},t.openReport=function(){return a.openReport()},n.defineDataSourcesOnScopeLegacy(this.scope,this.services.dataSources),this.setDataSources();var c=this.services.featureSwitchService;t.pinVisual=function(){return a.pinVisual()},t.getRelatedInsights=function(){return a.getRelatedInsights(e.telemetry.InsightEntryPoint.InFocusMode)},t.logInsightFeedback=function(e){return a.logInsightFeedback(e)},t.qrCode=function(){return a.qrCode()},t.viewModeState=this.services.viewModeState,t.editVisual=function(){return a.toggleViewMode(!1)},t.saveVisual=function(){return a.updateInFocusTile()},t.showRefreshErrorDetails=function(){return a.showRefreshErrorDetails()},t.inFocusEditEnabled=c.featureSwitches.inFocusEditEnabled,t.inFocusMenuItems=e.models.inFocusViewModelFactory.createInFocusMenuItems(this.services.localizationService,this.scope.canExport),t.inFocusMenuItemSelected=function(e){return a.onInFocusMenuItemSelected(e)},t.showPreviousVisual=function(){return a.showPreviousVisual()};var l=o.createFieldListViewModelFactory(o.createFieldListMenuItemFactory(this.services.localizationService,c),o.createFieldListPropertyTemplateGenerator(),this.services.localizationService,c);this.scope.fieldListConfig={viewModelFactory:l,alwaysHasActiveItem:!0},this.sortService=e.explore.services.createSortService(this.services.displayNameService,c,this.services.visualPlugin),this.dataProxy=this.services.singleExecutableDataProxyFactory.create(),this.visualQueryGenerator=i({dataReaders:this.services.dataReaderProvider,displayNameService:this.services.displayNameService,plugin:this.services.visualPlugin,pluginOps:this.services.visualPluginOps,sortService:this.sortService,featureSwitchService:c,aggrOps:this.services.aggrOps,filterGenerator:this.services.filterGenerator,transformPluginService:e.data.transforms.createTransformPluginService(),telemetryService:this.services.telemetryService}),this.services.undoRedo.setHandler({rollback:function(){},takeSnapshot:function(){return null}});var d=this.scope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,i,o,r){return a.handleStateChangeSuccess(e,t,i,o,r)})),p=this.services.rootScope.$on(e.constants.openInFocusTileActionName,(function(e,t){return a.onOpenTile(e,t)})),u=this.services.rootScope.$on(e.constants.openInFocusWorkbookTileActionName,(function(e,t){return a.onOpenWorkbookTile(e,t)})),v=this.services.rootScope.$on(e.constants.openInFocusRealTimeTileActionName,(function(e,t){return a.onOpenRealTimeTile(e,t)})),h=this.scope.$on(e.insights.constants.insightSelectedEvent,(function(e,t){return a.onInsightSelected(e,t)})),g=this.scope.$on(e.insights.constants.insightClosePaneEvent,(function(e){return a.onInsightClosePane()})),m=this.scope.$on(e.insights.constants.insightsOnSelectionEvent,(function(t){return a.getRelatedInsights(e.telemetry.InsightEntryPoint.InFocusMode)}));this.scope.$on("$destroy",(function(){d(),p(),u(),h(),g(),m(),v()})),t.viewModeState.setMode(0),this.visualAuthoringCore=e.explore.services.createVisualAuthoringCore(this.services.visualPlugin,this.services.geoTaggingAnalyzerService,this.services.aggrOps,c),this.services.pinVisual.setHandler({pinVisual:function(e){a.pinVisualHandler(e)}})}return t.createOptions=function(){return{
scopedServiceRoot:!0,scopedDependencies:["dataSources","eventBridge","filterGenerator","viewModeState","undoRedo","selection","pinVisual","visualPlugin","visualPluginOps","explorationNavigation","explorationCapabilities","exportData","hostFiltersService","formFactor"],additionalServices:["aggrOps","conceptualSchemaProxy","inFocusService","dashboardHttpService","dashboardDataService","singleExecutableDataProxyFactory","dataReaderProvider","modelMerger","displayNameService","dashboardService","featureSwitchService","geoTaggingAnalyzerService","localizationService","modelService","packageService","notificationToast","reportService","explorationProxy","modelConverter","telemetryService","errorService","qrCodeService","groupService","insightsService","navigation","$timeout","resourcePackagesService","navigationHelper"]}},t.prototype.toggleViewMode=function(t){var i=this.scope.viewModel;if(t)this.scope.$emit(e.constants.inFocusExitEvent),i.editVisualText=this.services.localizationService.get("InFocus_Edit"),i.taskPane.isPaneExpanded=!1,i.visualizationPane.isPaneExpanded=!1,this.services.viewModeState.setMode(0);else{var o=this.services.viewModeState.getMode();this.services.viewModeState.setMode(0===o?1:0),1===this.services.viewModeState.getMode()?(i.taskPane.isPaneExpanded=!0,i.visualizationPane.isPaneExpanded=!0,i.editVisualText=this.services.localizationService.get("InFocus_Exit_Edit")):(i.editVisualText=this.services.localizationService.get("InFocus_Edit"),i.taskPane.isPaneExpanded=!1,i.visualizationPane.isPaneExpanded=!1)}},t.prototype.updateInFocusTile=function(){var t=this,i=this.scope.viewModel.canvas.visual.visualContainer,o=this.services.dataSources.get(),r=i.readOnlyState.visual.type,a=i.themeName;this.services.conceptualSchemaProxy.get(o).then((function(n){var c,l=r===e.visuals.plugins.image.name?e.common.contracts.TileLayoutType.Full:e.common.contracts.TileLayoutType.Default,d=i.hostServices.getFilters(t.services.filterGenerator,n),p=i.contract.config.singleVisual,u=t.visualQueryGenerator.execute({config:p,dataSources:o,schema:n,additionalFilters:d});u?t.dataProxy.execute(u.options).then((function(e){c=t.services.pinVisual.getPinData(i.contract,l,o,d,e,u,a,n,s.getRegisteredResourcePackage(t.services.resourcePackagesService.getAllPackages())),t.updateTileInServer(c)}),(function(){})):(c=t.services.pinVisual.getPinData(i.contract,l,o,null,null,null,a,null,s.getRegisteredResourcePackage(t.services.resourcePackagesService.getAllPackages())),t.updateTileInServer(c))}))},t.prototype.updateTileInServer=function(t){var i=this;this.tileContractCurrent=c.createTileForPinData(this.services.visualPlugin,t,null);var o=this.services.telemetryService.startEvent(e.telemetry.InFocusModeSaveTileProperties,this.tileContractCurrent.config!==this.tileContractOriginal.config||this.tileContractCurrent.query!==this.tileContractOriginal.query);this.services.dashboardHttpService.updateTile(this.services.inFocusService.inFocusTile.contract,this.tileContractCurrent,o.event).then((function(){i.updateTileInDashboard()}),(function(e){i.updateTileFailed()}))},t.prototype.updateTileFailed=function(){this.notifyForSave("InFocus_UpdateTile_Error",r.Error,"InFocus_UpdateTile_Error_DefaultDetails")},t.prototype.updateTileInDashboard=function(){var e=this.services.inFocusService.inFocusTile.contract;e.config=this.tileContractCurrent.config,e.query=this.tileContractCurrent.query,e.tileData=this.tileContractCurrent.tileData,e.tileDataSet=this.tileContractCurrent.tileDataSet,e.$config=null,this.services.modelMerger.mergeTile(this.services.inFocusService.inFocusTile,e,this.services.modelService.getModelContracts(),this.services.reportService.getReportContracts()),this.notifyForSave("InFocus_UpdateTile_Success",r.Success,"InFocus_UpdateTile_Success_DefaultDetails")},t.prototype.notifyForSave=function(e,t,i){var o=this;this.services.localizationService.ensureLocalization((function(){o.services.notificationToast.notify({title:o.services.localizationService.get(e),message:o.services.localizationService.get(i),notificationType:t})}))},t.prototype.onInsightClosePane=function(){this.scope.viewModel.showInsightsPane=!1},t.prototype.onInsightSelected=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(o){return i.rerunInsights||(this.scope.viewModel.showPreviousVisualButton=!0),t={entryPoint:i.rerunInsights?e.telemetry.InsightEntryPoint.InsightsPaneTile:e.telemetry.InsightEntryPoint.InFocusMode,insightContainerModel:i.insightContainerModel,showInsightsEvent:i.showInsightsEvent,canPin:this.scope.viewModel.openInsightArgs?this.scope.viewModel.openInsightArgs.canPin:this.scope.canEdit},this.services.rootScope.$emit(e.insights.constants.viewInsightInFocus,i.pinData,t,i.rerunInsights),[2]}))}))},t.prototype.showPreviousVisual=function(){this.services.inFocusService.inFocusTile=this.originalTile,this.generateVisual(this.originalViewTileArgs),this.scope.viewModel.showPreviousVisualButton=!1,this.scope.$broadcast(e.insights.constants.clearInsightSelectionEvent)},t.prototype.onOpenTile=function(t,i){var o=this;t.stopPropagation(),this.currentViewTileArgs=i,i.openInsightArgs&&i.openInsightArgs.entryPoint===e.telemetry.InsightEntryPoint.InFocusMode?this.scope.$applyAsync((function(){o.scope.showInFocusMode=!0,o.generateVisual(i)})):this.scope.performTransitionAnimation(this.services.inFocusService.inFocusTile.id).then((function(){o.scope.$applyAsync((function(){o.scope.showInFocusMode=!0,o.generateVisual(i)}))}))},t.prototype.onOpenWorkbookTile=function(t,i){t.stopPropagation(),this.scope.relatedInsightsEnabled=!1;var o=i.workbook,r=this.services.inFocusService.inFocusTile;this.services.telemetryService.logEvent(e.telemetry.DashboardInFocusWorkbook,r.contract.id,o.contract.workbookId,o.contract.packageId),this.setExportableState(r),this.scope.showInFocusMode=!0,this.scope.viewModel.inFocusTile=r,this.scope.viewModel.workbook=o,this.scope.viewModel.displayText=o.displayText,this.scope.viewModel.subDisplayText=o.subDisplayText;var a=this.services.dashboardDataService.activeDashboard;this.scope.viewModel.dashboardText=this.services.localizationService.format("InFocus_ToDashboard",[a.displayName])},t.prototype.onOpenRealTimeTile=function(t,i){var o=this;t.stopPropagation(),this.scope.relatedInsightsEnabled=!1;var r=this.services.modelConverter.convertTile(i.contract);this.scope.viewModel.realTime=r.realTime,this.setExportableState(r),this.scope.viewModel.inFocusTile=r,this.scope.viewModel.displayText=r.displayText,this.scope.viewModel.subDisplayText=r.subDisplayText;var a=this.services.dashboardDataService.activeDashboard;this.scope.viewModel.dashboardText=this.services.localizationService.format("InFocus_ToDashboard",[a.displayName]),this.scope.performTransitionAnimation(this.services.inFocusService.inFocusTile.id).then((function(){o.scope.showInFocusMode=!0,o.scope.$applyAsync((function(){o.scope.$emit(e.constants.inFocusEnterEvent),o.scope.clearTransitionAnimation()}))}))},t.prototype.generateVisual=function(t){var i=this,o=this.scope.viewModel;o.inFocusTile=this.services.inFocusService.inFocusTile,this.setDataSources(o.inFocusTile),this.updateTile(o.inFocusTile,t.openInsightArgs),this.tileContractOriginal=o.inFocusTile.contract;var r=this.services.telemetryService.startEvent(e.telemetry.DashboardInFocusModeSelected,l[this.services.inFocusService.inFocusTile.composite.visual.type]);this.scope.openInFocusEvent||(this.scope.openInFocusEvent=r.event),this.scope.clearTransitionAnimation().then((function(){i.services.visualPlugin.loadPluginByNameIfAny(i.services.inFocusService.inFocusTile.composite.visual.type),i.setVisualContainerProperties(t,r)}))},t.prototype.setVisualContainerProperties=function(t,i){var o=this,r=this.scope,a=r.viewModel,n=a.inFocusTile.config.visualContainer,s=n.$visualContainer,c=a.canvas,l=c.exploration.exploreCanvas,d=this.initializeSection("fakeSection","fakeSection");l.contract=d,l.preventSelectionClearing=!0,r.themeName=n.themeName,s.layouts=jsCommon.ArrayExtensions.extendWithId([{id:0,position:{x:0,y:0,width:d.size.width,height:d.size.height}}]);var p=e.explore.viewModels.ViewModelFactory.convertVisualContainer(c.exploration.contract,c.exploration.sections[0].contract,s,0);if(!this.validateDrillableVisual(p)){var u={errorCode:"drillable visual in inFocus mode isn't correctly generated"};i.reject(u),i=null,r.inFocusDrillableError=!0,this.setErrorMessage()}p.disableResize=!0;var v=this.tileContractOriginal.tileDataSet;e.data.dsr.containsRestartToken(v)||(p.dataViewSource=v),p.contract.config.singleVisual.title={show:!1};var h=this.services.modelConverter.convertModel(a);e.explore.services.selectionUtils.selectVisualContainer(p.contract,this.services.selection),c.visual.visualContainer=p,c.visual.model=h,l.visualContainers[0]=p,l.visualContainers[0].options=this.services.explorationCapabilities.getCapabilities().visualContainerOptions;var g={showAppBar:!0,showTaskPane:!0,showVisualizationPane:!0,showNavContentPane:!0,visualContainerOptions:{showMenu:!1,showPin:!1,showContextMenu:!1,disablePin:!0,hideHeader:!0},showBackButtonOnAppBar:!1};this.services.explorationCapabilities.setCapabilities(g),a.showVisualEnabled=!0,r.$emit(e.constants.inFocusEnterEvent),t.runScopedInsights&&(this.services.$timeout((function(){var i=e.telemetry.InsightEntryPoint.DashboardTile;t.openInsightArgs&&t.openInsightArgs.entryPoint&&(i=t.openInsightArgs.entryPoint),o.getRelatedInsights(i)})),t.runScopedInsights=!1),null!=i&&i.resolve()},t.prototype.setErrorMessage=function(){var e=this.services.localizationService;this.scope.errorMessageConfig={canEdit:this.scope.canEdit,mode:!0,titleShared:e.get("InFocusEMHeader"),titleNonShared:e.get("InFocusEMHeader"),contentShared:e.get("InFocusEMContentShared"),contentNonShared:e.get("InFocusEMContentNonShared"),contact:e.get("InFocusEMContentSharedContact")}},t.prototype.validateDrillableVisual=function(t){var i=this.services.visualPlugin.capabilities(t.contract.config.singleVisual.visualType),o=e.explore.util.DrillUtils.getDrillableRoles(i);if(o.length>0)for(var r=t.contract.config.singleVisual.query.projections,a=0,n=o;a<n.length;a++){var s=n[a],c=r[s];if(!_.isEmpty(c)&&c.all().length>1&&_.isEmpty(c.activeProjectionRefs))return!1}return!0},t.prototype.setDataSources=function(t){var i=[];if(t){var o=e.explore.constants.DefaultSchemaName,r={type:e.common.constants.dsrDataReaderType,id:t.contract.modelId,name:e.explore.constants.DefaultSchemaName,dsr:{schemaName:e.explore.constants.DefaultSchemaName,vsName:t.vsName,dbName:t.dbName,modelId:t.contract.modelId}};if(i.push(r),this.services.featureSwitchService.featureSwitches.reportMeasures){var a=t.contract.$config.visualContainer.$modelExtensions,n=e.explore.constants.ExplorationSchemaName;i.push({type:e.explore.dataReaderPlugins.ExplorationDataReaderType,id:t.contract.id,name:n,extends:o,exploration:{schemaName:n,extends:o,getModelExtensions:function(){return a}}})}}var s=e.explore.contracts.createDataSourceArray(i);this.services.dataSources.set(s)},t.prototype.initializeSection=function(e,i){var o={name:e,displayName:i,size:t.getDefaultSize(),visualContainers:[],filters:[]};return this.services.explorationNavigation.goto(o,!1),o},t.getDefaultSize=function(){return{displayOption:0,width:e.explore.constants.ExploreCanvasConstants.DefaultCanvasWidth,height:e.explore.constants.ExploreCanvasConstants.DefaultCanvasHeight}},t.prototype.exitAndHide=function(){var e=this.services,t=e.dashboardDataService.activeDashboard;t&&!e.navigation.inInsightsView()&&e.navigationHelper.navigateToDashboard(t),this.hide()},t.prototype.hide=function(){this.scope.showInFocusMode=!1,this.scope.viewModel.showInsightsPane=!1,this.scope.viewModel.showPreviousVisualButton=!1,this.scope.viewModel.inFocusTile=null,this.scope.viewModel.canvas.visual.visualContainer=null,this.scope.viewModel.canvas.exploration&&(this.scope.viewModel.canvas.exploration.exploreCanvas.visualContainers=jsCommon.ArrayExtensions.createWithId()),this.toggleViewMode(!0),this.scope.inFocusDrillableError=!1,this.services.inFocusService.exit()},t.prototype.updateTile=function(t,i){this.services.filterGenerator.clearCrossHighlight(this.scope.viewModel.canvas.exploration.contract.sections[0]);var o=this.scope.viewModel;if(o.inFocusTile=t,o.openInsightArgs=i,o.inFocusTile){o.displayText=t.getDisplayText(),o.subDisplayText=t.getSubDisplayText();var r=o.inFocusTile;o.source=null!=r.report?this.services.localizationService.format("InFocus_SourceReport",[r.report.displayName]):this.services.localizationService.format("InFocus_SourceQna",[r.utterance]);var n=this.services.dashboardDataService.activeDashboard;this.setExportableState(r),i?i.entryPoint!==e.telemetry.InsightEntryPoint.InFocusMode&&(this.scope.viewModel.dashboardText=this.services.localizationService.format("InFocus_ToDashboard",[r.contractsModel.displayName])):this.scope.viewModel.dashboardText=null!=n?this.services.localizationService.format("InFocus_ToDashboard",[n.displayName]):this.services.localizationService.get("InFocus_DefaultDashboard"),o.pinVisualText=this.services.localizationService.get("PinVisual_ToolTip"),o.editVisualText=this.services.localizationService.get("InFocus_Edit"),o.saveVisualText=this.services.localizationService.get("ReportAppBar_SaveToDashboard"),o.getRelatedInsightsText=this.services.localizationService.get("Insights_GetRelatedInsights");var s=r.contract;r.setDatasetModelAndPackageInfo(this.services.modelService.findModel(s.modelId,s.packageId),this.services.packageService.findPackage(s.packageId)),this.scope.relatedInsightsEnabled=r.datasetModel.contract.insightsSupported&&!r.datasetModel.isHidden&&(r.datasetModel.getPermissions()&a.Read)===a.Read&&!r.workbook}},t.prototype.handleStateChangeSuccess=function(e,t,i,o,r){var a=this.services.navigation.inInFocusView(),n=this.services.navigation.inInFocusInsightsView(),s=!a&&!n;s&&this.hide()},t.prototype.openReport=function(){this.services.rootScope.$emit(e.constants.openTileEventName,this.services.inFocusService.inFocusTile)},t.prototype.getRelatedInsights=function(t){this.originalTile=this.scope.viewModel.inFocusTile,this.originalViewTileArgs=this.currentViewTileArgs,this.scope.viewModel.showPreviousVisualButton=!1,this.services.insightsService.setScopedInsightsSource(t),this.scope.viewModel.showInsightsPane?this.scope.$broadcast(e.insights.constants.getRelatedInsightsEvent):this.scope.viewModel.showInsightsPane=!0},t.prototype.logInsightFeedback=function(t){var i=this.scope.viewModel.openInsightArgs.showInsightsEvent,o=this.scope.viewModel.canvas.visual.visualContainer.contract;if(i&&o){var a=e.insights.utils.InsightsUtils,n=a.getFiltersFromQuery(o),s=a.getFiltersFromHighlights(o.config.singleVisual.objects),c=a.getNumberOfColumns(o);this.services.telemetryService.logChildEvent(i,e.telemetry.InsightsFeedback,t?e.telemetry.InsightFeedback.Yes:e.telemetry.InsightFeedback.No,n.length,s.length,c,this.scope.viewModel.openInsightArgs.insightContainerModel.source),this.services.notificationToast.notify({notificationType:r.Success,title:this.services.localizationService.get("Insights_FeedbackToastTitle"),message:this.services.localizationService.get("Insights_FeedbackToastMessage")})}},t.prototype.pinVisual=function(){var t=this,i=this.scope.viewModel,o=this.services.dataSources.get(),r=i.canvas.visual.visualContainer,a=r.contract.config.singleVisual.visualType;if(this.services.conceptualSchemaProxy.get(o).then((function(e){var i=r.hostServices.getFilters(t.services.filterGenerator,e);t.services.pinVisual.pinVisualContainer(o,r.contract,i,r.themeName,s.getRegisteredResourcePackage(t.services.resourcePackagesService.getAllPackages()))})),i.openInsightArgs){var n=i.openInsightArgs.insightContainerModel,c=e.insights.contracts.InsightType[n.contract.insight.Type];this.services.telemetryService.logChildEvent(i.openInsightArgs.showInsightsEvent,e.telemetry.InsightsPinInsight,n.contract.id,a,c,e.telemetry.PinInsightEntryPoint.InFocusMode,i.openInsightArgs.insightContainerModel.source,i.openInsightArgs.entryPoint===e.telemetry.InsightEntryPoint.InFocusMode?n.contract.relevance.Score:null)}},t.prototype.pinVisualHandler=function(t){if(t){var i=this.scope.viewModel,o=i.inFocusTile.contract;t.reportId=o.reportId,this.scope.dataSources.length>0&&(t.modelId=this.scope.dataSources[0].id,t.packageId=o.packageId);var r=this.scope.viewModel.inFocusTile;t.action=r.action,r.utterance&&(t.utterance=r.utterance),this.services.rootScope.$emit(e.explore.constants.pinVisualContainerEventName,t)}},t.prototype.showRefreshErrorDetails=function(){var e=this;this.services.localizationService.ensureLocalization((function(){e.services.errorService.error(e.services.localizationService.get("TileEditor_InFocusDatasetRefreshErrorMessage"),"InFocus_DatasetRefreshError",{title:e.services.localizationService.get("TileEditor_InFocusDatasetRefreshErrorTitle")})}))},t.prototype.onInFocusMenuItemSelected=function(e){switch(e.action){case 0:this.qrCode();break;case 1:this.exportData()}},t.prototype.qrCode=function(){this.services.qrCodeService.showDialogForTile(this.scope.$parent,this.services.inFocusService.inFocusTile,this.services.dashboardDataService.activeDashboard.contract,this.services.groupService.activeGroupObjectId,this.services.navigation.currentAppGUID)},t.prototype.exportData=function(){var e=this.scope.viewModel;this.services.exportData.exportTileDataToCsv(e.inFocusTile)},t.prototype.setExportableState=function(t){var i=!1,o=this.services.exportData;o&&(i=o.canExportTileData(t)),this.scope.canExport=i,this.scope.inFocusMenuItems=e.models.inFocusViewModelFactory.createInFocusMenuItems(this.services.localizationService,i)},t})();t.InFocusController=d})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i;var r=t.$watch((function(){return o.services.modelService.models.length}),(function(){o.services.modelService.models.length>0&&(r(),o.updateViewModel())})),a=this.scope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e){e.stopPropagation(),o.updateViewModel()}));this.scope.$on("$destroy",(function(){a()}))}return t.createOptions=function(){return{additionalServices:["modelService","navigation","telemetryService"]}},t.prototype.updateViewModel=function(){var t=e.telemetry.InsightEntryPoint.DirectNavigation;if(this.services.navigation.insightsSource){switch(this.services.navigation.insightsSource){case e.insights.constants.insightsSourceDesktop:t=e.telemetry.InsightEntryPoint.Desktop;break;case e.insights.constants.insightsSourceNavigationPane:t=e.telemetry.InsightEntryPoint.NavigationPane;break;case e.insights.constants.insightsSourceToast:t=e.telemetry.InsightEntryPoint.Notification}this.services.navigation.resetInsightsSource()}var i=this.services.modelService.findModelByDBName(this.services.navigation.insightsDataGUID).contract,o=e.insights.models.ViewModelFactory.createInsightCanvasModel({model:i});o.entryPoint=t,this.scope.viewModel=new e.models.insights.InsightsModel,this.scope.viewModel.insightsCanvasModel=o},t})();t.InsightsController=i})(i=t.insights||(t.insights={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.AppUtils,o=e.common.models.CollapsiblePaneExpandedWidth,r=e.common.constants,a=e.dataServices.constants,n=e.services.FullScreenFitStyle,s=e.common.contracts.Permissions,c=e.common.contracts.PinData,l=e.telemetry.PinTileSource,d=e.common.constants.TaskPaneCollapsiblePaneMode,p=e.common.constants.TaskPaneSlider,u=e.dataServices.models.TileFactory,v=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,t.asyncFeatureSwitchService.getFeatureSwitches().then((function(){i.initialize(),i.scope.isInitialized=!0}))}return t.createOptions=function(){return{additionalServices:["$location","$timeout","appService","appMetadataService","asyncFeatureSwitchService","bootstrapService","contentPackService","contentProviderHttpService","dashboardDataService","dashboardService","dashboardStateChangeService","errorService","explorationLoader","favorites","fullScreen","groupService","home","impersonationService","inFocusService","licenseEnforcementService","localizationService","modalDialogService","modelConverter","modelHttpService","modelService","mostRecentlyUsedService","navigation","notificationToast","packageService","pageTitle","permissionService","pinTileService","previewFeaturesModalService","reportService","rtl","quota","syncService","telemetryService","tutorialDataStore","userActivityContextService","userInfo","userNotificationInfo","visualPlugin","workbookService","conceptualModelSetting","appService","packageService","taskPaneSliderService","usageMetricsReport","navigationHelper"]}},t.prototype.initialize=function(){var t=this,i=this.services;this.scope.inAppsView=function(){return t.services.conceptualModelSetting.isAppsEnabled()&&t.services.navigation.inAppsDetailView()},this.scope.inAppView=function(){return t.services.conceptualModelSetting.isAppsEnabled()&&t.services.navigation.inAppView()},this.scope.isScrollable=function(){return t.services.navigation.inAppDetailView()},this.scope.inFavoritesView=function(){return i.navigation.inFavoritesView()},this.scope.inContentListView=function(){return i.navigation.inContentListView()},this.scope.inDashboardView=function(){return i.navigation.inDashboardView()},this.scope.inEmptyFeaturedDashboardView=function(){return t.services.navigation.inHomeDashboardView()&&!t.services.home.isHomeDashboardSet},this.scope.inGroupWelcomeView=function(){return i.navigation.inGroupWelcomeView()},this.scope.inReportView=function(){return i.navigation.inReportView()||i.navigation.inDatasetView()},this.scope.inDatasetView=function(){return i.navigation.inManageDatasetView()||i.navigation.inManageStreamingDatasetView()},this.scope.inWorkbookView=function(){return i.navigation.inWorkbookView()},this.scope.inDashboardSliderView=function(){return i.navigation.inFullPageSliderView()},this.scope.inQnaModelView=function(){return i.navigation.inQnaModelView()},this.scope.inQnaView=function(){return i.navigation.inQnaView()},this.scope.inWorkspacesView=function(){return i.navigation.inWorkspacesView()},this.scope.hideTaskPaneSliderOnClick=function(){return t.hideTaskPaneSliderOnClick()},this.scope.dashboardDataService=i.dashboardDataService,this.scope.navigation=i.navigation,this.scope.groupService=i.groupService,this.scope.fullScreen=i.fullScreen,this.scope.impersonation=i.impersonationService,this.scope.permissionService=i.permissionService,this.scope.showLoadingForDashboard=function(){return t.showLoadingForDashboard()},this.scope.quitImpersonation=function(){return t.quitImpersonation()},this.scope.exitFullScreen=function(){i.fullScreen.fullScreenMode=!1,i.fullScreen.fitStyle=n.None};var s=i.telemetryService.startActivity(this.scope,e.telemetry.AppInitialAppLoad,i.navigation.stateService.current.name,void 0);s.event.id=window.initialAppLoadActivityId||s.event.id,initializeContainerStartTime&&initializeContainerStartTime.getTime&&s&&s.event&&s.event.time&&(s.event.time=initializeContainerStartTime.getTime()),this.initializeContainer(s),this.scope.$watch("inDashboardView() || inDashboardSliderView()",(function(e){return t.scope.isDashboardLandingContainerActive=!!e})),i.rootScope.$on(e.constants.updateFavorites,(function(){i.favorites.reloadFavorites(!0)})),this.scope.$watch("inContentListView()",(function(e){return t.scope.isContentListActive=!!e,t.scope.isContentListActive})),this.scope.contentListEnabled=function(){return t.scope.listViewEnabled()},this.scope.favoritesEnabled=i.asyncFeatureSwitchService.featureSwitches.favoritesEnabled,this.scope.newQnaEnabled=!i.rtl.isRtlLayout,this.scope.listViewEnabled=function(){return i.conceptualModelSetting.isListViewEnabled()},this.usageMetricsEnabled=i.asyncFeatureSwitchService.featureSwitches.usageMetricsEnabled,this.scope.navigationPaneSide=i.rtl.isRtlLayout?"right":"left",i.rootScope.$on(e.constants.personalizeEventName,(function(e,i){t.onPersonalizePackage(e,i)})),this.scope.$on(r.onReportPersonalizedEventName,(function(e,i){t.onPersonalizeReport(e,i)})),i.rootScope.$on(r.openUsageMetricsReport,(function(e,i,o){t.openUsageMetricsReport(i,o)})),i.rootScope.$on(r.pinReportPageToDashboard,(function(e,i){t.pinReportPage(i)})),this.scope.$on(a.workbook.bindToExcelWorkbookEventName,(function(e,i){return t.onBindToExcelWorkbook(e,i)}));var c,l=this.scope.$on(r.navigation.stateChangeSuccess,(function(e,i,o,r,a){return t.handleStateChange(i,o,r,a)}));e.explore&&(c=i.rootScope.$on(e.explore.constants.pinVisualContainerEventName,(function(e,i){return t.pinVisual(i)})));var u,v;e.insights&&(v=i.rootScope.$on(e.insights.constants.pinInsightContainer,(function(e,i){return t.pinVisual(i)})),u=i.rootScope.$on(e.insights.constants.viewInsightInFocus,(function(e,i,o,r){return t.showVisualInFocus(i,o,r)})));var h=i.rootScope.$on(r.currentActiveReportInfoChangedEventName,(function(e,i){return t.updateCurrentReportInfo(e,i)})),g=this.scope.$on(e.constants.showTileEditorEventName,(function(e,r){e&&e.stopPropagation(),i.dashboardService.selectDashboardTile(r),t.services.taskPaneSliderService.expandPane(d.TileEditor,o.Large)})),m=this.scope.$on(e.constants.hideTileEditorEventName,(function(e){e&&e.stopPropagation(),i.dashboardService.clearSelectedDashboardTile(),t.services.taskPaneSliderService.collapsePane()})),f=this.scope.$on(e.settings.constants.showGatewayUserMappingPaneEventName,(function(){t.services.taskPaneSliderService.expandPane(d.UpnMappingPane,o.Large)})),y=this.scope.$on(e.settings.constants.hideGatewayUserMappingPaneEventName,(function(){t.services.taskPaneSliderService.collapsePane()})),b=this.scope.$on(p.ShowShareDashboardPaneEventName,(function(e){e&&e.stopPropagation(),t.services.taskPaneSliderService.expandPane(d.SharingPane,o.Large)}));this.scope.hideNotificationPaneOnClick=function(){return t.hideNotificationPaneOnClick()},this.scope.$watch((function(){return i.userNotificationInfo.showPane}),(function(e){t.scope.$applyAsync((function(){t.handleNotificationPane(e)}))})),i.appMetadataService.getAppMetadata().then((function(e){e&&e.userMetadata&&i.syncService.monitorUserChanges(e.userMetadata.version,e.userMetadata.tenantMetadata?e.userMetadata.tenantMetadata.version:null,e.userMetadata.groups?e.userMetadata.groups:[])})),this.scope.$on("$destroy",(function(){c&&c(),u&&u(),v&&v(),h&&h(),l&&l(),g(),m(),f(),y(),b()})),this.isNavigationPaneExpanded=!0,i.bootstrapService&&i.bootstrapService.bootstrap(),i.tutorialDataStore.onReady((function(){if(i.asyncFeatureSwitchService.featureSwitches.previewConceptualModel){var e=i.tutorialDataStore.hasKey(r.previewConceptualModelKey);e&&i.previewFeaturesModalService.showFeedbackModal()}}))},t.prototype.toggleNavigationPane=function(e){this.isNavigationPaneExpanded=e},t.prototype.findModel=function(e,t,i){void 0===i&&(i=!0);var o=this.services.modelService.findModel(e,t,i);return o&&o.contract||_.find(this.dashboardContainerModel.contract.models,(function(i){return i.id===e&&i.packageId===t}))},Object.defineProperty(t.prototype,"contentProviders",{get:function(){return this.services.contentProviderHttpService.getBuiltInContentProviders()},enumerable:!0,configurable:!0}),t.prototype.handleStateChange=function(t,i,o,r){var a=this;this.openExplorationEvent&&(this.openExplorationEvent.event&&this.openExplorationEvent.event.info&&(this.openExplorationEvent.event.info.isCancelled=!0,this.openExplorationEvent.event.info.errorCode="NavigateAway"),this.openExplorationEvent.resolve(),this.openExplorationEvent=void 0),this.services.taskPaneSliderService.collapsePane();var n=this.services.navigation;if(t.name===e.constants.navigation.states.home){var s=this.services.home;if(s.isHomeDashboardSet&&(!r.groupGUID||r.groupGUID===s.homeDashboard.groupId))return void n.insertGroupAndNavigateToDashboardByGUID(s.homeDashboard.dashboardObjectId,s.homeDashboard.groupId,1)}else if(t.name===e.constants.navigation.states.group)return void n.navigateToContentListOrActiveDashboard();if(n.inReportView())this.services.groupService.groupSwitchPromise().then((function(){a.services.navigationHelper.ensureReportGUID();var t=a.services.reportService.findReportByGUID(n.currentReportGUID);if(!t)return a.services.mostRecentlyUsedService.removeMRU(n.currentReportGUID),e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog("ArtifactKind_Report",a.services.errorService,a.services.localizationService,a.services.telemetryService),void n.navigateToContentListOrActiveDashboard();t.isNew=!1;var i=a.services.modelConverter.convertReport(t.contract);a.services.modelConverter.fillReport(i,t.contract),i.model=a.findModel(t.modelId,t.packageId),a.onBindToPowerViewReport(null,i,n.instantiationMode,null,n.currentReportPage)}));else if(n.inDatasetView()&&!n.inQnaModelView()){if(n.currentDatasetDBName){var c=this.services.modelService.findModelByDBName(n.currentDatasetDBName);if(!c)return e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog("ArtifactKind_Dataset",this.services.errorService,this.services.localizationService,this.services.telemetryService),void n.navigateToActiveDashboard();var l=this.services.modelConverter.convertReport(c.contract);this.services.modelConverter.fillReport(l,c.contract),l.model=c.contract,this.onBindToPowerViewReport(null,l,n.instantiationMode)}}else if(n.inDashboardView()){var d=this.services.dashboardDataService;this.services.navigationHelper.ensureDashboardGUID();var p=d.findDashboardByGUID(n.currentDashboardGUID);!p||d.activeDashboard&&d.activeDashboard.objectId===p.objectId||(d.activeDashboard=p),n.inQnaView()&&(this.scope.viewModel.qnaContainer.models=d.activeDashboardModels,this.scope.viewModel.qnaContainer.title=d.activeDashboard.displayName)}else n.inDatasetView()&&n.inQnaModelView()&&this.services.modelService.modelsPromise.then((function(e){var t=n.currentDatasetDBName,i=_(e).filter((function(e){return e.dbName===t})).map((function(e){return e.contract})).value();a.scope.viewModel.qnaContainer.models=i,a.scope.viewModel.qnaContainer.title=i[0].displayName}))},t.prototype.showVisualInFocus=function(e,t,i){if(e){var o=e.modelId,r=e.packageId,a=o?this.findModel(o,r):void 0,n=u.createTileForPinData(this.services.visualPlugin,e,a),s=this.services.modelConverter.convertTile(n,this.services.modelService.getModelContracts());this.services.inFocusService.view(s,t,i)}},t.prototype.isPinningSupported=function(e,t,i){var o,a=this.services.permissionService,n=a&&a.getModelEffectivePermissions(t)||t.permissions;if(e&&e.getPermissions()===s.CopyOnWrite?o=e.packageId:t&&n===s.CopyOnWrite&&(o=t.packageId),null!=o)return this.onPersonalize(o),!1;var c=i&&i.action,l=c===r.openQnAActionName||c===r.openInsightsActionName;return!(this.services.permissionService.isActiveWorkspaceIsReadOnly||e&&(e.getPermissions()&s.Write)!==s.Write||l&&t&&(n&s.Write)!==s.Write)||(this.services.pinTileService.showNotSupportedDialog(),!1)},t.prototype.pinVisual=function(t){if(t){var i,o=this.services.telemetryService,r=t.modelId,a=t.packageId,n=r?this.findModel(r,a):void 0,s=n?n.contentProviderId:void 0,l=e.common.findContentProviderName(this.contentProviders,s),d=!!(t.resourcePackageIds&&t.resourcePackageIds.length>0),p=o.startEvent(e.telemetry.DashboardPinTile,c.getVisualType(t),this.getSource(t),"",!1,l,d,"",!1);t.reportId&&(i=this.services.reportService.findReport(t.reportId),i||this.services.reportService.addReport(this.services.modelConverter.convertReport({id:t.reportId,permissions:e.common.contracts.Permissions.All|e.common.contracts.Permissions.Explore}))),this.isPinningSupported(i,n,t.action)&&this.services.pinTileService.showPinVisualDialog(t,i,n,void 0,p)}},t.prototype.pinReportPage=function(e){var t=this.services.reportService.findReport(e.reportId),i=this.findModel(e.modelId,e.packageId);this.usageMetricsEnabled&&this.belongsToUsageMetricsContentPack(t)&&(e.additionalODataFilter=this.services.navigation.additionalODataFilter),this.isPinningSupported(t,i,e.action)&&this.services.pinTileService.showPinReportPageDialog(e);
},t.prototype.getSource=function(t){switch(t.action.action){case e.common.constants.openQnAActionName:return l.QnA;case e.common.constants.openInsightsActionName:return l.Insights;default:return l.Exploration}},t.prototype.updateCurrentReportInfo=function(e,t){null!=e&&e.stopPropagation(),this.services.reportService.currentActiveReport=t},t.prototype.onPersonalizePackage=function(e,t){null!=e&&e.stopPropagation(),this.onPersonalize(t)},t.prototype.onPersonalizeReport=function(e,t){null!=e&&e.stopPropagation();var i=this.services.reportService.findReport(t);null!=i&&this.onPersonalize(i.packageId)},t.prototype.onPersonalize=function(e){this.services.contentPackService.onPersonalizeContentPack(e)},t.prototype.onBindToPowerViewReport=function(t,o,r,a,n){var s=this;null!=t&&t.stopPropagation(),this.updateCurrentReportInfo(null,{id:o.id,displayName:o.displayName});var c,l=this.services.dashboardDataService.activeDashboard;l&&(c=l.id);var d=this.services.modelConverter,p=d.convertReport(o.contract);d.fillReport(p,o.contract),p.packageId=o.contract.packageId,p.reportActiveSlideId=o.reportActiveSlideId,p.isNew=o.isNew,p.model=o.model,p.modelId=o.modelId;var u=p.contract&&i.getResourceAppGUID(p.contract,this.services.appService,this.services.packageService);this.openExplorationEvent=this.services.telemetryService.startActivity(this.scope,e.telemetry.EXOpenExploration,p.objectId,p.contract&&p.contract.originalReportObjectId,u,p.model&&p.model.directQueryMode===!0,!1,p.model&&!_.isEmpty(p.model.onPremModelConnectionString),this.getReportOpenSource(),this.belongsToUsageMetricsContentPack(o),this.services.groupService.activeGroupObjectId);var v={report:p,dashboardId:c,instantiationMode:r,tileId:a,reportPage:n,openExplorationTelemetryEvent:this.openExplorationEvent},h=this.scope.viewModel;h.explorationContainer=e.explore.viewModels.ViewModelFactory.createExplorationContainer(),this.services.explorationLoader.load(v);var g=e.contracts.LandingView.Report,m=this.services.telemetryService,f=m.startEvent(e.telemetry.DashboardSwitchView,h.contract.activeView,g);h.contract.activeView=g;var y=d.convertLandingContainerShallow(h.contract);y.calculateLayout(),this.services.localizationService.ensureLocalization((function(){s.scope.reportName=s.getReportTitleForNavigationBar(o)})),this.scope.viewModel.reportContainer.isActiveView=!0,f.resolve()},t.prototype.getReportOpenSource=function(){var t=jsCommon.QueryStringUtil.getQueryStringValue("openReportSource");return"email"===t?e.telemetry.OpenExplorationSource.EmailSubscription:e.telemetry.OpenExplorationSource.Normal},t.prototype.getReportTitleForNavigationBar=function(t){var i=t.displayName;return i?i:e.common.localize.get("Landing_DefaultReportName")},t.prototype.onBindToExcelWorkbook=function(t,i){t.stopPropagation(),this.services.workbookService.currentActiveWorkbook={id:i.id,packageId:i.packageId,uniqueId:i.uniqueId,displayName:i.displayName};var o=this.scope.viewModel,r=e.contracts.LandingView.Workbook,a=this.services.telemetryService,n=a.startEvent(e.telemetry.DashboardSwitchView,o.contract.activeView,r);this.scope.viewModel.contract.activeView=r,n.resolve()},t.prototype.initializeContainer=function(i){var o=this,r={dashboards:[],activeViewMode:e.contracts.DashboardContainerViewMode.DashboardViewer,activityPane:e.staticContract.getActivityPaneContract()},a={activeView:e.contracts.LandingView.Dashboard,dashboardContainer:r,reportContainer:{},workbookContainer:{},qnaContainer:{}},n=this.services.modelConverter,s=this.scope.viewModel=n.convertLandingContainer(a);s.calculateLayout(),s.applyLayout(),i&&this.logBootstrapEvents(i),this.services.rootScope.$on(e.constants.dashboardContainerLoaded,(function(e,r){o.scope.viewModel.dashboardContainer=o.services.dashboardService.dashboardContainerModel,i&&(t.logGetAppMetadataTelemetry(o.services.telemetryService,i,window.getAppMetadataInfo),o.services.$timeout((function(){i.event.info.finalState=r||o.services.navigation.stateService.current.name,o.scope.$applyAsync((function(){i.resolve(),o.scope.appDataReady=!0,o.services.pageTitle.refresh()}))})))}))},t.prototype.handleNotificationPane=function(e){this.scope.viewModel.notificationPane.isExpanded=e,this.scope.viewModel.showNotificationPane=e,this.scope.viewModel.notificationPane.expandedWidth=e?o.Small:o.Default,e||(this.services.userNotificationInfo.hidePaneOnClick=!1)},t.prototype.hideTaskPaneSliderOnClick=function(){this.services.taskPaneSliderService.collapsePane(),this.scope.$broadcast(e.constants.hideTaskPaneSliderOnClickEventName)},t.prototype.hideNotificationPaneOnClick=function(){this.services.userNotificationInfo.hidePaneOnClick=!0},Object.defineProperty(t.prototype,"dashboardContainerModel",{get:function(){return this.scope.viewModel.dashboardContainer=this.services.dashboardService.dashboardContainerModel,this.scope.viewModel.dashboardContainer},enumerable:!0,configurable:!0}),t.prototype.showLoadingForDashboard=function(){var e=this.services.dashboardDataService;return e.activeDashboard&&e.activeDashboard.id<0},t.prototype.quitImpersonation=function(){var e=this.services.impersonationService,t=e.getImpersonationState().modelId;e.clearImpersonation(),this.services.fullScreen.fullScreenMode&&this.scope.exitFullScreen(),this.services.navigation.showRowLevelSecuritySlider(t)},t.logGetAppMetadataTelemetry=function(t,i,o){if(!_.isEmpty(o))for(var r=0,a=o;r<a.length;r++){var n=a[r];if(n&&n.start&&n.end){var s=n.initialDashboardContainer,c=t.startChildEvent(i.event,e.telemetry.AppGetAppMetadata,n.url,n.groupGUID,n.size,_.size(s&&s.dashboards),_.size(s&&s.reports),_.size(s&&s.models),_.size(s&&s.workbooks),_.size(s&&s.favorites),n.start.toISOString(),n.end.toISOString());c.event.id=n.requestId,n.parseStart&&n.parseEnd&&t.logChildEvent(c.event,e.telemetry.AppParseAppMetadata,n.parseStart.toISOString(),n.parseEnd.toISOString()),n.isError?c.reject(e.errorDetailsHelper.getTelemetryErrorDetails({code:n.code,message:n.errorMessage})):c.resolve()}}},t.prototype.logBootstrapEvents=function(t){for(var i=this.services.telemetryService,o=e.common.perfMarkers.getJsParseTimes(window.parseTimeMarkers),r=0,a=o;r<a.length;r++){var n=a[r];i.logChildEvent(t.event,e.telemetry.AppJavaScriptParse,n.fileName,n.start,n.end)}var s=window.performance.timing;i.logChildEvent(t.event,e.telemetry.AppLoadPerformanceTiming,s.navigationStart,s.unloadEventStart,s.unloadEventEnd,s.redirectStart,s.redirectEnd,s.fetchStart,s.domainLookupStart,s.domainLookupEnd,s.connectStart,s.connectEnd,s.requestStart,s.responseStart,s.responseEnd,s.domLoading,s.domInteractive,s.domContentLoadedEventStart,s.domContentLoadedEventEnd,s.domComplete,s.loadEventStart,s.loadEventEnd)},t.prototype.openUsageMetricsReport=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r;return __generator(this,(function(a){switch(a.label){case 0:o=this.services.telemetryService.startEvent(e.telemetry.UsageMetricsViewUsageMetricsReport,e.constants.usageMetrics_Report,t.objectId,e.constants.usageMetrics_Report),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.services.usageMetricsReport.openReportUsageMetricsReport(t,i,o)];case 2:return a.sent(),o.resolve(),[3,4];case 3:return r=a.sent(),o.reject(e.errorDetailsHelper.getTelemetryErrorDetails(r.error)),[3,4];case 4:return[2]}}))}))},t.prototype.belongsToUsageMetricsContentPack=function(e){return e&&e.contract&&this.services.usageMetricsReport.reportBelongsToUsageMetricsContentPack(e.contract)},t})();t.LandingContainer=v})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.constants,o=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.scope.viewModel.ownedByMeSelected=!0,this.scope.tryItFree=function(){return o.tryItForFree()},this.scope.deleteModel=function(e){return o.deleteModel(e)},this.scope.userGroupHeader=new e.models.UserGroupHeaderModel,this.scope.isInVisibleDashboard=function(e){return o.services.quota.isInVisibleDashboard(e)},this.loadUserMetadata(),this.updateView(),t.$watchGroup([function(){return o.services.workbookService.lastUpdatedTimestamp},function(){return o.services.modelService.lastUpdatedTimestamp},function(){return o.scope.dashboardContainer.dashboards}],(function(){o.updateView()})),t.$watch((function(){return o.services.groupService.activeGroup}),(function(){o.loadUserMetadata(),o.updateView()})),this.logUsageEvent()}return t.createOptions=function(){return{additionalServices:["errorService","modelConverter","navigation","promiseFactory","telemetryService","localizationService","quota","modelService","modelHttpService","groupService","featureSwitchService","userInfo","workbookService","workbookHttpService","contentPackService","lazy","invitationService","packageService","usageMetricsReport"]}},t.prototype.deleteModel=function(t){if(t&&t.modelId){var i=this.services.modelService.findModel(t.modelId,t.packageId);i&&i.isUsedByContentPack?this.showDialogOnModelUsedByContentPack(t.modelId):this.scope.viewModel.ownedByMeSelected&&t.storageType===e.storageType.Dataset?this.deleteOwnedModel(t):this.scope.viewModel.ownedByMeSelected&&t.storageType===e.storageType.Report?this.deleteWorkbook(t):this.removeOthersModel(t)}},t.prototype.tryItForFree=function(){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.services.lazy("licenseHelper")];case 1:return t=i.sent(),this.services.userInfo.userFreeTrialExpired?t.displayDialogToExtendTrial(e.telemetry.LicenseEnforcementOperation.ManageStorageView):t.displayDialogToAcceptTrialTerms(e.telemetry.LicenseEnforcementOperation.ManageStorageView),[2]}}))}))},t.prototype.showDialogOnModelUsedByContentPack=function(e){this.services.contentPackService.showDialogOnModelDeleteInContentPack(e)},t.prototype.getUsageModelIndex=function(e,t){var i=this.scope.viewModel.usageDetails;if(i)for(var o=0,r=i.length;o<r;o++)if(i[o].modelId===e&&(!t||i[o].packageId===t))return o;return-1},t.prototype.deleteOwnedModel=function(t){var o=this,r=this.services.errorService.control(),a=[new InJs.ModalDialogAction(this.services.localizationService.get("QuotaManagement_DeleteButtonText"),function(a,n){o.logDeleteEvent(e.telemetry.QuotaDeleteItemType.DeleteOwnedModel,t.sizeInMBs),r.hideDialog();var s=o.getUsageModelIndex(t.modelId,t.packageId);s>=0&&o.scope.viewModel.usageDetails.splice(s,1);var c=o.services.telemetryService.startEvent(e.telemetry.DashboardDeleteDataset),l=o.services.modelService.findModel(t.modelId,t.packageId);o.services.modelHttpService.deleteModel(l.contract,c.event).then((function(){c.resolve(),o.updateUsage()}),(function(r){r.status===e.HttpStatusCode.Unauthorized?o.services.errorService.error(o.services.localizationService.get("Model_NoPermissionToDeleteMessage"),"Model_NoPermissionToDelete",{requestId:r.requestId,statusCode:r.status.toString()}):r.status===e.HttpStatusCode.BadRequest&&r.headers(e.common.PowerBIErrorHeader)===i.CannotDeleteModelPublishedToOrganizationalAppHeader?o.services.errorService.error(o.services.localizationService.get("Model_DeleteWaitMessage"),"Model_DeleteWaitMessage",{requestId:r.requestId,statusCode:r.status.toString()}):o.services.errorService.error(o.services.localizationService.get("Model_FailToDeleteModelMessage"),"Model_FailToDeleteModel",{requestId:r.requestId,statusCode:r.status.toString()}),o.scope.viewModel.usageDetails.push(t),c.reject()}))}),new InJs.ModalDialogAction(this.services.localizationService.get("QuotaManagement_CancelButtonText"),function(e,t){r.hideDialog()})],n=this.services.localizationService.get("QuotaManagement_DeleteConfirmationTitle"),s=this.services.localizationService.get("QuotaManagement_DeleteConfirmationMessage");r.showCustomDialog(n,$("<div/>").text(s),a,(function(e){e.parent().find('input[value="'+o.services.localizationService.get("QuotaManagement_CancelButtonText")+'"]').focus()}),!0)},t.prototype.removeOthersModel=function(t){var i=this,o=this.services.errorService.control(),r=[new InJs.ModalDialogAction(this.services.localizationService.get("QuotaManagement_RemoveButtonText"),function(r,a){i.logDeleteEvent(e.telemetry.QuotaDeleteItemType.RemoveSharedItem,t.sizeInMBs),o.hideDialog();var n=t.dashboardsFromModel,s=[];if(n)for(var c=0,l=n.length;c<l;c++){var d=n[c],p=d.contract.modelIds;s=s.concat(p);var u=i.services.telemetryService.startEvent(e.telemetry.DashboardDeleteDashboardUser);i.services.invitationService.deleteUser(i.scope.dashboardContainer.userId,d.id,u.event).then((function(e){u.resolve(),i.updateUsage()}),(function(e){i.services.errorService.error(i.services.localizationService.get("Dashboard_FailToRemoveDashboardMessage"),"Dashboard_FailToRemoveDashboard",{requestId:e.requestId,statusCode:e.status.toString()}),u.reject()}))}for(var c=0,l=s.length;c<l;c++){var v=i.getUsageModelIndex(s[c]);v>-1&&i.scope.viewModel.usageDetails.splice(v,1)}i.services.modelService.removeModels(s)}),new InJs.ModalDialogAction(this.services.localizationService.get("QuotaManagement_CancelButtonText"),function(e,t){o.hideDialog()})],a=this.services.localizationService.get("QuotaManagement_RemoveConfirmationTitle"),n=this.services.localizationService.get("QuotaManagement_RemoveConfirmationMessage");o.showCustomDialog(a,$("<div/>").text(n),r,(function(e){e.parent().find('input[value="'+i.services.localizationService.get("QuotaManagement_CancelButtonText")+'"]').focus()}),!0)},t.prototype.deleteWorkbook=function(t){var i=this,o=this.services.errorService.control(),r=[new InJs.ModalDialogAction(this.services.localizationService.get("QuotaManagement_DeleteButtonText"),function(r,a){i.logDeleteEvent(e.telemetry.QuotaDeleteItemType.DeleteOwnedWorkbook,t.sizeInMBs),o.hideDialog();var n=i.getUsageModelIndex(t.modelId,t.packageId);n>=0&&i.scope.viewModel.usageDetails.splice(n,1);var s=i.services.workbookService.workbooks,c=_.filter(s,(function(e){return e.modelId===t.modelId}));if(c&&c.length>0){var l=i.services.telemetryService.startEvent(e.telemetry.DashboardRemoveWorkbook,i.services.packageService.getWorkbookStorageProvider(c[0].contract.packageId),i.services.packageService.getWorkbookContentProvider(c[0].contract.packageId));i.services.workbookHttpService.deleteWorkbook(c[0].contract,l.event).then((function(){l.resolve(),i.updateUsage()}),(function(o){o.status===e.HttpStatusCode.Unauthorized?i.services.errorService.error(i.services.localizationService.get("Workbook_NoPermissionToRemoveMessage"),"Workbook_NoPermissionToRemove",{requestId:o.requestId,statusCode:o.status.toString()}):i.services.errorService.error(i.services.localizationService.get("Workbook_FailToRemoveWorkbookMessage"),"Workbook_FailToRemoveWorkbook",{requestId:o.requestId,statusCode:o.status.toString()}),i.scope.viewModel.usageDetails.push(t),l.reject()}))}}),new InJs.ModalDialogAction(this.services.localizationService.get("QuotaManagement_CancelButtonText"),function(e,t){o.hideDialog()})],a=this.services.localizationService.get("QuotaManagement_DeleteConfirmationTitle"),n=this.services.localizationService.get("QuotaManagement_DeleteConfirmationMessage");o.showCustomDialog(a,$("<div/>").text(n),r,(function(e){e.parent().find('input[value="'+i.services.localizationService.get("QuotaManagement_CancelButtonText")+'"]').focus()}),!0)},t.prototype.updateUsage=function(){var t=this.services.quota,i=t.getUsage();this.scope.viewModel.selfUsageInMB=i.ownedUsage,this.scope.viewModel.otherUsageInMB=i.sharedUsage,this.scope.viewModel.totalUsageInMB=i.totalUsage;var o={selfUsageInPercent:this.scope.viewModel.selfUsageInMB/this.scope.viewModel.quotaLimitInMB,otherUsageInPercent:this.scope.viewModel.otherUsageInMB/this.scope.viewModel.quotaLimitInMB,selfUsageInUnit:e.StorageUsageService.convertToUsageWithUnit(this.scope.viewModel.selfUsageInMB),otherUsageInUnit:e.StorageUsageService.convertToUsageWithUnit(this.scope.viewModel.otherUsageInMB),usageDescription:this.services.localizationService.format("QuotaManagement_UsageDescription",[e.StorageUsageService.convertToUsageWithUnit(i.totalUsage),e.StorageUsageService.convertToUsageWithUnit(this.scope.viewModel.quotaLimitInMB)])};this.scope.viewModel.usageBarModel=o},t.prototype.updateView=function(){this.scope.viewModel.usageDetails=this.services.quota.getUsageModels();var e=this.services.featureSwitchService.featureSwitches.showHiddenUsageMetricsModels;if(!e){var t=this.services.packageService,i=this.services.usageMetricsReport;this.scope.viewModel.usageDetails=_.filter(this.scope.viewModel.usageDetails,(function(e){var o=t.findPackage(e.packageId);return!i.packageIsUsageMetricsContentPack(o)}))}this.updateUsage()},t.prototype.loadUserMetadata=function(){this.services.groupService.activeGroup?this.scope.viewModel.isMyWorkspace=this.services.groupService.activeGroup.isMyWorkspace:this.scope.viewModel.isMyWorkspace=!0,this.scope.viewModel.isPremiumUser=this.services.userInfo.isPremiumUser,this.scope.viewModel.quotaLimitInMB=this.services.quota.quotaLimitInMB,this.scope.viewModel.quotaLimitInUnit=e.StorageUsageService.convertToUsageWithUnit(this.scope.viewModel.quotaLimitInMB),this.scope.viewModel.tryItFreeText=this.services.userInfo.userFreeTrialExpired?this.services.localizationService.get("ExtendTrial_RequestExtensionButtonText"):this.services.localizationService.get("UpgradeAccount_TryfreeButton")},t.prototype.logDeleteEvent=function(t,i){var o=this.scope.viewModel.isMyWorkspace?e.telemetry.QuotaOpenManageStorageContext.Personal:e.telemetry.QuotaOpenManageStorageContext.Group,r=this.services.telemetryService;r.logEvent(e.telemetry.QuotaManageStorageDelete,this.scope.viewModel.isPremiumUser,o,t,i,this.scope.viewModel.selfUsageInMB,this.scope.viewModel.otherUsageInMB,this.scope.viewModel.quotaLimitInMB)},t.prototype.logUsageEvent=function(){var t=this.scope.viewModel.isMyWorkspace?e.telemetry.QuotaOpenManageStorageContext.Personal:e.telemetry.QuotaOpenManageStorageContext.Group,i=this.services.telemetryService;i.logEvent(e.telemetry.QuotaStorageUsage,this.scope.viewModel.isPremiumUser,t,this.scope.viewModel.selfUsageInMB,this.scope.viewModel.otherUsageInMB,this.scope.viewModel.quotaLimitInMB)},t})();t.ManageStorageView=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.constants,r=e.common.DropdownUtils,a=e.constants.dynamicMessaging,n=e.models.factory.NavigationBarMenuFactory,s=e.dialog.PopupNotificationDialogBuilder;!(function(e){e[e.ContactSupport=0]="ContactSupport",e[e.DownloadCompanionApp=1]="DownloadCompanionApp",e[e.DownloadExcelPublisher=2]="DownloadExcelPublisher",e[e.DownloadGateways=3]="DownloadGateways",e[e.DownloadIOSApp=4]="DownloadIOSApp",e[e.DownloadAnalyzeInExcelUpdates=5]="DownloadAnalyzeInExcelUpdates",e[e.MakeSuggestion=6]="MakeSuggestion",e[e.ManageEmbed=7]="ManageEmbed",e[e.ManageStorage=8]="ManageStorage",e[e.OpenGeneralSettings=9]="OpenGeneralSettings",e[e.PublishContentPack=10]="PublishContentPack",e[e.ShowAboutDialog=11]="ShowAboutDialog",e[e.SignOut=12]="SignOut",e[e.UpgradeAccount=13]="UpgradeAccount",e[e.ViewContentPack=14]="ViewContentPack"})(i=t.NavigationBarMenuAction||(t.NavigationBarMenuAction={}));var c="noChrome",l="#EMAIL",d="https://support.powerbi.com",p='<div class="aboutPbiDialog"><div class="logo"></div><div class="info"><div class="title">{0}</div><div class="copyright">&copy;{1}</div><span class="field">{2}</span><span class="value">{{version}}</span><br><span class="field">{3}</span><span class="value">{4}</span><br><span class="field">{5}</span><span class="value">{6}</span><br><span class="field">{7}</span><span class="value">{8}</span></div></div>',u=(function(){function t(r,a){var n=this;this.scope=r,this.services=a;var s=this.services.$window;this.scope.navigation=this.services.navigation,this.scope.userInfo=this.services.userInfo,this.scope.featureSwitchPublishToWeb=!1,this.scope.logoConfig={operator:s.powerBIOperator,operatorLocale:s.powerBIOperatorLocale},this.supportPageUrl=s.supportPageUrl||d,this.scope.navigateToLanding=function(){n.shouldShowListView()?n.services.bootstrapService.bootstrapNavigation(!1,!0):n.services.navigation.navigateToActiveDashboard(),n.services.telemetryService.logEvent(e.telemetry.NavigationClickLogo)},this.services.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){n.scope.featureSwitchPublishToWeb=e.publishToWebEnabled&&e.anonymousEmbeddingEnabled})),this.scope.fullScreen=this.services.fullScreen,this.scope.enterFullScreen=function(){n.services.fullScreen.fullScreenMode=!0,n.services.telemetryService.logEvent(e.telemetry.SettingsEnterFullScreen,n.services.navigation.stateService.current.name)},this.bindNavigationBarMenus(),this.scope.powerBICompanionAppEnable=!1,this.scope.featureSwitchOrgAppsEnabled=this.services.asyncFeatureSwitchService.featureSwitches.orgAppsEnabled,this.scope.featureSwitchPermissionCenterEnabled=this.services.asyncFeatureSwitchService.featureSwitches.permissionCenterEnabled,this.scope.featureSwitchEnterpriseGatewayEnabled=!!this.services.asyncFeatureSwitchService&&this.services.asyncFeatureSwitchService.featureSwitches.enterpriseGatewayEnabled,this.scope.o365PowerBIEnabled=this.services.asyncFeatureSwitchService.featureSwitches.o365PowerBIEnabled&&this.services.userInfo.userHasOffice365Plan,this.scope.canWrite=function(){return!n.services.permissionService.isActiveWorkspaceIsReadOnly},this.services.userInfo.getUserPhoto().then((function(e){n.scope.userPhoto=e}));var c=this.services.$location.host();this.scope.isSelfhostInternal=0===c.indexOf("dxt.powerbi.com")||0===c.indexOf("portal.analysis.windows-int.net")||0===c.indexOf("powerbi-df.analysis-df.windows.net"),this.initializeUserNotifications(),this.services.userNotificationInfo.registerNotificationsUpdatedListener((function(){return n.notificationChangeHandler()})),this.services.localizationService.ensureLocalization((function(){t.FeedbackMessage=n.services.localizationService.get("FeedbackTicket_Message").replace("{{startLink}}",' <a href="https://support.powerbi.com/tos" target="_blank">').replace("{{endLink}}","</a> ")+" (#EMAIL).",t.SupportTicketMessage=n.services.localizationService.get("SupportTicket_Message").replace("{{startLink}}",' <a href="https://support.powerbi.com/tos" target="_blank">').replace("{{endLink}}","</a> ")+" (#EMAIL)."})),this.scope.showMenu=function(e,t,i){return n.showMenu(e,t,i)},this.scope.showSettingsMenu=function(e){return n.showSettingsMenu(e)},this.scope.getProTrialStatus=function(){return n.getProTrialStatus()},this.scope.promptForUpgrade=function(){return n.promptForUpgrade()};var l=this.services.rootScope.$on(e.constants.enablePowerBICompanionApp,(function(t){n.services.timeout((function(){n.scope.powerBICompanionAppEnable=!0;var t=_.filter(n.scope.downloadMenu,(function(e){return e.action===i.DownloadCompanionApp}))[0];t&&(t.href=e.models.PowerBICompanionModel.downloadLink)}))})),p=this.services.rootScope.$on(o.onReportChangedEventName,(function(e,t){n.scope.reportChanged=t}));this.scope.$on("$destroy",(function(){l(),p()}));var u=jsCommon.QueryStringUtil.parseQueryString(),v=u.test;v&&this.services.licenseEnforcementService.accept2017ProTrial()}return t.createOptions=function(){return{additionalServices:["$location","$window","asyncFeatureSwitchService","modalDialogService","dashboardHttpService","dropdown","errorService","lazy","navigation","promiseFactory","telemetryService","localizationService","userInfo","groupService","overlayService","userSettingsHttpService","notificationToast","fullScreen","gatewaysMetadataService","permissionService","$location","userNotificationInfo","bootstrapService","conceptualModelSetting","dynamicMessagingData","tutorialDataStore","licenseEnforcementService"]}},t.prototype.initializeUserNotifications=function(){var t=this;this.scope.showUserNotifications=function(){t.services.userNotificationInfo.showPane?t.services.userNotificationInfo.hidePaneOnClick=!0:(t.services.userNotificationInfo.showPane=!0,t.services.telemetryService.logEvent(e.telemetry.UserNotificationsLoadNotificationPane,t.services.userNotificationInfo.userNotifications.unseenCount))},this.scope.getUserNotificationsCount=function(){return _.size(t.scope.userNotifications)},this.scope.getHighestNotificationLevel=function(e){return t.services.userNotificationInfo.getHighestNotificationLevel(e)},this.popupNotificationDialog=new s(this.services.modalDialogService)},t.prototype.notificationChangeHandler=function(){var e=this,t=this.services.userNotificationInfo.userNotifications.notifications;if(this.scope.userNotifications=_.filter(t,(function(e){return!e.seen&&(1===e.notificationType||null==e.notificationType)})),this.scope.popupNotifications=_.filter(t,(function(e){return!e.seen&&0===e.notificationType})),!(_.isEmpty(this.scope.popupNotifications)||this.modalDialogPromise&&this.modalDialogPromise.pending())){var i=this.scope.popupNotifications[0];i.seen=!0;var o={title:i.message.title.text,subtitle:i.message.subTitle&&i.message.subTitle.text,message:i.message.message.text,imgUrl:i.message.image&&i.message.image.imagePath,okButton:{text:i.action.resource.text,url:i.action.path[0]},cancelButton:i.subAction?{text:i.subAction.resource.text,url:i.subAction.path[0]}:null};this.modalDialogPromise=this.popupNotificationDialog.show("popupNotificationDialog",o),this.modalDialogPromise.then((function(t){0===t?e.services.dynamicMessagingData.postData(a.userClickedAction).finally((function(){e.handleDynamicMessageAction(i.action)})):e.services.dynamicMessagingData.postData(a.userDismissedAction)}))}},t.prototype.handleDynamicMessageAction=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,r,a=this;return __generator(this,(function(n){switch(n.label){case 0:if(!t)return[2];switch(i=t.actionType){case 6:return[3,1];case 7:return[3,2]}return[3,4];case 1:return r=this.services.telemetryService.startEvent(e.telemetry.PreviewConceptualModel,!0,e.telemetry.From.PopupMessageDialog),this.services.tutorialDataStore.setKey(o.previewConceptualModelNewKey,!0,r).then((function(){a.services.$window.location.reload(!0)}),(function(){return r.reject()})),[3,5];case 2:return[4,this.services.licenseEnforcementService.accept2017ProTrial()];case 3:return n.sent(),this.services.$window.location.reload(!0),[3,5];case 4:return this.services.$window.open(t.path[0],"_self"),[3,5];case 5:return[2]}}))}))},t.prototype.showSettingsMenu=function(e){var t=this,i=this.scope,o=function(i){i(),t.services.dropdown.hideAll(),e.stopPropagation()},r={canWrite:function(){return i.canWrite()},onManageStorageSelected:function(){return o((function(){return t.manageStorage()}))},onCreateContentPackSelected:function(){return o((function(){return t.scope.navigation.showPublishContentPackSlider()}))},onViewContentPackSelected:function(){return o((function(){return t.scope.navigation.showViewContentPackSlider()}))},onAdminPortalSelected:function(){return o((function(){return t.openAdminPortal()}))},onManageGatewaysSelected:function(){return o((function(){return t.openManageGateways()}))},onManagePermissionsSelected:function(){return o((function(){return t.managePermissions()}))},onO365PowerBISelected:function(){return o((function(){return t.goToO365PowerBISites()}))},onPowerBISettingsSelected:function(){return o((function(){return t.openGeneralSettings()}))},onManageEmbedSelected:function(){return o((function(){return t.manageEmbed()}))},featureSwitchOrgAppsEnabled:function(){return i.featureSwitchOrgAppsEnabled},showAdminPortal:function(){return t.showAdminPortal()},featureSwitchEnterpriseGatewayEnabled:function(){return i.featureSwitchEnterpriseGatewayEnabled},featureSwitchPermissionCenterEnabled:function(){return i.featureSwitchPermissionCenterEnabled},o365PowerBIEnabled:function(){return i.o365PowerBIEnabled},featureSwitchPublishToWeb:function(){return i.featureSwitchPublishToWeb}};this.services.dropdown.showMenu(r,"navigationBarSettingsMenu.html",this.getMenuDisplayOptions(e))},t.prototype.showAdminPortal=function(){return!!this.services.asyncFeatureSwitchService.featureSwitches.adminCapacityEnabled||this.services.userInfo.userMetadata.isTenantAdmin},t.prototype.showMenu=function(e,t,i){var o=this;r.showLegacyDropdownItems(this.services.dropdown,e,t,"navigationBar-contextMenu",(function(e){return o.scope.navigationBarMenuItemSelected(e,void 0)}),this.getMenuDisplayOptions(i))},t.prototype.showFeedbackContextMenu=function(e){e.stopPropagation();var t=n.createMenuItems(0,this.services.localizationService);this.services.dropdown.showContextMenu(t,this.getMenuPosition(e),_.noop,!1,"feedbackContextMenu")},t.prototype.getProTrialStatus=function(){var e=this.services.userInfo,t=this.services.localizationService;if(!e.userHasPremiumPlan&&e.userHasFreeTrial)return e.userFreeTrialDaysRemaining>1?t.format("UpgradeAccount_TrialDaysLeftStatue",[e.userFreeTrialDaysRemaining]):1===e.userFreeTrialDaysRemaining?t.get("UpgradeAccount_TrialDayLeftStatue"):void 0},t.prototype.promptForUpgrade=function(){this.services.licenseEnforcementService.showUpgradeDialog(e.telemetry.LicenseEnforcementOperation.NavigationBar)},t.prototype.getMenuPosition=function(e){var t=e.currentTarget;return{x:t.offsetLeft+t.offsetWidth,y:t.offsetTop+t.offsetHeight}},t.prototype.getMenuDisplayOptions=function(e){return{preferLeft:!0,showInsideVisibleArea:!0,position:this.getMenuPosition(e)}},t.prototype.showSupportWidget=function(){var i=this;e.UserVoiceService.ensureUserVoice(this.services.telemetryService,(function(){e.UserVoicePopover.show();var o=e.session.UserInfoUtils.getEmailAddressForReceivingMail();e.UserVoicePopover.setFooterText(t.SupportTicketMessage.replace(l,o)),i.services.localizationService.ensureLocalization((function(){e.UserVoiceService.api.push(["embed","#popovermain",{mode:"contact",forum_id:e.session.UserInfoUtils.isInternalUser()===!0?265200:262210,contact_title:i.services.localizationService.get("TopNav_HelpMenu_ContactSupport"),height:"325px",width:"325px"}])}))}))},t.prototype.showAboutDialog=function(){var i=this,o=this.services.errorService.control(),r=e.helpers.ClusterLocationHelper.getClusterLocation(clusterUri,this.services.localizationService);if(this.services.localizationService.ensureLocalization((function(){var e=new Date;t.AboutDialogTemplate=jsCommon.StringExtensions.format(p,i.services.localizationService.get("TopNav_PowerBILogoTextNoPreview"),i.services.localizationService.format("PowerBI_Copyright_Text",[e.getFullYear().toString()]),i.services.localizationService.get("PowerBI_Build_Version_Text"),i.services.localizationService.get("AdditionalErrorInfo_ActivityIdText"),i.services.telemetryService.sessionId,i.services.localizationService.get("AdditionalErrorInfo_TimestampText"),e.toString(),i.services.localizationService.get("AdditionalErrorInfo_DataLocationText"),r)})),e.build){var a=[new InJs.ModalDialogAction(this.services.localizationService.get("TopNav_HelpMenu_AboutDialog_Close"),function(e,t){o.hideDialog()})],n=t.AboutDialogTemplate.replace("{{version}}",e.build);o.showCustomDialog(null,$(n),a,null,!0)}},t.prototype.downloadIOSApp=function(){var i=this,o=this.services.telemetryService,r=this.services.errorService.control();if(this.services.localizationService.ensureLocalization((function(){t.AboutDownloadPowerBIDialogTemplate='<div class="aboutPbiDownloadDialog"><div class="title">'+i.services.localizationService.get("PowerBIDownloadMobileTxt")+'</div><div class="dialoglogo mobileLogo"></div><div class="message">'+i.services.localizationService.get("PowerBIDownloadMobileMessage")+"</div></div>"})),e.build){var a=[new InJs.ModalDialogAction(this.services.localizationService.get("TopNav_DownloadMenu_AboutDialog_SendEmail"),function(e,t){r.hideDialog(),i.sendPowerBIDownloadLink()}),new InJs.ModalDialogAction(this.services.localizationService.get("LearnMore"),function(e,t){r.hideDialog(),i.services.$window.open(downloadPageFWlink,"_blank")})],n=t.AboutDownloadPowerBIDialogTemplate;r.showCustomDialog(null,$(n),a,(function(e){e.parent().find('input[value="'+i.services.localizationService.get("LearnMore")+'"]').focus()}),!0,null,c)}o.logEvent(e.telemetry.DashboardDownloadIOSApp,"Navigation Bar");
},t.prototype.downloadAnalyzeInExcelUpdates=function(){var i=this,o=this.services.telemetryService,r=this.services.errorService.control();this.services.localizationService.ensureLocalization((function(){t.AboutDownloadPowerBIDialogTemplate='<div class="aboutPbiDownloadDialog"><div class="title">'+i.services.localizationService.get("TopNav_SettingsMenu_AnalyzeInExcelUpdates")+'</div><div class="dialoglogo analyzeInExcelLogo"></div><div class="message">'+i.services.localizationService.get("PowerBIDownloadAnalyzeInExcelMessage_Part1")+'</div><div class="message">'+i.services.localizationService.get("PowerBIDownloadAnalyzeInExcelMessage_Part2")+"</div></div>"}));var a=[new InJs.ModalDialogAction(this.services.localizationService.get("AnalyzeInExcelToast_DownloadUpdate"),function(t,a){o.logEvent(e.telemetry.DashboardAndReportsDownloadExcelUpdates,e.common.AnalyzeInExcelService.getOperatingSystemArch(),"Download Menu"),r.hideDialog(),i.services.$window.open(e.common.AnalyzeInExcelService.getDownloadLink(),"_blank")}),new InJs.ModalDialogAction(this.services.localizationService.get("LearnMore"),function(e,t){r.hideDialog(),i.services.$window.open("https://go.microsoft.com/fwlink/?LinkID=786428","_blank")})],n=t.AboutDownloadPowerBIDialogTemplate;r.showCustomDialog(null,$(n),a,null,!0,null,c)},t.prototype.sendPowerBIDownloadLink=function(){var t=this,i=e.session.UserInfoUtils.getEmailAddressForReceivingMail(),o=this.services.telemetryService.startEvent(e.telemetry.PrivacySendPowerBIEmail);this.services.userSettingsHttpService.sendEmailForDownloadPowerBI(i,o.event).then((function(e){o.resolve();var r=t.services.errorService.control(),a=t.services.localizationService.get("PowerBISendDownloadEmailTxt"),n=t.services.localizationService.format("PowerBISendDownloadEmailSubmittedTo",[i]),s=[];r.showCustomDialog(a,$("<div/>").text(n),s,null,!0)}),(function(e){o.reject()}))},t.prototype.openGeneralSettings=function(){this.services.navigation.showSettingsSlider("general")},t.prototype.openManageGateways=function(){this.services.navigation.navigateToGateways()},t.prototype.logDownloadTelemetry=function(e){var t=this.services.telemetryService;t.logEvent(e,"Navigation Bar")},t.prototype.manageStorage=function(){var t=e.telemetry.QuotaOpenManageStorageContext.Personal;this.services.groupService.activeGroup&&!this.services.groupService.activeGroup.isMyWorkspace&&(t=e.telemetry.QuotaOpenManageStorageContext.Group),this.services.telemetryService.logEvent(e.telemetry.QuotaOpenManageStoragePage,e.telemetry.QuotaOpenManageStorageInteraction.NavigatorBarManageStorage,t),this.scope.navigation.showManageStorageSlider()},t.prototype.manageEmbed=function(){this.scope.navigation.showManageEmbedSlider()},t.prototype.upgradeAccount=function(){this.services.telemetryService.logEvent(e.telemetry.OpenUpgradeAccountPage,e.telemetry.OpenUpgradeAccountInteraction.NavigatorBarManageStorage)},t.prototype.signOut=function(){var t=this.services.$window[o.liveClientIdKey];if(null!=t){var i=jsCommon.StringExtensions.format(o.liveLogoutUrl,t,location.protocol+"//"+location.host);e.common.httpService.get(i,e.common.httpService.defaultRetryRequestOptions())}},t.prototype.goToO365PowerBISites=function(){var t=this,i=this.services.notificationToast.notify({title:this.services.localizationService.get("Loading_Text"),notificationType:e.common.NotificationToastType.Loading}),o=e.common.httpService.powerbiRequestOptions();e.common.httpService.get("/powerbi/providers/excel/sharePointService",o).then((function(r){var a=r.data,n=a.resourceId,s=n.indexOf("."),c=n.substring(0,s),l=c.substring(0,c.lastIndexOf("-my"))+n.substring(s);e.common.httpService.get("powerbi/metadata/o365powerbiurl",o).then((function(o){var r=o.data+"my?";r=r+"rootsite="+encodeURIComponent(l)+"&",r=r+"mysite="+encodeURIComponent(n)+"&",r=r+"lang="+encodeURIComponent(e.common.localization.loader.currentLanguageLocale),t.services.notificationToast.hide(i),t.services.$window.open(r,"_blank")}),(function(e){t.services.notificationToast.hide(i),t.showFailedToLoadO365SitesNotification()}))}),(function(e){t.services.notificationToast.hide(i),t.showFailedToLoadO365SitesNotification()}))},t.prototype.showFailedToLoadO365SitesNotification=function(){this.services.notificationToast.notify({title:this.services.localizationService.get("TopNav_SettingsMenu_PowerBIForO365_Error"),notificationType:e.common.NotificationToastType.Error})},t.prototype.openAdminPortal=function(){this.scope.navigation.navigateToAdminPortal(0)},t.prototype.managePermissions=function(){this.services.lazy("permissionNavigation").then((function(e){return e.navigateToManagePermissions(5,null)}))},t.prototype.bindNavigationBarMenus=function(){var t=this;this.services.localizationService.ensureLocalization((function(){var o=[{text:e.session.userInfo.givenName+" "+e.session.userInfo.surname,description:e.session.userInfo.name,descriptionTitle:e.session.userInfo.name,containerClass:"userInfoContainer",itemClass:"userInfoContent",labelClass:"userName",descriptionClass:"userEmail",type:DropDownMenuItemType.Title},{text:t.services.localizationService.get("TopNav_UserInfoMenu_SignOut"),action:i.SignOut,href:"/SignOut",hrefTarget:jsCommon.DOMConstants.selfValue,type:DropDownMenuItemType.Item}],r=[{text:t.services.localizationService.get("TopNav_HelpMenu_GettingStarted"),href:"https://go.microsoft.com/fwlink/?LinkID=512054",type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_HelpMenu_Community"),href:"https://go.microsoft.com/fwlink/?LinkId=617032",type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_HelpMenu_GetHelp"),href:t.supportPageUrl,type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_HelpMenu_Developers"),href:"https://go.microsoft.com/fwlink/?LinkId=521914",type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_HelpMenu_About"),action:i.ShowAboutDialog,type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"}];t.services.asyncFeatureSwitchService.getFeatureSwitches().then((function(o){var r=[{text:t.services.localizationService.get("TopNav_SettingsMenu_PowerBICompanion"),action:i.DownloadCompanionApp,href:e.models.PowerBICompanionModel.downloadLink,type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_SettingsMenu_PowerBIGateways"),action:i.DownloadGateways,href:"https://go.microsoft.com/fwlink/?LinkId=698861",type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_SettingsMenu_MobileDownload"),action:i.DownloadIOSApp,type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"},{text:t.services.localizationService.get("TopNav_SettingsMenu_PowerBIPublisher"),action:i.DownloadExcelPublisher,href:"https://powerbi.microsoft.com/en-us/excel-dashboard-publisher/",type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"}];o.analyzeInExcelEnabled&&r.push({text:t.services.localizationService.get("TopNav_SettingsMenu_AnalyzeInExcelUpdates"),action:i.DownloadAnalyzeInExcelUpdates,type:DropDownMenuItemType.Item,dropdownItemClass:"addBorderBottom"}),t.scope.downloadMenu=r})),t.scope.helpMenu=r,t.scope.userInfoMenu=o,t.scope.navigationBarMenuItemSelected=function(e){return t.onNavigationBarMenuItemSelected(e)},t.scope.showFeedbackContextMenu=function(e){return t.showFeedbackContextMenu(e)}}))},t.prototype.onNavigationBarMenuItemSelected=function(t){switch(t.action){case i.ContactSupport:this.showSupportWidget();break;case i.DownloadIOSApp:this.downloadIOSApp();break;case i.DownloadCompanionApp:this.logDownloadTelemetry(e.telemetry.DashboardDownloadCompanionApp);break;case i.OpenGeneralSettings:this.openGeneralSettings();break;case i.DownloadGateways:this.logDownloadTelemetry(e.telemetry.DashboardDownloadGateways);break;case i.DownloadExcelPublisher:this.logDownloadTelemetry(e.telemetry.DashboardDownloadExcelPublisher);break;case i.DownloadAnalyzeInExcelUpdates:this.downloadAnalyzeInExcelUpdates();break;case i.ShowAboutDialog:this.showAboutDialog();break;case i.ManageStorage:this.manageStorage();break;case i.UpgradeAccount:this.upgradeAccount();break;case i.SignOut:this.signOut();break;case i.PublishContentPack:this.scope.navigation.showPublishContentPackSlider();break;case i.ViewContentPack:this.scope.navigation.showViewContentPackSlider();break;case i.ManageEmbed:this.manageEmbed()}this.services.overlayService.hideAllDropdowns()},t.prototype.shouldShowListView=function(){return this.services.conceptualModelSetting.isListViewEnabled()},t})();t.NavigationBarController=u})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.dataServices.constants,r=e.common.constants.TaskPaneCollapsiblePaneMode;t.dashboardDeleteConfirmationTitle="Dashboard_DeleteConfirmationTitle",t.dashboardDeleteContentPackMessage="Dashboard_DeleteOrgAppContentPack";var a;!(function(e){e[e.NavigatorPaneGetDataButton=1]="NavigatorPaneGetDataButton",e[e.NavigatorPaneAddDatasetButton=2]="NavigatorPaneAddDatasetButton"})(a=t.GetDataInteractionButton||(t.GetDataInteractionButton={}));var n;!(function(e){e[e.Group=0]="Group",e[e.Dashboard=1]="Dashboard",e[e.Report=2]="Report",e[e.Dataset=3]="Dataset"})(n=t.NavigationPaneSection||(t.NavigationPaneSection={}));var s;!(function(e){e[e.Dashboard=1]="Dashboard",e[e.Report=2]="Report",e[e.Dataset=3]="Dataset"})(s=t.DeleteContentPackMessageType||(t.DeleteContentPackMessageType={}));var c;!(function(e){e[e.DisableHomeDashboard=0]="DisableHomeDashboard"})(c=t.HomeDashboardMenuAction||(t.HomeDashboardMenuAction={}));var l;!(function(e){e[e.EditGroup=0]="EditGroup",e[e.ViewGroup=1]="ViewGroup",e[e.LeaveGroup=2]="LeaveGroup",e[e.UnpublishApp=3]="UnpublishApp"})(l=t.GroupNavigationPaneMenuAction||(t.GroupNavigationPaneMenuAction={}));var d=(function(){function t(t,i){var r=this;this.searchFilterEventDelay=1e3,this.groupLinkTypeToDisplayNameMap={},this.groupLinkTypeToLabelClassMap={},this.scope=t,this.services=i,this.scope.isPaneExpanded=this.services.applicationOptions.isE2ERun,this.scope.isDashboardsListExpanded=this.scope.isReportsListExpanded=this.scope.isDatasetsListExpanded=!0,this.scope.isGroupsListExpanded=!1,this.scope.showAddDashboardInputBox=!1,this.scope.navigatorPaneGetDataButton=a.NavigatorPaneGetDataButton,this.scope.navigatorPaneAddDatasetButton=a.NavigatorPaneAddDatasetButton,this.scope.groupSection=n.Group,this.scope.dashboardSection=n.Dashboard,this.scope.reportSection=n.Report,this.scope.groupService=this.services.groupService,this.scope.home=this.services.home,this.scope.datasetSection=n.Dataset,this.scope.reportService=this.services.reportService,this.scope.workbookService=this.services.workbookService,this.scope.modelService=this.services.modelService,this.scope.dashboardDataService=this.services.dashboardDataService,this.scope.impersonation=this.services.impersonationService,this.scope.navigation=this.services.navigation,this.scope.homeDashboardEnabled=this.services.featureSwitchService.featureSwitches.homeDashboardEnabled,this.scope.favoritesEnabled=this.services.featureSwitchService.featureSwitches.favoritesEnabled,this.createHomeContextMenu(),this.scope.isInFavoritesView=function(){return r.isInFavoritesView()},this.createOwnershipFilterContextMenu(),this.scope.homeDashboardMenuItemSelected=function(e){return r.onHomeDashboardMenuItemSelected(e)},this.scope.ownershipFilterSelected=function(e){return r.onOwnershipFilterSelected(e)},this.scope.ownershipFilterFunction=function(e){return r.ownershipFilterFunction(e)},this.services.localizationService.ensureLocalization((function(){r.scope.addDashboardPlaceholder=r.services.localizationService.get("NewDashboard_AddDashboardLabelText")})),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.Calendar]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Calendar"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.Conversations]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Conversations"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.EditGroup]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_EditGroup"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.Files]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Files"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.LeaveGroup]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_LeaveGroup"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.Members]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Members"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.Notebook]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_Notebook"),this.groupLinkTypeToDisplayNameMap[e.common.contracts.GroupLinkType.ViewGroup]=this.services.localizationService.get("GroupNavigationPaneContextMenuItem_ViewGroup"),this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.Calendar]="calendar",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.Conversations]="conversations",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.EditGroup]="editGroup",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.Files]="files",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.LeaveGroup]="leaveGroup",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.Members]="members",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.Notebook]="notebook",this.groupLinkTypeToLabelClassMap[e.common.contracts.GroupLinkType.ViewGroup]="viewGroup",this.scope.isAddDashboardInputboxFocused=!1,this.scope.switchActiveDashboard=function(e){r.services.navigation.navigateToDashboardByGUID(e)},this.services.home.onHomeSettingChanged.push((function(){r.updateHomeIconColor()})),this.scope.switchToExternalContentViewerMode=function(e){r.switchToExternalContentViewerMode(e)},this.scope.canWrite=function(){return!r.services.permissionService.isActiveWorkspaceIsReadOnly},this.scope.openModel=function(e){r.services.navigationActions.openModel(e),r.scope.isOnHome=!1},this.scope.navigateToStreamingDatasets=function(){r.services.navigation.navigateToStreamingDatasets(0)},this.scope.openReport=function(e){r.services.navigationActions.openReport(e),r.scope.isOnHome=!1},this.scope.navigateToFavorites=function(){r.services.navigation.navigateToFavorites(),r.scope.isOnHome=!1},this.scope.viewWorkbook=function(e){r.services.navigationActions.viewWorkbook(e)},this.scope.searchFilterChanged=function(){r.searchFilterPromise&&r.services.timeout.cancel(r.searchFilterPromise),r.searchFilterPromise=r.services.timeout((function(){var t=r.scope.viewModel.dashboards?r.scope.viewModel.dashboards.length:0,i=r.services.reportService.reports?r.services.reportService.reports.length:0,o=r.scope.modelService.models?r.scope.modelService.models.length:0,a=r.services.telemetryService;a.logEvent(e.telemetry.DashboardFilterNavigatorPaneItems,t,i,o),r.searchFilterPromise=null}),r.searchFilterEventDelay)},this.scope.toggleNavigationPane=function(){return r.toggleNavigationPane()},this.scope.toggleNavigationPaneSection=function(e){return r.toggleNavigationPaneSection(e)},this.scope.navigateToHome=function(){r.services.navigation.navigateToHomeDashboard(!1),r.scope.isOnHome=!0,r.searchFilter=""},this.scope.$watch("groupService.isInGroupTransition",(function(){r.scope.isDashboardsListExpanded=r.scope.isReportsListExpanded=r.scope.isDatasetsListExpanded=!r.services.groupService.isInGroupTransition})),this.scope.$watch("impersonation.impersonating",(function(){r.searchFilter="",r.scope.selectedOwnershipFilter=r.scope.ownershipFilterContextMenuItems[0]})),this.services.navigationActions.initialize(),this.services.rootScope.$on(e.constants.groupAddedUpdateContextMenuEventName,(function(e,t){e.stopPropagation();var i=r.services.groupService.getGroup(t);r.bindGroupNavigationPaneMenu(i)})),this.scope.activeAddDashboard=function(){return r.activeAddDashboard()},this.scope.addDashboard=function(e){r.scope.showAddDashboardInputBox=!1,r.services.dashboardService.addDashboard(e)},this.scope.isDashboardNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},this.scope.$on(e.common.constants.textInputOnBlurEventName,(function(e){r.scope.showAddDashboardInputBox=!1})),this.scope.reportsResourceList=function(){var t=[];t=t.concat(r.scope.reportService.copyAndEditReports),e.common.featureSwitchService.featureSwitches.fullFidelityExcelEnabled&&(t=t.concat(r.scope.workbookService.copyAndEditWorkbooks));var i=r.services.impersonationService;return i.impersonating&&(t=_.filter(t,(function(e){return e.modelId===i.getImpersonationState().modelId}))),t},this.services.appMetadataService.getAppMetadata().then((function(e){r.initializeArchivedContentLink(e),r.bindGroupNavigationPaneMenu(r.services.groupService.activeGroup)})),this.scope.switchGroup=function(e){r.scope.isGroupsListExpanded=!1,r.switchGroup(e)},this.scope.addGroup=function(){return r.addGroup()},this.scope.isListOfGroupsExpanded=!1,this.services.rootScope.$on(o.onDatasetAddedEventName,(function(e,t){var i=r.scope.viewModel.contract.models,o=!1;if(i){for(var a=i.length,n=0;n<a;n++)if(i[n].id===t.id&&i[n].packageId===t.packageId){i[n]=t,o=!0;break}o||i.push(t)}})),this.services.rootScope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,i,o,a){return r.updateHomeIconColor()}))}return t.createOptions=function(){return{additionalServices:["applicationOptions","appMetadataService","dashboardService","dashboardDataService","featureSwitchService","groupService","home","impersonationService","localizationService","modelService","navigation","navigationActions","ownership","permissionService","reportService","quota","telemetryService","userInfo","viralTenantMergeHelperService","workbookService","taskPaneSliderService","licenseEnforcementService"]}},t.prototype.isInFavoritesView=function(){return this.services.navigation.inFavoritesView()},t.prototype.createHomeContextMenu=function(){var e=[];e.push({text:this.services.localizationService.get("NavigationPane_DisableFeaturedDashboard"),action:c.DisableHomeDashboard,type:DropDownMenuItemType.Item}),this.scope.homeDashboardMenuItems=e},t.prototype.createOwnershipFilterContextMenu=function(){this.scope.ownershipFilterContextMenuItems=[{text:this.services.localizationService.get("NavigationPane_OwnershipFilterAllContent"),filter:e.models.OwnershipFilterMenuFilter.AllContent},{text:this.services.localizationService.get("NavigationPane_OwnershipFilterMyContent"),filter:e.models.OwnershipFilterMenuFilter.MyContent},{text:this.services.localizationService.get("NavigationPane_OwnershipFilterSharedWithMe"),filter:e.models.OwnershipFilterMenuFilter.SharedWithMe}],this.scope.selectedOwnershipFilter=this.scope.ownershipFilterContextMenuItems[0]},t.prototype.ownershipFilterFunction=function(t){var i=this;return function(o){switch(t){case e.models.OwnershipFilterMenuFilter.AllContent:return!0;case e.models.OwnershipFilterMenuFilter.MyContent:return!i.services.ownership.isResourceSharedWithMe(o);case e.models.OwnershipFilterMenuFilter.SharedWithMe:return i.services.ownership.isResourceSharedWithMe(o)}}},t.prototype.updateHomeIconColor=function(){this.scope.isOnHome=this.services.home.isOnHomeDashboard(this.services.navigation.currentDashboardGUID)},t.prototype.onHomeDashboardMenuItemSelected=function(e){switch(e.action){case c.DisableHomeDashboard:this.services.home.disableHomeDashboard()}},t.prototype.onOwnershipFilterSelected=function(t){this.scope.selectedOwnershipFilter=t,this.services.groupService.activeGroup.lastOwnershipFilter=t.filter,this.services.telemetryService.logEvent(e.telemetry.DashboardOwnershipFilterSelected,e.models.OwnershipFilterMenuFilter[t.filter],this.services.groupService.isMyWorkspace())},t.prototype.initializeArchivedContentLink=function(e){var t=this;this.scope.showArchivedContentLink=!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e.previousTenantId),this.scope.showArchivedContentLink&&(this.scope.viewArchivedContent=function(){t.scope.navigation.toggleArchivedContent(e.previousTenantId)})},t.prototype.activeAddDashboard=function(){this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.AddDashboard)||(this.scope.isDashboardsListExpanded=!0,this.scope.showAddDashboardInputBox||(this.scope.showAddDashboardInputBox=!0,this.scope.isAddDashboardInputboxFocused=!0))},t.prototype.switchToExternalContentViewerMode=function(t){if(!angular.isUndefined(t)&&t){var i;switch(t){case a.NavigatorPaneGetDataButton:i=e.telemetry.OpenGetDataPageInteraction.NavigatorPaneGetDataButton;break;case a.NavigatorPaneAddDatasetButton:i=e.telemetry.OpenGetDataPageInteraction.NavigatorPaneAddDatasetButton;break;default:i=null}this.services.telemetryService.logEvent(e.telemetry.DashboardOpenGetDataPage,i)}this.services.navigation.showGetDataSlider()},t.prototype.toggleNavigationPane=function(){var t=this.scope.isPaneExpanded?e.telemetry.NavPaneToggleAction.Collapse:e.telemetry.NavPaneToggleAction.Expand;this.scope.isPaneExpanded=!this.scope.isPaneExpanded,localStorage.collapseNavigation=(!this.scope.isPaneExpanded).toString(),this.services.telemetryService.logEvent(e.telemetry.DashboardExpandCollapseNavigatorPane,t),this.scope.updateWindowIfNeeded&&this.scope.updateWindowIfNeeded(),this.scope.isOnHome=this.services.home.isOnHomeDashboard(this.services.navigation.currentDashboardGUID)},t.prototype.toggleNavigationPaneSection=function(t){var i=this;switch(t){case n.Dashboard:this.toggleNavigationPaneSectionWithTelemetryEvent(this.scope.isDashboardsListExpanded,e.telemetry.NavPaneSection.Dashboards,(function(){i.scope.isDashboardsListExpanded=!i.scope.isDashboardsListExpanded}));break;case n.Report:this.toggleNavigationPaneSectionWithTelemetryEvent(this.scope.isReportsListExpanded,e.telemetry.NavPaneSection.Reports,(function(){i.scope.isReportsListExpanded=!i.scope.isReportsListExpanded}));break;case n.Dataset:this.toggleNavigationPaneSectionWithTelemetryEvent(this.scope.isDatasetsListExpanded,e.telemetry.NavPaneSection.Datasets,(function(){i.scope.isDatasetsListExpanded=!i.scope.isDatasetsListExpanded}));break;case n.Group:this.toggleNavigationPaneSectionWithTelemetryEvent(this.scope.isGroupsListExpanded,e.telemetry.NavPaneSection.Datasets,(function(){i.scope.isGroupsListExpanded=!i.scope.isGroupsListExpanded,i.scope.isListOfGroupsExpanded=!1}))}},t.prototype.toggleNavigationPaneSectionWithTelemetryEvent=function(t,i,o){var r=this.scope.viewModel.dashboards?this.scope.viewModel.dashboards.length:0,a=this.services.reportService.reports?this.services.reportService.reports.length:0,n=this.scope.modelService.models?this.scope.modelService.models.length:0,s=this.services.telemetryService.startEvent(e.telemetry.DashboardExpandCollapseNavigatorPaneSection,t?e.telemetry.NavPaneToggleAction.Collapse:e.telemetry.NavPaneToggleAction.Expand,i,r,a,n);o&&o(),s.resolve()},t.prototype.addGroup=function(){this.services.viralTenantMergeHelperService.viewingDataFromMergedViralTenant()?this.services.viralTenantMergeHelperService.displayFeatureDisabledErrorMessage("ArchivedContent_ErrorMessageGroup"):this.isGroupFeatureEnabled()?this.services.taskPaneSliderService.expandPane(r.GroupEditorCreate,i.Large):this.services.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.CreateGroups)},t.prototype.switchGroup=function(t){t.aadGroupId!==this.services.groupService.activeGroupObjectId&&(t.isMyWorkspace||this.isGroupFeatureEnabled()?(this.bindGroupNavigationPaneMenu(t),this.services.navigation.navigateToGroupByGUID(t.aadGroupId)):this.services.groupService.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.SwitchGroups))},t.prototype.isGroupFeatureEnabled=function(){return this.services.licenseEnforcementService.supportsGroups()},t.prototype.bindGroupNavigationPaneMenu=function(e){var t=e.lastOwnershipFilter;this.scope.selectedOwnershipFilter=_.find(this.scope.ownershipFilterContextMenuItems,(function(e){return e.filter===t}))},t})();t.NavigationPaneController=d})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.dataServices.constants,r=e.common.contracts.Permissions,a=e.common.constants.TaskPaneCollapsiblePaneMode,n=(function(){function n(t,i){var o=this;this.scope=t,this.services=i,this.dashboardModel=t.viewModel,this.model=new e.models.DashboardNavigationPaneListItemModel(this.dashboardModel),this.updateDashboardMetadata(),this.model.actions=n.getDashboardActions(this.scope,this.services,this.model,this.dashboardModel),this.model.icon=this.services.ownership.isResourceSharedWithMe(this.dashboardModel)?e.models.NavigationPaneListItemIcon.Shared:this.model.icon=e.models.NavigationPaneListItemIcon.None,this.scope.model=this.model,this.scope.showContextMenu=!1,this.scope.tooltipConfig={tooltipLocalizeDescription:"NavigationPane_RefreshError",tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft},this.scope.rename=function(t){o.scope.$emit(e.constants.renameDashboardEventName,t,o.scope.model.source.id)},this.scope.isContextMenuEnabled=function(){return!o.services.permissionService.isActiveWorkspaceIsReadOnly},this.scope.isNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},this.scope.$on(e.common.constants.editableLabelOnBlurEventName,(function(e){o.scope.model.isNameEditable=!1}));var r=this.services.rootScope.$on(e.constants.notifyDashboardOwnerInfoLoaded,(function(){r(),r=null,o.updateDashboardMetadata()}));this.services.rootScope.$on("$destroy",(function(){r&&r()}))}return n.createOptions=function(){return{additionalServices:["$location","navigation","localizationService","quota","groupService","featureSwitchService","permissionService","workbookService","dashboardService","ownership","taskPaneSliderService"]}},n.prototype.updateDashboardMetadata=function(){var t=this,i=this.model.metadata=[];this.dashboardModel.hasOwnerInfo()&&i.push({name:"ownerInfo",type:e.common.models.ContextMenuItemMetadataType.Link,label:this.services.localizationService.get("DashboardContextMenu_OwnedBy").toLocaleUpperCase(),linkUrl:function(){return jsCommon.StringExtensions.format("mailto:{0}",t.dashboardModel.ownerMail)},linkText:function(){return t.dashboardModel.ownerMail},value:function(){return t.dashboardModel.ownerFullname?jsCommon.StringExtensions.format("{0} -",t.dashboardModel.ownerFullname):""},linkTarget:"_self"})},n.getDashboardActions=function(s,c,l,d){var p=[];return c.localizationService.ensureLocalization((function(){p.push({text:c.localizationService.get("DashboardContextMenu_Open"),action:function(){c.navigation.navigateToDashboardByGUID(d.objectId)}});var u=(d.getPermissions()&r.ReShare)===r.ReShare;u&&p.push({text:c.localizationService.get("DashboardContextMenu_Share"),action:function(){c.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.ShareDashboard)||(c.navigation.navigateToDashboardByGUID(d.objectId),c.timeout((function(){return c.taskPaneSliderService.expandPane(a.SharingPane,i.Large)})))}}),(d.getPermissions()&r.All)===r.All||(d.getPermissions()&r.ReadWrite)===r.ReadWrite?(p.push({text:c.localizationService.get("DashboardContextMenu_Rename"),action:function(){l.isNameEditable=!0}}),p.push({text:c.localizationService.get("DashboardContextMenu_Delete"),action:function(){c.dashboardService.promptForDeleteDashboard(d.id,!0)}}),p.push({text:c.localizationService.get("DashboardContextMenu_Settings"),action:function(){c.navigation.showSettingsSlider("dashboards",d.objectId)}})):(d.getPermissions()&r.CopyOnWrite)===r.CopyOnWrite?(p.push({text:c.localizationService.get("ContextMenu_Personalize"),action:function(){s.$emit(e.constants.personalizeEventName,d.contract.originalPackageId)}}),p.push({text:c.localizationService.get("DashboardContextMenu_Delete"),action:function(){if(d.contract.modelIds[0])s.$emit(e.constants.deleteModelEventName,d.contract.modelIds[0],d.contract.originalPackageId,t.DeleteContentPackMessageType.Dashboard);else if(d.contract.workbookIds[0]){var i=c.workbookService.findWorkbook(d.contract.workbookIds[0],d.contract.originalPackageId);s.$emit(o.workbook.removeWorkbookEventName,i,t.DeleteContentPackMessageType.Dashboard)}}})):p.push({text:c.localizationService.get("DashboardContextMenu_Remove"),action:function(){c.dashboardService.promptForDeleteDashboard(d.id,!1)}});var v=c.$location.search()[n.isDasboardExportAllowedQueryString];v&&"1"===v&&p.push({text:c.localizationService.get("DashboardContextMenu_Export"),action:function(){var e=c.$location.search()[n.packageTypeString];e||(e="XMLA"),c.dashboardService.exportDashboard(d.id,e)}})})),p},n})();n.isDasboardExportAllowedQueryString="exportallowed",n.packageTypeString="packageType",t.DashboardNavigationPaneListItemController=n})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.EnumExtensions,o=e.common.dialogs.FeatureNotSupportedDialogBuilder,r=e.common.dialog.MessageDialogBuilder,a=e.common.helpers.ModelConverterHelper,n=e.common.contracts.Permissions,s=e.common.contracts.PublishOrRefreshStatus,c=(function(){function c(t,i){var o=this;this.scope=t,this.services=i,this.scope.$on("destroy",(function(){o.modalDialogPromise&&o.modalDialogPromise.pending&&o.modalDialogPromise.reject("DatasetNavigationPaneListItemController destroyed")})),this.datasetContractModel=t.viewModel,this.datasetModel=t.viewModel,this.model=new e.models.DatasetNavigationPaneListItemModel(this.datasetContractModel),this.refreshDatasetModel={},this.model.historyDialogParameters=this.services.historyDialogService.historyDialogParameters,this.scope.showHistoryDialog=function(){return o.showHistoryDialog(o.refreshDatasetModel)},this.model.metadata=this.getDatasetMetadata(this.datasetContractModel),this.datasetContractPackage=this.services.packageService.findPackage(this.datasetContractModel.packageId),this.scope.model=this.model,this.scope.showContextMenu=!1,this.scope.tooltipConfig={tooltipLocalizeDescription:"NavigationPane_RefreshError",tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft},this.scope.isRefreshInProgress=function(){return o.isRefreshInProgress()},this.scope.rename=function(t){o.scope.$emit(e.constants.renameModelEventName,t,o.scope.model.source.id,o.scope.model.source.packageId)},this.scope.isNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},this.scope.isContextMenuEnabled=function(){return o.getDatasetMetadata(o.datasetContractModel,o.model.metadata),1!==o.model.source.packagePublishStatus},this.scope.$on(e.common.constants.editableLabelOnBlurEventName,(function(e){o.scope.model.isNameEditable=!1})),this.model.icon=this.services.ownership.isResourceSharedWithMe(this.datasetContractModel)?e.models.NavigationPaneListItemIcon.Shared:this.model.icon=e.models.NavigationPaneListItemIcon.None,t.$watch((function(){return o.datasetContractModel.contract.currentRefreshStartingTime}),(function(){o.updateDatasetMetadata()})),this.scope.showRefreshErrorDialog=function(){o.showRefreshErrorDialog()},this.scope.showRefreshError=function(){return o.showRefreshError()},this.scope.showIcon=function(){return o.showIcon()},this.scope.getPackagePublishStatus=function(){return o.getPackagePublishStatus()}}return c.createOptions=function(){return{additionalServices:["refreshService","errorService","modelConverter","modelHttpService","telemetryService","localizationService","navigation","modelService","packageService","historyDialogService","featureSwitchService","insightsService","analyzeInExcel","modalDialogService","ownership","groupService","permissionService","downloadReport"]
}},c.prototype.getPackagePublishStatus=function(){var t=this.services.modelService.findModel(this.model.source.id,this.model.source.packageId);return t?t.packagePublishStatus:e.common.contracts.PublishOrRefreshStatus.FinishedSuccessfully},c.prototype.showIcon=function(){var t=this.services.modelService.findModel(this.model.source.id,this.model.source.packageId);return!!t&&(t.packagePublishStatus!==e.common.contracts.PublishOrRefreshStatus.PublishError&&t.contract.lastRefreshStatus!==e.common.contracts.PublishOrRefreshStatus.RefreshError)},c.prototype.showRefreshError=function(){var t=this.services.modelService.findModel(this.model.source.id,this.model.source.packageId);return!!t&&(t.packagePublishStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError||t.contract.lastRefreshStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError)},c.prototype.displaySuccessHistoryResult=function(e){if(!_.isEmpty(e)){var i=t.SettingsDatasetController.getFriendlyErrorMessage(e[0].serviceExceptionJson),o=this.parseAdditionalErrorInfo(e[0].serviceExceptionJson);this.services.errorService.errorNoDefaultAdditionalErrorInfo(i,"RefreshFailure",{displayableErrorInfo:o})}},c.prototype.displayErrorHistoryResult=function(){this.services.errorService.error(this.services.localizationService.get("RefreshError_Unknown"),"RefreshFailure_FailedToGetHistories")},c.prototype.processModelAndPackageRefreshHistories=function(e,t){var i=this;this.services.modelHttpService.getPackageRefreshHistories(this.datasetContractModel.packageId.toString(),e.event).then((function(o){var r;if(!t||_.isEmpty(t.data)||t.data[0].isSuccessful)r=!1;else if(_.isEmpty(o.data)||o.data[0].isSuccessful)r=!0;else{var n=a.convertRefreshTimeToJsDateTime(t.data[0].endTime).getTime(),s=a.convertRefreshTimeToJsDateTime(o.data[0].endTime).getTime();r=n>s}r?i.displaySuccessHistoryResult(t.data):i.displaySuccessHistoryResult(o.data),e.resolve()}),(function(o){t?(i.displaySuccessHistoryResult(t.data),e.resolve()):(i.displayErrorHistoryResult(),e.reject())}))},c.prototype.showRefreshErrorDialog=function(){var t=this,i=this.services.modelHttpService,o=this.services.telemetryService,r=o.startEvent(e.telemetry.DashboardGetRefreshHistoriesOnRefreshFailures);this.datasetModel.contract.lastRefreshStatus===s.RefreshError&&this.datasetModel.contract.packagePublishStatus===s.RefreshError?i.getModelRefreshHistories(this.datasetContractModel.id.toString(),r.event).then((function(e){t.processModelAndPackageRefreshHistories(r,e)}),(function(e){t.processModelAndPackageRefreshHistories(r)})):this.datasetModel.contract.lastRefreshStatus===s.RefreshError?i.getModelRefreshHistories(this.datasetContractModel.id.toString(),r.event).then((function(e){t.displaySuccessHistoryResult(e.data),r.resolve()}),(function(e){t.displayErrorHistoryResult(),r.reject()})):this.datasetModel.contract.packagePublishStatus===s.RefreshError&&i.getPackageRefreshHistories(this.datasetContractModel.packageId.toString(),r.event).then((function(e){t.displaySuccessHistoryResult(e.data),r.resolve()}),(function(e){t.displayErrorHistoryResult(),r.reject()}))},c.prototype.parseAdditionalErrorInfo=function(e){var i=t.SettingsDatasetController.convertErrorDetailsJson(e),o=[];return i.forEach((function(e){o.push({errorInfoKey:e.Name,errorInfoValue:e.Value})})),o},c.prototype.isRefreshInProgress=function(){var e=this.services.modelService.findModel(this.datasetContractModel.id,this.datasetContractModel.packageId);return!!e&&e.isRefreshInProgress},c.prototype.updateDatasetMetadata=function(){this.getDatasetMetadata(this.datasetContractModel,this.model.metadata)},c.prototype.getDatasetMetadata=function(t,i){var o=this,r=this.services.refreshService,n=this.services.modelConverter,s=this.services.localizationService,l=this.services.historyDialogService,d=[],p=function(a){t.contentProviderId=a.contentProviderId,t.onPremModelConnectionString=a.onPremModelConnectionString,t.directQueryMode=a.directQueryMode,t.currentRefreshStartingTime=a.currentRefreshStartingTime,t.refreshSchedule=a.refreshSchedule,t.refreshHistories=a.refreshHistories,t.insightsSupported=a.insightsSupported,t.storageProviderType=a.storageProviderType,d=t.onPremModelConnectionString?c.addRefreshInfoForOnPremAnalysisServicesToMetadata(i):t.directQueryMode?c.addRefreshInfoForDirectQueryModel(i):c.addRefreshStatusToMetadata(n,a,s,l,o.refreshDatasetModel,i),r.isModelRefreshInProgress(a)?c.updateMetadataValue(i,"refreshInProgress",e.common.models.ContextMenuItemMetadataType.Text,(function(){return s.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_RefreshInProgress")})):c.deleteMetadataItem(i,"refreshInProgress",e.common.models.ContextMenuItemMetadataType.Text)},u=this.services.modelService.findModel(t.id,t.packageId);return u&&(this.setMissingPropertiesOnContractModelFromPackage(u),p(u.contract),this.refreshDatasetModel.dataset=a.convertModelToDataset(u.contract),this.model.actions=this.getDatasetActions(this.datasetContractModel,this.datasetContractPackage)),d},c.prototype.setMissingPropertiesOnContractModelFromPackage=function(e){var t=this.services.packageService.findPackage(e.packageId);t&&(void 0===e.contract.storageProviderType&&(e.contract.storageProviderType=t.contract.storageProviderType),e.contract.isPackageRefreshEnabled=t.contract.IsRefreshEnabled)},c.prototype.getDatasetActions=function(o,r){var a=this,s=[];return this.services.localizationService.ensureLocalization((function(){var c=a.services.featureSwitchService,l=a.services.localizationService,d=a.services.telemetryService,p=a.services.permissionService.getModelEffectivePermissions(o.contract);if(i.hasFlag(p,n.CopyOnWrite)&&(s.push({text:l.get("ContextMenu_Personalize"),action:function(){d.logEvent(e.telemetry.DashboardClickPersonalize,o.contentProviderId),a.scope.$emit(e.constants.personalizeEventName,o.packageId)}}),s.push({text:l.get("DashboardContextMenu_Delete"),action:function(){d.logEvent(e.telemetry.DashboardDatasetClickDelete,o.contentProviderId),a.scope.$emit(e.constants.deleteModelEventName,o.id,o.packageId,t.DeleteContentPackMessageType.Dataset)}})),a.services.ownership.permissionsArePersonalized(p,r)&&s.push({text:a.services.localizationService.get("DashboardContextMenu_Delete"),action:function(){d.logEvent(e.telemetry.DashboardDatasetClickDelete,o.contentProviderId),a.scope.$emit(e.constants.deleteModelEventName,o.id,o.packageId)}}),i.hasFlag(p,n.All)&&(s.push({text:l.get("DashboardContextMenu_Rename"),action:function(){d.logEvent(e.telemetry.DashboardDatasetClickRename,o.contentProviderId),a.model.isNameEditable=!0}}),s.push({text:l.get("DashboardContextMenu_Delete"),action:function(){d.logEvent(e.telemetry.DashboardDatasetClickDelete,o.contentProviderId),a.scope.$emit(e.constants.deleteModelEventName,o.id,o.packageId)}}),a.datasetContractModel.contract.onPremModelConnectionString||s.push({text:a.datasetContractModel.contract.directQueryMode?l.get("DashboardContextMenu_DatasetSettings"):l.get("DashboardContextMenu_ManageRefresh"),action:function(){a.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickScheduleRefresh,o.contentProviderId),a.services.navigation.showSettingsSlider("datasets",o.dbName)}}),s.push({text:l.get("DashboardContextMenu_RefreshNow"),action:function(){d.logEvent(e.telemetry.DashboardDatasetClickRefreshNow,o.contentProviderId),a.services.refreshService.tryRefreshNow(a.services.telemetryService,a.services.errorService,o,"datasets")}})),c&&(a.services.analyzeInExcel.isAnalyzeInExcelSupported(c,p)&&s.push({text:l.get("DashboardContextMenu_AnalyzeInExcel"),action:function(){var t=a.services.modelService.findModel(o.id,o.packageId);a.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsAnalyzeInExcel,"Dataset Navigation Pane List",t.contentProviderId,t.contract.modelFeatures,t.dbName),a.services.analyzeInExcel.startAnalyzeInExcel(t)}}),o.contract.insightsSupported&&i.hasFlag(p,n.Read)&&s.push({text:a.getInsightsText(),action:function(){d.logEvent(e.telemetry.DashboardDatasetClickInsights,o.contentProviderId),a.scope.$emit(e.constants.showInsightsEventName,o.id,o.packageId)},descriptor:e.constants.insightsDescriptor}),o.contentProviderId===e.common.constants.pbiDesktopContentProviderId&&_.isEmpty(o.contract.onPremModelConnectionString)&&i.hasFlag(p,n.All)&&a.services.featureSwitchService.featureSwitches.datasetDownloadPbix&&s.push({text:l.get("DashboardContextMenu_DownloadDataset"),action:function(){a.services.downloadReport.downloadModel({id:o.id.toString(),filename:o.displayName})}}),i.hasFlag(p,n.All)&&(6===o.contentProviderId||7===o.contentProviderId)&&!o.contract.onPremModelConnectionString)){var u=a.services.groupService.activeGroup;(u.isMyWorkspace||u.contract.isOwner||!u.contract.isReadOnly)&&s.push({text:l.get("DashboardContextMenu_GranularSecurity"),action:function(){6===o.contentProviderId?a.cloudRlsNotSupportedDialog():o.contract.lastRefreshStatus===e.common.contracts.PublishOrRefreshStatus.RefreshInProgress||o.packagePublishStatus===e.common.contracts.PublishOrRefreshStatus.PublishInProgress?a.showRefreshInProgressDialog():a.services.navigation.showRowLevelSecuritySlider(o.id)}})}})),s},c.prototype.cloudRlsNotSupportedDialog=function(){this.modalDialogPromise=new o(this.services.modalDialogService).show("ModalDialog_CloudRlsUnSupportedTypeTitle","ModalDialog_CloudRlsUnSupportedTypeMessage","https://go.microsoft.com/fwlink/?LinkID=733530")},c.prototype.showRefreshInProgressDialog=function(){this.modalDialogPromise=new r(this.services.modalDialogService).show("RefreshInProgress",{titleText:this.services.localizationService.get("ModalDialog_CloudRlsDataRefreshTitle"),messageText:this.services.localizationService.get("ModalDialog_CloudRlsDataRefreshMessage"),okButtonText:this.services.localizationService.get("PBI_Button_Label_Close"),hideCancelButton:!0})},c.prototype.getInsightsText=function(){var e,t=this.services.insightsService.getInsightsStatus(this.datasetModel.contract);switch(t){case 2:e=this.services.localizationService.get("DashboardContextMenu_ViewInsights");break;case 1:e=this.services.localizationService.get("DashboardContextMenu_GettingInsights");break;default:e=this.services.localizationService.get("DashboardContextMenu_GetInsights")}return e},c.prototype.showHistoryDialog=function(e){this.services.historyDialogService.showHistoryDialog(e)},c.addRefreshStatusToMetadata=function(t,i,o,r,n,l){var d,p,u,v=[],h=a.convertRefreshTimeToJsDateTime(i.lastRefreshTime),g=!1;i.lastRefreshStatus===s.RefreshError?(d=e.common.models.ContextMenuItemMetadataType.Action,u=o.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshFailed",[""]),p=""+h,g=!0):i.lastRefreshStatus===s.PublishError?(d=e.common.models.ContextMenuItemMetadataType.Action,u="",p=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastPackagePublishFailed")):(d=e.common.models.ContextMenuItemMetadataType.Text,u=o.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshSucceeded",[""]),p=""+h),v.push({name:"lastRefreshStatus",type:d,label:u.toLocaleUpperCase(),isWarning:g,value:function(){return p},actionOnClick:function(){r.showHistoryDialog(n)},actionText:function(){return p}}),c.updateMetadataValue(l,"lastRefreshStatus",d,(function(){return p}),g,void 0,void 0,void 0,(function(){r.showHistoryDialog(n)}),void 0,u.toLocaleUpperCase());var m=c.isModelScheduledRefreshEnabled(i),f=c.doesStorageSourceAllowRefresh(i),y=c.isStorageSourceRefreshEnabled(i);if(f)if(y&&m){var b=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NextRefresh")+a.convertRefreshTimeToJsDateTime(i.nextRefreshTime);c.showNextRefresh(b,v,l)}else if(!y&&m){var b=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NotOneDriveNextScheduled")+a.convertRefreshTimeToJsDateTime(i.nextRefreshTime);c.showNextRefresh(b,v,l)}else if(y&&!m){var b=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_OneDriveEnabledRefreshNotEnabled");c.showRefreshDisabled(b,v,l)}else{var b=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NotOneDriveAndScheduleRefreshNotEnabled");c.showRefreshDisabled(b,v,l)}else if(m){var b=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_NextRefresh")+a.convertRefreshTimeToJsDateTime(i.nextRefreshTime);c.showNextRefresh(b,v,l)}else{var b=o.get("SettingsDataset_ScheduleRefresh_FlyoutMessage_RefreshNotEnabled");c.showRefreshDisabled(b,v,l)}return v},c.getNextRefreshTimeName=function(){var e="nextRefreshTime";return e},c.getRefreshScheduleNotSetupName=function(){var e="refreshScheduleNotSetUp";return e},c.showNextRefresh=function(t,i,o){var r=c.getNextRefreshTimeName();c.deleteMetadataItem(o,"refreshScheduleNotSetUp",e.common.models.ContextMenuItemMetadataType.Text),i.push({name:r,type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return t}}),c.updateMetadataValue(o,r,e.common.models.ContextMenuItemMetadataType.Text,(function(){return t})),c.deleteMetadataItem(o,c.getRefreshScheduleNotSetupName(),e.common.models.ContextMenuItemMetadataType.Text)},c.showRefreshDisabled=function(t,i,o){var r=c.getRefreshScheduleNotSetupName();c.deleteMetadataItem(o,c.getNextRefreshTimeName(),e.common.models.ContextMenuItemMetadataType.Text),i.push({name:r,type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return t}}),c.updateMetadataValue(o,r,e.common.models.ContextMenuItemMetadataType.Text,(function(){return t}))},c.isModelScheduledRefreshEnabled=function(t){return t.refreshSchedule.refreshEnabled!==!1&&(t.contentProviderId===e.controllers.ContentProviderIds.salesforce||t.isAllDataSourcesSupportedForRefresh!==!1)},c.doesStorageSourceAllowRefresh=function(t){return t.storageProviderType===e.common.contracts.StorageProviderType.OneDrive||t.storageProviderType===e.common.contracts.StorageProviderType.SharePoint},c.isStorageSourceRefreshEnabled=function(e){return e.isPackageRefreshEnabled},c.addRefreshInfoForOnPremAnalysisServicesToMetadata=function(t){var i=[],o=e.common.localize.get("SettingsDataset_DisableEntireRefreshPageErrorMessage_OnPremAnalysisServicesScheduleInfo");return i.push({name:"OnPremASRefreshInfo",type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return o}}),c.updateMetadataValue(t,"OnPremASRefreshInfo",e.common.models.ContextMenuItemMetadataType.Text,(function(){return o})),i},c.addRefreshInfoForDirectQueryModel=function(t){var i=[],o=e.common.localize.get("SettingsDataset_DisableEntireRefreshPageErrorMessage_DirectQueryScheduleInfo");return i.push({name:"DirectQueryRefreshInfo",type:e.common.models.ContextMenuItemMetadataType.Text,value:function(){return o}}),c.updateMetadataValue(t,"DirectQueryRefreshInfo",e.common.models.ContextMenuItemMetadataType.Text,(function(){return o})),i},c.updateMetadataValue=function(e,t,i,o,r,a,n,s,c,l,d){if(void 0===r&&(r=!1),e){for(var p=void 0,u=0,v=e.length;u<v;u++){var h=e[u];if(h.name===t){p=h;break}}p?(p.value=o,p.isWarning=r,p.linkText=a,p.linkUrl=n,p.linkTitle=s,p.actionOnClick=c,p.type=i,p.infoTooltipConfig=l,p.label=d):e.push({name:t,type:i,value:o,linkText:a,linkUrl:n,linkTitle:s,linkTarget:"_blank",actionOnClick:c,isWarning:r,infoTooltipConfig:l,label:d})}},c.deleteMetadataItem=function(e,t,i){if(e){for(var o=void 0,r=0,a=e.length;r<a;r++){var n=e[r];if(n.name===t&&n.type===i){o=r;break}}o&&e.splice(o,1)}},c})();t.DatasetNavigationPaneListItemController=c})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){this.scope=t,this.services=i,this.groupModel=t.viewModel,this.model=new e.models.GroupNavigationPaneListItemModel(this.groupModel),this.scope.model=this.model,this.scope.showContextMenu=!1,this.scope.tooltipConfig={tooltipLocalizeDescription:"NavigationPane_RefreshError",tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft},this.scope.isNameValid=function(e){return _.isEmpty(e)},this.scope.isContextMenuEnabled=function(){return!1},this.services.userInfo.getUserPhoto().then((function(e){t.userPhoto=e}))}return t.createOptions=function(){return{additionalServices:["navigation","localizationService","userInfo"]}},t})();t.GroupNavigationPaneListItemController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(t,i){var o=this;this.scope=t,this.services=i;var r=t.viewModel;this.reportContract=r.contract,this.model=new e.models.ReportNavigationPaneListItemModel(r),this.model.actions=this.getReportActions(this.reportContract),this.scope.model=this.model,this.scope.showContextMenu=!1,this.scope.tooltipConfig={tooltipLocalizeDescription:"NavigationPane_RefreshError",tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft},this.scope.rename=function(e){o.services.reportService.renameReport(e,o.scope.model.source.id)},this.scope.isNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},this.scope.isContextMenuEnabled=function(){return!o.services.permissionService.isActiveWorkspaceIsReadOnly&&o.model.source.packagePublishStatus!==e.common.contracts.PublishOrRefreshStatus.PublishInProgress},this.scope.$on(e.common.constants.editableLabelOnBlurEventName,(function(e){o.scope.model.isNameEditable=!1}))}return i.createOptions=function(){return{additionalServices:["localizationService","reportService","permissionService","featureSwitchService","modelService","analyzeInExcel","telemetryService"]}},i.prototype.getReportActions=function(i){var o=this,r=[];return this.services.localizationService.ensureLocalization((function(){var a=o.services.featureSwitchService;r.push({text:o.services.localizationService.get("DashboardContextMenu_Open"),action:function(){o.scope.$emit(e.constants.openReportEventName,i.id)}}),(i.permissions&e.common.models.ReportPermissions.All)===e.common.models.ReportPermissions.All||(i.permissions&e.common.models.ReportPermissions.Personalized)===e.common.models.ReportPermissions.Personalized?(r.push({text:o.services.localizationService.get("DashboardContextMenu_Rename"),action:function(){o.model.isNameEditable=!0}}),r.push({text:o.services.localizationService.get("DashboardContextMenu_Delete"),action:function(){o.scope.$emit(e.constants.deleteReportEventName,i.id)}})):(i.permissions&e.common.models.ReportPermissions.CopyOnWrite)===e.common.models.ReportPermissions.CopyOnWrite&&(r.push({text:o.services.localizationService.get("ContextMenu_Personalize"),action:function(){o.scope.$emit(e.constants.personalizeEventName,i.packageId)}}),r.push({text:o.services.localizationService.get("DashboardContextMenu_Delete"),action:function(){o.scope.$emit(e.constants.deleteModelEventName,i.modelId,i.packageId,t.DeleteContentPackMessageType.Report)}})),a&&o.services.analyzeInExcel.isAnalyzeInExcelSupported(a,i.permissions)&&r.push({text:o.services.localizationService.get("DashboardContextMenu_AnalyzeInExcel"),action:function(){var t=o.services.modelService.findModel(i.modelId,i.packageId);o.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsAnalyzeInExcel,"Report Navigation Pane List",t.contentProviderId,t.contract.modelFeatures,t.dbName),o.services.analyzeInExcel.startAnalyzeInExcel(t)}})})),r},i})();t.ReportNavigationPaneListItemController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.EnumExtensions,o=e.common.helpers.ModelConverterHelper,r=e.common.contracts.Permissions,a=e.common.models.ContextMenuItemMetadataType,n=e.dataServices.constants,s=(function(){function s(t,i){var o=this;this.scope=t,this.services=i,this.workbookModel=t.viewModel,this.model=new e.models.WorkbookNavigationPaneListItemModel(this.workbookModel),this.refreshDatasetModel={},this.model.historyDialogParameters=this.services.historyDialogService.historyDialogParameters,this.scope.showHistoryDialog=function(){return o.showHistoryDialog(o.refreshDatasetModel)},this.model.metadata=this.getWorkbookMetadata(this.workbookModel),this.model.actions=this.getWorkbookActions(this.workbookModel),this.scope.model=this.model,this.scope.showContextMenu=!1,this.scope.isRefreshInProgress=function(){return o.isRefreshInProgress()},this.scope.tooltipConfig={tooltipLocalizeDescription:"NavigationPane_RefreshError",tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft},this.scope.rename=function(e){o.services.workbookService.renameWorkbook(e,o.scope.model.source.id,o.scope.model.source.packageId)},this.scope.isNameValid=function(e){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)},this.scope.isContextMenuEnabled=function(){return o.getWorkbookMetadata(o.workbookModel,o.model.metadata),!o.services.permissionService.isActiveWorkspaceIsReadOnly},this.scope.$on(e.common.constants.editableLabelOnBlurEventName,(function(e){o.scope.model.isNameEditable=!1})),this.services.rootScope.$on(n.workbook.openWorkbookContextMenuEventName,(function(e,t){t.id===o.model.source.id&&t.packageId===o.model.source.packageId&&(o.getWorkbookMetadata(o.workbookModel,o.model.metadata),o.scope.showContextMenu=!0)})),this.model.icon=this.workbookModel.isOwner()?e.models.NavigationPaneListItemIcon.Workbook:e.models.NavigationPaneListItemIcon.Shared,this.scope.showRefreshError=function(){return o.showRefreshError()},this.scope.showIcon=function(){return o.showIcon()},this.scope.getPackagePublishStatus=function(){return o.getPackagePublishStatus()}}return s.createOptions=function(){return{additionalServices:["refreshService","errorService","telemetryService","localizationService","workbookService","modelService","packageService","historyDialogService","featureSwitchService","ownership","permissionService"]}},s.prototype.getPackagePublishStatus=function(){if(!this.workbookModel.modelId)return e.common.contracts.PublishOrRefreshStatus.FinishedSuccessfully;var t=this.services.modelService.findModel(this.workbookModel.modelId,this.workbookModel.packageId);return t?t.packagePublishStatus:e.common.contracts.PublishOrRefreshStatus.FinishedSuccessfully},s.prototype.showRefreshError=function(){if(!this.workbookModel.modelId)return!1;var t=this.services.modelService.findModel(this.workbookModel.modelId,this.workbookModel.packageId);return!!t&&(t.packagePublishStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError||t.contract.lastRefreshStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError)},s.prototype.showIcon=function(){if(!this.workbookModel.modelId)return!0;var t=this.services.modelService.findModel(this.workbookModel.modelId,this.workbookModel.packageId);return!t||t.packagePublishStatus!==e.common.contracts.PublishOrRefreshStatus.PublishError&&t.contract.lastRefreshStatus!==e.common.contracts.PublishOrRefreshStatus.RefreshError},s.prototype.isRefreshInProgress=function(){if(this.workbookModel.packageId){var t=this.services.packageService.findPackage(this.workbookModel.packageId);if(t&&t.publishOrRefreshStatus===e.common.contracts.PublishOrRefreshStatus.RefreshInProgress)return!0}if(this.workbookModel.modelId){var i=this.services.modelService.findModel(this.workbookModel.modelId,this.workbookModel.packageId);if(i&&i.isRefreshInProgress)return!0}return!1},s.prototype.getWorkbookMetadata=function(e,i){var r=this,n=this.services.localizationService,c=this.services.historyDialogService,l=[],d=this.services.workbookService.findWorkbook(e.id,e.packageId);if(this.services.packageService.isLocalWorkbook(this.workbookModel.packageId)){l=l.concat(s.addExcelLocalFileInfo("WorkbookContextMenu_LocalFileName",i,"localFileName",a.Text,this.workbookModel.contract.sourceFilePath)),l=l.concat(s.addExcelLocalFileInfo("WorkbookContextMenu_Source",i,"FileSource",a.Text,this.services.localizationService.get("WorkbookContextMenu_Source_LocalFile")));var p=this.services.packageService.findPackage(this.workbookModel.packageId);if(p){var u=""+o.convertRefreshTimeToJsDateTime(p.lastRefreshTime);l=l.concat(s.addExcelLocalFileInfo("WorkbookContextMenu_LocalFile_LastUpdateTime",i,"localFileLastUpdated",a.Text,u))}return l}d.contract.sourceFilePath&&(l=l.concat(s.addSpoFileName(d.contract.sourceFilePath,d.viewUrl,i))),d.isOwner()&&(l=l.concat(s.addExcelLocalFileInfo("WorkbookContextMenu_Source",i,"FileSource",a.Text,this.services.localizationService.get("WorkbookContextMenu_Source_SharePointOneDrive"))));var v=this.services.modelService.findModel(this.workbookModel.modelId,this.workbookModel.packageId);if(!v){var p=this.services.packageService.findPackage(this.workbookModel.packageId);return p&&(l=l.concat(s.addLastRefreshForNonModelWorkbook(p.lastRefreshTime,i))),l}if(!this.workbookModel.contract.isPowerPivotVersionSupportsRefresh)return l=s.addRefreshInfoForNotSupportedModelWorkbook(i);var h=v.contract,g=function(e){h.contentProviderId=e.contentProviderId,h.onPremModelConnectionString=e.onPremModelConnectionString,h.directQueryMode=e.directQueryMode,h.refreshSchedule=e.refreshSchedule,h.refreshHistories=e.refreshHistories,h.storageProviderType=e.storageProviderType,l=l.concat(t.DatasetNavigationPaneListItemController.addRefreshStatusToMetadata(null,e,n,c,r.refreshDatasetModel,i))};return g(h),this.refreshDatasetModel.dataset=o.convertModelToDataset(h),l},s.prototype.showHistoryDialog=function(e){this.services.historyDialogService.showHistoryDialog(e)},s.prototype.getWorkbookActions=function(t){var o=this,a=[],s=this.services.localizationService.get("WorkbookContextMenu_View"),c=this.services.workbookService.findWorkbook(t.id,t.packageId);return this.services.localizationService.ensureLocalization((function(){var l=c.getPermissions();c.isOwner()?(o.services.featureSwitchService.featureSwitches.embedFullFidelityWorkbooks?a.push({text:s,action:function(){o.scope.$emit(n.workbook.viewWorkbookEventName,t.id,t.packageId)}}):a.push({text:s,link:c.viewUrl,action:function(){o.services.telemetryService.logEvent(e.telemetry.DashboardViewWorkbook,c.contract.etagHash,l,o.services.packageService.getWorkbookStorageProvider(c.packageId),o.services.packageService.getWorkbookContentProvider(c.packageId))}}),c.isEditable()&&a.push({text:o.services.localizationService.get("WorkbookContextMenu_Edit"),link:c.editUrl,action:function(){o.services.telemetryService.logEvent(e.telemetry.DashboardEditWorkbook,c.contract.etagHash)}}),a.push({text:o.services.localizationService.get("WorkbookContextMenu_Rename"),action:function(){o.model.isNameEditable=!0}}),o.services.packageService.isLocalWorkbook(c.packageId)&&a.push({text:o.services.localizationService.get("WorkbookContextMenu_Replace"),action:function(){o.scope.$emit(e.constants.replaceLocalWorkbookEventName,c.uniqueId)}}),o.services.packageService.isScheduleRefreshEnabledForWorkbook(c)&&a.push({text:o.services.localizationService.get("WorkbookContextMenu_ScheduleRefresh"),action:function(){var t=o.services.modelService.findModel(c.modelId,c.packageId);t&&(o.services.telemetryService.logEvent(e.telemetry.DashboardWorkbookClickScheduleRefresh,t.contentProviderId),o.services.rootScope.$emit(e.common.constants.showSettingsViewerEventName,"workbooks",t.dbName))}}),o.services.packageService.isRefreshNowEnabledForWorkbook(c)&&a.push({text:o.services.localizationService.get("WorkbookContextMenu_RefreshNow"),action:function(){var t=o.services.modelService.findModel(c.modelId,c.packageId);t&&(o.services.telemetryService.logEvent(e.telemetry.DashboardWorkbookClickRefreshNow,t.contentProviderId),o.services.refreshService.tryRefreshNow(o.services.telemetryService,o.services.errorService,t,"workbooks"))}}),a.push({text:o.services.localizationService.get("WorkbookContextMenu_Remove"),action:function(){o.scope.$emit(n.workbook.removeWorkbookEventName,t)}})):(i.hasFlag(l,r.CopyOnWrite)&&a.push({text:o.services.localizationService.get("ContextMenu_Personalize"),action:function(){o.services.telemetryService.logEvent(e.telemetry.DashboardClickPersonalize,c.contentProviderId),o.scope.$emit(e.constants.personalizeEventName,c.packageId)}}),o.services.featureSwitchService.featureSwitches.embedFullFidelityWorkbooks?a.push({text:s,action:function(){o.scope.$emit(n.workbook.viewWorkbookEventName,t.id,t.packageId)}}):a.push({text:s,link:c.viewUrl,action:function(){o.services.telemetryService.logEvent(e.telemetry.DashboardViewWorkbook,c.contract.etagHash,l,o.services.packageService.getWorkbookStorageProvider(c.packageId),o.services.packageService.getWorkbookContentProvider(c.packageId))}}),a.push({text:o.services.localizationService.get("WorkbookContextMenu_Remove"),action:function(){o.scope.$emit(n.workbook.removeWorkbookEventName,c)}}))})),a},s.addLastRefreshForNonModelWorkbook=function(t,i){var r=o.convertRefreshTimeToJsDateTime(t),a=e.common.localize.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshSucceeded",[""]);return s.addInfoForWorkbook("WorkbookIsUpToDate",""+r,i,null,a.toLocaleUpperCase())},s.addRefreshInfoForNotSupportedModelWorkbook=function(t){var i=e.common.localize.get("WorkbookContextMenu_NotSupportedModel_RefreshNotSupported");return s.addInfoForWorkbook("WorkbookIsUpToDate",i,t)},s.addExcelLocalFileInfo=function(t,i,o,r,a){var n;return a?(n=e.common.localize.format(t,[""]),s.addInfoForWorkbook(o,a,i,r,n.toLocaleUpperCase())):(n=e.common.localize.get(t),s.addInfoForWorkbook(o,n,i,r))},s.addInfoForWorkbook=function(e,i,o,r,n){var s=[];return s.push({name:e,type:a.Text,label:n,value:function(){return i},infoToolTipConfig:r}),t.DatasetNavigationPaneListItemController.updateMetadataValue(o,e,a.Text,(function(){return i}),null,null,null,null,null,r,n),s},s.addSpoFileName=function(i,o,r){var a=[],n=e.common.localize.get("WorkbookContextMenu_SpoFileName"),s=i.substring(i.lastIndexOf("/")+1);return a.push({name:"spoFileNameAndLink",type:e.common.models.ContextMenuItemMetadataType.Link,value:function(){return""},label:n.toLocaleUpperCase(),linkText:function(){return s},linkUrl:function(){return o},linkTitle:function(){return i},linkTarget:"_blank"}),t.DatasetNavigationPaneListItemController.updateMetadataValue(r,"spoFileNameAndLink",e.common.models.ContextMenuItemMetadataType.Link,(function(){return""}),!1,(function(){return s}),(function(){return o}),(function(){return i}),void 0,void 0,n.toLocaleUpperCase()),a},s})();t.WorkbookNavigationPaneListItemController=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.constants.nps,o=jsCommon.QueryStringUtil,r=(function(){function t(t,r){var a=this;if(this.appLoadedWaitInterval=3e4,this.services=r,this.scope=t,this.listener=function(e){return a.receiveMessage(e)},this.scope.initListener=function(){return a.services.$window.addEventListener("message",a.listener)},this.scope.$on("$destroy",(function(){a.destroyIframeListener()})),"undefined"!=typeof npsUrlOrigin&&(this.redirectRoot=npsUrlOrigin,this.redirectRoot)){var n=e.session.userInfo.puid,s=this.redirectRoot+i.renderPath,c={};c[i.languageParam]=this.services.localizationService.currentLanguageLocale,c[i.puidParam]=n;var l=this.redirectRoot+i.displayPath,d={};d[i.puidParam]=n,this.scope.renderUrl=o.addOrUpdateQueryStringToUrl(s,c);var p=o.addOrUpdateQueryStringToUrl(l,d);this.services.applicationOptions.isE2ERun||this.services.appMetadataService.getAppMetadata().then((function(){a.services.$timeout((function(){e.npsHttpService.showNpsDialog(p).then((function(t){if(t&&t.data){var i=t.data;if(i.display){if(a.services.fullScreen.fullScreenMode)return;a.services.telemetryService.logEvent(e.telemetry.NPSShowDialog),a.scope.connectToNps()}}}))}),a.appLoadedWaitInterval)}))}}return t.createOptions=function(){return{additionalServices:["$window","$timeout","localizationService","appMetadataService","applicationOptions","fullScreen","telemetryService"]}},t.prototype.destroyIframeListener=function(){this.services.$window.removeEventListener("message",this.listener),this.scope.closeNpsHostIframe()},t.prototype.receiveMessage=function(e){if(e&&e.origin&&!(this.redirectRoot.indexOf(e.origin)<0)){var t=e.data;t&&t.msgType&&(t.msgType===i.closeNpsDialog?this.destroyIframeListener():t.msgType===i.resizeNpsDialog&&this.scope.resizeNpsHostIframe())}},t})();t.NpsHostController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));
var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){var i=this;this.scope=e,this.services=t,this.scope.getApplicationLauncher=function(){return i.getApplicationLauncher()},this.scope.showAppLauncherContainer=!1,this.scope.loadingAppLauncher=!1,this.scope.loadingError=!1,this.scope.oldStyleAppLauncher=!0,this.scope.o365NavigationBarData=null}return e.createOptions=function(){return{additionalServices:["o365ApplicationLauncherService"]}},e.prototype.getApplicationLauncher=function(){var e=this;null!==this.scope.o365NavigationBarData||this.scope.loadingAppLauncher||(this.scope.loadingError=!1,this.scope.loadingAppLauncher=!0,this.services.o365ApplicationLauncherService.getApplicationLauncher().then((function(t){var i=$("<link rel='stylesheet' type='text/css' href='"+t.data.cssUrl+"'>");$("head").append(i),$.getScript(t.data.jsUrl,(function(){var i=$.parseJSON(t.data.navBarDataJson);e.scope.$applyAsync((function(){e.scope.oldStyleAppLauncher=i.FlightName.indexOf("ShellNewAppLauncher")===-1})),O365Shell.SetData(i),O365Shell.RenderAsync({launcher:"o365AppLauncherContent"},_.noop,_.noop)})),e.scope.o365NavigationBarData=t,e.scope.loadingAppLauncher=!1}),(function(t){e.scope.loadingAppLauncher=!1,e.scope.loadingError=!0})))},e})();e.O365ApplicationLauncherController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.DashboardUtils,o=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.scope.dashboardDataService=i.dashboardDataService,this.scope.pin=function(){return o.pin()},this.scope.cancel=function(){return o.cancel()},this.scope.saveAndContinue=function(){return o.saveAndContinue()},this.scope.isDashboardPinnable=function(e){return o.isDashboardPinnable(e)},this.scope.noPinnableDashboard=function(){return o.noPinnableDashboard()},this.scope.getDefaultSelectedDashboardId=function(){return o.getDefaultSelectedDashboardId()},this.scope.getSortedPinnableDashboards=function(){return o.getSortedPinnableDashboards()},this.scope.getDashboards=function(){return o.getDashboards()},this.scope.updateFormatting=function(){return o.updateFormatting()},this.scope.isLiveReport=this.services.pinTileService.isLiveReport,this.scope.pinButtonText=this.scope.isLiveReport?this.services.localizationService.get("PinLiveReport_PinLive"):this.services.localizationService.get("ReportContainer_Pin"),this.scope.viewModel.isPinned=!1,this.updateView();var r=this.scope.viewModel;r.useExistingDashboard=!0,this.services.userSettingsService.getUserSettings().then((function(t){r.useDashboardFormatting=null==t.tileDialogPreviewFormat||t.tileDialogPreviewFormat===e.contracts.TileDialogPreviewFormats.DashboardFormat,o.updateFormatting()})),this.scope.$watch("dashboardDataService.dashboards.length",(function(){o.updateView()}))}return t.createOptions=function(){return{additionalServices:["dashboardDataService","pinTileService","localizationService","userSettingsService"],scopedServiceRoot:!0}},t.prototype.updateView=function(){this.sortedPinnableDashboards=this.getSortedPinnableDashboards(),this.scope.viewModel.selectedDashboardId=this.getDefaultSelectedDashboardId()},t.prototype.pin=function(){this.scope.viewModel.isPinned=!0,this.services.pinTileService.onPinButtonClickedActions()},t.prototype.saveAndContinue=function(){this.scope.viewModel.needSaveReport&&this.services.pinTileService.onSaveAndContinueButtonClickedActions()},t.prototype.cancel=function(){this.services.pinTileService.hideDialog()},t.prototype.updateFormatting=function(){this.services.pinTileService.updateTile(this.scope.viewModel.useDashboardFormatting)},t.prototype.isDashboardPinnable=function(e){if(e.contract){var t=i.isWriteable(e.contract),o=this.services.dashboardDataService.activeDashboard;return this.services.pinTileService.isPinFromDashboard&&o?t&&e.id!==o.id:t}return!1},t.prototype.getDefaultSelectedDashboardId=function(){var e=this.services.dashboardDataService.activeDashboard;if(!this.services.pinTileService.isPinFromDashboard&&e&&this.isDashboardPinnable(e))return e.id.toString();var t=this.sortedPinnableDashboards;return t.length>0?t[0].id.toString():null},t.prototype.noPinnableDashboard=function(){return 0===this.sortedPinnableDashboards.length&&(this.scope.viewModel.useExistingDashboard=!1,!0)},t.prototype.getSortedPinnableDashboards=function(){var e=this.services.dashboardDataService.activeDashboard,t=this.services.dashboardDataService.dashboards,o=_.sortBy(_.filter(t,(function(e){return i.isWriteable(e.contract)})),(function(e){return e.displayName.toLowerCase()}));return this.services.pinTileService.isPinFromDashboard&&e&&_.pull(o,e),o},t.prototype.getDashboards=function(){return this.services.dashboardDataService.dashboards},t})();t.PinTileDialogController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.helpers.ContentPackAuthoringHelper,o=e.common.controllers.EmailsList,r=e.common.models.EmailsListModel,a=e.dialog.IntroduceAppDialogBuilder,n=e.common.contracts.Permissions,s=(function(){function t(t,i){var a=this;this.scope=t,this.services=i,this.element=this.services.$element,this.scope.setDefaultImage=function(){return a.setDefaultImage(!0)},this.scope.publishContentPack=function(){return a.publishContentPack()},this.scope.toggleDashboard=function(e){return a.toggleDashboard(e)},this.scope.toggleReport=function(e){return a.toggleReport(e)},this.scope.toggleWorkbook=function(e){return a.toggleWorkbook(e)},this.scope.enableUpdateButton=function(){return a.enableUpdateButton()},this.scope.onContentPackChanged=function(){return a.onContentPackChanged()},this.scope.cancelPublishContentPack=function(){return a.cancelPublishContentPack()},this.scope.validateImageUploaded=function(e){return a.validateImageUploaded(e)},this.scope.imageThumbView="",this.scope.isIconUpdated=!0,this.scope.isLegacyReport=function(e){return a.isLegacyReport(e)},this.scope.dashboardHasLegacyReport=function(e){return a.dashboardHasLegacyReport(e)},this.scope.canDashboardBeAdded=function(e){return a.canDashboardBeAdded(e)},this.scope.getWorkookPermissionsMessageType=function(){return a.getWorkookPermissionsMessageType()},this.scope.getLocalizedTemplatizeModelToolTip=function(){return a.getLocalizedTemplatizeModelToolTip()};var n=this.scope.viewModel;n.hasTitleValidationError=!1,n.hasNoItemsSelected=!1,n.hasDescriptionValidationError=!1,n.hasGroupsValidationError=!1,n.isPublishOrUpdateError=!1,n.hasImageValidationError=!1,n.hasTemplatePublishError=!1,n.providerKey="",n.emailsList=new r,n.userGroupHeader=new e.models.UserGroupHeaderModel,n.isTemplate=!1,this.getSettingsMetadata(),this.updateView(),this.clearContents();var s=this.services.navigation.contentPack;this.services.contentPackService.findContentPack(s).then((function(e){if(a.scope.updateContentPack=e,a.scope.updateContentPack){if(a.scope.$watch("viewModel.emailsList.isDirty",(function(e){e&&(n.isUpdateScenario=!e,n.isPublishOrUpdateError=!e)})),n.providerKey=a.scope.updateContentPack.providerContract.providerKey,n.publishButtonText=a.services.localizationService.get("PBI_Button_Label_Update"),n.headerText=a.services.localizationService.get("Publish_UpdateContentPack"),a.scope.updateContentPack.isSharedToEntireOrg)n.contentPackCreatedFor=!0;else{n.contentPackCreatedFor=!1,n.emailsList=new r;var t=a.scope.updateContentPack.providerContract;t.accessPermissions&&t.accessPermissions.adUserMetadataList?(n.emailsList.inputUserList=t.accessPermissions.adUserMetadataList,n.emailsList.inputUserList.forEach((function(e){e.userPrincipalName||(e.isSecurityGroup=!0)}))):n.emailsList.inputUserList=o.emailsToUsers(a.scope.updateContentPack.listOfGroupPrincipals)}n.titleText=a.scope.updateContentPack.displayText,n.descriptionText=a.scope.updateContentPack.description,a.scope.updateContentPack.iconUrl&&(a.scope.imageThumbView=jsCommon.Utility.urlCombine(clusterUri,a.scope.updateContentPack.iconUrl),a.scope.isIconUpdated=!1);for(var i=a.scope.updateContentPack.dashboardIds.length,s=0;s<i;s++)a.toggleDashboard(null,a.scope.updateContentPack.dashboardIds[s]);i=a.scope.updateContentPack.reportIds.length;for(var s=0;s<i;s++)a.toggleReport(a.scope.updateContentPack.reportIds[s],!0);i=a.scope.updateContentPack.modelIds.length;for(var s=0;s<i;s++)a.toggleModelByIds(a.scope.updateContentPack.modelIds[s]);i=a.scope.updateContentPack.workbookIds.length;for(var s=0;s<i;s++)a.toggleWorkbook(a.scope.updateContentPack.workbookIds[s],!0);a.scope.updateContentPack.providerContract.isDirty||(n.isUpdateScenario=!0)}else n.publishButtonText=a.services.localizationService.get("Publish_ContentPackPublishButton"),n.headerText=a.services.localizationService.get("Publish_CreateContentPack");a.scope.onFileSelect=function(e){var t=new FileReader;if(0!==e.length){a.scope.isIconUpdated=!0,a.scope.errorMessage="";var i=e[0];a.readAsDataUrl(i,t).then((function(e){a.scope.imageThumbView=e,a.enableUpdateButton(),n.hasImageValidationError=a.validateImageUploaded(a.scope.imageThumbView.length),n.imageValidationErrorText=a.services.localizationService.get("Publish_ImageSizeValidationError")}),(function(e){a.scope.errorMessage=e}))}},a.scope.$watchGroup([function(){return a.scope.dashboardContainer.dashboards.length},function(){return a.services.reportService.reports.length},function(){return a.services.workbookService.workbooks.length},function(){return a.services.modelService.lastUpdatedTimestamp}],(function(){a.updateView()})),a.scope.isPublishAllowed=function(){return!0},a.services.asyncFeatureSwitchService.getFeatureSwitches().then((function(e){a.scope.isPublishContentPackFeatureDisabled=!e.publishContentPackEnabled,a.scope.showTemplateUI=e.templatePublishEnabled||e.templatePublishFlightingWorkAroundEnabled,a.scope.updateContentPack&&a.scope.updateContentPack.providerContract&&4===a.scope.updateContentPack.providerContract.category&&(n.isTemplate=!0,a.scope.isPublishAllowed=function(){return!1})}),(function(){a.scope.isPublishContentPackFeatureDisabled=!0})),a.initAppIntroDialog()})),this.scope.$on("$destroy",(function(){a.clearContents()}))}return t.createOptions=function(){return{additionalServices:["$sce","asyncFeatureSwitchService","errorService","modalDialogService","modelConverter","navigation","promiseFactory","telemetryService","localizationService","$element","reportService","modelService","contentPackService","quota","groupService","workbookService","notificationToast","packageService","settingsMetadataService","conceptualModelSetting","$window","licenseEnforcementService"]}},t.prototype.initAppIntroDialog=function(){var t=this;this.services.conceptualModelSetting.isAppsEnabled()&&(this.introduceAppDialogBuilder=new a(this.services.modalDialogService),this.introduceAppDialogBuilder.show("introduceAppWhenCreateContentPack",{mode:0}).then((function(i){0===i&&t.services.$window.open(e.constants.pbiAppsLink,"_blank")})))},t.prototype.isUpdate=function(){return!_.isEmpty(this.scope.viewModel.providerKey)},t.prototype.getSettingsMetadata=function(){var e=this;this.services.settingsMetadataService.getSettings().then((function(t){e.settingsMetadata=t}),(function(){e.settingsMetadata=null})).finally((function(){e.scope.isTemplatingAllowed=function(){return e.isTemplatingAllowed()},4===e.scope.updateContentPack.providerContract.category&&(e.scope.viewModel.isTemplate=!0,e.scope.updateContentPack&&(e.scope.isPublishAllowed=function(){return e.isTemplatingAllowed()}))}))},t.prototype.getLocalizedTemplatizeModelToolTip=function(){return this.isTemplatingAllowed()?null:this.services.localizationService.get("PublishContentPack_TemplatizeModel_NotAllowed")},t.prototype.updateIsRemoteWorkbookSelected=function(){var e=this,t=_.find(this.scope.workbooks,(function(t){return t&&t.isSelected&&!e.services.packageService.isLocalWorkbook(t.contract.packageId)}));this.scope.isRemoteWorkbookSelected=void 0!==t,this.scope.workbooksWebUri=t?t.contract.webUri:void 0},t.prototype.isMyWorkspace=function(){return this.services.groupService.isMyWorkspace()},t.prototype.getWorkookPermissionsMessageType=function(){return this.isMyWorkspace()?0:2},t.prototype.updateView=function(){this.scope.dashboards=this.filteredDashboards,this.scope.reports=this.filteredReports,this.scope.models=this.filteredModels,this.services.asyncFeatureSwitchService.featureSwitches.excelWorkbooksInContentPackEnabled?this.scope.workbooks=this.filteredWorkbooks:this.scope.workbooks=[],this.scope.filteredReportResources=[].concat(this.scope.workbooks).concat(this.scope.reports),this.updateIsRemoteWorkbookSelected(),this.dashboardsWithExternalContent=[],this.getDashboardWithExternalSource()},Object.defineProperty(t.prototype,"filteredDashboards",{get:function(){return _.filter(this.scope.dashboardContainer.dashboards,(function(e){return(e.getPermissions()&n.Write)===n.Write&&(e.getPermissions()&n.ReShare)===n.ReShare}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filteredReports",{get:function(){return this.services.reportService.editableReports},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filteredModels",{get:function(){return this.services.modelService.editableModels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filteredWorkbooks",{get:function(){return this.services.workbookService.originalWorkbooks},enumerable:!0,configurable:!0}),t.prototype.switchToDashboardView=function(){var e=this;this.services.conceptualModelSetting.isListViewEnabled()?this.services.groupService.ensureGroupsInitialization().then((function(){var t=e.services.groupService.activeGroupObjectId;e.services.navigation.navigateToContentList(t)})):this.services.navigation.navigateToActiveDashboard()},t.prototype.cancelPublishContentPack=function(){this.clearContents(),this.services.navigation.navigateBack()},t.prototype.validateImageUploaded=function(e){return!(e<65e3)},t.prototype.clearContents=function(){var e=this.scope.viewModel;e.contentPackCreatedFor=!1,e.isUpdateScenario=!1,e.titleText="",e.descriptionText="",this.scope.setDefaultImage(!0);for(var t=0,i=this.scope.dashboards.length;t<i;t++){var o=this.scope.dashboards[t];o.isSelected=!1,o.isEnabled=!0}for(var t=0,i=this.scope.reports.length;t<i;t++){var r=this.scope.reports[t];r.isSelected=!1,r.isEnabled=!0,r.countOfLinkedAncestorsSelected=0}for(var t=0,i=this.scope.models.length;t<i;t++){var a=this.scope.models[t];a.isSelected=!1,a.isEnabled=!0,a.countOfLinkedAncestorsSelected=0}for(var t=0,i=this.scope.workbooks.length;t<i;t++){var n=this.scope.workbooks[t];n.isSelected=!1,n.isEnabled=!0,n.countOfLinkedAncestorsSelected=0}},t.prototype.enableUpdateButton=function(){this.scope.viewModel.isUpdateScenario=!1,this.scope.viewModel.isPublishOrUpdateError=!1,this.isTemplatingAllowed()||this.isUpdate()||(this.scope.viewModel.isTemplate=!1)},t.prototype.onContentPackChanged=function(){if(this.scope.updateContentPack){var e=this.scope.updateContentPack,t=this.scope.viewModel;this.scope.viewModel.isUpdateScenario=e.isSharedToEntireOrg===(t.contentPackCreatedFor===!0)&&e.displayText===t.titleText&&e.description===t.descriptionText&&e.iconUrl===this.scope.imageThumbView&&e.dashboardIds.sort().toString()===this.returnSelectedDashboardIds().sort().toString()&&e.reportIds.sort().toString()===this.returnSelectedResourceIds(this.scope.reports).sort().toString()&&e.modelIds.sort().toString()===this.returnSelectedResourceIds(this.scope.models).sort().toString()&&e.workbookIds.sort().toString()===this.returnSelectedResourceIds(this.scope.workbooks).sort().toString(),e.listOfGroupPrincipals&&t.groupsAddressesList&&(this.scope.viewModel.isUpdateScenario=this.scope.viewModel.isUpdateScenario&&e.listOfGroupPrincipals.sort().toString()===t.groupsAddressesList.sort().toString())}return this.scope.viewModel.isUpdateScenario},t.prototype.isLegacyReport=function(t){return!e.helpers.ReportUtility.IsReportSavedAsExploration(t.contract)},t.prototype.canDashboardBeAdded=function(e){return _.indexOf(this.dashboardsWithExternalContent,e)<0},t.prototype.getDashboardWithExternalSource=function(){if(!_.isEmpty(this.scope.dashboards))for(var e=_.map(this.scope.models,(function(e){return e.id})),t=_.map(this.scope.reports,(function(e){return e.id})),i=0;i<this.scope.dashboards.length;i++){if(!_.isEmpty(this.scope.dashboards[i].contract.modelIds)){var o=_.difference(this.scope.dashboards[i].contract.modelIds,e);_.isEmpty(o)||this.dashboardsWithExternalContent.push(this.scope.dashboards[i].id)}if(!_.isEmpty(this.scope.dashboards[i].contract.reportIds)){var r=_.difference(this.scope.dashboards[i].contract.reportIds,t);_.isEmpty(r)||this.dashboardsWithExternalContent.push(this.scope.dashboards[i].id)}}},t.prototype.dashboardHasLegacyReport=function(t){if(!t||!t.contract)return!1;for(var i=t.contract.reportIds,o=i?i.length:0,r=0;r<o;r++){var a=this.services.reportService.findReport(i[r]);if(a&&!e.helpers.ReportUtility.IsReportSavedAsExploration(a.contract))return!0}return!1},t.prototype.updateRelatedResources=function(t,i,o){for(var r=0,a=i;r<a.length;r++){var n=a[r];if(n.isSelected)if(o){if(t===e.common.models.ResourceType.Report&&n.isEnabled){var s=this.services.modelService.findModel(n.modelId);s.countOfLinkedAncestorsSelected--}n.countOfLinkedAncestorsSelected++,n.isEnabled=!o}else n.countOfLinkedAncestorsSelected--;0===n.countOfLinkedAncestorsSelected&&(n.isSelected=o,n.isEnabled=!o,o&&n.countOfLinkedAncestorsSelected++)}},t.prototype.toggleDashboard=function(t,i){if(t||(t=_.find(this.scope.dashboards,(function(e){return e.id===i})),t&&(t.isSelected=!0)),t){var o=_.filter(this.scope.reports,(function(e){return t.contract.reportIds.indexOf(e.id)!==-1}));this.updateRelatedResources(e.common.models.ResourceType.Report,o,t.isSelected);var r=_.filter(this.scope.models,(function(e){return t.contract.modelIds.indexOf(e.id)!==-1}));this.updateRelatedResources(e.common.models.ResourceType.Model,r,t.isSelected);var a=_.filter(this.scope.workbooks,(function(e){return t.contract.workbookIds.indexOf(e.id)!==-1}));this.updateRelatedResources(e.common.models.ResourceType.Workbook,a,t.isSelected),this.updateIsRemoteWorkbookSelected(),this.enableUpdateButton()}},t.prototype.toggleWorkbook=function(e,t){var i;t&&(i=_.find(this.scope.workbooks,(function(t){return t.id===e})),i&&(i.isSelected=!0)),this.enableUpdateButton(),this.updateIsRemoteWorkbookSelected()},t.prototype.toggleReport=function(t,i){var o;if(i){if(o=_.find(this.scope.reports,(function(e){return e.id===t})),o&&(o.isSelected=!0,!o.isEnabled))return}else if(this.scope.filteredReportResources&&this.scope.filteredReportResources[t]){var r=this.scope.filteredReportResources[t].id;o=_.find(this.scope.reports,(function(e){return e.id===r}))}if(o){var a=_.filter(this.scope.models,(function(e){return e.id===o.modelId}));this.updateRelatedResources(e.common.models.ResourceType.Model,a,o.isSelected)}this.enableUpdateButton()},t.prototype.toggleModelByIds=function(e){var t=_.find(this.scope.models,(function(t){return t.id===e}));t&&!t.isSelected&&(t.isSelected=!0),this.enableUpdateButton()},t.prototype.setDefaultImage=function(e){this.scope.isIconUpdated=!0,this.scope.viewModel.isDefaultImageUsed=e,this.scope.viewModel.hasImageValidationError=!1,this.scope.imageThumbView="",this.enableUpdateButton()},t.prototype.readAsDataUrl=function(e,t){if(void 0!==e){var i=this.services.promiseFactory.defer();return t.onload=function(){i.resolve(t.result)},t.onerror=function(){i.reject(t.error)},t.readAsDataURL(e),i.promise}},t.prototype.validateTitleSize=function(){return!(this.scope.viewModel.titleText&&this.scope.viewModel.titleText.length>t.TitleSizeLimit)},t.prototype.isTitleEmpty=function(){return!this.scope.viewModel.titleText||0===this.scope.viewModel.titleText.length},t.prototype.isDescriptionEmpty=function(){return!this.scope.viewModel.descriptionText||0===this.scope.viewModel.descriptionText.length},t.prototype.validateDescriptionSize=function(){return!(this.scope.viewModel.descriptionText&&this.scope.viewModel.descriptionText.length>t.DescriptionSizeLimit)},t.prototype.returnSelectedResourceIds=function(e){for(var t=[],i=e.length,o=0;o<i;o++)e[o].isSelected&&t.push(e[o].id);return t},t.prototype.returnSelectedDashboardIds=function(){for(var e=[],t=this.scope.dashboards,i=t.length,o=0;o<i;o++)t[o].isSelected&&e.push(t[o].id);return e},t.prototype.isTemplatingAllowed=function(){var e=this.scope.dashboards.filter((function(e){return e.isSelected===!0})),t=this.scope.reports.filter((function(e){return e.isSelected===!0})),o=this.scope.models.filter((function(e){return e.isSelected===!0})),r=this.scope.workbooks.filter((function(e){return e.isSelected===!0}));return i.isTemplatingAllowed(e,t,o,r,this.services.modelService,this.services.packageService,this.settingsMetadata)},t.prototype.publishContentPack=function(t){var i=this;this.scope.viewModel.hasValidationError=!1;var o=this.scope.viewModel,r=!!o.providerKey,a=this.services.licenseEnforcementService.supportsOrgApps();if(!a)return void this.services.contentPackService.displayLicenseErrorDialog(!1);if(!this.services.quota.checkQuotaExceeded(r?e.telemetry.QuotaCheckOperation.UpdateContentPack:e.telemetry.QuotaCheckOperation.PublishContentPack)){if(o.isSharedWithOrg=!1,o.hasTitleValidationError=!1,o.hasNoItemsSelected=!1,o.hasDescriptionValidationError=!1,o.hasGroupsValidationError=!1,o.hasTemplatePublishError=!1,o.contentPackCreatedFor===!0)o.isSharedWithOrg=!0,o.emailsList=null;else{if(!o.emailsList.validationTrigger())return void(o.hasGroupsValidationError=o.emailsList.hasValidationError);o.groupsAddressesList=o.emailsList.validEmailsList.concat(o.emailsList.validObjectIds);for(var n=0,s=o.groupsAddressesList.length;n<s;n++)o.groupsAddressesList[n]=o.groupsAddressesList[n].toLowerCase()}if(this.isTitleEmpty())return o.hasTitleValidationError=!0,void(o.titleValidationError=this.services.localizationService.get("PublishContentPack_EmptyTitle"));if(!this.validateTitleSize())return o.hasTitleValidationError=!0,void(o.titleValidationError=this.services.localizationService.get("Publish_TitleSizeExceeded"));if(this.isDescriptionEmpty())return o.hasDescriptionValidationError=!0,void(o.descriptionTextValidationError=this.services.localizationService.get("PublishContentPack_EmptyDescription"));if(!this.validateDescriptionSize())return o.hasDescriptionValidationError=!0,void(o.descriptionTextValidationError=this.services.localizationService.get("Publish_DescriptionSizeExceeded"));if(!o.hasImageValidationError){if(o.hasImageValidationError=!1,o.selectedDashboardIds=this.returnSelectedDashboardIds(),o.selectedReportIds=this.returnSelectedResourceIds(this.scope.reports),o.selectedDatasetIds=this.returnSelectedResourceIds(this.scope.models),o.selectedWorkbookIds=this.returnSelectedResourceIds(this.scope.workbooks),0===o.selectedDashboardIds.length&&0===o.selectedReportIds.length&&0===o.selectedDatasetIds.length&&0===o.selectedWorkbookIds.length)return o.hasNoItemsSelected=!0,void(o.itemsNotSelectedError=this.services.localizationService.get("PublishContentPack_NoItemsSelected"));o.isPublishInProgress=!0,o.isPublishCancelled=!0,r?this.services.contentPackService.findContentPackByGUID(o.providerKey).then((function(e){if(e)return!e.providerContract.isDirty&&i.onContentPackChanged()?(i.scope.viewModel.isPublishOrUpdateError=!0,i.scope.viewModel.publishOrUpdateError=i.services.localizationService.get("UpdateContentPack_NoChangesMade"),o.isPublishInProgress=!1,void(o.isPublishCancelled=!1)):void i.publishInternal(r)})):this.publishInternal(r)}}},t.prototype.publishInternal=function(t){var o=this,r=this.services.telemetryService,a=!1,n=this.services.groupService.isMyWorkspace(),s=this.scope.viewModel,c=r.startEvent(e.telemetry.DashboardContentPackPublish,t,s.selectedDashboardIds.length,s.selectedReportIds.length,s.selectedDatasetIds.length,s.selectedWorkbookIds.length,n,s.isSharedWithOrg?0:s.groupsAddressesList?s.groupsAddressesList.length:0,a),l=e.contentPackService.publishContentPack(s,this.scope.imageThumbView,null,this.scope.isIconUpdated,!1,c.event);l.then((function(i){c.resolve(),o.services.notificationToast.notify({title:o.services.localizationService.get("Publish_Success"),message:o.services.localizationService.format("Publish_SuccessMessage",[s.titleText]),notificationType:e.common.NotificationToastType.Success}),o.scope.viewModel.isPublishInProgress=o.scope.viewModel.isPublishCancelled=!1,o.switchToDashboardView(),o.services.contentPackService.loadContentPacks(),t&&o.services.contentPackService.setContentPackCleanForSession(s.providerKey)}),(function(t){var r=o.scope.viewModel;r.isPublishInProgress=r.isPublishCancelled=!1;var a=i.getPublishErrorFromResult(t,o.services.localizationService);if(a){switch(a.errorType){case 0:r.hasImageValidationError=!0,r.imageValidationErrorText=a.errorMessage;break;case 1:r.hasTemplatePublishError=!0,r.templatePublishErrorText=a.errorMessage;break;case 2:r.hasGroupsValidationError=!0,r.groupsValidationError=a.errorMessage}c.event.info.isUserError=!0,c.resolve()}else c.reject(e.errorDetailsHelper.getTelemetryErrorDetails(t.error,t.status)),o.services.errorService.error(o.services.localizationService.get("PublishContentPack_Failed_Desc"),"",{requestId:t.requestId,statusCode:t.status.toString(),activityId:t.activityId})}))},t})();s.DescriptionSizeLimit=2e3,s.TitleSizeLimit=200,t.PublishContentPackView=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){var i=this;this.scope=e,this.services=t,this.scope.hideDialog=function(){return i.hideDialog()},this.scope.tryIEDownloadQRCodeImage=function(){return i.tryIEDownloadQRCodeImage()},this.initialize()}return e.createOptions=function(){return{additionalServices:["qrCodeService"]}},e.prototype.initialize=function(){var e=this;this.services.qrCodeService.getQRCodeCanvas(this.scope.viewModel.url).then((function(t){e.scope.qrCodeCanvas=t,void 0!==e.scope.viewModel.subDisplayText?e.scope.qrCodeImageFileName=e.scope.viewModel.displayText+" - "+e.scope.viewModel.subDisplayText+".jpg":e.scope.qrCodeImageFileName=e.scope.viewModel.displayText+".jpg",e.scope.qrCodeImageDataUrl=e.scope.qrCodeCanvas.toDataURL("image/jpeg",1)}))},e.prototype.hideDialog=function(){this.services.qrCodeService.hideQRCodeDialog()},e.prototype.tryIEDownloadQRCodeImage=function(){if(this.scope.qrCodeCanvas.msToBlob){var e=this.scope.qrCodeCanvas.msToBlob();return window.navigator.msSaveBlob(e,this.scope.qrCodeImageFileName),!1}return!0},e})();e.QrCodeDialogController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){var i=this;this.scope=e,this.services=t,this.scope.hideDialog=function(){return i.hideDialog()}}return e.createOptions=function(){return{additionalServices:["qrCodeService"]}},e.prototype.hideDialog=function(){this.services.qrCodeService.hideQRProgressDialog()},e})();e.QRCodeProgressDialogController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.scope.viewModel={dashboardObjectId:this.services.navigation.currentDashboardGUID,isRequestActive:!1,splashMessage:this.services.localizationService.get("RequestDashboardAccess_SplashMessage")},this.scope.requestAccess=function(){return i.requestAccess()}}return t.createOptions=function(){return{additionalServices:["navigation","localizationService","modalDialogService","telemetryService","invitationService","dashboardService","groupService","errorService"]}},t.prototype.requestAccess=function(){var e=this,t=this.scope.$new(!0);t.viewModel={accessRequestedDescription:this.services.localizationService.get("RequestDashboardAccessModal_AccessRequestedDescription"),requestAccessDescription:this.services.localizationService.get("RequestDashboardAccessModal_RequestAccessDescription"),placeholderText:this.services.localizationService.get("RequestDashboardAccessModal_Placeholder"),message:""};var i=[new InJs.ModalDialogAction(this.services.localizationService.get("RequestDashboardAccessModal_SendButton"),function(i,o){e.scope.viewModel.isRequestActive=!0,t.closeDialog(),e.sendRequest(t.viewModel.message)}),new InJs.ModalDialogAction(this.services.localizationService.get("RequestDashboardAccessModal_CancelButton"),function(e,i){t.closeDialog()})],o={dialogName:this.services.localizationService.get("RequestDashboardAccessModal_RequestAccessTitle"),template:"<request-dashboard-access-modal></request-dashboard-access-modal>",dialogActions:i,scope:t};this.services.modalDialogService.showLegacyWebModalDialog(o)},t.prototype.sendRequest=function(t){var i=this,o=!1;t||(t="",o=!0);var r=this.services.telemetryService.startEvent(e.telemetry.DashboardRequestDashboardAccess,this.scope.viewModel.dashboardObjectId,t.length,o);this.services.invitationService.requestDashboardAccess(this.scope.viewModel.dashboardObjectId,t,r.event).then((function(e){r.resolve(),i.showConfirmationDialog()}),(function(t){var o=t.headers(e.common.PowerBIErrorHeader),a="RequestDashboardAccessInvalidRequest",n=o||a;r.reject({errorCode:n,errorSource:n!==a?e.telemetry.ErrorSource.User:e.telemetry.ErrorSource.PowerBI}),i.services.errorService.error(i.services.localizationService.get("RequestDashboardAccess_FailedToRequestDashboardAccess"),"RequestDashboardAccess_FailedToRequestDashboardAccess",{requestId:t.requestId,statusCode:t.status.toString()}),i.scope.viewModel.isRequestActive=!1}))},t.prototype.showConfirmationDialog=function(){var e=this,t=this.scope.$new(!0);t.message=this.services.localizationService.get("RequestDashboardAccessModal_AccessRequested");var i=[new InJs.ModalDialogAction(this.services.localizationService.get("RequestDashboardAccessModal_CloseButton"),function(i,o){t.closeDialog(),e.onConfirmationDialogClosed()})],o={dialogName:this.services.localizationService.get("RequestDashboardAccessModal_AccessRequestedTitle"),template:"<span>{{message}}</span>",scope:t,dialogActions:i,isDismissable:!1};this.services.modalDialogService.showLegacyWebModalDialog(o)},t.prototype.onConfirmationDialogClosed=function(){var e=this.services.dashboardService.dashboardContainerModel.visibleDashboards;e&&e.length>0?this.services.navigation.navigateToDashboardByGUID(e[0].objectId):this.services.navigation.navigateToGroupWelcome()},t})();t.RequestDashboardAccessController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.models.factory.DatasetsMenuFactory,r=jsCommon.EnumExtensions,a=e.common.dialogs.FeatureNotSupportedDialogBuilder,n=e.common.helpers.ModelConverterHelper,s=e.common.contracts.Permissions,c=e.common.contracts.PublishOrRefreshStatus,l=e.common.contracts.RealTimeMode,d=e.common.constants.TaskPaneCollapsiblePaneMode,p=(function(){function p(e,t){var i=this;this.mapDateObjects=function(e){return e.forEach((function(e){e.nextRefreshTime=i.convertRefreshTimeToJsDateTime(e.contract.nextRefreshTime)})),e},this.scope=e,this.services=t,e.predicate="name",e.reverse=!0,e.order=function(t){e.reverse=e.predicate===t&&!e.reverse,e.predicate=t},e.modelService=this.services.modelService,this.initialize()}return p.createOptions=function(){return{additionalServices:["analyzeInExcel","contentPackService","dashboardService","errorService","featureSwitchService","groupService","historyDialogService","insightsService","localizationService","modalDialogService","modelConverter","modelHttpService","modelService","navigation","ownership","packageService","realTimeModel","refreshService","quota","telemetryService","settingsMetadataService","overlayService","permissionService","conceptualModelSetting","taskPaneSliderService","lazy"]}},p.prototype.initialize=function(){var t=this;this.services.telemetryService.logEvent(e.telemetry.DashboardManageDatasetsLanding),this.modelDashboards={},this.streamingDatasetActions={},this.datasetMenuActions=this.createFileMenuActions(),
this.isOrgApp=!1;var i=1;this.services.navigation.inManageStreamingDatasetView()&&(i=2,1===this.services.navigation.instantiationMode&&this.showStreamingDatasetGalleryPane()),this.setActiveTab(i),this.services.groupService.ensureGroupsInitialization().then((function(){t.services.groupService.activeGroup&&(t.activeGroupName=t.services.groupService.activeGroup.displayName)})),this.searchFilter=""},Object.defineProperty(p.prototype,"listViewEnabled",{get:function(){return this.services.conceptualModelSetting.isListViewEnabled()},enumerable:!0,configurable:!0}),p.prototype.onDestroy=function(){this.modalDialogPromise&&this.modalDialogPromise.pending&&this.modalDialogPromise.reject("ManageDatasetsController destroyed")},p.prototype.inDatasetsView=function(){var e=this.services.navigation;return e.inManageDatasetView()||e.inManageStreamingDatasetView()},p.prototype.isPackagePublishInProgress=function(e){return e===c.PublishInProgress},p.prototype.navigateToContentList=function(){this.services.navigation.navigateToContentList(this.services.groupService.activeGroupObjectId)},p.prototype.convertRefreshTimeToJsDateTime=function(e){var t=n.convertRefreshTimeToJsDateTime(e);return t.getFullYear()>3e3?this.services.localizationService.get("ManageDatasets_NextRefresh_NA"):t.toLocaleString()},p.prototype.datasetMenuActionSelected=function(e){switch(e.action){case 8:this.analyzeInExcel(this.activeModel);break;case 1:this.createReport(this.activeModel);break;case 7:case 16:this.delete(this.activeModelContract);break;case 2:case 11:case 12:this.getInsights(this.activeModelContract);break;case 3:this.granularSecurity(this.activeModelContract);break;case 5:this.refreshNow(this.activeModelContract);break;case 4:this.rename(this.activeModelContract);break;case 6:this.refreshSchedule(this.activeModelContract);break;case 10:this.navigateToSettingsPage(this.activeModelContract);break;case 9:this.personalizeDataset(this.activeModel);break;case 13:this.toggleRowState(this.activeModelIndex);break;case 15:this.showStreamingDatasetEditorPane(this.activeModel.id);break;case 14:this.showStreamingDatasetPushInfoPane(this.activeModel.id)}this.services.overlayService.hideAllDropdowns()},p.prototype.streamingDatasetActionSelected=function(e,t,i){this.setActiveModel(e,t),this.datasetMenuActionSelected(i)},p.prototype.getDashboardsForModel=function(e){return this.modelDashboards[e.id]||(this.modelDashboards[e.id]=_(this.services.dashboardService.dashboards).filter((function(t){return t.contract.modelIds&&t.contract.modelIds.indexOf(e.id)>=0})).map((function(e){return e.displayName})).value().join(this.services.localizationService.get("ListJoin_Separator"))),this.modelDashboards[e.id]},p.prototype.getStreamingDatasetActions=function(e){if(r.hasFlag(e.getPermissions(),s.All)){if(this.streamingDatasetActions[e.realTimeMode])return this.streamingDatasetActions[e.realTimeMode];var t=[];return t.push(15),t.push(16),e.realTimeMode===l.PersistAndCache&&t.push(1),e.realTimeMode!==l.PubNubCacheOnly&&t.push(14),this.streamingDatasetActions[e.realTimeMode]=o.customizeRowMenuActions(t,this.services.localizationService)}return[]},p.prototype.getModelType=function(t){return t.realTimeMode===l.PubNubCacheOnly?e.constants.streamingDatasetModelPubNub:this.services.localizationService.get("StreamingDataset_API")},p.prototype.navigateToGetData=function(){this.services.telemetryService.logEvent(e.telemetry.DashboardOpenGetDataPage,e.telemetry.OpenGetDataPageInteraction.NavigatorPaneAddDatasetButton),this.services.navigation.showGetDataSlider()},p.prototype.resetSearchOnEsc=function(e){27===e.which&&(this.searchFilter="")},p.prototype.setActiveTab=function(e){this.activeTab=e,this.placeholderText=1===this.activeTab?this.services.localizationService.get("ManageDataSets_PlaceholderSearchDatasets"):this.services.localizationService.get("ManageDataSets_PlaceholderSearchStreamingDatasets"),1===e?this.services.navigation.navigateToDatasets():this.services.navigation.navigateToStreamingDatasets(0)},p.prototype.showStreamingDatasetGalleryPane=function(){this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.CreateStreamingDataset)||(this.services.realTimeModel.setSelected(null),this.services.featureSwitchService.featureSwitches.realTimePubNubEnabled?this.services.taskPaneSliderService.expandPane(d.StreamingDatasetGallery):this.services.taskPaneSliderService.expandPane(d.StreamingDatasetEditor))},p.prototype.showOptions=function(e,t){this.setActiveModel(e,t),this.customizeMenuActions(this.activeModelContract,this.activeModelPackage)},p.prototype.toggleRowState=function(e){this.activePosition=this.activePosition===e?-1:e},p.prototype.setActiveModel=function(e,t){this.activeModel=e,this.activeModelIndex=t,this.activeModelContract=e.contract,this.activeModelPackage=this.services.packageService.findPackage(this.activeModelContract.packageId)},p.prototype.createReport=function(t){return null!=t.contract.packagePublishStatus&&t.contract.packagePublishStatus!==c.FinishedSuccessfully&&t.contract.packagePublishStatus!==c.RefreshInProgress&&t.contract.packagePublishStatus!==c.RefreshError?void(t.contract.packagePublishStatus===c.PublishError&&this.deleteModelOnPublishFailure(t.id)):(t.isNew=t.contract.isNew=!1,void(this.services.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.OpenDataset)||(r.hasFlag(t.getPermissions(),s.CopyOnWrite)?this.scope.$emit(e.constants.personalizeEventName,t.packageId):this.services.navigation.navigateToDatasetByDBName(t.dbName))))},p.prototype.deleteModelOnPublishFailure=function(e){var t=this;this.deleteItemOnPublishFailure(this.services.localizationService.get("NavigationPane_ModelPublishErrorTitle"),this.services.localizationService.get("NavigationPane_ModelPublishErrorContent"),(function(){t.services.modelService.deleteModel(e)}))},p.prototype.deleteItemOnPublishFailure=function(e,t,i){var o=this,r=this.services.errorService.control(),a=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(e,t){r.hideDialog(),i()}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){r.hideDialog()})];r.showCustomDialog(e,$("<div/>").text(t),a,(function(e){e.parent().find('input[value="'+o.services.localizationService.get("ModalDialogButtonText_No")+'"]').focus()}),!0)},p.prototype.getInsights=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i;return __generator(this,(function(o){switch(o.label){case 0:return this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickInsights,t.contentProviderId),[4,this.services.lazy("insightsBootstrap")];case 1:return i=o.sent(),i.start(t.dbName,t.vsName,t.packageId,e.insights.constants.insightsSourceNavigationPane),[2]}}))}))},p.prototype.showStreamingDatasetEditorPane=function(e){this.services.realTimeModel.setSelected(e),this.services.taskPaneSliderService.expandPane(d.StreamingDatasetEditor)},p.prototype.granularSecurity=function(e){6===e.contentProviderId?this.cloudRlsNotSupportedDialog():this.services.navigation.showRowLevelSecuritySlider(e.id)},p.prototype.cloudRlsNotSupportedDialog=function(){this.modalDialogPromise=new a(this.services.modalDialogService).show("ModalDialog_CloudRlsUnSupportedTypeTitle","ModalDialog_CloudRlsUnSupportedTypeMessage","https://go.microsoft.com/fwlink/?LinkID=733530")},p.prototype.rename=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickRename,t.contentProviderId),this.services.settingsMetadataService.setSettings(4,t.dbName),this.services.taskPaneSliderService.expandPane(d.SettingsBlade,i.Medium)},p.prototype.refreshNow=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickRefreshNow,t.contentProviderId),this.services.refreshService.tryRefreshNow(this.services.telemetryService,this.services.errorService,t,"datasets")},p.prototype.refreshSchedule=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickScheduleRefresh,t.contentProviderId),this.services.navigation.showSettingsSlider("datasets",t.dbName)},p.prototype.navigateToSettingsPage=function(e){this.services.navigation.showSettingsSlider("datasets",e.dbName)},p.prototype.delete=function(i){this.services.telemetryService.logEvent(e.telemetry.DashboardDatasetClickDelete,i.contentProviderId);var o=i.id,r=i.packageId,a=this.services.modelService.findModel(o,r);a&&a.isUsedByContentPack?this.services.contentPackService.showDialogOnModelDeleteInContentPack(o):this.deleteModel(o,r,this.isOrgApp?t.DeleteContentPackMessageType.Dataset:null)},p.prototype.deleteModel=function(e,i,o){var r,a,n=this,s=this.services.modelService.findModel(e,i),c=this.services.errorService.control(),l=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(t,o){c.hideDialog(),s&&s.realTimeMode?n.services.realTimeModel.deleteModel(e):n.services.modelService.deleteModel(e,i)}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){c.hideDialog()})];switch(o){case t.DeleteContentPackMessageType.Dataset:r=this.services.localizationService.get("Model_DeleteConfirmationTitle"),a=this.services.localizationService.get("Model_DeleteOrgAppContentPack");break;default:s&&s.realTimeMode?(r=this.services.localizationService.get("StreamingDatasetModel_DeleteConfirmationTitle"),a=this.services.localizationService.format("StreamingDatasetModel_DeleteConfirmationMessage",[s.displayName])):(r=this.services.localizationService.get("Model_DeleteConfirmationTitle"),a=this.services.localizationService.format("Model_DeleteConfirmationMessage",s?[s.displayName]:[]))}c.showCustomDialog(r,$("<div/>").text(a),l,(function(e){e.parent().find('input[value="'+n.services.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)},p.prototype.customizeMenuActions=function(e,t){var i=this.services.featureSwitchService,a=this.services.localizationService,n=[],c=this.services.permissionService.getModelEffectivePermissions(e);if((c&s.CopyOnWrite)===s.CopyOnWrite&&(n.push(9),n.push(7),this.isOrgApp=!0),this.services.ownership.permissionsArePersonalized(c,t)&&(n.push(7),this.isOrgApp=!1),r.hasFlag(c,s.All)&&(this.isOrgApp=!1,n.push(10),n.push(4),n.push(7),e.onPremModelConnectionString||(e.directQueryMode?n.push(10):n.push(6)),n.push(5)),i){if(this.services.analyzeInExcel.isAnalyzeInExcelSupported(i,c)&&n.push(8),e.insightsSupported&&(r.hasFlag(c,s.Read)||this.services.ownership.permissionsArePersonalized(c,t))){var l=this.findInsightAction(e);n.push(l)}if(r.hasFlag(c,s.All)&&(6===e.contentProviderId||7===e.contentProviderId)&&!e.onPremModelConnectionString){var d=this.services.groupService.activeGroup;(d.isMyWorkspace||d.contract.isOwner||!d.contract.isReadOnly)&&n.push(3)}}n.push(13),this.isOrgApp||n.push(1),this.datasetMenuActions=o.customizeRowMenuActions(n,a)},p.prototype.findInsightAction=function(e){var t=this.services.insightsService.getInsightsStatus(e);switch(t){case 2:return 12;case 1:return 11;default:return 2}},p.prototype.analyzeInExcel=function(t){var i=this.services.modelService.findModel(t.id,t.packageId);i&&(this.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsAnalyzeInExcel,"Dataset Navigation Pane List",i.contentProviderId,i.contract.modelFeatures,i.dbName),this.services.analyzeInExcel.startAnalyzeInExcel(i))},p.prototype.personalizeDataset=function(t){this.services.telemetryService.logEvent(e.telemetry.DashboardClickPersonalize,t.contentProviderId),this.scope.$emit(e.constants.personalizeEventName,t.packageId)},p.prototype.createFileMenuActions=function(){var e=this.services.localizationService;return o.rowMenuActions(e)},p.prototype.showStreamingDatasetPushInfoPane=function(t){this.services.telemetryService.logEvent(e.telemetry.RealTimeStreamingDatasetPushInfoPaneOpened),this.services.realTimeModel.setSelected(t),this.services.taskPaneSliderService.expandPane(d.StreamingDatasetPushInfo)},p})();t.ManageDatasetsController=p})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=(function(){function o(e,t){var i=this;this.scope=e,this.model=this.scope.viewModel,this.services=t,this.scope.isScheduledRefresh=function(e){return i.isScheduledRefresh(e)},this.initModalDialog(),this.modelRefreshHistories=[],this.packageRefreshHistories=[],this.errorService=this.services.errorService,this.datasetsService=this.services.datasetsService,this.modelHttpService=this.services.modelHttpService,this.telemetryService=this.services.telemetryService,this.promiseFactory=this.services.promiseFactory,this.getRefreshHistories(),this.scope.getSelectedHistories=function(e){return i.selectHistories(e)}}return o.createOptions=function(){return{additionalServices:["datasetsService","modelHttpService","telemetryService","errorService","localizationService","promiseFactory"]}},o.prototype.getRefreshHistories=function(){var t=this,i=this.promiseFactory.defer(),o=this.promiseFactory.defer(),r=this.telemetryService.startEvent(e.telemetry.DashboardGetRefreshHistory,e.telemetry.RefreshType.Models),a=this.telemetryService.startEvent(e.telemetry.DashboardGetRefreshHistory,e.telemetry.RefreshType.Packages);this.services.modelHttpService.getModelRefreshHistories(this.model.datasetModel.dataset.modelId.toString(),r.event).then((function(e){i.resolve(e),r.resolve()}),(function(e){i.resolve(e),r.reject()})),this.services.modelHttpService.getPackageRefreshHistories(this.model.datasetModel.dataset.contract.packageId.toString(),a.event).then((function(e){o.resolve(e),a.resolve()}),(function(e){o.resolve(e),a.reject()})),this.promiseFactory.all([i.promise,o.promise]).then((function(e){t.model.showSpinner=!1;var i=e[0],o=e[1];i.data||o.data||t.errorModalConfig(i,"HistoryDialog_ScheduledAndOneDriveRefreshHistoryError"),i.data&&!o.data&&(t.modelRefreshHistories=t.convertRefreshHistories(i.data),t.scope.refreshTypeSelected=0,t.errorModalConfig(o,"HistoryDialog_OneDriveRefreshHistoryError")),!i.data&&o.data&&(t.packageRefreshHistories=t.convertRefreshHistories(o.data),t.scope.refreshTypeSelected=1,t.errorModalConfig(i,"HistoryDialog_ScheduledRefreshHistoryError")),i.data&&o.data&&(t.modelRefreshHistories=t.convertRefreshHistories(i.data),t.packageRefreshHistories=t.convertRefreshHistories(o.data),i.data.length<=0&&o.data.length>0?t.scope.refreshTypeSelected=1:t.scope.refreshTypeSelected=0)}))},o.prototype.errorModalConfig=function(t,i){this.errorService.error(e.common.localize.get(i),i,{requestId:t.requestId,statusCode:t.status.toString(),displayLearnMoreHelpLink:!0,helpLink:"https://go.microsoft.com/fwlink/?LinkId=799819"})},o.prototype.selectHistories=function(e){return 0===e?this.modelRefreshHistories:1===e?this.packageRefreshHistories:void 0},o.prototype.initModalDialog=function(){var t=this;this.model.showModalDialog=!0,this.scope.dialogModel=new e.common.models.ModalDialogModel((!1),this.services.localizationService.get("TopNav_HelpMenu_AboutDialog_Close"),(!0),(!1),(!1),(!0)),this.scope.closeDialog=function(){return t.closeDialog()}},o.prototype.closeDialog=function(){var e=this;this.model.showModalDialog=!1,setTimeout((function(){e.model.showHistoryDialog=!1,e.scope.$apply()}),0)},o.prototype.isScheduledRefresh=function(t){return t.refreshType===e.common.contracts.RefreshType.Scheduled},o.prototype.convertRefreshHistories=function(o){var r=[];if(o)for(var a=o.length,n=0;n<a;n++){var s=o[n];r.push({id:s.id,refreshType:s.refreshType?s.refreshType:e.common.contracts.RefreshType.Scheduled,startTime:i.convertRefreshTimeToJsDateTime(s.startTime).toLocaleString(),endTime:s.endTime?i.convertRefreshTimeToJsDateTime(s.endTime).toLocaleString():"",isSuccessful:s.isSuccessful,friendlyErrorMessage:this.getFriendlyErrorMessage(s),details:t.SettingsDatasetController.convertErrorDetailsJson(s.serviceExceptionJson),status:this.getStatusMessage(s)})}return r},o.prototype.getFriendlyErrorMessage=function(e){return 4===e.status?this.services.localizationService.get("HistoryDialog_RefreshDisabledMessage"):t.SettingsDatasetController.getFriendlyErrorMessage(e.serviceExceptionJson)},o.prototype.getStatusMessage=function(e){var t=this.services.localizationService;if(o.isRefreshInProgress(e))return t.get("HistoryDialog_RefreshStatus_InProgress");if(o.isRefreshTimedOut(e))return t.get("HistoryDialog_RefreshStatus_TimedOut");switch(e.status){case 1:return t.get("HistoryDialog_RefreshStatus_Completed");case 4:return t.get("Disabled");case 2:return t.get("HistoryDialog_RefreshStatus_Failed");default:return""}},o.isRefreshInProgress=function(t){var o=i.convertRefreshTimeToJsDateTime(t.startTime);return!(t.endTime||!o)&&o.getTime()+e.constants.refreshHistoryDialogTimeoutValue>=Date.now()},o.isRefreshTimedOut=function(t){var o=i.convertRefreshTimeToJsDateTime(t.startTime);return!(t.endTime||!o)&&o.getTime()+e.constants.refreshHistoryDialogTimeoutValue<Date.now()},o})();t.HistoryDialogController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,e.canCloseAccount=this.canCloseAccount(),e.promptCloseAccount=function(){return i.promptCloseAccount()}}return t.createOptions=function(){return{additionalServices:["errorService","localizationService","telemetryService","userInfo","userMetadataHttpService"]}},t.prototype.canCloseAccount=function(){var t=this.services.userInfo;return!t.userHasPremiumPlan&&t.userMetadata.tenantMetadata.tenantType===e.common.contracts.TenantType.ViralTenant},t.prototype.promptCloseAccount=function(){var e=this,t=this.services.errorService.control(),i=this.services.localizationService;t.showPrompt(i.get("Settings_CloseAccount"),i.get("Settings_CloseAccount_AreYouSure"),[new InJs.ModalDialogAction(i.get("PBI_Button_Label_Close"),function(){e.closeAccount(),t.hideDialog()}),new InJs.ModalDialogAction(i.get("ModalDialogButtonText_Cancel"),function(){t.hideDialog()})])},t.prototype.closeAccount=function(){var t=this,i=this.services.telemetryService.startEvent(e.telemetry.DashboardCloseUserAccount,this.scope.reason,this.scope.userComment);this.services.userMetadataHttpService.closeUserAccount(i.event).then((function(){i.resolve(),e.LocalyticsService.afterDequeue((function(){location.href="/AccountClosed"}))}),(function(e){t.services.errorService.error(t.services.localizationService.get("GenericErrorDescription"),"GenericError",{requestId:e.requestId,statusCode:e.status.toString()}),i.reject()}))},t})();t.SettingsCloseAccountController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.models.ContentPackItems,o=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.services.localizationService.ensureLocalization((function(){return e.sectionTitle=i.services.localizationService.format("SettingsDashboard_Title",[e.viewModel.name])}));var o=e.viewModel;e.qnaEnabled=o.qnaEnabled,e.gravityEnabled=!!o.gravityEnabled,e.applyChanges=function(){return i.applyChanges()},e.discardChanges=function(){return i.discardChanges()},this.scope.onDataClassificationIdChanged=function(){return i.onDataClassificationIdChanged()},null==e.qnaEnabled&&(e.qnaEnabled=o.hasQnaSupportedModel),this.services.featureSwitchService.featureSwitches.dataClassificationEnabled&&this.services.dataClassificationService.getDataClassificationsAsync().then((function(t){i.scope.dataClassifications=t,i.scope.defaultDataClassification=_.find(t,(function(e){return e.default})),t.length>0&&(e.dataClassificationId=o.dataClassificationId||i.scope.defaultDataClassification.id)}))}return t.createOptions=function(){return{additionalServices:["dashboardHttpService","errorService","localizationService","navigation","telemetryService","dashboardService","dataClassificationService","featureSwitchService"]}},t.prototype.applyChanges=function(){var t=this,o=this.scope,r=o.dashboardSettingsForm;if(r.$dirty){var a=o.viewModel,n=a.dashboardId,s=o.qnaEnabled,c=o.gravityEnabled,l=o.dataClassificationId,d=this.services.telemetryService.startEvent(e.telemetry.DashboardSaveDashboardSettings,!1,!1,!1,a.objectId),p=this.getUpdatedDashboardSetting();this.services.dashboardHttpService.updateDashboardSetting(n,p,d.event).then((function(){var o=t.services.dashboardService.dashboardContainerModel.findDashboard(n);if(o&&o.isUsedByContentPack&&t.services.rootScope.$emit(e.constants.contentPackDirtyShowNotification,o.id,i.Dashboard),t.scope.qnaEnabled!==a.qnaEnabled&&(a.qnaEnabled=s,t.services.dashboardService.setQnaEnabled(a.dashboardId,s),d.event.info.qnaEnabledUpdated=!0),t.scope.gravityEnabled!==a.gravityEnabled){a.gravityEnabled=c,d.event.info.gravityEnabledUpdated=!0;var r=t.services.dashboardService.dashboardContainerModel.findDashboard(a.dashboardId);r&&(r.contract.gravityEnabled=r.gravityEnabled=c)}if(t.scope.dataClassificationId!==a.dataClassificationId){a.dataClassificationId=l,d.event.info.dataClassificationUpdated=!0;var p=_.find(t.services.dashboardService.dashboards,(function(e){return e.id===a.dashboardId}));p.dataClassificationId=l}d.resolve(),t.services.navigation.navigateBack()}),(function(e){d.reject(),t.services.errorService.error(t.services.localizationService.get("SettingsDashboards_Error_FailedToSaveDashboards"),"SettingsDashboards_Error_FailedToSaveDashboards",{requestId:e.requestId,statusCode:e.status.toString()})}))}},t.prototype.discardChanges=function(){this.services.navigation.navigateBack()},t.prototype.getUpdatedDashboardSetting=function(){var e=this.scope.viewModel;return _.omit({qnaEnabled:this.scope.qnaEnabled!==e.qnaEnabled?this.scope.qnaEnabled:null,gravityEnabled:this.scope.gravityEnabled!==e.gravityEnabled?this.scope.gravityEnabled:null,dataClassificationId:this.scope.dataClassificationId!==e.dataClassificationId?this.scope.dataClassificationId:null},(function(e){return null===e}))},t.prototype.onDataClassificationIdChanged=function(){this.scope.isNonDefaultDataClassificationSelected=this.scope.dataClassificationId!==this.scope.defaultDataClassification.id},t})();t.SettingsDashboardController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){this.scope=t,this.services=i;var o=t.viewModel;t.onDashboardSelected=function(e){return i.navigation.showSettingsSlider("dashboards",e)},i.navigation.settingsId?o.currentDashboardId=i.navigation.settingsId:!o.currentDashboardId&&o.dashboards.length>0&&(o.currentDashboardId=_.sortBy(o.dashboards,(function(e){return e.name.toUpperCase()}))[0].objectId);var r=t.$on(e.common.constants.navigation.stateChangeSuccess,(function(){"dashboards"===i.navigation.settingsGroup&&(o.currentDashboardId=i.navigation.settingsId)}));t.$on("$destroy",(function(){r()}))}return t.createOptions=function(){return{additionalServices:["navigation"]}},t})();t.SettingsDashboardsController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i,o){var r=this;this.scope=t,this.services=i,this.settingsGroupsType=o;var a=this.scope.viewModel;this.scope.onDatasetSelected=function(e){return r.onDatasetSelected(e)},i.navigation.settingsId?a.currentDatasetId=this.getIdFromDbName(this.services.navigation.settingsId):!a.currentDatasetId&&this.scope.filteredModels.length>0&&(a.currentDatasetId=_.sortBy(this.scope.filteredModels,(function(e){return e.displayName.toUpperCase()}))[0].id);var n=this.scope.$on(e.common.constants.navigation.stateChangeSuccess,(function(){i.navigation.settingsGroup===r.settingsGroupsType&&(r.scope.viewModel.currentDatasetId=r.getIdFromDbName(r.services.navigation.settingsId))}));this.scope.$on("$destroy",(function(){n()}))}return t.createOptions=function(){return{additionalServices:["errorService","featureSwitchService","localizationService","modelService","packageService","navigation","telemetryService","usageMetricsReport"]}},t.prototype.getIdFromDbName=function(e){var t=_.find(this.scope.viewModel.datasets,(function(t){return t.contract.dbName===e}));if(t)return t.modelId},t.prototype.onDatasetSelected=function(t){var i=this,o=_.find(this.scope.viewModel.datasets,(function(e){return e.modelId===i.scope.viewModel.currentDatasetId}));o&&(o.isDirty||o.isQnaDirty)?this.displayLeaveConfirmationModal(t):(this.setCurrentDataset(t),this.services.telemetryService.logEvent(e.telemetry.DashboardDataModelSelected,this.settingsGroupsType))},t.prototype.displayLeaveConfirmationModal=function(e){var t=this,i=this.services.errorService.control(),o=this.services.localizationService.get("SettingsDataset_DiscardChangesWarning_YesOption"),r=this.services.localizationService.get("SettingsDataset_DiscardChangesWarning_CancelOption"),a=[new InJs.ModalDialogAction(o,function(o,r){i.hideDialog(),t.setCurrentDataset(e)}),new InJs.ModalDialogAction(r,function(e,t){i.hideDialog()})],n=this.services.localizationService.get("SettingsDataset_DiscardChangesWarning_Title"),s=this.services.localizationService.get("datasets"===this.settingsGroupsType?"SettingsDataset_DiscardChangesWarning_DatasetMessage":"SettingsDataset_DiscardChangesWarning_WorkbookMessage");i.showCustomDialog(n,$("<div/>").text(s),a,(function(e){e.parent().find('input[value="'+r+'"]').focus()}),!0)},t.prototype.setCurrentDataset=function(e){this.services.navigation.showSettingsSlider(this.settingsGroupsType,e)},t})();t.SettingsDataModelsController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.contracts.admsGateway.DatabaseType,r=e.connectivity.models.DatasetParametersDialogModel,a=e.connectivity.helpers.ErrorConverterHelper,n=e.common.helpers.ModelConverterHelper,s=e.explore.util.ScriptVisualsUtil,c=e.common.contracts.StorageProviderType,l=e.common.contracts.ConnectionType,d=e.common.contracts.gateway.GatewayStatus,p=e.common.contracts.gateway.GatewayType;!(function(e){e[e.salesforce=9]="salesforce"})(i=t.ContentProviderIds||(t.ContentProviderIds={}));var u=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.model={},this.model.dataset=t.viewModel,this.scope.datasetPageReady=!1,this.scope.isPageActive=!0,this.scope.isHidden=!1,this.scope.editDatasource=function(e){return o.editDatasource(e)},this.scope.editStorageSource=function(){return o.editStorageSource()},this.scope.applyChanges=function(){return o.applyChanges()},this.scope.enableCortana=function(){return o.enableCortana()},this.scope.enableQna=function(){return o.enableQna()},this.scope.discardChanges=function(){return o.discardChanges()},this.scope.addRefreshTime=function(){return o.addRefreshTime()},this.scope.tryProAccount=function(){return o.tryProAccount()},this.scope.removeRefreshTime=function(e){return o.removeRefreshTime(e)},this.scope.canAddRefreshTime=function(){return o.canAddRefreshTime()},this.scope.shouldRefreshSettingsDisabled=function(){return o.shouldRefreshSettingsDisabled()},this.scope.shouldDatasourceCredentialsDisabled=function(){return o.shouldDatasourceCredentialsDisabled()},this.scope.shouldRefreshSettingsToggleDisabled=function(){return o.shouldRefreshSettingsToggleDisabled()},this.scope.updateStorageSourceRefresh=function(){return o.updateStorageSourceRefresh()},this.scope.shouldSettingsDatasetButtonDisable=function(){return o.shouldSettingsDatasetButtonDisable()},this.scope.shouldScheduleRefreshContainerDisabled=function(){return o.shouldScheduleRefreshContainerDisabled()},this.scope.shouldGatewaysContainerDisabled=function(){return o.shouldGatewaysContainerDisabled()},this.scope.shouldPackageRefreshSettingsToggleDisabled=function(){return o.shouldPackageRefreshSettingsToggleDisabled()},this.scope.shouldTakeoverContainerShow=function(){return o.shouldTakeoverContainerShow()},this.scope.refreshSettingsToggleMouseUp=function(){return o.refreshSettingsToggleChanged()},this.scope.getStorageSourceDisplayName=function(){return o.getStorageSourceDisplayName()},this.scope.showTakeoverDialog=function(){return o.showTakeoverDialog()},this.scope.isTakeoverStatusReady=!1,this.scope.testConnectionProgressing=function(e){return o.testConnectionProgressing(e)},this.scope.testConnectionFailed=function(e){return o.testConnectionFailed(e)},this.scope.testPackageConnectionProgressing=function(){return o.testPackageConnectionProgressing()},this.scope.testPackageConnectionFailed=function(){return o.testPackageConnectionFailed()},this.scope.updateOnPremGatewayOverride=function(e){return o.updateOnPremGatewayOverride(e)},this.scope.datasetParametersDialogParameters=new r,this.scope.authDialogParameters=new e.common.models.AuthDialogModel,this.scope.getTrustedHtml=function(e){return o.getTrustedHtml(e)},this.scope.showHistoryDialog=function(){return o.showHistoryDialog(o.model)},this.scope.historyDialogParameters=this.services.historyDialogService.historyDialogParameters,this.scope.applyGatewaySelection=function(){return o.applyGatewaySelection()},this.scope.discardGatewaySelection=function(){return o.discardGatewaySelection()},this.scope.enterpriseGatewayETLEnabled=this.services.featureSwitchService.featureSwitches.enterpriseGatewayETLEnabled,this.scope.storageRefreshSupported=void 0===this.scope.storageRefreshSupported||this.scope.storageRefreshSupported,this.scope.tryProAccountButtonText=this.services.userInfo.userFreeTrialExpired?this.services.localizationService.get("ExtendTrial_RequestExtensionButtonText"):this.services.localizationService.get("UpgradeAccount_TryfreeButton"),this.scope.updateAccountScheduleDataRefreshMessage=this.services.localizationService.format("UpgradeAccount_ScheduleDataRefreshMessage",[e.common.constants.FreeTrialPeriod]),this.scope.$on(e.common.constants.datasetShowAuthDialog,(function(e,t){return o.showAuthDialog(t)})),this.scope.$on(e.common.constants.datasetDatasourceUpdated,(function(e,t){return o.datasetDatasourceUpdated(t)})),this.services.modelService.addModelUpdateListener(this),this.scope.$on(e.common.constants.scopeDestroyEventName,(function(){o.services.modelService.removeModelUpdateListener(o),o.scope.isPageActive=!1})),this.scope.$on(e.common.constants.datasetShowParameterDialogAfterInvalidParameter,(function(e,t){return o.showParameterDialogWithInvalidParameterMessage(t)})),this.scope.$on(e.settings.constants.selectGatewayStatusReadyEventName,(function(e){return o.updateGatewayHeaderWarning()})),this.model.dataset.isDirty=!1,this.model.dataset.areDatasourcesDirty=!1,this.model.dataset.takenOver=this.services.groupService.activeGroup.isMyWorkspace,this.scope.firstTimeExperience=!1,this.scope.newGatewayIsAvailable=!1,this.scope.gatewayNoLongerSupported=!1,this.scope.refreshScheduleComplete=!1,this.scope.storageRefreshEnabledInitialValue=!1,this.scope.disableRefreshSection=!1,this.scope.disableDatasourcesSection=!1,this.scope.storageSourceFileNotFound=!1,this.scope.displayIcon=e.common.models.InlineMessageIcon.Info,this.scope.onPremGatewayDownloadLink=e.models.PowerBIOnPremGatewayModel.downloadLink,this.scope.hasRefreshSchedule=!0,this.scope.hasEditableDatasources=!0,this.scope.showHeaderMessage=!1,this.scope.hasLicenseForProModel=this.services.licenseEnforcementService.supportsProModels(),this.scope.viewModel.manageDataSourcesExpand=!1,this.scope.viewModel.gatewaysExpand=!1,this.scope.viewModel.gatewayExpand=!1,this.scope.viewModel.refreshSectionExpand=!this.model.dataset.takenOver,this.scope.viewModel.qnaSectionExpand=!1,this.scope.viewModel.manageStorageSourceExpand=!1,this.scope.viewModel.manageStorageRefreshExpand=!1;var a=this.model.dataset.contract,s=!n.onpremGatewayRequired(a)&&n.canScheduleRefresh(a);this.scope.selectGatewayModel=new e.settings.models.SelectGatewayModel(this.model.dataset.modelId,(!1),(!0),s),this.scope.$watch("viewModel.hasDatasourceWithWrongCredentials",(function(e,t){o.shrinkManageDataSourceInnerContainerFirstTimeExperience()&&(o.scope.viewModel.manageDataSourcesExpand=!1,o.scope.viewModel.refreshSectionExpand=!0);
}),!0),this.initializeDataset(),this.initializeQna()}return t.createOptions=function(){return{additionalServices:["$sce","datasetsService","errorService","featureSwitchService","groupService","historyDialogService","lazy","localizationService","modelHttpService","modelService","navigation","refreshService","telemetryService","notificationToast","userInfo","promiseFactory","gatewaysMetadataService","gatewaysMetadataHttpService","conceptualSchemaProxy","dataProxy","modalDialogService","selectGatewayService","licenseEnforcementService"]}},t.areYouSureYouWantToLeaveThisDataset=function(e,i,o){var r=e.control(),a=i.get("SettingsDataset_DiscardChangesWarning_YesOption"),n=i.get("SettingsDataset_DiscardChangesWarning_CancelOption"),s=[new InJs.ModalDialogAction(a,function(e,i){r.hideDialog(),t.closeDataset(o)}),new InJs.ModalDialogAction(n,function(e,t){r.hideDialog()})],c=i.get("SettingsDataset_DiscardChangesWarning_Title"),l=i.get("SettingsDataset_DiscardChangesWarning_DatasetMessage");r.showCustomDialog(c,$("<div/>").text(l),s,(function(e){e.parent().find('input[value="'+n+'"]').focus()}),!0)},t.closeDataset=function(e){e.navigateBack()},t.prototype.onModelUpdated=function(e,t){var i=this.scope.viewModel&&this.scope.viewModel.contract;if(i&&i.packageId===t&&i.id===e){var o=this.services.modelService.findModel(i.id,i.packageId),r=o&&o.contract&&o.contract.nextRefreshTime;r&&r!==i.nextRefreshTime&&(i.nextRefreshTime=r,this.updateRefreshTime(i))}},t.prototype.initializeDataset=function(){var e=this.scope.viewModel.contract;e.refreshSchedule=this.services.modelService.getModelRefreshSchedule(this.model.dataset.modelId,this.model.dataset.packageId),this.contentProviderId=e.contentProviderId,this.scope.showDiscoverDatasourcesSpinner=!0,this.scope.showDiscoverStorageSourcesSpinner=!0,this.initializeStorageSource(e),this.initializeDataSources(e.directQueryMode),this.checkIfModelRefreshDisabledBySelectiveRefresh()},t.prototype.checkIfModelRefreshDisabledBySelectiveRefresh=function(){var t=this.services.featureSwitchService;if(t.featureSwitches.selectiveModelRefresh){var i=this.scope.viewModel&&this.scope.viewModel.contract;if(i){var o=this.services.modelService.findModel(i.id,i.packageId);o&&o.isRefreshDisabledDueToInactivity()&&(this.scope.showHeaderMessage=!0,this.scope.headerMessage=this.services.localizationService.get("SettingsDataSet_InactiveModelRefreshDisabled"),this.scope.headerLearnMoreLink=e.constants.configureScheduledRefreshLink)}}},t.prototype.initializeDataSources=function(e,t){e?this.retrieveModelForDirectQueryAndApplyToScope(t):this.retrieveModelForRefreshAndApplyToScope(t)},t.prototype.initializeStorageSource=function(e){this.scope.showStorageRefresh=this.isStorageRefreshAllowed(e),this.scope.showStorageConnection=this.isStorageCredentialAllowed(e),this.scope.showStorageRefresh||this.scope.showStorageConnection?(this.scope.showDiscoverStorageSourcesSpinner=!0,this.scope.storageRefreshEnabledInitialValue=e.isPackageRefreshEnabled,this.getStorageSourceForModel()):this.scope.showDiscoverStorageSourcesSpinner=!1},t.prototype.isSalesforceAllowed=function(e){return this.services.featureSwitchService.featureSwitches.salesforceAndOneDriveCredentialsEnabled&&"undefined"!=typeof e&&e.contentProviderId===i.salesforce},t.prototype.isStorageCredentialAllowed=function(e){return this.services.featureSwitchService.featureSwitches.salesforceAndOneDriveCredentialsEnabled&&"undefined"!=typeof e&&e.storageProviderType===c.OneDrive},t.prototype.isStorageRefreshAllowed=function(e){return this.services.featureSwitchService.featureSwitches.salesforceAndOneDriveCredentialsEnabled&&this.scope.storageRefreshSupported&&"undefined"!=typeof e&&(e.storageProviderType===c.OneDrive||e.storageProviderType===c.SharePoint)},t.prototype.retrieveModelForRefreshAndApplyToScope=function(t){var i=this;void 0===t&&(t=!1);var o=this.scope.viewModel.contract;if(this.updateLastTakeoverEmail(o,t),this.canModelShowDatasource(o)){this.scope.isOnPremGatewayRequired=n.onpremGatewayRequired(o),this.scope.isOnPremGatewayAllowed=n.onpremGatewayAllowed(o);var r=this.services.licenseEnforcementService.supportsEditDatasetConfiguration(o);r?(this.initializeModelRefreshSettings(o),this.scope.disableDatasourcesSection=!1,this.services.datasetsService.migrateAdmsDatasources(this.model.dataset.modelId.toString(),null).then((function(e){if(e.data)for(var t=0,o=i.model.dataset.contract.refreshConnections;t<o.length;t++){var r=o[t];r.connectionType=l.DMTS}})).finally((function(){i.scope.isOnPremGatewayRequired?i.retrieveGateway():i.retrieveDatasourcesOnDataset()}))):this.disableEntirePageParametered("UpgradeAccount_ScheduleOnPremDataRefreshMessage",!1,[e.common.constants.FreeTrialPeriod])}this.scope.isHidden=o.isHidden,this.scope.datasetPageReady=!0},t.prototype.initializeModelRefreshSettings=function(e){var t=n.convertModelToDataset(e).refreshSettings;this.model.dataset.refreshSettings=t,t.refreshEnabled||"UTC"!==t.refreshTimeZoneId||!_.isEmpty(t.refreshTimesHourly)&&1!==t.refreshTimesHourly.length||this.setDefaultTimeZone(),this.model.dataset.parameters=e.parameters,this.scope.disableEntireRefreshPage=!1,this.scope.disableRefreshSection=!1,this.updateRefreshTime(e),this.watchForRefreshSettingsChanges()},t.prototype.watchForRefreshSettingsChanges=function(){var e=this;this.scope.$watch("viewModel.refreshSettings",(function(t,i){i!==t&&(e.model.dataset.isDirty=!0)}),!0)},t.prototype.canModelShowDatasource=function(e){if(!e)return this.disableEntirePage("SettingsDataset_DisableEntireRefreshPageErrorMessage_ModelNotSupported",!0),this.scope.isHidden=e.isHidden,this.scope.datasetPageReady=!0,!1;var t=this.isSalesforceAllowed(e),i=this.isStorageRefreshAllowed(e);return t?this.canModelShowDatasourceForSalesforce(e):i?this.canModelShowDatasourceForOneDrive(e):this.canModelShowDatasourceForDataMovement(e)},t.prototype.canModelShowDatasourceForSalesforce=function(e){return e.refreshSchedule.isRefreshable===!0||(this.disableEntirePage("SettingsDataset_DisableEntireRefreshPageErrorMessage_DataSourcesNotSupported",!0),!1)},t.prototype.canModelShowDatasourceForOneDrive=function(e){return e.onPremModelConnectionString?(this.disableRefreshSection("SettingsDataset_DisableEntireRefreshPageErrorMessage_OnPremAnalysisServicesScheduleInfo"),!1):e.isHidden||this.modelHasRefreshConnections(e)?!!this.modelSupportsRefresh(e)||(this.disableRefreshSection(),!1):(this.disableRefreshSection(),!1)},t.prototype.canModelShowDatasourceForDataMovement=function(e){return e.onPremModelConnectionString?(this.services.featureSwitchService.featureSwitches.directQueryScheduledRefresh?(this.initializeModelRefreshSettings(e),this.scope.disableDatasourcesSection=!0):this.disableRefreshSection("SettingsDataset_DisableEntireRefreshPageErrorMessage_OnPremAnalysisServicesScheduleInfo"),this.showDataSourcesStatus(),!1):e.isHidden||this.modelHasRefreshConnections(e)?!!this.modelSupportsRefresh(e)||(this.disableRefreshSection("SettingsDataset_DisableEntireRefreshPageErrorMessage_DataSourcesNotSupported",!0),!1):(this.disableRefreshSection("SettingsDataset_DisableEntireRefreshPageErrorMessage_DataSourcesHasNoConnection"),!1)},t.prototype.modelHasRefreshConnections=function(e){return e.refreshConnections&&e.refreshConnections.length>0},t.prototype.modelSupportsRefresh=function(t){var i=!!this.services.featureSwitchService.featureSwitches.directQueryScheduledRefresh;return!(!i||!e.common.models.SettingsDatasetModel.isDirectQueryOrOnPremModel(t))||t.refreshSchedule.isRefreshable&&t.isAllDataSourcesSupportedForRefresh},t.prototype.retrieveModelForDirectQueryAndApplyToScope=function(e){var t=this;void 0===e&&(e=!1);var i=this.scope.viewModel.contract;this.services.licenseEnforcementService.supportsEditDatasetConfiguration(i)||this.disableEntirePage("SettingsDataset_DisableEntireRefreshPageErrorMessage_NeedProAccount");var o=!!this.services.featureSwitchService.featureSwitches.directQueryScheduledRefresh;this.scope.hasRefreshSchedule=o,this.scope.isOnPremGatewayRequired=!1,this.scope.hasEditableDatasources=!1,this.scope.isHidden=i.isHidden,this.contentProviderId=i.contentProviderId,o&&this.watchForRefreshSettingsChanges(),this.model.dataset.parameters=i.parameters,this.updateLastTakeoverEmail(i,e).then((function(){t.model.dataset.takenOver?t.getDatasourcesForDirectQuery():(t.model.dataset.contract.refreshConnections&&t.model.dataset.contract.refreshConnections.length>0?(t.scope.hasEditableDatasources=!1,t.scope.isCloudDirectQuery=!0):t.disableEntirePage("SettingsDataset_DisableEntireRefreshPageErrorMessage_DatasetSettingsNotSupported"),t.scope.datasetPageReady=!0)}))},t.prototype.updateLastTakeoverEmail=function(t,i){var o=this,r=this.services.telemetryService,a=r.startEvent(e.telemetry.DashboardInitializeSettingsDatasetModel),n=this.services.promiseFactory.defer();return i?this.services.modelHttpService.getModel(this.scope.viewModel.modelId,null,a.event).then((function(e){o.model.dataset.contract.creatorUser=e.data.creatorUser,o.updateLastTakeoverEmailInternal(t),n.resolve(null)}),(function(e){o.services.datasetsService.displayOopsErrorAndEndTelemetry(r,o.services.errorService,"SettingsDataset_Error_FailedToLoadModelForRefresh",e,a),n.resolve(null)})):(this.updateLastTakeoverEmailInternal(t),n.resolve(null)),n.promise},t.prototype.updateLastTakeoverEmailInternal=function(t){t.creatorUser?(this.model.dataset.lastTakeoverEmailAddress=this.getEmailAddressForReceivingMail(t.creatorUser),this.model.dataset.takenOver=jsCommon.StringExtensions.equalIgnoreCase(t.creatorUser.emailAddress,e.session.UserInfoUtils.getUPN()),this.scope.isTakeoverStatusReady=!0):(this.model.dataset.lastTakeoverEmailAddress=void 0,this.model.dataset.takenOver=!0,this.scope.viewModel.refreshSectionExpand=!1)},t.prototype.getEmailAddressForReceivingMail=function(e){return _.isEmpty(e.emailAddress)?e.AlternateEmailAddress:e.emailAddress},t.prototype.retrieveGateway=function(){var t=this,i=this.services.datasetsService,o=this.services.telemetryService,r=this.services.errorService,a=o.startEvent(e.telemetry.DashboardRetrieveGateway,this.contentProviderId);this.services.gatewaysMetadataService.getPersonalGateway().then((function(i){t.scope.personalGateway=i,t.scope.personalGatewayAnnotation=e.settings.models.GatewayModelConverter.getGatewayAnnotation(t.scope.personalGateway),t.scope.authDialogParameters.personalGateway=t.scope.personalGateway,t.scope.personalGateway.gatewayStatus===d.NotInstalled?(t.scope.viewModel.gatewayExpand=!1,t.scope.viewModel.manageDataSourcesExpand=!1):t.scope.personalGateway.gatewayStatus===d.NotReachable&&(t.scope.viewModel.gatewayExpand=!0,t.scope.viewModel.manageDataSourcesExpand=!1),t.retrieveDatasourcesOnDataset()}),(function(e){i.displayOopsErrorAndEndTelemetry(o,r,"SettingsDataset_Error_FailedToRetrieveGateway",e,a)}))},t.prototype.getDatasourcesForDirectQuery=function(){var t=this,i=this.services.telemetryService,o=i.startEvent(e.telemetry.DashboardInitializeSettingsDatasetModel),r=this.services.errorService,a=this.services.datasetsService;this.services.gatewaysMetadataService.getModelDataSources(this.model.dataset.modelId).then((function(i){t.scope.showDiscoverDatasourcesSpinner=!1;var o=i;t.scope.isCloudDirectQuery=!0;for(var r=0;r<o.monikers.length;r++){var a=o.monikers[r],s=_.map(a.monikerDataSources,(function(e){return e.dataSourceId}));if(!_.every(s)){t.scope.isCloudDirectQuery=!1;break}var c=_.filter(o.datasources,(function(e){return s.indexOf(e.dataSourceId)>-1}));if(0===c.length||_.some(c,(function(e){return e.onPremGatewayRequired}))){t.scope.isCloudDirectQuery=!1;break}var l=_.map(c,(function(e){return e.gatewayId})),d=_.filter(o.gateways,(function(e){return l.indexOf(e.gatewayId)>-1}));if(_.any(d,(function(e){return e.gatewayName}))){t.scope.isCloudDirectQuery=!1;break}}t.scope.isCloudDirectQuery?(t.scope.hasEditableDatasources=!0,t.scope.viewModel.datasources=_.map(o.datasources,(function(e){return n.convertCloudDirectQueryDatasourceToDatasetDatasource(t.model.dataset.modelId,e)})),_.some(t.scope.viewModel.datasources,(function(t){return t.testConnectionState===e.common.models.TestConnectionState.Failed}))&&(t.scope.viewModel.manageDataSourcesExpand=!0)):(t.services.featureSwitchService.featureSwitches.directQueryScheduledRefresh||t.disableRefreshSection("SettingsDataset_DisableEntireRefreshPageErrorMessage_DatasetSettingsNotSupported"),t.showDataSourcesStatus()),t.scope.datasetPageReady=!0}),(function(n){if(n.error&&n.error.code){var s=e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+n.error.code;"ServerError_ModelHasNoPowerBIDMMoniker"===s?t.disableEntirePage(s,!1):a.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToLoadDatasources",n,o)}else a.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToLoadDatasources",n,o);t.scope.datasetPageReady=!0}))},t.prototype.retrieveDatasourcesOnDatasetForSalesforce=function(){var t=this,i=this.services.telemetryService,o=this.services.errorService,r=this.services.datasetsService;this.shrinkManageDataSourceInnerContainerFirstTimeExperience()&&(this.scope.viewModel.manageDataSourcesExpand=!1,this.scope.viewModel.refreshSectionExpand=!0);var n=this.getSalesforceDatasource(this.model.dataset),s=[n];this.model.dataset.datasources=s,n.testConnectionState=e.common.models.TestConnectionState.Progressing;var c=i.startEvent(e.telemetry.DashboardTestDataSourceConnection);r.testPackageCredentials(n.packageId,c.event).then((function(i){c.resolve(),t.scope.showDiscoverDatasourcesSpinner=!1,i.data?(n.oAuth2URL=i.data.oAuth2Endpoint,n.oAuth2Nonce=i.data.oAuth2Nonce,i.data.testConnectionResponse&&i.data.testConnectionResponse.testPassed?n.testConnectionState=e.common.models.TestConnectionState.Passed:(n.testConnectionState=e.common.models.TestConnectionState.Failed,n.testConnectionErrorMessage=a.convertTestPackageConnectionDetailsToErrorMessage(i.data.testConnectionResponse),t.scope.lastRefreshFailureMessage=t.services.localizationService.get("SettingsDataset_ManageDataSources_Warning_YouNeedToProvideCredentials"),t.scope.viewModel.manageDataSourcesExpand=!0)):(n.testConnectionState=e.common.models.TestConnectionState.Failed,t.scope.viewModel.manageDataSourcesExpand=!0)}),(function(e){r.displayOopsErrorAndEndTelemetry(i,o,"SettingsDataset_Error_FailedToTestConnection",e,c)}))},t.prototype.getStorageSourceForModel=function(){var t=this,i=this.services.telemetryService,o=this.services.errorService,r=this.services.datasetsService;if(this.model.dataset.contract.storageProviderType===c.OneDrive){var n=i.startEvent(e.telemetry.DashboardInitializeSettingsDatasetModel);this.model.dataset.storageSource={modelId:this.model.dataset.modelId,onpremGatewayRequired:!1,packageId:this.scope.viewModel.contract.packageId,name:this.model.dataset.name,credentialTypes:[e.common.contracts.gateway.CredentialType.OAuth2],testConnectionState:e.common.models.TestConnectionState.Progressing},r.testPackageCredentials(this.model.dataset.storageSource.packageId,n.event).then((function(i){n.resolve(),t.scope.storageSourceTraceDetails={activityId:i.activityId,requestId:i.requestId,errorCode:i.status.toString(),time:(new Date).toString(),version:e.build},t.scope.showDiscoverStorageSourcesSpinner=!1,t.model.dataset.storageSource.oAuth2URL=i.data.oAuth2Endpoint,t.model.dataset.storageSource.oAuth2Nonce=i.data.oAuth2Nonce,i.data&&i.data.testConnectionResponse&&i.data.testConnectionResponse.testPassed?t.model.dataset.storageSource.testConnectionState=e.common.models.TestConnectionState.Passed:(t.model.dataset.storageSource.testConnectionState=e.common.models.TestConnectionState.Failed,t.isFileNotFoundCode(i.data.testConnectionResponse)?t.disableStorageSourceUpdates():(t.model.dataset.storageSource.testConnectionErrorMessage=a.convertTestPackageConnectionDetailsToErrorMessage(i.data.testConnectionResponse),t.scope.viewModel.manageStorageSourceExpand=!0))}),(function(e){r.displayOopsErrorAndEndTelemetry(i,o,"SettingsDataset_Error_FailedToTestConnection",e,n)}))}else this.model.dataset.contract.storageProviderType===c.SharePoint&&(this.model.dataset.storageSource={modelId:this.model.dataset.modelId,onpremGatewayRequired:!1,packageId:this.scope.viewModel.contract.packageId,name:this.model.dataset.name,credentialTypes:[e.common.contracts.gateway.CredentialType.OAuth2],testConnectionState:e.common.models.TestConnectionState.Progressing},this.model.dataset.storageSource.testConnectionState=e.common.models.TestConnectionState.Passed,this.scope.showDiscoverStorageSourcesSpinner=!1)},t.prototype.hasDmtsPersonalGateway=function(){return this.scope.personalGateway&&this.scope.personalGateway.gatewayId>0},t.prototype.retrieveDatasourcesOnDataset=function(){this.scope.viewModel.contract.contentProviderId===i.salesforce?this.retrieveDatasourcesOnDatasetForSalesforce():this.retrieveDatasourcesOnDatasetForDataMovement()},t.prototype.retrieveDatasourcesOnDatasetForDataMovement=function(){var t=this,i=this.services.telemetryService,o=i.startEvent(e.telemetry.DashboardInitializeSettingsDatasetModel),r=this.services.errorService,s=this.services.datasetsService,c=this.services.gatewaysMetadataService;this.services.featureSwitchService.featureSwitches.isSovereignCloud||this.hasDmtsPersonalGateway()||n.shouldUseDMTS(this.model.dataset.contract.refreshConnections,null)?c.getModelDataSources(this.model.dataset.modelId).then((function(a){if(o.resolve(),t.scope.showDiscoverDatasourcesSpinner=!1,a){for(var s=t.services.selectGatewayService.getSelectedGateway(a),l=[],d=n.convertDMTSDiscoverDatasourcesResponseToDatasources(t.model.dataset.modelId,n.getEffectiveDatasourcesFromDiscoverDatasourceResponse(a,s?s.gatewayId:null)),u=function(e){var t=_.find(a.gateways,(function(t){return t.gatewayId===e.gatewayId})).gatewayType;t===p.Personal&&l.push(e)},v=0,h=d;v<h.length;v++){var g=h[v];u(g)}if(t.shrinkManageDataSourceInnerContainerFirstTimeExperience()&&(t.scope.viewModel.manageDataSourcesExpand=!1,t.scope.viewModel.refreshSectionExpand=!0),t.model.dataset.datasources=l,!_.isEmpty(l)){n.getDatasourceNames(l);for(var m=0,f=l;m<f.length;m++){var g=f[m];!(function(i){i.testConnectionState=e.common.models.TestConnectionState.Progressing,c.getDataSourceStatus(i.gatewayId,i.datasourceId).then((function(){i.testConnectionState=e.common.models.TestConnectionState.Passed}),(function(o){i.testConnectionState=e.common.models.TestConnectionState.Failed,t.scope.viewModel.manageDataSourcesExpand=!0,e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(o.error).done((function(r){var a=[];if(r&&r.displayableErrorInfo)for(var n=0,s=r.displayableErrorInfo;n<s.length;n++){var c=s[n];a.push({key:c.errorInfoKey,value:c.errorInfoValue})}i.testConnectionErrorMessage=t.services.localizationService.get(e.helpers.PowerBIServiceExceptionErrorHelper.serverErrorPrefix+o.error.code),i.testConnectionErrorMessage+=JSON.stringify(a)}))}))})(g)}}}else c.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToLoadDatasources",o)}),(function(e){t.scope.showDiscoverDatasourcesSpinner=!1,c.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToLoadDatasources",o,e)})):c.getAdmsAggregatedDatasourcesForOneModel(this.model.dataset.modelId.toString(),!1).then((function(s){if(o.resolve(),t.scope.showDiscoverDatasourcesSpinner=!1,s){t.model.dataset.datasources=n.convertDiscoverAggregatedDatasourcesResponseToDatasources(t.model.dataset.modelId,s),t.shrinkManageDataSourceInnerContainerFirstTimeExperience()&&(t.scope.viewModel.manageDataSourcesExpand=!1,t.scope.viewModel.refreshSectionExpand=!0);var l=t.model.dataset.datasources;if(l){n.getDatasourceNames(l);for(var d=l.length,p=0;p<d;p++){var u=l[p];!(function(n){n.testConnectionState=e.common.models.TestConnectionState.Progressing;var s=i.startEvent(e.telemetry.DashboardTestDataSourceConnection);c.testAdmsDataSourceConnection(n.admsDatasourceId,n.modelId).then((function(i){s.resolve(),i&&i.instanceTestConnectionResults&&i.instanceTestConnectionResults.testPassed?n.testConnectionState=e.common.models.TestConnectionState.Passed:(n.testConnectionState=e.common.models.TestConnectionState.Failed,n.testConnectionErrorMessage=a.convertADMSTestConnectionResultToErrorMessage(i),t.scope.viewModel.manageDataSourcesExpand=!0)}),(function(e){c.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToTestConnection",o)}))})(u)}}}else c.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToLoadDatasources",o)}),(function(e){t.scope.showDiscoverDatasourcesSpinner=!1,s.displayOopsErrorAndEndTelemetry(i,r,"SettingsDataset_Error_FailedToLoadDatasources",e,o)}))},t.prototype.updateRefreshTime=function(i){this.scope.lastRefreshFailed=!1,this.scope.nextRefreshTime=e.common.localize.get("SettingsDataset_ScheduleRefresh_NextRefresh")+n.convertRefreshTimeToJsDateTime(i.nextRefreshTime).toString();var o=this.scope.viewModel.contract.refreshHistories;if(o&&0!==o.length){var r=o[0];if(4===r.status)return void(this.scope.nextRefreshTime="");if(r.isSuccessful||1===r.status){var a=n.convertRefreshTimeToJsDateTime(o[0].endTime);this.scope.lastRefreshStatus=e.common.localize.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshSucceeded",[""+a])}else if(r.endTime){this.scope.lastRefreshHistoryDetails=t.convertErrorDetailsJson(o[0].serviceExceptionJson),this.scope.lastRefreshFailureMessage=t.getFriendlyErrorMessage(o[0].serviceExceptionJson);var a=n.convertRefreshTimeToJsDateTime(o[0].endTime);this.scope.lastRefreshStatus=e.common.localize.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshFailed",[""+a]),this.scope.lastRefreshFailed=!0}else{var s=n.convertRefreshTimeToJsDateTime(o[0].startTime);s.getTime()+18e5>Date.now()?this.scope.lastRefreshStatus=e.common.localize.get("NavigationPane_RefreshInProgress"):this.scope.lastRefreshStatus=e.common.localize.format("SettingsDataset_ScheduleRefresh_FlyoutMessage_LastRefreshSucceeded",[""+a])}}},t.prototype.disableRefreshSection=function(e,t){void 0===t&&(t=!1);for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];e&&(this.scope.headerMessage=i&&i.length>0?this.services.localizationService.format(e,i):this.scope.headerMessage=this.services.localizationService.get(e)),this.scope.headerMessage&&(this.scope.showHeaderMessage=!0),this.scope.disableRefreshSection=!0,this.scope.disableDatasourcesSection=!0},t.prototype.disableEntirePageParametered=function(e,t){void 0===t&&(t=!1);for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];this.scope.disableEntireRefreshPage=!0,this.scope.showHeaderMessage=!0,i&&i.length>0?this.scope.headerMessage=this.services.localizationService.format(e,i):this.scope.headerMessage=this.services.localizationService.get(e),this.scope.disabledEntireRefreshPageShowLearnMoreLink=t},t.prototype.disableEntirePage=function(e,t){void 0===t&&(t=!1),this.scope.disableEntireRefreshPage=!0,this.scope.showHeaderMessage=!0,this.scope.headerMessage=this.services.localizationService.get(e),this.scope.disabledEntireRefreshPageShowLearnMoreLink=t},t.prototype.disableStorageSourceUpdates=function(){this.scope.storageSourceFileNotFound=!0,this.scope.displayIcon=e.common.models.InlineMessageIcon.Error,this.scope.showHeaderMessage=!0,this.scope.headerMessage=this.services.localizationService.get("SettingsDataset_OneDrive_FileNotFound"),this.scope.viewModel.manageStorageSourceExpand=!1,this.scope.viewModel.manageStorageRefreshExpand=!1},t.prototype.initializeQna=function(){var e=this,t=this.scope,i=t.viewModel.contract,o=this.services.featureSwitchService.featureSwitches;t.viewModel.isQnaDirty=!1;var r=!i.isHidden&&i.qnaSupported,a=o.cortanaEnabled!==!1&&(!i.directQueryMode||2===i.pushDataVersion||o.qnaSupportDQEnabled)&&(!i.onPremModelConnectionString||o.qnaSupportOnPremEnabled),n=i.directQueryMode&&2!==i.pushDataVersion&&o.qnaSupportDQEnabled||i.onPremModelConnectionString&&o.qnaSupportOnPremEnabled;r&&(a||n)?t.qna={showCortanaSetting:a,showOnPremiseSetting:n,cortanaEnabled:i.cortanaEnabled,powerBIQnaEnabled:i.powerBIQnaEnabled,apply:function(){return e.applyQnaSettings()},discard:function(){return e.discardChanges()}}:t.qna=null},t.prototype.applyQnaSettings=function(){var t=this.scope,i=t.qna,o=t.viewModel.contract,r=this.services;if(i.powerBIQnaEnabled!==o.powerBIQnaEnabled||i.cortanaEnabled!==o.cortanaEnabled){var a={};i.powerBIQnaEnabled!==o.powerBIQnaEnabled&&(a.powerBIQnaEnabled=i.powerBIQnaEnabled),i.cortanaEnabled!==o.cortanaEnabled&&(a.cortanaEnabled=i.cortanaEnabled),r.modelService.updateModelQnaFeatures(this.model.dataset.modelId,a).then((function(){o.powerBIQnaEnabled=i.powerBIQnaEnabled,o.cortanaEnabled=i.cortanaEnabled,t.viewModel.isQnaDirty=!1}),(function(){r.errorService.error(e.common.localize.get("SettingsGeneral_Error_FailedToSave"),"SettingsGeneral_Error_FailedToSave")}))}else t.viewModel.isQnaDirty=!1},t.prototype.editStorageSource=function(){if(this.model.dataset&&this.model.dataset.storageSource){var e=this.scope.authDialogParameters;e.isImportScenario=!1,e.providerId=this.contentProviderId,e.datasource=this.model.dataset.storageSource,e.dialogTitle=this.services.localizationService.format("AuthDialog_Configure",[this.model.dataset.name]),e.updatePackage=!0,e.showAuthDialog=!0,e.showModalDialog=!0}},t.prototype.editDatasource=function(e){if(this.model.dataset.takenOver){var t=this.scope.viewModel.datasources.indexOf(e);if(this.model.dataset.areDatasourcesDirty=!0,this.scope.authDialogParameters.datasource=e,this.model.dataset.contract.contentProviderId===i.salesforce&&(this.scope.authDialogParameters.updatePackage=!0),void 0===this.model.dataset.parameters||void 0!==this.model.dataset.parameters&&0===this.model.dataset.parameters.length)this.showAuthDialog({dsIndex:t});else{var o=this.scope.datasetParametersDialogParameters;o.isImportScenario=!1,o.providerIdentification?o.providerIdentification.providerId=this.contentProviderId:o.providerIdentification={providerId:this.contentProviderId},o.datasetModel={},o.datasetModel.dataset=this.model.dataset,o.dialogTitle=this.services.localizationService.format("DatasetParametersDialog_Configure",[this.model.dataset.name]),o.dsIndex=t,o.showDatasetParametersDialog=!0}}},t.prototype.showAuthDialog=function(e){var t=this.scope.authDialogParameters;t.isImportScenario=!1,t.showError=!1,t.selectedAuthenticationIndex=0,t.providerId=this.contentProviderId,t.datasource=this.model.dataset.datasources[e.dsIndex],t.dialogTitle=this.services.localizationService.format("AuthDialog_Configure",[this.model.dataset.name]),t.showAuthDialog=!0,t.showModalDialog=!0,t.validateParameters=!!e.validateParameters&&e.validateParameters},t.prototype.updateOnPremGatewayOverride=function(t){var i=this;this.services.telemetryService.logEvent(e.telemetry.DashboardForceScheduleRefreshUseITGW,t),this.services.datasetsService.updateModelOnPremisesGatewayOverride(this.model.dataset.modelId.toString(),t).then((function(e){i.retrieveModelForRefreshAndApplyToScope()}),(function(e){i.retrieveModelForRefreshAndApplyToScope()}))},t.prototype.showHistoryDialog=function(e){this.services.historyDialogService.showHistoryDialog(e)},t.prototype.datasetDatasourceUpdated=function(t){var i=this;this.scope.isCloudDirectQuery&&this.clearDataCaches(),this.services.localizationService.ensureLocalization((function(){i.services.notificationToast.notify({title:i.services.localizationService.format("SettingsDataset_Notification_DatasourceUpdated_Title",[t]),message:i.services.localizationService.format("SettingsDataset_Notification_DatasourceUpdated_Message",[t]),notificationType:e.common.NotificationToastType.Success})}))},t.prototype.clearDataCaches=function(){var e={dbName:this.model.dataset.contract.dbName,modelId:this.model.dataset.modelId,vsName:this.model.dataset.contract.vsName,schemaName:void 0};this.services.conceptualSchemaProxy.clearCache(),this.services.dataProxy.clearCache("dsr",[e])},t.prototype.showParameterDialogWithInvalidParameterMessage=function(e){var t=this;this.scope.$applyAsync((function(){t.scope.datasetParametersDialogParameters.showDatasetParametersDialog=!0,t.scope.datasetParametersDialogParameters.showSpinner=!1,t.scope.datasetParametersDialogParameters.showValidationError=!0,t.scope.datasetParametersDialogParameters.invalidParameterNameValuePairs=e,t.scope.authDialogParameters.showAuthDialog=!1,t.scope.authDialogParameters.showModalDialog=!1}))},t.prototype.applyChanges=function(){var t=this,i=this.validateApplyChanges();i!==!1&&(this.model.dataset.isDirty?(this.updateRefreshScheduleData(),this.scope.refreshScheduleComplete=!0):this.services.localizationService.ensureLocalization((function(){t.services.notificationToast.notify({title:t.services.localizationService.format("SettingsDataset_Notification_RefreshScheduleUpdated_Title",[t.model.dataset.name]),message:t.services.localizationService.format("SettingsDataset_Notification_RefreshScheduleUpdated_Message",[t.model.dataset.name]),notificationType:e.common.NotificationToastType.Success})})),this.model.dataset.areDatasourcesDirty=!1)},t.prototype.tryProAccount=function(){return __awaiter(this,void 0,e.Promise,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.services.lazy("licenseHelper")];case 1:return t=i.sent(),this.services.userInfo.userFreeTrialExpired?t.displayDialogToExtendTrial(e.telemetry.LicenseEnforcementOperation.Dataset):t.displayDialogToAcceptTrialTerms(e.telemetry.LicenseEnforcementOperation.Dataset),[2]}}))}))},t.prototype.validateApplyChanges=function(){var t=this,i=!0,o=this.model.dataset.refreshSettings.refreshFrequency,r=1440===o,a=10080===o;if(!r&&!a)return i;var s=r?e.common.constants.allWeekDays:n.convertDatasetWeekdaysToModelWeekdays(this.model.dataset.refreshSettings.refreshDays);r===!1&&0===s&&(i=!1,this.services.localizationService.ensureLocalization((function(){t.services.notificationToast.notify({title:t.services.localizationService.format("SettingsDataset_Notification_RefreshScheduleCannotBeUpdated_Title",[t.model.dataset.name]),message:t.services.localizationService.get("SettingsDataset_Notification_RefreshScheduleCannotBeUpdated_Message"),notificationType:e.common.NotificationToastType.Error})})));var c=this.model.dataset.refreshSettings.refreshTimesHourly;if(i&&this.scope.hasLicenseForProModel&&c&&c.length>0){for(var l=c.length,d=0;d<l;d++){var p=c[d];if(void 0===p.refreshAmPmIndex||void 0===p.refreshHourIndex||void 0===p.refreshMinuteIndex)i=!1,p.isIncomplete=!0;else{p.isIncomplete=!1;for(var u=0;u<d;u++){var v=c[u];if(p.refreshAmPmIndex===v.refreshAmPmIndex&&p.refreshHourIndex===v.refreshHourIndex&&p.refreshMinuteIndex===v.refreshMinuteIndex){i=!1,p.isDuplicate=!0;break}p.isDuplicate=!1}}}i||this.services.localizationService.ensureLocalization((function(){t.services.notificationToast.notify({title:t.services.localizationService.format("SettingsDataset_Notification_RefreshScheduleCannotBeUpdated_Title",[t.model.dataset.name]),message:t.services.localizationService.get("SettingsDataset_Notification_RefreshScheduleCannotBeUpdatedTimeFormat_Message"),notificationType:e.common.NotificationToastType.Error})}))}return i},t.prototype.updateRefreshScheduleData=function(){var t=this,i=n.convertSettingModelToRefreshScheduleContract(this.model.dataset.refreshSettings,!this.scope.hasLicenseForProModel),o=this.services.telemetryService,r=o.startEvent(e.telemetry.DashboardSettingsDatasetsSaveRefreshSettings,i.refreshEnabled,i.isDaily,i.weekDays,i.refreshNotificationEnabled,this.contentProviderId),a=this.services.errorService,s=this.services.datasetsService,c=this.services.refreshService;c.updateRefreshSchedule(this.model.dataset.modelId.toString(),i,r.event).then((function(i){r.resolve(),t.model.dataset.isDirty=!1,t.services.localizationService.ensureLocalization((function(){t.services.notificationToast.notify({title:t.services.localizationService.format("SettingsDataset_Notification_RefreshScheduleUpdated_Title",[t.model.dataset.name]),message:t.services.localizationService.format("SettingsDataset_Notification_RefreshScheduleUpdated_Message",[t.model.dataset.name]),notificationType:e.common.NotificationToastType.Success
})}))}),(function(e){s.displayOopsErrorAndEndTelemetry(o,a,"SettingsDataset_Error_FailedToSaveRefreshSettings",e,r)}))},t.prototype.discardChanges=function(){this.model.dataset.isDirty||this.scope.viewModel.isQnaDirty?t.areYouSureYouWantToLeaveThisDataset(this.services.errorService,this.services.localizationService,this.services.navigation):t.closeDataset(this.services.navigation)},t.prototype.addRefreshTime=function(){this.shouldRefreshSettingsDisabled()||(void 0===this.model.dataset.refreshSettings.refreshTimesHourly&&(this.model.dataset.refreshSettings.refreshTimesHourly=[]),this.model.dataset.refreshSettings.refreshTimesHourly.push({}))},t.prototype.removeRefreshTime=function(e){if(!this.shouldRefreshSettingsDisabled()){var t=this.model.dataset.refreshSettings.refreshTimesHourly;if(!t||t.length<e)return;t.splice(e,1)}},t.prototype.canAddRefreshTime=function(){var t=this.model.dataset.refreshSettings.refreshTimesHourly;return!t||t.length<e.common.constants.maxRefreshTimeNumber},t.prototype.shouldRefreshSettingsToggleDisabled=function(){return!this.model.dataset.takenOver||this.model.dataset.hasDatasourceWithWrongCredentials&&!this.scope.selectGatewayModel.useEnterpriseGateway||this.scope.isOnPremGatewayRequired&&!this.scope.selectGatewayModel.useEnterpriseGateway&&this.scope.personalGateway&&!this.scope.personalGateway.gatewayAnnotation},t.prototype.shouldRefreshSettingsDisabled=function(){return this.shouldRefreshSettingsToggleDisabled()||!this.model.dataset.refreshSettings.refreshEnabled},t.prototype.shouldDatasourceCredentialsDisabled=function(){return!this.scope.viewModel.takenOver||this.scope.isOnPremGatewayAllowed&&(this.scope.isOnPremGatewayRequired&&this.scope.personalGateway&&this.scope.personalGateway.gatewayStatus===d.NotReachable||this.services.featureSwitchService.featureSwitches.enterpriseGatewayETLEnabled&&(this.scope.selectGatewayModel.useEnterpriseGateway||void 0===this.scope.selectGatewayModel.useEnterpriseGateway))},t.prototype.shouldSettingsDatasetButtonDisable=function(){return!this.model.dataset.isDirty&&!this.model.dataset.areDatasourcesDirty||this.shouldRefreshSettingsToggleDisabled()},t.prototype.updateStorageSourceRefresh=function(){if(this.scope.storageRefreshEnabledInitialValue!==this.scope.viewModel.contract.isPackageRefreshEnabled){if(this.shouldPackageRefreshSettingsToggleDisabled())return;this.scope.packageRefreshScheduleUpdateInProgress=!0;var t=this.scope.viewModel.contract.packageId,i=this.services.telemetryService.startEvent(e.telemetry.DashboardInitializeSettingsDatasetModel);this.scope.viewModel.contract.cloudRlsEnabled&&this.scope.viewModel.contract.isPackageRefreshEnabled&&!this.services.featureSwitchService.featureSwitches.cloudRlsRoleMembershipEnabled?this.confirmEnableStorageRefreshAndOverwriteRls(t,i):this.updatePackageRefreshEnabled(t,i),this.scope.packageRefreshScheduleUpdateInProgress=!1}},t.prototype.confirmEnableStorageRefreshAndOverwriteRls=function(t,i){var o=this,r=this.services.rootScope.$new(),a=this.services.localizationService.get("ModalDialogButtonText_Continue"),n=this.services.localizationService.get("ModalDialogButtonText_Cancel"),s=this.services.telemetryService,c=this.scope.viewModel.contract.id,l=[new InJs.ModalDialogAction(a,function(a,n){s.logEvent(e.telemetry.RowLevelSecurityDisableRLS,e.telemetry.DisableRLSSource.OneDriveRefreshEnabled,!0,c),o.services.modelHttpService.disableRlsModel(c,i.event).then((function(e){o.scope.viewModel.contract.cloudRlsEnabled=!1,o.services.modelService.updateContractModel(o.scope.viewModel.contract),o.updatePackageRefreshEnabled(t,i)}),(function(e){o.services.datasetsService.displayOopsErrorAndEndTelemetry(s,o.services.errorService,"SettingsDataset_Error_FailedToUpdatePackageRefreshSchedule",e,i)})),r.closeDialog()}),new InJs.ModalDialogAction(n,function(t,i){s.logEvent(e.telemetry.RowLevelSecurityDisableRLS,e.telemetry.DisableRLSSource.OneDriveRefreshEnabled,!1,c),o.scope.$applyAsync((function(){o.scope.viewModel.manageStorageRefreshExpand=!0,o.scope.viewModel.contract.isPackageRefreshEnabled=o.scope.storageRefreshEnabledInitialValue})),r.closeDialog()})],d=this.services.localizationService.get("SettingsDataset_RefreshStorageSource_OverwritingRlsWarning_Title"),p=this.services.localizationService.get("SettingsDataset_RefreshStorageSource_OverwritingRlsWarning_Message"),u={dialogName:d,isDismissable:!1,scope:r,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",dialogActions:l,notificationType:jsCommon.ModalDialogNotificationType.SecurityWarning,htmlMessageText:p};this.services.modalDialogService.showLegacyWebModalDialog(u)},t.prototype.updatePackageRefreshEnabled=function(e,t){var i=this;this.services.datasetsService.updatePackageRefreshEnabled(e,this.scope.viewModel.contract.isPackageRefreshEnabled,t.event).then((function(e){t.resolve(),e?i.scope.storageRefreshEnabledInitialValue=i.scope.viewModel.contract.isPackageRefreshEnabled:(i.scope.viewModel.manageStorageRefreshExpand=!0,i.scope.viewModel.contract.isPackageRefreshEnabled=i.scope.storageRefreshEnabledInitialValue)}),(function(e){i.services.datasetsService.displayOopsErrorAndEndTelemetry(i.services.telemetryService,i.services.errorService,"SettingsDataset_Error_FailedToUpdatePackageRefreshSchedule",e,t)}))},t.prototype.shrinkManageDataSourceInnerContainerFirstTimeExperience=function(){return this.scope.firstTimeExperience&&this.scope.personalGateway.gatewayStatus===d.Live&&!this.model.dataset.hasDatasourceWithWrongCredentials},t.prototype.shouldScheduleRefreshContainerDisabled=function(){return!this.model.dataset.takenOver||this.scope.firstTimeExperience&&this.scope.isOnPremGatewayRequired&&this.scope.personalGateway.gatewayStatus!==d.Live&&!this.scope.selectGatewayModel.useEnterpriseGateway||this.scope.isOnPremGatewayRequired&&this.services.featureSwitchService.featureSwitches.enterpriseGatewayETLEnabled&&void 0===this.scope.selectGatewayModel.useEnterpriseGateway},t.prototype.shouldGatewaysContainerDisabled=function(){return!this.model.dataset.takenOver||this.scope.isOnPremGatewayRequired&&this.scope.selectGatewayModel.pgw&&this.scope.selectGatewayModel.pgw.gatewayStatus===e.common.contracts.gateway.GatewayStatus.NotInstalled&&void 0===this.scope.selectGatewayModel.enterpriseGateways},t.prototype.shouldPackageRefreshSettingsToggleDisabled=function(){return!this.dataSetHasStorageSource()||this.model.dataset.storageSource.testConnectionState!==e.common.models.TestConnectionState.Passed||this.scope.packageRefreshScheduleUpdateInProgress===!0},t.prototype.dataSetHasStorageSource=function(){return"undefined"!=typeof this.model&&"undefined"!=typeof this.model.dataset&&"undefined"!=typeof this.model.dataset.storageSource},t.prototype.refreshSettingsToggleChanged=function(){if(this.model&&this.model.dataset&&this.model.dataset.refreshSettings){var e=this.model.dataset;if(!e.refreshSettings.refreshEnabled){var t=e.hasRDataSource;return null===t||void 0===t?void this.popUserConsentDialogIfRequired(this.model):t?void this.confirmRefreshForRDataSource():void 0}}},t.prototype.confirmRefreshForRDataSource=function(){var e=this;this.shouldRefreshSettingsToggleDisabled()||s.confirmRefreshForRDataSource(this.services.errorService,this.services.localizationService,this.services.modalDialogService,this.services.rootScope.$new(),(function(){}),(function(){e.scope.viewModel.refreshSettings.refreshEnabled=!1,e.scope.$applyAsync()}))},t.prototype.popUserConsentDialogIfRequired=function(t){var i=this;if(this.model&&this.model.dataset&&this.model.dataset.modelId){var r=this.services.telemetryService,a=r.startEvent(e.telemetry.DashboardGetAggregatedDatasourcesForOneModel,t.contentProviderId),n=this.services.errorService,s=this.services.datasetsService,c=this.model.dataset.modelId.toString();this.services.gatewaysMetadataService.getAdmsAggregatedDatasourcesForOneModel(c,!1).then((function(t){a.resolve(),i.scope.showDiscoverDatasourcesSpinner=!1;var s=t;if(!s)return void i.services.gatewaysMetadataService.displayOopsErrorAndEndTelemetry(r,n,"SettingsDataset_Error_FailedToLoadDatasources",a);var c=_.some(s,(function(t){var i=t.discoverDataSourceEntry;return!!i.databaseType&&(i.databaseType.toString()===o.Extension.toString()&&i.extensionDatabaseType===e.common.constants.RDataSourceName)}));c&&i.confirmRefreshForRDataSource()}),(function(e){i.scope.showDiscoverDatasourcesSpinner=!1,s.displayOopsErrorAndEndTelemetry(r,n,"SettingsDataset_Error_FailedToLoadDatasources",e,a)}))}},t.prototype.shouldTakeoverContainerShow=function(){return!this.services.groupService.activeGroup.isMyWorkspace&&void 0!==this.model.dataset.lastTakeoverEmailAddress},t.prototype.getTrustedHtml=function(e){return this.services.$sce.trustAsHtml(e)},t.prototype.showTakeoverDialog=function(){var e=this,t=this.services.errorService,i=t.control(),o=[new InJs.ModalDialogAction(this.services.localizationService.get("TakeOver_Confirmation_TakeOverButton_Text"),function(o,r){e.onTakeoverConfirm(t),i.hideDialog()}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){i.hideDialog()})],r=this.services.localizationService.get("TakeOver_Confirmation_Title"),a=$("<div/>").append($("<p/>").text(this.services.localizationService.get("TakeOver_Confirmation_Message_Paragraph1"))).append($("<p/>").text(this.services.localizationService.get("TakeOver_Confirmation_Message_Paragraph2")));i.showCustomDialog(r,a,o,(function(t){t.parent().find('input[value="'+e.services.localizationService.get("ModalDialogButtonText_Cancel")+'"]').focus()}),!0)},t.prototype.onTakeoverConfirm=function(t){var i=this;this.scope.datasetPageReady=!1;var o=this.services.telemetryService,r=this.services.datasetsService;if(this.isModelETL(this.model.dataset.contract)){var a=o.startEvent(e.telemetry.SettingsDeleteAllDatasources);r.deleteAdmsAllDatasources(this.model.dataset.modelId.toString(),a.event).then((function(e){i.retrieveModelForRefreshAndApplyToScope(!0),a.resolve()}),(function(e){r.displayOopsErrorAndEndTelemetry(o,t,"SettingsDataset_Error_FailedToDeleteAllDatasources",e,a)}))}else{var n=o.startEvent(e.telemetry.SettingsTakeoverDatasources);r.takeoverDatasource(this.model.dataset.modelId,n.event).then((function(e){i.initializeDataSources(i.scope.isCloudDirectQuery,!0),n.resolve()}),(function(e){r.displayOopsErrorAndEndTelemetry(o,t,"SettingsDataset_Error_FailedToDeleteAllDatasources",e,n)}))}},t.prototype.isModelETL=function(e){return!e.directQueryMode&&!e.onPremModelConnectionString},t.prototype.getStorageSourceDisplayName=function(){return this.dataSetHasStorageSource()&&this.model.dataset.contract.storageProviderType===c.OneDrive?e.common.localize.get("GetData_OneDrivePersonal_Title"):this.dataSetHasStorageSource()&&this.model.dataset.contract.storageProviderType===c.SharePoint?e.common.localize.get("GetData_OneDriveBusiness_Title"):""},t.prototype.testConnectionProgressing=function(t){return t.testConnectionState===e.common.models.TestConnectionState.Progressing},t.prototype.testConnectionFailed=function(t){return t.testConnectionState===e.common.models.TestConnectionState.Failed},t.prototype.testPackageConnectionProgressing=function(){return!!this.dataSetHasStorageSource()&&this.model.dataset.storageSource.testConnectionState===e.common.models.TestConnectionState.Progressing},t.prototype.testPackageConnectionFailed=function(){return!!this.dataSetHasStorageSource()&&this.model.dataset.storageSource.testConnectionState===e.common.models.TestConnectionState.Failed},t.convertErrorDetailsJson=function(t){if(!t)return null;var i=JSON.parse(t),o=[];return e.helpers.PowerBIServiceExceptionErrorHelper.GenerateErrorMessage(i.error).done((function(e){e.displayableErrorInfo.forEach((function(e){o.push({Name:e.errorInfoKey,Value:e.errorInfoValue})}))})),o},t.getFriendlyErrorMessage=function(t){if(!t)return null;var i,o=JSON.parse(t);return i=e.helpers.PowerBIServiceExceptionErrorHelper.FormatWithNamedParameters(o.error.code,null)},t.prototype.setDefaultTimeZone=function(){var e=jsCommon.Utility.getLocalTimeZoneString(),t=this.model.dataset.refreshTimeZonesViewModel.filter((function(t){return t.key===e}));t.length>0?this.model.dataset.refreshSettings.refreshTimeZoneId=t[0].key:this.model.dataset.refreshSettings.refreshTimeZoneId="UTC"},t.prototype.isFileNotFoundCode=function(e){var t=["SharePointProviderUnableToGetFilesAndFolders","SharePointProviderUnableToGetFileProperties","SharePoint_ItemNotExist","SharePoint_FileNotFound","OneDriveProviderUnableToGetFileProperties"],i=t.indexOf(e.faultCode);return!(i<0)},t.prototype.getSalesforceDatasource=function(t){var i={packageId:t.contract.packageId,modelId:t.modelId,name:t.name,onpremGatewayRequired:!1,alreadyExecutedTestConnection:!1,credentialTypes:[e.common.contracts.gateway.CredentialType.OAuth2]};return i.displayName=n.getDatasourceDisplayName(i),i.fullName=n.getDatasourceDisplayName(i),i},t.prototype.applyGatewaySelection=function(){var t=this;this.services.gatewaysMetadataService.bindModelToGateway(this.model.dataset.modelId,this.scope.selectGatewayModel.selectedGatewayId).then((function(){t.scope.$broadcast(e.settings.constants.gatewaySelectionAppliedEventName),t.scope.selectGatewayModel.useEnterpriseGateway||t.retrieveDatasourcesOnDataset(),t.services.localizationService.ensureLocalization((function(){t.services.notificationToast.notify({title:t.services.localizationService.format("SettingsDataset_Notification_GatewayConnectionUpdated_Title",[t.model.dataset.name]),message:t.services.localizationService.format("SettingsDataset_Notification_GatewayConnectionUpdated_Message",[t.model.dataset.name]),notificationType:e.common.NotificationToastType.Success})}))}),(function(i){var o={requestId:i.requestId,statusCode:i.status.toString()};t.services.errorService.error(e.common.localize.get("SettingsGateways_Error_FailedToBind"),"SettingsGateways_Error_FailedToBind",o)}))},t.prototype.discardGatewaySelection=function(){this.scope.$broadcast(e.settings.constants.gatewaySelectionDiscardedEventName)},t.prototype.enableCortana=function(){this.scope.viewModel.isQnaDirty=!0,this.scope.qna.cortanaEnabled&&(this.scope.qna.powerBIQnaEnabled=!0)},t.prototype.enableQna=function(){this.scope.viewModel.isQnaDirty=!0,this.scope.qna.powerBIQnaEnabled||(this.scope.qna.cortanaEnabled=!1)},t.prototype.updateGatewayHeaderWarning=function(){if(this.services.featureSwitchService.featureSwitches.enterpriseGatewayETLEnabled){var t=this.services.localizationService;if(this.scope.isOnPremGatewayRequired&&!this.hasAnyGateway())return void this.setGatewayWarning(t.get("PGWNotInstalled_EGWNotAvailable"));var i=this.getPGWStatus(),o=e.common.contracts.gateway.GatewayStatus;if(this.isBoundToGateway()){if(this.isBoundToEnterpriseGateway())switch(this.getEGWStatus()){case e.connectivity.models.GatewayStatus.NotReachable:var r=this.getSelectedEnterpriseGateway();return void(0===this.getAvaialableEnterpriseGatewayCount()?this.scope.selectGatewayModel.isCloudScheduleRefresh?this.setGatewayWarning(t.format("EGWOffline_Cloud_Message",[this.getGatewayName(r),this.getGatewayAdminName(r)])):i===o.NotInstalled?this.setGatewayWarning(t.format("PGWNotInstalled_EGWOffline_Message_1",[this.getGatewayName(r)]),t.get("PGWNotInstalled_EGWOffline_Message_2"),t.format("PGWNotInstalled_EGWOffline_Message_3",[this.getGatewayAdminName(r)])):i===o.Live?this.setGatewayWarning(t.format("EGWOffline_OnPrem_Message",[this.getGatewayName(r),this.getGatewayAdminName(r)])):i===o.NotReachable&&this.setGatewayWarning(t.format("EGWOffline_PGWOfflineMessage",[this.getGatewayName(r),this.getGatewayAdminName(r)])):this.scope.selectGatewayModel.isCloudScheduleRefresh?this.setGatewayWarning(t.format("EGWOffline_OtherGatewayAvailable_Cloud_Message",[this.getGatewayName(r),this.getGatewayAdminName(r)])):i===o.NotInstalled?this.setGatewayWarning(t.format("EGWOffline_OtherGatewayAvailable_PGWNotInstalled_Message_1",[this.getGatewayName(r)]),t.get("EGWOffline_OtherGatewayAvailable_PGWNotInstalled_Message_2"),t.format("EGWOffline_OtherGatewayAvailable_PGWNotInstalled_Message_3",[this.getGatewayAdminName(r)])):i===o.Live?this.setGatewayWarning(t.format("EGWOffline_OtherGatewayAvailable_OnPrem_Message",[this.getGatewayName(r),this.getGatewayAdminName(r)])):i===o.NotReachable&&this.setGatewayWarning(t.format("EGWOffline_PGWOfflineMessage_OtherGatewayAvailable",[this.getGatewayName(r),this.getGatewayAdminName(r)])))}else if(!this.scope.selectGatewayModel.isCloudScheduleRefresh)switch(i){case o.NotReachable:return 0===this.getAvaialableEnterpriseGatewayCount()?void this.setGatewayWarning(t.get("PGWOffline_Message")):void this.setGatewayWarning(t.get("PGWOffline_EGWAvailable_Message"))}}else if(this.scope.selectGatewayModel.egwAccessLost)return void(this.scope.selectGatewayModel.isCloudScheduleRefresh?this.setGatewayWarning(t.get("EGWAccessLost_Cloud_Message")):this.setGatewayWarning(t.get("EGWAccessLost_OnPrem_Message")));this.clearGatewayWarning()}},t.prototype.setGatewayWarning=function(t,i,o){void 0===i&&(i=null),void 0===o&&(o=null),this.scope.viewModel.gatewaysExpand=!0,this.scope.headerMessage=t,this.scope.headerLink=i,this.scope.headerGatewayWarning=o,this.scope.showInstallPGWLink=null!=i,this.scope.showHeaderMessage=!0,this.scope.isGatewayWarning=!0,this.scope.displayIcon=e.common.models.InlineMessageIcon.Warning},t.prototype.clearGatewayWarning=function(){this.scope.isGatewayWarning&&(this.scope.headerMessage="",this.scope.headerLink=null,this.scope.headerGatewayWarning=null,this.scope.showHeaderMessage=!1,this.scope.isGatewayWarning=!1,this.scope.showInstallPGWLink=!1,this.scope.displayIcon=e.common.models.InlineMessageIcon.Info)},t.prototype.getGatewayName=function(e){return e?e.displayName:""},t.prototype.getGatewayAdminName=function(e){return e&&e.gatewayAnnotation.gatewayContactInformation&&0!==e.gatewayAnnotation.gatewayContactInformation.length?e.gatewayAnnotation.gatewayContactInformation[0]:""},t.prototype.isBoundToGateway=function(){return this.scope.selectGatewayModel.selectedGatewayId!==-1},t.prototype.isBoundToEnterpriseGateway=function(){return this.scope.selectGatewayModel.useEnterpriseGateway},t.prototype.hasAnyGateway=function(){return this.scope.selectGatewayModel.enterpriseGateways&&this.scope.selectGatewayModel.enterpriseGateways.length>0||this.scope.selectGatewayModel.pgw&&this.scope.selectGatewayModel.pgw.gatewayStatus!==d.NotInstalled},t.prototype.getPGWStatus=function(){return this.scope.selectGatewayModel.pgw?this.scope.selectGatewayModel.pgw.gatewayStatus:d.NotInstalled},t.prototype.getEGWStatus=function(){var t=this.getSelectedEnterpriseGateway();return t?t.status:e.connectivity.models.GatewayStatus.Unknown},t.prototype.getAvaialableEnterpriseGatewayCount=function(){for(var t=0,i=0,o=this.scope.selectGatewayModel.enterpriseGateways;i<o.length;i++){var r=o[i];r.status===e.connectivity.models.GatewayStatus.Live&&t++}return t},t.prototype.getSelectedEnterpriseGateway=function(){var e=this;return _.find(this.scope.selectGatewayModel.enterpriseGateways,(function(t){return t.id===e.scope.selectGatewayModel.selectedGatewayId}))},t.prototype.showGatewayStatus=function(e){return this.services.gatewaysMetadataService.getGatewayStatus(e.gatewayId)},t.prototype.showDataSourcesStatus=function(){var e=this;this.services.gatewaysMetadataService.getModelDataSources(this.scope.viewModel.modelId).then((function(t){var i=e.services.selectGatewayService.getSelectedGateway(t);if(i){var o=n.getEffectiveDatasourcesFromDiscoverDatasourceResponse(t,i.gatewayId),r=o.length,a=0,s=0;if(0===r)return void(e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_NoDataSourceStatusMessage",[i.gatewayName]));for(var c=0,l=o;c<l.length;c++){var d=l[c];e.services.gatewaysMetadataService.getDataSourceStatus(i.gatewayId,d.dataSourceId).then((function(){a++,r===a?e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_GatewayStatusMessage",[i.gatewayName,e.services.localizationService.get("Gateways_Status_Online_Datasource_Online")]):r===a+s&&(e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_GatewayStatusMessage",[i.gatewayName,e.services.localizationService.get("Gateways_Status_Online_Datasource_Offline")]))}),(function(t){s++,r===s?e.showGatewayStatus(i).then((function(t){e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_GatewayStatusMessage",[i.gatewayName,e.services.localizationService.get("Gateways_Status_Online_Datasource_All_Offline")])}),(function(t){t.error.code.match("DM_GWPipeline_Client_GatewayUnreachable")?e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_GatewayStatusMessage",[i.gatewayName,e.services.localizationService.get("Gateways_Status_Offline")]):e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_GatewayDataSourceStatusMessage",[i.gatewayName,e.services.localizationService.get("Gateways_Status_Offline")])})):r===a+s&&(e.scope.gatewayStatusMessage=e.services.localizationService.format("SettingsDataset_GatewayStatusMessage",[i.gatewayName,e.services.localizationService.get("Gateways_Status_Online_Datasource_Offline")]))}))}}}))},t})();t.SettingsDatasetController=u})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=10,r=300,a=(function(){function a(e,t){var a=this;this.scope=e,this.services=t,e.modelSupportsQna=i.getIsQnaSupported(e.viewModel.contract,this.services.featureSwitchService.featureSwitches),e.sectionExpanded=!1,e.maxQuestions=o,e.maxUtteranceLength=r,this.generateQuestionsFromViewModel(),e.deleteQuestion=function(e){return a.deleteQuestion(e)},e.addQuestion=function(){return a.addQuestion()},e.onChange=function(e){return a.onChange(e)},e.applyChanges=function(){return a.applyChanges()},e.discardChanges=function(){return a.discardChanges()},e.isDirty=!1,t.localizationService.ensureLocalization((function(){e.inputAriaLabel=t.localizationService.get("SettingsDataset_FeaturedQuestions_FeaturedQuestionInputLabel")}))}return a.createOptions=function(){return{additionalServices:["errorService","featureSwitchService","localizationService","modelService","navigation"]}},a.prototype.deleteQuestion=function(e){var t=this.scope;t.isDirty=!0,t.questions.splice(e,1),this.checkForValid()},a.prototype.addQuestion=function(){var e=this.scope;e.isDirty=!0;var t={utterance:"",validationMessage:null,isValid:!1};e.questions.push(t),this.onChange(t),e.focusOnLastInput&&this.services.timeout((function(){return e.focusOnLastInput()}),0)},a.prototype.onChange=function(e){if(this.scope.isDirty=!0,!e||_.isEmpty(e.utterance)){var t=this.services.localizationService;t.ensureLocalization((function(){e.validationMessage=t.get("SettingsDataset_FeaturedQuestions_EmptyError")})),e.isValid=!1}else e.validationMessage=null,e.isValid=!0;this.checkForValid()},a.prototype.applyChanges=function(){var t=this,i=this.scope,o=_.map(i.questions,(function(e,t){return{utterance:e.utterance,order:t}}));this.services.modelService.updateFeaturedQuestions(i.viewModel.modelId,o).then((function(){i.isDirty=!1;var e=i.viewModel;e.contract.featuredQuestions=o,t.services.modelService.updateContractModel(t.scope.viewModel.contract)}),(function(){t.services.errorService.error(e.common.localize.get("SettingsGeneral_Error_FailedToSave"),"SettingsGeneral_Error_FailedToSave")}))},a.prototype.discardChanges=function(){this.generateQuestionsFromViewModel(),this.scope.isDirty?t.SettingsDatasetController.areYouSureYouWantToLeaveThisDataset(this.services.errorService,this.services.localizationService,this.services.navigation):t.SettingsDatasetController.closeDataset(this.services.navigation),this.scope.isDirty=!1},a.prototype.checkForValid=function(){var e=this.scope;e.isValid=_.all(e.questions,(function(e){return e.isValid}))},a.prototype.generateQuestionsFromViewModel=function(){var e=this.scope;e.questions=_(e.viewModel.contract.featuredQuestions).sortBy((function(e){return e.order})).map((function(e){return{utterance:e.utterance||"",validationMessage:null,isValid:!0}})).value();for(var t=0,i=e.questions;t<i.length;t++){var o=i[t];this.onChange(o)}},a})();t.SettingsDatasetFeaturedQuestionsController=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.Permissions,o=(function(e){function o(t,o){var r=this;return t.filteredModels=_.filter(o.modelService.getModelContracts(),(function(e){return(e.permissions&i.Write)===i.Write&&!e.isHidden})),r=e.call(this,t,o,"datasets")||this,t.$watch((function(){return o.modelService.lastUpdatedTimestamp}),(function(){r.updateView()})),r}return __extends(o,e),o.createOptions=function(){return t.SettingsDataModelsController.createOptions()},o.prototype.updateView=function(){var e=this.services.usageMetricsReport;this.scope.filteredModels=_.filter(this.services.modelService.getModelContracts(),(function(t){return(t.permissions&i.Write)===i.Write&&!t.isHidden&&!e.modelOriginatedFromUsageMetricsContentPack(t)}));for(var t=0;t<this.scope.filteredModels.length;t++)if(this.scope.filteredModels[t].id===this.scope.viewModel.currentDatasetId)return;this.scope.viewModel.currentDatasetId=null},o})(t.SettingsDataModelsController);t.SettingsDatasetsController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,e.isDirty=!1,e.esriSettings={esriVisualEnabled:e.viewModel.esriVisualEnabled},e.applyChanges=function(){return i.applyChanges()},e.discardChanges=function(){return i.discardChanges()},e.onSettingChange=function(){return e.isDirty=!0},e.esriVisualDisallowed=!this.services.featureSwitchService.featureSwitches.esriVisualEnabled}return t.createOptions=function(){return{additionalServices:["navigation","telemetryService","userSettingsService","featureSwitchService","trustedVisual","visualConsent"]}},t.prototype.applyChanges=function(){var t=this;this.scope.viewModel.esriVisualEnabled===this.scope.esriSettings.esriVisualEnabled?this.services.navigation.navigateBack():this.services.visualConsent.setConsent(e.visualHost.EsriVisual,this.scope.esriSettings.esriVisualEnabled).then((function(e){t.scope.viewModel.esriVisualEnabled=e,t.services.navigation.navigateBack()}))},t.prototype.discardChanges=function(){this.services.navigation.navigateBack()},t})();t.SettingsEsriController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,t.subGroups=[],e.common.localize.ensureLocalization((function(){o.services.featureSwitchService.featureSwitches.previewConceptualModel&&o.addSubGroup(new e.models.GeneralSubGroup(e.models.SettingsGeneralSubgroupType.Preview,e.common.localize.get("Settings_PreviewFeatures"))),o.addSubGroup(new e.models.GeneralSubGroup(e.models.SettingsGeneralSubgroupType.Privacy,e.common.localize.get("SettingsGeneral_Privacy_Title"))),o.addSubGroup(new e.models.GeneralSubGroup(e.models.SettingsGeneralSubgroupType.Language,e.common.localize.get("SettingsGeneral_Language_Title"))),o.services.featureSwitchService.featureSwitches.closeAccountEnabled&&o.addSubGroup(new e.models.GeneralSubGroup(e.models.SettingsGeneralSubgroupType.CloseAccount,e.common.localize.get("Settings_CloseAccount"))),o.addSubGroup(new e.models.GeneralSubGroup(e.models.SettingsGeneralSubgroupType.Plugins,e.common.localize.get("SettingsGeneral_Plugins_Title"))),o.services.featureSwitchService.featureSwitches.esriEnabled&&o.addSubGroup(new e.models.GeneralSubGroup(e.models.SettingsGeneralSubgroupType.Esri,e.common.localize.get("SettingsGeneral_Esri")))})),t.onSubgroupSelected=function(e){return o.onSubgroupSelected(e)};var r=this.services.navigation.settingsId;if(r){r=r.charAt(0).toUpperCase()+r.slice(1);var a=e.models.SettingsGeneralSubgroupType[r];t.viewModel.selectedSubgroupType=a?a:e.models.SettingsGeneralSubgroupType.Privacy}else t.viewModel.selectedSubgroupType||(t.viewModel.selectedSubgroupType=e.models.SettingsGeneralSubgroupType.Privacy)}return t.createOptions=function(){return{additionalServices:["featureSwitchService","navigation"]}},t.prototype.onSubgroupSelected=function(t){var i=e.models.SettingsGeneralSubgroupType[t];this.services.navigation.showSettingsSlider("general",i.charAt(0).toLowerCase()+i.slice(1)),this.scope.viewModel.selectedSubgroupType=t},t.prototype.getSelectedSubgroupType=function(){return this.scope.viewModel.selectedSubgroupType},t.prototype.addSubGroup=function(e){this.scope.subGroups.push(e)},t})();t.SettingsGeneralController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.scope.supportedLanguages=e.common.models.SettingsViewModelFactory.createSupportedLanguagesModel(),this.scope.supportedLanguages.unshift({name:i.localizationService.get("SettingsLanguage_Default"),code:e.constants.defaultBrowserLanguageCode,lcid:null}),this.scope.isLoading=!1,this.scope.applyChanges=function(){return o.applyChanges()},this.scope.discardChanges=function(){return o.discardChanges()};for(var r=this.scope.viewModel.preferredLanguage||e.constants.defaultBrowserLanguageCode,a=0,n=this.scope.supportedLanguages;a<n.length;a++){var s=n[a];if(s.code===r){this.scope.currentLanguage=this.originalLanguage=s;break}}}return t.createOptions=function(){return{additionalServices:["$window","localizationService","telemetryService","userSettingsService"]}},t.prototype.applyChanges=function(){var t=this;if(this.scope.languageSettingsForm.$dirty){var i=this.scope.currentLanguage.code===e.constants.defaultBrowserLanguageCode?"":this.scope.currentLanguage.code,o=this.services.telemetryService.startEvent(e.telemetry.LocaleSaveLocaleSetting,this.scope.currentLanguage.code);this.scope.isLoading=!0,this.services.userSettingsService.updateLanguageSetting(i,o).then((function(){t.originalLanguage=t.scope.currentLanguage,t.scope.isLoading=!1,t.services.$window.location.reload(!0)}))}},t.prototype.discardChanges=function(){this.scope.currentLanguage=this.originalLanguage},t})();t.SettingsLanguageController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(i,o){var r=this;this.scope=i,this.services=o,i.viewModel=i.viewModel||{developerMode:e.localStorageService.getData(t.DeveloperModeEnabledKey)},i.pluginsSettings={developerMode:i.viewModel.developerMode},i.applyChanges=function(){return r.applyChanges()}}return t.createOptions=function(){return{additionalServices:["telemetryService","userSettingsService"]}},t.prototype.applyChanges=function(){e.localStorageService.setData(t.DeveloperModeEnabledKey,this.scope.pluginsSettings.developerMode),this.services.telemetryService.logEvent(e.telemetry.DeveloperVisualEnabledChanged,this.scope.pluginsSettings.developerMode)},t})();i.DeveloperModeEnabledKey="DEVELOPER_MODE_ENABLED",t.SettingsPluginsController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,e.isDirty=!1,e.privacySettings={allowQnaDataCollection:e.viewModel.allowQnaDataCollection},e.applyChanges=function(){return i.applyChanges()},e.discardChanges=function(){return i.discardChanges()},e.onSettingChange=function(){return e.isDirty=!0}}return t.createOptions=function(){return{additionalServices:["navigation","telemetryService","userSettingsService"]}},t.prototype.applyChanges=function(){var t=this;if(this.scope.viewModel.allowQnaDataCollection===this.scope.privacySettings.allowQnaDataCollection)this.services.navigation.navigateBack();else{var i=this.services.telemetryService.startEvent(e.telemetry.PrivacySaveSettingsModel);this.services.userSettingsService.updateAllowQnaDataCollection(this.scope.privacySettings.allowQnaDataCollection,i).then((function(e){
t.scope.viewModel.allowQnaDataCollection=e,t.services.navigation.navigateBack()}))}},t.prototype.discardChanges=function(){this.services.navigation.navigateBack()},t})();t.SettingsPrivacyController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){}return e})();e.SettingsPublishedContentController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,t.onSettingsGroupSelected=function(e){return o.onSettingsGroupSelected(e)},t.settingsGroups=this.getSettingsGroups(),t.isLoading=!0;var r=t.$on(e.common.constants.navigation.stateChangeSuccess,(function(){return o.handleStateChange()}));this.handleStateChange(),t.$on("$destroy",(function(){r()})),i.settingsMetadataService.getSettings().then((function(e){t.viewModel=i.modelConverter.convertSettingsMetadata(e),t.isLoading=!1}),(function(){i.errorService.error(e.common.localize.get("SettingsGeneral_Error_FailedToLoad"),"SettingsGeneral_Error_FailedToLoad"),i.navigation.navigateBack()}))}return t.createOptions=function(){return{additionalServices:["errorService","navigation","modelConverter","settingsMetadataService","permissionService","telemetryService","featureSwitchService"]}},t.prototype.handleStateChange=function(){this.scope.currentSettingsGroup=this.services.navigation.settingsGroup},t.prototype.onSettingsGroupSelected=function(t){this.services.navigation.showSettingsSlider(t),this.scope.currentSettingsGroup!==t&&this.services.telemetryService.logEvent(e.telemetry.DashboardSettingGroupChanged,this.scope.currentSettingsGroup,t)},t.prototype.getSettingsGroups=function(){var t=this,i=[],o=e.common.localize;return o.ensureLocalization((function(){i.push(new e.models.SettingsGroup("general",o.get("SettingsGroupsNames_General"))),t.services.permissionService.isActiveWorkspaceIsReadOnly||(i.push(new e.models.SettingsGroup("dashboards",o.get("SettingsGroupsNames_Dashboards"))),i.push(new e.models.SettingsGroup("datasets",o.get("SettingsGroupsNames_Datasets"))),i.push(new e.models.SettingsGroup("workbooks",o.get("SettingsGroupsNames_Workbooks"))),i.push(new e.models.SettingsGroup("alerts",o.get("SettingsGroupsNames_Alerts"))),t.services.featureSwitchService.featureSwitches.emailSubscriptionEnabled&&i.push(new e.models.SettingsGroup("communications",o.get("SettingsGroupsNames_Subscriptions"))))})),i},t})();t.SettingsViewerController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(t){function i(e,o){for(var r=this,a=_.filter(o.workbookService.workbooks,(function(e){return i.filterWorkbooks(e,o.packageService)})),n=[],s=0;s<a.length;s++){var c=a[s],l=o.modelService.findModel(c.modelId,c.packageId);l&&n.push(l.contract)}return e.filteredModels=n,e.storageRefreshSupported=!1,r=t.call(this,e,o,"workbooks")||this}return __extends(i,t),i.createOptions=function(){var t=e.SettingsDataModelsController.createOptions();return t.additionalServices=t.additionalServices.concat("workbookService").concat("packageService"),t},i.filterWorkbooks=function(e,t){return t.isRefreshNowEnabledForWorkbook(e)},i})(e.SettingsDataModelsController);e.SettingsWorkbooksController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.controllers.EmailsList,o=e.common.models.EmailsListModel,r=e.common.contracts.Permissions,a=(function(){function t(i,o){var r=this;this.scope=i,this.services=o,this.navigation=o.navigation;var a=this.services.dashboardDataService;this.isInContentListViewEquivalent()?this.scope.activeDashboard=this.services.shareSliderService.shareDashboard:this.scope.activeDashboard=a.sharingDashboard=a.sharingDashboard||a.activeDashboard,this.scope.switchToDashboardView=function(){return r.switchToDashboardView()},this.scope.shareEmail=function(){return r.shareEmail()},this.scope.cancelShare=function(){return r.cancelShare()},this.scope.isNotPermitted=function(){return t.isNotPermitted(r.scope.activeDashboard)},this.scope.sharedWithUsers=function(e){return r.sharedWithUsers(e)},this.scope.cancelInvite=function(e){return r.cancelInvite(e)},this.scope.stopSharing=function(e,t){return r.stopSharing(e,t)},this.scope.isOwner=function(){return t.isOwner(r.scope.activeDashboard)},this.scope.sharingPermissionsItemSelected=function(e){return r.onSharingPermissionsItemSelected(e)},this.scope.validateInputTag=function(e){return r.validateInputTags()},this.scope.resetValidation=function(){return r.validateInputTags()},this.scope.grantAccess=function(e){return r.grantAccess(e)},this.scope.denyAccess=function(e){return r.denyAccess(e)},this.scope.anyRequests=function(){return r.scope.viewModel.requestingUsers&&r.scope.viewModel.requestingUsers.length>0},this.scope.approveAll=function(){return r.approveAll()},this.scope.navigateToManagePermissions=function(){return r.navigateToManagePermissions()};var n=this.scope.activeDashboard.objectId;this.scope.getDashboardUrl=function(){return r.services.invitationService.getSharedDashboardLink(n,!1)},this.scope.featureSwitchPermissionCenterEnabled=this.services.featureSwitchService.featureSwitches.permissionCenterEnabled,this.scope.shouldShowPermissionsWarning=function(){return r.shouldShowPermissionsWarning(r.scope.activeDashboard)},this.scope.getWorkookPermissionsMessageType=function(){return r.getWorkookPermissionsMessageType(r.scope.activeDashboard)},this.setWorkbookTileWebUri(this.scope.activeDashboard),this.getDashboardUsersAndCreateSummaryText(),this.services.telemetryService.logEvent(e.telemetry.DashboardOpenShareDialog);var s=this.scope.$watch("viewModel",(function(e){r.initializeViewModel(e)})),c=this.scope.$on(e.constants.hideTaskPaneSliderOnClickEventName,(function(e){return r.closePaneAndUpdateState()}));this.scope.$on("$destroy",(function(){s(),c()})),this.scope.requestsClick=function(){r.scope.anyRequests()&&r.sharedWithUsers(!0)}}return t.createOptions=function(){return{additionalServices:["$location","dashboardDataService","domainHelperService","errorService","featureSwitchService","groupService","invitationService","licenseEnforcementService","lazy","localizationService","modelConverter","navigation","notificationToast","packageService","promiseFactory","telemetryService","userInfo","visualPlugin","shareSliderService","dashboardDataService","contentList","taskPaneSliderService"]}},t.prototype.initializeViewModel=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,r=this;return __generator(this,(function(a){switch(a.label){case 0:return t?(t.isUserListChanged=!1,t.isEmailBeingSent=!1,t.showSecurityGroupUpgradeAccount=!1,t.messageText="",t.emailsList=new o,t.inviteSelected=!0,t.sharedWithSelected=!1,i=t,[4,this.proContentAlertMessage(this.scope.activeDashboard)]):[2];case 1:return i.proContentAlertMessage=a.sent(),t.notifyViaEmail=!0,this.scope.viewModel.emailValidationError=this.scope.viewModel.emailValidationWarning="",this.services.localizationService.ensureLocalization((function(){t.placeholderMessage=r.services.localizationService.get("Sharing_MessagePlaceholderText"),t.defaultText=r.services.localizationService.get("Sharing_DefaultEmailText"),t.enterEmailText=r.services.localizationService.get("Sharing_AddEmailText")})),this.resetChangedUserList(e.models.SharingUserList.Default),[2]}}))}))},t.validateDashboardPermission=function(e,t){return e&&(e.contract.permissions&t)===t},t.isOwner=function(e){return t.validateDashboardPermission(e,r.All)},t.isNotPermitted=function(e){return!t.validateDashboardPermission(e,r.ReShare)},t.prototype.proContentAlertMessage=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i;return __generator(this,(function(o){switch(o.label){case 0:return this.services.featureSwitchService.featureSwitches.pseudoLocEnabled?[2,this.services.localizationService.get("UpgradeAccount_ShareDashboardWarnMessageV2")]:[3,1];case 1:return i=t,i?[4,this.services.licenseEnforcementService.dashboardHasProFeatures(t.contract)]:[3,3];case 2:i=o.sent()||this.dashboardContainsRScriptTiles(t),o.label=3;case 3:if(e=i)return[2,this.services.localizationService.get("UpgradeAccount_ShareDashboardWarnMessage")];o.label=4;case 4:return[2]}}))}))},t.prototype.dashboardContainsRScriptTiles=function(t){if(t.tiles)for(var i=0,o=t.tiles;i<o.length;i++){var r=o[i],a=e.dataServices.TileUtils.getVisualType(r.config);if(a){var n=this.services.visualPlugin.capabilities(a);if(n&&n.dataViewMappings&&e.ScriptResultUtil.findScriptResultMapping(n.dataViewMappings))return!0}}return!1},t.prototype.getRemoteWorkbookTile=function(e){var t=this,i=void 0;return e&&e.tiles&&(i=_.find(e.tiles,(function(e){return!!(e&&e.workbook&&e.workbook.contract)&&!t.services.packageService.isLocalWorkbook(e.workbook.contract.packageId)}))),i},t.prototype.shouldShowPermissionsWarning=function(e){return void 0!==this.getRemoteWorkbookTile(e)||!t.isOwner(e)&&this.containsWorkbookTile(e)},t.prototype.containsWorkbookTile=function(e){var t=void 0;return e.tiles&&(t=_.find(e.tiles,(function(e){return e&&e.workbook}))),void 0!==t},t.prototype.isMyWorkspace=function(){return this.services.groupService.isMyWorkspace()},t.prototype.getWorkookPermissionsMessageType=function(e){return this.isMyWorkspace()?t.isOwner(e)?0:1:2},t.prototype.setWorkbookTileWebUri=function(e){var t=this.getRemoteWorkbookTile(e);void 0!==t&&(this.scope.workbookWebUri=t.workbook.webUri)},t.prototype.markIsExternalInvitation=function(e){this.services.domainHelperService.emailIsInVerifiedDomain(e.sentToEmailAddress).then((function(t){e.isExternalUser=!t}),(function(){e.isExternalUser=!1}))},t.prototype.markIsExternalUser=function(e){this.services.domainHelperService.emailIsInVerifiedDomain(e.emailAddress).then((function(t){e.isExternalUser=!t}),(function(){e.isExternalUser=!1}))},t.prototype.onSharingPermissionsItemSelected=function(t){switch(t.action){case e.models.SharingOptions.StopSharing:this.stopSharing(t.id,t.kind);break;case e.models.SharingOptions.ReadOnly:this.editPermissions(t.id,t.kind,r.Read);break;case e.models.SharingOptions.ReadReshare:this.editPermissions(t.id,t.kind,r.ReadReshare)}},t.prototype.createSharingSummary=function(){var e,i=this.scope.viewModel;return i.owner?t.isOwner(this.scope.activeDashboard)?null==i.sharedUsers?e:e=0===i.sharedUsers.length?this.services.localizationService.get("Sharing_OnlyWithYou"):1===i.sharedUsers.length?this.services.localizationService.format("Sharing_SharedWithOne",[i.sharedUsers[0].fullName]):this.services.localizationService.format("Sharing_SharedWithMoreThanOne",[i.sharedUsers[0].fullName,(i.sharedUsers.length-1).toString()]):e=this.services.localizationService.format("Sharing_DashboardOwner",[i.owner.fullName]):e},t.prototype.createRequestsSummary=function(){var e=null,i=this.scope.viewModel;if(!i.owner||!t.isOwner(this.scope.activeDashboard)||!i.requestingUsers||0===i.requestingUsers.length)return e;var o=i.requestingUsers[0].fullName;return 1===i.requestingUsers.length?this.services.localizationService.format("Sharing_OneUserHasRequestedAccess",[o]):2===i.requestingUsers.length?this.services.localizationService.format("Sharing_TwoUsersHaveRequestedAccess",[o]):this.services.localizationService.format("Sharing_ThreeOrMoreUsersHaveRequestedAccess",[o,i.requestingUsers.length-1])},t.prototype.resetChangedUserList=function(e){this.scope.viewModel.selectedList=e,this.scope.viewModel.removedUserId=-1,this.scope.viewModel.removedUserKind=void 0,this.scope.viewModel.allowReshare=!0},t.prototype.validateMessageSize=function(){return!(this.scope.viewModel.messageText.length>t.MessageSizeLimit)||(this.services.notificationToast.notify({title:this.services.localizationService.get("Sharing_InvalidEntry"),message:this.services.localizationService.get("Sharing_MessageSizeExceeded"),notificationType:e.common.NotificationToastType.Alert}),!1)},t.prototype.switchToDashboardView=function(){this.isInContentListViewEquivalent()||this.navigation.navigateToDashboardByGUID(this.scope.activeDashboard.objectId)},t.prototype.shareEmail=function(){var t=this;if(this.scope.viewModel.emailsList.validationTrigger()&&this.validateMessageSize()){var i=this.scope.viewModel.emailsList.validObjectIds,o=this.scope.viewModel.emailsList.validEmailsList,r=!this.scope.isOwner(),a=this.services.telemetryService,n=a.startEvent(e.telemetry.DashboardSendShareInvitation);this.validateInputTags().then((function(s){var c=t.scope.viewModel.messageText,l=!1;_.isEmpty(c)?(l=!0,c=t.scope.viewModel.defaultText):c=t.scope.viewModel.messageText;var d=a.startChildEvent(n.event,e.telemetry.DashboardInviteDashboardUsers,o.length,i.length,c.length,l,r,t.scope.viewModel.allowReshare,t.scope.activeDashboard.objectId,t.scope.viewModel.notifyViaEmail,s.externalEmailCount);t.scope.viewModel.isEmailBeingSent=!0,t.services.invitationService.sendInvitation(t.scope.activeDashboard.id,o,i,c,t.scope.viewModel.allowReshare,t.scope.viewModel.notifyViaEmail,d.event).then((function(){d.resolve(),t.notifySharingSuccess("Sharing_SendEmailSuccess"),t.scope.viewModel.isEmailBeingSent=!1,t.scope.viewModel.emailsList.inputUserList=[],n.resolve(),t.scope.viewModel.notifyViaEmail?t.switchToDashboardView():t.sharedWithUsers(!0),t.closePaneAndUpdateState()}),(function(i){var o;if(i.status===e.HttpStatusCode.RequestEntityTooLarge)t.displayShareEmailLimitExceededError(parseInt(i.headers.ActualInvitationEmailCount,10));else{t.notifySharingFailure("Sharing_FailedToInvitedUsers"),t.scope.viewModel.isEmailBeingSent=!1;var r=i.headers(e.common.PowerBIErrorHeader);r===e.constants.DashboardSharingSecurityGroupRequirePro&&(t.scope.viewModel.showSecurityGroupUpgradeAccount=!0,o=r),r===e.constants.DashboardInvitationUnsupportedGroup&&(t.displayShareToUnifiedGroupError(),o=r)}var a={errorCode:i.status+"",errorSource:o?e.telemetry.ErrorSource.User:e.telemetry.ErrorSource.PowerBI};d.reject(a),n.reject(a)}))}),(function(i){null!==i?(n.reject({errorCode:i.errorReason,errorSource:e.telemetry.ErrorSource.User}),t.services.telemetryService.logEvent(i.errorTelemetryEvent)):n.reject({errorCode:"UnknownSystemError",errorSource:e.telemetry.ErrorSource.PowerBI}),t.notifySharingFailure("Sharing_FailedToInvitedUsers")}))}},t.prototype.cancelShare=function(){this.closePaneAndUpdateState()},t.prototype.validateInputTags=function(){var t=this;this.scope.viewModel.emailValidationError=this.scope.viewModel.emailValidationWarning="",this.scope.viewModel.showSecurityGroupUpgradeAccount=!1;var i=this.services.promiseFactory.defer();return this.services.domainHelperService.getVerifiedDomains().then((function(o){var r={},a={},n=null,s="",c=0,l=t.services.licenseEnforcementService.supportsGroups();if(t.scope.viewModel&&t.scope.viewModel.emailsList){for(var d=t.scope.viewModel.emailsList.inputUserList,p=!1,u=0,v=d;u<v.length;u++){var h=v[u];if(h.userPrincipalName){var g=h.userPrincipalName.split("@"),m=g[1].toLowerCase();o.verifiedDomains[m.toUpperCase()]||(r[m]=m,c++),o.blockedDomains[m.toUpperCase()]&&(a[m]=m)}h.isSecurityGroup&&!l&&(p=!0)}var f="",y=0;for(var b in r)y++,f+=b+", ";var S="",w=0;for(var C in a)w++,S+=C+", ";p&&(t.scope.viewModel.showSecurityGroupUpgradeAccount=!0),_.endsWith(f,", ")&&(f=f.substring(0,f.length-2)),_.endsWith(S,", ")&&(S=S.substring(0,S.length-2)),t.services.featureSwitchService.featureSwitches.externalSharingEnabled?w>0?(t.scope.viewModel.emailValidationError=t.services.localizationService.format("Sharing_BlockedDomains",[S]),n=e.telemetry.DashboardSharingWithBlockedDomain,s=S):y>0&&t.displaySharingToExternalUserWarning(f):y>0&&(t.scope.viewModel.emailValidationError=t.services.localizationService.format("Sharing_EmailDomainNotInTenant",[f]),n=e.telemetry.DashboardSharingWithInvalidDomain,s=f)}t.scope.viewModel.hasValidationError?i.reject({errorReason:s,errorTelemetryEvent:n}):i.resolve({externalEmailCount:c})}),(function(e){i.reject(null)})),i.promise},t.prototype.displayShareEmailLimitExceededError=function(t){this.scope.viewModel.emailValidationError=this.services.localizationService.get("Sharing_EmailAddressExceeded").replace("{{maxEmails}}",i.MaxAllowedEmailAddresses.toString());var o=this.services.telemetryService;o.logEvent(e.telemetry.DashboardSharingEmailAddressExceededLimit,t)},t.prototype.displayShareToUnifiedGroupError=function(){this.scope.viewModel.emailValidationError=this.services.localizationService.get("DashboardInvitationUnsupportedGroup");var t=this.services.telemetryService;t.logEvent(e.telemetry.DashboardSharingEmailAddressUnsupportedGroup)},t.prototype.displaySharingToExternalUserWarning=function(e){this.scope.viewModel.emailValidationWarning=this.services.localizationService.format("Sharing_ExternalOrganization",[e])},t.prototype.getListOfDashboardUsers=function(){var i=this,o=this.services.telemetryService.startEvent(e.telemetry.DashboardLoadDashboardUsers),a=this.services.promiseFactory.defer();return this.scope.activeDashboard&&this.services.invitationService.getDashboardAccess(this.scope.activeDashboard.id,o.event).then((function(n){var s,c,l=i.scope.viewModel,d=i.services.modelConverter;!n.data||n.data instanceof Array?(s=n.data,c=[]):(s=n.data.accesses,c=n.data.requests);var p=d.convertDashboardAccessInfoArray(s||[]);p.map((function(e){return i.markIsExternalUser(e)}));var u=d.convertDashboardAccessInfoArray(c||[]);if(l.owner=_.filter(p,(function(e){return e.permissions===r.All}))[0],l.sharedUsers=_.filter(p,(function(e){return e.permissions!==r.All})),l.requestingUsers=u,i.navigation.currentInviteObjectId){var v=parseInt(i.navigation.currentInviteId,10),h=e.contracts.DashboardAccessInfoKind.User,g=_.filter(l.requestingUsers,(function(e){return e.id===v&&e.kind===h}));if(g&&g.length>0){var m=g[0];i.scope.viewModel.emailsList.inputUserList.push({isSecurityGroup:!1,displayName:m.fullName,userPrincipalName:null,objectId:i.navigation.currentInviteObjectId,objectType:e.common.contracts.ADUserMetaDataObjectType.User})}}t.isOwner(i.scope.activeDashboard)?i.services.invitationService.getInvitedUsers(i.scope.activeDashboard.id,o.event).then((function(e){var t=i.scope.viewModel;t.invitedUsers=d.convertDashboardInvitation(e.data),t.invitedUsers.map((function(e){return i.markIsExternalInvitation(e)})),o.resolve(),a.resolve({})}),(function(e){o.reject(),i.services.localizationService.ensureLocalization((function(){i.services.errorService.error(i.services.localizationService.get("Sharing_FailedToLoadInvitedUsers"),"Sharing_FailedToLoadInvitedUsers",{requestId:e.requestId,statusCode:e.status.toString()}),a.reject({})}))})):a.resolve({})}),(function(e){i.services.localizationService.ensureLocalization((function(){i.services.errorService.error(i.services.localizationService.get("Sharing_FailedToLoadUsers"),"Sharing_FailedToLoadUsers",{requestId:e.requestId,statusCode:e.status.toString()}),a.reject({})}))})),a},t.prototype.getDashboardUsersAndCreateSummaryText=function(){var e=this;this.getListOfDashboardUsers().promise.then((function(){e.scope.viewModel.summaryText=e.createSharingSummary(),e.scope.viewModel.requestsSummaryText=e.createRequestsSummary()}),_.noop)},t.prototype.sharedWithUsers=function(e){e?this.getDashboardUsersAndCreateSummaryText():this.validateInputTags(),this.scope.viewModel.inviteSelected=!e,this.scope.viewModel.sharedWithSelected=e},t.prototype.cancelInvite=function(t){var i=this;if(this.scope.activeDashboard){var o=this.services.telemetryService.startEvent(e.telemetry.DashboardLoadDashboardUsers);this.services.invitationService.cancelInvitation(t,this.scope.activeDashboard.id,o.event).then((function(t){o.resolve(),i.sharedWithUsers(!0),i.resetChangedUserList(e.models.SharingUserList.Default)}),(function(e){o.reject(),i.services.localizationService.ensureLocalization((function(){i.services.errorService.error(i.services.localizationService.get("Sharing_FailedToCancelInvitation"),"Sharing_FailedToCancelInvitation",{requestId:e.requestId,statusCode:e.status.toString()})}))})),this.resetChangedUserList(e.models.SharingUserList.InvitedUsers)}},t.prototype.stopSharing=function(t,i){var o=this;if(this.scope.activeDashboard){var a=this.services.telemetryService.startEvent(e.telemetry.DashboardDeleteDashboardUser),n={dashboardId:this.scope.activeDashboard.id,id:t,kind:i,permissions:r.None,emailAddress:null,familyName:null,givenName:null,isOwner:!1,sentToEmailAddress:null};this.scope.viewModel.removedUserId=t,this.scope.viewModel.removedUserKind=i,this.services.invitationService.deleteDashboardAccess(n,a.event).then((function(t){a.resolve(),o.sharedWithUsers(!0),o.resetChangedUserList(e.models.SharingUserList.Default)}),(function(t){o.services.localizationService.ensureLocalization((function(){o.services.errorService.error(o.services.localizationService.get("Sharing_FailedToDeleteDashboardUser"),"Sharing_FailedToDeleteDashboardUser",{requestId:t.requestId,statusCode:t.status.toString()}),a.reject()})),o.resetChangedUserList(e.models.SharingUserList.SharedUsers)}))}},t.prototype.editPermissions=function(t,i,o){var r=this;if(this.scope.activeDashboard){var a=this.services.telemetryService.startEvent(e.telemetry.DashboardEditDashboardPermissions,this.scope.activeDashboard.objectId,o),n={dashboardId:this.scope.activeDashboard.id,id:t,kind:i,permissions:o,emailAddress:null,familyName:null,givenName:null,isOwner:!1,sentToEmailAddress:null};this.services.invitationService.editDashboardAccess(n,a.event).then((function(t){a.resolve(),r.sharedWithUsers(!0),r.resetChangedUserList(e.models.SharingUserList.Default)}),(function(e){r.services.errorService.error(r.services.localizationService.get("Sharing_FailedToEditPermissions"),"Sharing_FailedToEditPermissions",{requestId:e.requestId,statusCode:e.status.toString()}),a.reject()})),this.resetChangedUserList(e.models.SharingUserList.SharedUsers)}},t.prototype.grantAccess=function(t){for(var i=this,o=this.services.telemetryService.startEvent(e.telemetry.DashboardSendShareInvitation),r=!0,a=this.scope.viewModel.defaultText,n=t.map((function(e){return e.emailAddress})),s=[],c=!1,l=!1,d=!0,p=this.services.telemetryService.startChildEvent(o.event,e.telemetry.DashboardInviteDashboardUsers,n.length,s.length,a.length,r,c,l,this.scope.activeDashboard.objectId,d,0),u=0,v=t;u<v.length;u++){var h=v[u];h.isPerformingAccessRequest=!0}this.services.invitationService.sendInvitation(this.scope.activeDashboard.id,n,s,a,l,d,p.event).then((function(){o.resolve(),i.notifySharingSuccess("Sharing_AccessHasBeenGranted"),i.scope.viewModel.isEmailBeingSent=!1,i.scope.viewModel.emailsList.inputUserList=[],p.resolve(),t.forEach((function(t){_.remove(i.scope.viewModel.requestingUsers,(function(e){return e.id===t.id&&e.kind===t.kind})),t.permissions=e.common.contracts.Permissions.Read,i.scope.viewModel.sharedUsers.push(t)})),i.getDashboardUsersAndCreateSummaryText()}),(function(){p.reject(),i.notifySharingFailure("Sharing_GrantAccessFailed")})).finally((function(){t.forEach((function(e){e.isPerformingAccessRequest=!1}))}))},t.prototype.denyAccess=function(t){var i=this,o=this.services.telemetryService.startEvent(e.telemetry.DashboardDeleteDashboardAccessRequest,this.scope.activeDashboard.objectId,t.kind,t.id);t.isPerformingAccessRequest=!0,this.services.invitationService.deleteDashboardAccessRequest(this.scope.activeDashboard.id,t.kind,t.id,o.event).then((function(){o.resolve(),i.notifySharingSuccess("Sharing_AccessRequestRemoved"),_.remove(i.scope.viewModel.requestingUsers,(function(e){return e.id===t.id&&e.kind===t.kind})),i.getDashboardUsersAndCreateSummaryText()}),(function(){o.reject(),i.notifySharingFailure("Sharing_AccessRequestRemovalFailed")})).finally((function(){t.isPerformingAccessRequest=!1}))},t.prototype.notifySharingSuccess=function(t){this.services.notificationToast.notify({title:this.services.localizationService.get("Sharing_Success"),message:this.services.localizationService.get(t),notificationType:e.common.NotificationToastType.Share})},t.prototype.notifySharingFailure=function(t){this.services.notificationToast.notify({title:this.services.localizationService.get("Sharing_Failure"),message:this.services.localizationService.get(t),notificationType:e.common.NotificationToastType.Error})},t.prototype.approveAll=function(){var e=this.scope.viewModel.requestingUsers.slice();this.grantAccess(e)},t.prototype.navigateToManagePermissions=function(){var e=this;this.services.lazy("permissionNavigation").then((function(t){return t.navigateToManagePermissions(1,e.scope.activeDashboard.objectId)}))},t.prototype.closePaneAndUpdateState=function(){this.services.taskPaneSliderService.collapsePane(),this.services.dashboardDataService.sharingDashboard=null,this.isInContentListViewEquivalent()?this.services.contentList.tileSelectionOff(this.services.shareSliderService.shareDashboard):this.navigation.inSharingView()&&this.navigation.navigateToDashboardByGUID(this.navigation.currentDashboardGUID)},t.prototype.isInContentListViewEquivalent=function(){return this.navigation.inContentListView()||this.navigation.inFavoritesView()||this.navigation.inRecentlyViewedView()||this.navigation.inSharedWithMeView()},t})();a.MessageSizeLimit=4e3,t.ShareView=a})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.constants.TaskPaneCollapsiblePaneMode,r=(function(){function e(e,t){var i=this;this.scope=e,this.services=t,this.scope.isPaneExpanded=function(){return i.isPaneExpanded()},this.services.taskPaneSliderService.registerPaneVisibilityChangeObserver((function(e,t,o,r){return i.updatePaneVisibility(e,t,o,r)})),this.services.taskPaneSliderService.registerPaneVisibilityChangeObserver((function(e,t,o,r){return i.updatePaneVisibility(e,t,o,r)}))}return e.createOptions=function(){return{additionalServices:["taskPaneSliderService"]}},e.prototype.updatePaneVisibility=function(e,t,r,a){var n=this.scope.viewModel;n.collapsiblePane.isExpanded=e,n.collapsiblePane.expandedWidth=r||i.Large,n.previousMode=this.scope.viewModel.collapsiblePaneMode,n.collapsiblePaneMode=t||o.Default,n.parameters=a||{}},e.prototype.isPaneExpanded=function(){return this.services.taskPaneSliderService.isPaneExpanded()},e.prototype.expandCollapsiblePane=function(){var e=this.scope.viewModel;this.updatePaneVisibility(!0,e.collapsiblePaneMode,e.collapsiblePaneWidth,e.parameters)},e.prototype.hideTaskPaneSlider=function(){this.updatePaneVisibility(!1,o.Default,i.Large)},e})();t.TaskPaneSliderController=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.dataServices.models.ContentPackItems,r=e.dataServices.models.Dashboard,a=e.dataServices.models.IsValidIntraDomainPrefix,n=e.dataServices.models.IntraDomainNavigationType,s=e.common.helpers.ModelConverterHelper,c=e.common.models.Report,l=e.explore.contracts.SingleVisualConfig,d=e.common.constants.TaskPaneCollapsiblePaneMode,p=e.models.factory.TileOptionsFactory,u=e.dataServices.contracts.TileType,v=e.dataServices.TileUtils,h=(function(){function t(t,i){var o=this;this.tileSaved=!1,this.scope=t,this.services=i;var r=this.services.dashboardDataService.selectedDashboardTile.tileModel;t.back=function(){return o.back()},t.closeTileEditorWithoutSaving=function(){return o.cancel()},t.restoreDefaults=function(){return o.restoreDefaults()},t.showTechnicalDetailsDialog=function(){return o.showTechnicalDetailsDialog()},t.saveChangesAndExit=function(){return o.save()},t.setCustomLinkChanged=function(){return o.setCustomLinkChanged()},t.setDynamicImageForWorkbookTile=function(){return t.workbookService.setModelDynamicImageUrl(r.workbook)},t.showLastRefreshTimeChanged=function(){return o.showLastRefreshTimeChanged()},t.toggleDisplayTitle=function(){return o.toggleDisplayTitle()},t.onLinkTargetChanged=function(){return o.onLinkTargetChanged()},t.hasTitleError=function(){return o.hasTitleError()},t.hasExternalLinkError=function(){return o.hasExternalLinkError()},t.hasInternalLinkError=function(){return o.hasInternalLinkError()},t.canSave=function(){return o.canSave()},t.viewModel=new e.models.TileEditorModel(r,this.services.featureSwitchService,this.services.explorationSerializer,this.services.visualPlugin,this.services.workbookService),t.workbookService=i.workbookService,t.tileEditorHeaderPaneTitle=function(){return o.tileEditorHeaderPaneTitle()},t.activateHeaderTab=function(e){return o.activateHeaderTab(e)},this.setDisplayTitle();var a=t.viewModel.tile;a&&a.realTime&&this.saveRealTimeTileContext(),this.setCustomLinkProperties(),t.isSavedRealTimeTile=!!a.realTime&&!a.isTemporary,t.isSavedRealTimeTile&&(t.headerTabs=p.getRealTimeTileEditHeaderTabs(i.localizationService),t.activeHeaderTab=t.headerTabs[0]),t.tileModel=r,t.selectedModel=i.modelService.findModel(r.contract.modelId),t.$watchGroup([function(){return r.hasTitle()},function(){return r.hasSubtitle()}],(function(){a.invalidateLayout()}));var n=t.$on("$destroy",(function(){var e=o.scope.viewModel;o.tileSaved||e.tile.isTemporary||!e.isDirty()||e.undoChanges(),n()}))}return t.createOptions=function(){return{additionalServices:["dashboardService","dashboardDataService","dashboardHttpService","errorService","explorationSerializer","featureSwitchService","localizationService","modelService","reportService","telemetryService","workbookService","visualPlugin","taskPaneSliderService"],scopedDependencies:["pinVisual","visualQueryGenerator"],scopedServiceRoot:!0}},t.prototype.hasTitleError=function(){var e=this.scope,t=!!e.tileEditorForm&&e.tileEditorForm.title.$touched;return t&&!e.viewModel.isTitleValid()},t.prototype.hasExternalLinkError=function(){var e=this.scope;if(!e.hasCustomLink)return!1;var t=e.tileEditorForm&&e.tileEditorForm.customUrl&&e.tileEditorForm.customUrl.$touched;return t&&!e.viewModel.isCustomLinkValid(!1)},t.prototype.hasInternalLinkError=function(){var e=this.scope;return!!e.hasCustomLink&&e.internalLinkInfo.hasError},t.prototype.canSave=function(){var e=this.scope,t=e.viewModel,i=!!e.tileEditorForm&&e.tileEditorForm.$invalid;return!i&&t.isDirty()&&t.isValid(2===e.customLinkType)},t.prototype.showTechnicalDetailsDialog=function(){var t=this.services.errorService.control(),i=[new InJs.ModalDialogAction(this.services.localizationService.get("PBI_Button_Label_Close"),function(e,i){t.hideDialog()})],o=$("<div/>"),r='<a href="'+jsCommon.PowerBIDefaultHelpPage+'" target="_blank">'+this.services.localizationService.get("TileEditor_TechnicalDetails_SupportPage")+"</a>";o.append($("<div/>").html(this.services.localizationService.format("TileEditor_TechnicalDetails_Description",[r]))),this.addTileDetails(o),e.session.userInfo&&e.session.userInfo.uoid&&o.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_UserObjectId"),e.session.userInfo.uoid));var a=this.services.dashboardDataService.activeDashboard;a&&o.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_DashboardId"),a.id.toString())),this.addPackageDetails(o),this.addModelDetails(o),t.showCustomDialog(this.services.localizationService.get("TileEditor_TechnicalDetails_Title"),o,i,null,!0)},t.prototype.activateHeaderTab=function(e){this.scope.activeHeaderTab=e},t.prototype.onLinkTargetChanged=function(){var e=this.scope,t=e.internalLinkInfo,i=t.target;if(i){t.hasError=!1;var o=e.viewModel.tile.action;i instanceof c?o.targetUrl="/reports/"+i.objectId:o.targetUrl="/dashboards/"+i.objectId}},t.prototype.cancel=function(){var e=this.scope.viewModel.tile;e.isTemporary?this.services.dashboardService.removeTemporaryTile(e):(this.scope.viewModel.undoChanges(),e.realTime&&this.restoreRealTimeTileContext()),this.services.taskPaneSliderService.collapsePane()},t.prototype.back=function(){var e=this.scope.viewModel.tile;if(e.isTemporary){var t=e.realTime?d.RealTimeBlade:d.TileGallery;this.services.taskPaneSliderService.expandPane(t,i.Large)}},t.prototype.restoreDefaults=function(){this.scope.viewModel.restoreDefaults(),
this.scope.hasCustomLink=!1,this.scope.customLinkType=1;var t=this.scope.viewModel.tile.action;t.action===e.constants.openUrlActionName&&(t.action=null),this.setDisplayTitle()},t.prototype.save=function(){var e=this.scope.viewModel;if(e.isValid(2===this.scope.customLinkType)){var t=e.tile;t.isTemporary?(t.isSelected=!1,this.saveNewTile()):this.saveExistingTile()}},t.prototype.saveNewTile=function(){var t=this.scope.viewModel,i=this.getPinTileTelemetryEvent();t.updateModelContract(),this.tileSaved=!0,this.services.dashboardService.saveTemporaryTile(t.tile,i),this.scope.$emit(e.constants.hideTileEditorEventName)},t.prototype.saveExistingTile=function(){var t=this,i=this.scope.viewModel,r=i.tile.contract,a=i.originalContract;if(!i.isDirty())return void this.scope.$emit(e.constants.hideTileEditorEventName);i.updateModelContract();var n=this.services.telemetryService.startEvent(e.telemetry.DashboardEditTileProperties,!1,r.displayText!==a.displayText,r.subDisplayText!==a.subDisplayText,r.action!==a.action,r.config!==a.config);this.services.dashboardHttpService.updateTile(a,r,n.event).then((function(){n.resolve(),t.tileSaved=!0,t.scope.$emit(e.constants.hideTileEditorEventName);var i=t.services.dashboardDataService.activeDashboard;i&&i.isUsedByContentPack&&t.services.rootScope.$emit(e.constants.contentPackDirtyShowNotification,i.id,o.Dashboard)}),(function(i){i.status===e.HttpStatusCode.Unauthorized?(n.event.info.readOnlyTileEdited=!0,n.resolve()):n.reject(),t.services.errorService.error(t.services.localizationService.get("TileEditor_UpdateFailed"),"TileEditor_UpdateFailed",{requestId:i.requestId,statusCode:i.status.toString()})}))},t.prototype.setCustomLinkProperties=function(){var t=this.scope,i=t.viewModel.tile,o=i.action,s=i.intraDomainNavigationParameters;o.openInSameTab=!!o.openInSameTab||!1,t.customLinkType=a(o.targetUrl)?2:1,t.hasCustomLink=o.action===e.constants.openUrlActionName;var c=this.services,l=c.dashboardDataService,d=l.visibleDashboards.slice();_.pull(d,l.activeDashboard);var p,u=c.reportService.copyAndEditReports,v=_.union(d,u);if(!_.isEmpty(v))if(1===t.customLinkType)p=v[0];else if(s){var h=s.navigationType===n.Dashboard?d:u;p=_.find(h,(function(e){return e.objectId===s.navigationTargetGuid}))}var g=function(e){var t=e instanceof r?"CreateApp_DefaultContent_Dashboard":"CreateApp_DefaultContent_Report";return c.localizationService.format(t,[e.displayName])};t.internalLinkInfo={candidates:v,target:p,getCandidateName:g,hasError:2===t.customLinkType&&!p}},t.prototype.setCustomLinkChanged=function(){var t=this.scope.viewModel,i=this.scope;if(i.hasCustomLink){i.customLinkType=i.customLinkType||1,t.setAction(e.constants.openUrlActionName);var o=t.tile.action;if(o.openInSameTab=!1,2===i.customLinkType)this.onLinkTargetChanged();else{var r=t.originalContract.$action;o.targetUrl=r&&!a(r.targetUrl)?r.targetUrl:null}}else t.setAction(null)},t.prototype.setDisplayTitle=function(){var e=this.scope,t=e.viewModel,i=t.tile.config,o=i&&!!i.hideTitle,r=t.titleRequired||!!t.tile.getDisplayText();e.displayTitle=!o&&r},t.prototype.showLastRefreshTimeChanged=function(){var e=this.scope.viewModel.tile.config;e&&e.lastRefreshTimeEnabled&&!this.scope.displayTitle&&(this.scope.displayTitle=!0,this.toggleDisplayTitle())},t.prototype.toggleDisplayTitle=function(){this.scope.viewModel.tile.config=this.scope.viewModel.tile.config||{},this.scope.viewModel.tile.config.hideTitle=!this.scope.displayTitle},t.prototype.tileEditorHeaderPaneTitle=function(){var e=this.services.localizationService,t=e.get("TileEditor_PaneTitle_Details"),i=this.scope.viewModel.tile,o=i.config&&i.config.widget;if(null==o||!i.isTemporary)return t;switch(o.id){case 1:return e.get("TileEditorPane_WebContentTitle");case 2:return e.get("TileEditorPane_ImageWidgetTitle");case 3:return e.get("TileEditorPane_TextboxTitle");case 4:return e.get("TileEditorPane_VideoWidgetTitle");default:return t}},t.prototype.getPinTileTelemetryEvent=function(){var t=this.scope.viewModel,i=t.tile.config,o=e.dataServices.TileUtils.getVisualType(i)||"",r=i&&i.widget?i.widget.name:"",a=t.tile.realTime;a&&(o=a.visual&&a.visual.type,r=u[u.realTime]);var n=this.services.telemetryService.startEvent(e.telemetry.DashboardPinTile,o,e.telemetry.PinTileSource.Widget,"",!1,"",!1,r,!1);return n},t.prototype.saveRealTimeTileContext=function(){var e=this.scope.viewModel.tile.realTime;this.restoreContext={singleVisualConfig:l.clone(e.singleVisualConfig),dataWindow:e.config.dataWindow}},t.prototype.restoreRealTimeTileContext=function(){var e=this.scope.viewModel.tile,t=e.realTime;if(t.singleVisualConfig&&this.restoreContext){t.hideVisual&&(t.hideVisual=!1);var i=this.services;v.UpdateRealTimeTile(e,this.restoreContext.singleVisualConfig,this.restoreContext.dataWindow,this.scope.selectedModel,t.schema,i.pinVisual,i.visualPlugin,i.visualQueryGenerator,i.telemetryService)}},t.prototype.addPackageDetails=function(e){var t=this.scope.tileModel;if(t&&t.contract.tilePackage){var i=t.contract.tilePackage;e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageId"),i.id.toString())),i.lastRefreshTime&&(e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageLastRefreshTime"),s.convertRefreshTimeToJsDateTime(i.lastRefreshTime).toLocaleString())),null!=i.publishOrRefreshStatus&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageLastRefreshStatus"),i.publishOrRefreshStatus.toString()))),i.NextRefreshTime&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageNextRefreshTime"),s.convertRefreshTimeToJsDateTime(i.NextRefreshTime).toLocaleString())),i.contentProviderId&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_PakageContentProviderId"),i.contentProviderId.toString()))}},t.prototype.addModelDetails=function(e){var t=this.scope.selectedModel;t&&(e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelId"),t.id.toString())),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelLastRefreshTime"),t.lastRefreshTimeInLocaleString)),null!=t.contract.lastRefreshStatus&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelLastRefreshStatus"),t.contract.lastRefreshStatus.toString())),t.contract.nextRefreshTime&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelNextRefreshTime"),s.convertRefreshTimeToJsDateTime(t.contract.nextRefreshTime).toLocaleString())),t.contract.lastTimeAModelChangeWasDetectedInTheCluster&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelLastTimeAModelChangeWasDetectedInTheCluster"),s.convertRefreshTimeToJsDateTime(t.contract.lastTimeAModelChangeWasDetectedInTheCluster).toLocaleString())),t.contract.onPremModelConnectionString&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelOnPremModelConnectionString"),t.contract.onPremModelConnectionString)),null!=t.contract.forcedRLS&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelForcedRLS"),String(t.contract.forcedRLS))),null!=t.contract.directQueryMode&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelDirectQueryMode"),String(t.contract.directQueryMode))),null!=t.contract.isRefreshedByContentProvider&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ModelIsRefreshedByContentProvider"),String(t.contract.isRefreshedByContentProvider))))},t.prototype.addTileDetails=function(e){var t=this.scope.tileModel;e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_TileId"),t.id.toString()));var i=t.contract;if(i){i.errorCode&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorCode"),i.errorCode.toString()));var o=i.queryResultError;o&&(e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorId"),o.id.toString())),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorType"),o.type.toString())),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorDetail"),o.errorDetail)),e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_ErrorRequestActivityId"),o.rootActivityId))),i.queryHash&&e.append(InJs.InfoNavUtility.constructErrorField(this.services.localizationService.get("TileEditor_TechnicalDetails_QueryHash"),i.queryHash.toString()))}},t})();t.TileEditorController=h})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.models.TileFactory,o=e.dataServices.contracts.TileType,r=2,a=2,n=(function(){function t(e,t){this.scope=e,this.services=t,this.tileGroups=i.getTileGalleryGroups(),this.clearOutTemporaryTile()}return t.createOptions=function(){return{additionalServices:["modelConverter","telemetryService","dashboardService","taskPaneSliderService"]}},t.prototype.closeTileGalleryPane=function(){this.selectedTile=null,this.services.taskPaneSliderService.collapsePane()},t.prototype.select=function(e){this.selectedTile=e},t.prototype.next=function(){var t=this.services,i=t.modelConverter.convertTile(this.selectedTile.defaultTileContract),n=e.dataServices.ContractUtils.getMasterLayoutPosition(i.contract);n.width=n.width||r,n.height=n.height||a;var s=o[i.type];t.telemetryService.logEvent(e.telemetry.DashboardWidgetSelected,s);var c={tile:i.contract,parentEvent:null,isTemporaryTile:!0,showNotification:!1};this.services.dashboardService.pinTileWithoutNotification(c)},t.prototype.clearOutTemporaryTile=function(){var e=this.services.dashboardService.getSelectedDashboardTile(),t=e&&e.tileModel;t&&t.isTemporary&&this.services.dashboardService.removeTemporaryTile(t)},t})();t.TileGalleryController=n})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=jsCommon.JsonExtensions,r=e.explore.services,a=e.dataServices.contracts.TileType,n=jsCommon.Trace,s=(function(){function t(e,t){var a=this;this.tileRefreshRetryCount=0,this.scope=e,this.services=t,this.scope.viewModel.updateVisualInteractivityOptions("true"===e.allowInteractivity),this.onViewModelChanged();var s=e.$watch("viewModel",(function(){return a.onViewModelChanged()}));e.$on(i.visualReady,(function(e){a.onVisualDataChanged(e)})),e.$on(i.scopeDestroyEventName,(function(){s()}));var c=this.scope.viewModel.getThemeName();if(this.themeLoaded=!c||this.services.themeService.isThemeLoaded(c),!this.themeLoaded){var l=this.services.resourcePackagesService.getAllPackages();r.loadRegisteredResourceAsDecodedString(this.services.promiseFactory,this.services.resourceLoader,l,c).then((function(e){if(e){var t=o.tryParseJSON(e,void 0,!0);t?a.services.themeService.addCustomTheme(c,t):n.error("Theme JSON could not be parsed",!0)}else n.error("Theme was not loaded",!0)})).catch((function(e){n.error("Error loading theme - "+e,!0)})).finally((function(){a.themeLoaded=!0,a.scope.$applyAsync()}))}}return t.createOptions=function(){return{additionalServices:["dataProxy","localizationService","modelConverter","telemetryService","visualPlugin","modelService","featureSwitchService","promiseFactory","resourcePackagesService","themeService"],scopedDependencies:["resourceLoader"]}},t.prototype.readyToRender=function(){return!this.scope.viewModel.isLoading&&this.themeLoaded},t.prototype.onViewModelChanged=function(){var t=this,i=this.scope,o=i.viewModel;if(o){this.initTileData();var r=o.contract,a=this.services.modelService.findModel(r.modelId,r.packageId),n=!!r.queryResultError,s=this.services.featureSwitchService.featureSwitches.selectiveRefreshEnabled,c=s&&!n&&o.isDataStale(a?a.lastRefreshEpochTime:void 0);this.shouldRefreshData(n,c)&&(this.tileRefreshRetryCount++,o.isLoading=!o.tileData.data,this.scope.$emit(e.constants.refreshTileData,o.contract.modelId),o.setDataLoadEventDelegate((function(){return t.services.telemetryService.startEvent(e.telemetry.DashboardLoadTileData,o.contract.id,o.contract.modelId)}))),o.setDependencies(this.services.dataProxy),e.tileDataRefreshWorker(this.scope,this.services.modelConverter,o),o.errorText=o.errorText||this.services.localizationService.get("Tile_ErrorText"),o.onErrorDelegate=function(){return t.onErrorChanged()};var l=o.visual&&o.visual.type;i.allowDeferredRendering=l&&!this.services.visualPlugin.isLightWeightRenderingVisual(l),o.onErrorDelegate(),o.shouldBeIncludedInTelemetryMeasurement=!(!o.tileData||!o.tileData.data||n)}},t.prototype.onErrorChanged=function(){var t=this.scope.viewModel;t&&t.isError?(this.services.telemetryService.logEvent(e.telemetry.DashboardTileError,a[a.composite],t.errorText),this.scope.$emit(i.tileErrorEventName,t.errorText,t.errorDetails)):this.scope.$emit(i.clearTileErrorEventName)},t.prototype.shouldRefreshData=function(e,i){if(this.tileRefreshRetryCount>=t.tileRefreshRetryMaxCount)return!1;if(e)return!1;var o=this.scope.viewModel;return!!o.tileData&&(!!o.requiresData()&&(!o.tileData.data||i))},t.prototype.initTileData=function(){var e=this.scope.viewModel;if(!e.tileData){var t=this.services;try{e.tileData=t.modelConverter.convertTileData(e.contract)}catch(i){e.isError=!0,e.errorText=t.localizationService.get("Tile_DsrParseErrorText")}}},t.prototype.onVisualDataChanged=function(e){e.stopPropagation();var t=this.scope.viewModel;this.scope.$emit(i.tileVisualLoadedEventName,t.contract.id)},t})();s.tileRefreshRetryMaxCount=1,t.CompositeTileController=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.constants,r=e.common.models.CollapsiblePaneExpandedWidth,a=e.dataServices.models.DashboardTileModel,n=jsCommon.EnumExtensions,s=e.common.contracts.Permissions,c=e.telemetry.PinTileSource,l=e.common.constants.TaskPaneCollapsiblePaneMode,d=e.dataServices.contracts.TileType,p=e.dataServices.TileUtils;!(function(e){e[e.delete=0]="delete",e[e.edit=1]="edit",e[e.inFocus=2]="inFocus"})(i=t.tileActions||(t.tileActions={}));var u=7,v=6,h=(function(){function t(t,i){var r=this;this.scope=t,this.services=i;var n=this.scope.viewModel;this.isHovered=!1,this.scope.isTileError=!1,this.scope.optionsMenuVisible=!1,t.inFocusState=i.inFocusService.getInFocusState(n),this.scope.model=new a(n),this.scope.editTile=function(e){return r.editTile(e)},this.scope.deleteTile=function(){return r.deleteTile()},this.scope.openTile=function(e,t){return r.openTile(e,t)},this.scope.showAlertsEditor=function(e){return r.showAlertsEditor(e)},this.scope.setOptionsMenuVisibility=function(e,t){return r.setOptionsMenuVisibility(e,t)},this.scope.pinTileFromDashboard=function(e){return r.pinTileFromDashboard(e)},this.scope.inFocusTile=function(e,t){return r.inFocusTile(e,t)},this.scope.isInsightsSupported=function(){return r.isInsightsSupported()},this.scope.openNotifications=function(e){return r.openNotifications(e)},this.scope.isReadOnly=function(){return r.isReadOnly()},this.scope.isNonActionable=function(){return r.isNonActionable()},this.scope.displayDashboardTileOptionsMenuVisible=function(){return r.displayDashboardTileOptionsMenuVisible()},this.scope.displayDashboardTileOpenOptions=function(){return r.displayDashboardTileOpenOptions()},this.scope.setHover=function(e){return r.setHover(e)},this.scope.displayDashboardTileShowIcon=function(){return r.displayDashboardTileShowIcon()},this.scope.inEditMobileLayoutMode=function(){return r.inEditMobileLayoutMode()},this.scope.viewportContextSelector=this.scope.viewportContextSelector||o.dashboardSelector;var s=n.contract;n.setDatasetModelAndPackageInfo(this.services.modelService.findModel(s.modelId,s.packageId),this.services.packageService.findPackage(s.packageId)),this.scope.getOpenActionType=function(){return r.getOpenActionType()},this.scope.getOpenActionDescriptionText=function(){return r.getOpenActionDescriptionText()};var c=this.services.rootScope.$on(e.constants.setDashboardTileOptionsMenuVisibility,(function(e,t){r.updateOptionsMenu(e,t)}));this.scope.isModelTile=n&&n.model&&n.contract&&!n.contract.config,this.scope.isWorkbookTile=n&&n.workbook&&n.contract&&"number"==typeof n.contract.workbookId,this.scope.shouldShowPinButton=function(){return r.shouldShowPinButton()},this.scope.shouldShowAlertsButton=function(){return r.shouldShowAlertsButton()},this.scope.shouldShowInfocusButton=function(){return r.shouldShowInfocusButton()},this.scope.exportVisualData=function(e){return r.exportVisualData(e)},this.setCanExportVisualData(),this.updateReportModel(n),this.isReportTile()&&this.setReportTileContext(n),this.scope.$on(o.scopeDestroyEventName,(function(){c()})),this.setInViewPort()}return t.createOptions=function(){return{additionalServices:["pinTileService","contentProviderHttpService","telemetryService","inFocusService","featureSwitchService","localizationService","reportService","modelService","packageService","workbookService","modelConverter","errorService","visualPlugin","userNotificationInfo","userNotificationTileFilterService","groupService","navigation","dashboardDataService","userInfo","dashboardService","auditing","platformCapabilities","taskPaneSliderService"],scopedDependencies:["exportData"]}},t.prototype.setInViewPort=function(){var t=this.scope.viewModel,i=e.dataServices.ContractUtils.getMasterLayoutPosition(t.contract);i&&(this.scope.inViewport=i.x+i.width<=u&&i.y+i.height<=v)},t.prototype.isReadOnly=function(){return!this.scope.canEdit||this.scope.disableInteractions},t.prototype.isNonActionable=function(){var e=this.scope.viewModel;return!e||!e.action||!e.action.action||this.scope.disableInteractions},t.prototype.setHover=function(e){this.isHovered=e},t.prototype.displayDashboardTileOpenOptions=function(){var e=this.scope.viewModel,t=this.services.platformCapabilities.supportsMouseover;return this.scope.inViewport&&(this.isHovered||!t)&&e&&!this.scope.optionsMenuVisible&&!e.isTemporary&&!this.scope.disableInteractions&&!this.inEditMobileLayoutMode()},t.prototype.displayDashboardTileOptionsMenuVisible=function(){return this.scope.optionsMenuVisible&&!this.scope.disableInteractions},t.prototype.displayDashboardTileShowIcon=function(){return this.scope.disableInteractions},t.prototype.inEditMobileLayoutMode=function(){return this.services.dashboardDataService.InEditMobileLayoutMode},t.prototype.isReportTile=function(){var e=this.scope.viewModel;return e&&null!=e.reportTile},t.prototype.setCanExportVisualData=function(){var e=this,t=this.services.exportData,i=this.scope.viewModel;if(i.type!==d.composite)return void(this.scope.canExport=t.canExportTileData(i));var o=this.scope.$watch("viewModel.composite.tileData",(function(r){r&&(e.scope.canExport=t.canExportTileData(i),o())}))},t.prototype.exportVisualData=function(t){t.stopPropagation();var i=this.services,o=this.scope.viewModel,r=p.getVisualType(o.config);this.scope.optionsMenuVisible=!1;var a=this.services.userInfo.isPremiumUser,n=o.contract&&o.contract.id,s=i.telemetryService.startEvent(e.telemetry.EXExportVisualData,r,e.telemetry.ExportVisualSource.Dashboard,!1,0,a,!1,0);this.services.exportData.exportTileDataToCsv(this.scope.viewModel).then((function(e){s.event.info.isPartialResult=e.isPartialResult,s.resolve()}),(function(e){s.reject({errorCode:e.error.toString()})})),this.services.auditing.auditEvent(n,e.common.contracts.AuditEntityType.Tile,e.common.contracts.AuditActivityType.exportDashboardTile)},t.prototype.shouldShowPinButtonForWorkbookTile=function(){var e=this.scope.viewModel,t=this.scope.isWorkbookTile&&e.config&&!e.config.workbookTile,i=!1;if(e.workbook&&e.workbook.contract){var o=this.services.workbookService.findWorkbook(e.workbook.contract.workbookId,e.workbook.contract.packageId);i=!o||!o.isOwner()}return!t&&!i},t.prototype.shouldShowPinButton=function(){var e=this.scope.viewModel,t=null!==this.scope.isModelTile&&this.scope.isModelTile;return!t&&!this.scope.isTileError&&(!e.workbook||this.shouldShowPinButtonForWorkbookTile())},t.prototype.updateReportModel=function(e){e&&e.report&&(e.report=this.services.reportService.findReport(e.report.id))},t.prototype.setReportTileContext=function(e){if(this.scope.isTileError=e.reportTile.isError,e.report&&e.action.action===o.openReportActionName){var t=this.services.reportService.findReport(e.report.id);t||this.services.reportService.addReport(e.report);var i=this.services.modelService.findModel(e.report.modelId);i||this.services.modelService.addContractModel(e.contractsModel)}},t.prototype.getOpenActionType=function(){var e=this.scope.viewModel;return e.action.action===this.tileActionCache?this.tileActionTypeCache:(this.updateTileActionProperties(),this.tileActionTypeCache)},t.prototype.getOpenActionDescriptionText=function(){var e=this.scope.viewModel;return e.action.action===this.tileActionCache&&null!=this.tileActionDescriptionCache?this.tileActionDescriptionCache:(this.updateTileActionProperties(),this.tileActionDescriptionCache)},t.prototype.updateTileActionProperties=function(){var e=this.scope.viewModel;this.tileActionCache=e.action.action,this.updateTileActionType(),this.updateTileActionText()},t.prototype.updateTileActionType=function(){var t=this.scope.viewModel;t.action.action===e.constants.openUrlActionName?this.tileActionTypeCache=0:t.action.action===o.openQnAActionName?this.tileActionTypeCache=1:t.action.action===o.openReportActionName&&!this.scope.isModelTile&&t.report?this.tileActionTypeCache=2:t.action.action===o.openReportActionName&&!t.report&&this.scope.isModelTile?this.tileActionTypeCache=4:t.action.action===o.openReportActionName&&(t.report||this.scope.isModelTile)?this.tileActionTypeCache=2:t.action.action===o.openWorkbookActionName&&t.workbook&&(this.tileActionTypeCache=3)},t.prototype.updateTileActionText=function(){var t=this.scope.viewModel;if(t.action.action===e.constants.openUrlActionName)this.tileActionDescriptionCache=t.action.targetUrl;else if(t.action.action===o.openQnAActionName)this.tileActionDescriptionCache=t.utterance;else if(t.action.action!==o.openReportActionName||this.scope.isModelTile)if(t.action.action===o.openReportActionName||t.action.action===e.constants.openInFocusTileActionName||t.action.action===o.openInsightsActionName){var i=null;t.contractsModel&&(i=this.services.modelService.findModel(t.contractsModel.id,t.contractsModel.packageId)),this.tileActionDescriptionCache=i?i.displayName:""}else if(t.action.action===o.openWorkbookActionName){var r=t.contract&&t.contract.workbookId,a=this.services.workbookService.findWorkbook(r);this.tileActionDescriptionCache=a?a.displayName:""}else t.action.action||(this.tileActionDescriptionCache=this.services.localizationService.get("TileMenuOption_NoAction"));else{var n=t.report&&t.report.objectId,s=this.services.reportService.findReportByGUID(n);this.tileActionDescriptionCache=s?s.displayName:""}},t.prototype.updateOptionsMenu=function(e,t){t!==this.scope.model.tileModel.id&&(this.scope.optionsMenuVisible=!1)},t.prototype.setOptionsMenuVisibility=function(t,i){i.stopPropagation(),this.scope.optionsMenuVisible=t,this.services.rootScope.$emit(e.constants.setDashboardTileOptionsMenuVisibility,this.scope.model.tileModel.id)},t.prototype.openTile=function(t,i){var o=this.scope.model.tileModel,r=o&&o.composite&&o.composite.isError;if(this.scope.disableInteractions||this.inEditMobileLayoutMode())return i&&i.preventDefault&&i.preventDefault(),!1;if(!t&&r)return!1;if(!t&&this.isReportTile())return!1;if(this.scope.optionsMenuVisible=!1,this.scope.isTileElementChanging())return!1;if(o.isLoading)return!1;if(i)try{var a=i,n=$(a.target||a.srcElement);if(n.is("a")&&!n.hasClass("dashboardTileLayout"))return!1}catch(e){}return this.scope.$emit(e.constants.openTileEventName,o),i&&i.stopPropagation&&i.stopPropagation(),!0},t.prototype.editTile=function(t){t&&t.stopPropagation&&t.stopPropagation(),this.scope.optionsMenuVisible=!1,this.scope.$emit(e.constants.showTileEditorEventName,this.scope.model)},t.prototype.deleteTile=function(){this.scope.optionsMenuVisible=!1,this.scope.$emit(e.constants.hideTileEditorEventName),this.scope.$emit(t.Events.DeleteTile),this.scope.$emit(e.constants.removeTileEventName,this.scope.model.tileModel)},t.prototype.pinTileFromDashboard=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a,n,s,l,d;return __generator(this,(function(p){switch(p.label){case 0:return t.stopPropagation(),this.scope.optionsMenuVisible=!1,i=this.services.contentProviderHttpService.getBuiltInContentProviders(),o=this.scope.model.tileModel,r=o.model&&o.model.contentProviderId,a=e.common.findContentProviderName(i,r),n=o.contract.resourcePackageIds,s=!!(n&&n.length>0),l=o.config&&o.config.widget?o.config.widget.name:"",d=this.services.telemetryService.startEvent(e.telemetry.DashboardPinTile,o.composite?o.composite.visual.type:void 0,c.Dashboard,"",!1,a,s,l,!1),[4,this.services.pinTileService.showPinVisualFromDashboardDialog(o,d)];case 1:return[2,p.sent()]}}))}))},t.prototype.inFocusTile=function(e,t){e.stopPropagation(),this.scope.optionsMenuVisible=!1;var i=this.scope.model.tileModel;this.services.dashboardService.selectDashboardTile(this.scope.model);var o=i.objectId,r=i.contract.originalTileObjectId,a=this.services.groupService.activeGroupObjectId,n=this.services.dashboardDataService.activeDashboard.objectId,s=this.services.dashboardDataService.activeDashboard.contract.originalDashboardObjectId;t?this.services.navigation.showInsightsInFocusMode(o,r,n,a):this.services.navigation.showInFocusMode(o,r,n,s,a)},t.prototype.isInsightsSupported=function(){var e=this.scope.viewModel,t=e.datasetModel;return!e.workbook&&!e.realTime&&t&&!t.isHidden&&t.contract.insightsSupported&&n.hasFlag(t.getPermissions(),s.Read)},t.prototype.showAlertsEditor=function(e){e&&e.stopPropagation&&e.stopPropagation(),this.scope.optionsMenuVisible=!1,this.services.dashboardService.selectDashboardTile(this.scope.model),this.services.taskPaneSliderService.expandPane(l.AlertsEditor,r.Small)},t.prototype.shouldShowAlertsButton=function(){var t=this.scope.viewModel.datasetModel;if(!t||!this.services.dashboardService.isAlertingEnabled())return!1;var i=this.scope.viewModel;if(i.type===d.realTime)return!1;var o=p.getVisualType(i.config);return o===e.visuals.plugins.card.name||o===e.visuals.plugins.gauge.name||o===e.visuals.plugins.kpi.name},t.prototype.shouldShowInfocusButton=function(){return 1===this.scope.inFocusState&&this.services.dashboardService.isInFocusModeEnabled()},t.prototype.openNotifications=function(t){t&&t.stopPropagation&&t.stopPropagation();var i=this.scope.viewModel.contract.id,o=this.services.userNotificationInfo.userNotifications.notifications,r=_.filter(this.services.userNotificationTileFilterService.filterNotifications(o,i),(function(e){return!e.seen}));if(!_.isEmpty(r))for(var a=0,n=r;a<n.length;a++){var s=n[a];s.message.filterProperties&&s.message.filterProperties.UserDataAlertRuleId&&this.services.telemetryService.logEvent(e.telemetry.DataAlertsTileBadgeClicked,parseInt(s.message.filterProperties.UserDataAlertRuleId,10))}this.services.userNotificationTileFilterService.tileId=i,this.services.userNotificationInfo.showPane=!0},t})();h.Events={DeleteTile:"DeleteTile"},t.DashboardTileController=h})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.scope=e,this.element=t}return e})();e.ImageTileController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.scope=e,this.element=t}return e})();e.ModelTileController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e){var t=this;this.scope=e,this.scope.openTile=function(){return t.openTile()}}return t.prototype.openTile=function(){var t=this.scope.viewModel;this.scope.$emit(e.constants.openProviderTileEventName,t)},t})();t.ProviderTileController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common,o=e.explore.util.ExplorationTrustedVisualUtil,r=jsCommon.JsonExtensions,a=e.dataServices.contracts.TileType,n=e.explore.ScopeUtils,s=e.dataServices.models.TileFactory,c=e.explore.FilterUtils,l=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,n.defineDataSourcesOnScopeLegacy(this.scope,this.services.dataSources);var r=this.services.viewModeState;r.setMode(0);var a=this.scope.$on(e.constants.populateDashboardWithReportTiles,(function(){o.populateReportTiles()}));this.services.undoRedo.setHandler({rollback:function(){},takeSnapshot:function(){return null}}),this.scope.$on("$destroy",(function(){a()})),this.populateReportTiles();var s={showAppBar:!1,showTaskPane:!1,showVisualizationPane:!1,showNavContentPane:!0,visualContainerOptions:{showMenu:!1,showPin:!1,showContextMenu:!1,disablePin:!1,hideHeader:!0},showBackButtonOnAppBar:!1};this.services.explorationCapabilities.setCapabilities(s)}return t.createOptions=function(){return{scopedDependencies:["dataSources","viewModeState","undoRedo","selection","visualPlugin","explorationNavigation","explorationCapabilities","resourceLoader","shell"],scopedServiceRoot:!0,additionalServices:["conceptualSchemaProxy","promiseFactory","localizationService","modelService","reportService","modelConverter","pinTileService","reportTileService","resourcePackagesService","explorationSerializer","featureSwitchService","visualPlugin","telemetryService","trustedVisual","themeService"]}},t.prototype.reloadTrustedVisuals=function(t){_.isEmpty(t)||(this.services.visualPlugin.ensureTrustedVisualPlugins(t),this.services.rootScope.$emit(e.constants.reloadEmptyVisuals,{visualTypes:t.map((function(e){return e.name}))}))},t.prototype.populateExploration=function(e,i,r,a,n){var s=this;this.setDataSources(e,i);var c={withData:!0,withQuery:!0},l=this.services.explorationSerializer.deepCopyExploration(i,c),d=this.services.pinTileService.mapCanvasSize(l,r);this.applySectionParameterFilters(d,r,a,n);var p=t.getReferencedResourcePackages(d,r);this.resolveExploration(p,d,r),o.acquireTrustedVisuals(i,this.services.trustedVisual).then((function(e){return s.reloadTrustedVisuals(e)}))},t.prototype.resolveExploration=function(t,i,o){if(_.isEmpty(t))this.resolveExplorationWithoutResourcePackage(i,o);else{var r=this.scope.viewModel;this.services.telemetryService.logEvent(e.telemetry.DashboardRegisterAndLoadResourcePackagesForReportTiles,t.length,r&&r.contract?r.contract.id:-1,!0),this.resolveExplorationWithResourcePackages(t,i,o)}},t.prototype.applySectionParameterFilters=function(t,i,o,r){if(t&&t.sections){var a=e.explore.SectionUtils.findSectionIndexForSectionId(t,i),n=null!=a&&t.sections[a];if(n){c.mergeExplorationSectionFilters(t,n);var s=e.explore.PodUtils.findPodIndexForPodName(t,o),l=null!=s&&t.pods[s];c.applySectionParameterFilters(n,l,r)}}},t.prototype.resolveExplorationWithResourcePackages=function(e,t,i){var o=this;this.services.resourcePackagesService.registerPackages(e),this.services.visualPlugin.ensurePlugins(e,!1).finally((function(){o.resolveExplorationWithoutResourcePackage(t,i)}))},t.prototype.populateReportTiles=function(){var e=this,t=this.scope.viewModel;if(t.isError=!1,
t&&t.contract){var i=t.contract;if(!i||i.type!==a.report)return;var o=this.services.modelConverter.convertTileConfig(i),r=i.reportId,n=this.services.reportService.findReport(r),s=i.sectionId;if(!n)return void this.setErrorText();var c=this.services.modelService.findModel(n.modelId,n.packageId);this.services.reportTileService.getExploration(r,s).then((function(t){return e.initializeExplorationTheme(t)})).then((function(t){var i=o&&o.reportTile&&o.reportTile.sectionId,r=t.sections;if(null==s&&null!=i&&null!=r&&i<r.length){var a=t.sections[i];if(!a)return void e.setErrorText();s=a.id}var n=null,l=null;if(o&&o.reportTile&&(n=o.reportTile.pod,o.reportTile.filters)){var d=[];l=e.services.explorationSerializer.deserializeFilterCollection(o.reportTile.filters,d,!1)}e.populateExploration(c.contract,t,s,n,l)}),(function(){return e.setErrorText()}))}},t.prototype.initializeExplorationTheme=function(t){var o=this;if(t&&t.theme){if(i.isLegacyThemeName(t.theme))return this.services.promiseFactory.resolve(t);this.scope.themeName=t.theme;var a=e.explore.services.loadRegisteredResourceAsDecodedString(this.services.promiseFactory,this.services.resourceLoader,t.resourcePackages,t.theme);return a.then((function(e){if(e){var i=r.tryParseJSON(e);i&&o.services.themeService.addCustomTheme(t.theme,i)}return t})).catch((function(){return t}))}return this.services.promiseFactory.resolve(t)},t.prototype.resolveExplorationWithoutResourcePackage=function(t,i){var o=this.scope.viewModel,r=t.sections,a=r.length,n=[];this.services.explorationNavigation.loadExploration(t);for(var c=0;c<a;c++)r[c].crossHighlight=void 0,n[c]={contract:r[c],selected:!0,displayName:r[c].displayName};if(void 0===i)return void this.setErrorText();var l=e.explore.SectionUtils.findSectionById(t,i);if(!l)return void this.setErrorText();this.services.explorationNavigation.goto(l);for(var d=new e.explore.viewModels.ExploreCanvas(l),p=jsCommon.ArrayExtensions.createWithId(),u=l.visualContainers.length,c=0;c<u;c++){var v=e.explore.viewModels.ViewModelFactory.convertVisualContainer(t,d.contract,l.visualContainers[c],0);v.allowDeferredRendering=!0,v.options=this.services.explorationCapabilities.getCapabilities().visualContainerOptions,p.push(v)}d.visualContainers=p,o.exploration={contract:t,exploreCanvas:d,sections:n},o.isLoading=s.isTileLoading(o.contract)},t.prototype.setDataSources=function(t,i){var o=i.dataSources.withId(t.id);if(!o){var r=e.explore.constants.DefaultSchemaName;if(o={type:e.common.constants.dsrDataReaderType,id:t.id,name:e.explore.constants.DefaultSchemaName,dsr:{schemaName:e.explore.constants.DefaultSchemaName,vsName:t.vsName,dbName:t.dbName,modelId:t.id}},i.dataSources.push(o),this.services.featureSwitchService.featureSwitches.reportMeasures){var a=e.explore.constants.ExplorationSchemaName;i.dataSources.push({type:e.explore.dataReaderPlugins.ExplorationDataReaderType,id:i.id,name:a,extends:r,exploration:{schemaName:a,extends:r,getModelExtensions:function(){return i.modelExtensions}}})}}var n=i.dataSources;this.services.dataSources.set(n)},t.prototype.setErrorText=function(){var e=this.scope.viewModel;e.isError=!0,e.errorText=this.services.localizationService.get("ReportTile_DataUnavailable")},t.getReferencedResourcePackages=function(e,i){var o=t.getReferencedVisualsInSection(e,i);if(!_.isEmpty(o))return _.filter(e.resourcePackages,(function(e){return 0===e.type&&o[e.name]}))},t.getReferencedVisualsInSection=function(e,t){var i=e.sections,o={};if(_.isEmpty(i))return o;for(var r=0,a=i;r<a.length;r++){var n=a[r];if(n.id===t){_.map(n.visualContainers,(function(e){var t=e&&e.config&&e.config.singleVisual&&e.config.singleVisual.visualType;_.isEmpty(t)||(o[t]=!0)}));break}}return o},t})();t.ReportTileController=l})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.scope=e,this.element=t}return e})();e.SsrsTileController=t})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.UrlUtils,o=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.scope.workbookTileUrl=this.workbookTileUrl,this.scope.workbookTileImageUrl=this.workbookTileImageUrl,this.scope.useLiveEwaControl=!!this.services.featureSwitchService.featureSwitches.liveWorkbookTiles;var o=this.scope.$watch("viewModel.tileModel.size",(function(){return i.services.workbookService.setModelDynamicImageUrl(i.scope.viewModel)}),!0),r=this.scope.$watch("viewModel",(function(){return i.services.workbookService.setModelDynamicImageUrl(i.scope.viewModel)}));this.scope.$on("$destroy",(function(){o(),r()})),this.initWorkbookTile()}return t.createOptions=function(){return{additionalServices:["$sce","workbookService","featureSwitchService"]}},t.prototype.constructWorkbookWopiUrl=function(e,t){if(this.scope.viewModel.contract.$config.workbookTile){var i=e.replace(/ExcelJs.ashx/i,"xlEmbed.aspx");return i=i+"&access_token="+t+"&item="+this.scope.viewModel.contract.$config.workbookTile.item+"&action=embedView"}return""},t.prototype.shouldPreparePreviewImage=function(){return!this.scope.viewModel.previewImageUrl&&!this.scope.viewModel.image&&!this.scope.viewModel.hasImages()},t.prototype.initWorkbookTile=function(){var t=this;this.scope.viewModel.isLoading=!0,this.shouldPreparePreviewImage()&&this.services.workbookService.getWorkbookTilePreviewImageUrl(this.scope.viewModel.contract).then((function(i){var o=i.indexOf("?")===-1?"?":"&";t.scope.viewModel.previewImageUrl=i+o+(new Date).getTime(),t.services.workbookService.setModelDynamicImageUrl(t.scope.viewModel),t.scope.onTileImageReady((function(i){t.scope.viewModel.isLoading=!1;var o=e.dataServices.ContractUtils.getMasterLayoutPosition(t.scope.viewModel.contract);o.width=Math.min(e.common.models.gridLayoutConstants.gridDefaultCols,e.common.GridLayoutConstants.getDefaultColSpanFromWidth(i.width)),o.height=Math.min(e.common.models.gridLayoutConstants.gridMaxRowSpan,e.common.GridLayoutConstants.getDefaultRowSpanFromHeight(i.height))}))})),this.scope.useLiveEwaControl&&this.services.workbookService.getWorkbookEmbedAccessData(this.scope.viewModel.contract.workbookId,this.scope.viewModel.contract.packageId).then((function(e){if(e&&i.isValidHttpUrl(e.url)){var o=t.constructWorkbookWopiUrl(e.url,e.accessToken);t.scope.workbookTileUrl=t.services.$sce.trustAsResourceUrl(o)}}))},t})();t.WorkbookTileController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.constants,o=e.dataServices.models.Tile,r=e.models.factory.TileOptionsFactory,a=e.dataServices.TileUtils,n=e.dataServices.contracts.TileType,s=(function(){function t(t,o){var r=this;this.scope=t,this.services=o,this.model=t.viewModel,this.tileId="tile"+this.model.id,this.updateTileHref(),this.scope.hasWarning=function(){return r.hasWarning()},this.scope.shouldShowTileVisual=function(){return r.shouldShowTileVisual()},this.scope.$watchCollection("viewModel.action",(function(){return r.updateTileHref()}));var a=this.services.rootScope.$on(i.reportDeletedEventName,(function(e,t){r.model.report&&r.model.report.id===t&&(r.model.report=null)}));this.scope.$on(e.common.constants.scopeDestroyEventName,(function(){a()})),this.updateModelTileHeaderSize(),this.scope.$root.$on(e.common.constants.needStrategySwapEventName,(function(){r.updateModelTileHeaderSize()})),this.scope.$on(e.common.constants.tileErrorEventName,(function(t,i,o){r.scope.isError=!0,r.scope.errorText=i,r.scope.errorDetails=o||{message:r.scope.errorText,displayableErrorInfo:[]},r.model.resetTileErrors=function(){r.scope.isError=!1},r.scope.$emit(e.constants.dashboardTileErrorEventName,r.model,r.scope.errorDetails)})),this.scope.$on(e.common.constants.clearTileErrorEventName,(function(t){var i=r.scope.errorDetails;r.scope.isError&&i&&r.scope.$emit(e.constants.removeDashboardTileErrorEventName,r.model,i),r.model.resetTileErrors&&r.model.resetTileErrors()})),this.services.rootScope.$on(e.constants.rowLevelSecurityAccessDeniedEventName,(function(e,t){r.model.composite&&_.find(t,(function(e){return r.scope.viewModel.contract.modelId===e}))&&(r.scope.isError=!0,r.scope.errorText=r.services.localizationService.get("Tile_RLS_NoAccess"),r.model.composite.tileData.data=null,r.model.resetTileErrors=function(){r.scope.isError=!1})})),this.scope.getUnseenCount=function(){return r.getUnseenCount()},this.scope.getIcons=function(){return r.getIcons()},this.scope.getWebContentIcon=function(){return r.getWebContentIcon()},this.scope.onIconClick=function(e,t){return r.onIconClick(e,t)}}return t.createOptions=function(){return{additionalServices:["localizationService","userInfo","visualPlugin","dashboardDataService","modelService","userNotificationInfo","featureSwitchService","userNotificationTileFilterService","tileDisplay","errorService","gridLayout","licenseEnforcementService"],scopedDependencies:["scriptVisuals"]}},t.prototype.updateTileHref=function(){this.model.intraDomainNavigationParameters=null;var t=this.model.action;t.action===e.constants.openUrlActionName&&o.isValidUrl(t.targetUrl,!0)?this.scope.$emit(e.constants.updateTileHrefEventName,this.model,t.targetUrl):this.model.href=void 0},t.prototype.hasLostReportConnection=function(){var t="bingSocial",i=this.scope.viewModel,o=i.action;return i.type===n.composite&&o&&!(o.action&&o.action===e.common.constants.openQnAActionName)&&(!o.action||o.action===e.common.constants.openReportActionName&&!i.report)&&i.contract.name!==t&&!i.config.widget},t.prototype.hasWarning=function(){var e=this.services.visualPlugin,t=this.services.userInfo,i=this.scope.viewModel;if(this.scope.isError&&this.services.tileDisplay.isVisualSupportedInErrorState(i)){var o=i.composite;return this.scope.warning={tooltip:this.services.localizationService.format("DashboardAppBar_TileError_ErrorTooltip",[o.errorText])},!0}if(a.tileContainsScriptVisuals(this.scope.viewModel,e)){if(this.services.scriptVisuals.shouldBlockScriptVisual()){var r=t&&!Array.isArray(t)&&this.services.licenseEnforcementService.supportsScriptVisuals();return this.scope.warning={tooltip:r&&this.services.localizationService.get("Tile_RVis_RefreshDisabled")||this.services.localizationService.get("Tile_RVis_RefreshDisabledForNonPro")},!0}}else{if(this.hasLostReportConnection())return this.scope.warning={tooltip:this.services.localizationService.get("Tile_LoseReportConnection")},!0;if(this.scope.viewModel.errorCode)return this.scope.warning={tooltip:this.model.details.getErrorLocId(this.model.errorCode,this.services.localizationService)},!0}return!1},t.prototype.getUnseenCount=function(){var e=this.scope.viewModel.contract.id,t=this.services.userNotificationInfo;if(!e||!t||!t.userNotifications||_.isEmpty(t.userNotifications.notifications))return 0;var i=t.userNotifications.notifications,o=_.filter(this.services.userNotificationTileFilterService.filterNotifications(i,e),(function(e){return!e.seen}));return o.length},t.prototype.onIconClick=function(e,t){t.stopPropagation();var i=this.scope;switch(e.action){case 0:this.scope.headerClickTarget({event:t,openNotification:!0});break;case 2:this.services.tileDisplay.onErrorIconClicked({message:e.tooltip()});break;case 1:this.services.tileDisplay.onErrorIconClicked({isError:i.isError,errorTitle:i.errorText,errorDetails:i.errorDetails,message:e.tooltip()})}},t.prototype.getIcons=function(){var t=this;if(this.icons)return this.icons;var i={badgeTextSetter:this.getUnseenCount.bind(this),localizationService:this.services.localizationService,showNotifications:function(){return t.getUnseenCount()>0},showWarning:this.hasWarning.bind(this),showWebContent:function(){var e=t.scope.viewModel;return e&&e.type===n.iframe&&!e.isTemporary&&e.hasTitle()},showRealTime:function(){var e=t.scope.viewModel;return e&&e.type===n.realTime},warningToolTipSetter:function(){return t.scope.warning&&t.scope.warning.tooltip}};return this.icons=r.getDashboardTileIcons(i),i.showWarning()&&this.scope.$emit(e.constants.dashboardTileErrorEventName,this.model,{message:i.warningToolTipSetter(),displayableErrorInfo:[]}),this.icons},t.prototype.getWebContentIcon=function(){return _.find(this.getIcons(),(function(e){return 2===e.action}))},t.prototype.shouldShowTileVisual=function(){return!!this.services.tileDisplay.shouldShowTileVisual(this.scope.viewModel)&&(!this.scope.isError||this.services.tileDisplay.isVisualSupportedInErrorState(this.scope.viewModel))},t.prototype.updateModelTileHeaderSize=function(){var e=1;this.services.gridLayout.strategy.isDynamic()||this.services.dashboardDataService.InEditMobileLayoutMode?e=2:this.scope.largeHeader&&(e=0),this.model.setTileHeaderSize(e)},t})();t.Tile=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.scope.loadUserMetadata=function(){return i.loadUserMetadata()},this.scope.loadUserMetadata()}return t.createOptions=function(){return{additionalServices:["groupService","featureSwitchService","userInfo"]}},t.prototype.loadUserMetadata=function(){this.scope.viewModel.userName=e.session.UserInfoUtils.getFullName(),this.services.groupService.activeGroup?(this.scope.viewModel.activeGroup=this.services.groupService.activeGroup,this.scope.viewModel.isMyWorkspace=this.scope.viewModel.activeGroup.isMyWorkspace):this.scope.viewModel.isMyWorkspace=!0,this.scope.viewModel.isPremiumUser=this.services.userInfo.isPremiumUser,this.scope.viewModel.userHasFreeTrial=this.services.userInfo.userHasFreeTrial,this.scope.viewModel.userHasPremiumPlan=this.services.userInfo.userHasPremiumPlan},t})();t.UserGroupHeaderController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t){this.scope=t,t.userName=e.session.UserInfoUtils.getFullName()}return t})();t.UserInfoController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i,this.scope.editContentPack=function(e){return o.editContentPack(e)},this.scope.deleteContentPack=function(e){return o.deleteContentPack(e)},this.services.contentPackService.getContentPacksForCurrentGroup().then((function(e){o.scope.contentPacks=_.filter(e,(function(e){return!o.services.contentPackService.isApp(e)}))})),this.scope.userGroupHeader=new e.models.UserGroupHeaderModel}return t.createOptions=function(){return{additionalServices:["navigation","contentPackService"]}},t.prototype.editContentPack=function(e){this.services.navigation.showPublishContentPackSlider(e)},t.prototype.deleteContentPack=function(e){var t=this;this.services.contentPackService.deleteContentPack(e).then((function(i){i&&_.remove(t.scope.contentPacks,(function(t){return t.providerContract.providerKey===e}))}))},t})();t.ViewContentPack=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t){var i=this;this.scope=t,this.scope.onYesClick=function(){return i.scope.viewModel.onButtonClick(e.models.WarningBarResult.Yes)},this.scope.onNoClick=function(){return i.scope.viewModel.onButtonClick(e.models.WarningBarResult.No)},this.scope.onFixItClick=function(){return i.scope.viewModel.onButtonClick(e.models.WarningBarResult.FixIt)}}return t})();t.WarningBarController=i})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.helpers.ModelConverterHelper,r=e.dataServices.constants.workbook,a="WorkbookAppBar_DataRefreshNotSupported_LocalFile_Tooltip",n="WorkbookAppBar_DataRefreshNotSupported_SharedWorkbooks_Tooltip",s="WorkbookAppBar_DataRefreshNotSupported_NoModel_Tooltip",c="WorkbookAppBar_DataRefreshNotSupported_PowerPivotVersion_Tooltip",l="WorkbookAppBar_DataRefreshNotSupported";!(function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.NotSupported=2]="NotSupported",e[e.MissingData=3]="MissingData"})(i=t.DataRefreshStatus||(t.DataRefreshStatus={}));var d;!(function(e){e[e.Supported=0]="Supported",e[e.NotSupportedNotOwned=1]="NotSupportedNotOwned",e[e.NotSupportedLocalWorkbook=2]="NotSupportedLocalWorkbook",e[e.NotSupportedNoModel=3]="NotSupportedNoModel",e[e.NotSupportedPowerPivotOldVersion=4]="NotSupportedPowerPivotOldVersion"})(d||(d={}));var p;!(function(e){e[e.Supported=0]="Supported",e[e.NotSupportedNotOwned=1]="NotSupportedNotOwned",e[e.NotSupportedLocalWorkbook=2]="NotSupportedLocalWorkbook",e[e.NotSupportedNotLoaded=3]="NotSupportedNotLoaded",e[e.StatusNotKnown=4]="StatusNotKnown"})(p||(p={}));var u=(function(){function t(e,t){var i=this;this.scope=e,this.services=t,this.model=this.scope.viewModel,this.services.localizationService.ensureLocalization((function(){i.bindMenuActions()}))}return t.createOptions=function(){return{additionalServices:["localizationService","featureSwitchService","modelService","historyDialogService","packageService","telemetryService"]}},t.prototype.isEditEnabled=function(){return this.model.workbook&&this.getEditSupportedStatus(this.model.workbook)===p.Supported},t.prototype.isWorkbookLoaded=function(){return this.model&&this.model.workbookLoaded},t.prototype.bindMenuActions=function(){var e=this,i=this.scope,o=t.WorkbookAppBarActions;i.editMenuActions=[{text:this.services.localizationService.get("WorkbookAppBar_EditInExcel"),description:this.services.localizationService.get("WorkbookAppBar_EditInExcelDescription"),action:o.EditInExcel,itemClass:"editInExcel",type:DropDownMenuItemType.Item},{text:this.services.localizationService.get("WorkbookAppBar_EditInExcelOnline"),description:this.services.localizationService.get("WorkbookAppBar_EditInExcelOnlineDescription"),action:o.EditInExcelOnline,itemClass:"editInExcelOnline",type:DropDownMenuItemType.Item}],i.dataMenuActions=[{text:this.services.localizationService.get("WorkbookAppBar_Calculate"),description:this.services.localizationService.get("WorkbookAppBar_CalculateDetails"),action:o.Calculate,itemClass:"calculate",type:DropDownMenuItemType.Item}],i.editMenuActionSelected=function(t){return e.onEditMenuActionSelected(t)},i.dataMenuActionSelected=function(t){return e.onDataMenuActionSelected(t)},i.pinClicked=function(){return e.pinClicked()},i.reloadClicked=function(){return e.reloadClicked()},i.isPinToDashboardEnabled=function(){return e.isPinToDashboardEnabled()},i.getPinButtonTooltipLocId=function(){return e.getPinButtonTooltipLocId()},i.isWorkbookLoaded=function(){return e.isWorkbookLoaded()},i.isEditEnabled=function(){return e.isEditEnabled()},i.getEditButtonTooltipLocId=function(){return e.getEditButtonTooltipLocId()},i.getRefreshDataStatus=function(){return e.updateLastRefreshInformationAndGetStatus()}},t.prototype.onEditMenuActionSelected=function(e){var i=t.WorkbookAppBarActions;switch(e.action){case i.EditInExcelOnline:this.EditInExcelOnline();break;case i.EditInExcel:this.EditInExcel()}},t.prototype.onDataMenuActionSelected=function(e){var i=t.WorkbookAppBarActions;switch(e.action){case i.Calculate:this.CalculateClicked()}},t.prototype.CalculateClicked=function(){this.services.telemetryService.logEvent(e.telemetry.DashboardCalculateWorkbook),this.scope.$emit(t.Events.CalculateWorkbookClicked)},t.prototype.EditInExcelOnline=function(){this.scope.$emit(t.Events.EditInExcelOnlineClicked)},t.prototype.EditInExcel=function(){this.scope.$emit(t.Events.EditInExcelClicked)},t.prototype.pinClicked=function(){this.scope.$emit(t.Events.PinClicked)},t.prototype.reloadClicked=function(){this.services.telemetryService.logEvent(e.telemetry.DashboardReloadWorkbook),this.scope.$emit(t.Events.ReloadClicked)},t.prototype.getDataRefreshSupportStatus=function(e){return e.isOwner()?e.contract.modelId?e.contract.isPowerPivotVersionSupportsRefresh?d.Supported:d.NotSupportedPowerPivotOldVersion:d.NotSupportedNoModel:d.NotSupportedNotOwned},t.prototype.getEditSupportedStatus=function(e){return this.model.workbookLoaded&&e.isEditable()?p.Supported:this.model.workbookLoaded?e.isOwner()?this.services.packageService.isLocalWorkbook(e.packageId)?p.NotSupportedLocalWorkbook:p.StatusNotKnown:p.NotSupportedNotOwned:p.NotSupportedNotLoaded},t.prototype.isPinToDashboardEnabled=function(){return this.model.workbook.isOwner()&&this.isWorkbookLoaded()},t.prototype.getPinButtonTooltipLocId=function(){return this.model.workbookLoaded?this.model.workbook.isOwner()?this.model.workbookChanged?"WorkbookAppBar_PinTooltip_Disabled_WorkbookChanged":this.model.workbookRangeSelected?"WorkbookAppBar_PinTooltip_Enabled":"WorkbookAppBar_PinTooltip_Disabled_NoSelection":"WorkbookAppBar_PinTooltip_NotOwner":""},t.prototype.getEditButtonTooltipLocId=function(){var e,t=this.getEditSupportedStatus(this.model.workbook);switch(t){case p.Supported:e="";break;case p.NotSupportedNotLoaded:e="";break;case p.NotSupportedLocalWorkbook:e="WorkbookAppBar_EditToolTip_NotEditable_Local";break;case p.NotSupportedNotOwned:e="WorkbookAppBar_EditToolTip_NotEditable_NotOwned";break;case p.StatusNotKnown:e=""}return e},t.prototype.updateLastRefreshInformationAndGetStatus=function(){if(!this.model||!this.model.workbook)return i.MissingData;var t=this.getDataRefreshSupportStatus(this.model.workbook);if(t!==d.Supported){var o=void 0;switch(t){case d.NotSupportedLocalWorkbook:o=a;break;case d.NotSupportedNotOwned:o=n;break;case d.NotSupportedNoModel:o=s;break;case d.NotSupportedPowerPivotOldVersion:o=c;break;default:o=""}return this.scope.refreshNotSupportedTooltip={tooltipLocalizeDescription:o,tooltipArrowPosition:e.common.ArrowPosition.arrowTopLeft},this.scope.refreshInformationText=this.services.localizationService.get(l),i.NotSupported}var r=this.services.modelService.findModel(this.model.workbook.modelId,this.model.workbook.packageId);return r?this.getLastRefreshText(r.contract):i.MissingData},t.prototype.getLastRefreshText=function(t){var r,a,n=this;if(t.lastRefreshStatus===e.common.contracts.PublishOrRefreshStatus.RefreshError){r=this.services.localizationService.get("WorkbookAppBar_LastDataRefreshFailed"),a=i.Failure;var s={};s.dataset=o.convertModelToDataset(t),this.scope.showRefreshHistory=function(){return n.services.historyDialogService.showHistoryDialog(s)}}else if(t.lastRefreshStatus===e.common.contracts.PublishOrRefreshStatus.PublishError)a=i.MissingData,r="";else{var c=o.convertRefreshTimeToJsDateTime(t.lastRefreshTime);a=i.Success,r=this.services.localizationService.format("WorkbookAppBar_LastDataRefreshSucceded",[""+c.toLocaleString()])}return this.scope.refreshInformationText=r,a},t})();u.WorkbookAppBarActions={Calculate:"Calculate",EditInExcel:"EditInExcel",EditInExcelOnline:"EditInExcelOnline",Pin:"Pin",Reload:"Reload"},u.Events={PinClicked:r.pinClickedEventName,EditInExcelOnlineClicked:r.editInExcelOnlineClickedEventName,EditInExcelClicked:r.editInExcelClickedEventName,CalculateWorkbookClicked:r.calculateWorkbookClickedEventName,ReloadClicked:r.reloadExcelWorkbookEventName},t.WorkbookAppBarController=u})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.EwaNamedItemType,o=e.dataServices.contracts.TileType,r=e.dataServices.constants,a=(function(){function e(e,t,i){this.workbook=e,this.range=t,this.promiseFactory=i}return e.prototype.getTileData=function(){return this.getTileDataDeferred=this.promiseFactory.defer(),this.verifyIntersections(0),this.getTileDataDeferred.promise},e.prototype.verifyIntersections=function(e){var t=this,o=this.workbook.getNamedItems();if(e>=o.getCount()){var r={elementName:this.range.getAddressA1(),elementRange:this.range.getAddressA1(),smartSelection:!1,sheetName:this.range.getSheet().getName()};return void this.getTileDataDeferred.resolve(r)}var a=o.getItem(e),n=a.getNamedItemType();return n!==i.NamedRange&&n!==i.Table&&n!==i.PivotTable?void this.verifyIntersections(e+1):void a.getRefersToRangeAsync((function(e){return t.verifyNamedItemIntersection(e)}),e)},e.prototype.verifyNamedItemIntersection=function(e){var t=e.getReturnValue(),i=e.getUserContext();if(this.rangesIntersect(this.range,t)){var o={elementName:this.workbook.getNamedItems().getItem(i).getName(),elementRange:t.getAddressA1(),smartSelection:!0,namedItemType:this.workbook.getNamedItems().getItem(i).getNamedItemType(),sheetName:this.workbook.getActiveSheet().getName()};return void this.getTileDataDeferred.resolve(o)}this.verifyIntersections(i+1)},e.prototype.rangesIntersect=function(e,t){return null!=e&&null!=t&&(e.getSheet()===t.getSheet()&&e.getRow()===t.getRow()&&e.getRowCount()===t.getRowCount()&&e.getColumn()===t.getColumn()&&e.getColumnCount()===t.getColumnCount())},e})(),n=(function(){function e(e,t,i){this.workbook=e,this.item=t,this.promiseFactory=i}return e.prototype.getTileData=function(){var e=this,t=this.promiseFactory.defer(),o=this.item.getNamedItemType();if(o===i.NamedRange||o===i.Table||o===i.PivotTable)this.item.getRefersToRangeAsync((function(i){var r=i.getReturnValue(),a={elementName:e.item.getName(),elementRange:r.getAddressA1(),smartSelection:!1,namedItemType:o,sheetName:r.getSheet().getName()};t.resolve(a)}),void 0);else{var r={elementName:this.item.getName(),elementRange:this.workbook.getActiveSheet().getRange(0,0,1,1).getAddressA1(),smartSelection:!1,namedItemType:o,sheetName:this.workbook.getActiveSheet().getName()};t.resolve(r)}return t.promise},e})(),s=(function(){function i(t,o){var r=this;this.scope=t,this.services=o,this.scope.appBarArgs={selection:null},this.resetSelectionArgs(),this.unsubscribeList=[],this.subscribeToAppBarEvents(),this.setWorkbookAppBarIfNeeded(),this.scope.isEmbeddedWorkbookReady=!1,this.scope.embeddedWorkbookFailed=!1,this.scope.isEmbeddedWorkbookDataReady=!1,this.scope.dismissToast=function(){e.models.WorkbookContainer.DiscoverabilityToastDismissed=!0;var t=r.services.telemetryService.startEvent(e.telemetry.DashboardWorkbookPinabilityShown);r.services.tutorialDataStore.setKey(i.WorkbookPinToastShown,!0,t),r.scope.viewModel.showDiscoverabilityToast=!1},this.scope.showPinDashboardDialog=function(){return r.showPinDashboardDialog()};var a;this.services.groupService.groupSwitchPromise().then((function(){r.services.workbookService.ensureWorkbookInitialization().then((function(){r.navigateToWorkbookPage(),a=r.scope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,i,o,a){return r.handleStateChange(t,i,o,a)}))}))})),this.scope.$on("$destroy",(function(){r.unsubscribeToAppBarEvents(),a&&a()}))}return i.createOptions=function(){return{additionalServices:["$rootScope","$window","applicationOptions","contentProviderHttpService","dashboardHttpService","dashboardService","errorService","featureSwitchService","groupService","localizationService","modelConverter","mostRecentlyUsedService","navigation","notificationToast","packageService","permissionService","pinTileService","promiseFactory","telemetryService","tutorialDataStore","workbookService"]}},i.prototype.handleStateChange=function(t,i,o,r){t.name===e.common.constants.navigation.states.workbook&&this.navigateToWorkbookPage()},i.prototype.resetSelectionArgs=function(){this.scope.appBarArgs.selection=void 0},i.prototype.navigateToWorkbookPage=function(){var t,i=this.services.navigation.currentWorkbookURLIdentifier;if(t=this.services.workbookService.findWorkbookByEtagHash(i),t||(t=this.services.workbookService.findWorkbookByUniqueId(i)),!t)return this.services.mostRecentlyUsedService.removeMRU(i),e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog("ArtifactKind_Workbook",this.services.errorService,this.services.localizationService,this.services.telemetryService),void this.services.navigation.navigateToContentListOrActiveDashboard();this.scope.$emit(r.workbook.bindToExcelWorkbookEventName,t),this.services.mostRecentlyUsedService.updateMRU(e.models.MRUArtifactType.Workbooks,t.uniqueId,t.displayName,t.getPermissions());var o=this.services.navigation.currentWorkbookActiveSelection;this.onLoadExcelWorkbook(t,o)},i.prototype.subscribeToAppBarEvents=function(){var i=this,o=this.scope,r=o.$on(t.WorkbookAppBarController.Events.PinClicked,(function(e){return i.pinButtonResponse()}));this.unsubscribeList.push(r);var a=o.$on(t.WorkbookAppBarController.Events.EditInExcelOnlineClicked,(function(e){return i.openWorkbookInExcelOnline()}));this.unsubscribeList.push(a);var n=o.$on(t.WorkbookAppBarController.Events.EditInExcelClicked,(function(e){return i.openWorkbookInExcel()}));this.unsubscribeList.push(n);var s=this.services.rootScope.$on(e.constants.groupSwitchedEventName,(function(){return i.setWorkbookAppBarIfNeeded()}));this.unsubscribeList.push(s);var c=this.services.rootScope.$on(t.WorkbookAppBarController.Events.CalculateWorkbookClicked,(function(){return i.calculateWorkbook()}));this.unsubscribeList.push(c);var l=this.services.rootScope.$on(t.WorkbookAppBarController.Events.ReloadClicked,(function(){return i.onLoadExcelWorkbook(i.scope.viewModel.workbook,null)}));this.unsubscribeList.push(l)},i.prototype.unsubscribeToAppBarEvents=function(){var e=-1,t=this.unsubscribeList.length;if(t){for(e=t;t;)this.unsubscribeList[--t]();this.unsubscribeList.splice(0,e)}},i.prototype.embedWorkbook=function(t,o,r){var a=this,n=this.scope.viewModel.workbook.contract,s=!!n.modelId;this.services.workbookService.embedWorkbook(n.etagHash,this.scope.getEwaTargetWindow(),t.url,t.accessToken,t.accessTokenTtl,this.services.packageService.getWorkbookStorageProvider(n.packageId),this.services.packageService.getWorkbookContentProvider(n.packageId),n.permissions,s,o).then((function(t){a.scope.isEmbeddedWorkbookReady=!0,t.ewaControl&&(e.models.WorkbookContainer.DiscoverabilityToastDismissed=a.services.tutorialDataStore.hasKey(i.WorkbookPinToastShown),a.scope.viewModel.showDiscoverabilityToast=a.scope.workbookAppBarIncluded,a.onEwaApplicationReady(t)),r.resolve()}),(function(){r.reject(),a.scope.viewModel.workbook=null,a.scope.embeddedWorkbookFailed=!0}))},i.prototype.onWopiDataError=function(t,i){var o=this.services.$window,r=this.services.telemetryService,a=this.services.navigation;this.services.errorService.error(this.services.localizationService.get("Workbook_FailToEmbedWorkbookMessage"),"Workbook_FailToEmbedWorkbook",{title:this.services.localizationService.get("Workbook_FailToEmbedWorkbookTitle"),dismissCallback:function(n){"openInXL"===n&&(r.logChildEvent(i,e.telemetry.DashboardWorkbookViewedExternallyDueToAnError,t.contract.etagHash),o.open(t.viewUrl,"_blank")),a.navigateBack()},dialogOptions:[{label:this.services.localizationService.get("Workbook_FailToEmbedWorkbookActionOpenInExcel"),resultValue:"openInXL"},{label:this.services.localizationService.get("PowerViewError_Close"),resultValue:"close"}]})},i.prototype.ensureExpressionApplied=function(e){var t=this,i=this.services.promiseFactory.defer();return this.services.timeout((function(){var o=e();t.services.timeout((function(){i.resolve(o)}),0,!1)})),i.promise},i.prototype.getWopiAccessData=function(e,t){return this.services.workbookService.getWorkbookEmbedAccessData(e.id,e.packageId,t)},i.prototype.loadExcelWorkbook=function(t,i){var o=this,r=this.services.telemetryService,a=r.startEvent(e.telemetry.DashboardViewWorkbook,t.contract.etagHash,t.getPermissions(),this.services.packageService.getWorkbookStorageProvider(t.packageId),this.services.packageService.getWorkbookContentProvider(t.packageId));this.getWopiAccessData(t,a.event).then((function(e){o.ensureExpressionApplied((function(){o.scope.isEmbeddedWorkbookDataReady=!0})).then((function(){o.embedWorkbook(e,i,a)}))}),(function(){o.onWopiDataError(t,a.event),o.scope.viewModel.workbook=null,a.reject()}))},i.prototype.setWorkbookAppBarIfNeeded=function(){this.scope.workbookAppBarIncluded=!this.services.permissionService.isActiveWorkspaceIsReadOnly},i.prototype.calculateWorkbook=function(){this.workbook.recalcAsync()},i.prototype.onLoadExcelWorkbook=function(e,t){var i=this;this.resetSelectionArgs(),this.scope.viewModel.workbook=e,this.scope.viewModel.workbookRangeSelected=!1,this.scope.viewModel.workbookChanged=!1,this.scope.viewModel.workbookLoaded=!1,
this.scope.viewModel.loadedWorkbookOrdinal=e.contract.etagOrdinal,this.workbook=null,this.scope.isEmbeddedWorkbookDataReady=!1,this.scope.isEmbeddedWorkbookReady=!1,this.scope.embeddedWorkbookFailed=!1,this.anyWorkbookChangesOccurred=!1,this.ensureExpressionApplied((function(){})).then((function(){i.loadExcelWorkbook(e,t)}))},i.prototype.openWorkbookInExcel=function(){this.services.$window.open("ms-excel:ofe|u|"+this.scope.viewModel.workbook.contract.sourceFilePath,"_self")},i.prototype.openWorkbookInExcelOnline=function(){this.services.$window.open(this.scope.viewModel.workbook.editUrl,"_blank")},i.prototype.showPinDashboardDialog=function(){var t=this;this.scope.appBarArgs.selection&&this.scope.appBarArgs.selection.getTileData().then((function(i){var a={item:i.elementName,itemType:i.namedItemType,hideGridlines:!1,hideRowAndColumnHeaders:!0,allowTyping:!1,activeSelection:i.elementRange,keepOriginalContentSize:r.workbook.defaultKeepOriginalContentSize,sheetName:i.sheetName.replace(/\'/g,"''")},n={version:e.dataServices.constants.upgrader.TileConfigVersion,workbookTile:a},s={action:e.common.constants.openWorkbookActionName},c=n.workbookTile.item,l=t.scope.viewModel.workbook,d=e.dataServices.ContractUtils.createMasterLayoutConfig({width:e.common.GridLayoutConstants.gridItemMediumLandscapeColSpan,height:e.common.GridLayoutConstants.gridItemMediumLandscapeRowSpan}),p={type:o.workbook,workbookId:t.scope.viewModel.workbook.id,packageId:t.scope.viewModel.workbook.contract.packageId,displayText:t.services.workbookService.getDefaultTileTitle(n.workbookTile,l.contract.displayName),subDisplayText:t.services.workbookService.getDefaultTileSubtitle(c),config:JSON.stringify(n),$config:n,action:JSON.stringify(s),layoutConfig:JSON.stringify(d),$layoutConfig:d};t.services.modelConverter.resolveTilePackage(p,t.services.packageService.packages);var u=t.services.packageService.getWorkbookContentProvider(l.packageId),v=e.common.findContentProviderName(t.services.contentProviderHttpService.getBuiltInContentProviders(),u),h=void 0!==i.namedItemType?i.namedItemType:-1,g=t.services.telemetryService.startEvent(e.telemetry.DashboardPinWorkbookTile,"",e.telemetry.PinTileSource.Workbook,"",!1,v,i.smartSelection,h,t.services.packageService.getWorkbookStorageProvider(l.packageId));t.services.pinTileService.showPinVisualDialog(void 0,void 0,void 0,t.scope.viewModel.workbook.contract,g,p)}))},i.prototype.onEwaApplicationReady=function(e){var t=this;this.resetSelectionArgs();var i=e.ewaControl;this.workbook=i.getActiveWorkbook(),i.add_activeSelectionChanged((function(e){return t.onWorkbookSelectionChange(e)})),i.add_workbookChanged((function(e){return t.onWorkbookChanged(e)})),this.scope.viewModel.workbookLoaded=!0,this.scope.appBarArgs.selection=new a(this.workbook,i.getActiveWorkbook().getActiveSelection(),this.services.promiseFactory)},i.prototype.onWorkbookSelectionChange=function(e){var t=this;if(this.scope.viewModel.workbookRangeSelected=!0,0===e.getSelectionType()){var i=e;this.scope.$applyAsync((function(){return t.scope.appBarArgs.selection=new a(t.workbook,i.getRange(),t.services.promiseFactory)}))}else if(1===e.getSelectionType()){var o=e;this.scope.$applyAsync((function(){return t.scope.appBarArgs.selection=new n(t.workbook,o.getNamedItem(),t.services.promiseFactory)}))}},i.prototype.onWorkbookChanged=function(t){var i=this.scope.viewModel;!this.anyWorkbookChangesOccurred&&i.workbookRangeSelected&&(this.services.telemetryService.logEvent(e.telemetry.DashboardWorkbookEditedInPowerBICausedPinBlock),this.anyWorkbookChangesOccurred=!0),i.workbookChanged||(i.workbookChanged=!0,this.scope.$digest())},i.prototype.pinButtonResponse=function(){if(this.scope.viewModel.workbookChanged)this.services.pinTileService.pinTileScenario=0,this.showPinDashboardDialog();else if(this.scope.viewModel.workbookRangeSelected||this.services.applicationOptions.isE2ERun)this.services.pinTileService.pinTileScenario=2,this.showPinDashboardDialog();else{this.services.pinTileService.pinTileScenario=1;var e=this.services.localizationService.get("PinTile_RangeNotSelected"),t=this.services.localizationService.get("PinTile_RangeNotSelected_Title");this.services.errorService.infoCustom(t,e)}},i})();s.WorkbookPinToastShown="workbookPinToastShown",t.WorkbookContainerController=s})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t){var i=this;this.restrict="A",this.scope={backgroundImage:"@"},this.link=function(t,o,r){o.css({opacity:"0"});var a=!0;t.$watch("backgroundImage",(function(n){if(!_.isEmpty(n)){var s=o.visible()&&"visible"===document.visibilityState&&"false"!==r.backgroundAnimation,c=$("<img/>");c.one("error",(function(){$(i).remove();var o=i.localizationService.get("Tile_ErrorText");t.$emit(e.common.constants.tileErrorEventName,o)})).attr("src",n),s?c.one("load",(function(){var e=o;return a?(a=!1,e.css({"background-image":"url("+n+")"}),void e.velocity({opacity:"1"},1e3)):void e.velocity({opacity:"1"}).velocity("transition.slideLeftBigOut",500,(function(){e.css({"background-image":"url("+n+")"}),e.velocity("transition.slideRightBigIn",500)}))})).attr("src",n):o.css({"background-image":"url("+n+")",opacity:"1"})}}))},this.localizationService=t}return t})();t.BackgroundImage=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/collapsiblePane.html",this.transclude=!0,this.replace=!0,this.scope={viewModel:"=",isExpanderHidden:"="},this.controller=e.common.createController(e.controllers.CollapsiblePaneController)}return t})();t.CollapsiblePane=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t){var i=this;this.restrict="E",this.templateUrl="views/contentProviderDialog.html",this.replace=!0,this.scope={viewModel:"="},this.link=function(t,o,r){var a=o.find("iframe.contentProviderDialogFrame");t.loadContentProviderFrame=function(o){var r=a.parent();a.remove(),a=o,r.append(a);var n=a[0].contentWindow?a[0].contentWindow:a[0].contentDocument?a[0].contentDocument.defaultView:null;n&&(a[0].onload=function(){i.$timeout((function(){return t.$emit(e.constants.configPageLoadedEventName)}),0)})},t.$on(e.common.constants.scopeDestroyEventName,(function(){o.closest(".sliderContentView").find("input.sourceFilterBox").select()}))},this.controller=e.common.createController(e.controllers.ContentProviderController),this.$timeout=t}return t})();t.ContentProvider=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.templateUrl="views/contentProviderLocalFile.html",this.scope={selectedFile:"=",isUpdateFromElementFlow:"=",elementToUpdate:"=?"},this.controller=e.common.createController(e.controllers.ContentProviderLocalFileController)}return t})();t.ContentProviderLocalFile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderChildTile.html",this.replace=!0,this.scope={viewModel:"="}}return e})();e.ContentProviderChildTile=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentProviderConfigurationUIStyle,o=(function(){function t(i,o,r,a,n,s){var c=this;this.restrict="E",this.replace=!0,this.templateUrl="views/contentProviderDialog.html",this.scope={},this.controller=e.common.createController(e.controllers.ContentProviderController),this.link=function(i,o){var r=o.find(".loading"),a=o.find("iframe.contentProviderDialogFrame");c.contentProviderAuthenticationInfoCache={},i.hideLoadingUI=function(){r.hide()},i.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,o,r,a){o.providerName||i.unloadContentProviderFrame(!0)}));var n=c.rootScopeService.$on(e.common.constants.contentProviderStoreConnectEventName,(function(t,n){c.currentContentProviderTile=n,c.windowService.clearInterval(c.authenticationDialogClosingDetectInterval),n.customConfigurationHandler?(c.windowService[e.common.constants.contentProviderStoreCustomConfigurationService]&&(c.windowService[e.common.constants.contentProviderStoreCustomConfigurationService].configData=void 0),i.customConfigurationHandler=n.customConfigurationHandler):n.authenticationInitializationInProgress?n.authenticationInitializationDeferred.promise.then((function(e){c.showLoginDialog(i,n)})):n.authentication&&n.authentication.oAuth?c.showLoginDialog(i,n):c.connect(o,r,a,i,n)}));i.getAuthenticationInfoByContentProviderName=function(e){return c.contentProviderAuthenticationInfoCache[e]},i.unloadContentProviderFrame=function(r){o.hasClass(t.VisibleCSSClassName)&&(i.hideLoadNotification(),o.removeClass(t.VisibleCSSClassName),c.connectedTile=null,a.remove(),i.$emit(e.common.constants.contentProviderStoreConfigurationUIVisibilityChangedEventName,!1),r||c.navigation.showGetDataSlider(c.navigation.categoryName,"",2))},i.loadContentProviderFrame=function(t,n){n?(i.showLoadNotification(),o.addClass("modalDialog")):o.removeClass("modalDialog"),i.$emit(e.common.constants.contentProviderStoreConfigurationUIVisibilityChangedEventName,!0,n),a.remove(),a=t,o.append(a),n&&a.show();var s=a[0].contentWindow?a[0].contentWindow:a[0].contentDocument?a[0].contentDocument.defaultView:null;s&&(a[0].onload=function(){n||r.hide(),a.show()})};var s=c.rootScopeService.$on(e.common.constants.contentProviderStoreAuthorizationCodePostbackEventName,(function(e,t){c.windowService.clearInterval(c.authenticationDialogClosingDetectInterval),c.contentProviderTileWaitingForAuthentication&&c.contentProviderTileWaitingForAuthentication.providerName===c.navigation.providerName&&(c.contentProviderAuthenticationInfoCache[c.currentContentProviderTile.providerName]={endpoint:c.currentContentProviderTile.authentication.oAuth.oAuthEndpoint,authCode:t},c.connect(o,r,a,i,c.currentContentProviderTile))})),l=c.rootScopeService.$on(e.common.constants.contentProviderStoreCustomConfigurationPostbackEventName,(function(e,t){i.customConfigurationHandler=void 0,t?c.connect(o,r,a,i,c.currentContentProviderTile):c.navigation.showGetDataSlider(c.navigation.categoryName,"",2)}));i.$on(e.common.constants.scopeDestroyEventName,(function(){i.hideLoadNotification(),o.closest(".landingController").find("input.ng-pristine").select(),n(),s(),l()}))},this.ngTimeoutService=i,this.windowService=o,this.rootScopeService=r,this.navigation=n,this.localizationService=a,this.contentProviderService=s}return t.prototype.showLoginDialog=function(t,i){var o=this,r=e.common.errorService.control(),a=[new InJs.ModalDialogAction(this.localizationService.get("GetData_OK"),function(e,t){r.hideDialog(),o.navigation.showGetDataSlider(o.navigation.categoryName,"",2)})];if(i.authentication.oAuth.oAuthEndpoint){this.contentProviderTileWaitingForAuthentication=this.currentContentProviderTile;var n=this.windowService;n.$parentScope=t,this.authWindow=e.common.popupWindowService.open(i.authentication.oAuth.oAuthEndpoint,550,530),this.authenticationDialogClosingDetectInterval=this.windowService.setInterval((function(){try{o.authWindow&&!o.authWindow.closed||(o.windowService.clearInterval(o.authenticationDialogClosingDetectInterval),o.contentProviderTileWaitingForAuthentication.providerName===o.navigation.providerName&&o.navigation.showGetDataSlider(o.navigation.categoryName,"",2),o.contentProviderTileWaitingForAuthentication=null)}catch(e){}}),100)}else{var s=this.localizationService.get("GetData_AuthenticationError_Title"),c=this.localizationService.get("GetData_UnableToRetrieveTheAuthenticationEndpoint");r.showCustomDialog(s,InJs.DomFactory.div().text(c),a,void 0,!0)}},t.prototype.connect=function(o,r,a,n,s){if(this.connectedTile!==s)switch(this.connectedTile=s,o.addClass(t.VisibleCSSClassName),r.show(),a.hide(),s.contract.configurationUIstyle){case i.DirectConnect:var c=this.contentProviderService.getDataAccessInfo(s.contract);c&&n.$emit(e.constants.dataSourceAccessInfoGeneratedEventName,c,s.contract,!0);break;case i.FullScreen:n.initConfigurationPage(s.contract);break;case i.ModalDialog:n.initConfigurationPage(s.contract,!0)}},t})();o.VisibleCSSClassName="visible",t.ContentProviderConfiguration=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderEventTile.html",this.replace=!0,this.scope={viewModel:"="},this.link=function(e,t,i){var o=JSON.parse(e.viewModel.contract.providerConfig),r=o.eventName;e.handleClick=function(){r&&e.$root.$emit(r)}}}return e})();e.ContentProviderEventTile=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderLinkTile.html",this.replace=!0,this.scope={viewModel:"="},this.link=function(e,t,i){var o=JSON.parse(e.viewModel.contract.providerConfig);e.href=o.FWLink}}return e})();e.ContentProviderLinkTile=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=".xlsx,.xlsm,.pbix,.csv",o=(function(){function t(t,o,r){var a=this;this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderLocalFileTile.html",this.replace=!0,this.scope={viewModel:"="},this.link=function(t,o,r){t.chooseFile=function(){var o=a.promiseFactory.defer();o.promise.then((function(i){t.$emit(e.common.constants.localFileSelectedEventName,i)})),a.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.GetData)||a.localFileService.chooseLocalFile(o,i)}},this.localFileService=t,this.quota=o,this.promiseFactory=r}return t})();t.ContentProviderLocalFileTile=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderNormalTile.html",this.replace=!0,this.scope={viewModel:"="}}return e})();e.ContentProviderNormalTile=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.controllers.contentProviderStore.ContentProviderSplashState,o=(function(){function t(t,o){var r=this;this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderSplash.html",this.replace=!0,this.controller=e.common.createController(e.controllers.contentProviderStore.ContentProviderSplashController),this.link=function(t,o,a){var n=t.$eval(a.screenState);n?(t.screenState=n,n===i.GroupWelcome&&r.telemetryService.logEvent(e.telemetry.DashboardGetDataSplash,e.telemetry.GetDataSplashState.GroupWelcome)):r.navigation.categoryName===e.constants.navigation.getDataWelcome?(t.screenState=i.Welcome,r.telemetryService.logEvent(e.telemetry.DashboardGetDataSplash,e.telemetry.GetDataSplashState.Welcome)):(t.screenState=i.GetData,r.telemetryService.logEvent(e.telemetry.DashboardGetDataSplash,e.telemetry.GetDataSplashState.GetData))},this.telemetryService=t,this.navigation=o}return t})();t.ContentProviderSplash=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderStore.html",this.scope={activeDashboard:"=activeDashboard"},this.replace=!0,this.controller=e.common.createController(e.controllers.contentProviderStore.ContentProviderStoreController)}return t})();t.ContentProviderStore=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderTileBody.html",this.replace=!0}return e})();e.ContentProviderTileBody=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentProviderConfigurationUIStyle,o=e.controllers.contentProviderStore.contentProviderConstants,r=e.common.utils.DateFormatter,a=(function(){function t(t,a,n,s,c,l,d,p,u,v,h){var g=this;this.contentProviderService=u,this.rtl=v,this.windowMetrics=h,this.restrict="E",this.templateUrl="views/contentProviderStore/contentProviderTileBrowser.html",this.replace=!0,this.scope={tiles:"=",selectedContentProviderTile:"=",navigateToCategory:"=",hasContentProviderLoaded:"=",isSplashState:"="},this.link=function(t,a,n){var s,c,l,d=0,p=0,u=[],v=a.find(".detailPane"),h=v.find(".accordion"),m=v.find(".detailPaneArrow"),f="resize.contentProvider";t.contentProviderLoadingMessage=e.common.localize.get("Contentprovider_Loading_Message"),t.selectedChildContentProvider=null,t.getPublishMetaData=function(e){return g.localizationService.format("GetData_PublishedBy",[e])},t.getLocalizedValue=function(e){return g.localizationService.get(e)},t.getPrettyDate=function(e){return r.getPrettyRelativeDate(e,g.localizationService)},t.tilesByProviderName=_.indexBy(t.tiles,"providerName"),t.clearSelection=function(){t.selectedContentProviderTile=null},t.navigateToTile=function(i,r){var a=t.tiles[i],n=o.categoryEnumToNameMap[a.clientCategory],s=a.providerName;if(g.telemetryService.logEvent(e.telemetry.DashboardGetDataProviderSelect,n,s),a.contract.disabledInArchivedContent===!0&&g.viralTenantMergeHelperService.viewingDataFromMergedViralTenant())return void g.viralTenantMergeHelperService.displayFeatureDisabledErrorMessage("ArchivedContent_ErrorMessageOneDrivePro");if(r){var c=0;g.navigation.providerName&&(c=2),g.navigation.showGetDataSlider(n,s,c)}},t.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,i,o,r,n){t.updateSelectedContentProviderTile(),n.categoryName===o.categoryName||o.providerName||a.scrollTop(0)})),t.updateSelectedContentProviderTile=function(){var e=g.navigation.providerName,i=_.find(t.tiles,(function(t){return t.providerName===e}));i?t.selectTile(i):(t.hideDetailPane(),t.clearSelection())},t.selectChildTile=function(e){t.selectedChildContentProvider=e},t.selectTile=function(e){var o=_.findIndex(t.tiles,e),r=s[o],n=angular.element(r),l=e.contract.configurationUIstyle<=i.DirectConnect;if(t.selectedContentProviderTile=e,e.disableDetailPane)g.connectToContentProvider(t,!1);else if(l&&n){var p=n.find(".tileContent"),f=u.indexOf(r),y=(Math.floor(f/d)+1)*d-1;y>=u.length&&(y=u.length-1);var b=v.height(),S=!1;if(y===c&&v.hasClass("visible")||(v.removeClass("visible").detach(),v.insertAfter(u[y]),v.offset(),v.addClass("visible"),S=!0),g.openDetailPane(t,a,n,e,p,v,h,b,S),n.length>0){var w=n.offset().left,C=v.offset().left,D=n.width(),I=(D-m.outerWidth())/2;if(g.rtl&&g.rtl.isRtlLayout){var T=g.windowMetrics.windowWidth;w=w+D-T,C=C+v.width()-T,I*=-1}var M=w-C+I;m.css("transform","translateX("+M+"px)")}c=y}},t.closeDetailPane=function(){g.navigation.showGetDataSlider(g.navigation.categoryName,"",2),t.hideDetailPane()},t.hideDetailPane=function(){var e=a.find(".detailPane");e.hasClass("visible")&&(e.removeClass("visible"),e.detach())},t.childConnect=function(){g.childConnect(t,!0)},t.connect=function(){g.connectToContentProvider(t,!0)};var y=t.$root.$on(e.common.constants.contentProviderStoreTileListRefreshEventName,(function(e,i,o){t.currentCategory=i,l=o?new RegExp("\\b"+o,"i"):null,t.hideDetailPane(),l?(t.tiles=_.sortBy(t.tiles,(function(e){return e.title.toLowerCase()})),t.clearSelection()):t.tiles=_.sortBy(t.tiles,(function(e){return[e.sortPriority,e.title.toLowerCase()]})),g.timeoutService((function(){S(),l||t.updateSelectedContentProviderTile()}))}));t.$on(e.common.constants.scopeDestroyEventName,(function(){angular.element(g.windowService).off(f)})),angular.element(g.windowService).on(f,(function(){S()}));var b=function(e){var o=!1;return l?(o=null!==e.title.match(l),!o&&e.searchKeywords&&(o=null!==e.searchKeywords.match(l)),!o||e.contract.configurationUIstyle!==i.FWLink&&e.contract.configurationUIstyle!==i.Event||(o=!1)):o=e.clientCategory===t.currentCategory,o&&(g.updateTileAuthorization(e),g.updateChildAuthorization(e)),o},S=function(){s=a.find(".tile"),u=[],t.visibleTiles=[];var e=!1;if(s.length>0){for(var i=0,o=s.length;i<o;i++){var r=t.tiles[i],n=angular.element(s[i]);b(r)?(r.visible=!0,n.addClass("visible"),t.visibleTiles.push(r),u.push(s[i]),e=!0):(r.visible=!1,n.removeClass("visible"))}var c=angular.element(s[0]);if(d=Math.floor(a.width()/c.outerWidth(!0)),d>0){var h=c.outerWidth(!0)*d-parseInt(c.css("margin-right"),0);v.css("width",h)}p!==d&&t.selectedContentProviderTile&&v.hasClass("visible")&&t.selectTile(t.selectedContentProviderTile),p=d}t.showNoSearchResultText=!e&&null!==l};t.$on(e.common.constants.scopeDestroyEventName,(function(){y()}))},this.timeoutService=t,this.windowService=a,this.navigation=n,this.telemetryService=s,this.localizationService=c,this.viralTenantMergeHelperService=l,this.userInfoService=d,this.quota=p}return t.prototype.handleAutoRedirect=function(t,i){if(i.autoRedirectUrlParams){for(var o=i.autoRedirectUrlParams.split("&"),r=jsCommon.QueryStringUtil.parseQueryString(),a=!1,n=0,s=o;n<s.length;n++){var c=s[n];if(r[c]){a=!0;break}}a&&t.connect()}else this.navigation.stateService.params[e.common.constants.navigation.getDataForceConnect]&&t.connect()},t.prototype.openDetailPane=function(e,i,o,r,a,n,s,c,l){var d=this;this.timeoutService((function(){var a=n.find(".accordion"),s=a.height()+106;(c!==s||l)&&n.animate({height:s},250,(function(){o.length>0&&i.animate({scrollTop:o.position().top+o.height()+n.height()-i.height()-t.detailPaneScrollingOffset},250),d.handleAutoRedirect(e,r)}))}))},t.prototype.updateChildAuthorization=function(e){if(this.tileHasChildItems(e))for(var t=0,i=e.tileGrouping.groupingChildItems;t<i.length;t++){var o=i[t];this.updateTileAuthorization(o)}},t.prototype.updateTileAuthorization=function(t){if(t.authentication&&t.authentication.oAuth&&t.authenticationInitializationInProgress&&!t.authentication.oAuth.oAuthEndpoint){var i=e.common.httpService.powerbiRequestOptions();i.telemetryDescription="GetAuthorization: "+t.contract.providerName,e.common.httpService.get(t.authentication.oAuth.endpointRetrievalAPI,i).then((function(e){t.authenticationInitializationInProgress=!1,t.authentication.oAuth.oAuthEndpoint=e.data,t.authenticationInitializationDeferred.resolve(e.data)}),(function(e){t.authenticationInitializationInProgress=!1,t.authenticationInitializationDeferred.resolve("")}))}else t.authenticationInitializationInProgress=!1},t.prototype.tileHasChildItems=function(e){return e.tileGrouping&&e.tileGrouping.groupingChildItems&&e.tileGrouping.groupingChildItems.length>0},t.prototype.childConnect=function(e,t){e.selectedContentProviderTile=e.selectedChildContentProvider,this.connectToContentProvider(e,!0)},t.prototype.connectToContentProvider=function(t,i){var r=this;this.localizationService.ensureLocalization((function(){var a=!1,n=!1,s=o.categoryEnumToNameMap[t.selectedContentProviderTile.clientCategory],c=t.selectedContentProviderTile.providerName,l=t.selectedContentProviderTile;if(l.usePBIDesktop)return t.closeDetailPane(),r.windowService.open(e.constants.downloadPBIDesktopLink,e.constants.targetValueBlank),void r.telemetryService.logEvent(e.telemetry.DashboardGetDataProviderAccordionConnect,s,c,a,n);if(r.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.GetData)&&(n=!0),!n){var d=l.contract;r.contentProviderService.upgradeRequiredToConnect(d)?(a=!0,r.contentProviderService.displayFeatureDisabledDialog(d)):(t.$root.$emit(e.common.constants.contentProviderStoreConnectEventName,t.selectedContentProviderTile),i&&t.hideDetailPane())}r.telemetryService.logEvent(e.telemetry.DashboardGetDataProviderAccordionConnect,s,c,a,n)}))},t})();a.detailPaneScrollingOffset=39,t.ContentProviderTileBrowser=a})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/contentProviderStore/customConfigHandlers/sharePointUrlModal.html"}return e})();e.SharePointUrlModal=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(e){e[e.left=0]="left",e[e.right=1]="right"})(i||(i={}));var o=(function(){function t(){this.controller=e.common.createController(r),this.restrict="A",this.scope={context:"=",arrowDirection:"=?",showContextMenu:"=?"}}return t})();t.ContextMenu=o;var r=(function(){function e(t,o){var r=this;this.scope=t,this.services=o,this.element=this.services.$element,this.rtl=this.services.rtl,this.windowMetrics=this.services.windowMetrics,this.rtl&&this.rtl.isRtlLayout&&(t.arrowDirection=e.rightArrowDirection),this.arrowDirection=t.arrowDirection?i[t.arrowDirection]:i.left,this.scope.contextMenuStyle=e.contextMenuInactiveStyle,this.scope.close=function(){return r.hideDialog()},t.$on("$destroy",(function(){return r.dispose()})),$(window).on("resize",(function(){return r.blurAnchor()})),$(window).on(jsCommon.DOMConstants.keyDownEventName,(function(e){return r.keyDownHideDialog(e)})),$(window).on(jsCommon.DOMConstants.mouseDownEventName,(function(e){return r.mouseDownHideDialog(e)})),angular.isUndefined(t.showContextMenu)?this.element.bind(jsCommon.DOMConstants.mouseClickEventName,(function(e){return r.showDialog(e)})):this.scope.$watch((function(){return r.scope.showContextMenu}),(function(t,i){t&&!i&&r.scope.contextMenuStyle===e.contextMenuInactiveStyle?r.showDialog():!t&&i&&r.scope.contextMenuStyle===e.contextMenuActiveStyle&&r.hideDialog()}))}return e.createOptions=function(){return{additionalServices:["$element","$templateCache","rtl","windowMetrics"]}},e.prototype.clickOutsideContextMenu=function(t){var i=t.pageX,o=t.pageY;if(this.contextMenuElement&&this.scope.contextMenuStyle===e.contextMenuActiveStyle){var r=this.contextMenuElement.offset(),a=r.left,n=r.top,s=a+this.contextMenuElement.width(),c=n+this.contextMenuElement.height();return a>i||i>s||n>o||o>c}return!1},e.prototype.blurAnchor=function(){this.element.is(":focus")&&this.element.blur()},e.prototype.dispose=function(){this.contextMenuElement&&this.contextMenuElement.remove(),$(window).off("resize",this.blurAnchor),$(window).off(jsCommon.DOMConstants.keyDownEventName,this.keyDownHideDialog),$(window).off(jsCommon.DOMConstants.mouseDownEventName,this.mouseDownHideDialog)},e.prototype.showDialog=function(t){var o=this;t&&(t.preventDefault(),t.stopPropagation()),this.contextMenuElement||(this.template=angular.element(this.services.$templateCache.get("views/contextMenu.html")),this.contextMenuElement=this.services.compile(this.template)(this.scope),this.arrowElement=this.contextMenuElement.find(e.arrowSelector),$("body").append(this.contextMenuElement));var r=this.element.offset();this.services.timeout((function(){switch(o.arrowDirection){case i.left:r.left+=o.element.width()+e.arrowWidth+e.positionOffset.left,r.top-=o.contextMenuElement.height()/2-o.element.height()/2-e.positionOffset.top;break;case i.right:var t=o.contextMenuElement.width();if(r.left-=t+e.arrowWidth+e.positionOffset.left,r.top-=o.contextMenuElement.height()/2-o.element.height()/2-e.positionOffset.top,o.rtl&&o.rtl.isRtlLayout){var a=o.windowMetrics.windowWidth-(r.left+t);r.left=null,o.contextMenuElement.css("right",a)}}r.top=o.adjustPositionTop(r),o.contextMenuElement.css(r),o.scope.contextMenuStyle=e.contextMenuActiveStyle,o.scope.showContextMenu=!0}))},e.prototype.adjustPositionTop=function(t){var i=0,o=i+$(document).height()-this.contextMenuElement.height();return t.top<i?(this.arrowElement.css({top:t.top+this.contextMenuElement.height()/2-i+e.arrowPositionOffset.top}),i):t.top>o?(this.arrowElement.css({top:t.top+this.contextMenuElement.height()/2-o+e.arrowPositionOffset.top}),o):(this.arrowElement.removeAttr("style"),t.top)},e.prototype.hideDialog=function(){this.contextMenuElement&&(this.scope.contextMenuStyle=e.contextMenuInactiveStyle,this.scope.showContextMenu=!1)},e.prototype.mouseDownHideDialog=function(e){var t=this;this.clickOutsideContextMenu(e)&&this.scope.$apply((function(){t.hideDialog()}))},e.prototype.keyDownHideDialog=function(t){var i=this;this.scope.contextMenuStyle===e.contextMenuActiveStyle&&27===t.keyCode&&this.scope.$apply((function(){i.hideDialog()}))},e})();r.arrowPositionOffset={left:0,top:-10},r.arrowWidth=17,r.positionOffset={left:-22,top:0},r.contextMenuActiveStyle="active",r.contextMenuInactiveStyle="inactive",r.arrowSelector=".wrapper .arrow",r.rightArrowDirection="right"})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i="custom",o=(function(){function t(t){var o=this;this.$timeout=t,this.require=["ngModel","?^customValidatorSynchronizer"],this.restrict="A",this.link=function(t,r,a,n){function s(e){d.$setValidity(i,u.validate(e)),p&&p.synchronizeValidation()}var c,l,d=n[0],p=n[1],u=t.$eval(a.customValidator);p&&(l=p.registerValidator((function(){d.$error[i]&&d.$setValidity(i,u.validate(d.$viewValue))}))),t.$watch(a.ngModel,(function(e,t){(e||t)&&(c?o.$timeout.cancel(c):d.$setValidity(i,!0),u.delay>0?c=o.$timeout((function(){c=null,s(e)}),u.delay):s(e))})),t.$on(e.common.constants.scopeDestroyEventName,(function(){l&&l(),c&&o.$timeout.cancel(c)}))}}return t})();t.CustomValidator=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.controller=e.common.createController(e.controllers.CustomValidatorSynchronizerController),this.restrict="A"}return t})();t.CustomValidatorSynchronizer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.AppUtils,o=e.common.models,r=e.helpers.DashboardTelemetryHelper,a=e.services.FullScreenFitStyle,n=(function(){function t(n,s,c,l,d,p,u){var v=this;this.telemetryService=n,this.gridLayout=s,this.userActivityContextService=c,this.appService=l,this.packageService=d,this.timeout=p,this.groupService=u,this.restrict="E",this.templateUrl="views/dashboard.html",this.replace=!0,this.scope={viewModel:"=",displayLayout:"<",mobileLayout:"<?",inEditMobileLayoutMode:"<?",isGroupTransitionDelayed:"<",enableStrategySwap:"<?"},this.controller=e.common.createController(e.controllers.DashboardController),this.link=function(n,s,c){function l(){var e=s.find(".dashboardTile.selected");if(e.length>0){var t=s.offset(),i=e.offset();s.animate({scrollTop:i.top-t.top+s.scrollTop(),scrollLeft:i.left-t.left+s.scrollLeft()})}}var d=-1,p=!1,u=!0;v.telemetryHelper=new r(v.telemetryService,v.userActivityContextService,v.timeout,n),n.disablePointerEvents="true"===c.disablePointerEvents,n.scaleDashboard=function(e){var i=n.gridLayoutContainer.containerWidth+t.TileContainerPixelPadding,o=n.gridLayoutContainer.containerHeight,r=s.parent().width(),a=s.parent().height(),c=t.calculateDashboardScaleFactor(i,o,r,a,e);if(!(c<=0)){var l={transform:"scale("+c+")",width:i+"px",height:e?a/c+"px":o+"px"};s.css(l).addClass(t.DashboardFitToScreenCSSClass)}},n.$watch("fullScreen.fitStyle",(function(e){switch(e){case a.FitToContent:n.scaleDashboard();break;case a.FitToWidth:n.scaleDashboard(!0);break;case a.None:s.removeAttr("style").removeClass(t.DashboardFitToScreenCSSClass)}})),n.$watch("viewModel",(function(e,r){if(e&&r&&e.id!==r.id){e.gridLayoutService=r.gridLayoutService,e.gridLayoutService.strategy=new o.DefaultGridLayoutStrategy,e.gridLayoutService.displayLayout=0;var a=e.tiles;if(a)for(var c=0,l=a;c<l.length;c++){var h=l[c];h.gridLayoutContext&&h.gridLayoutContext.setActiveLayout(0),h.invalidateLayout()}}if(e){var g=null;v.appService&&e.contract&&(g=i.getDashboardAppGUID(e,v.appService,v.packageService)),v.telemetryHelper.recordOpenDashboardEvent(e,g,v.groupService.activeGroupObjectId),v.gridLayout&&(e.gridLayoutService=v.gridLayout);var m=n.displayLayout||0;e.currentDisplayLayout=m}p=!0,window.clearTimeout(d),s.scrollTop(0).scrollLeft(0).addClass(t.TransitioningCSSClass),
u||s.css("opacity","0")})),n.$watch("viewModel.isLoaded",(function(t,i){var o=v.doesModelContainsTilesByLayout(n.viewModel,n.displayLayout);t&&!i&&o&&n.$emit(e.constants.dashboardTileRepeatFinishedEvent)})),n.onDestroy=function(){v.telemetryHelper.forceResolve()},n.$on(e.constants.dashboardTileRepeatFinishedEvent,(function(){n.fullScreen.fitStyle===a.FitToContent&&n.scaleDashboard(),l(),p&&(u||s.velocity(t.DashboardVelocityUITransitionType,t.DashboardTransitionDurationMs),d=window.setTimeout((function(){s.removeClass(t.TransitioningCSSClass)}),2e3),p=!1,n.$emit(e.common.constants.domLayoutChangedEvent))}))}}return t.calculateDashboardScaleFactor=function(e,t,i,o,r){var a=i/e;if(r)return a;var n=o/t;return a<n?a:n},t.prototype.doesModelContainsTilesByLayout=function(e,t){return e&&(!e.tiles||void 0===t||0===_.filter(e.tiles,(function(e){return e.hasLayoutPosition(t)})).length)},t})();n.TransitioningCSSClass="transitioning",n.DashboardTransitionDurationMs=150,n.DashboardVelocityUITransitionType="transition.fadeIn",n.TileContainerPixelPadding=40,n.DashboardFitToScreenCSSClass="fitToScreen",t.Dashboard=n})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.constants,o=(function(){function t(){this.restrict="E",this.templateUrl="views/dashboardContainer.html",this.replace=!0,this.scope={viewModel:"=",collapsiblePaneMode:"=",isActive:"="},this.controller=e.common.createController(e.controllers.DashboardContainerController),this.link=function(e,t,o){var r=e.rootScope.$on(i.inFocusEnterEvent,(function(){t.hide()})),a=e.rootScope.$on(i.inFocusExitEvent,(function(){t.show()})),n=e.$on("$destroy",(function(){r(),a(),n()}))}}return t})();t.DashboardContainer=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.controller=e.common.createController(e.controllers.DevToolsViewController),this.templateUrl="views/devToolsView.html"}return t})();t.DevToolsView=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/excelUploadFormat.html",this.replace=!0,this.controller=e.common.createController(e.controllers.ExcelUploadFormatController)}return t})();t.ExcelUploadFormat=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.scope={viewModel:"=",canvasOptions:"<",explorationContainerOptions:"<"},this.controller=e.common.createController(e.controllers.ExplorationContainerController),this.templateUrl="views/explorationContainer.html"}return t})();t.ExplorationContainer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=jsCommon.DOMConstants,i=(function(){function e(e){var i=this;this.restrict="A",this.scope={flyoutToggle:"="},this.link=function(e,o,r){function a(t){var i=$(t.target).parents().addBack().is(o);i||(e.flyoutToggle=!1,e.$applyAsync())}e.$watch("flyoutToggle",(function(e,o){e!==o&&e===!0?i.$window.on(t.mouseDownEventName,a):e!==o&&e===!1&&i.$window.off(t.mouseDownEventName,a)}))},this.$window=$(e)}return e})();e.FlyoutToggle=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.templateUrl="views/historyDialogView.html",this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.HistoryDialogController)}return t})();t.HistoryDialog=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=300,o=20,r=(function(){function t(t){var r=this;this.promiseFactory=t,this.restrict="A",this.templateUrl="views/inFocus.html",this.scope={canEdit:"="},this.controller=e.common.createController(e.controllers.InFocusController),this.link=function(e,t){e.performTransitionAnimation=function(e){var t=$.Deferred();0===$(".inFocusTransition.begin").length&&$('<div class="inFocusTransition begin"></div>').insertAfter($("[in-focus]"));var i=$(".dashboardTile[data-id="+e+"]");if(0===i.length)return t.resolve(),t;var o=i.offset(),r=o.top,a=o.left,n=i.width(),s=i.height();return $(".inFocusTransition.begin").velocity({opacity:1,top:0,left:0,width:"100%",height:"100%"},{duration:250,begin:function(){$(".begin").css({top:r,left:a,width:n,height:s})},complete:function(){t.resolve()}}),t},e.clearTransitionAnimation=function(){var e=r.promiseFactory.defer();return $(".inFocusTransition.begin").velocity({opacity:0},{duration:350,complete:function(){$(".inFocusTransition.begin").css({width:0,height:0}),e.resolve(null)}}),e.promise};var a=function(t){var i=e.viewModel.inFocusTile,r=i&&i.realTime;if(r){var a=e.onResizeViewport||t;if(a){var n=a.width-2*o,s=a.height-2*o;if(!(n<=0||s<=0)){var c={width:n,height:s};i.calculateLayout(c),i.applyLayout()}}}},n=_.throttle(a,i);e.handleResize=function(e,t){n({width:e,height:t})}}}return t})();t.InFocus=r})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/insights/insights.html",this.scope={activeDashboard:"=activeDashboard"},this.replace=!0,this.controller=e.common.createController(e.controllers.insights.InsightsController)}return t})();t.Insights=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.transclude=!0,this.controller=e.common.createController(e.controllers.LandingContainer),this.templateUrl="views/landingContainer.html",this.controllerAs="$ctrl"}return t})();t.LandingContainer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=".xlsx,.xlsm,.pbix,.csv",o=(function(){function t(t,o,r,a){var n=this;this.localizationService=t,this.errorService=o,this.applicationOptions=r,this.timeoutService=a,this.restrict="E",this.templateUrl="views/localFileBrowser.html",this.replace=!0,this.link=function(t,o,r){t.fileDialogFilter=i,n.input=o.find(".browseFileInput"),n.input.val(""),n.input.focus(),n.input.bind("change",(function(){return n.onFileSelected(t)})),n.input.bind("click",(function(e){e.stopPropagation()})),t.$on(e.common.constants.chooseLocalFileEventName,(function(e,i){t.fileDialogFilter=i,n.timeoutService((function(){return n.selectFile(t)}))}))}}return t.prototype.onFileSelected=function(t){var i,o=this.input[0];o.files&&(i=o.files[0]),t.$emit(e.common.constants.localFileSelectedEventName,i)},t.prototype.selectFile=function(e){this.input.val("");try{this.applicationOptions.isE2ERun||this.input.click()}catch(e){var t=this.errorService.control();t.showCustomDialog(this.localizationService.get("GetData_FileCannotBeUploadedTitle"),angular.element("<div/>").text(this.localizationService.get("GetData_FileCannotBeUploadedText")),[new InJs.ModalDialogAction(this.localizationService.get("GetData_OK"),function(e,i){t.hideDialog()})],(function(e){e.parent().find('input[type="button"]').focus()}),!0)}},t})();t.LocalFileBrowser=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/manageStorageView.html",this.scope={viewModel:"=",dashboardContainer:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.ManageStorageView)}return t})();t.ManageStorageView=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/navigationBar.html",this.transclude=!0,this.replace=!0,this.scope={currentDashboard:"=",currentReport:"=",currentWorkbook:"="},this.controller=e.common.createController(e.controllers.NavigationBarController)}return t})();t.NavigationBar=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/navigationPane.html",this.replace=!0,this.controllerAs="$ctrl",this.scope={viewModel:"=",currentReport:"=",currentWorkbook:"="},this.link=function(t,i,o){var r=i.find(".searchBox input"),a=function(e,t){if(e&&e.length>0&&!e.visible()){var o=i.find(".scrollRegion"),r=o.scrollTop();o.scrollTop(r+t)}};i.find(".searchBox i.glyphicon").click((function(){t.isPaneExpanded=!0,t.$digest(),window.setTimeout((function(){r.focus()}),250)})),i.find(".scrollRegion").on(jsCommon.DOMConstants.scrollEventName,(function(o){var r=i.find("li.active");r.length>0&&t.$broadcast(e.constants.navPaneScrollEventName,r)})),t.$root.$on(e.constants.scrollNavPaneToActiveDashboardEventName,(function(e,t){setTimeout((function(){var e=i.find(".dashboardList li.selected");a(e,e.offset().top-$(window).height()/2)}),0)})),t.$on(e.constants.scrollToNavPaneListItemEventName,(function(e,t){var o=0,r=i.find(".scrollRegion"),n=r.offset(),s=t.offset(),c=t.outerHeight();s.top<n.top?o=s.top-n.top:s.top+c>n.top+r.height()&&(o=s.top+c-n.top-r.height()),a(t,o)})),t.updateWindowIfNeeded=function(){window.setTimeout((function(){$(window).trigger("resize")}),50)}},this.controller=e.common.createController(e.controllers.NavigationPaneController)}return t})();t.NavigationPane=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(){this.restrict="E",this.templateUrl="views/navigationPaneListItem.html",this.replace=!0,this.scope={newStyle:"<",viewModel:"=",selected:"=?"},this.link=function(e,i,o){t.NavigationPaneListItem.link(e,i,o)},this.controller=e.common.createController(e.controllers.DashboardNavigationPaneListItemController)}return i})();t.DashboardNavigationPaneListItem=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(){this.restrict="E",this.templateUrl="views/navigationPaneListItem.html",this.replace=!0,this.scope={newStyle:"<",viewModel:"=",selected:"=?"},this.link=function(e,i,o){t.NavigationPaneListItem.link(e,i,o)},this.controller=e.common.createController(e.controllers.DatasetNavigationPaneListItemController)}return i})();t.DatasetNavigationPaneListItem=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(){this.restrict="E",this.templateUrl="views/groupNavigationPaneListItem.html",this.replace=!0,this.scope={viewModel:"=",selected:"=?"},this.link=function(e,i,o){t.NavigationPaneListItem.link(e,i,o)},this.controller=e.common.createController(e.controllers.GroupNavigationPaneListItemController)}return i})();t.GroupNavigationPaneListItem=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){}return t.link=function(t,i,o){t.showContextMenuIfEnabled=function(){t.$emit(e.constants.scrollToNavPaneListItemEventName,i),t.showContextMenu=t.isContextMenuEnabled()},t.$on(e.constants.navPaneScrollEventName,(function(e,o){t.showContextMenu&&o.length>0&&o[0]===i[0]&&t.$apply((function(){t.showContextMenu=!1}))}))},t})();t.NavigationPaneListItem=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(){this.restrict="E",this.templateUrl="views/navigationPaneListItem.html",this.replace=!0,this.scope={newStyle:"<",viewModel:"=",selected:"=?"},this.link=function(e,i,o){t.NavigationPaneListItem.link(e,i,o)},this.controller=e.common.createController(e.controllers.ReportNavigationPaneListItemController)}return i})();t.ReportNavigationPaneListItem=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(){this.restrict="E",this.templateUrl="views/navigationPaneListItem.html",this.replace=!0,this.scope={newStyle:"<",viewModel:"=",selected:"=?"},this.link=function(e,i,o){t.NavigationPaneListItem.link(e,i,o)},this.controller=e.common.createController(e.controllers.WorkbookNavigationPaneListItemController)}return i})();t.WorkbookNavigationPaneListItem=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/npsHost.html",this.replace=!0,this.scope={},this.link=function(e,t,i){var o='<iframe name="npsFrame" id="npsFrame" sandbox="allow-same-origin allow-scripts allow-popups allow-forms" src="{{npsUrl}}"></iframe>',r=function(){var e=t.find("iframe#npsFrame");e&&e.remove()};e.closeNpsHostIframe=function(){t.removeClass("npsActive"),r()},e.resizeNpsHostIframe=function(){$("#npsFrame").addClass("short")},e.connectToNps=function(){e.initListener(),r();var i=$(o.replace("{{npsUrl}}",e.renderUrl));t.append(i),$("#npsFrame").load((function(){t.addClass("npsActive")}))}},this.controller=e.common.createController(e.controllers.NpsHostController)}return t})();t.NpsHost=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.restrict="E",this.templateUrl="views/loadNotificationDialog.html",this.replace=!0,this.scope={message:"="},this.scope=e}return e})();e.LoadNotificationDialog=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/o365ApplicationLauncher.html",this.replace=!0,this.scope={},this.link=function(e,t,i){var o=t.find(".o365AppLauncherContainer"),r=!1;t.mousedown((function(){r=!0})),t.bind("click",(function(t){e.showAppLauncherContainer?(o.removeClass("fadein"),o.addClass("fadeout")):(e.getApplicationLauncher(),o.removeClass("fadeout"),o.addClass("fadein"),o.focus()),e.showAppLauncherContainer=!e.showAppLauncherContainer,r=!1})),o.on("blur",(function(t){r?r=!1:(o.removeClass("fadein"),o.addClass("fadeout"),e.showAppLauncherContainer=!1)}))},this.controller=e.common.createController(e.controllers.O365ApplicationLauncherController)}return t})();t.O365ApplicationLauncher=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="A",this.scope={onLoad:"&",onError:"&?"},this.link=function(t,i){i.on("load",(function(){t.$applyAsync((function(){t.onLoad()}))})),t.onError&&i.on("error",(function(){t.$applyAsync((function(){t.onError()}))})),t.$on(e.common.constants.scopeDestroyEventName,(function(){i.off()}))}}return t})();t.OnLoad=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t){var i=this;this.restrict="E",this.templateUrl="views/pinTileDialog.html",this.replace=!0,this.controller=e.common.createController(e.controllers.PinTileDialogController),this.link=function(e,t,o){i.$timeout((function(){t.find('input[type="text"]').focus(),$(".inputReportTitle").keypress((function(e){if(13===e.keyCode){var t=$(".saveAndContinueBtn");t.prop("disabled")||t.click()}})),$(".inputDashboardTitle").keypress((function(e){if(13===e.keyCode){var t=$(".pinTile");t.prop("disabled")||t.click()}})),$(".newDashRadio").click((function(e){$(".inputDashboardTitle").focus()}))}),500),i.$timeout((function(){var e=t.find(".tilePreviewFrame .dashboardTile");e.length>0&&e.fadeIn(300)}))},this.$timeout=t}return t})();t.PinTileDialog=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=jsCommon.BrowserUtils,o=e.common.constants,r="@media print {{0}{ {1} }}",a="explore-canvas-printer",n="dashboard-printer",s=(function(){function t(e,t,i,r){var s=this;this.restrict="A",this.link=function(e,t,i){if(i.disablePrint===(!0).toString())return t.removeAttr(a),void t.removeAttr(n);var r=s.rootScope,c=r.$on(o.enterPrintModeEvent,(function(i){i.stopPropagation(),s.insertPrintStylingInDOM(e,t)})),l=r.$on(o.exitPrintModeEvent,(function(e){e.stopPropagation(),s.removePrintStylingFromDOM(t)})),d=e.$on("$destroy",(function(){c(),l(),s.removePrintStylingFromDOM(t),d()}))},this.rootScope=e,this.compileService=t,this.featureSwitchService=i,this.localizationService=r}return t.getPrintTargetViewPort=function(t){var o={width:e.constants.defaultPortraitPrintWidth,height:e.constants.defaultPortraitPrintHeight},r=t.width(),a=t.height();if(r>a&&(o.width=e.constants.defaultLandscapePrintWidth,o.height=e.constants.defaultLandscapePrintHeight),i.isChrome()){var n=t.parent();o.width=n.width(),o.height=n.height()}return o},t.calculateScaleFactor=function(e,t,i){var o=t.width/e.width,r=t.height/e.height;return i?Math.max(o,r):Math.min(o,r)},t.prototype.calculateStyle=function(e,t){return null},t.prototype.getStyleString=function(e){for(var t=Object.keys(e),i="",o=0,r=t.length;o<r;o++){var a=t[o];i=i+a+":"+e[a]+"; "}return i},t.prototype.insertPrintStylingInDOM=function(e,t){var i=this;if(null!=this.printContainerSelector){if(this.featureSwitchService.featureSwitches.printingEnabled===!1)return this.printMediaQueryElement||this.localizationService.ensureLocalization((function(){var e=i.localizationService.get("PrintingIsDisabledForThisTenantMessage"),t=$("<div>").addClass("errorTitle").text(e),o=$("<div>").attr("id","printDisabledOverlay").append(t);i.printMediaQueryElement=o,$("body").append(i.printMediaQueryElement)})),void t.hide();this.printMediaQueryElement||(this.printMediaQueryElement=$("<style></style>").attr("type","text/css"),$("body").append(this.printMediaQueryElement));var o=this.calculateStyle(t,e),a=this.getStyleString(o),n=jsCommon.StringExtensions.format(r,this.printContainerSelector,a);this.printMediaQueryElement.html(n)}},t.prototype.removePrintStylingFromDOM=function(e){this.printMediaQueryElement&&(this.printMediaQueryElement.remove(),this.printMediaQueryElement=void 0),this.featureSwitchService.featureSwitches.printingEnabled===!1&&e.show()},t})();t.BasePrinter=s})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=40,i=(function(i){function o(){var e=null!==i&&i.apply(this,arguments)||this;return e.printContainerSelector="[dashboard-printer]",e}return __extends(o,i),o.prototype.calculateStyle=function(i,o){var r=o.gridLayoutContainer.containerWidth+t,a=o.gridLayoutContainer.containerHeight,n=e.BasePrinter.getPrintTargetViewPort(i),s=e.BasePrinter.calculateScaleFactor({width:r,height:a},n);return s<=0?{}:{transform:"scale("+s+") !important","-webkit-transform":"scale("+s+") !important",width:r+"px !important",height:a+"px !important",overflow:"visible !important"}},o})(e.BasePrinter);e.DashboardPrinter=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=40,i=(function(i){function o(){var e=null!==i&&i.apply(this,arguments)||this;return e.printContainerSelector="[explore-canvas-printer]",e}return __extends(o,i),o.prototype.calculateStyle=function(i,o){var r=i.width()+t,a=i.height(),n=e.BasePrinter.getPrintTargetViewPort(i),s=i.find(".visualContainer");if(s.length>0){var c=0,l=0;s.each((function(e,t){var i=$(t),o=i.position(),r=Math.max(0,o.left),a=Math.max(0,o.top);c=Math.max(c,r+i.width()),l=Math.max(l,a+i.height())}));var d=e.BasePrinter.calculateScaleFactor({width:r,height:a},{width:c,height:l},!0);r*=d,a*=d}var p=e.BasePrinter.calculateScaleFactor({width:r,height:a},n),u=r*p,v=a*p,h=(n.width-u)/2,g=(n.height-v)/2;return{width:r+"px !important",height:a+"px !important",transform:"translate("+h+"px, "+g+"px) scale("+p+") !important","-webkit-transform":"translate("+h+"px, "+g+"px) scale("+p+") !important","transform-origin":"left top !important","-webkit-transform-origin":"left top !important",left:"auto !important",top:"auto !important",right:"auto !important",bottom:"auto !important"}},o})(e.BasePrinter);e.ExploreCanvasPrinter=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/publishContentPackView.html",this.scope={viewModel:"=",dashboardContainer:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.PublishContentPackView)}return t})();t.PublishContentPackView=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/qrCodeDialog.html",this.replace=!0,this.controller=e.common.createController(e.controllers.QrCodeDialogController)}return t})();t.QrCodeDialog=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/qrCodeProgressDialog.html",this.replace=!0,this.controller=e.common.createController(e.controllers.QRCodeProgressDialogController)}return t})();t.QrCodeProgressDialog=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/requestDashboardAccess.html",this.scope={viewModel:"=?"},this.controller=e.common.createController(e.controllers.RequestDashboardAccessController)}return t})();t.RequestDashboardAccess=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/requestDashboardAccessModal.html",this.replace=!0}return e})();e.RequestDashboardAccessModal=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.controller=e.common.createController(e.controllers.ManageDatasetsController),this.restrict="E",this.bindToController=!0,this.controllerAs="$ctrl",this.scope={},this.templateUrl="views/settings/manageDatasets.html",this.link=function(e,t,i,o){window.setTimeout((function(){var e=t.find(".manageDatasetsPane .search input");e.focus()}),100)}}return t})();t.ManageDatasets=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/settings/refreshStatusView.html",this.replace=!0}return e})();e.RefreshStatus=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/settings/refreshWelcomeView.html",this.replace=!0}return e})();e.RefreshWelcome=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsCloseAccountView.html",this.scope={},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsCloseAccountController)}return t})();t.SettingsCloseAccount=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsDashboardView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsDashboardController)}return t})();t.SettingsDashboard=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsDashboardsView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsDashboardsController)}return t})();t.SettingsDashboards=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsDatasetView.html",this.scope={viewModel:"=",storageRefreshSupported:"=?"},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsDatasetController)}return t})();t.SettingsDataset=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsDatasetFeaturedQuestionsView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsDatasetFeaturedQuestionsController),this.link=function(e,t,i){e.focusOnLastInput=function(){t.find('input[type="text"]').last().focus()}}}return t})();t.SettingsDatasetFeaturedQuestions=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsDatasetsView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsDatasetsController)}return t})();t.SettingsDatasets=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsEsriView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsEsriController)}return t})();t.SettingsEsri=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsGeneralView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsGeneralController)}return t})();t.SettingsGeneral=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsPluginsView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsPluginsController)}return t})();t.SettingsPlugins=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsPrivacyView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsPrivacyController)}return t})();t.SettingsPrivacy=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsPublishedContentView.html",this.scope={},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsPublishedContentController)}return t})();t.SettingsPublishedContent=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsLanguageView.html",this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.SettingsLanguageController)}return t})();t.SettingsLanguage=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsViewerView.html",this.scope={},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsViewerController)}return t})();t.SettingsViewer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/settings/settingsDatasetsView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.SettingsWorkbooksController)}return t})();t.SettingsWorkbooks=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/shareView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.ShareView)}return t})();t.ShareView=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/taskPaneSliderView.html",this.replace=!0,this.controller=e.common.createController(e.controllers.TaskPaneSliderController)}return t})();t.TaskPaneSlider=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.models.TileFactory,o=(function(){function t(t){var o=this;this.controller=e.common.createController(e.controllers.TileEditorController),this.replace=!0,this.restrict="E",this.scope={},this.templateUrl="views/tileEditor.html",this.link=function(e,t){var r=e.viewModel.tile.config;if(r&&r.widget){var a=i.getTileTemplate(r.widget.id),n=o.$compile(a)(e);t.find(".widgetEditorContent").append(n)}var s=!1;t.find("input").keyup((function(t){if(!(27!==t.keyCode&&13!==t.keyCode||s)){s=!0,t.target.blur(),27===t.keyCode?e.closeTileEditorWithoutSaving():13===t.keyCode&&e.saveChangesAndExit();try{e.$apply()}catch(e){}t.target.focus(),s=!1}})),window.setTimeout((function(){var e=t.find(".displayText");e.is(":disabled")?t.find(".pbi-input input").first().focus():e.focus()}),500)},this.$compile=t}return t})();t.TileEditor=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.controller=e.common.createController(e.controllers.TileGalleryController),this.restrict="E",this.bindToController=!0,this.controllerAs="$ctrl",this.scope={},this.templateUrl="views/tileGallery.html"}return t})();t.TileGallery=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/compositeTile.html",this.replace=!0,this.scope={viewModel:"=",allowInteractivity:"@"},this.controllerAs="$ctrl",this.controller=e.common.createController(e.controllers.CompositeTileController)}return t})();t.CompositeTile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=e.dataServices.constants,r=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/dashboardTile.html",this.replace=!0,this.scope={viewModel:"=",canEdit:"=",disableInteractions:"=?",addTileToMobileView:"&?",removeTileFromMobileView:"&?",viewportContextSelector:"<?"},this.link=function(r,a,n){var s=r.viewModel.report;s&&a.attr("data-report-id",s.id),r.disableInteractions="true"===n.disableInteractions,r.disablePointerEvents="true"===n.disablePointerEvents||r.disableInteractions,r.onceInViewport=function(){r.inViewport=!0},r.$on(e.controllers.DashboardTileController.Events.DeleteTile,(function(e,t){e.stopPropagation&&e.stopPropagation(),a.hide()}));var c=r.$root.$on(o.deleteModelStartedEventName,(function(e,t){var i=r.viewModel.datasetModel;i&&i.id===t&&a.hide()})),l=r.$root.$on(o.deleteModelFailedEventName,(function(e,t){var i=r.viewModel.datasetModel;i&&i.id===t&&a.show()}));r.$watch("canEdit",(function(e,i){var o=e?"false":"true";a.attr(t.DragResizeDisabledAttr,o)})),r.isTileElementChanging=function(){return a.hasClass("changing")};var d=r.viewModel,p=a.find(".tileContent")[0],u=function(e){r.openTile(!1,e)&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)};d&&!d.reportTile&&p&&p.addEventListener("click",u,!0),r.$on(i.scopeDestroyEventName,(function(){p&&p.removeEventListener("click",u,!0),l(),c()}))},this.controller=e.common.createController(e.controllers.DashboardTileController);
}return t})();r.DragResizeDisabledAttr="drag-resize-disabled",t.DashboardTile=r})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i,o){var r=this;this.restrict="E",this.replace=!0,this.scope={viewModel:"="},this.templateUrl="views/tiles/iframeTile.html",this.link=function(t,i){function o(e){a.postMessage({embedCode:e},"*")}var a,n=!1;if(t.iframeSource=embeddedWebContentIframeSource,!r.networkAvailability.isNetworkAvailable()){var s=r.localizationService.get("Tile_ErrorText");return void t.$emit(e.common.constants.tileErrorEventName,s)}var c=function(e){e.data&&e.data.iframeLoaded&&(a=i.find("iframe").first()[0].contentWindow,a&&e.source===a&&(n=!0,o(t.viewModel.embedCode),r.$window.removeEventListener(jsCommon.DOMConstants.messageEventName,c)))};r.$window.addEventListener(jsCommon.DOMConstants.messageEventName,c),t.$watch("viewModel.embedCode",(function(e){n&&o(e)}))},this.$window=t,this.networkAvailability=i,this.localizationService=o}return t})();t.IframeTile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/tiles/imageTile.html",this.replace=!0,this.scope={viewModel:"="}}return e})();e.ImageTile=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/modelTile.html",this.replace=!0,this.scope={viewModel:"="},this.link=function(t){t.imageUrl=e.dataServices.constants.modelPlaceholderImageUrl}}return t})();t.ModelTile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/reportTile.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.ReportTileController)}return t})();t.ReportTile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/tiles/ssrsTile.html",this.replace=!0,this.scope={viewModel:"="}}return e})();e.SsrsTile=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/tile.html",this.replace=!0,this.scope={viewModel:"=",headerClickTarget:"&"},this.controller=e.common.createController(e.controllers.Tile),this.link=function(e,t,i){e.disablePointerEvents="true"===i.disablePointerEvents,e.largeHeader=i.hasOwnProperty("largeHeader"),e.allowInteractivity=i.allowInteractivity,e.largeHeader&&e.viewModel.setTileHeaderSize(0)}}return t})();t.Tile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/tiles/workbookTile.html",this.replace=!0,this.scope={viewModel:"=",title:"="},this.controller=e.common.createController(e.controllers.WorkbookTileController),this.link=function(e,t,i){e.onTileImageReady=function(e){t.find("img.internalWorkbookTileImage").load((function(t){e(t.currentTarget)}))}}}return t})();t.WorkbookTile=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){var e=this;this.restrict="E",this.templateUrl="views/usageBarView.html",this.replace=!0,this.scope={usageBarModel:"=",viewModel:"="},this.link=function(t,i,o){t.$watch("usageBarModel.selfUsageInPercent",(function(){e.updateBar(t,i)})),t.$watch("usageBarModel.otherUsageInPercent",(function(){e.updateBar(t,i)}))}}return e.prototype.updateBar=function(e,t){var i=e.usageBarModel.selfUsageInPercent,o=e.usageBarModel.otherUsageInPercent,r=t.find(".usageBar"),a=t.find(".legends"),n=r.outerWidth(!0),s=n*i,c=n*o,l=r.children();r.hasClass("threebars")&&r.removeClass("threebars"),r.hasClass("twobars")&&r.removeClass("twobars"),r.hasClass("onebar")&&r.removeClass("onebar"),a.hasClass("threebars")&&a.removeClass("threebars"),a.hasClass("twobars")&&a.removeClass("twobars"),i+o<=1?($(l[0]).css("width",s+"px"),$(l[1]).css("width",c+"px"),$(l[2]).css("width",n-s-c+"px"),r.addClass("threebars"),a.addClass("threebars")):i>1?($(l[0]).css("width",n+"px"),$(l[1]).css("width","0px"),$(l[2]).css("width","0px"),r.addClass("onebar"),a.addClass("twobars")):($(l[0]).css("width",s+"px"),$(l[1]).css("width",n-s+"px"),$(l[2]).css("width","0px"),r.addClass("twobars"),a.addClass("twobars"))},e})();e.UsageBar=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t,i,o,r){var a=this;this.restrict="E",this.templateUrl="views/usageBarMenuItemView.html",this.replace=!0,this.scope={text:"=?",usageDescription:"=?",labelClass:"=?"},this.link=function(e,t,i){a.updateBar(e,t),e.$watchGroup([function(){return a.quota.quotaLimitInMB},function(){return a.modelService.lastUpdatedTimestamp},function(){return a.workbookService.lastUpdatedTimestamp}],(function(){a.updateBar(e,t)})),e.$watch((function(){return a.groupService.activeGroup}),(function(){a.updateBar(e,t)}))},this.quota=e,this.modelService=t,this.workbookService=i,this.groupService=o,this.featureSwitchService=r}return e.prototype.updateBar=function(t,i){var o=this.quota.getUsageBarMenuItemViewModel();t.text=o.text,t.usageDescription=o.usageDescription;var r=o.usageInMB/o.quotaLimitInMB,a=i.find(".usageBar"),n=a.outerWidth(!0),s=n*r,c=a.children();a.hasClass(e.onebarClass)&&a.removeClass(e.onebarClass),a.hasClass(e.twobarsClass)&&a.removeClass(e.twobarsClass),r<=1?($(c[0]).css("width",s+"px"),$(c[1]).css("width",n-s+"px"),a.addClass(e.twobarsClass)):($(c[0]).css("width",n+"px"),$(c[1]).css("width","0px"),a.addClass(e.onebarClass))},e})();t.onebarClass="onebar",t.twobarsClass="twobars",e.UsageBarMenuItem=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/userGroupHeaderView.html",this.scope={viewModel:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.UserGroupHeaderController)}return t})();t.UserGroupHeader=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.transclude=!0,this.controller=e.common.createController(e.controllers.UserInfoController),this.template='<div ng-transclude class="userInfo"></div>'}return t})();t.UserInfoContainer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/viewContentPack.html",this.scope={},this.replace=!0,this.controller=e.common.createController(e.controllers.ViewContentPack)}return t})();t.ViewContentPack=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/warningBar.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.WarningBarController)}return t})();t.WarningBar=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/waterMarkMessage.html",this.scope={config:"="}}return e})();e.WaterMarkMessage=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.replace=!0,this.templateUrl="views/workbookAppBar.html",this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.WorkbookAppBarController)}return t})();t.WorkbookAppBar=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/workbookContainer.html",this.replace=!0,this.scope={viewModel:"="},this.controller=e.common.createController(e.controllers.WorkbookContainerController),this.link=function(e,t,i){e.getEwaTargetWindow=function(){var e=t.find("iframe.workbookEWAIsolation")[0];return e.contentWindow}}}return t})();t.WorkbookContainer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.replace=!0,this.templateUrl="views/workbookDiscoverabilityToast.html"}return e})();e.WorkbookDiscoverabilityToast=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){function i(t,i,o,r){o.ensureLocalization((function(){var a=o.get(t),n=o.format("ArtifactDoesNotExistTitleFormat",[a]),s=o.get("ArtifactDoesNotExistMessage");r.logEvent(e.telemetry.ArtifactNotFound,t);var c={label:o.get("PBI_Button_Label_OK"),resultValue:"ok",cssClass:"primary"};i.error(s,"artifactNotFound",{title:n,dialogOptions:[c],isDismissable:!0,showAdditionalErrorInfo:!1})}))}t.showArtifactDoesNotExistDialog=i})(i=t.ArtifactNotFoundHelper||(t.ArtifactNotFoundHelper={}))})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){}return t.HasUnsupportedExploreVisuals=function(e,t){var i=!1;if(e){var o=e.sections;if(o)for(var r=0,a=o.length;r<a;r++){var n=o[r],s=n.visualContainers;if(s)for(var c=0,l=s.length;c<l;c++){var d=s[c],p=d.config.singleVisual.visualType;if(p&&!t.getPlugin(p)){if(e.resourcePackages&&e.resourcePackages.some((function(e){return e.name===p})))continue;i=!0;break}}}}return i},t.IsReportSavedAsExploration=function(e){return e.hasExploration||!e.reportUrl},t.shouldDisplayErrorAsNotificationBar=function(t){return t===e.DMTS_NoGatewayWithAllDatasourcesToBindError||t===e.DMTS_MultipleGatewaysWithAllDatasourcesToBindError||t===e.DMTS_DatasourceHasNoCredentialError||t===e.DM_GWPipeline_Client_GatewayUnreachable||t===e.DMTS_UserLostPermissionToDatasourceError||t===e.DMTS_UserNotFoundInADGraphError||t===e.DM_GWPipeline_Gateway_DataSourceConnectionError||t===e.DM_GWPipeline_Gateway_DataSourceAccessError||t===e.DM_GWPipeline_Gateway_ImpersonationError||t===e.DM_GWPipeline_Gateway_InvalidMashupConnectionString||t===e.DM_GWPipeline_Gateway_DatabaseLoginError||t===e.DM_GWPipeline_Gateway_SqlTimeoutException||t===e.DM_GWPipeline_Gateway_AdomdTimeoutException||t===e.DM_GWPipeline_Gateway_InvalidObjectNameException||t===e.DM_GWPipeline_Gateway_ConnectionBrokenException||t===e.DM_GWPipeline_Gateway_MemoryError||t===e.DM_GWPipeline_Gateway_MissingStructureError||t===e.DM_GWPipeline_Gateway_UnprocessedStructureError||t===e.DM_GWPipeline_Gateway_ModelLoadError||t===e.DM_GWPipeline_Gateway_CancellationError||t===e.DM_GWPipeline_Gateway_QueryExecutionError||t===e.DM_GWPipeline_Gateway_RecalculationRequiredError||t===e.DM_GWPipeline_Gateway_AdomdConnectError||t===e.DM_GWPipeline_Gateway_MashupDataAccessError||t===e.RS_CannotRetrieveModel||t===e.RS_AccessDeniedDueToRLSGroup||t===e.RS_AccessDenied},t})();t.ReportUtility=i})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=2e3,i=(function(){function e(e,t){this.newQueryResultUpdates=[],this.explorationId=e,this.explorationProxy=t}return e.prototype.onNewQueryCacheResultAvailable=function(e){var i=this;this.newQueryResultUpdates.push(e),1===this.newQueryResultUpdates.length&&setTimeout((function(){var e={visualQueryResults:_.map(i.newQueryResultUpdates,(function(e){var t={visualContainerId:e.visualContainerId,query:e.query,dataTransforms:e.dataTransforms};return t}))};i.explorationProxy.saveVisualContainerQueries(i.explorationId,e),i.newQueryResultUpdates=[]}),t)},e})();e.VisualContainerQueryUpdater=i})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){var e=this;this.reports=[],this.dashboards=[],this.tiles=[],this.models=[],this.isReportExpanded=!0,this.isDashboardExpanded=!1,this.isTileExpanded=!1,this.onCuratedContentExpanded=function(t){e.openOneAtTime(t)}}return Object.defineProperty(e.prototype,"dashboardCount",{get:function(){return this.dashboards.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tileCount",{get:function(){return this.tiles.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reportCount",{get:function(){return this.reports.length},enumerable:!0,configurable:!0}),e.prototype.addModels=function(e){e=e||[];for(var t=0;t<e.length;t++)this.models.push(e[t])},e.prototype.addReports=function(e){e=e||[];for(var t=0;t<e.length;t++)e[t].reportUrl&&this.reports.push(e[t])},e.prototype.addDashboards=function(e){e=e||[];for(var t=0;t<e.length;t++)this.dashboards.push(e[t])},e.prototype.addTiles=function(e){e=e||[];for(var t=0;t<e.length;t++)this.tiles.push(e[t])},e.prototype.openOneAtTime=function(e){"report"===e?(this.isReportExpanded=!this.isReportExpanded,this.isReportExpanded&&(this.isDashboardExpanded=!1,this.isTileExpanded=!1)):"dashboard"===e?(this.isDashboardExpanded=!this.isDashboardExpanded,this.isDashboardExpanded&&(this.isReportExpanded=!1,this.isTileExpanded=!1)):"tile"===e&&(this.isTileExpanded=!this.isTileExpanded,this.isTileExpanded&&(this.isReportExpanded=!1,this.isDashboardExpanded=!1))},e})();e.ActivityPaneCuratedContentModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(){this._connectionOptionsTag=-1}return Object.defineProperty(i.prototype,"connectionOptionsTag",{get:function(){return this._connectionOptionsTag},enumerable:!0,configurable:!0}),i.prototype.onPackageSelectionChange=function(e){this.packageSelectionEvent=e},i.prototype.updatePackagesData=function(e){if(e){var t=-1,i=null;this.packageItems&&(t=this.packageItems.selectedIndex,i=this.packageItems.selectedItem),this.packageModels=[],this.activityPaneData=e.activityPaneData,this.packageItems=this.initializePackageNames(i),t!==-1?this.packageItems.selectedIndex=t:this.packageItems.itemsCount>0&&(this.packageItems.selectedIndex=0)}},i.prototype.initializePackageNames=function(i){var o=this,r=[];if(this.activityPaneData.length>0){r=this.activityPaneData.map((function(e){return new t.ComboBoxItem(e.packageName,e.packageId)})),this.packageItems||(this.packageItems=new t.ComboBoxModel),this.packageItems.clearItems(),r.sort((function(e,t){return e.name.toLowerCase().localeCompare(t.name.toLowerCase())}));for(var a=0;a<r.length;a++)this.packageItems.addItem(r[a]);this.packageItems.selectedIndex===-1&&this.packageItems.itemsCount>0&&(this.packageItems.selectedIndex=0),this.packageItems.addSeparator(),this.packageItems.addItem(new t.ComboBoxItem(e.common.localize.get("ActivityPane_ConnectionOptionsText"),this.connectionOptionsTag,t.ComboBoxItemType.Text,(!1))),i=i||this.packageItems.selectedItem,this.populateSelectedPackageModels(i)}return this.packageItems.onClickEvent=function(e){return o.onPackageItemSelected(e)},this.packageItems.onDropDownEvent=function(){return o.onPackageItemSelected()},this.packageItems},i.prototype.onPackageItemSelected=function(e){e=e||this.packageItems.selectedItem,this.populateSelectedPackageModels(e),this.packageSelectionEvent&&this.packageSelectionEvent(e)},i.prototype.populateSelectedPackageModels=function(t){if(t.tag!==this.connectionOptionsTag)for(var i=this.activityPaneData,o=0;o<i.length;o++){var r=i[o];if(r.packageId===t.tag){if(!r.models)return;if(this.packageModels=[],1===r.models.length){var a=r.models[0];this.packageModels[0]={modelId:a.id,modelName:e.common.localize.get("ActivityPane_Explore")}}else for(var n=0;n<r.models.length;n++){var a=r.models[n];this.packageModels[n]={modelId:a.id,modelName:e.common.localize.get("ActivityPane_Explore")+" "+a.displayName}}break}}},i})();t.ActivityPaneDataPackagesModel=i;var o=(function(){function e(e,t){this.modelId=e,this.modelName=t}return e})();t.ActivityPanePackageModel=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return e})();e.ActivityPaneModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(e,i,o,r){this.localizationService=r,this.alerts=e?e:[],this.tileName=i.getDisplayText(),this.measureName=o,this.tileModel=i,this.moreOptionsMenu=[{action:0,text:r.get("AlertsPane_Collapse"),type:DropDownMenuItemType.Item}],this.operatorOptions=[{label:r.get("AlertsPane_GreaterThanOperator"),value:0},{label:r.get("AlertsPane_LessThanOperator"),value:1}],this.frequencyOptions=[{label:"AlertsPane_NotificationFrequencyDay",value:0},{label:"AlertsPane_NotificationFrequencyHour",value:1}],this.alertFailureMessages=[{message:r.get("AlertsPane_CreateError"),value:t.AlertFailureState.Create},{message:r.get("AlertsPane_UpdateError"),value:t.AlertFailureState.Update},{message:r.get("AlertsPane_DeleteError"),value:t.AlertFailureState.Delete}]}return i.prototype.addNewEmptyAlert=function(e){var i=this.tileModel.getDisplayText();if(i){var o=t.factory.AlertsModelFactory.createEmptyAlert(i,this.measureName,this.localizationService.format("AlertsPane_AlertsForTile",[i]),e);this.alerts.unshift(o)}},i.prototype.isValid=function(){return _.every(this.alerts,(function(t){return t.title.length<=e.constants.alertTitleMaxLength&&t.title.length>0&&jQuery.isNumeric(t.thresholdValue)}))},i})();t.AlertsEditorModel=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.None=0]="None",e[e.Create=1]="Create",e[e.Update=2]="Update",e[e.Delete=3]="Delete"})(t=e.AlertFailureState||(e.AlertFailureState={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Text=1]="Text",e[e.Separator=2]="Separator"})(t=e.ComboBoxItemType||(e.ComboBoxItemType={}));var i=(function(){function e(e,i,o,r){this._name=e,this._tag=i,this._type=o||t.Text,this._selectable="undefined"==typeof r||r}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){return this._tag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectable",{get:function(){return this._selectable},enumerable:!0,configurable:!0}),e})();e.ComboBoxItem=i;var o=(function(){function e(){this._items=[],this._dialogVisible=!1,this._selectedIndex=-1,this._separatorTag=-9}return Object.defineProperty(e.prototype,"separatorTag",{get:function(){return this._separatorTag},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isVisible",{get:function(){return this._dialogVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedItem",{get:function(){return this._items[this._selectedIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){this._selectedIndex=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemsCount",{get:function(){return this._items.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onClickEvent",{set:function(e){this._onClickEvent=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"onDropDownEvent",{set:function(e){this._onDropDownEvent=e},enumerable:!0,configurable:!0}),e.prototype.clearItems=function(){this._items=[]},e.prototype.addItem=function(e){this._items.push(e)},e.prototype.addSeparator=function(){this._items.push(new i("",(-9),t.Separator,(!1)))},e.prototype.collapse=function(){this._dialogVisible=!1},e.prototype.toggle=function(e){this._dialogVisible||this._onDropDownEvent&&this._onDropDownEvent(),this._dialogVisible=!this._dialogVisible,e.stopPropagation()},e})();e.ComboBoxModel=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.ContentProviderStoreModel=t})(t=e.contentProviderStore||(e.contentProviderStore={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function i(i){var o=this;this.contract=i,this.contentProviderDialogModel=new e.common.models.ModalDialogModel((!1),"Ok",(!0),(!0),(!0),(!1)),this.sharePane=new t.ShareViewModel,this.manageStoragePane=new t.ManageStorageViewModel,this.manageEmbedPane=new t.ManageEmbedViewModel,this.publishPane=new t.PublishContentPackViewModel,this.temporaryDashboardMap=null,this.accessRequestInfo={dashboardObjectId:""},this.viewMode=0,e.common.localize.ensureLocalization((function(){o.contentProviderDialogModel.confirmButtonText=e.common.localize.get("DashboardContainer_Ok")}))}return Object.defineProperty(i.prototype,"dashboards",{get:function(){return this._dashboards},set:function(e){this._dashboards=e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibleDashboards",{get:function(){return _.filter(this._dashboards,(function(e){return!e.isHidden}))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"models",{get:function(){return this.contract.models},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPhonePortraitViewMode",{get:function(){return 1===this.viewMode},enumerable:!0,configurable:!0}),i.prototype.cacheTemporaryDashBoardMapping=function(e,t){this.temporaryDashboardMap={temporaryId:e,resolvedId:t}},i.prototype.calculateLayout=function(){if(this._dashboards)for(var e=0,t=this._dashboards;e<t.length;e++){var i=t[e];i.calculateLayout()}},i.prototype.applyLayout=function(e){if(this._dashboards)for(var t=0,i=this._dashboards;t<i.length;t++){var o=i[t];o.applyLayout()}},i.prototype.findDashboard=function(e){return this.dashboards[this.getDashboardIndex(e)]},i.prototype.findDashboardByGUID=function(e){var t=this.dashboards;this.temporaryDashboardMap&&this.temporaryDashboardMap.resolvedId&&this.temporaryDashboardMap.temporaryId&&this.temporaryDashboardMap.temporaryId===e&&(e=this.temporaryDashboardMap.resolvedId);for(var i=0,o=t.length;i<o;i++)if(t[i].objectId===e)return t[i]},i.prototype.getDashboardIndex=function(e){for(var t=this.dashboards,i=0,o=t.length;i<o;i++)if(t[i].id===e)return i;return-1},i})();t.DashboardContainer=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.ImportData=0]="ImportData",e[e.ViewExcel=1]="ViewExcel"})(t=e.UploadFormat||(e.UploadFormat={}));var i;!(function(e){e[e.Local=0]="Local",e[e.OneDrive=1]="OneDrive",e[e.DropBox=2]="DropBox",e[e.OneDrivePro=3]="OneDrivePro",e[e.SharePoint=4]="SharePoint"})(i=e.HostType||(e.HostType={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.EmailsListModel,o=(function(){function t(e){this.isAdmin=!(!e||!e.contract)&&e.contract.isOwner,this.groupName=e?e.displayName:"",this.groupId="",this.emailsList=new i,this.displayMemberList=[],this.originalDisplayMemberList=[],this.invalidEmailAddressesErrorMessage="",this.notExitingEmailAddressesErrorMessage="",this.privacyOption=e&&e.contract&&e.contract.isPublic?0:1,this.accessControlOption=e&&e.contract&&e.contract.isReadOnly?1:0,this.isCapacityEnabled=e&&e.contract&&!!e.contract.capacityObjectId,this.capacity=e&&e.capacity,this.initPrivacyOptions(),this.initAccessControlOptions(),this.initMemberRoleOptions()}return t.prototype.initPrivacyOptions=function(){this.privacyOptions=[{key:0,value:e.common.localize.get("GroupEditor_PrivacyOptions_Public")},{key:1,value:e.common.localize.get("GroupEditor_PrivacyOptions_Private")}]},t.prototype.initAccessControlOptions=function(){this.accessControlOptions=[{key:0,value:e.common.localize.get("GroupEditor_AccessControlOptions_ReadWrite")},{key:1,value:e.common.localize.get("GroupEditor_AccessControlOptions_ReadOnly")}]},t.prototype.initMemberRoleOptions=function(){this.groupMemberRoleOptions=[{key:1,value:e.common.localize.get("GroupEditor_RoleOptions_Admin")},{key:0,value:e.common.localize.get("GroupEditor_RoleOptions_Member")}]},t})();t.GroupEditorModel=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t){var i=this;this.contextMenuItemList=[],t&&t.metadata&&(t.metadata.contextMenuItemList.forEach((function(e){i.contextMenuItemList.push(e)})),this.contextMenuSeparatorPosition=t.metadata.contextMenuItemList.length),0===this.contextMenuItemList.length&&(this.contextMenuSeparatorPosition=-1),t.isOwner||t.isPublic?this.contextMenuItemList.push({linkType:e.common.contracts.GroupLinkType.EditGroup}):this.contextMenuItemList.push({linkType:e.common.contracts.GroupLinkType.ViewGroup}),this.contextMenuItemList.push({linkType:e.common.contracts.GroupLinkType.LeaveGroup})}return t})();t.GroupMetadata=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.ContentTileType,o=(function(){function o(o){this.contract=o,o&&(this.aadGroupId=o.objectId,this.displayName=o.displayName,this.metadata=new t.GroupMetadata(o),this.capacity=o.capacityObjectId&&{id:o.capacityObjectId,name:o.capacityName}),this.isMyWorkspace=!1,this.lastViewedDashboard=-1,this.lastOwnershipFilter=e.models.OwnershipFilterMenuFilter.AllContent,this.contentTileType=i.Workspace}return o.prototype.getPermissions=function(){},o})();t.Group=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.showHistoryDialog=!1,this.showSpinner=!1}return e})();e.HistoryDialogModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.InsightsModel=t})(t=e.insights||(e.insights={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.models.CollapsiblePaneModel,o=e.common.constants.TaskPaneCollapsiblePaneMode,r=(function(){function e(e){this.collapsiblePaneMode=o.Default,this.contract=e,this.showDashboardName=!1,this.collapsiblePane=new i,this.notificationPane=new i,this.showNotificationPane=!1}return e.prototype.calculateLayout=function(){this.dashboardContainer.calculateLayout(),this.reportContainer.calculateLayout()},e.prototype.applyLayout=function(){this.dashboardContainer.applyLayout(),this.reportContainer.applyLayout()},e})();t.LandingContainer=r})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.UsageBarModel=t;var i=(function(){function e(){this.ownedByMeSelected=!0}return e})();e.ManageStorageViewModel=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(i){function o(e,t,i,o,r,a,n){return new m(e,t,i,o,r,a,n)}var r=e.common.constants,a=e.common.contracts,n=a.ContentProviderCategory,s=jsCommon.DateExtensions,c=e.common.helpers.ModelConverterHelper,l=e.common.models.ReportContainer,d=e.dataServices.constants,p=e.dataServices.models.Dashboard,u=e.common.controllers.EmailsList,v=e.common.models.EmailsListModel,h=jsCommon.JsonExtensions,g=jsCommon.EnumExtensions;i.createModelConverter=o;var m=(function(){function o(e,t,i,o,r,a,n){this.telemetryService=e,this.errorService=t,this.visualPlugins=i,this.promiseFactory=o,this.geolocationService=r,this.dataServiceModelConverter=a,this.localizationService=n}return o.prototype.setModelMerger=function(e){this.modelMerger=e},o.prototype.convertAppPublishModel=function(t){var i=this.convertContentPack(t);if(i){var o=this.dataServiceModelConverter.convertAppModelBase(t),r=__assign({url:e.helpers.UrlHelper.getAppUrl(t.providerKey),displayName:t.displayText,objectId:t.providerKey,emailsList:new v,publishAsTemplate:t.category===n.OrganizationalTemplateApp,getPermissions:function(){return a.Permissions.Read|a.Permissions.CopyOnWrite}},i,o);return r.emailsList.inputUserList=u.emailsToUsers(t.accessPermissions.listOfGroupsOrPrincipals),r}},o.prototype.convertLandingContainer=function(t){var o=new i.LandingContainer(t);return o.dashboardContainer=this.convertDashboardContainer(t.dashboardContainer),o.reportContainer=this.convertReportContainer(t.reportContainer),o.workbookContainer=this.convertWorkbookContainer(t.workbookContainer),o.qnaContainer=this.convertQnaContainer(t.qnaContainer),o.explorationContainer=e.explore.viewModels.ViewModelFactory.createExplorationContainer(),o},o.prototype.convertLandingContainerShallow=function(t){var o=new i.LandingContainer(t);return o.dashboardContainer=this.convertDashboardContainerShallow(t.dashboardContainer),o.reportContainer=this.convertReportContainerShallow(t.reportContainer),o.explorationContainer=e.explore.viewModels.ViewModelFactory.createExplorationContainer(),o},o.prototype.convertReportContainerShallow=function(e){var t=new l(e);return t},o.prototype.convertReportContainer=function(e){var t=this.convertReportContainerShallow(e);return this.fillReportContainerChildren(t,e),t},o.prototype.fillReportContainerChildren=function(e,t){t&&(e.report=this.convertReport(t),this.fillReport(e.report,t))},o.prototype.fillReport=function(e,t){this.dataServiceModelConverter.fillReport(e,t)},o.prototype.fillModel=function(e,t){this.dataServiceModelConverter.fillModel(e,t)},o.prototype.convertReport=function(e){return this.dataServiceModelConverter.convertReport(e)},o.prototype.convertPackage=function(e){return this.dataServiceModelConverter.convertPackage(e)},o.prototype.convertQnaContainerShallow=function(e){var t=new i.QnaContainer(e);return t},o.prototype.convertQnaContainer=function(e){var t=this,i=this.convertQnaContainerShallow(e);return e.models&&(i.models=e.models.map((function(e){return t.convertModel(e)}))),i},o.prototype.convertWorkbookContainerShallow=function(e){var t=new i.WorkbookContainer(e);return t},o.prototype.convertWorkbookContainer=function(e){var t=this.convertWorkbookContainerShallow(e);return this.fillWorkbookContainerChildren(t,e),t},o.prototype.fillWorkbookContainerChildren=function(e,t){t&&(e.workbook=this.convertWorkbook(t))},o.prototype.convertWorkbook=function(e){return this.dataServiceModelConverter.convertWorkbook(e)},o.prototype.convertWorkbookShallow=function(e){return this.dataServiceModelConverter.convertWorkbookShallow(e)},o.prototype.convertModel=function(e){return this.dataServiceModelConverter.convertModel(e)},o.prototype.convertAppDataset=function(e){return this.dataServiceModelConverter.convertAppDataset(e)},o.prototype.convertContentPack=function(e){var t=this.dataServiceModelConverter.convertContentPackBase(e);if(e){var i=__assign({publishedTo:this.findPublishedTo(e.accessPermissions),isDirty:e.isDirty,listOfGroupPrincipals:e.accessPermissions.listOfGroupsOrPrincipals,isSharedToEntireOrg:e.accessPermissions.isSharedToEntireOrganization},t);return i}},o.prototype.findPublishedTo=function(e){if(e.isSharedToEntireOrganization)return this.localizationService.get("GetData_MyOrganization");var t=this.localizationService.get("PowerBI_Semicolon_Delimiter");if(e.adUserMetadataList)return _.map(e.adUserMetadataList,(function(e){return e.displayName||e.userPrincipalName})).join(t);var i=e.listOfGroupsOrPrincipals;return i.join(t)},o.prototype.convertReportShallow=function(e){return this.dataServiceModelConverter.convertReportShallow(e)},o.prototype.convertModelShallow=function(e){return this.dataServiceModelConverter.convertModelShallow(e);
},o.prototype.convertPackageShallow=function(e){return this.dataServiceModelConverter.convertPackageShallow(e)},o.prototype.convertDashboardContainerShallow=function(e){var t=new i.DashboardContainer(e);return t.activeViewMode=e.activeViewMode,t.userId=e.userId,t.accessRequestInfo=e.accessRequestInfo,t},o.prototype.fillDashboardContainerDashboard=function(e,t){var i=this;if(t.dashboards&&1===t.dashboards.length){var o=t.packages||[],r=t.dashboards[0];r.tiles&&r.tiles.map((function(e){i.resolveTilePackage(e,o)}))}},o.prototype.setDashboardIsSample=function(t,i){t.resetSampleFields();var o=_.chain(i).filter((function(e){return e.contentProviderId===d.samplesContentProviderId})).map((function(e){return e.id})).value(),a=i.filter((function(e){return Object.keys(r.generatedSamplesContentProvidersMap).map((function(e){return parseInt(e,10)})).indexOf(e.contentProviderId)>=0})),n=t.contract.packageIds;if(n)for(var s=0;s<n.length;s++){var c=n[s];if(o.indexOf(c)>=0){t.isSharedSample=!0,t.isSample=!0,t.sampleProviderName=e.constants.samplesContentProviderName;break}for(var l=0,p=a.length;l<p;++l){var u=a[l];if(u.id===c){t.isSample=!0,t.sampleProviderName=this.getSampleProviderName(u.contentProviderId);break}}}},o.prototype.setDashboardHasOnPremiseModel=function(t,i){t.hasOnPremiseModel=!1;var o=_.chain(i).filter((function(t){return t.vsName===e.common.constants.onPremiseVSName})).map((function(e){return e.id})).value(),r=t.contract.modelIds;if(r)for(var a=0;a<r.length;a++){var n=r[a];if(o.indexOf(n)>=0){t.hasOnPremiseModel=!0;break}}},o.prototype.setDashboardHasUpdate=function(e,t){e.hasUpdate=!1;var i=_.find(t,(function(t){return t.id===e.contract.originalPackageId}));i&&i.latestVersion&&i.version!==i.latestVersion&&(e.hasUpdate=!0)},o.prototype.setDashboardsHasUpdate=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];o.hasUpdate=!0}},o.prototype.getSampleProviderName=function(e){var t=r.generatedSamplesContentProvidersMap[e];return t?t:"Unknown Sample"},o.prototype.fillDashboardContainerDashboards=function(e,t){t.dashboards&&(e.userId=t.userId,this.fillDashboardContainerDashboardsFromBasicDashboardContainer(e,t))},o.prototype.fillDashboardContainerDashboardsFromBasicDashboardContainer=function(e,t){var i=this;if(t.dashboards){var o=t.reports||[],r=t.workbooks||[],a=t.models||[],n=t.packages||[];e.dashboards=t.dashboards.map((function(e){var s=i.convertDashboard(e,a,o,r);return i.setDashboardIsSample(s,n),i.setDashboardHasOnPremiseModel(s,a),i.setDashboardHasUpdate(s,n),e.id===t.activeDashboardId&&s.contract.tiles&&s.contract.tiles.map((function(e){i.resolveTilePackage(e,n)})),s}))}},o.prototype.updateDashboardContainerContract=function(e,t){this.updateDashboardContainerContractFromBasicDashboardContainer(e,t),e.groups=t.groups,e.userId=t.userId,e.previousTenantId=t.previousTenantId},o.prototype.updateDashboardsReportContract=function(e,t){t.reportIds.splice(e,1)},o.prototype.removeDashboardsWorkbookContract=function(e,t){t.workbookIds.splice(e,1)},o.prototype.updateDashboardContainerContractFromBasicDashboardContainer=function(e,t){var i=t.dashboards;void 0===t.activeDashboardId&&i&&i.length>0&&(t.activeDashboardId=i[0].id),this.modelMerger.mergeModelContentProviderId(t.models,t.packages),e.dashboards=i,e.activeDashboardId=t.activeDashboardId,e.models=t.models,e.reports=t.reports,e.workbooks=t.workbooks,e.packages=t.packages},o.prototype.resolveTilePackage=function(e,t){this.dataServiceModelConverter.resolveTilePackage(e,t)},o.prototype.getTileModel=function(e,t){return this.dataServiceModelConverter.getTileModel(e,t)},o.prototype.getTileReport=function(e,t){return this.dataServiceModelConverter.getTileReport(e,t)},o.prototype.getTileWorkbook=function(e,t,i){return this.dataServiceModelConverter.getTileWorkbook(e,t,i)},o.prototype.fillDashboardContainerDashboardsShallow=function(e,t){var i=this;t.dashboards&&(e.dashboards=t.dashboards.map((function(e){return i.convertDashboardShallow(e)})))},o.prototype.convertDashboardContainer=function(e){var t=this.convertDashboardContainerShallow(e);return this.fillDashboardContainerDashboards(t,e),e.activityPane&&(t.activityPane=this.convertActivityPane(e.activityPane)),t},o.prototype.convertActivityPane=function(e){var t=this,i=this.convertActivityPaneShallow(e);return e.contentProviders||(i.contentProviders=e.contentProviders.map((function(e){return t.convertContentProvider(e)}))),i},o.prototype.convertActivityPaneShallow=function(e){var t=new i.ActivityPaneModel(e);return t},o.prototype.convertContentProvider=function(t){if(!t)return null;var o=new i.ProviderTileModel(t);return o.backgroundImageUrl=e.build+t.iconUrl,o.displayText=t.displayText,o},o.prototype.convertContentProviderContractToContentProviderTileModel=function(e){var t=null;if(e){var i=this.promiseFactory.defer();e.authentication||i.resolve(""),t={contract:e,id:e.id,title:e.displayText,category:e.category,clientCategory:c.getContentProviderClientCategory(e),providerName:e.providerName,iconUrl:e.iconUrl?jsCommon.Utility.urlCombine(clusterUri,e.iconUrl):null,iconCSSClass:e.iconCSSClass,descriptionLocalizationKey:e.description,learnMoreUrl:e.learnMoreUrl,searchKeywords:e.searchKeywords,publisher:e.publisher,publishDate:e.publishDate,emailAddress:null,emailAddressAsLink:null,visible:!1,disableDetailPane:e.disableDetailPane,sortPriority:null!==e.sortPriority&&void 0!==e.sortPriority?e.sortPriority:r.contentProviderStoreTileMaxSortPriority,authentication:e.authentication,authenticationInitializationDeferred:i,authenticationInitializationInProgress:!0,finePrint:e.finePrint,autoRedirectUrlParams:e.autoRedirectUrlParams,customConfigurationHandler:e.customConfigurationHandler,tileGrouping:null,usePBIDesktop:e.usePBIDesktop}}return t},o.prototype.convertContentProviderContractToContentProviderTileModelWithGrouping=function(e){var t=null;return e&&(t={contract:e,id:e.id,title:e.grouping.groupingName,category:e.category,clientCategory:c.getContentProviderClientCategory(e),providerName:e.providerName,iconUrl:e.iconUrl?jsCommon.Utility.urlCombine(clusterUri,e.iconUrl):null,iconCSSClass:e.iconCSSClass,descriptionLocalizationKey:e.grouping.groupingDescription,learnMoreUrl:e.learnMoreUrl,searchKeywords:e.searchKeywords||"",publisher:e.publisher,publishDate:null,emailAddress:null,emailAddressAsLink:null,visible:!1,disableDetailPane:e.disableDetailPane,sortPriority:null!==e.sortPriority&&void 0!==e.sortPriority?e.sortPriority:r.contentProviderStoreTileMaxSortPriority,authentication:null,authenticationInitializationDeferred:null,authenticationInitializationInProgress:!1,finePrint:e.finePrint,autoRedirectUrlParams:null,customConfigurationHandler:null,tileGrouping:{groupingChildItems:[]}}),t},o.prototype.groupContentProviderTileModels=function(e){for(var t,i,o=[],a={},n=[],s=0,c=e;s<c.length;s++){var l=c[s];l.contract.grouping&&l.contract.grouping.groupingName&&l.contract.grouping.groupingName.length>0?(t=l.contract.grouping.groupingName,a[t]||(i=this.convertContentProviderContractToContentProviderTileModelWithGrouping(l.contract),a[t]=i,n.push(t),o.push(i)),i=a[t],i.searchKeywords=i.searchKeywords.concat(" ",l.searchKeywords||""," ",l.title.toLowerCase()),l.sortPriority=l.contract.grouping.groupingIndex,jQuery.isNumeric(l.sortPriority)||(l.sortPriority=r.contentProviderStoreTileMaxSortPriority),i.tileGrouping.groupingChildItems.push(l)):o.push(l)}return o},o.prototype.convertDashboardShallow=function(e){var t=new p(e);return this.modelMerger.mergeDashboardShallow(t,e),t},o.prototype.convertDashboard=function(e,t,i,o){return this.dataServiceModelConverter.convertDashboard(e,t,i,o)},o.prototype.fillDashboardChildren=function(e,t,i,o){return this.dataServiceModelConverter.fillDashboardChildren(e,t,i,o)},o.prototype.convertTileShallow=function(e,t,i){return this.dataServiceModelConverter.convertTileShallow(e,t,i)},o.prototype.convertSpecificTileShallow=function(e,t){return this.dataServiceModelConverter.convertSpecificTileShallow(e,t)},o.prototype.convertTile=function(e,t,i,o){return this.dataServiceModelConverter.convertTile(e,t,i,o)},o.prototype.convertCompositeTile=function(e){return this.dataServiceModelConverter.convertCompositeTile(e)},o.prototype.convertTileData=function(e){return this.dataServiceModelConverter.convertTileData(e)},o.prototype.convertImageTile=function(e){return this.dataServiceModelConverter.convertImageTile(e)},o.prototype.convertWorkbookTile=function(e,t,i){return this.dataServiceModelConverter.convertWorkbookTile(e,t,i)},o.prototype.convertReportTile=function(e){return this.dataServiceModelConverter.convertReportTile(e)},o.prototype.convertModelTile=function(e){return this.dataServiceModelConverter.convertModelTile(e)},o.prototype.convertIframeTile=function(e){return this.dataServiceModelConverter.convertIframeTile(e)},o.prototype.convertSsrsTile=function(e){return this.dataServiceModelConverter.convertSsrsTile(e)},o.prototype.convertRealTimeTile=function(e){return this.dataServiceModelConverter.convertRealTimeTile(e)},o.prototype.convertTileConfig=function(e){return this.dataServiceModelConverter.convertTileConfig(e)},o.prototype.convertTileAction=function(e){return this.dataServiceModelConverter.convertTileAction(e)},o.prototype.convertUserSettings=function(e){var t=new i.UserSettings(e);return t.allowQnaDataCollection=null==e.allowQnaDataCollection||e.allowQnaDataCollection,t.tileDialogPreviewFormat=e.tileDialogPreviewFormat,t.preferredLanguage=e.preferredLanguage,t.extendedSettings=h.tryParseJSON(e.extendedSettings),t.esriVisualEnabled=null!=e.esriVisualEnabled&&e.esriVisualEnabled,t},o.prototype.convertSettingsMetadata=function(e){return{dashboards:this.convertSettingsDashboards(e.dashboards),general:this.convertSettingsGeneral(e.userSettings),datasets:this.convertSettingsDatasets(e.datasetModels||[]),workbooks:this.convertSettingsDatasets(e.workbookModels||[])}},o.prototype.convertSettingsCommunications=function(e,t){if(e){for(var i=[],o=0,r=e;o<r.length;o++){var a=r[o],n=_.map(a.subscriptions,(function(e){return{id:e.id}}));i.push({dashboardInfo:a.dashboardInfo,reportInfo:a.reportInfo,subscriptions:n})}var s=[{predicateName:"displayName",allowSorting:!0,displayName:this.localizationService.get("SettingsCommunication_Name_ColumnTitle")},{predicateName:"actions",allowSorting:!1,displayName:this.localizationService.get("SettingsCommunication_Actions_ColumnTitle")},{predicateName:"count",allowSorting:!0,displayName:this.localizationService.get("SettingsCommunication_Overview_ColumnTitle")}];return{subscriptions:i,workspaceName:t,columnsHeader:s}}},o.prototype.convertSettingsDashboards=function(e){var t=this;return{dashboards:_.map(e,(function(e){return t.convertSettingsDashboard(e)}))}},o.prototype.convertSettingsDashboard=function(e){return{dashboardId:e.id,hasQnaSupportedModel:e.hasQnaSupportedModel,name:e.displayName,objectId:e.objectId,qnaEnabled:e.qnaEnabled,gravityEnabled:e.gravityEnabled,dataClassificationId:e.dataClassificationId}},o.prototype.convertSettingsEsri=function(e){return{esriVisualEnabled:null!=e.esriVisualEnabled&&e.esriVisualEnabled}},o.prototype.convertSettingsGeneral=function(e){return{privacy:this.convertSettingsPrivacy(e),language:this.convertSettingsLanguage(e),esri:this.convertSettingsEsri(e)}},o.prototype.convertSettingsPrivacy=function(e){return{allowQnaDataCollection:null==e.allowQnaDataCollection||e.allowQnaDataCollection}},o.prototype.convertSettingsLanguage=function(e){return{preferredLanguage:e.preferredLanguage}},o.prototype.convertSettingsDatasets=function(e){var t=this;return{datasets:_.map(e,(function(e){return t.convertSettingsDataset(e)}))}},o.prototype.convertSettingsDataset=function(e){return e&&!e.contentProviderId&&e.packageContentProviderId&&(e.contentProviderId=e.packageContentProviderId),c.convertModelToDataset(e)},o.prototype.getImageUrl=function(e){return this.dataServiceModelConverter.getImageUrl(e)},o.prototype.getSsrsImageUrl=function(e){return this.dataServiceModelConverter.getSsrsImageUrl(e)},o.prototype.convertDashboardInvitation=function(e){var t=this,i=[];return null==e||""===e.toString()?[]:i=e.map((function(e){return t.convertToUserInvitation(e)}))},o.prototype.convertToUserInvitation=function(e){var t=new i.UserInvitationModel;return t.dashboardId=e.dashboardId,t.id=e.id,t.permissions=e.permissions,t.sentToEmailAddress=e.sentToEmailAddress,t},o.prototype.convertDashboardAccessInfoArray=function(e){var t=this;return null==e||_.isEmpty(e.toString())?[]:_.map(e,(function(e){return t.convertDashboardAccessInfo(e)}))},o.prototype.convertDashboardAccessInfo=function(e){var t=new i.DashboardAccessInfoModel;return t.emailAddress=e.emailAddress,t.id=e.id,t.kind=e.kind,t.permissions=e.permissions,t.givenName=e.givenName,t.familyName=e.familyName,t.fullName=e.givenName,e.familyName?t.fullName=t.fullName+" "+e.familyName:_.isEmpty(t.fullName)&&(t.fullName=t.emailAddress),t},o.prototype.convertCuratedContent=function(e,t){if(!e)return null;var o=[],r=[],a=[],n=[],s=new i.ActivityPaneCuratedContentModel,c=e.activityPaneData;t||c&&c.length>0&&(t=new i.ComboBoxItem(c[0].packageName,c[0].packageId));var l=_.filter(c,(function(e){return e.packageId===t.tag}));return l&&1===l.length&&(l[0].models&&(n=l[0].models),l[0].reports&&(o=l[0].reports),l[0].dashboards&&(r=l[0].dashboards),l[0].tiles&&(a=l[0].tiles),s.packageId=l[0].packageId),s.addModels(n),s.addReports(o),s.addDashboards(r),s.addTiles(a),s},o.prototype.convertEmbedToEmbeddedResource=function(t,i){var o;switch(t.embedType){case e.explore.contracts.EmbedType.Static:o="ManageEmbed_EmbedType_Snapshot";break;case e.explore.contracts.EmbedType.Interactive:o="ManageEmbed_EmbedType_Live";break;default:o="ManageEmbed_EmbedType_Unknown"}var r=t.disabled?"ManageEmbed_Status_Blocked":"ManageEmbed_Status_Active";i.model&&i.model.cloudRlsEnabled&&(r="ManageEmbed_Status_NotSupported");var a=null,n=null;return t.embedType===e.explore.contracts.EmbedType.Interactive&&t.createDate&&(n=jsCommon.DateExtensions.parseUtcDate(t.createDate),n&&(a=n.toLocaleString())),{contract:t,associatedReport:i,statusLocalizationKey:r,status:"",embedTypeLocalizationKey:o,embedType:"",dateCreated:a,dateCreatedSortable:n}},o.prototype.convertAlertsEditorPane=function(e,i,o){return{contract:e,title:e.title,tileName:i.getDisplayText(),measureName:o,thresholdValue:e.rule.condition.compareToAValue.value.toString(),enabled:e.enabled,operator:e.rule.condition.compareToAValue.operator,frequency:e.notificationSetting.frequency,emailNotificationEnabled:g.hasFlag(e.notificationSetting.carrierType,2),isExpanded:!1,isNew:!1,alertFailureState:t.AlertFailureState.None}},o.prototype.convertAlertModelToContract=function(e,t,i){var o=e.contract;return{id:o?o.id:null,rule:i,modelId:t.contract.modelId,tileId:t.id,notificationSetting:{carrierType:e.emailNotificationEnabled?3:1,frequency:e.frequency},enabled:e.enabled,title:e.title,dashboard:o?o.dashboard:null,group:o?o.group:null,tile:o?o.tile:null,createdDateTimeUtc:o?o.createdDateTimeUtc:null,alertQueryFilters:[]}},o.prototype.convertSettingsAlerts=function(e,t){var i=moment(t.createdDateTimeUtc.toLocaleString()+"Z").toDate();return{contract:t,alertCreatedDate:s.GetFullDateWithTime(e,i),alertTitle:t.title,dashboardName:t.dashboard?t.dashboard.displayName:null,enabled:t.enabled}},o})()})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=jsCommon.EnumExtensions,r=e.explore.viewModels,a=e.common.contracts.Permissions,n=e.dataServices.models.RealTimeModel,s=e.data.SemanticFilter,c=e.dataServices.TileDefaultSizesUtils,l=e.dataServices.TileUtils,d=e.explore.util.VisualContainerUtils,p="glyphicon",u="glyph-mini",v="pbi-glyph-tvmonitor",h="pbi-glyph-phone";!(function(t){function i(e,t,i,o,r,a,n,s,c){var l=[];return b(s,o,r)&&l.push({text:e.get("Duplicate_Dashboard"),action:0,type:DropDownMenuItemType.Item}),t.featureSwitches.printingEnabled!==!1&&l.push({text:e.get("Print_Dashboard"),action:1,type:DropDownMenuItemType.Item}),a.disableDashboardRefresh||f(s)&&l.push({text:e.get("Refresh_Dashboard"),action:2,type:DropDownMenuItemType.Item}),a.disableSetFeaturedDashboard||!c||n.isListViewEnabled()||c.inAppView()||(i.isOnHomeDashboard(c.currentDashboardGUID)?l.push({text:e.get("NavigationPane_DisableFeaturedDashboard"),action:7,type:DropDownMenuItemType.Item}):l.push({text:e.get("SetFeaturedDashboardButton"),action:3,type:DropDownMenuItemType.Item})),y(s)&&(l.push({text:e.get("Dashboard_Authoring_Delete_Phone_View"),action:8,type:DropDownMenuItemType.Item}),l.push({text:e.get("ContentTileOptions_Settings"),action:6,type:DropDownMenuItemType.Item})),l}function r(e){var t=[];return t.push({text:e.get("Dashboard_Authoring_Web"),action:4,type:DropDownMenuItemType.Item,hasGlyph:!0,iconClass:[p,u,v].join(" "),checked:!0,tooltip:e.get("Dashboard_Authoring_Phone_Tooltip")}),t.push({text:e.get("Dashboard_Authoring_Phone"),action:5,type:DropDownMenuItemType.Item,hasGlyph:!0,iconClass:[p,u,h].join(" "),tooltip:e.get("Dashboard_Authoring_Web_Tooltip")}),t}function s(e,t){return{dashboardPane:d(e,t),mobileDashboard:e}}function d(e,t){return void 0===t&&(t=!0),{dashboard:e,isPaneExpanded:t}}function g(e){for(var t=1,i=[],o=1,r=1,a=0,n=e;a<n.length;a++){var s=n[a];i.push(l.createDefaultPhoneByTile(o,r,s)),o+=c.getRowSpan(s,t)}return i}function m(){var t={name:"",columns:[],mode:e.common.contracts.RealTimeMode.CacheOnly},i=new n(null,t);return i.isNew=!0,i}function f(e){return!!e}function y(e){return e&&(o.hasFlag(e.getPermissions(),a.All)||o.hasFlag(e.getPermissions(),a.ReadWrite))}function b(e,t,i){return e&&e.canEdit&&!t.isActiveWorkspaceIsReadOnly&&!i.fullScreenMode&&o.hasFlag(e.getPermissions(),a.ReShare)}t.createDashboardMenuItems=i,t.createAuthoringDashboardMenuItems=r,t.createDashboardEditMobileDisplay=s,t.createDashboardPane=d,t.createDefaultPhonePositions=g,t.createDefaultRealTimeModel=m})(i=t.modelFactory||(t.modelFactory={}));var g;!(function(t){function i(e,t,i){return{canvas:a(e,i),taskPane:{isPaneExpanded:!1},visualizationPane:{sections:[],activeSection:0,pagePaneSections:[],activePageSection:0,isPaneExpanded:!1,visualPluginFilter:function(e){var i=t.tryGetFilterPropertyIdentifier(e.capabilities);return!i}},showVisualEnabled:!1,inFocusTile:null,dashboardText:"",displayText:"",subDisplayText:"",source:"",pinVisualText:"",saveVisualText:"",editVisualText:"",getRelatedInsightsText:"",workbook:null,realTime:null,showInsightsPane:!1,showPreviousVisualButton:!1}}function o(e,t){var i=[];return i.push({text:e.get("InFocus_GenerateQrCode"),action:0,type:DropDownMenuItemType.Item}),t&&i.push({text:e.get("ExportData_MenuItem"),action:1,type:DropDownMenuItemType.Item}),i}function a(e,t){var i={id:0,name:d.uniqueName(e.visualContainers),config:{},layouts:jsCommon.ArrayExtensions.extendWithId([{id:t,position:c()}])},o={visual:{visualContainer:r.ViewModelFactory.convertVisualContainerStandalone(i,t)},exploration:n(e)},a=o.visual.visualContainer;return a.overridePosition=c(),a.allowDeferredRendering=!0,a.hostServices={deleteVisualRelationships:_.noop,getFilters:function(){var t=[],i=a.contract.filters||[];i=i.concat(e.filters||[]);for(var o=0,r=i;o<r.length;o++){var n=r[o],c=n.filter;c&&t.push(c)}return{dataFilter:s.merge(t),highlightFilter:null}},getVisualRelationshipFilterAction:function(){return 0},selectDataPoint:function(){},setVisualRelationshipFilterAction:_.noop,clearHighlight:function(){}},o}function n(t){var i={width:t.size.width,height:t.size.height,dataSources:e.explore.contracts.createDataSourceArray(),sections:[t]};return e.explore.viewModels.ViewModelFactory.convertExploration(i,0)}function c(){return{x:0,y:0,width:1024,height:768}}t.createInFocus=i,t.createInFocusMenuItems=o})(g=t.inFocusViewModelFactory||(t.inFocusViewModelFactory={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i){return new a(e,t,i)}var o=e.common.helpers.ModelConverterHelper,r=e.dataServices.ContractUtils;t.createModelMerger=i;var a=(function(){function e(e,t,i){this.permissionService=i,this.modelConverter=e,this.dataServiceModelMerger=t}return e.prototype.mergeDashboard=function(e,t,i,o,r){this.dataServiceModelMerger.mergeDashboard(e,t,i,o,r)},e.prototype.mergeDashboardShallow=function(e,t){this.dataServiceModelMerger.mergeDashboardShallow(e,t)},e.prototype.mergeDashboardOwnerInfo=function(e,t){this.dataServiceModelMerger.mergeDashboardOwnerInfo(e,t)},e.prototype.mergeDashboardTiles=function(e,t){this.dataServiceModelMerger.mergeDashboardTiles(e,t)},e.prototype.mergeTileShallow=function(e,t,i,o){this.dataServiceModelMerger.mergeTileShallow(e,t,i,o)},e.prototype.mergeTile=function(e,t,i,o,r,a){this.dataServiceModelMerger.mergeTile(e,t,i,o,r,a)},e.prototype.mergeResourceWithIdArrays=function(e,t){for(var i=e.slice(0),o=0;o<e.length;o++){var r=e[o];_.filter(t,(function(e){return e.id===r.id})).length>0&&i.splice(i.indexOf(r),1)}return i.concat(t)},e.prototype.mergeModelContentProviderId=function(e,t){if(e)for(var i=0;i<e.length;i++){var o=e[i];o.contentProviderId=o.contentProviderId||r.findContentProviderId(t,o.packageId)}},e.prototype.mergeReport=function(e,t){var i=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.objectId=t.objectId||e.objectId,e.modelId=t.modelId||e.modelId,e.reportUrl=t.reportUrl||e.reportUrl,e.packagePublishStatus=t.packagePublishStatus||e.packagePublishStatus,e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.getPermissionsCallback=function(){return i.permissionService.getReportEffectivePermissions(t)})},e.prototype.mergeModel=function(e,t){var i=this;e&&t&&(e.contract=t,e.id=t.id||e.id,e.isNew=t.isNew||e.isNew,e.getPermissionsCallback=function(){return i.permissionService.getModelEffectivePermissions(t)},e.name=t.name||e.name,e.displayName=t.displayName||e.displayName,e.description=t.description||e.description,e.fileName=t.fileName||e.fileName,e.packageId=t.packageId||e.packageId,e.packageVersion=t.packageVersion||e.packageVersion,e.contentProviderId=t.contentProviderId||e.contentProviderId,e.qnaSupported=t.qnaSupported,e.packagePublishStatus=null!=t.packagePublishStatus?t.packagePublishStatus:e.packagePublishStatus,e.isRefreshInProgress=t.currentRefreshStartingTime&&o.convertRefreshTimeToJsDateTime(t.currentRefreshStartingTime).getTime()+18e5>Date.now(),e.cloudRlsEnabled=t.cloudRlsEnabled)},e.prototype.mergeWorkbook=function(e,t){this.dataServiceModelMerger.mergeWorkbook(e,t)},e.prototype.mergePackage=function(e,t){this.dataServiceModelMerger.mergePackage(e,t)},e})()})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.contracts.Permissions,o=(function(){function o(e){this.source=e,this.isNameEditable=!1,this.metadata=[],this.actions=[],this.icon=t.NavigationPaneListItemIcon.None}return o.getDashboardPermissionString=function(t){var o;return e.common.localize.ensureLocalization((function(){switch(t){case i.All:o=e.common.localize.get("DashboardContextMenu_AllPermissionMessage");break;case i.None:o=e.common.localize.get("DashboardContextMenu_NonePermissionMessage");break;case i.Read:o=e.common.localize.get("DashboardContextMenu_ReadPermissionMessage");break;case i.ReadReshare:o=e.common.localize.get("DashboardContextMenu_ReadResharePermissionMessage");break;case i.ReadWrite:o=e.common.localize.get("DashboardContextMenu_ReadWritePermissionMessage");break;case i.ReShare:o=e.common.localize.get("DashboardContextMenu_ReSharePermissionMessage");break;case i.Write:o=e.common.localize.get("DashboardContextMenu_WritePermissionMessage");break;default:o=e.common.localize.get("DashboardContextMenu_UnknownPermissionMessage")}})),o},o})();t.DashboardNavigationPaneListItemModel=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function t(t){this.source=t,this.isNameEditable=!1,this.metadata=[],this.actions=[],this.icon=e.NavigationPaneListItemIcon.None}return t})();e.DatasetNavigationPaneListItemModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function t(t){this.source=t,this.isNameEditable=!1,this.metadata=this.getGroupMetadata(t),this.actions=this.getGroupActions(t),t.isMyWorkspace?this.icon=e.NavigationPaneListItemIcon.User:this.icon=e.NavigationPaneListItemIcon.Group}return t.prototype.getGroupMetadata=function(e){var t=[];return t},t.prototype.getGroupActions=function(e){var t=[];return t.push({text:"'"+e.displayName+"' 1",action:function(){}}),t.push({text:"'"+e.displayName+"' 2",action:function(){}}),t.push({text:"'"+e.displayName+"' 3",action:function(){}}),t},t})();e.GroupNavigationPaneListItemModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.None=0]="None",e[e.Shared=1]="Shared",e[e.ReadOnly=2]="ReadOnly",e[e.Group=3]="Group",e[e.User=4]="User",e[e.Workbook=5]="Workbook"})(t=e.NavigationPaneListItemIcon||(e.NavigationPaneListItemIcon={}));var i=(function(){function e(){}return e})();e.NavigationPaneListItemModel=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function t(t){this.source=t,this.isNameEditable=!1,this.metadata=[],this.actions=[],this.icon=e.NavigationPaneListItemIcon.None}return t})();e.ReportNavigationPaneListItemModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function t(t){this.source=t,this.isNameEditable=!1,this.metadata=[],this.actions=[],this.icon=e.NavigationPaneListItemIcon.Workbook}return t})();e.WorkbookNavigationPaneListItemModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.dashboardTile=e,this.reportTile=e,this.workbookTile=e,this.hasTileFormatting=!0}return e})();e.PinTileDialogModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){})(t=e.PowerBICompanionModel||(e.PowerBICompanionModel={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){})(t=e.PowerBIConnectorModel||(e.PowerBIConnectorModel={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){})(t=e.PowerBIOnPremGatewayModel||(e.PowerBIOnPremGatewayModel={}))})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){e&&(this.isDefaultImageUsed=!e.icon),this.contentPackCreatedFor=!1}return e})();e.PublishContentPackViewModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.QrCodeDialogModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.RequestDashboardAccess=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.RequestDashboardAccessModal=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t;!(function(e){e[e.Privacy=0]="Privacy",e[e.CloseAccount=1]="CloseAccount",e[e.Language=2]="Language",e[e.Plugins=3]="Plugins",e[e.Preview=4]="Preview",e[e.Esri=5]="Esri"})(t=e.SettingsGeneralSubgroupType||(e.SettingsGeneralSubgroupType={}));var i=(function(){function e(e,t){this.type=e,this.name=t}return e})();e.GeneralSubGroup=i})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){this.type=e,this.name=t}return e})();e.SettingsGroup=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i,o=e.common.contracts.Permissions;!(function(e){e[e.Default=0]="Default",e[e.SharedUsers=1]="SharedUsers",e[e.InvitedUsers=2]="InvitedUsers",e[e.RequestingUsers=3]="RequestingUsers"})(i=t.SharingUserList||(t.SharingUserList={}));var r;!(function(e){e[e.ReadOnly=0]="ReadOnly",e[e.ReadReshare=1]="ReadReshare",e[e.StopSharing=2]="StopSharing"})(r=t.SharingOptions||(t.SharingOptions={}));var a=(function(){function e(){}return e})();t.UserInvitationModel=a;var n=(function(){function t(){}return Object.defineProperty(t.prototype,"permissionsDisplayText",{get:function(){if((this.permissions&o.Read)===o.Read)return(this.permissions&o.Write)===o.Write?e.common.localize.get("Sharing_PermissionDisplay_CanEdit"):e.common.localize.get("Sharing_PermissionDisplay_CanView")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isExternalUser",{get:function(){return this._isExternalUser},set:function(e){this._isExternalUser=e,this.allowedActions=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sharingPermissionsOptions",{get:function(){if(this.allowedActions)return this.allowedActions;var t=[{text:e.common.localize.get("Sharing_PermissionOptions_StopSharing"),action:r.StopSharing,id:this.id,type:DropDownMenuItemType.Item,kind:this.kind}];return(this.permissions&o.ReShare)===o.ReShare?t.push({text:e.common.localize.get("Sharing_PermissionOptions_DisableReshares"),action:r.ReadOnly,id:this.id,type:DropDownMenuItemType.Item,kind:this.kind}):this.isExternalUser||t.push({text:e.common.localize.get("Sharing_PermissionOptions_EnableReshares"),action:r.ReadReshare,id:this.id,type:DropDownMenuItemType.Item,kind:this.kind}),this.allowedActions=t,this.allowedActions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"emailAddressAsLink",{get:function(){return"mailto:"+this.emailAddress},enumerable:!0,configurable:!0}),t})();t.DashboardAccessInfoModel=n;var s=(function(){function e(){this.allowReshare=!0}return Object.defineProperty(e.prototype,"hasValidationError",{get:function(){return!_.isEmpty(this.emailValidationError)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasValidationWarning",{get:function(){return!_.isEmpty(this.emailValidationWarning)},enumerable:!0,configurable:!0}),e})();t.ShareViewModel=s})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.constants,o=e.dataServices.models.Tile,r=(function(){function t(e,t,i,o,r){this.titleRequired=!1,this.tile=e,this.explorationSerializer=i,this.featureSwitchService=t,this.visualPlugin=o,this.originalContract=angular.copy(e.contract),this.initialize(r)}return t.prototype.initialize=function(e){var t=this.tile;this.workbookService=e;var i=t.composite;if(i)this.defaultTitle=i.config.heading1,this.defaultSubtitle=i.config.heading3,t.displayText=null==t.displayText?this.defaultTitle:t.displayText,t.subDisplayText=null==t.subDisplayText?this.defaultSubtitle:t.subDisplayText;else if(t.reportTile)this.defaultTitle=t.displayText,this.defaultSubtitle=t.subDisplayText;else if(t.workbook){if(t.config&&t.config.workbookTile){var o=t.config.workbookTile.item,r=e.findWorkbook(t.contract.workbookId).contract.displayName;this.defaultTitle=e.getDefaultTileTitle(t.config.workbookTile,r),this.defaultSubtitle=e.getDefaultTileSubtitle(o)}else this.defaultTitle=t.displayText,this.defaultSubtitle=t.subDisplayText;this.titleRequired=!0}this.defaultTitle=this.defaultTitle||"",this.defaultSubtitle=this.defaultSubtitle||"",null==t.displayText&&(t.displayText=this.defaultTitle,t.subDisplayText=this.defaultSubtitle),this.hasTitle=t.hasTitle(),this.canAddOrRemoveCustomLink=!(!t.config||!t.config.widget)||!t.reportTile},Object.defineProperty(t.prototype,"hasLastRefreshTime",{get:function(){return!!this.tile.contractsModel&&!this.tile.realTime},enumerable:!0,configurable:!0}),t.prototype.isCustomLinkValid=function(t){var i=this.tile.action;return i.action!==e.constants.openUrlActionName||o.isValidUrl(i.targetUrl,t);
},t.prototype.isDirty=function(){var e=this.tile,t=this.originalContract,i=e.action,o=t.$action,r=!1;return i&&o&&(r=i.action!==o.action||!!i.openInSameTab!=!!o.openInSameTab||i.targetUrl!==o.targetUrl),e.displayText!==t.displayText||e.subDisplayText!==t.subDisplayText||r||!_.isEqual(e.config,t.$config)||!(!(e.workbook&&t.$config&&t.$config.workbookTile)||_.isEqual(e.workbook.keepOriginalContentSize,t.$config.workbookTile.keepOriginalContentSize))},t.prototype.isTitleValid=function(){var e=this.tile.config;return!(this.titleRequired||this.tile.subDisplayText||e&&e.lastRefreshTimeEnabled)||!!this.tile.displayText},t.prototype.isValid=function(e){return this.isTitleValid()&&this.isCustomLinkValid(e)},t.prototype.canRestoreDefaults=function(){var e=this.tile,t=!1;e.workbook&&(t=!!e.workbook.keepOriginalContentSize);var i=!1;return e.config&&e.config.lastRefreshTimeEnabled&&(i=e.config.lastRefreshTimeEnabled===!0),e.displayText!==this.defaultTitle||e.subDisplayText!==this.defaultSubtitle||t||i||!_.isEmpty(e.action.targetUrl)||this.tile.action.openInSameTab===!0},t.prototype.restoreDefaults=function(){var e=this.tile;e.displayText=this.defaultTitle,e.subDisplayText=this.defaultSubtitle;var t=this.tile.action;t.openInSameTab=!1,t.targetUrl=null,t.originalAction&&(t.action=t.originalAction),e.workbook&&this.setKeepOriginalSizeProperty(i.workbook.defaultKeepOriginalContentSize);var o=e.config;o&&(o.lastRefreshTimeEnabled&&(o.lastRefreshTimeEnabled=!1),o.hideTitle&&(o.hideTitle=!1))},t.prototype.setAction=function(e){var t=this.tile.action;e?(t.originalAction||(t.originalAction=t.action),t.action=e):(t.action=t.originalAction||null,delete t.originalAction)},t.prototype.undoChanges=function(){var e=this.tile,t=this.originalContract;this.hasTitle!==e.hasTitle()&&e.invalidateLayout(),e.contract=t,e.displayText=t.displayText,e.subDisplayText=t.subDisplayText,e.action=t.$action,e.config=t.$config,this.tile.workbook&&t.$config.workbookTile&&this.setKeepOriginalSizeProperty(t.$config.workbookTile.keepOriginalContentSize)},t.prototype.updateModelContract=function(){var t=this.tile,i=t.contract;i.displayText=t.displayText,i.subDisplayText=t.subDisplayText;var o=t.action;i.$action=o,i.action=JSON.stringify(o);var r=t.config;t.workbook&&r.workbookTile&&(r.workbookTile.keepOriginalContentSize=t.workbook.keepOriginalContentSize),i.$config=r,i.config=e.dataServices.models.TileFactory.serializeTileConfig(r,this.explorationSerializer,this.visualPlugin,this.featureSwitchService.featureSwitches.visualContainerTileConfig)},t.prototype.setKeepOriginalSizeProperty=function(e){this.tile.workbook.keepOriginalContentSize=e,this.workbookService.setModelDynamicImageUrl(this.tile.workbook)},t})();t.TileEditorModel=r})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return e})();e.ProviderTileModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,n,s,c){return t.isE2ERun?{itemKeys:[],items:{}}:window.initialDashboardContainer&&jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(window.initialDashboardContainer.previousTenantId)?s.isListViewEnabled()?a.createTutorialModel(o,s,c,n):e.displayPremiumUserFirstTimeExperience?{itemKeys:["DataCapacityLimit","GetDataOnPremisesDataSources","CreateGroup","CreateContentPacks"],items:{DataCapacityLimit:{title:o.get("TutorialPopup_DataCapacityLimitTitle"),text:"<div class='data-capacity-limit'>"+o.get("TutorialPopup_DataCapacityLimitText")+" <a target='_blank' href='https://go.microsoft.com/fwlink/?LinkId=616908'>"+o.get("LearnMore")+"</a></div>",buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".topNavRight #settingsMenuBtn").length>0},attachTo:function(){return $(".topNavRight #settingsMenuBtn")},offset:r.dataCapacityLimit},GetDataOnPremisesDataSources:{title:o.get("TutorialPopup_OnPremisesDataSourcesTitle"),text:"<div class='onpremises-datasources'>"+o.get("TutorialPopup_OnPremisesDataSourcesText")+" <a target='_blank' href='https://go.microsoft.com/fwlink/?LinkId=616911'>"+o.get("LearnMore")+"</a></div>",buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".navigationPane .getDataBtn").length>0},attachTo:function(){return $(".navigationPane").hasClass("isCollapsed")?$(".navigationPane .getDataBtn .getDataIcon"):$(".navigationPane .getDataBtn")},offset:r.dataOnPremises},CreateGroup:{title:o.get("TutorialPopup_CreateGroupTitle"),text:"<div class='create-group'>"+o.get("TutorialPopup_CreateGroupText")+" <a target='_blank' href='https://go.microsoft.com/fwlink/?LinkId=616912'>"+o.get("LearnMore")+"</a></div>",buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".navigationPane .addButton").length>0},attachTo:function(){return $(".navigationPane .addButton")},offset:r.createGroup},CreateContentPacks:{title:o.get("TutorialPopup_CreateContentPacksTitle"),text:"<div class='create-content-packs'>"+o.get("TutorialPopup_CreateContentPacksText")+" <a target='_blank' href='https://go.microsoft.com/fwlink/?LinkId=616913'>"+o.get("LearnMore")+"</a></div>",buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".sliderContentView.contentProviderStore .navigation .categoryContainer .category").length>0},attachTo:function(){return $(".sliderContentView.contentProviderStore .navigation .categoryContainer .category")},offset:r.createContentPacks}}}:{itemKeys:["FindContent"],items:{ConnectData:{title:o.get("TutorialPopup_ConnectDataTitle"),text:o.get("TutorialPopup_ConnectDataText"),buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".navigationPane .getDataBtn").length>0},attachTo:function(){return $(".navigationPane").hasClass("isCollapsed")?$(".navigationPane .getDataBtn .getDataIcon"):$(".navigationPane .getDataBtn")},offset:r.connectData},FindContent:{title:o.get("TutorialPopup_FindContentTitle"),text:o.get("TutorialPopup_FindContentText"),buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".navPaneListItemName .textLabel.new").length>0},attachTo:function(){return $(".navigationPane").hasClass("isCollapsed")?$(".navigationPane .expanderBtn"):$(".navPaneListItemName .textLabel.new").eq(0).closest("li")},offset:r.findContent}}}:{itemKeys:["WelcomeToNewPowerBI","ViewArchivedContent"],items:{WelcomeToNewPowerBI:{title:"<div class='archived-content'>"+o.get("TutorialPopup_WelcomeArchivedContentTitle")+"</div>",text:"<div class='archived-content'>"+o.get("TutorialPopup_WelcomeArchivedContentParagraphOne")+"<br/><br/>"+o.get("TutorialPopup_WelcomeArchivedContentParagraphTwo")+"<br/><br/ >"+o.get("TutorialPopup_WelcomeArchivedContentGoingForward")+"</div><div class='archived-content-caption archived-content-caption-title archived-content-caption-left'>"+o.get("TutorialPopup_ArchivedContentTitle")+"</div><div class='archived-content-caption archived-content-caption-left'>"+o.get("TutorialPopup_ArchivedContentText")+"<br/><br/></div><div class='tenant-merge-picture'></div><div class='archived-content-caption archived-content-caption-title archived-content-caption-right'>"+o.get("TutorialPopup_ForYourOrganizationTitle")+"</div><div class='archived-content-caption archived-content-caption-right'>"+o.get("TutorialPopup_ForYourOrganizationText")+"</div><div class='archived-content-learn-more'><a target='_blank' href='https://go.microsoft.com/fwlink/?LinkId=615080'>"+o.get("TutorialPopup_WelcomeArchivedContentLearnMoreLinkText")+"</a></div>",buttonLabel:o.get("TutorialPopup_GotIt")+'<i class="check ms-Icon ms-Icon--check get-data-icon archived-content"></i>',modalButtonClassOverride:"archived-content-override",canShow:function(){return 0===$(".loading.intro").length},attachTo:function(){return $("body")},modal:!0},ViewArchivedContent:{title:o.get("TutorialPopup_ViewArchivedContentTitle"),text:o.get("TutorialPopup_ViewArchivedContentText"),buttonLabel:o.get("TutorialPopup_GotIt"),canShow:function(){return $(".navigationPane .viewArchivedContent").length>0},attachTo:function(){return $(".navigationPane").hasClass("isCollapsed")?$(".navigationPane .expanderBtn"):$(".navigationPane .viewArchivedContent")},offset:r.connectData}}}}function i(e){var t="GroupCapacitySettings";return{itemKeys:[t],items:{GroupCapacitySettings:{title:e.get("TutorialPopup_GroupCapacitySettingsTitle"),text:e.get("TutorialPopup_GroupCapacitySettingsText"),buttonLabel:e.get("TutorialPopup_GotIt"),canShow:function(){return $(".advanced").length>0},attachTo:function(){return $(".advanced")},iconClass:"pbi-glyph-diamond",offset:r.groupCapacitySettings,dataStoreKey:t}}}}function o(e){var t="WelcomeToCapacity",i=$("<div>"),o='<div class="tutorial-capacity-title"><i class="glyphicon pbi-glyph-diamond glyph-normal"></i>'+e.get("TutorialPopup_WelcomeToCapacityTitle")+"</div>",r=$(o);r.appendTo(i),$("<div>").addClass("tutorial-capacity-header").text(e.get("TutorialPopup_AddedToCapacity")).appendTo(i);var a=$("<div>");$("<div>").addClass("tutorial-capacity-picture").appendTo(a);var n='<div class="tutorial-capacity-text"><div class="description-title">'+e.get("TutorialPopup_WelcomeToCapacityText")+"</div><ul><li>"+e.get("TutorialPopup_WelcomeToCapacityText1")+"</li><li>"+e.get("TutorialPopup_WelcomeToCapacityText2")+'</li></ul><a href="https://go.microsoft.com/fwlink/?linkid=845343">'+e.get("TutorialPopup_WelcomeToCapacityLearnMore")+"</a></div>";return $(n).appendTo(a),{itemKeys:[t],items:{WelcomeToCapacity:{title:i.html(),text:a.html(),buttonLabel:e.get("TutorialPopup_GotIt"),modalButtonClassOverride:"tutorial-capacity-button-override",canShow:function(){return 0===$(".loading.intro").length},attachTo:function(){return $("body")},modal:!0,customClass:"tutorial-capacity-container",overlayOptions:0,dataStoreKey:t}}}}var r;!(function(e){e.connectData={top:0,left:-25},e.home={top:-15,left:-15},e.findContent={top:0,left:-25},e.dataCapacityLimit={top:-10,left:0},e.dataOnPremises={top:10,left:0},e.createGroup={top:0,left:-25},e.createContentPacks={top:0,left:-25},e.insights={top:-10,left:0},e.groupCapacitySettings={top:-25,left:-5}})(r=e.tutorialPopupOffset||(e.tutorialPopupOffset={}));var a;!(function(t){function i(e){var t=".navigationPaneV2 "+e;return $(".navigationPaneV2").hasClass("isExpanded")||$(".navigationPaneV2 .expanderBtn").click(),$(t)}function o(e){switch(e){case p:return"pbi-glyph-favoritestar";case u:return"pbi-glyph-mru";case v:return"pbi-glyph-my-apps";case h:return"pbi-glyph-shared";case g:return"pbi-glyph-collections";case m:return"pbi-glyph-user";case f:return"pbi-glyph-getdata";case y:return"pbi-glyph-gear";default:return""}}function r(t,i){return t===f?i.isRtlLayout?e.Direction.RightBottomForRtl:e.Direction.LeftBottom:t===y?e.Direction.Top:i.isRtlLayout?e.Direction.RightTopForRtl:e.Direction.LeftTop}function a(e,t){var i=$("<div>");$("<div>").addClass("list-view-navigation-header").text(e.get("TutorialPopup_PowerBIPreview")).appendTo(i),$("<div>").addClass("list-view-navigation-title").text(e.get("TutorialPopup_ListViewNavigationPreviewTitle")).appendTo(i);var o=$("<div>");return $("<div>").addClass("tutorial-nav-model-picture").appendTo(o),$("<div>").addClass("list-view-navigation-text").text(e.get("TutorialPopup_ListViewNavigationPreviewText")).appendTo(o),{title:i.html(),text:o.html(),buttonLabel:e.get("TutorialPopup_TakeAQuickTourButtonText"),modalButtonClassOverride:"list-view-navigation-button-override",canShow:function(){return 0===$(".loading.intro").length},attachTo:function(){return $("body")},modal:!0,customClass:"list-view-navigation-container",cancelText:e.get("TutorialPopup_SkipTutorial"),overlayOptions:0,dataStoreKey:d,onButtonClick:function(){return t.resetToMyWorkspace()}}}function n(t,o,r,a,n){var s="."+t[0].toLowerCase()+t.slice(1,t.length),l=function(){return i(s)},d=c(t,l,o,r,a,n);return t===v&&(d.learnMoreText=o.get("LearnMore"),d.learnMoreUrl=e.constants.pbiAppsLink),d}function s(e,t,i,o){var r="#"+e[0].toLowerCase()+e.slice(1,e.length),a=function(){return $(".topNavRight "+r)},n=c(e,a,t,i,void 0,o);return n}function c(e,t,i,a,n,s){var c=i.get("TutorialPopup_"+e+"Title"),l=i.get("TutorialPopup_"+e+"Text"),p=s?i.get("TutorialPopup_GotIt"):i.get("TutorialPopup_Next"),u=function(){return t().length>0},v=o(e),h=r(e,a),g=!0,m=2,f=n||d,y={title:c,text:l,buttonLabel:p,canShow:u,showWhenUnclickable:g,attachTo:t,iconClass:v,preferredOrientation:h,overlayOptions:m,dataStoreKey:f};return y}function l(e,t,i,o){var r={itemKeys:[],items:{}},c=_(r.itemKeys).concat(d,p,u);return t.isAppsEnabled()&&(c=c.concat(v)),c=c.concat(h,g,m,f,y),r.itemKeys=c.value(),r.items[d]=a(e,o),r.items[p]=n(p,e,i),r.items[u]=n(u,e,i),r.items[v]=n(v,e,i,b),r.items[h]=n(h,e,i),r.items[g]=n(g,e,i),r.items[m]=n(m,e,i),r.items[f]=n(f,e,i),r.items[y]=s(y,e,i,!0),t.isAppsEnabled()&&(r.items[f].text=e.get("TutorialPopup_GetDataWithAppsText")),r.isBlockingTutorial=!0,r.isSequentialTutorial=!0,r}var d="ListViewNavigationPreviewTutorial",p="Favorites",u="Recent",v="MyApps",h="SharedWithMe",g="Workspaces",m="QuickAccessPaneLauncher",f="GetData",y="SettingsMenuBtn",b="AppModelPreviewTutorial";t.createTutorialModel=l})(a=e.ListViewNavigationPreviewTutorialFactory||(e.ListViewNavigationPreviewTutorialFactory={})),e.createStartupTutorialModel=t,e.createGroupCapacitySettingsTutorialModel=i,e.createStartUpCapacityTutorialModel=o})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.isMyWorkspace=!0}return e})();e.UserGroupHeaderModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return e})();e.UserSettings=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(e){e[e.FixIt=1]="FixIt",e[e.YesNo=2]="YesNo"})(i=t.WarningBarActionType||(t.WarningBarActionType={}));var o;!(function(e){e[e.Yes=0]="Yes",e[e.No=1]="No",e[e.FixIt=2]="FixIt"})(o=t.WarningBarResult||(t.WarningBarResult={}));var r=(function(){function t(t,i,o){var r=this;e.common.localize.ensureLocalization((function(){r._text=e.common.localize.get(t)})),this._type=i,this._clickCallback=o}return Object.defineProperty(t.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),t.prototype.onButtonClick=function(e){this._clickCallback(e)},t})();t.WarningBarModel=r})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return Object.defineProperty(e.prototype,"showDiscoverabilityToast",{get:function(){return!e.DiscoverabilityToastDismissed&&this._showDiscoverabilityToast},set:function(e){this._showDiscoverabilityToast=e},enumerable:!0,configurable:!0}),e})();e.WorkbookContainer=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,r){return new o(e,t,i,r)}var i=jsCommon.StringExtensions;e.createAlertHttpService=t;var o=(function(){function t(t,i,o,r){this.httpService=e.common.httpService,this.promiseFactory=t,this.telemetryService=i,this.errorService=o,this.localizationService=r,this.allAlerts=[]}return t.prototype.createAlert=function(i,o){var r=this,a=this.promiseFactory.defer(),n="metadata/alerts",s=this.telemetryService.startChildEvent(o,e.telemetry.DataAlertsRequest,e.telemetry.AlertRequestType.Create);return this.httpService.post(n,i,this.httpService.powerbiRequestOptions()).then((function(e){s.resolve(),a.resolve(e.data)}),(function(e){var i=r.getErrorCode(e);if(i===t.quotaExceededError){var o=r.errorService.control();o.showPrompt(r.localizationService.get("Alerts_QuotaExceededDialogTitle"),r.localizationService.get("Alerts_QuotaExceededDialogMessage"),[new InJs.ModalDialogAction(r.localizationService.get("ModalDialogButtonText_Ok"),function(e,t){o.hideDialog()})])}s.reject({errorCode:i}),a.resolve(-1)})),a.promise},t.prototype.updateAlert=function(t,o){var r=this,a=this.promiseFactory.defer(),n="metadata/alerts/{0}",s=this.telemetryService.startChildEvent(o,e.telemetry.DataAlertsRequest,e.telemetry.AlertRequestType.Update);return this.httpService.put(i.format(n,t.id.toString()),t,this.httpService.powerbiRequestOptions()).then((function(e){s.resolve(),a.resolve(!0)}),(function(e){var t=r.getErrorCode(e);s.reject({errorCode:t}),a.resolve(!1)})),a.promise},t.prototype.deleteAlert=function(t,o){var r=this,a=this.promiseFactory.defer(),n="metadata/alerts/{0}",s=this.telemetryService.startChildEvent(o,e.telemetry.DataAlertsRequest,e.telemetry.AlertRequestType.Delete);return this.httpService.delete(i.format(n,t.toString()),this.httpService.powerbiRequestOptions()).then((function(e){s.resolve(),a.resolve(!0)}),(function(e){var t=r.getErrorCode(e);s.reject({errorCode:t}),a.resolve(!1)})),a.promise},t.prototype.toggleAlert=function(t,o,r){var a=this,n=this.promiseFactory.defer(),s="metadata/alerts/{0}/toggle",c=this.telemetryService.startChildEvent(r,e.telemetry.DataAlertsRequest,e.telemetry.AlertRequestType.Toggle);return this.httpService.put(i.format(s,t.toString()),o,this.httpService.powerbiRequestOptions()).then((function(e){c.resolve(),n.resolve(!0)}),(function(e){var t=a.getErrorCode(e);c.reject({errorCode:t}),n.resolve(!1)})),n.promise},t.prototype.getAllAlerts=function(t,o){var r=this,a=this.promiseFactory.defer(),n="metadata/alerts{0}",s=this.telemetryService.startChildEvent(t,e.telemetry.DataAlertsRequest,e.telemetry.AlertRequestType.Get);return this.httpService.get(i.format(n,null!=o?"?tileId="+o:""),this.httpService.powerbiRequestOptions()).then((function(e){s.resolve(),a.resolve(e.data)}),(function(e){var t=r.getErrorCode(e);s.reject({errorCode:t}),a.resolve([])})),a.promise},t.prototype.getErrorCode=function(e){var t=void 0;return e&&(e.error?t=e.error.code:e.status&&(t=e.status.toString())),t},t})();o.quotaExceededError="DataDrivenAlertRulesQuotaExceeded"})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"DeleteContentPack");return o.enableTelemetry=!0,e.common.httpService.delete("/powerbi/content/providers/organization/"+t+"/",o)}function o(t,i,o,a,n,s){var c=r(t,i,o,a,n),l=t.isTemplate,d=e.common.httpService.powerbiRequestOptions(s,l?"PublishTenantContentPack":"PublishContentPack"),p=l?"/powerbi/content/providers/organizationaltemplate/":"/powerbi/content/providers/organization/";return t.providerKey?e.common.httpService.put(p+t.providerKey+"/",JSON.stringify(c),d):e.common.httpService.post(p,JSON.stringify(c),d)}function r(e,t,i,o,r){var a;a=e.isTemplate?s.OrganizationalTemplate:s.Organizational;var n={name:e.titleText,description:e.descriptionText,icon:t,parameterIcon:i,accessPermissions:{listOfGroupsOrPrincipals:e.groupsAddressesList,isSharedToEntireOrganization:e.isSharedWithOrg},dashboardIds:e.selectedDashboardIds,reportIds:e.selectedReportIds,modelIds:e.selectedDatasetIds,workbookIds:e.selectedWorkbookIds,contentProviderCategory:a};return e.emailsList&&e.emailsList.inputUserList&&(n.accessPermissions.adUserMetadataList=e.emailsList.inputUserList),e.providerKey&&(o||(n.skipUpdateIcon=!o,n.icon=""),r||(n.skipUpdateParameterIcon=!r,n.parameterIcon="")),n}function a(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"SetContentPackDirty");o.enableTelemetry=!0;var r={contentProviderKeys:t},a=e.common.httpService.put("/powerbi/content/providers/organization/",JSON.stringify(r),o);return a}function n(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"Personalize");return e.common.httpService.put("/powerbi/content/providers/personalize?packageId="+t,null,o)}var s=e.common.contracts.ContentProviderCategory;t.deleteContentPack=i,t.publishContentPack=o,t.createContentPackRequest=r,t.setContentPackDirty=a,t.personalize=n})(t=e.contentPackService||(e.contentPackService={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i){return new o(e,t,i)}t.createExportStaticReportProxy=i;var o=(function(){function t(e,t,i){this.promiseFactory=e,this.errorService=t,this.localizationService=i}return t.prototype.exportAsImage=function(t,i){var o=this,r="v1.0/myorg/reports/"+t;i&&(r+="/pages/"+i);var a=e.common.httpService.powerbiRequestOptions();_.extend(a.headers,{Accept:"image/png"}),a.responseType="arraybuffer";var n=this.promiseFactory.defer();return e.common.httpService.get(r,a).then((function(e){n.resolve({blob:e.data})}),(function(e){n.reject(e?{error:e.error,requestId:e.requestId}:{}),o.errorService.error(o.localizationService.get("ExportStaticImage_Error"),"ExportStaticImage_Error",{requestId:e.requestId,statusCode:e.status.toString()})})),n.promise},t})()})(t=e.proxies||(e.proxies={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t){return new i(e,t)}e.createFavoritesHttpService=t;var i=(function(){function t(e,t){this.syncService=e,this.notificationToastService=t}return t.prototype.deleteFavorite=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"DeleteFavorite"),r="metadata/favorites/"+t.id+"?type="+t.favoriteType;return e.common.httpService.delete(r,o)},t.prototype.getFavorites=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetFavorites");return e.common.httpService.get("metadata/favorites",i)},t.prototype.addFavorite=function(t,i,o){var r=e.common.httpService.powerbiRequestOptions(o,"AddFavorites"),a={favoriteType:t,favoriteId:i};return e.common.httpService.post("metadata/favorites",JSON.stringify(a),r)},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t){return new i(e,t)}e.createGroupHttpService=t;var i=(function(){function t(e,t){this.telemetryService=e,this.activeGroupIdService=t}return t.prototype.setActiveGroupId=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"SetActiveGroup"),o="/powerbi/metadata/user/activegroup";return i.enableTelemetry=!0,e.common.httpService.post(o,null,i)},t.prototype.getGroupDashboardContainer=function(t,i){var o=t.lastViewedDashboard,r=e.common.httpService.powerbiRequestOptions(i,"GetGroupContainer"),a="powerbi/metadata/groupmetadata/";return o&&o!==-1&&(a=jsCommon.Utility.urlCombine(a,"?dashboardId="+encodeURIComponent(o.toString()))),e.common.httpService.get(a,r)},t.prototype.addGroup=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"AddGroup");return o.enableTelemetry=!0,e.common.httpService.put("/powerbi/metadata/groups",t,o)},t.prototype.validateGroupMembers=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"ValidateGroupMembers");return o.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/groups/validatemembers",t,o)},t.prototype.getGroupMembers=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"GetGroupMembers");return o.enableTelemetry=!0,e.common.httpService.get("/powerbi/metadata/groups/"+t+"/members",o)},t.prototype.updateGroup=function(t,i,o,r,a,n,s){var c=e.common.httpService.powerbiRequestOptions(s,"UpdateGroupMembers");c.enableTelemetry=!0;var l={group:i,membersToAdd:o,membersToRemove:r,membersToAdmins:a,adminsToMembers:n};return e.common.httpService.post("/powerbi/metadata/groups/"+t,l,c)},t.prototype.deleteGroup=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"DeleteGroup");return o.enableTelemetry=!0,e.common.httpService.delete("/powerbi/metadata/groups/"+t,o)},t.prototype.validateGroupId=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"ValidateGroupId");return o.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/groups/validategroupid",JSON.stringify(t),o)},t.prototype.getAvailableGroupCapacities=function(){var t=e.common.httpService.powerbiRequestOptions(this.telemetryService.startEvent(e.telemetry.GroupsGetCapacities).event,"GetAvailableGroupCapacities");return e.common.httpService.get("/capacities/author",t)},t})()})(powerbi||(powerbi={})),define("powerBI/proxies/insightsHttpRuntime",["require","exports"],(function(e,t){"use strict";function i(e,t,i,o){return new c(e,t,i,o)}var o=powerbi.insights.constants,r=jsCommon.EnumExtensions,a=powerbi.insights.contracts.InsightsWarnings;t.create=i;var n="insights/derive",s="insights/derive/queue",c=(function(){function e(e,t,i,o){this.httpService=e,this.promiseFactory=t,this.featureSwitchService=o,this.pendingInsightsRequests={},i.addInsightsListener(this)}return e.prototype.deriveInsights=function(e){return this.featureSwitchService.featureSwitches.insightsSyncServiceEnabled?this.deriveInsightsAsync(powerbi.insights.utils.InsightsUtils.getDbMoniker(e.model),e.options,e.requestedInsights,e.timeoutInMS,e.query,e.insightType):this.deriveInsightsSync(powerbi.insights.utils.InsightsUtils.getDbMoniker(e.model),e.options,e.requestedInsights,e.timeoutInMS,e.query,e.insightType)},e.prototype.deriveInsightsSync=function(e,t,i,r,a,s){var c=this,l=this.promiseFactory.defer(),d=null;(a||s)&&(d={TopicQuery:a,InsightType:s});var p={VirtualServerName:e.virtualServerName,DatabaseName:e.databaseName,RequestedInsights:null==i?o.numberOfInsightsRequested:i,TimeoutInMS:null==r?o.timeoutInMs:r,Scope:d,Options:t};return this.httpService.post(n,p,this.httpService.powerbiRequestOptions()).then((function(e){if(0===e.data.Insights.length){var t=c.getMostFatalErrorCode(e.data.Warnings);l.reject({ErrorCode:t,RequestId:e.requestId,Warnings:e.data.Warnings})}else l.resolve(c.CreateInsightContainers(e.data))}),(function(e){var t=c.getErrorCode(e);l.reject({ErrorCode:t,RequestId:e.requestId,Warnings:null})})),l.promise},e.prototype.deriveInsightsAsync=function(e,t,i,r,a,n){var c=this,l=this.promiseFactory.defer(),d=null;(a||n)&&(d={TopicQuery:a,InsightType:n});var p={DatabaseName:e.databaseName,RequestedInsights:i?i:o.numberOfInsightsRequested,TimeoutInMS:r?r:o.timeoutInMs,VirtualServerName:e.virtualServerName,Scope:d,ModelId:e.modelId,Options:t};return this.httpService.post(s,p,this.httpService.powerbiRequestOptions()).then((function(e){c.pendingInsightsRequests[e.data.JobId]=l}),(function(e){var t=c.getErrorCode(e);l.reject({ErrorCode:t,RequestId:e.requestId,Warnings:null})})),l.promise},e.prototype.onInsightsAvailable=function(e){var t=this,i=s+"/"+e+"/results",o=this.pendingInsightsRequests[e];this.httpService.get(i,this.httpService.powerbiRequestOptions()).then((function(e){if(0===e.data.Results.Insights.length&&o){var i=t.getMostFatalErrorCode(e.data.Results.Warnings);o.reject({ErrorCode:i,RequestId:e.requestId,Warnings:e.data.Results.Warnings})}else o&&o.resolve(t.CreateInsightContainers(e.data.Results))}),(function(e){if(o){var i=t.getErrorCode(e);o.reject({ErrorCode:i,RequestId:e.requestId,Warnings:null})}}))},e.prototype.getErrorCode=function(e){var t=void 0;return e&&(e.error?t=e.error.code:e.status&&(t=e.status.toString())),t},e.prototype.getMostFatalErrorCode=function(e){var t;return this.shouldCheckFatalWarnings&&(r.hasFlag(e,a.InvalidModel)?t=a[a.InvalidModel]:r.hasFlag(e,a.ModelUnavailable)?t=a[a.ModelUnavailable]:r.hasFlag(e,a.InsightsServiceException)?t=a[a.InsightsServiceException]:r.hasFlag(e,a.CacheException)?t=a[a.CacheException]:r.hasFlag(e,a.ConnectionPoolTimeoutExceeded)?t=a[a.ConnectionPoolTimeoutExceeded]:r.hasFlag(e,a.IN4DataMinerException)&&(t=a[a.IN4DataMinerException])),t},e.prototype.shouldCheckFatalWarnings=function(e){return!(r.hasFlag(e,a.NoMeasures)||r.hasFlag(e,a.NoDimensions)||r.hasFlag(e,a.NoFilteredComponents))},e.prototype.CreateInsightContainers=function(e){for(var t=[],i=0;i<e.Insights.length;i++)t.push({Insight:e.Insights[i],Relevance:e.Relevances?e.Relevances[i]:void 0});return t},e})()}));var powerbi;!(function(e){function t(e,t){return new r(e,t)}var i=e.common.contracts.Permissions,o=jsCommon.Utility;e.createInvitationService=t;var r=(function(){function t(e,t){this.promiseFactory=e,this.telemetryService=t}return t.prototype.claimInvite=function(i,r,a,n){var s={invitationId:r,tenantIdentifier:i},c=e.common.httpService.powerbiRequestOptions(n,"ClaimInvite");c.headers["X-PowerBI-RedirectedFromSignup"]="true";var l=o.urlCombine(t.baseDashboardInvitationsUrl,"/invitations/accept");return e.common.httpService.post(l,s,c)},t.prototype.sendInvitation=function(r,a,n,s,c,l,d){var p={emailAddresses:a,objectIds:n,message:s,permission:c?i.ReadReshare:i.Read,notifyViaEmail:l},u=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+r+"/invitations"),v=e.common.httpService.powerbiRequestOptions(d,"SendInvitation");return v.headers["X-PowerBI-WFE-Origin"]=e.common.httpService.frontendUri,e.common.httpService.post(u,p,v)},t.prototype.getInvitedUsers=function(i,r){var a=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+i+"/invitations"),n=e.common.httpService.powerbiRequestOptions(r,"GetInvitedUsers");return e.common.httpService.get(a,n)},t.prototype.getDashboardAccess=function(i,r){var a=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+i+"/access"),n=e.common.httpService.powerbiRequestOptions(r,"GetDashboardAccess");return e.common.httpService.get(a,n)},t.prototype.cancelInvitation=function(i,r,a){var n=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+r+"/invitations/"+i),s=e.common.httpService.powerbiRequestOptions(a,"CancelInvitation");return e.common.httpService.delete(n,s)},t.prototype.deleteUser=function(i,r,a){var n=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+r+"/users/"+i),s=e.common.httpService.powerbiRequestOptions(a,"DeleteUser");return e.common.httpService.delete(n,s)},t.prototype.deleteDashboardAccess=function(i,r){var a=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+i.dashboardId+"/access/"+i.kind+"/"+i.id),n=e.common.httpService.powerbiRequestOptions(r,"DeleteDashboardAccess");return e.common.httpService.delete(a,n)},t.prototype.editDashboardAccess=function(i,r){var a=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+i.dashboardId+"/access"),n=e.common.httpService.powerbiRequestOptions(r,"EditDashboardAccess");return e.common.httpService.put(a,i,n)},t.prototype.requestDashboardAccess=function(i,r,a){var n=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+i+"/requestaccess"),s=e.common.httpService.powerbiRequestOptions(a,"RequestDashboardAccess",{dismissGroupObjectId:!0});return e.common.httpService.put(n,{message:r},s)},t.prototype.deleteDashboardAccessRequest=function(i,r,a,n){var s=o.urlCombine(t.baseDashboardInvitationsUrl,"/"+i+"/requestaccess/"+r+"/"+a),c=e.common.httpService.powerbiRequestOptions(n,"DeleteDashboardAccessRequest");return e.common.httpService.delete(s,c)},t.prototype.getDashboardInviteLink=function(e,i){var o={code:e,tenantId:window.tenantId,extShare:i},r=btoa(JSON.stringify(o));return window.baseUrl+"/"+t.claimInvitePage+"?i="+r},t.prototype.getSharedDashboardLink=function(e,i){if(i){var o={dashboardId:e,tenantId:window.tenantId,extShare:!0},r=btoa(JSON.stringify(o));return window.baseUrl+"/"+t.claimInvitePage+"?i="+r}return window.baseUrl+"/groups/me/dashboards/"+e},t})();r.baseUrl="powerbi/invitation",r.baseDashboardInvitationsUrl=o.urlCombine(r.baseUrl,"/dashboards"),r.claimInvitePage="claiminvite.html"})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(t){var i={};return e.common.httpService.get(t,i)}t.showNpsDialog=i})(t=e.npsHttpService||(e.npsHttpService={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new o}var i=jsCommon.Utility;e.createO365ApplicationLauncherService=t;var o=(function(){function t(){}return t.prototype.getApplicationLauncher=function(){var t="/metadata/office365shell/";t=i.urlCombine(t,"?locale="+e.common.localization.loader.currentLanguageLocale);var o=e.common.httpService.powerbiRequestOptions();return e.common.httpService.get(t,o)},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"GetDelayedQueryResult");return e.common.httpService.get("explore/queryresult/"+t,o)}t.getQueryData=i})(t=e.queryService||(e.queryService={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,s,l,d){return new c(e,t,i,o,r,a,n,s,l,d)}var i=e.common.contracts.admsGateway.DatabaseType,o=e.common.contracts.gateway.GatewayStatus,r=e.connectivity.helpers.ErrorConverterHelper,a=e.common.helpers.ModelConverterHelper,n=e.explore.util.ScriptVisualsUtil,s="RefreshingData";
e.createRefreshService=t;var c=(function(){function t(e,t,i,o,r,a,n,s,c,l){this.modelHttpService=e,this.datasetsService=t,this.gatewaysMetadataService=r,this.rootScope=i,this.notificationToastService=o,this.featureSwitchService=a,this.promiseFactory=n,this.selectGatewayService=s,this.localizationService=c,this.modalDialogService=l}return t.prototype.handleRefreshError=function(t,i,o,r){var a=o.headers(e.common.PowerBIErrorHeader);a&&a===e.common.constants.serverErrors.packageOperationInProgress?this.displayOopsErrorAndEndTelemetry(t,i,"PackageOperationBlocked",o,r):a&&a===e.common.constants.serverErrors.dataRefreshTooSoon?this.displayOopsErrorAndEndTelemetry(t,i,"DataRefreshBlocked",o,r):this.displayOopsErrorAndEndTelemetry(t,i,"PackageRefreshUnknownFailure",o,r)},t.prototype.refreshNow=function(t,i,o,r,a,n,c,l,d){var p,u=this,v=t.startEvent(e.telemetry.DashboardDatasetRefresh,r);p=this.notificationToastService.notify({title:e.common.localize.get(a?a:s),message:n?e.common.localize.get(n):void 0,notificationType:e.common.NotificationToastType.Loading}),this.refreshPackage(o,v.event).then((function(t){u.notificationToastService.hide(p),c&&u.notificationToastService.notify({title:e.common.localize.get(c),message:e.common.localize.format(l,[d]),notificationType:e.common.NotificationToastType.Success}),v.resolve()}),(function(e){u.notificationToastService.hide(p),u.handleRefreshError(t,i,e,v)}))},t.prototype.tryRefreshDMNow=function(e,t,i,o,r,n,s,c){this.tryRefreshDMNowImpl(e,t,a.shouldUseDMTS(i.data.refreshConnections,null),o,r,n,s,c)},t.prototype.tryRefreshDMNowImpl=function(t,i,o,r,s,c,l,d){var p=this,u=t.startEvent(e.telemetry.DashboardGetAggregatedDatasourcesForOneModel,r.contentProviderId);if(o)if(s)if(null!=c){var v=this.promiseFactory,h=this,g=a.getEffectiveDatasourcesFromDiscoverDatasourceResponse(s,c),m=_.map(g,(function(e){return p.gatewaysMetadataService.getDataSourceStatus(e.gatewayId,e.dataSourceId)}));v.all(m).then((function(){u.resolve(),h.refreshNow(t,i,r.packageId,r.contentProviderId)}),(function(o){h.rootScope.$emit(e.common.constants.showSettingsViewerEventName,d,r.dbName);var a="SettingsDataset_Error_CannotRefreshTitle",n=e.common.localize.get("ServerError_PersonalGateway_LongMessage_DataSource_InvalidCredential");h.displayCustomizedErrorAndEndTelemetry(t,i,null,n,a,u,e.telemetry.ErrorSource.User,o)}))}else 0===s.datasources.length&&0===s.gateways.length&&(u.resolve(),this.refreshNow(t,i,r.packageId,r.contentProviderId));else this.gatewaysMetadataService.displayOopsErrorAndEndTelemetry(t,i,"SettingsDataset_Error_FailedToLoadDatasources",u);else this.gatewaysMetadataService.getAdmsAggregatedDatasourcesForOneModel(r.id.toString(),!0).then((function(e){if(p.notificationToastService.hide(l),e){if(p.isRequireUserConsent(e))return void n.confirmRefreshForRDataSource(i,p.localizationService,p.modalDialogService,p.rootScope.$new(),(function(){p.refreshNowADMS(t,i,r,d,e,u)}),(function(){}));p.refreshNowADMS(t,i,r,d,e,u)}else p.gatewaysMetadataService.displayOopsErrorAndEndTelemetry(t,i,"SettingsDataset_Error_FailedToLoadDatasources",u)}),(function(e){p.notificationToastService.hide(l),p.displayOopsErrorAndEndTelemetry(t,i,"SettingsDataset_Error_FailedToLoadDatasources",e,u)}))},t.prototype.tryRefreshNow=function(t,i,o,r){var a=this,n=t.startEvent(e.telemetry.DashboardPrepareRefreshNow,o.contentProviderId),s=this.notificationToastService.notify({title:e.common.localize.get("PreparingForRefresh"),notificationType:e.common.NotificationToastType.Loading});this.modelHttpService.getModelAndPackageForRefresh(o.id,o.packageId,n.event).then((function(c){n.resolve(),c.data&&c.data.packageId?a.isModelRefreshInProgress(c.data)?(a.notificationToastService.hide(s),a.displayCustomizedErrorAndEndTelemetry(t,i,"SettingsDataset_RefreshNow_Popup_RefreshInProgress",null,"SettingsDataset_RefreshNow_Popup_RefreshInProgressTitle",n,e.telemetry.ErrorSource.User,c)):c.data.isAllDataSourcesSupportedForRefresh===!0?a.isPackageImportedFromOneDrive(c.data)?(a.notificationToastService.hide(s),a.tryRefreshNonDMNow(t,i,c,o,r)):a.gatewaysMetadataService.getModelDataSources(o.id).then((function(n){if(0===n.gateways.length&&0===n.datasources.length)return void(!c.data.isHidden&&e.common.helpers.ModelConverterHelper.onpremGatewayRequired(c.data)?a.tryRetrieveGatewayAndRefreshDMNow(t,i,c,o,n,s,r):a.tryRefreshDMNow(t,i,c,o,n,null,s,r));var l=a.selectGatewayService.getSelectedGateway(n),d=a.selectGatewayService.getSelectedGatewayType(l);switch(d){case 0:i.error(e.common.localize.get("SettingsDataset_Error_DatasetNotBoundToAnyGateway"),"SettingsDataset_Error_DatasetNotBoundToAnyGateway");break;case 1:!c.data.isHidden&&e.common.helpers.ModelConverterHelper.onpremGatewayRequired(c.data)?a.tryRetrieveGatewayAndRefreshDMNow(t,i,c,o,n,s,r):a.tryRefreshDMNow(t,i,c,o,n,l.gatewayId,s,r);break;case 2:a.refreshNow(t,i,o.packageId,o.contentProviderId)}}),(function(n){return n.error&&n.error.code===e.settings.constants.ServerError_ModelHasNoPowerBIDMMoniker?void(!c.data.isHidden&&e.common.helpers.ModelConverterHelper.onpremGatewayRequired(c.data)?a.tryRetrieveGatewayAndRefreshDMNow(t,i,c,o,null,s,r):a.tryRefreshDMNow(t,i,c,o,null,null,s,r)):void i.error(e.common.localize.get("SettingsDataset_Error_FailedToDiscoverDatasource"),"SettingsDataset_Error_FailedToDiscoverDatasource",{requestId:n.requestId,statusCode:n.status.toString()})})):(a.notificationToastService.hide(s),a.tryRefreshNonDMNow(t,i,c,o,r)):(a.notificationToastService.hide(s),t.logEvent(e.telemetry.DashboardRefreshNowFailedToRetrieveModel,o.contentProviderId),a.showRefreshNowNotification(!1,o))}),(function(e){a.notificationToastService.hide(s),a.displayOopsErrorAndEndTelemetry(t,i,"SettingsDataset_Error_FailedToLoadModelForRefresh",e,n)}))},t.prototype.tryRetrieveGatewayAndRefreshDMNow=function(t,i,r,n,s,c,l){var d=this,p=t.startEvent(e.telemetry.DashboardRetrieveGateway,n.contentProviderId);this.gatewaysMetadataService.getPersonalGateway().then((function(u){return u.gatewayStatus===o.NotReachable?(d.rootScope.$emit(e.common.constants.showSettingsViewerEventName,l,n.dbName),void d.displayCustomizedErrorAndEndTelemetry(t,i,"SettingsDataset_Error_GatewayOffline",null,"SettingsDataset_Error_GatewayOfflineTitle",p,e.telemetry.ErrorSource.External)):u.gatewayStatus===o.NotInstalled?(d.rootScope.$emit(e.common.constants.showSettingsViewerEventName,l,n.dbName),void d.displayCustomizedErrorAndEndTelemetry(t,i,"SettingsDataset_Error_GatewayNotExist",null,"SettingsDataset_Error_GatewayNotExistTitle",p,e.telemetry.ErrorSource.External)):void d.tryRefreshDMNowImpl(t,i,a.shouldUseDMTS(r.data.refreshConnections,u),n,s,u.gatewayId,c,l)}),(function(e){d.notificationToastService.hide(c),d.displayOopsErrorAndEndTelemetry(t,i,"SettingsDataset_Error_FailedToRetrieveGateway",e,p)}))},t.prototype.tryRefreshNonDMNow=function(t,i,o,r,a){var n=o.data.contentProviderId;6===n||7===n||9===n||60===n||o.data.directQueryMode?this.refreshNow(t,i,r.packageId,r.contentProviderId):this.rootScope.$emit(e.common.constants.showSettingsViewerEventName,a,r.dbName)},t.prototype.displayOopsErrorAndEndTelemetry=function(t,i,o,r,a){a.reject(),i.error(e.common.localize.get(o),o,{requestId:r.requestId,statusCode:r.status.toString()})},t.prototype.refreshPackage=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"RefreshPackage");return o.retryCount=0,e.common.httpService.post("powerbi/content/packages/"+t+"/refresh/",null,o)},t.prototype.getGatewayStatus=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"GetGatewayStatus");return e.common.httpService.get("powerbi/dmm/subscribe/"+t,o)},t.prototype.updateRefreshSchedule=function(t,i,o){var r=e.common.httpService.powerbiRequestOptions(o,"UpdateRefreshSchedule");return r.retryCount=0,e.common.httpService.post("powerbi/metadata/models/"+t+"/refreshschedule",i,r)},t.prototype.showRefreshNowNotification=function(t,i){var o=t?i.name+e.common.localize.get("SettingsDataset_Notification_RefreshNow_Scheduled_Title"):i.name+e.common.localize.get("SettingsDataset_Notification_RefreshNow_NotScheduled_Title"),r=t?i.name+e.common.localize.get("SettingsDataset_Notification_RefreshNow_Scheduled_Message"):e.common.localize.get("SettingsDataset_Notification_RefreshNow_NotScheduled_Message_Part1")+i.name+e.common.localize.get("SettingsDataset_Notification_RefreshNow_NotScheduled_Message_Part2");this.notificationToastService.notify({title:o,message:r})},t.prototype.displayCustomizedErrorAndEndTelemetry=function(t,i,o,r,a,n,s,c){n.reject();var l={requestId:c?c.requestId:void 0,statusCode:c?c.status.toString():void 0,title:e.common.localize.get(a)};i.error(o?e.common.localize.get(o):r,o,l,!1,s)},t.prototype.isPackageImportedFromOneDrive=function(e){return e.packageVersion.length>10&&(6===e.contentProviderId||7===e.contentProviderId||60===e.contentProviderId)},t.prototype.isModelRefreshInProgress=function(e){var t=e.currentRefreshStartingTime&&a.convertRefreshTimeToJsDateTime(e.currentRefreshStartingTime);return t&&t.getTime()+18e5>Date.now()},t.prototype.isRequireUserConsent=function(t){return t&&_.some(t,(function(t){return t.discoverDataSourceEntry.databaseType.toString()===i.Extension.toString()&&t.discoverDataSourceEntry.extensionDatabaseType===e.common.constants.RDataSourceName}))},t.prototype.refreshNowADMS=function(t,i,o,a,n,s){s.resolve();for(var c=!0,l=0;l<n.length;l++)if(!n[l].testConnectionResponse||n[l].testConnectionResponse.instanceTestConnectionResults.testPassed===!1){c=!1,this.rootScope.$emit(e.common.constants.showSettingsViewerEventName,a,o.dbName);var d="SettingsDataset_Error_CannotRefreshTitle",p=r.convertADMSTestConnectionResultToErrorMessage(n[l].testConnectionResponse);this.displayCustomizedErrorAndEndTelemetry(t,i,null,p,d,s,e.telemetry.ErrorSource.PowerBI);break}c&&this.refreshNow(t,i,o.packageId,o.contentProviderId)},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new i}e.createRealTimeDataHttpService=t;var i=(function(){function t(){}return t.prototype.createDataset=function(t){var i=e.common.httpService.powerbiRequestOptions(null,"Create Real Time Dataset");return e.common.httpService.post("realtime/models",t,i)},t.prototype.getCredentials=function(t){var i=e.common.httpService.powerbiRequestOptions(null,"Get Real Time Dataset External Credentials");return e.common.httpService.get("realtime/models/"+t+"/credentials",i)},t.prototype.getDataset=function(t){var i=e.common.httpService.powerbiRequestOptions(null,"Get Real Time Dataset");return e.common.httpService.get("realtime/models/"+t,i)},t.prototype.getHistory=function(t){var i=e.common.httpService.powerbiRequestOptions(null,"Get History");return e.common.httpService.post("realtime/history",t,i)},t.prototype.updateDataset=function(t,i){var o=e.common.httpService.powerbiRequestOptions(null,"Update Real Time Dataset");return e.common.httpService.put("realtime/models/"+t,i,o)},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new i}e.createSettingsMetadataHttpService=t;var i=(function(){function t(){}return t.prototype.getSettings=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetSettingsMetadata");return i.enableTelemetry=!0,e.common.httpService.get("/powerbi/metadata/settings",i)},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t){return new o(e,t)}var i=jsCommon.StringExtensions;e.createSubscriptionsHttpService=t;var o=(function(){function t(t,i){this.httpService=e.common.httpService,this.promiseFactory=t,this.telemetryService=i,this.endpoint="metadata/emailsubscriptions"}return t.prototype.createSubscription=function(t,i){var o=this,r=this.promiseFactory.defer(),a=this.telemetryService.startChildEvent(i,e.telemetry.EmailSubscriptionsRequest,e.telemetry.EmailSubscriptionRequestType.Create);return this.httpService.post(this.endpoint,t,this.httpService.powerbiRequestOptions()).then((function(e){a.resolve(),r.resolve(e.data)}),(function(t){var i=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);a.reject(i);var n=o.getErrorCode(t);r.reject({ErrorCode:n,RequestId:t.requestId})})),r.promise},t.prototype.getAllSubscriptions=function(t){var i=this,o=this.promiseFactory.defer(),r=this.telemetryService.startChildEvent(t,e.telemetry.EmailSubscriptionsRequest,e.telemetry.EmailSubscriptionRequestType.Get);return this.httpService.get(this.endpoint,this.httpService.powerbiRequestOptions()).then((function(e){r.resolve(),o.resolve(e.data)}),(function(t){var a=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);r.reject(a);var n=i.getErrorCode(t);o.reject({ErrorCode:n,RequestId:t.requestId})})),o.promise},t.prototype.updateSubscription=function(t,i){var o=this,r=this.promiseFactory.defer(),a=this.telemetryService.startChildEvent(i,e.telemetry.EmailSubscriptionsRequest,e.telemetry.EmailSubscriptionRequestType.Update);return this.httpService.put(this.endpoint,t,this.httpService.powerbiRequestOptions()).then((function(e){a.resolve(),r.resolve(e.data)}),(function(t){var i=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);a.reject(i);var n=o.getErrorCode(t);r.reject({ErrorCode:n,RequestId:t.requestId})})),r.promise},t.prototype.deleteSubscription=function(t,o){var r=this,a=this.promiseFactory.defer(),n=this.telemetryService.startChildEvent(o,e.telemetry.EmailSubscriptionsRequest,e.telemetry.EmailSubscriptionRequestType.Delete),s=this.endpoint+"/{0}";return this.httpService.delete(i.format(s,t.toString()),this.httpService.powerbiRequestOptions()).then((function(e){n.resolve(),a.resolve(e.data)}),(function(t){var i=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);n.reject(i);var o=r.getErrorCode(t);a.reject({ErrorCode:o,RequestId:t.requestId})})),a.promise},t.prototype.getReportSubscription=function(t,o){var r=this,a=this.promiseFactory.defer(),n="metadata/emailsubscriptions/report/{0}",s=this.telemetryService.startChildEvent(o,e.telemetry.EmailSubscriptionsRequest,e.telemetry.EmailSubscriptionRequestType.Get);return this.httpService.get(i.format(n,t.toString()),this.httpService.powerbiRequestOptions()).then((function(e){s.resolve(),a.resolve(e.data)}),(function(t){var i=e.errorDetailsHelper.getTelemetryErrorDetails(t.error);s.reject(i);var o=r.getErrorCode(t);a.reject({ErrorCode:o,RequestId:t.requestId})})),a.promise},t.prototype.getDashboardSubscription=function(t,o){return __awaiter(this,void 0,e.Promise,(function(){var r,a,n,s,c,l,d;return __generator(this,(function(p){switch(p.label){case 0:r=this.promiseFactory.defer(),a="metadata/emailsubscriptions/dashboard/{0}",n=this.telemetryService.startChildEvent(o,e.telemetry.EmailSubscriptionsRequest,e.telemetry.EmailSubscriptionRequestType.Get),p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.httpService.get(i.format(a,t.toString()),this.httpService.powerbiRequestOptions())];case 2:return s=p.sent(),n.resolve(),r.resolve(s.data),[3,4];case 3:return c=p.sent(),l=e.errorDetailsHelper.getTelemetryErrorDetails(c.error),n.reject(l),d=this.getErrorCode(c),r.reject({ErrorCode:d,RequestId:c.requestId}),[3,4];case 4:return[2,r.promise]}}))}))},t.prototype.getErrorCode=function(e){var t=void 0;return e&&(e.error?t=e.error.code:e.status&&(t=e.status.toString())),t},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new i}e.createUserSettingsHttpService=t;var i=(function(){function t(){}return t.prototype.getUserSettings=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetUserSettings");return i.enableTelemetry=!0,e.common.httpService.get("/powerbi/metadata/userSettings",i)},t.prototype.updateAllowQnaDataCollection=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"UpdateAllowQnaDataCollection",{dismissGroupObjectId:!0});return o.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/userSettings/allowQnaDataCollection",JSON.stringify(t),o)},t.prototype.updateExtendedSettings=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"UpdateUserExtendedSettings");return o.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/userSettings/extendedSettings",JSON.stringify(t),o)},t.prototype.updateUserSettings=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"UpdateUserSettings",{dismissGroupObjectId:!0});return o.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/userSettings/updateUserSettings",JSON.stringify(t),o)},t.prototype.sendEmailForDownloadPowerBI=function(i,o){var r=e.common.httpService.powerbiRequestOptions(o,"SendEmailForDownloadPowerBI");return r.enableTelemetry=!0,e.common.httpService.post(t.PowerBIDownloadUrl,{email:i},r)},t})();i.PowerBIDownloadUrl="https://powerbi.microsoft.com/submitemail"})(powerbi||(powerbi={})),define("powerBI/proxies/publishAppHttp",["require","exports"],(function(e,t){"use strict";function i(){return new s}var o=powerbi.helpers.PublishAppHelper,r=jsCommon.Utility,a="/powerbi/content/providers/organization/",n="/powerbi/content/providers/organizationaltemplate/";t.create=i;var s=(function(){function e(){}return e.prototype.publishApp=function(e,t,i){var r=common.httpService,a=r.powerbiRequestOptions(e,"PublishApp"),n=o.createPublishOrUpdateAppModelRequest(t,i);return r.post(this.getUrlPrefix(t),n,a)},e.prototype.updateApp=function(e,t,i){var a=common.httpService,n=a.powerbiRequestOptions(e,"UpdateApp"),s=o.createPublishOrUpdateAppModelRequest(t,i);return a.put(r.urlCombine(this.getUrlPrefix(t),t.objectId)+"/",s,n)},e.prototype.deleteApp=function(e,t){var i=common.httpService.powerbiRequestOptions(e,"DeletePublishedApp");return i.enableTelemetry=!0,common.httpService.delete("/powerbi/content/providers/organization/"+t+"/",i)},e.prototype.getUrlPrefix=function(e){return e.publishAsTemplate?n:a},e})()}));var powerbi;!(function(e){function t(e,t){return new i(e,t)}e.createConceptualModelSetting=t;var i=(function(){function t(e,t){this.featureSwitchService=e,this.tutorialDataStore=t}return t.prototype.isPreviewEnabled=function(){return this.featureSwitchService.featureSwitches.conceptualModelEnabled||this.featureSwitchService.featureSwitches.previewConceptualModel&&this.tutorialDataStore.hasKey(e.common.constants.previewConceptualModelNewKey)},t.prototype.isListViewEnabled=function(){return this.featureSwitchService.featureSwitches.listViewEnabled&&this.isPreviewEnabled()},t.prototype.isAppsEnabled=function(){return this.featureSwitchService.featureSwitches.appsEnabled&&this.isListViewEnabled()},t.prototype.isTemplateAppsEnabled=function(){return this.featureSwitchService.featureSwitches.appTemplatesEnabled&&this.isAppsEnabled()},t.prototype.isServiceAppsEnabled=function(){return this.featureSwitchService.featureSwitches.serviceAppsEnabled&&this.isAppsEnabled()},t})();e.ConceptualModelSetting=i})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D){return new s(t,e,i,o,r,a,n,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D)}var i=e.common.contracts.ContentProviderCategory,o=e.dataServices.models.ContentPackItems,r=e.dialogs.MakeACopyDialogBuilder,a=e.common.dialog.MessageDialogBuilder,n=e.dialogs.ProgressDialogBuilder;e.createContentPackService=t;var s=(function(){function t(t,i,o,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M){var k=this;this.appService=t,this.rootScope=i,this.errorService=o,this.telemetryService=s,this.modelConverter=c,this.syncService=l,this.contentProviderHttpService=d,this.localizationService=p,this.navigation=u,this.dashboardService=v,this.featureSwitchService=h,this.userInfo=g,this.lazy=m,this.notificationToast=f,this.reportService=y,this.modelService=b,this.permissionService=S,this.workbookService=w,this.promiseFactory=C,this.quota=D,this.modalDialogService=I,this.groupService=T,this.licenseEnforcementService=M,this.requests={},this.contentPacksDirtyStates={},this.makeACopyDialogBuilder=new r(I),this.progressDialogBuilder=new n(I,C),this.messageDialogBuilder=new a(I),this.syncService.addContentPackRefreshListener(this),this.rootScope.$on(e.constants.dashboardContainerLoaded,(function(){k.loadContentPacks()})),this.groupService.addGroupChangedHandler(this),this.rootScope.$on(e.constants.contentPackDirtyShowNotification,(function(e,t,i){return k.notifyIfDirty(t,i)})),this.rootScope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,t,i,o,r){k.contentPacksDirtyStates={}}))}return t.prototype.isApp=function(e){var t=e.category;return t===i.OrganizationalApp||t===i.OrganizationalTemplateApp},t.prototype.onContentPackDeleted=function(e){this.currentGroupCPs&&_.remove(this.currentGroupCPs.contentPacks,(function(t){return t.providerId===e}))},t.prototype.getContentPacksForCurrentGroup=function(){var e=this.getActiveGroupGUID();return e?this.currentGroupCPs&&this.currentGroupCPs.groupGUID===e?this.promiseFactory.resolve(this.currentGroupCPs.contentPacks):this.loadContentPacks():this.promiseFactory.reject()},t.prototype.userHasLicenseForCreateOrgApp=function(){return this.licenseEnforcementService.supportsOrgApps()},t.prototype.displayLicenseErrorDialog=function(t){var i=this,o=t?e.telemetry.LicenseEnforcementOperation.ConnectApps:e.telemetry.LicenseEnforcementOperation.ConnectContentPacks,r=t?"UpgradeAccount_ConnectAppMessage":"UpgradeAccount_ConnectContentMessage",a=t?"UpgradeAccount_ConnectAppTitle":"UpgradeAccount_ConnectContentTitle";this.lazy("licenseHelper").then((function(t){return t.displayFeatureDisabledErrorMessage(o,i.localizationService.format(r,[""+e.common.constants.FreeTrialPeriod]),i.localizationService.get(a))}))},t.prototype.setContentPackCleanForSession=function(e){if(this.currentGroupCPs){var t=this.currentGroupCPs.contentPacks,i=_.find(t,(function(t){return t.providerContract.providerKey===e}));i&&(i.providerContract.isDirty=!1)}},t.prototype.showDialogOnModelDeleteInContentPack=function(e){var t=_.find(this.currentGroupCPs.contentPacks,(function(t){return _.contains(t.modelIds,e)}));t&&this.showDeleteArtifactInContentPack(t,"Model_DeleteConfirmationTitle","Model_DeleteCheckMessageApps","Model_DeleteCheckMessage","ModelDeleteInOrgProvider")},t.prototype.showDialogOnWorkbookRemoveInContentPack=function(e){var t=_.find(this.currentGroupCPs.contentPacks,(function(t){return _.contains(t.workbookIds,e)}));t&&this.showDeleteArtifactInContentPack(t,"Workbook_RemoveConfirmationTitle","Workbook_RemoveCheckMessageApps","Workbook_RemoveCheckMessage","WorkbookDeleteInOrgProvider")},t.prototype.deleteContentPack=function(e){var t=this,i=this.promiseFactory.defer(),o=this.localizationService;return this.messageDialogBuilder.show("DeleteInContentPack",{messageText:o.get("ContentPackDelete_Message"),titleText:o.get("ContentPack_DeleteConfirmationTitle"),okButtonText:o.get("ModalDialogButtonText_Delete"),cancelButtonText:o.get("PBI_Button_Label_Cancel")}).then((function(o){0===o?(t.deleteContentPackRequest(e).then((function(e){return i.resolve(!0)}),(function(e){return i.reject()})),t.currentGroupCPs&&!_.isEmpty(t.currentGroupCPs.contentPacks)||t.navigation.navigateToContentListOrActiveDashboard()):i.resolve(!1)}),(function(){return i.reject()})),i.promise},t.prototype.onPersonalizeContentPack=function(t){var i=this;if(!this.appService.getAppInstance(t)){if(!this.userHasLicenseForCreateOrgApp())return void this.displayLicenseErrorDialog(!1);var o=e.telemetry.QuotaCheckOperation.PersonalizeContentPack;this.quota.checkQuotaExceeded(o)||this.showMakeACopyDialog(t).then((function(o){if(0===o){var r=i.progressDialogBuilder.show("PersonalizeOrgAppProgress","MakeACopy_ProgressDialogTitle","MakeACopy_ProgressDialogDescription"),a=i.telemetryService.startEvent(e.telemetry.DashboardContentPackPersonalize);e.contentPackService.personalize(t,a.event).then((function(e){a.resolve(),i.navigation.navigateToContentListOrActiveDashboard()}),(function(t){a.reject(e.errorDetailsHelper.getTelemetryErrorDetails(t.error,t.status)),i.errorService.error(i.localizationService.get("PublishContentPack_PersonalizationFailed_Desc"),"",{requestId:t.requestId,statusCode:t.status.toString(),activityId:t.activityId})})).finally((function(){return r.then((function(){return i.progressDialogBuilder.hide()}))}))}}))}},t.prototype.showDeleteArtifactInContentPack=function(e,t,i,o,r){var a=this,n=this.localizationService,s=this.isApp(e),c=s?i:o,l=s?"PBI_Button_Label_OK":"Publish_ViewContentPacks",d="PBI_Button_Label_Cancel",p=this.messageDialogBuilder.show(r,{messageText:n.get(c),titleText:n.get(t),okButtonText:n.get(l),cancelButtonText:n.get(d),hideCancelButton:s});s||p.then((function(e){0===e&&a.navigation.showViewContentPackSlider()}))},t.prototype.showMakeACopyDialog=function(e){var t=this.dashboardService.findDashboardsByPackageId(e),i=this.modelService.findModelsByPackageId(e),o=this.reportService.findReportsByPackageId(e),r="PublishContentPack_PersonalizeTitle",a="PublishContentPack_PersonalizeDescription",n="PersonalizeContentPack";return this.makeACopyDialogBuilder.show(n,r,a,"PersonalizeOrgApp_PersonalizeDescriptionItemIntro",t,o,i)},t.prototype.resetContentPackUsageFlags=function(){var e=this.dashboardService.dashboardContainerModel.dashboards;if(e)for(var t=0,i=e;t<i.length;t++){var o=i[t];o&&(o.isUsedByContentPack=!1)}var r=this.reportService.reports;if(r)for(var a=0,n=r;a<n.length;a++){var s=n[a];s&&(s.isUsedByContentPack=!1)}var c=this.modelService.models;if(c)for(var l=0,d=c;l<d.length;l++){var p=d[l];p&&(p.isUsedByContentPack=!1)}var u=this.workbookService.workbooks;if(u)for(var v=0,h=u;v<h.length;v++){var g=h[v];g&&(g.isUsedByContentPack=!1)}},t.prototype.deleteContentPackRequest=function(t){var i=this,o=this.promiseFactory.defer();return this.findContentPackByGUID(t).then((function(r){if(r){var a=i.telemetryService.startEvent(e.telemetry.DashboardDeleteContentPack,r.isSharedToEntireOrg,r.dashboardIds.length,r.reportIds.length,r.modelIds.length,r.workbookIds.length,r.listOfGroupPrincipals.length);i.removeContentPacks([r.providerId]),e.contentPackService.deleteContentPack(t,a.event).then((function(e){a.resolve(),i.markItemsUsedByContentPack(),o.resolve(null)}),(function(e){a.reject(),i.addContentPack(r),i.errorService.error(i.localizationService.get("ContentPack_Delete_FailedMessage"),"",{requestId:e.requestId,statusCode:e.status.toString(),activityId:e.activityId}),o.reject()}))}else i.notificationToast.notify({title:i.localizationService.get("ContentPack_Delete_Failed_Title"),message:i.localizationService.get("ContentPack_Delete_FailedMessage"),notificationType:e.common.NotificationToastType.Error}),o.reject()}),(function(e){return o.reject()})),o.promise},t.prototype.addContentPack=function(t){var i=this.getActiveGroupGUID();if(i){this.currentGroupCPs||(this.currentGroupCPs={groupGUID:i,contentPacks:[]});var o=this.currentGroupCPs.contentPacks;if(t){var r=_.find(o,(function(e){return e.providerId===t.providerId}));r?e.helpers.ContentPackAuthoringHelper.updateContentPack(r,t):o.push(t)}}},t.prototype.findContentPack=function(e){var t=this.promiseFactory.defer();return _.isNaN(e)&&t.resolve(void 0),this.getContentPacksForCurrentGroup().then((function(i){var o=_.find(i,(function(t){return t.providerId===e}));t.resolve(o)}),(function(){return t.resolve(void 0)})),t.promise},t.prototype.findContentPackByGUID=function(e){var t=this.promiseFactory.defer();return null==e&&t.resolve(void 0),this.getContentPacksForCurrentGroup().then((function(i){var o=_.find(i,(function(t){return t.providerContract.providerKey===e}));t.resolve(o)}),(function(){return t.resolve(void 0)})),t.promise},t.prototype.removeContentPacks=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t];this.onContentPackDeleted(o)}},t.prototype.onGroupChanged=function(){this.currentGroupCPs=null,this.loadContentPacks()},t.prototype.loadContentPacks=function(){var t=this;if(!this.featureSwitchService.featureSwitches.orgAppsEnabled&&!this.userHasLicenseForCreateOrgApp()||this.permissionService.isActiveWorkspaceIsReadOnly)return this.promiseFactory.reject();var i=this.groupService.activeGroup&&this.groupService.activeGroup.aadGroupId;if(!i)return this.promiseFactory.reject();var o=this.requests[i];if(o)return o.promise;var r=this.requests[i]=this.promiseFactory.defer(),a=this.telemetryService.startEvent(e.telemetry.DashboardViewContentPacks);return this.contentProviderHttpService.getOrganizationalContentProviders(a.event).then((function(e){a.resolve();for(var o=[],n=0,s=e.data;n<s.length;n++){var c=s[n];o.push(t.modelConverter.convertContentPack(c))}i===t.groupService.activeGroup.aadGroupId&&(t.currentGroupCPs={groupGUID:i,contentPacks:o},t.markItemsUsedByContentPack()),r.resolve(o)}),(function(e){a.reject(),r.reject()})).finally((function(){delete t.requests[i]})),r.promise},t.prototype.markItemsUsedByContentPack=function(){var e=this;if(this.resetContentPackUsageFlags(),this.currentGroupCPs&&!_.isEmpty(this.currentGroupCPs.contentPacks))for(var t=0,i=this.currentGroupCPs.contentPacks;t<i.length;t++){var o=i[t];o.dashboardIds.forEach((function(t){var i=e.dashboardService.findDashboard(t);i&&(i.isUsedByContentPack=!0)})),o.reportIds.forEach((function(t){var i=e.reportService.findReport(t);i&&(i.isUsedByContentPack=!0)})),o.modelIds.forEach((function(t){var i=e.modelService.findModel(t);i&&(i.isUsedByContentPack=!0)})),o.workbookIds.forEach((function(t){var i=e.workbookService.findWorkbook(t);i&&(i.isUsedByContentPack=!0)}))}},t.prototype.notifyIfDirty=function(e,t){if(this.currentGroupCPs&&!_.isEmpty(this.currentGroupCPs.contentPacks)){var i=[],r=this.currentGroupCPs.contentPacks,a={isApp:!1,isContentPack:!1};switch(t){case o.Dashboard:for(var n=0,s=r;n<s.length;n++){var c=s[n];this.dirtyCheck(c.dashboardIds,e,i,c,a)}break;case o.Report:for(var l=0,d=r;l<d.length;l++){var c=d[l];this.dirtyCheck(c.reportIds,e,i,c,a)}break;case o.Model:for(var p=0,u=r;p<u.length;p++){var c=u[p];this.dirtyCheck(c.modelIds,e,i,c,a)}break;case o.Workbook:for(var v=0,h=r;v<h.length;v++){var c=h[v];this.dirtyCheck(c.workbookIds,e,i,c,a)}}this.contentPacksDirtyStates[t]||(this.contentPacksDirtyStates[t]={});var g=this.contentPacksDirtyStates[t];g[e]||(this.showContentPackDirtyNotification(a),g[e]=!0),i.length>0&&this.setContentPackDirty(i)}},t.prototype.dirtyCheck=function(e,t,i,o,r){_.contains(e,t)&&(i.push(o.providerContract.providerKey),o.providerContract.isDirty=!0,this.appService.isAppCategory(o.category)?r.isApp=!0:r.isContentPack=!0)},t.prototype.showContentPackDirtyNotification=function(t){var i=this;if(t.isContentPack){var o={displayText:this.localizationService.get("PublishContentPack_IsDirty_Ok"),action:function(){i.navigation.showViewContentPackSlider()}};this.notificationToast.notify({message:this.localizationService.get("PublishContentPack_Changes"),notificationType:e.common.NotificationToastType.Alert,actionButtons:[o]})}},t.prototype.setContentPackDirty=function(t){var i=this.telemetryService.startEvent(e.telemetry.DashboardContentPackDirty,t.length);e.contentPackService.setContentPackDirty(t,i.event).then((function(e){i.resolve()}),(function(e){i.reject()}))},t.prototype.getActiveGroupGUID=function(){var e=this.groupService.activeGroup,t=e&&e.aadGroupId;if(t)return t},t})();e.ContentPackService=s})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,I,T,M,k,P,E,A,_,R){return new D(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,I,T,M,k,P,E,A,_,R)}function i(e){return e.inContentListView()?s.ContentList:e.inAppsDetailView()?s.OrgApps:e.inFavoritesView()?s.Favorites:e.inRecentlyViewedView()?s.RecentlyUsed:void 0}var o=e.dataServices.models.AppDataset,r=e.dataServices.AppUtils,a=e.common.contracts.Permissions,n=e.common.models.CollapsiblePaneExpandedWidth,s=e.telemetry.ContentListArtifactSource,c=e.telemetry.ContentListArtifactType,l=e.common.contracts.ContentProviderClientCategory,d=e.helpers.ContentTileHelper,p=e.common.contracts.ContentTileType,u=e.dataServices.models.Dashboard,v=jsCommon.EnumExtensions,h=e.models.MRUArtifactType,g=e.models.MRUModel,m=e.dataServices.contracts.PackageType,f=e.common.contracts.Permissions,y=e.common.models.Report,b=e.common.contracts.PublishOrRefreshStatus,S=e.common.constants.TaskPaneCollapsiblePaneMode,w=e.dataServices.models.Workbook,C="packageType";e.createContentListService=t;var D=(function(){
function t(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b,S,w,C,D,I,T,M,k,P,E,A,_){this.telemetryService=e,this.dashboardService=t,this.reportService=i,this.navigation=o,this.modelService=r,this.analyzeInExcel=a,this.workbookService=n,this.contentPackService=s,this.localizationService=c,this.packageService=l,this.errorService=d,this.$rootScope=p,this.modalDialogService=u,this.exportToPowerPointService=v,this.refreshService=h,this.permissionService=g,this.settingsMetadataService=m,this.location=f,this.$window=y,this.favorites=b,this.shareSliderService=S,this.groupService=w,this.appService=C,this.promiseFactory=D,this.mostRecentlyUsedService=I,this.dataServiceModelConverter=T,this.conceptualModelSetting=M,this.dashboardDataService=k,this.taskPaneSliderService=P,this.ownershipService=E,this.usageMetricsReport=A,this.lazyInjector=_}return t.prototype.isVisible=function(e){if(e.isHidden)return!1;switch(e.contentTileType){case p.Report:case p.Workbook:if(!this.canCopyAndEdit(e)||this.usageMetricsReport.contentTileBelongsToUsageMetricsContentPack(e))return!1;break;case p.Dataset:if(!this.modelService.isExplorableNonLegacySampleModel(e)||this.usageMetricsReport.contentTileBelongsToUsageMetricsContentPack(e))return!1}var t=d.getPackageId(e);return!this.conceptualModelSetting.isAppsEnabled()||!this.isAppInstance(t)},t.prototype.isPackageReadyToUse=function(e){var t=d.getPackageId(e);return!_.isNumber(t)||!!this.packageService.findPackage(t)},t.prototype.canCopyAndEdit=function(e){var t=e.getPermissions();return v.hasFlag(t,f.Write)||v.hasFlag(t,f.CopyOnWrite)},t.prototype.isAppInstance=function(e){var t=this.packageService.findPackage(e);return!(!t||t.packageType!==m.AppInstance)&&!!this.appService.getAppInstance(t.id)},t.prototype.tileSelectionOff=function(e){this.shareSliderService.shareDashboard=null;var t=e.objectId,i=this.dashboardService.findDashboardByGUID(t);if(i&&(i.isContentTileSelected=!1),this.navigation.inFavoritesView()){var o=this.favorites.getFavoriteByContentTile(e);o&&(o.isContentTileSelected=!1)}},t.prototype.dashboardsOwnersMergedPromise=function(){return this.dashboardService.dashboardsOwnersMergedPromise()},t.prototype.isFavorite=function(e){var t=d.getActualType(e);if(!d.isFavoritableContentType(t))return!1;var i=this.favorites.getFavoriteByContentTile(e);return!!i},t.prototype.isFavoriteDisabled=function(e){var t=this.dashboardService.findDashboardByGUID(e);return!!t&&(t.isFavoriteDisabled||t.id<0)},t.prototype.identifyAndDeleteContent=function(e){var t=this.getStrategy(e);t&&t.identifyAndDeleteContent(d.getObjectID(e))},t.prototype.deleteContent=function(e,t){var i=this.getStrategy(e);i&&i.deleteContent(d.getObjectID(e),t)},t.prototype.addDashboard=function(e){this.dashboardService.addDashboard(e)},t.prototype.canShowTileOptions=function(e){var t=this.getStrategy(e);return!!t&&t.canShowTileOptions(e)},t.prototype.publishInProgress=function(e){var t=this.getStrategy(e);if(t){var i=t.getModels(e),o=i&&i[0];return!!o&&o.packagePublishStatus===b.PublishInProgress}},t.prototype.canRefreshNow=function(e){var t=this.getStrategy(e);return!!t&&t.canRefreshNow(e)},t.prototype.canScheduleRefresh=function(e){var t=this.getStrategy(e);return!!t&&t.canScheduleRefresh(e)},t.prototype.canReplaceWorkbook=function(e){var t=this.getStrategy(e);return!!t&&t.canReplaceWorkbook(d.getObjectID(e))},t.prototype.shareContent=function(e,t){var i=this.getStrategy(e);i&&i.shareContent(e,t)},t.prototype.addFavorite=function(e,t){return this.groupService.activeGroupObjectId!==t?this.switchGroupThenAddFavorite(e,t):this.addFavoriteInternal(e)},t.prototype.removeFavorite=function(e){this.favorites.deleteFavorite(e)},t.prototype.refreshNow=function(e){var t=this.getStrategy(e);t&&t.refreshNow(e)},t.prototype.scheduleRefresh=function(e){var t=this.getStrategy(e);t&&t.scheduleRefresh(e)},t.prototype.editWorkbook=function(e){var t=this.getStrategy(e);t&&t.editWorkbook(d.getObjectID(e))},t.prototype.replaceWorkbook=function(e){var t=this.getStrategy(e);t&&t.replaceWorkbook(d.getObjectID(e))},t.prototype.exportDashboard=function(e){var t=this.getStrategy(e);t&&t.exportDashboard(d.getObjectID(e))},t.prototype.exportToPowerPoint=function(e){var t=this.getStrategy(e);t&&t.exportReportToPowerPoint(d.getObjectID(e))},t.prototype.getDashboards=function(){return this.dashboardService.getDashboards()},t.prototype.getReports=function(){return this.reportService.getReports()},t.prototype.getWorkbooks=function(){var e=this;return this.workbookService.ensureWorkbookInitialization().then((function(){return e.workbookService.workbooks}))},t.prototype.getDatasets=function(){var e=this;return this.modelService.modelsPromise.then((function(){return e.modelService.models}))},t.prototype.subscribeReports=function(e){var t={onReportAdded:e,onReportDeleted:e,onReportsReset:e};return this.reportService.subscribe(t),t},t.prototype.unsubscribeReports=function(e){this.reportService.unsubscribe(e)},t.prototype.subscribeDashboards=function(e){var t={onDashboardAdded:e,onDashboardDeleted:e,onDashboardsReset:e};return this.dashboardDataService.subscribe(t),t},t.prototype.unsubscribeDashboards=function(e){this.dashboardDataService.unsubscribe(e)},t.prototype.subscribeModels=function(e){var t={onModelAdded:e,onModelDeleted:e,onModelsReset:e};return this.modelService.subscribe(t),t},t.prototype.unsubscribeModels=function(e){this.modelService.unsubscribe(e)},t.prototype.subscribeWorkbooks=function(e){var t={onWorkbookAdded:e,onWorkbookDeleted:e,onWorkbooksReset:e};return this.workbookService.subscribe(t),t},t.prototype.unsubscribeWorkbooks=function(e){this.workbookService.unsubscribe(e)},t.prototype.openContent=function(e,t,i,o){var r=this.getStrategy(e);r&&r.openContent(e,t,i,o)},t.prototype.openUsageMetricsReport=function(e,t,i,o){var r=this.getStrategy(e);r&&r.openUsageMetricsReport(e,t)},t.prototype.showRename=function(e){var t=this.getStrategy(e);t&&t.showRename(d.getObjectID(e))},t.prototype.analyzeContentInExcel=function(e){var t=this.getStrategy(e);t&&t.analyzeContentInExcel(e)},t.prototype.personalizeContent=function(t){var i=this.getStrategy(t);if(i){var o=i.getContentPackageId(t);this.telemetryService.logEvent(e.telemetry.DashboardClickPersonalize,o),this.contentPackService.onPersonalizeContentPack(o)}},t.prototype.getModels=function(e){var t=this.getStrategy(e);if(t)return t.getModels(e)},t.prototype.runInsights=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a,n;return __generator(this,(function(s){switch(s.label){case 0:return(i=this.getStrategy(t))?(o=i.getModels(t),r=o&&o[0],a=t.contentTileType===p.Report?e.insights.constants.insightsSourceReportTile:e.insights.constants.insightsSourceNavigationPane,[4,this.lazyInjector("insightsBootstrap")]):[3,2];case 1:n=s.sent(),n.start(r.dbName,r.vsName,r.packageId,a),s.label=2;case 2:return[2]}}))}))},t.prototype.getStrategy=function(e){var t={navigation:this.navigation,dashboardService:this.dashboardService,reportService:this.reportService,errorService:this.errorService,$rootScope:this.$rootScope,modalDialogService:this.modalDialogService,localizationService:this.localizationService,modelService:this.modelService,analyzeInExcel:this.analyzeInExcel,workbookService:this.workbookService,contentPackService:this.contentPackService,packageService:this.packageService,telemetryService:this.telemetryService,refreshService:this.refreshService,permissionService:this.permissionService,settingsMetadataService:this.settingsMetadataService,location:this.location,$window:this.$window,favorites:this.favorites,exportToPowerPoint:this.exportToPowerPointService,shareSliderService:this.shareSliderService,groupService:this.groupService,promiseFactory:this.promiseFactory,appService:this.appService,mostRecentlyUsedService:this.mostRecentlyUsedService,dataServiceModelConverter:this.dataServiceModelConverter,conceptualModelSetting:this.conceptualModelSetting,taskPaneSliderService:this.taskPaneSliderService,ownershipService:this.ownershipService,usageMetricsReport:this.usageMetricsReport,lazy:this.lazyInjector};switch(e.contentTileType){case p.Dashboard:return new T(t);case p.Favorite:return new k(t);case p.Report:return new M(t);case p.Workbook:return new P(t);case p.OrgApp:return new E(t);case p.AppDataset:return new A(t);case p.MRU:return new R(t);case p.AppPlaceHolder:return new x(t)}},t.prototype.switchGroupThenAddFavorite=function(t,i){var o=this,r=this.groupService.getGroup(i),a=this.telemetryService.startEvent(e.telemetry.GroupsSwitchGroup,i);return this.groupService.switchGroup(r,!1,a).then((function(){return o.addFavoriteInternal(t)}))},t.prototype.addFavoriteInternal=function(e){return this.favorites.addFavorite(e)},t})();e.ContentListService=D;var I=(function(){function e(e){e.conceptualModelSetting.isAppsEnabled(),this.services=e}return e.prototype.openContent=function(e,t){},e.prototype.openUsageMetricsReport=function(e,t){},e.prototype.deleteContent=function(e,t){},e.prototype.shareContent=function(e,t){},e.prototype.showRename=function(e){},e.prototype.identifyAndDeleteContent=function(e){},e.prototype.getContentPackageId=function(e){return null},e.prototype.analyzeContentInExcel=function(e){},e.prototype.getModels=function(e){},e.prototype.runInsights=function(e){},e.prototype.canRefreshNow=function(e){return!1},e.prototype.canScheduleRefresh=function(e){return!1},e.prototype.canReplaceWorkbook=function(e){return!1},e.prototype.canShowTileOptions=function(e){return!0},e.prototype.refreshNow=function(e){},e.prototype.scheduleRefresh=function(e){},e.prototype.exportDashboard=function(e){},e.prototype.editWorkbook=function(e){},e.prototype.replaceWorkbook=function(e){},e.prototype.exportReportToPowerPoint=function(e){},e.prototype.prepareAndTriggerModelDeletion=function(e,t,i,o){var r=this.services.modelService.findModel(e,t);if(r&&r.isUsedByContentPack)this.services.contentPackService.showDialogOnModelDeleteInContentPack(e);else{var a=this.services.localizationService.get(i),n=this.services.localizationService.get(o);this.deleteModel(e,t,a,n)}},e.prototype.deleteModel=function(e,t,i,o){var r=this,a=this.services.errorService.control(),n=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(i,o){a.hideDialog(),r.services.modelService.deleteModel(e,t)}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){a.hideDialog()})],s=this.services.modelService.findModel(e,t),c="";s&&(c=s.displayName),i=i||this.services.localizationService.get("Model_DeleteConfirmationTitle"),o=o||this.services.localizationService.format("Model_DeleteConfirmationMessage",c),a.showCustomDialog(i,$("<div/>").text(o),n,(function(e){e.parent().find('input[value="'+r.services.localizationService.get("ModalDialogButtonText_No")+'"]').focus()}),!0)},e.prototype.removeWorkbook=function(e,t,i){var o=this;t||i||(t="Workbook_RemoveConfirmationTitle",i=e.isOwner()?this.services.packageService.isLocalWorkbook(e.packageId)?"Workbook_RemoveOwnedLocalConfirmationMessage":"Workbook_RemoveOwnedRemoteConfirmationMessage":e.isPersonalized()?"Workbook_RemovePersonalizedConfirmationMessage":"Workbook_RemoveInOrgPackConfirmationMessage");var r=this.services.localizationService.get(t),a=this.services.localizationService.get(i),n=this.services.errorService.control(),s=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Remove"),function(t,i){n.hideDialog(),o.services.workbookService.removeWorkbook(e.id,e.packageId,o.services.packageService.getWorkbookStorageProvider(e.packageId),o.services.packageService.getWorkbookContentProvider(e.packageId)),o.services.mostRecentlyUsedService.removeMRU(e.uniqueId)}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){n.hideDialog()})];n.showCustomDialog(r,$("<div/>").text(a),s,(function(e){e.parent().find('input[value="'+o.services.localizationService.get("ModalDialogButtonText_No")+'"]').focus()}),!0)},e})(),T=(function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.openContent=function(t,o,a,n){this.services.telemetryService.logEvent(e.telemetry.ContentListOpenArtifact,i(this.services.navigation),c.Dashboard);var s=d.getObjectID(t),l=d.getOriginalObjectID(t);_.isEmpty(a)?this.services.ownershipService.isResourceSharedWithMe(t)?this.services.navigation.navigateToSharedDashboardByGUID(s):this.services.navigation.insertGroupAndNavigateToDashboardByGUID(s,o):(r.isOrgAppInstance(n,this.services.appService)&&(n=null),this.services.navigation.navigateToAppDashboardByGUID(s,l,a,o,null,!0,n))},o.prototype.openUsageMetricsReport=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a,n;return __generator(this,(function(s){switch(s.label){case 0:if(o=d.getObjectID(t),r=this.services.dashboardService.findDashboardByGUID(o),!r)return[2];a=this.services.telemetryService.startEvent(e.telemetry.UsageMetricsViewUsageMetricsReport,e.constants.usageMetrics_Dashboard,o,e.constants.usageMetrics_NavModel),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.services.usageMetricsReport.openDashboardUsageMetricsReport(r,i,a)];case 2:return s.sent(),a.resolve(),[3,4];case 3:return n=s.sent(),a.reject(e.errorDetailsHelper.getTelemetryErrorDetails(n.error)),[3,4];case 4:return[2]}}))}))},o.prototype.deleteContent=function(e,t){var i=this.services.dashboardService.findDashboardByGUID(e);i&&this.services.dashboardService.promptForDeleteDashboard(i.id,t)},o.prototype.shareContent=function(e,t){e&&e instanceof u&&(this.services.shareSliderService.openShareSlider(e),e.isContentTileSelected=!0)},o.prototype.showRename=function(e){var t=this.services.dashboardService.findDashboardByGUID(e);t&&(this.services.settingsMetadataService.setSettings(1,e),t.isContentTileSelected=!0,this.services.taskPaneSliderService.expandPane(S.SettingsBlade,n.Medium))},o.prototype.getContentPackageId=function(e){if(e&&e instanceof u)return e.contract.originalPackageId},o.prototype.canShowTileOptions=function(e){return!this.services.permissionService.isActiveWorkspaceIsReadOnly},o.prototype.getModels=function(e){var t=this;if(e&&e instanceof u){var i=e.contract;if(i&&!_.isEmpty(i.modelIds)&&!_.isEmpty(i.packageIds))return _.map(i.modelIds,(function(e){return t.services.modelService.findModel(e)}))}},o.prototype.exportDashboard=function(e){var t=this.services.dashboardService.findDashboardByGUID(e);if(t){var i;this.services.location&&(i=this.services.location.search()[C]),i||(i="XMLA"),this.services.dashboardService.exportDashboard(t.id,i)}},o.prototype.identifyAndDeleteContent=function(e){var t=this.services.dashboardService.findDashboardByGUID(e);if(t){var i=t.contract.workbookIds[0],r=t.contract.modelIds[0],a=t.contract.originalPackageId;if(r)this.prepareAndTriggerModelDeletion(r,a,o.dashboardDeleteConfirmationTitle,o.dashboardDeleteContentPackMessage);else if(i){var n=this.services.workbookService.findWorkbook(i,a);if(n&&n.isUsedByContentPack)this.services.contentPackService.showDialogOnWorkbookRemoveInContentPack(i);else{var s=o.dashboardDeleteConfirmationTitle,c=o.dashboardDeleteConfirmationTitle;this.removeWorkbook(n,s,c)}}else a&&this.services.appService.deleteInstance(a)}},o})(I);T.dashboardDeleteConfirmationTitle="Dashboard_DeleteConfirmationTitle",T.dashboardDeleteContentPackMessage="Dashboard_DeleteOrgAppContentPack";var M=(function(t){function o(e){return t.call(this,e)||this}return __extends(o,t),o.prototype.openContent=function(t,o,a,n){this.services.telemetryService.logEvent(e.telemetry.ContentListOpenArtifact,i(this.services.navigation),c.Report);var s=d.getObjectID(t),l=d.getOriginalObjectID(t),p=a&&n&&!r.isOrgAppInstance(n,this.services.appService)?n:void 0;this.services.navigation.navigateToReport({appGUID:a,appInstanceId:p,reportGUID:s,reportOriginalGUID:l,groupGUID:o})},o.prototype.openUsageMetricsReport=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a,n;return __generator(this,(function(s){switch(s.label){case 0:if(o=d.getObjectID(t),r=this.services.reportService.findReportByGUID(o),!r)return[2];a=this.services.telemetryService.startEvent(e.telemetry.UsageMetricsViewUsageMetricsReport,e.constants.usageMetrics_Report,o,e.constants.usageMetrics_NavModel),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this.services.usageMetricsReport.openReportUsageMetricsReport(r,i,a)];case 2:return s.sent(),a.resolve(),[3,4];case 3:return n=s.sent(),a.reject(e.errorDetailsHelper.getTelemetryErrorDetails(n.error)),[3,4];case 4:return[2]}}))}))},o.prototype.showRename=function(e){var t=this.services.reportService.findReportByGUID(e);t&&(this.services.settingsMetadataService.setSettings(2,e),t.isContentTileSelected=!0,this.services.taskPaneSliderService.expandPane(S.SettingsBlade,n.Medium))},o.prototype.deleteContent=function(e,t){var i=this.services.reportService.findReportByGUID(e);i&&this.deleteReport(i.id)},o.prototype.getContentPackageId=function(e){if(e&&e instanceof y)return e.packageId},o.prototype.canShowTileOptions=function(t){if(t&&t instanceof y){var i=this.getModels(t),o=i&&i[0];return!this.services.permissionService.isActiveWorkspaceIsReadOnly&&o&&o.packagePublishStatus!==e.common.contracts.PublishOrRefreshStatus.PublishInProgress}return!1},o.prototype.identifyAndDeleteContent=function(e){var t=this.services.reportService.findReportByGUID(e);if(t){var i=t.modelId,r=t.packageId;i&&this.prepareAndTriggerModelDeletion(i,r,o.reportDeleteConfirmationTitle,o.reportDeleteContentPackMessage)}},o.prototype.analyzeContentInExcel=function(t){var i=this.getModels(t),o=i&&i[0];o&&(this.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsAnalyzeInExcel,"Report Navigation Pane List",o.contentProviderId,o.contract.modelFeatures,o.dbName),this.services.analyzeInExcel.startAnalyzeInExcel(o))},o.prototype.exportReportToPowerPoint=function(e){var t=this.services.reportService.findReportByGUID(e);if(t){var i={reportId:t.id,filename:t.displayName,reportSectionsNumber:void 0};this.services.exportToPowerPoint.exportToPowerPoint(i)}},o.prototype.getModels=function(e){if(e&&e instanceof y){var t=this.services.modelService.findModel(e.modelId,e.packageId);if(t)return[t]}},o.prototype.deleteReport=function(e){var t=this,i=this.services.$rootScope.$new(),o=this.services.errorService.control(),r=this.services.reportService.findReport(e),a=[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Delete"),function(i,a){o.hideDialog(),t.services.mostRecentlyUsedService.removeMRU(r.objectId),t.services.reportService.deleteReport(e)}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialogButtonText_Cancel"),function(e,t){o.hideDialog()})];i.message=this.services.localizationService.format("Report_DeleteConfirmationMessage",[r.displayName]);var n,s,c=this.services.dashboardService.hasTileForReportandSection(void 0,e);c&&(n=jsCommon.ModalDialogNotificationType.Warning,s=this.services.localizationService.get("PinLiveReport_DeleteReportWarning"));var l={dialogName:this.services.localizationService.get("Report_DeleteConfirmationTitle"),isDismissable:!0,scope:i,template:"<custom-modal-dialog></custom-modal-dialog>",dialogCssClass:"customModalDialog",focusOnFirstButton:!0,dialogActions:a,notificationType:n,notificationText:s};this.services.modalDialogService.showLegacyWebModalDialog(l)},o})(I);M.reportDeleteConfirmationTitle="Report_DeleteConfirmationTitle",M.reportDeleteContentPackMessage="Report_DeleteOrgAppContentPack";var k=(function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.openContent=function(t,o,r,a){var n=t;if(3===n.favoriteType){var s=new E(this.services);s.openContent(n,o,n.contentProviderKey,n.favoriteId)}else{this.services.telemetryService.logEvent(e.telemetry.ContentListOpenArtifact,i(this.services.navigation),c.Dashboard);var l=d.getObjectID(t);this.services.navigation.insertGroupAndNavigateToDashboardByGUID(l,o)}},o.prototype.shareContent=function(e,t){this.services.groupService.activeGroupObjectId!==t?this.switchGroupThenShare(e,t):this.shareContentInternal(e)},o.prototype.switchGroupThenShare=function(t,i){var o=this,r=this.services.groupService.getGroup(i),a=this.services.telemetryService.startEvent(e.telemetry.GroupsSwitchGroup,i);this.services.groupService.switchGroup(r,!1,a).then((function(){o.services.groupService.ensureGroupsInitialization().then((function(){o.services.navigation.inFavoritesView()&&o.services.dashboardService.getDashboards().then((function(){o.shareContentInternal(t)}))}))}))},o.prototype.shareContentInternal=function(e){var t=d.getObjectID(e),i=this.services.dashboardService.findDashboardByGUID(t);if(i){this.services.shareSliderService.openShareSlider(i);var o=this.services.favorites.getFavoriteByContentTile(e);o&&(o.isContentTileSelected=!0)}},o.prototype.canShowTileOptions=function(e){return!0},o})(I),P=(function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.openContent=function(t,o,r,a){var n=d.getObjectID(t),s=this.services.workbookService.findWorkbookByUniqueId(n);s&&(s.isNew=!1),this.services.telemetryService.logEvent(e.telemetry.ContentListOpenArtifact,i(this.services.navigation),c.Workbook),_.isEmpty(r)?this.services.navigation.insertGroupAndNavigateToWorkbookByUniqueId(n,o):this.services.navigation.navigateToAppWorkbookByUniqueId(n,r,o)},o.prototype.editWorkbook=function(t){var i=this.services.workbookService.findWorkbookByUniqueId(t);i&&(this.services.$window.open(i.editUrl,"_blank"),this.services.telemetryService.logEvent(e.telemetry.DashboardEditWorkbook,i.contract.etagHash))},o.prototype.replaceWorkbook=function(e){var t=this.services.workbookService.findWorkbookByUniqueId(e);t&&this.services.workbookService.replaceLocalWorkbook(t.uniqueId)},o.prototype.showRename=function(e){var t=this.services.workbookService.findWorkbookByUniqueId(e);t&&(this.services.settingsMetadataService.setSettings(3,e),t.isContentTileSelected=!0,this.services.taskPaneSliderService.expandPane(S.SettingsBlade,n.Medium))},o.prototype.getContentPackageId=function(e){if(e&&e instanceof w)return e.packageId},o.prototype.identifyAndDeleteContent=function(e){var t=this.services.workbookService.findWorkbookByUniqueId(e);if(t){var i=t.id,o=t.packageId;if(i){var r=this.services.workbookService.findWorkbook(i,o);r&&r.isUsedByContentPack?this.services.contentPackService.showDialogOnWorkbookRemoveInContentPack(i):this.removeWorkbook(r)}}},o.prototype.canRefreshNow=function(e){var t=d.getObjectID(e),i=this.services.workbookService.findWorkbookByUniqueId(t);return!!i&&this.services.packageService.isRefreshNowEnabledForWorkbook(i)},o.prototype.canShowTileOptions=function(e){return!this.services.permissionService.isActiveWorkspaceIsReadOnly},o.prototype.getModels=function(e){if(e&&e instanceof w&&e.isOwner()&&e.modelId&&e.packageId){var t=this.services.modelService.findModel(e.modelId,e.packageId);if(t)return[t]}},o.prototype.canScheduleRefresh=function(e){var t=d.getObjectID(e),i=this.services.workbookService.findWorkbookByUniqueId(t);return!!i&&this.services.packageService.isScheduleRefreshEnabledForWorkbook(i)},o.prototype.canReplaceWorkbook=function(e){var t=this.services.workbookService.findWorkbookByUniqueId(e);return!!t&&this.services.packageService.isLocalWorkbook(t.packageId)},o.prototype.refreshNow=function(t){var i=d.getObjectID(t),o=this.services.workbookService.findWorkbookByUniqueId(i);if(o)if(o.modelId&&o.contract.isPowerPivotVersionSupportsRefresh){var r=this.services.modelService.findModel(o.modelId,o.packageId);r&&(this.services.telemetryService.logEvent(e.telemetry.DashboardWorkbookClickRefreshNow,r.contentProviderId),this.services.refreshService.tryRefreshNow(this.services.telemetryService,this.services.errorService,r,"workbooks"))}else this.services.telemetryService.logEvent(e.telemetry.DashboardWorkbookClickRefreshNow,o.contentProviderId),this.services.refreshService.refreshNow(this.services.telemetryService,this.services.errorService,o.packageId,o.contentProviderId)},o.prototype.scheduleRefresh=function(t){var i=d.getObjectID(t),o=this.services.workbookService.findWorkbookByUniqueId(i);if(o){var r=this.services.modelService.findModel(o.modelId,o.packageId);r&&(this.services.telemetryService.logEvent(e.telemetry.DashboardWorkbookClickScheduleRefresh,r.contentProviderId),this.services.$rootScope.$emit(e.common.constants.showSettingsViewerEventName,"workbooks",r.dbName))}},o})(I),E=(function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.openContent=function(t,i,o,r){var a=this,n=this.services;n.groupService.ensureGroupsInitialization().then((function(){if(n.groupService.isMyWorkspace())a.openContentHelper(t,i,o,r);else{var s=_.find(n.groupService.groups,(function(e){return e.isMyWorkspace})),c=a.services.telemetryService.startEvent(e.telemetry.GroupsSwitchGroup,s.aadGroupId);n.groupService.switchGroup(s,!1,c,!0).then((function(){a.openContentHelper(t,i,o,r)}))}}))},o.prototype.openContentHelper=function(t,o,a,n){var s=this.services;s.telemetryService.logEvent(e.telemetry.ContentListOpenArtifact,i(s.navigation),c.OrgApp);var l;if(t.contentTileType===p.MRU&&t instanceof g?(l=s.appService.getAppInstance(t.packageid),null==l&&this.services.mostRecentlyUsedService.removeMRU(t.objectId,o)):t.contentTileType===p.Favorite&&null!=n?l=s.appService.getAppInstance(n):t.contentTileType===p.OrgApp&&(l=t),null==l)return e.helpers.ArtifactNotFoundHelper.showArtifactDoesNotExistDialog("ArtifactKind_App",this.services.errorService,this.services.localizationService,this.services.telemetryService),void this.services.navigation.navigateToApps();var d=r.getDefaultAppArtefact(l),v=r.isOrgApp(l.providerContract)?null:l.packageId;if(d){var h=t.objectId;d instanceof u?this.services.navigation.navigateToAppDashboardByGUID(d.objectId,d.contract.originalDashboardObjectId,h,o,null,!0,v):d instanceof y?this.services.navigation.navigateToReport({appGUID:h,appInstanceId:v,reportGUID:d.objectId,reportOriginalGUID:d.contract.originalReportObjectId,groupGUID:this.services.groupService.activeGroupObjectId}):d instanceof w&&this.services.navigation.navigateToAppWorkbookByUniqueId(d.uniqueId,h,o)}else this.services.navigation.navigateToApp(l.providerContract.providerKey,v)},o.prototype.identifyAndDeleteContent=function(e){var t=this.services.appService,i=t.getAppByGUID(e),o=i.providerKey,a=r.getPackageIDByOrgAppGUID(t,this.services.packageService,o);t.deleteInstance(a)},o.prototype.canShowTileOptions=function(e){return!1},o.prototype.canScheduleRefresh=function(e){return!1},o.prototype.getContentPackageId=function(e){return r.getPackageIDByOrgAppGUID(this.services.appService,this.services.packageService,e.objectId)},o})(I),A=(function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.canShowTileOptions=function(e){return!1},i.prototype.analyzeContentInExcel=function(t){var i=t;this.services.telemetryService.logEvent(e.telemetry.DashboardAndReportsAnalyzeInExcel,"Report Navigation Pane List",i.contentProviderId,i.contract.modelFeatures,i.dbName),this.services.analyzeInExcel.startAnalyzeInExcel(i)},i.prototype.getModels=function(e){var t=e;if(t)return[t]},i.prototype.canRefreshNow=function(e){return this.canModelRefresh(e)},i.prototype.refreshNow=function(e){if(this.canRefreshNow(e)){var t=e;this.services.refreshService.tryRefreshNow(this.services.telemetryService,this.services.errorService,t,"datasets")}},i.prototype.canScheduleRefresh=function(e){return this.canModelRefresh(e)},i.prototype.scheduleRefresh=function(e){if(this.canScheduleRefresh(e)){var t=e;this.services.navigation.showSettingsSlider("datasets",t.dbName)}},i.prototype.canModelRefresh=function(e){if(e instanceof o&&v.hasFlag(e.getPermissions(),a.Write))return!!r.isParameterizedAppInstance(e.packageId,this.services.appService)},i})(I),R=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getStrategy=function(e){switch(e.type){case h.Dashboards:return new T(this.services);case h.Reports:return new M(this.services);case h.Workbooks:return new P(this.services);case h.AppInstance:return new E(this.services)}},t.prototype.openContent=function(e,t,i,o){if(e instanceof g){var r=this.getStrategy(e);if(r){var a=d.getMRUOriginalContentTile(e,this.services.dashboardService,this.services.reportService,this.services.workbookService,this.services.appService);o=e.packageid||o,r.openContent(a,t,i,o)}}},t})(I),x=(function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return __extends(i,t),i.prototype.openContent=function(t,i,o,r){e.helpers.ContentProviderStoreHelper.navigateToCategoryAndProviderHelper(l.Organizational,e.controllers.contentProviderStore.contentProviderConstants.getAppsInteraction,0,this.services.telemetryService,this.services.navigation,this.services.$rootScope,!0)},i.prototype.canShowTileOptions=function(e){return!1},i})(I)})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r){return new v(e,t,i,o,r)}function i(e,t,i){var o=e?r.dynamicGridWidth:r.dynamicGridHeight,a=0;i&&(a=e?l+d:p+u);var n=e?0:c;return o*t+2*r.dynamicGridItemSpacing*(t-1)-a-n}function o(t,i,o,r){var s=i.tooltipsEnabled,c=r&&r.forecastEnabled,l=r&&r.improvedMapLegend,d=r&&r.axisControlImprovements,p=r&&r.donutChartLabelPercentEnabled,u=r&&r.textboxFontColorEnabled,v=r&&r.responsiveVisualEnabled,h=r&&r.customFontFamily;switch(t){case e.visuals.plugins.barChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.barChart,(function(){return new e.visuals.CartesianChart({chartType:6,tooltipsEnabled:s,animator:new e.visuals.DashboardColumnChartAnimator,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.clusteredBarChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.clusteredBarChart,(function(){return new e.visuals.CartesianChart({chartType:5,tooltipsEnabled:s,animator:new e.visuals.DashboardColumnChartAnimator,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.clusteredColumnChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.clusteredColumnChart,(function(){return new e.visuals.CartesianChart({chartType:3,tooltipsEnabled:s,animator:new e.visuals.DashboardColumnChartAnimator,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.columnChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.columnChart,(function(){return new e.visuals.CartesianChart({chartType:4,tooltipsEnabled:s,animator:new e.visuals.DashboardColumnChartAnimator,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v
})})}),r);case e.visuals.plugins.dataDotClusteredColumnComboChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.dataDotClusteredColumnComboChart,(function(){return new e.visuals.CartesianChart({chartType:15,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.dataDotStackedColumnComboChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.dataDotStackedColumnComboChart,(function(){return new e.visuals.CartesianChart({chartType:16,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.donutChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.donutChart,(function(){return new e.visuals.DonutChart({tooltipsEnabled:s,donutChartLabelPercentEnabled:p})}),r);case e.visuals.plugins.funnel.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.funnel,(function(){return new e.visuals.FunnelChart({tooltipsEnabled:s,axisControlImprovements:d})}),r);case e.visuals.plugins.gauge.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.gauge,(function(){return new e.visuals.Gauge({animator:new e.visuals.BaseAnimator,tooltipsEnabled:s})}),r);case e.visuals.plugins.hundredPercentStackedBarChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.hundredPercentStackedBarChart,(function(){return new e.visuals.CartesianChart({chartType:7,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.hundredPercentStackedColumnChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.hundredPercentStackedColumnChart,(function(){return new e.visuals.CartesianChart({chartType:8,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.lineChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.lineChart,(function(){return new e.visuals.CartesianChart({chartType:0,tooltipsEnabled:s,forecastEnabled:c,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.areaChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.areaChart,(function(){return new e.visuals.CartesianChart({chartType:1,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.stackedAreaChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.stackedAreaChart,(function(){return new e.visuals.CartesianChart({chartType:2,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.lineClusteredColumnComboChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.lineClusteredColumnComboChart,(function(){return new e.visuals.CartesianChart({chartType:13,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.lineStackedColumnComboChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.lineStackedColumnComboChart,(function(){return new e.visuals.CartesianChart({chartType:14,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.pieChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.pieChart,(function(){return new e.visuals.DonutChart({sliceWidthRatio:0,tooltipsEnabled:s,donutChartLabelPercentEnabled:p})}),r);case e.visuals.plugins.scatterChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.scatterChart,(function(){return new e.visuals.CartesianChart({chartType:9,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,scatterWithMatrixDV:r&&r.scatterWithMatrixDV,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.treemap.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.treemap,(function(e){var t=e.module;return new t.Treemap({isScrollable:!1,tooltipsEnabled:s})}),r);case e.visuals.plugins.waterfallChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.waterfallChart,(function(){return new e.visuals.CartesianChart({chartType:12,tooltipsEnabled:s,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,axisControlImprovements:d,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.map.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.applyImprovedMapLegendMappings(e.visuals.plugins.map,l,!1),(function(){return new e.visuals.Map({tooltipsEnabled:s,disableZooming:!0,disablePanning:!0})}),r);case e.visuals.plugins.filledMap.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.applyImprovedMapLegendMappings(e.visuals.plugins.filledMap,l,!0),(function(){return new e.visuals.Map({filledMap:!0,tooltipsEnabled:s,disableZooming:!0,disablePanning:!0})}),r);case e.visuals.plugins.shapeMap.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.shapeMap,(function(e){var t=e.module;return new t.ShapeMap({tooltipsEnabled:s})}),r);case e.visuals.plugins.matrix.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.matrix,(function(){return new e.visuals.Matrix}),r);case e.visuals.plugins.tableEx.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.tableEx,(function(){return new e.visuals.TableEx(n.createDashboardConstructorOptions())}),r);case e.visuals.plugins.pivotTable.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.pivotTable,(function(){return new e.visuals.PivotTable(a.createDashboardConstructorOptions())}),r);case e.visuals.plugins.realTimeLineChart.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.realTimeLineChart,(function(){return new e.visuals.CartesianChart({chartType:17,animator:new e.visuals.RealTimeLineChartAnimator,cartesianSmallViewPortProperties:o.cartesianSmallViewPortProperties,legendSmallViewPortProperties:o.legendSmallViewPortProperties,animateCategoryAxis:!0,animateValueAxis:!0,responsiveVisualEnabled:v,customFontFamily:h,viewModelAdapter:new e.visuals.CartesianViewModelAdapter({responsiveVisualEnabled:v})})}),r);case e.visuals.plugins.table.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.table,(function(){return new e.visuals.Table}),r);case e.visuals.plugins.card.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.card,(function(){return new e.visuals.Card({cardSmallViewportProperties:o.cardSmallViewportProperties})}),r);case e.visuals.plugins.textbox.name:return e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins.textbox,(function(){return new e.visuals.Textbox({viewModelAdapter:new e.visuals.TextboxHelpers.ViewModelAdapter(o.textboxSmallViewportProperties),disableScrollingInViewMode:!0,textboxFontColorEnabled:u})}),r);case e.visualHost.EsriVisual:return e.visuals.plugins[e.visualHost.EsriVisual]?e.visualHost.visualPluginServiceHelpers.getPluginCopyWithFeatureSwitches(e.visuals.plugins[e.visualHost.EsriVisual],e.visuals.plugins[e.visualHost.EsriVisual].create,r):null;default:return e.Prototype.inherit(e.visuals.plugins[t])}}var r=e.common.GridLayoutConstants,a=e.visuals.PivotTableOptions,n=e.visuals.TableExOptions,s=e.visualHost.visualPluginServiceHelpers.VisualPluginStorage,c=42,l=10,d=10,p=0,u=8;e.createDashboardVisualPluginService=t;var v=(function(){function t(t,r,a,n,c){var l=this;this.asyncFeatureSwitchService=t,this.promiseFactory=r,this.resourceLoader=a,this.telemetryService=n,this.storage=new s;var d=i(!0,2,!1),p=i(!0,2,!0),u=i(!1,2,!0),v=i(!0,3,!0),h=i(!0,4,!0),g=i(!1,2,!0),m=i(!0,3,!0),f=i(!1,2,!0),y=i(!0,3,!0),b=i(!0,2,!0),S=i(!1,2,!0),w=i(!0,4,!0),C=i(!1,3,!0),D={cardSmallViewportProperties:{cardSmallViewportWidth:d},cartesianSmallViewPortProperties:{minWidthForLegend:p,minHeightForLegend:u,minHeightForAxisLabels:f,minWidthForAxisLabels:m,mediumWidthForAxis:y,minWidthForAxis:b,minHeightForAxis:S,maxWidthForMediumFont:h,maxWidthForSmallFont:v},legendSmallViewPortProperties:{maxWidthForSmallFont:v,maxWidthForMediumFont:h,minHeightForTransform:g},textboxSmallViewportProperties:{minWidthToScaleFontSize:w,minHeightToScaleFontSize:C}};this.initBuiltInPlugins=this.asyncFeatureSwitchService.getFeatureSwitches().then((function(t){for(var i in e.visuals.plugins)l.storage.loadPlugin(i,o(i,c,D,t))}))}return t.prototype.ensureBuiltInPlugins=function(){return this.initBuiltInPlugins},t.prototype.getVisuals=function(){return this.storage.getLoadedPlugins()},t.prototype.ensureTrustedVisualPlugins=function(e){s.ensureTrustedVisualPlugins(this.storage,e)},t.prototype.ensurePlugins=function(e,t){var i=[];if(e&&e.length)for(var o=0,r=e;o<r.length;o++){var a=r[o];0===a.type&&i.push(this.ensurePlugin(a,!1))}return this.promiseFactory.allSettled(i)},t.prototype.ensurePlugin=function(e,t){return s.ensurePlugin(this.storage,this.promiseFactory,this.resourceLoader,e,!1,this.telemetryService)},t.prototype.getPlugin=function(t){var i=this.storage.getLoadedPlugin(t);return!i&&e.visuals.plugins[t]&&(this.storage.loadPlugin(t,e.Prototype.inherit(e.visuals.plugins[t])),i=this.storage.getLoadedPlugin(t)),i},t.prototype.capabilities=function(e){var t=this.getPlugin(e);return t?t.capabilities:void 0},t.prototype.isCustomVisual=function(t){return e.visualHost.utils.isCustomVisual(this.getPlugin(t),t)},t.prototype.getInteractivityOptions=function(){return{overflow:"hidden",isVisualInteractive:!1}},t.prototype.getTelemetryHostInformation=function(){return{name:"Dashboard"}},t.prototype.isScriptVisual=function(t){return e.visualHost.utils.isScriptVisual(this.getPlugin(t))},t.prototype.isScriptVisualQueryable=function(){return e.visualHost.utils.isScriptVisualQueryable(this.asyncFeatureSwitchService.featureSwitches)},t.prototype.isLightWeightRenderingVisual=function(t){return e.visualHost.utils.isLightWeightRenderingVisual(this.getPlugin(t))},t.prototype.getStorage=function(){return this.storage},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i){return new a(e,t,i)}var i=e.data.EmptyDataClientError,o=e.data.InvalidDataResponseClientError;e.createDelayedQueryResultResolver=t;var r=1e4,a=(function(){function t(e,t,i){this.jobsWaitingForResults={},this.jobsAlreadyResolved=[],this.syncService=e,this.$timeout=t,this.telemetryService=i,e.addDelayedQueryDataListener(this)}return t.prototype.resolveDelayedQuery=function(e,t){var i=this,o=this.$timeout(r);o.then((function(){return i.preemptiveQuery(e)})),this.jobsWaitingForResults[e]={jobId:e,deferred:t,preemptiveQueryPromise:o},this.jobsAlreadyResolved.indexOf(e)>=0&&this.onDelayedQueryDataAvailable(e)},t.prototype.onDelayedQueryDataAvailable=function(i){var r=this,a=this.jobsWaitingForResults[i];a?(this.$timeout.cancel(this.jobsWaitingForResults[i].preemptiveQueryPromise),delete this.jobsWaitingForResults[i],e.queryService.getQueryData(i,void 0).then((function(e){return r.handleQueryDataResult(e,a)})).catch((function(){a.deferred.reject(new o)}))):this.jobsAlreadyResolved.indexOf(i)<0&&(this.jobsAlreadyResolved.push(i),this.jobsAlreadyResolved.length>t.MaxResolvedJobsToTrack&&this.jobsAlreadyResolved.shift())},t.prototype.preemptiveQuery=function(t){var i=this,o=this.jobsWaitingForResults[t];o&&e.queryService.getQueryData(t,void 0).then((function(r){i.handleQueryDataResult(r,o),delete i.jobsWaitingForResults[t],i.telemetryService.logEvent(e.telemetry.AppPreemptiveQueryData,t)}))},t.prototype.handleQueryDataResult=function(t,o){var r=t.data;if(r&&r.data){var a={descriptor:r.data.descriptor,dsr:r.data.dsr,requestId:t.requestId};o.deferred.resolve(a)}else if(r.error){var n=new e.ServiceErrorToClientError(r.error);n.requestId=t.requestId,o.deferred.reject(n)}else o.deferred.reject(new i)},t})();a.MaxResolvedJobsToTrack=100})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,a,n,s,c,l,d,p,u,v,h,g,m,f){return new r(e,t,i,o,a,n,s,c,l,d,p,u,v,h,g,m,f)}var i=e.common.contracts.ContentTileType,o=e.common.contracts.Permissions;e.createFavoritesService=t;var r=(function(){function t(t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f){var y=this;this.telemetryService=t,this.favoritesHttp=i,this.activeGroupId=o,this.promiseFactory=r,this.dashboardService=a,this.rootScope=n,this.featureSwitchService=s,this.notificationToast=c,this.localizationService=l,this.errorService=d,this.permissionService=p,this.appMetadataService=u,this.navigation=v,this.tutorialDataStore=h,this.dataClassificationService=g,this.appService=m,this.mostRecentlyUsedService=f,this.favorites=[],this.listeners=[],this.navigation.inFavoritesView()||this.reloadFavorites(),this.rootScope.$on(e.constants.groupSwitchedEventName,(function(){return y.populateFavorites()}))}return t.prototype.getFavoriteByContentTile=function(t){var i=e.helpers.ContentTileHelper.getObjectID(t),o=e.helpers.ContentTileHelper.getContentFavoriteType(t);return _.find(this.favorites,(function(e){return e.objectId===i&&e.favoriteType===o}))},t.prototype.getFavoriteTelemetryType=function(t){switch(t){case 1:return e.telemetry.FavoriteType.Dashboard;case 3:return e.telemetry.FavoriteType.AppInstance;case 2:return e.telemetry.FavoriteType.Report}},t.prototype.addFavorite=function(t){var i=this,o=e.helpers.ContentTileHelper.getContentFavoriteType(t);if(!o)return this.promiseFactory.reject();var r=e.helpers.ContentTileHelper.getFavoriteId(t,this.dashboardService),a=this.promiseFactory.defer();return this.ensureDependentServices().then((function(t){var n;if(1===o?n=i.dashboardService.findDashboard(r):3===o&&(n=i.appService.getAppInstance(r)),n){n.isFavorite=!0,n.isFavoriteDisabled=!0;var s=i.getFavoriteTelemetryType(o),c=i.telemetryService.startEvent(e.telemetry.DashboardAddFavorite,r,i.activeGroupId.activeGroupObjectId,s);i.favoritesHttp.addFavorite(o,r,c.event).then((function(e){var t=e.data;t.uniqueId=i.getUniqueId(r,o),1===o?(i.fillFavoriteDashboardInfo(t,r,i.activeGroupId.activeGroupObjectId),a.resolve(t)):3===o&&(i.fillFavoriteOrgAppInfo(t,r,i.activeGroupId.activeGroupObjectId),a.resolve(t)),i.matchMRUFavorites(t),c.resolve(),i.onAdded(t)}),(function(e){a.reject(),c.reject(),n&&(n.isFavorite=!1,n.isFavoriteDisabled=!1),i.errorService.error(i.localizationService.get("Favorites_FailedToFavorite"),"",{requestId:e.requestId,statusCode:e.status.toString(),activityId:e.activityId})})).finally((function(){n.isFavoriteDisabled=!1}))}else a.reject()}),(function(e){return a.reject()})),a.promise},t.prototype.deleteFavorite=function(t){var i=this,o=this.getFavoriteByContentTile(t);o&&this.ensureDependentServices().then((function(r){var a,n=e.helpers.ContentTileHelper.getContentFavoriteType(t),s=i.getFavoriteTelemetryType(n);t instanceof e.models.MRUModel?a=t:1===n?a=i.dashboardService.findDashboardByGUID(o.objectId):3===n&&(a=i.appService.getAppInstance(o.favoriteId)),null!=a&&(a.isFavoriteDisabled=!0);var c=i.telemetryService.startEvent(e.telemetry.DashboardDeleteFavorite,o.objectId,o.workspaceId,s);i.favoritesHttp.deleteFavorite(o,c.event).then((function(e){var t=_.remove(i.favorites,(function(e){return e.id===o.id}));t&&t.length>0&&i.onDeleted(o),o=null,c.resolve(),a&&(a.isFavorite=!1,a.isFavoriteDisabled=!1)}),(function(e){c.reject(),i.errorService.error(i.localizationService.get("Favorites_FailedToUnfavorite"),"",{requestId:e.requestId,statusCode:e.status.toString(),activityId:e.activityId}),a&&(a.isFavorite=!0,a.isFavoriteDisabled=!1)}))}))},t.prototype.updateFavoritesWithPermissions=function(e){for(var t=function(e){e.getPermissions=function(){return e.permissions}},i=0,o=e;i<o.length;i++){var r=o[i];t(r)}return e},Object.defineProperty(t.prototype,"favoritesCache",{get:function(){return this.initialized?this.favorites:void 0},enumerable:!0,configurable:!0}),t.prototype.reloadFavorites=function(t){var i=this;if(this.favoritesDeferred=this.promiseFactory.defer(),t){var o=this.telemetryService.startEvent(e.telemetry.DashboardGetFavorites,0);return this.favoritesHttp.getFavorites(o.event).then((function(e){var t=i.updateFavoritesWithPermissions(e.data);i.favorites=t,i.favorites=_.uniq(i.favorites,(function(e){return e.favoriteId})),_.isEmpty(i.favorites)||(o.event.info.countOfFavorites=i.favorites.length),i.populateFavorites().finally((function(){i.favoritesDeferred.resolve(i.favorites),i.initialized=!0,o.resolve(),i.onReset()}))}),(function(t){i.favoritesDeferred.reject(),t.status===e.HttpStatusCode.Unauthorized?o.resolve():(o.reject(),i.errorService.error(i.localizationService.get("Favorites_FailedToLoadFavorites"),"",{requestId:t.requestId,statusCode:t.status.toString(),activityId:t.activityId}))})),this.favoritesDeferred.promise}return this.promiseFactory.all([this.appMetadataService.getAppMetadata(),this.ensureDependentServices()]).then((function(e){var t=e[0]&&e[0].favorites;if(t){var o=i.updateFavoritesWithPermissions(t);i.favorites=o,i.favorites=_.uniq(i.favorites,(function(e){return e.favoriteId})),i.initialized=!0,i.populateFavorites().finally((function(){i.favoritesDeferred.resolve(i.favorites),i.onReset()}))}})),this.favoritesDeferred.promise},t.prototype.subscribe=function(e){_.contains(this.listeners,e)||this.listeners.push(e)},t.prototype.unsubscribe=function(e){_.pull(this.listeners,e)},t.prototype.onAdded=function(e){for(var t=0,i=this.listeners;t<i.length;t++){var o=i[t];o.onFavoriteAdded&&o.onFavoriteAdded(e)}},t.prototype.onDeleted=function(e){for(var t=0,i=this.listeners;t<i.length;t++){var o=i[t];o.onFavoriteDeleted&&o.onFavoriteDeleted(e)}},t.prototype.onReset=function(){for(var e=0,t=this.listeners;e<t.length;e++){var i=t[e];i.onFavoriteDeleted&&i.onFavoritesReset()}},t.prototype.fillFavoriteDashboardInfo=function(e,t,i){var r=this.dashboardService.findDashboard(t);this.fillFavoriteInfo(e,r,1),e.permissions=this.permissionService.isActiveWorkspaceIsReadOnly?o.Read:r.getPermissions(),e.getPermissions=function(){return e.permissions},e.workspaceId===this.activeGroupId.myWorkspaceGroupId?e.ownerInfo=r.ownerFullname:(e.ownerInfo=this.activeGroupId.groupDisplayName,e.workspaceId=i)},t.prototype.fillFavoriteOrgAppInfo=function(e,t,i){var o=this.appService.getAppInstance(t);o&&(this.fillFavoriteInfo(e,o,3),e.permissions=o.getPermissions(),e.getPermissions=o.getPermissions,e.ownerInfo=o.author,e.favoriteId=o.packageId)},t.prototype.fillFavoriteInfo=function(e,t,o){e.objectId=t.objectId,e.displayName=t.displayName,e.contentTileType=i.Favorite,e.favoriteType=o,this.favorites.push(e)},t.prototype.populateFavorites=function(){var e=this,t=this.promiseFactory.defer(),i=this.favorites;return i?this.updateFavorites(i).then((function(){return t.resolve(null)})):this.reloadFavorites().then((function(i){e.updateFavorites(i).then((function(){return t.resolve(null)}))})),t.promise},t.prototype.updateFavorites=function(e){var t=this;return this.ensureDependentServices().then((function(o){var r=t.activeGroupId.activeGroupObjectId;r===t.activeGroupId.myWorkspaceGroupId&&(r=null);for(var a=0,n=e;a<n.length;a++){var s=n[a];s.contentTileType=i.Favorite;var c=s.favoriteId;if(s.uniqueId=t.getUniqueId(c,s.favoriteType),t.matchMRUFavorites(s),3===s.favoriteType){var l=t.appService.getAppInstance(s.favoriteId);l&&(s.objectId=l.providerContract.providerKey,s.ownerInfo=l.author,t.updateFavoritableContent(l,s))}else if(1===s.favoriteType&&s.workspaceId===r){var d=t.dashboardService.findDashboardByGUID(s.objectId);s.dataClassificationId=d&&d.dataClassificationId,t.updateFavoritableContent(d,s)}}}))},t.prototype.matchMRUFavorites=function(e){var t;switch(e.favoriteType){case 1:t=this.mostRecentlyUsedService.findDashboardMRU(e.objectId);break;case 3:t=this.mostRecentlyUsedService.findAppInstanceMRU(e.favoriteId),t&&(e.objectId=t.objectId)}t&&this.updateFavoritableContent(t,e)},t.prototype.updateFavoritableContent=function(e,t){e&&(e.favoriteInfo=t,e.isFavorite=!0)},t.prototype.ensureDependentServices=function(){return this.promiseFactory.all([this.dashboardService.getDashboards(),this.appService.ensureAppsInitialization(),this.mostRecentlyUsedService.getMRUModels()])},t.prototype.getUniqueId=function(e,t){return 10*e+t},t})();e.FavoritesService=r})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i){return new o(e,t,i)}t.createFilterPersistenceService=i;var o=(function(){function t(e,i,o){var r=this;this.promiseFactory=e,this.userSettingsService=i,this.telemetryService=o,this.filters={},this.filtersLoadedPromise=this.userSettingsService.getExtendedSettingByKey(t.UserExtendedSettingKey).then((function(e){r.filters=e||r.filters}))}return t.prototype.getFilter=function(e){var t=this;return this.filtersLoadedPromise.then((function(){return t.filters?t.filters[e]:null})).catch((function(e){return null}))},t.prototype.setFilter=function(i,o){var r=this.telemetryService.startEvent(e.telemetry.ContentListPersistFilter);this.filters[i]=o,this.userSettingsService.updateExtendedSettings(t.UserExtendedSettingKey,this.filters,r)},t})();o.UserExtendedSettingKey="filter",t.FilterPersistenceService=o})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e){return new a(e)}var i=e.common.models.CollapsiblePaneExpandedWidth,o=e.common.contracts.GroupLinkType,r=e.common.constants.TaskPaneCollapsiblePaneMode;e.createGroupContextMenuService=t;var a=(function(){function t(e){this.services=e,this.localizationService=e.localizationService}return t.prototype.getIconNameForGroupLinkType=function(e){switch(e){case o.Calendar:return"calendar";case o.Conversations:return"comment";case o.Files:return"page2";case o.Members:return"group";case o.Notebook:return"folder";case o.EditGroup:return"edit";case o.ViewGroup:return"show";case o.LeaveGroup:return"delete"}},t.prototype.getTextForGroupLinkType=function(e){switch(e){case o.Calendar:return this.localizationService.get("GroupNavigationPaneContextMenuItem_Calendar");case o.Conversations:return this.localizationService.get("GroupNavigationPaneContextMenuItem_Conversations");case o.Files:return this.localizationService.get("GroupNavigationPaneContextMenuItem_Files");case o.Members:return this.localizationService.get("GroupNavigationPaneContextMenuItem_Members");case o.Notebook:return this.localizationService.get("GroupNavigationPaneContextMenuItem_Notebook");case o.EditGroup:return this.localizationService.get("GroupNavigationPaneContextMenuItem_EditGroup");case o.ViewGroup:return this.localizationService.get("GroupNavigationPaneContextMenuItem_ViewGroup");case o.LeaveGroup:return this.localizationService.get("GroupNavigationPaneContextMenuItem_LeaveGroup");case o.UnpublishApp:return this.localizationService.get("GroupNavigationPaneContextMenuItem_UnpublishApp");default:return""}},t.prototype.performActionWithGroupContextMenuItem=function(e,t){switch(e.linkType){case o.Calendar:case o.Conversations:case o.Files:case o.Members:case o.Notebook:this.services.$window.open(e.url,"_blank");break;case o.EditGroup:case o.ViewGroup:case o.LeaveGroup:this.performActionWithNonUrlGroupLinkType(e.linkType,t)}},t.prototype.performActionWithNonUrlGroupLinkType=function(e,t){switch(e){case o.EditGroup:this.services.taskPaneSliderService.expandPane(r.GroupEditorEdit,i.Large,{group:t});break;case o.ViewGroup:this.services.taskPaneSliderService.expandPane(r.GroupEditorView,i.Large,{group:t});break;case o.LeaveGroup:this.leaveGroup(t)}},t.prototype.leaveGroup=function(e){var t=this,i=this.services.errorService,o=i.control(),r=[new InJs.ModalDialogAction(this.localizationService.get("ModalDialogButtonText_Leave"),function(i,r){o.hideDialog(),t.tryLeaveGroup(e)}),new InJs.ModalDialogAction(this.localizationService.get("PBI_Button_Label_Cancel"),function(e,t){o.hideDialog()})],a=this.localizationService.get("GroupEditor_LeaveGroupConfirmation_Title"),n=this.localizationService.get("GroupEditor_LeaveGroupConfirmation_Message");o.showCustomDialog(a,$("<div/>").text(n),r,(function(e){e.parent().find('input[value="'+t.localizationService.get("PBI_Button_Label_Cancel")+'"]').focus()}),!0)},t.prototype.tryLeaveGroup=function(t){var i=this,o=this.services.errorService.control(),r=this.services.promiseFactory.defer(),a=this.services.rootScope.$new(),n={dialogName:null,scope:a,template:'<spinner></spinner><span localize="GroupEditor_WaitLeaveGroup"></span>',containerCssClass:"leaveGroup",isDismissable:!1};this.services.modalDialogService.showLegacyWebModalDialog(n);var s=e.session.UserInfoUtils.getEmailAddressForReceivingMail();if(t.contract.isOwner){var c=this.services.telemetryService,l=c.startEvent(e.telemetry.GroupEditorGetGroupMembers);this.services.groupHttp.getGroupMembers(t.aadGroupId,l.event).then((function(e){if(i.isUserTheOnlyAdmin(s,e.data)){o.hideDialog();var a=[new InJs.ModalDialogAction(i.localizationService.get("ModalDialogButtonText_Ok"),function(e,t){o.hideDialog()})],n=i.localizationService.get("Groups_LeaveGroup_TheOnlyAdmin_Message");o.showCustomDialog("",$("<div/>").text(n),a,null,!0),l.resolve(),r.resolve(!1)}else l.resolve(),i.leaveGroupInternal(t,s).then((function(e){r.resolve(e)}))}),(function(t){o.hideDialog(),i.services.errorService.error(i.localizationService.get("GroupEditor_FailedGetGroupMembers_Message"),"FailedToGetGroupMembers",{requestId:t.requestId,statusCode:t.status.toString()}),l.reject(e.errorDetailsHelper.getTelemetryErrorDetails(t.error,t.status)),r.resolve(!1)}))}else this.leaveGroupInternal(t,s).then((function(e){r.resolve(e)}));return r.promise},t.prototype.leaveGroupInternal=function(t,i){var o=this,r=this.services.promiseFactory.defer(),a=[],n=[{userPrincipalName:i,membershipStatus:e.common.contracts.GroupMembershipStatus.Member}],s={displayName:""},c=this.services.telemetryService,l=c.startEvent(e.telemetry.GroupEditorUserLeaveGroup,!1,t.contract.objectId,t.contract.isReadOnly,0,0),d=this.services.errorService.control();return this.services.groupHttp.updateGroup(t.aadGroupId,s,a,n,null,null,l.event).then((function(i){d.hideDialog(),o.services.groupService.removeGroup(t.aadGroupId),o.services.navigation.navigateToGroupByGUID(e.constants.myWorkSpaceGroupId),l.event.info.groupUpdated=!0;var a=_.filter(i.data,(function(t){return t.membershipStatus!==e.common.contracts.GroupMembershipStatus.Owner})).length;l.event.info.adminCount=a,l.event.info.memberCount=i.data.length-a,l.resolve(),r.resolve(!0)}),(function(t){d.hideDialog(),o.services.errorService.error(o.localizationService.get("GroupEditor_FailedUpdateGroup_Message"),"FailedToUpdateGroup",{requestId:t.requestId,statusCode:t.status.toString()}),l.event.info.groupUpdated=!1,l.reject(e.errorDetailsHelper.getTelemetryErrorDetails(t.error,t.status)),r.resolve(!1)})),r.promise},t.prototype.isUserTheOnlyAdmin=function(t,i){var o=0===_.filter(i,(function(i){return(i.membershipStatus===e.common.contracts.GroupMembershipStatus.Owner||i.membershipStatus===e.common.contracts.GroupMembershipStatus.MemberAndOwner)&&i.userPrincipalName.toLowerCase()!==t.toLowerCase()})).length;return o},t})();e.GroupContextMenuService=a})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e){return new i(e)}e.createGroupService=t;var i=(function(){function t(e){this._isInGroupTransition=!1,this._isGroupTransitionDelayed=!1,this._groups=[],this.groupChangedHandlers=[],this.services=e,this.initializationDeferredOperation=this.services.promiseFactory.defer(),this.initGroupsService()}return t.prototype.resolveGroupSwitchTelemetry=function(){this.perfSwitchGroupEvent&&(this.perfSwitchGroupEvent.resolve(),this.perfSwitchGroupEvent=null)},Object.defineProperty(t.prototype,"isInGroupTransition",{get:function(){return this._isInGroupTransition},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isGroupTransitionDelayed",{get:function(){return this._isGroupTransitionDelayed},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this._groups},enumerable:!0,configurable:!0}),t.prototype.getGroup=function(e){var t=_.findIndex(this._groups,(function(t){return t.aadGroupId===e}));return this._groups[t]},t.prototype.addGroup=function(t){var i=new e.models.Group(t);this._groups.push(i)},t.prototype.removeGroup=function(t){_.remove(this._groups,(function(e){return e.aadGroupId===t})),this.services.rootScope.$emit(e.constants.groupDeletedEventName)},t.prototype.isMyWorkspace=function(){return!this.activeGroup||this.activeGroup.isMyWorkspace},Object.defineProperty(t.prototype,"activeGroup",{get:function(){var e=this.getGroup(this.services.activeGroupIdService.activeGroupObjectId);return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activeGroupObjectId",{
get:function(){return this.services.activeGroupIdService.activeGroupObjectId},set:function(e){this.services.activeGroupIdService.activeGroupObjectId=e,this.activeGroup?(this.services.activeGroupIdService.isReadOnly=this.activeGroup.contract.isReadOnly&&!this.activeGroup.contract.isOwner,this.services.telemetryService.setHostInfo("isInCapacity",!!this.activeGroup.capacity)):this.services.activeGroupIdService.isReadOnly=!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"datasets",{get:function(){return this.services.modelService.models},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reports",{get:function(){return this.services.reportService.reports},enumerable:!0,configurable:!0}),t.prototype.switchGroup=function(e,t,i,o){this.groupSwitchDeferred&&(this.groupSwitchDeferred.reject(),this.groupSwitchDeferred=null);var r=this.services.navigation,a=r.currentGroupGUID;r.currentGroupGUID=e.aadGroupId,this.switchGroupInternal(e,t,i,o);var n=this.groupSwitchPromise();return n.catch((function(){return r.currentGroupGUID=a})),n},t.prototype.isDataInCurrentGroup=function(){return this.services.modelService.models.length>0||this.services.reportService.reports.length>0||this.services.workbookService.workbooks.length>0},t.prototype.showGroupUpsellMessage=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a;return __generator(this,(function(n){switch(n.label){case 0:return i=this.services.localizationService.get("UpgradeReasonText_Groups"),o=this.services.localizationService.format("UpgradeDialogTitle",[i]),r=this.services.localizationService.format("UpgradeAccount_ProContentProviderMessage",[i.toLocaleLowerCase(),e.common.constants.FreeTrialPeriod]),[4,this.services.lazy("licenseHelper")];case 1:return a=n.sent(),a.displayFeatureDisabledErrorMessage(t,r,o),[2]}}))}))},t.prototype.ensureGroupsInitialization=function(){return this.initializationDeferredOperation.promise},t.prototype.groupSwitchPromise=function(){return this.groupSwitchDeferred?this.groupSwitchDeferred.promise:this.services.promiseFactory.resolve(null)},t.prototype.addGroupChangedHandler=function(e){this.groupChangedHandlers.push(e)},t.prototype.updateActiveGroup=function(e,t){this.activeGroupObjectId=e,this.services.activeGroupIdService.groupDisplayName=t},t.prototype.initGroupsService=function(){var t=this;this.initTemporaryGroupService(),this.services.appMetadataService.getAppMetadata().then((function(e){t.initGroupsServiceFromDashboardContainer(e)}),(function(){t.updateGroups()})),this.services.rootScope.$on(e.common.constants.navigation.stateChangeSuccess,(function(e,i,o,r,a){return t.handleStateChange(i,o,r,a)})),this.services.rootScope.$on(e.constants.dashboardTileRepeatFinishedEvent,this.resolveGroupSwitchTelemetry)},t.prototype.handleStateChange=function(t,i,o,r){var a=this;if(window.appLoadError&&!window.appLoadError.handled&&window.appLoadError.error===e.constants.appLoadErrorGroupNotAccessible&&i&&i.groupGUID===e.constants.myWorkSpaceGroupId)return i.dashboardGUID||this.showGroupNotAccessibleMessage(),window.appLoadError.handled=!0,void(this.activeGroupObjectId=e.constants.myWorkSpaceGroupId);if(this.activeGroupObjectId!==i.groupGUID){var n=this.activeGroupObjectId,s=e.constants.navigation.states.home;t.name===s&&this.services.home.isHomeDashboardSet?this.activeGroupObjectId=this.services.home.homeDashboard.groupId:this.services.navigation.inGroupView()&&this.services.navigation.currentGroupGUID&&(this.activeGroupObjectId=this.services.navigation.currentGroupGUID),this.shouldSwitchGroup(t,i,o,r,n)&&(this.groupSwitchDeferred&&this.groupSwitchDeferred.reject(),this.groupSwitchDeferred=this.services.promiseFactory.defer(),this.ensureGroupsInitialization().then((function(){var o=a.getGroup(t.name===s?a.services.home.homeDashboard.groupId:i.groupGUID);if(o){var r=!1;t.name===s&&(o.lastViewedDashboard=a.services.home.homeDashboard.dashboardId,r=!0),a.perfSwitchGroupEvent=a.services.telemetryService.startEvent(e.telemetry.GroupsSwitchGroup,i.groupGUID),a.switchGroupInternal(o,r,a.perfSwitchGroupEvent,!1)}else a.groupSwitchDeferred.resolve(null)})))}},t.prototype.shouldSwitchGroup=function(t,i,o,r,a){var n=r.groupGUID||this.isValidStateWithEmptyGroupGUID(o)&&a;if(!n)return!1;if(i.groupGUID&&i.groupGUID!==n)return!0;if(t.name===e.constants.navigation.states.home){if(!this.services.home.isHomeDashboardSet)return!1;if(n!==this.services.home.homeDashboard.groupId)return!0}return!1},t.prototype.isValidStateWithEmptyGroupGUID=function(t){var i=t.name;return i===e.constants.navigation.states.recentlyViewed||i===e.constants.navigation.states.workspaces||i===e.constants.navigation.states.home},t.prototype.switchGroupInternal=function(t,i,o,r){var a=this;this.startTimedTransition(),this.groupSwitchDeferred||(this.groupSwitchDeferred=this.services.promiseFactory.defer()),this.updateActiveGroup(t.aadGroupId,t.displayName),this.services.groupHttpService.getGroupDashboardContainer(t,o.event).then((function(o){if(t.aadGroupId===a.activeGroupObjectId){var n=o.data;if(n){a.services.packageService.updatePackageCollection(n.packages),a.services.reportService.updateReportCollection(n.reports),a.services.modelService.updateDatasetCollection(n.models),a.services.workbookService.updateWorkbookCollection(n.workbooks),t.isMyWorkspace&&a.services.appService.updateAppsCollection(n.apps,n.packages);for(var s=0,c=a.groupChangedHandlers;s<c.length;s++){var l=c[s];l.onGroupChanged()}}a.groupSwitchDeferred.resolve(null),a.groupSwitchDeferred=null,a.services.rootScope.$emit(e.constants.groupSwitchedEventName,n,i,!!r),a.endTimedTransition()}}),(function(e){var t=jsCommon.StringExtensions.format("Status:{0} requestId:{1} Details:{2}",e.status.toString(),e.requestId,e.error&&e.error.message?e.error.message:"");o.reject({errorCode:e.error&&e.error.code?e.error.code:"FailToGetGroupDashboardContainer",errorMessage:t}),a.groupSwitchDeferred.reject(),a.groupSwitchDeferred=null,a.showLoadGroupFailedMessage(e.requestId,e.status.toString()),a.endTimedTransition()}))},t.prototype.initTemporaryGroupService=function(){this.loadMyWorkspace(),this.activeGroupObjectId=this.services.navigation.currentGroupGUID?this.services.navigation.currentGroupGUID:e.common.constants.myWorkspaceGroupId},t.prototype.initGroupsServiceFromDashboardContainer=function(e){this.loadGroupsWithActiveDashboard(this.services.userInfo.userMetadata?this.services.userInfo.userMetadata.groups:null,e.activeDashboardId),this.updateGroups(),this.handleUrlQueryString()},t.prototype.handleUrlQueryString=function(){this.services.location.search().needproforgroups&&(this.showGroupUpsellMessage(e.telemetry.LicenseEnforcementOperation.LandingGroups),this.services.location.search("needproforgroups",null))},t.prototype.showLoadGroupFailedMessage=function(e,t){var i=this;this.services.localizationService.ensureLocalization((function(){i.services.errorService.error(i.services.localizationService.get("ErrorMessage_FailedLoadGroup"),"FailedLoadGroup",{requestId:e,statusCode:t})}))},t.prototype.showGroupNotAccessibleMessage=function(){var e=this.services.errorService.control(),t=[new InJs.ModalDialogAction(this.services.localizationService.get("DashboardContainer_Ok"),function(t,i){e.hideDialog()})],i=this.services.localizationService.get("GroupNotAccessibleDialogTitle"),o=this.services.localizationService.get("GroupNotAccessibleDialogMessage");e.showCustomDialog(i,InJs.DomFactory.div().text(o),t,void 0,!0)},t.prototype.updateGroups=function(){var e=this;this.services.userInfo.userMetadataPromise&&this.services.userInfo.userMetadataPromise.then((function(t){var i;e.activeGroup&&(i=e.activeGroup.lastViewedDashboard),e.loadGroupsWithActiveDashboard(t.groups,i),e.services.activeGroupIdService.initialGroupIdReadyPromise.then((function(){e.services.activeGroupIdService.isReadOnly=e.activeGroup.contract.isReadOnly&&!e.activeGroup.contract.isOwner}))}))},t.prototype.loadGroupsWithActiveDashboard=function(e,t){var t=t;this.loadGroups(e),this.activeGroup&&(this.activeGroup.lastViewedDashboard=t),this.initializationDeferredOperation.resolve(null)},t.prototype.loadGroups=function(t){var i=this;if(this._groups=[],this.loadMyWorkspace(),t)for(var o=0,r=t.length;o<r;++o){var a=new e.models.Group(t[o]);!(function(e){i.services.userInfo.findGroupIcon(e.contract.objectId).then((function(t){e.icon=t}))})(a),this._groups.push(a)}},t.prototype.loadMyWorkspace=function(){var t={id:-1,displayName:this.services.localizationService.get("NavigationPane_Groups_MyWorkspace"),objectId:this.services.activeGroupIdService.myWorkspaceGroupId,groupType:e.common.contracts.GroupType.Unknown,isOwner:!1,isPublic:!1,isReadOnly:!1,mailNickname:""},i=new e.models.Group(t);i.isMyWorkspace=!0,this._groups.push(i)},t.prototype.startTimedTransition=function(){var e=this;this._isInGroupTransition=!0,this._isGroupTransitionDelayed=!1,this._groupTransitionTimeoutPromise&&this.services.timeout.cancel(this._groupTransitionTimeoutPromise),this._groupTransitionTimeoutPromise=this.services.timeout((function(){e._isGroupTransitionDelayed=!0}),t.switchGroupTimeLimit)},t.prototype.endTimedTransition=function(){this._isInGroupTransition=!1,this._isGroupTransitionDelayed=!1,this.services.timeout.cancel(this._groupTransitionTimeoutPromise)},t})();i.switchGroupTimeLimit=1e3,e.Groups=i})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t){return new o(e,t)}var i=e.models.HistoryDialogModel;e.createHistoryDialogService=t;var o=(function(){function e(e,t){this.rootScope=e,this.compile=t,this.parameters=new i,this.serviceScope=this.rootScope.$new(),this.serviceScope.historyDialogParameters=this.parameters}return e.prototype.showHistoryDialog=function(t){var i=this.parameters;i.showHistoryDialog=!0,i.showSpinner=!0,i.datasetModel={},i.datasetModel.dataset=t.dataset,this.historyDialogElement||(this.template=angular.element(e.htmlTemplate),this.historyDialogElement=this.compile(this.template)(this.serviceScope)),$("body").append(this.historyDialogElement)},e.prototype.hideHistoryDialog=function(){var e=this.parameters;e.showHistoryDialog=!1,e.showSpinner=!1},Object.defineProperty(e.prototype,"historyDialogParameters",{get:function(){return this.parameters},enumerable:!0,configurable:!0}),e})();o.htmlTemplate="<history-dialog view-model='historyDialogParameters' ng-if='historyDialogParameters.showHistoryDialog'> </history-dialog>",e.HistoryDialogService=o})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,r,a,n){return new o(e,t,i,r,a,n)}t.createHome=i;var o=(function(){function t(e,t,i,o,r,a){this.rootScope=e,this.errorService=t,this.localizationService=i,this.notificationToast=o,this.telemetryService=r,this.promiseFactory=a,this.onHomeSettingChanged=[],this.resetHomeAtClientSide()}return Object.defineProperty(t.prototype,"isHomeDashboardSet",{get:function(){return this.homeDashboard.dashboardId!==-1},enumerable:!0,configurable:!0}),t.prototype.resetHomeAtClientSide=function(){this.homeDashboard={dashboardId:-1,groupId:"",dashboardObjectId:""};for(var e=0,t=this.onHomeSettingChanged.length;e<t;e++)this.onHomeSettingChanged[e]()},t.prototype.resetHome=function(e){var t=this,i=this.promiseFactory.defer();return this.disableHomeDashboardHelper(e).then((function(e){t.resetHomeAtClientSide(),i.resolve(e)}),(function(e){i.reject(e)})),i.promise},t.prototype.getHomeDashboard=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetHomeDashboard");return i.enableTelemetry=!0,e.common.httpService.get("/powerbi/metadata/user/homedashboard",i)},t.prototype.disableHomeDashboard=function(){var t=this,i=this.localizationService,o=this.errorService.control(),r=[new InJs.ModalDialogAction(i.get("Jumps_Dialog_Confirm"),function(r,a){o.hideDialog();var n=t.notificationToast.notify({message:i.get("DisablingFeaturedDashboard"),notificationType:e.common.NotificationToastType.Loading}),s=t.telemetryService.startEvent(e.telemetry.DashboardDisableHomeDashboard,t.homeDashboard.dashboardObjectId);t.resetHome(s.event).then((function(o){t.notificationToast.notify({title:i.get("SetFeaturedDashboardSuccessTitle"),message:i.get("DisableFeaturedDashboardSuccessContent"),notificationType:e.common.NotificationToastType.Success}),s.resolve()}),(function(e){t.errorService.error(i.get("SetFeaturedDashboardFailed"),"SetFeaturedDashboardFailed",{requestId:e.requestId,statusCode:e.status.toString()}),s.reject()})).finally((function(){t.notificationToast.hide(n)}))}),new InJs.ModalDialogAction(i.get("ExplorationNavigationTab_Cancel"),function(e,t){o.hideDialog()})];o.showPrompt(i.get("DisableFeaturedDashboardTitle"),i.get("DisableFeaturedDashboardContent"),r,!1)},t.prototype.isOnHomeDashboard=function(e){return this.homeDashboard.dashboardObjectId===e},t.prototype.setHomeDashboard=function(t,i,o,r){var a=this,n=this.localizationService,s=this.notificationToast.notify({message:n.get("SettingFeaturedDashboard"),notificationType:e.common.NotificationToastType.Loading}),c=this.telemetryService.startEvent(e.telemetry.DashboardSetHomeDashboard,i);this.setHomeDashboardHelper(t,c.event).then((function(s){a.notificationToast.notify({title:n.get("SetFeaturedDashboardSuccessTitle"),message:a.localizationService.format("SetFeaturedDashboardSuccessContent",[o]),notificationType:e.common.NotificationToastType.Success}),a.homeDashboard.dashboardId=t,a.homeDashboard.groupId=r,a.homeDashboard.dashboardObjectId=i;for(var l=0,d=a.onHomeSettingChanged.length;l<d;l++)a.onHomeSettingChanged[l]();c.resolve()}),(function(e){a.errorService.error(n.get("Dashboard_RefreshCompletedFailure"),"Dashboard_RefreshCompletedFailure",{requestId:e.requestId,statusCode:e.status.toString()}),c.reject()})).finally((function(){a.notificationToast.hide(s)}))},t.prototype.setHomeDashboardDialog=function(e,t){var i=this,o=this.errorService.control(),r=this.localizationService,a=[new InJs.ModalDialogAction(r.get("SetFeaturedDashboardButton"),function(r,a){o.hideDialog(),i.setHomeDashboard(e.id,e.objectId,e.displayName,t)}),new InJs.ModalDialogAction(r.get("ExplorationNavigationTab_Cancel"),function(e,t){o.hideDialog()})],n=e.displayName;if(this.homeDashboard.dashboardId===-1){var s=r.format("SetFeaturedDashboardContent",[n]);o.showPrompt(r.get("SetFeaturedDashboardTitle"),s,a,!1)}else{var s=r.format("ChangeFeaturedDashboardContent",[n]);o.showPrompt(r.get("ChangeFeaturedDashboardTitle"),s,a,!1)}},t.prototype.setHomeDashboardHelper=function(t,i){var o=e.common.httpService.powerbiRequestOptions(i,"SetHomeDashboard");return o.enableTelemetry=!0,e.common.httpService.post("/powerbi/metadata/user/homedashboard/"+t,null,o)},t.prototype.disableHomeDashboardHelper=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"DeleteHomeDashboard");return i.enableTelemetry=!0,e.common.httpService.delete("/powerbi/metadata/user/homedashboard",i)},t})();t.Home=o})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,n){return new c(e,t,i,o,r,a,n)}var o,r=e.dataServices.ContractUtils,a=e.dataServices.models.Tile,n=e.dataServices.contracts.TileType,s=e.dataServices.models.WorkbookTileModel;!(function(e){e[e.Failure=0]="Failure",e[e.Success=1]="Success"})(o=t.InFocusable||(t.InFocusable={})),t.createInFocusService=i;var c=(function(){function t(e,t,i,o,r,a,n){this.rootScope=e,this.telemetryService=t,this.modelConverter=i,this.modelService=o,this.reportService=r,this.localizationService=a,this.visualPlugin=n,this.inFocusTile=null}return t.prototype.view=function(e,t,i){this.inFocusTile=e,e.type===n.workbook?this.openInFocusWorkbookTile(e,t):e.type===n.realTime?this.openInFocusRealTimeTile(e):this.openInFocusTile(e,t,i)},t.prototype.openInFocusTile=function(t,i,o){this.rootScope.$emit(e.constants.openInFocusTileActionName,{modelId:t.contract.modelId,openInsightArgs:i,runScopedInsights:o})},t.prototype.openInFocusWorkbookTile=function(i,o){var r=t.cloneWorkbookTileModelForInFocusUse(i.workbook,this.localizationService),a=r.tileModel.layoutPosition;a.width=Math.floor(i.gridLayoutContext.getGridWidth()/e.common.GridLayoutConstants.defaultGridWidth),a.height=Math.floor(i.gridLayoutContext.getGridHeight()/e.common.GridLayoutConstants.defaultGridHeight),this.rootScope.$emit(e.constants.openInFocusWorkbookTileActionName,{workbook:r})},t.prototype.openInFocusRealTimeTile=function(t){this.rootScope.$emit(e.constants.openInFocusRealTimeTileActionName,t)},t.prototype.exit=function(){this.inFocusTile=null,this.showVisualEnabled=!1},t.prototype.getInFocusState=function(t){if(!t)return o.Failure;switch(t.type){case n.composite:var i=t.composite&&t.composite.visual;if(i&&i.type!==e.visuals.plugins.image.name)try{var a=t.contract.query,s=r.convertToSemanticQueryWithDataShapeBinding(a);if(s&&s.defn&&s.defn.Version>=2&&_.isEmpty(s.defn.Transform))return o.Success}catch(e){}break;case n.workbook:case n.realTime:return o.Success}return o.Failure},t.cloneWorkbookTileModelForInFocusUse=function(e,t){var i=new s(null,null);return jQuery.extend(i,e),i.tileModel=new a(null,t),jQuery.extend(i.tileModel,e.tileModel),i.tileModel.layoutPosition=_.cloneDeep(e.tileModel.layoutPosition),i},t})();t.InFocusService=c})(t=e.services||(e.services={}))})(powerbi||(powerbi={})),define("powerBI/services/insightsBootstrap",["require","exports"],(function(e,t){"use strict";function i(e,t,i,o,a,n,s){return new r(e,t,i,o,a,n,s)}var o=powerbi.insights.contracts.wireContracts.RequestOptions;t.create=i;var r=(function(){function e(e,t,i,o,r,a,n){this.insightsService=e,this.modelService=t,this.navigationService=i,this.telemetryService=o,this.notificationToastService=r,this.localizationService=a,this.appService=n}return e.prototype.start=function(e,t,i,o){var r=this.modelService.findModelByDBName(e,i);if(r){var a=this.appService.getAppInstance(i),n=a&&a.providerContract.providerKey,s=this.insightsService.getInsightsStatus(r.contract),c=this.navigationService;switch(s){case 2:c.showInsightsPanel({groupGUID:c.currentGroupGUID,dataGUID:e,insightsSource:o,appGUID:n});break;case 0:this.getInsights(r,o,c.currentGroupGUID,n)}}},e.prototype.getInsights=function(e,t,i,r){return __awaiter(this,void 0,powerbi.Promise,(function(){var a,n,s,c,l,d,p,u;return __generator(this,(function(v){switch(v.label){case 0:return a=powerbi.telemetry.InsightEntryPoint.NavigationPane,t===powerbi.insights.constants.insightsSourceToast&&(a=powerbi.telemetry.InsightEntryPoint.Notification),n=this.telemetryService.startEvent(powerbi.telemetry.InsightsShowInsights,0,a,e.contract.contentProviderId,powerbi.getHashCode(e.contract.dbName),!1),s={model:e.contract,requestOptions:o.ThoroughMode},c=this.showInsightsLoadingNotification(e),[4,this.insightsService.getInsights(s,n.event)];case 1:return l=v.sent(),d=l.insightContainers,p=_.size(d),u=p>0,n.event.info.insightCount=p,l.isError&&!u?n.reject():n.resolve(),this.notificationToastService.hide(c),this.showInsightsLoadedNotification(e,u,i,r),[2]}}))}))},e.prototype.showInsightsLoadingNotification=function(e){return this.notificationToastService.notify({title:this.localizationService.get("Insights_LoadingTitle"),message:this.localizationService.format("Insights_LoadingSubtitle",[e.displayName]),notificationType:common.NotificationToastType.Loading,sticky:!0})},e.prototype.showInsightsLoadedNotification=function(e,t,i,o){var r=this,a=this.localizationService,n={displayText:a.get("Insights_FinishedLoadingButtonText"),action:function(){r.navigationService.showInsightsPanel({groupGUID:i,dataGUID:e.dbName,insightsSource:powerbi.insights.constants.insightsSourceToast,appGUID:o})}},s={displayText:a.get("LearnMore"),action:function(){window.open(powerbi.insights.constants.zeroInsightsLink,"_blank")}};t?this.notificationToastService.notify({title:a.get("Insights_FinishedLoadingTitle"),message:a.format("Insights_FinishedLoadingSubtitle",[e.displayName]),notificationType:common.NotificationToastType.Success,actionButtons:[n],sticky:!0}):this.notificationToastService.notify({title:a.get("Insights_FinishedLoadingNoInsightsTitle"),message:a.format("Insights_FinishedLoadingNoInsightsSubtitle",[e.displayName]),notificationType:common.NotificationToastType.NoIcon,actionButtons:[s]})},e})()}));var powerbi;!(function(e){function t(e,t,i,o,a,n,s){return new r(e,t,i,o,a,n,s)}var i=e.common.constants;e.createLicenseEnforcementSevice=t;var o=7,r=(function(){function t(e,t,o,r,a,n,s){var c=this;this.analyzeInExcelService=e,this.licenseStrategyFactory=t,this.rootScope=o,this.userInfoService=r,this.lazy=a,this.checkUnsavedService=n,this.userNotificationInfoService=s,this.rootScope.$on(i.navigation.stateChangeStart,(function(e,t,i,o,r){c.handleStateChange(e,t,i,o,r)})),e.onBeforeAnalyzeInExcel=function(){return c.supportsAnalyzeInExcel(!0)}}return t.prototype.accept2017ProTrial=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,this.lazy("licenseHelper")];case 1:return e=t.sent(),e.accept2017proTrial(),[2]}}))}))},t.prototype.supportsDashboard=function(e,t,i){return this.licenseCheckStrategy.checkForDashboard(e,t,i)},t.prototype.dashboardHasProFeatures=function(e){return this.licenseCheckStrategy.dashboardHasProFeatures(e)},t.prototype.supportsQueryRefresh=function(e){return this.licenseCheckStrategy.supportsQueryRefresh(e)},t.prototype.supportsReport=function(e,t){return this.licenseCheckStrategy.checkForReport(e,!!t)},t.prototype.supportsDataset=function(e,t){return this.licenseCheckStrategy.checkForDataset(e,!!t)},t.prototype.supportsGroups=function(){return this.licenseCheckStrategy.checkForGroups()},t.prototype.supportsUsageMetrics=function(){return this.licenseCheckStrategy.checkForUsageMetrics()},t.prototype.supportsReportEmailSubscription=function(e){return this.licenseCheckStrategy.checkForReportEmailSubscription(!!e)},t.prototype.supportsDashboardEmailSubscription=function(e){return this.licenseCheckStrategy.checkForDashboardEmailSubscription(!!e)},t.prototype.supportsEditDatasetConfiguration=function(e){return this.licenseCheckStrategy.checkForEditDatasetConfiguration(e)},t.prototype.supportsProModels=function(){return this.licenseCheckStrategy.checkForProModels()},t.prototype.supportsScriptVisuals=function(){return this.licenseCheckStrategy.checkForScriptVisuals()},t.prototype.supportsOrgApps=function(){return this.licenseCheckStrategy.checkForOrgApps()},t.prototype.supportsApps=function(e){return this.licenseCheckStrategy.checkForApps(!!e)},t.prototype.supportsPremiumContentProviders=function(){return this.licenseCheckStrategy.checkForPremiumContentProviders()},t.prototype.supportsSharing=function(e){return this.licenseCheckStrategy.checkForSharing(!!e)},t.prototype.supportsExportToPowerPoint=function(e){return this.licenseCheckStrategy.checkForExportToPowerPoint(!!e)},t.prototype.supportsAnalyzeInExcel=function(e){return this.licenseCheckStrategy.checkForAnalyzeInExcel(!!e)},Object.defineProperty(t.prototype,"licenseCheckStrategy",{get:function(){return this.strategy||(this.strategy=this.licenseStrategyFactory.create()),this.strategy},enumerable:!0,configurable:!0}),t.prototype.handleStateChange=function(t,o,r,a,n){return __awaiter(this,void 0,e.Promise,(function(){var e,e;return __generator(this,(function(a){switch(a.label){case 0:return this.checkUnsavedService.userHasUnsavedWork?[2]:o.name!==i.navigation.states.report&&o.name!==i.navigation.states.reportPage?[3,3]:r&&r.reportGUID?[4,this.supportsReport(r.reportGUID,!0)]:[3,2];case 1:e=a.sent(),e||t.preventDefault(),a.label=2;case 2:return[3,4];case 3:o.name===i.navigation.states.dataset&&r&&r.datasetDBName&&(e=this.supportsDataset(r.datasetDBName,!0),e||t.preventDefault()),a.label=4;case 4:return[2]}}))}))},t.prototype.createNotificationForTrial=function(){var t=this.userInfoService.userFreeTrialDaysRemaining;!this.userInfoService.userHasPremiumPlan&&(this.userInfoService.userHasFreeTrial||this.userInfoService.userFreeTrialExpired)&&t<=o&&this.userNotificationInfoService&&this.userNotificationInfoService.addClientNotification({id:0,notificationCategory:e.userNotifications.contracts.NotificationCategory.Trial,message:{title:{displayTextResource:this.getTrialNoticeDisplayTitle(t),values:t>1?[{NotificationValueType:1,value:t.toString()}]:null},message:{displayTextResource:this.getTrialNoticeDisplayDescription(t),values:t>1?[{NotificationValueType:1,value:t.toString()}]:null},image:{imageType:6}},action:{resource:{displayTextResource:e.userNotifications.contracts.NotificationResource.UsersNotifications_RequestExtensionLinkText,values:[{NotificationValueType:1,value:i.toString()}]},actionType:1},seen:!1})},t.prototype.showUpgradeDialog=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.lazy("licenseHelper")];case 1:return e=i.sent(),e.displayDialogToUpgrade(t),[2]}}))}))},t.prototype.showTrialDialog=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(i){switch(i.label){case 0:return[4,this.lazy("licenseHelper")];case 1:return e=i.sent(),e.displayDialogToAcceptTrialTerms(t),[2]}}))}))},t.prototype.getTrialNoticeDisplayDescription=function(t){return this.userInfoService.userFreeTrialExpired?e.userNotifications.contracts.NotificationResource.ExtendTrial_TrialExpired:0===t?e.userNotifications.contracts.NotificationResource.UsersNotifications_TrialRunsOutInLessThanADay:1===t?e.userNotifications.contracts.NotificationResource.UsersNotifications_TrialRunsOutInOneDay:e.userNotifications.contracts.NotificationResource.UsersNotifications_TrialRunningOut},t.prototype.getTrialNoticeDisplayTitle=function(t){return this.userInfoService.userFreeTrialExpired?e.userNotifications.contracts.NotificationResource.UsersNotifications_TitleTrialExpired:0===t?e.userNotifications.contracts.NotificationResource.UsersNotifications_TitleTrialRunsOutInLessThanADay:1===t?e.userNotifications.contracts.NotificationResource.UsersNotifications_TitleTrialRunsOutInOneDay:e.userNotifications.contracts.NotificationResource.UsersNotifications_TitleTrialRunningOut},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){var t=e.common.constants,i=e.telemetry.LicenseEnforcementOperation,o=e.common.helpers.ModelConverterHelper,r=e.common.contracts.ModelProperty,a=(function(){function e(e,t,i,o,r,a){this.featureSwitchService=e,this.userInfoService=t,this.reportService=i,this.modelService=o,this.lazy=r,this.localizationService=a}return e.prototype.create=function(){return this.featureSwitchService.featureSwitches.pseudoLocEnabled?new s(this.userInfoService,this.reportService,this.modelService,this.lazy,this.localizationService):new c(this.userInfoService,this.reportService,this.modelService,this.lazy,this.localizationService)},e})();e.LicenseCheckStrategyFactory=a;var n=(function(){function e(e,t,i){this.userInfoService=e,this.lazy=t,this.localizationService=i,this.initializeProFeatures()}return e.prototype.checkForGroups=function(){return this.checkForFeature(i.SwitchGroups)},e.prototype.checkForUsageMetrics=function(){return this.checkForFeature(i.UsageMetrics)},e.prototype.checkForReportEmailSubscription=function(e){return this.checkForFeature(i.ReportEmailSubscription,e)},e.prototype.checkForDashboardEmailSubscription=function(e){return this.checkForFeature(i.DashboardEmailSubscription,e)},e.prototype.checkForScriptVisuals=function(){return this.checkForFeature(i.ScriptVisual)},e.prototype.checkForOrgApps=function(){return this.checkForFeature(i.ConnectContentPacks)},e.prototype.checkForApps=function(e){return this.checkForFeature(i.ConnectApps,e)},e.prototype.checkForProModels=function(){return this.checkForFeature(i.ProModels)},e.prototype.checkForPremiumContentProviders=function(){return this.checkForFeature(i.PremiumContentProviders)},e.prototype.checkForSharing=function(e){return this.checkForFeature(i.Sharing,e)},e.prototype.checkForExportToPowerPoint=function(e){return this.checkForFeature(i.ExportToPowerPoint,e)},e.prototype.checkForAnalyzeInExcel=function(e){return this.checkForFeature(i.AnalyzeInExcel,e)},e.prototype.checkForFeature=function(e,t){var i=this;if(this.userInfoService.isPremiumUser)return!0;var o=!_.contains(this.proFeatures,e);if(!o&&t){var r=this.localizationService;this.lazy("licenseHelper").then((function(t){t.displayFeatureDisabledErrorMessage(e,i.defaultDisabledFeatureMessage,r.get("UpgradeAccount_Title"))}))}return o},Object.defineProperty(e.prototype,"defaultDisabledFeatureMessage",{get:function(){var e=this.localizationService;return this.userInfoService.userFreeTrialExpired?e.get("UpgradeAccount_DisabledFeatureMessageTrialExpired"):e.format("UpgradeAccount_DisabledFeatureMessage",[t.FreeTrialPeriod.toString()])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultDisabledContentMessage",{get:function(){var e=this.localizationService;return this.userInfoService.userFreeTrialExpired?e.get("UpgradeAccount_DisabledContentMessageTrialExpired"):e.format("UpgradeAccount_DisabledContentAccessMessage",[t.FreeTrialPeriod.toString()])},enumerable:!0,configurable:!0}),e})(),s=(function(t){function o(e,i,o,r,a){var n=t.call(this,e,r,a)||this;return n.userInfoService=e,n.reportService=i,n.modelService=o,n.lazy=r,n.localizationService=a,n}return __extends(o,t),o.prototype.initializeProFeatures=function(){this.proFeatures=[i.SwitchGroups,i.UsageMetrics,i.ConnectApps,i.ReportEmailSubscription,i.DashboardEmailSubscription,i.ConnectContentPacks,i.PremiumContentProviders,i.Sharing,i.ExportToPowerPoint,i.AnalyzeInExcel]},o.prototype.checkForDashboard=function(t,i,o){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return this.userInfoService.isPremiumUser?[2,!0]:[2,this.checkForSharedEntityFeaturesV2(t.featuresV2,o)]}))}))},o.prototype.dashboardHasProFeatures=function(t){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2,!1]}))}))},o.prototype.checkForReport=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(o){return this.userInfoService.isPremiumUser?[2,!0]:(e=this.reportService.findReportByGUID(t),[2,this.checkForSharedEntityFeaturesV2(e.contract.featuresV2,i)])}))}))},o.prototype.checkForDataset=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var e,o;return __generator(this,(function(r){switch(r.label){case 0:return this.userInfoService.isPremiumUser?[2,!0]:[4,this.modelService.findModelsByDBName(t)];case 1:return e=r.sent(),o=_.first(e),[2,this.checkForSharedEntityFeaturesV2(o.contract.featuresV2,!!i)]}}))}))},o.prototype.checkForSharedEntityFeaturesV2=function(t,i){var o=!this.hasFeature(t,38);return!o&&i&&this.showUpsellDialog(e.telemetry.LicenseEnforcementOperation.ReportMessage,this.defaultDisabledContentMessage),o},o.prototype.supportsQueryRefresh=function(t){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){return[2,!0]}))}))},o.prototype.checkForEditDatasetConfiguration=function(e){return!0},o.prototype.hasFeature=function(e,t){var i=Math.floor(t/32),o=t%32;return!e||e.length<=i,!!(e[i]&1<<o)},o.prototype.showUpsellDialog=function(t,i,o){return __awaiter(this,void 0,e.Promise,(function(){var e,r;return __generator(this,(function(a){switch(a.label){case 0:return[4,this.lazy("licenseHelper")];case 1:return e=a.sent(),r=this.localizationService,_.isEmpty(i)&&(i=this.defaultDisabledFeatureMessage),_.isEmpty(o)&&(o=r.get("UpgradeAccount_Title")),e.displayFeatureDisabledErrorMessage(t,i,o,"dashboardRequiresProLicenseDialog"),[2]}}))}))},o})(n),c=(function(a){function n(e,t,i,o,r){var n=a.call(this,e,o,r)||this;return n.userInfoService=e,n.reportService=t,n.modelService=i,n.lazy=o,n.localizationService=r,n}return __extends(n,a),n.prototype.initializeProFeatures=function(){this.proFeatures=[i.SwitchGroups,i.UsageMetrics,i.ConnectApps,i.ProModels,i.ReportEmailSubscription,i.DashboardEmailSubscription,i.ScriptVisual,i.ConnectContentPacks,i.PremiumContentProviders]},n.prototype.checkForDashboard=function(i,o,r){return __awaiter(this,void 0,e.Promise,(function(){
var e,a,n,s,c,l;return __generator(this,(function(d){switch(d.label){case 0:return a=this.userInfoService.isPremiumUser,a?[3,2]:[4,this.dashboardHasProFeatures(i)];case 1:a=!d.sent(),d.label=2;case 2:return e=a,e||!r?[3,4]:[4,this.lazy("licenseHelper")];case 3:n=d.sent(),s=this.localizationService,c=s.format("UpgradeAccount_ShareDashboardMessage",[t.FreeTrialPeriod.toString()]),l=s.format("UpgradeAccount_ShareDashboardTitle",[i.displayName]),n.displayFeatureDisabledErrorMessage(o,c,l,"dashboardRequiresProLicenseDialog"),d.label=4;case 4:return[2,e]}}))}))},n.prototype.checkForReport=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var e,o=this;return __generator(this,(function(r){return e=this.reportService.findReportByGUID(t),e?[2,this.checkUserLicenseForModel((function(){return o.modelService.findModels(e.modelId)}),i)]:[2,!1]}))}))},n.prototype.checkForDataset=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var e=this;return __generator(this,(function(o){return[2,this.checkUserLicenseForModel((function(){return e.modelService.findModelsByDBName(t)}),i)]}))}))},n.prototype.supportsQueryRefresh=function(e){var t=this;return this.checkUserLicenseForModel((function(){return t.modelService.findModels(e)}),!1)},n.prototype.checkForEditDatasetConfiguration=function(e){return!!this.checkForProModels()||n.isNonProModel(e)},n.isNonProModel=function(e){if(e.modelFeatures===r.None)return!0;var t=e.modelFeatures===r.HourlyRefresh&&e.refreshSchedule&&e.refreshSchedule.executionTimeHourly&&e.refreshSchedule.executionTimeHourly.indexOf(",")<0,i=!o.onpremGatewayRequired(e)&&_.isEmpty(e.refreshConnections);return t&&i},n.prototype.checkUserLicenseForModel=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a,s,c;return __generator(this,(function(l){switch(l.label){case 0:return this.checkForProModels()?[2,!0]:[4,this.modelService.modelsPromise];case 1:return l.sent(),o=t(),_.isEmpty(o)?[2,!1]:(r=_.first(o),(a=r&&r.contract)?(s=n.isNonProModel(a),s||!i?[3,3]:[4,this.lazy("licenseHelper")]):[2,!1]);case 2:c=l.sent(),c.displayFeatureDisabledErrorMessage(e.telemetry.LicenseEnforcementOperation.ReportMessage,this.localizationService.format("UpgradeAccount_ShareDashboardTitle",[r.contract.displayName]),this.localizationService.get("UpgradeAccount_ReportMessage")),l.label=3;case 3:return[2,s]}}))}))},n.prototype.dashboardHasProFeatures=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i,o,r,a,s;return __generator(this,(function(c){switch(c.label){case 0:return t&&t.ownerInfo&&t.ownerInfo.groupObjectId?[2,!0]:(e=t&&t.modelIds,_.isEmpty(e)?[2,!1]:[4,this.modelService.modelsPromise]);case 1:for(c.sent(),i=this.modelService,o=0;o<t.modelIds.length;o++)if(r=i.findModels(t.modelIds[o]),a=_.first(r),s=a&&a.contract,s&&!n.isNonProModel(s))return[2,!0];return[2,!1]}}))}))},n})(n)})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,n,s,c,l){return new d(e,t,i,o,r,a,n,s,c,l)}function o(e){return{getMRUModels:function(){return e.resolve([])},removeMRU:function(e){},updateMRU:function(e,t,i,o,r,a,n){},findDashboardMRU:function(e){},findAppInstanceMRU:function(e){}}}var r=e.common.contracts.ContentTileType,a=e.models.MRUArtifactType,n=e.models.MRUModel;t.createMostRecentlyUsedService=i,t.createMostRecentlyUsedServicePlaceholder=o;var s="MRU",c=5e3,l=100,d=(function(){function t(e,i,o,r,a,n,c,l,d,p){var u=this;this.groupService=e,this.promiseFactory=i,this.navigation=o,this.telemetryService=r,this.timeoutService=a,this.userSettingsService=n,this.packageService=c,this.dashboardDataService=l,this.reportService=d,this.appService=p,this.mostRecentlyUsedModels=[];var v=this.promiseFactory.defer();this.mostRecentlyUsedLoadedPromise=v.promise,this.groupService.ensureGroupsInitialization().then((function(){u.userSettingsService.getExtendedSettingByKey(s).then((function(e){u.mostRecentlyUsedModels=e?e.map(t.convertToMRUModel):[],v.resolve(null)}))}))}return t.prototype.getMRUModels=function(){var e=this;return this.mostRecentlyUsedLoadedPromise.then((function(){return e.removeRecordsWithInaccessibleGroups(),e.fixMRUEntriesForContentPack(),e.mostRecentlyUsedModels}))},t.prototype.findDashboardMRU=function(e){return _.find(this.mostRecentlyUsedModels,(function(t){return t.objectId===e&&t.type===a.Dashboards}))},t.prototype.findAppInstanceMRU=function(e){return _.find(this.mostRecentlyUsedModels,(function(t){return t.packageid===e&&t.type===a.AppInstance}))},t.prototype.removeMRU=function(e,t){var i=this,o=t?t:this.navigation.currentGroupGUID;this.mostRecentlyUsedLoadedPromise.then((function(t){_.remove(i.mostRecentlyUsedModels,(function(t){return t.objectId===e&&t.workspaceId===o})),i.updateUserSettings()}))},t.prototype.updateMRU=function(e,t,i,o,r,s,c){var d=this;if(r||(r=this.navigation.currentGroupGUID),c){var p=this.appService.getAppInstance(c);p&&(e=a.AppInstance,t=p.objectId,i=p.displayName,s=void 0)}this.mostRecentlyUsedLoadedPromise.then((function(a){var p=_.findIndex(d.mostRecentlyUsedModels,(function(e){return e.objectId===t&&e.workspaceId===r})),u=p>=0?d.mostRecentlyUsedModels.splice(p,1)[0]:new n(e,t,r);u.count++,u.displayName=i,u.lastAccess=new Date,u.packageid=c,u.originalGUID=s,o&&(u.permissions=o),d.mostRecentlyUsedModels.unshift(u),d.mostRecentlyUsedModels.splice(l),d.updateUserSettings()}))},t.prototype.removeRecordsWithInaccessibleGroups=function(){var e=this,t=_.remove(this.mostRecentlyUsedModels,(function(t){return!e.groupService.getGroup(t.workspaceId)}));_.isEmpty(t)||this.updateUserSettings()},t.prototype.updateUserSettings=function(){var i=this;this.updateMRUPromise||(this.updateMRUPromise=this.timeoutService((function(){i.updateMRUPromise=null;var o=i.telemetryService.startEvent(e.telemetry.MostRecentlyUsedServiceUpdateMRUData),r=i.mostRecentlyUsedModels.map(t.convertToMRUContract);i.userSettingsService.updateExtendedSettings(s,r,o)}),c))},t.prototype.fixMRUEntriesForContentPack=function(){for(var t=function(t){if(null!=t.originalGUID&&null!==t.packageid)if(e.helpers.ContentTileHelper.getMRUActualType(t)===r.Dashboard){var o=i.dashboardDataService.findDashboardsByPackageId(t.packageid);if(!_.isEmpty(o)){var a=_.find(o,(function(e){return e.contract.originalDashboardObjectId===t.originalGUID}));a&&(t.objectId=a.objectId)}}else if(e.helpers.ContentTileHelper.getMRUActualType(t)===r.Report){var n=i.reportService.findReportsByPackageId(t.packageid);if(!_.isEmpty(n)){var s=_.find(n,(function(e){return e.contract.originalReportObjectId===t.originalGUID})),c=s&&s.objectId;null!=c&&(t.objectId=c)}}},i=this,o=0,a=this.mostRecentlyUsedModels;o<a.length;o++){var n=a[o];t(n)}},t.convertToMRUContract=function(e){var t={co:e.count,dn:e.displayName,la:e.lastAccess.toISOString(),oid:e.objectId,ty:e.type};return angular.isDefined(e.workspaceId)&&(t.gid=e.workspaceId),angular.isDefined(e.permissions)&&(t.pm=e.permissions),angular.isDefined(e.originalGUID)&&(t.originalid=e.originalGUID),angular.isDefined(e.packageid)&&(t.packageid=e.packageid),t},t.convertToMRUModel=function(e){var t=new n(e.ty,e.oid,e.gid);return t.count=e.co,t.displayName=e.dn,t.lastAccess=new Date(e.la),angular.isDefined(e.gid)&&(t.workspaceId=e.gid),angular.isDefined(e.pm)&&(t.permissions=e.pm),angular.isDefined(e.originalid)&&(t.originalGUID=e.originalid),angular.isDefined(e.packageid)&&(t.packageid=e.packageid),t},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,r){return new o(e,t,i,r)}t.createNavigationStateValidator=i;var o=(function(){function t(t,i,o,r){this.$timeout=t,this.impersonationService=i,this.permissionService=o,this.reportService=r,this.allowedReadOnlyStates=[e.constants.navigation.states.apps,e.constants.navigation.states.landing,e.constants.navigation.states.adminPortal,e.constants.navigation.states.adminPortalCapacities,e.constants.navigation.states.groups,e.constants.navigation.states.group,e.constants.navigation.states.dashboards,e.constants.navigation.states.dashboard,e.constants.navigation.states.dashboardReport,e.constants.navigation.states.dashboardReportPage,e.constants.navigation.states.dashboardReports,e.constants.navigation.states.dashboardWorkbook,e.constants.navigation.states.dashboardWorkbooks,e.constants.navigation.states.inFocusMode,e.constants.navigation.states.insights,e.constants.navigation.states.dashboardQna,e.constants.navigation.states.dashboardQnaStart,e.constants.navigation.states.modelQna,e.constants.navigation.states.settings,e.constants.navigation.states.settingsGroup,e.constants.navigation.states.sharedDashboard,e.constants.navigation.states.sharedDashboardReport,e.constants.navigation.states.sharedDashboardReportPage,e.constants.navigation.states.sharedDashboardReports,e.constants.navigation.states.sharedDashboardWorkbook,e.constants.navigation.states.sharedDashboardWorkbooks,e.constants.navigation.states.home,e.constants.navigation.states.favorites,e.constants.navigation.states.recentlyViewed,e.constants.navigation.states.sharedWithMe,e.constants.navigation.states.contentList,e.constants.navigation.states.manageEmbed,e.constants.navigation.states.workspaces,e.common.constants.navigation.states.report,e.common.constants.navigation.states.reportPage,e.common.constants.navigation.states.reports,e.common.constants.navigation.states.workbook,e.common.constants.navigation.states.workbooks]}return t.prototype.setDefaultStateCallback=function(e){this.navigateToDefaultState=e},t.prototype.validateState=function(e){this.handleStateAccessibility(e)},t.prototype.validateStateChange=function(e,t,i,o,r){this.impersonationService.impersonating&&this.handleImpersonationStateChanging(t,i.reportGUID),this.handleStateAccessibility(t,e,o)},t.prototype.handleImpersonationStateChanging=function(t,i){if(t===e.common.constants.navigation.states.reportPage){var o=this.impersonationService.getImpersonationState().modelId,r=this.reportService.findReportByGUID(i);r&&r.modelId===o||this.impersonationService.clearImpersonation()}else t&&this.impersonationService.clearImpersonation()},t.prototype.handleStateAccessibility=function(e,t,i){var o=this;this.permissionService.isActiveWorkspaceIsReadOnly&&!_.contains(this.allowedReadOnlyStates,e)&&(i&&_.contains(this.allowedReadOnlyStates,i)&&t?t.preventDefault():this.$timeout((function(){o.navigateToDefaultState()})))},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e){return new l(e)}var i=e.dataServices.models.Dashboard,o=e.common.models.Model,r=jsCommon.EnumExtensions,a=e.models.MRUModel,n=e.common.contracts.Permissions,s=e.common.models.Report,c=e.dataServices.models.Workbook;e.createOwnershipService=t;var l=(function(){function e(e){this.packageService=e}return e.prototype.isResourceShareableWithMe=function(e){return e instanceof i||e instanceof s||e instanceof c||e instanceof o||e instanceof a},e.prototype.isResourceSharedWithMe=function(e){switch(!0){case e instanceof i:return e.getPermissions()===n.Read||e.getPermissions()===n.ReadReshare;case e instanceof s:return!1;case e instanceof c:return!e.isOwner()&&!r.hasFlag(e.getPermissions(),n.CopyOnWrite);case e instanceof o:var t=this.packageService.findPackage(e.packageId);return this.permissionsArePersonalized(e.getPermissions(),t);case e instanceof a:return e.permissions===n.Read||e.permissions===n.ReadReshare;default:return!1}},e.prototype.permissionsArePersonalized=function(e,t){var i=n.ReadWrite|n.Explore,o=n.Read|n.Explore,r=null==t?void 0:t.permissions;return void 0===r?(e&n.All)!==n.All&&(e&i)===i:(e&n.All)!==n.All&&(e&o)===o&&(r&n.ReadWrite)===n.ReadWrite},e})();e.OwnershipService=l})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i){return new r(e,t,i)}var i=["moz","ms","webkit"];e.createPageVisibilityService=t;var o="isAppInactive",r=(function(){function e(e,t,i){this.config=e,this.telemetryService=t,this.$document=i;var o=this.getBrowserVisibilityAttributes();o&&(this.browserHiddenAttribute=o.hiddenAttributeName,this.browserVisibilityChangeAttribute=o.visibilityChangeEventName,this.$document.on(this.browserVisibilityChangeAttribute,this.visibilityStateListener.bind(this)),this.services=[])}return e.prototype.register=function(e){var t=this.services;_.contains(t,e)||t.push(e)},e.prototype.unregister=function(e){var t=this.services;_.pull(t,e)},e.prototype.onBrowserTabActive=function(){for(var e=0,t=this.services;e<t.length;e++){var i=t[e];i.resume()}this.telemetryService.setHostInfo(o,!1)},e.prototype.onBrowserHidden=function(){for(var e=0,t=this.services;e<t.length;e++){var i=t[e];i.pause()}this.config.logPageInactiveToTelemetry&&this.telemetryService.setHostInfo(o,!0)},e.prototype.visibilityStateListener=function(){this.$document.prop(this.browserHiddenAttribute)?this.onBrowserHidden():this.onBrowserTabActive()},e.prototype.getBrowserVisibilityAttributes=function(){var e=this.$document,t="hidden",o="visibilitychange";if(void 0!==e.prop(t))return{hiddenAttributeName:t,visibilityChangeEventName:o};for(var r=_.capitalize(t),a=0,n=i;a<n.length;a++){var s=n[a],c=s+r;if(e.prop(c))return{hiddenAttributeName:c,visibilityChangeEventName:s+o}}return null},e})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g,m,f,y,b,S){return new s(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g,m,f,y,b,S)}var i=e.dataServices.ContractUtils,o=e.data.services.DataViewTransformActionsSerializer,r=e.common.contracts.PinData,a=e.explore.util.ScriptVisualsUtil,n=e.dataServices.models.TileFactory;e.createPinTileService=t;var s=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h,g,m,f,y,b){this.telemetryService=i,this.localizationService=o,this.errorService=t,this.rootScope=e,this.modalDialogService=r,this.modelConverter=a,this.visualPlugin=n,this.themeService=s,this.visualStylePresetService=c,this.userSettingsService=l,this.reportService=d,this.modelService=p,this.workbookService=u,this.dashboardService=v,this.packageService=h,this.explorationSerializer=g,this.promiseFactory=m,this.moduleLoader=f,this.featureSwitchService=y,this.modalDialog=this.errorService.control(),this.usageMetricsReport=b}return t.prototype.setSavedReport=function(e){this.savedReport=e},t.prototype.showPinVisualDialog=function(i,o,a,s,c,l){var d,p=l,u=void 0===o?[]:[o],v=void 0===a?[]:[a],h=void 0===s?[]:[s];this.pinEvent=c;var g=void 0!==l,m=!1,f=i&&(i.action.action===e.common.constants.openInsightsActionName||i.action.originalAction===e.common.constants.openInsightsActionName),y=i&&i.action&&!i.action.action&&!i.reportId;if(g||(m=i.action.action===e.common.constants.openQnAActionName||i.action.originalAction===e.common.constants.openQnAActionName),this.isPinFromDashboard=!1,this.isLiveReport=!1,this.pinTileScope=this.createPinTileScope(void 0===o&&!m),g)this.pinTileScope.viewModel.hasTileFormatting=!1,this.formattedTileContract=l;else{p=n.createTileForPinData(this.visualPlugin,i,a);var b=i&&r.getVisualType(i);b&&i.themeName&&i.themeName!==t.defaultTheme&&this.isTileFormattingRequired(b)?i.themeName=void 0:this.pinTileScope.viewModel.hasTileFormatting=!1,d=n.createTileForPinData(this.visualPlugin,i,a),this.formattedTileContract=d}this.dashboardTile=this.modelConverter.convertTile(this.formattedTileContract,v,u,h),this.reportTile=this.modelConverter.convertTile(p,[a],u),this.reportTile.composite&&(this.themeName=this.reportTile.composite.config.themeName),this.setTheme(this.dashboardTile,!1),this.setTheme(this.reportTile,!0),this.pinTileScope.viewModel.needSaveReport=!(o||m||f||s||y),this.createModelDialogWithOptions(this.pinTileScope)},t.prototype.showPinVisualFromDashboardDialog=function(i,o){if(this.pinEvent=o,this.isPinFromDashboard=!0,i.reportTile){var r=i.reportTile.exploration,a=i.contract.sectionId,n=e.explore.SectionUtils.findSectionById(r.contract,a);if(!n)return;var s,c=void 0;if(i.config&&i.config.reportTile){var l=i.config.reportTile;c=l.pod;var d=[];s=l.filters&&this.explorationSerializer.deserializeFilterCollection(l.filters,d,!1)}var p={exploration:r,section:n,reportId:i.contract.reportId,modelId:i.contract.modelId,packageId:i.contract.packageId,isPinFromDashboard:this.isPinFromDashboard,displayText:i.displayText,subDisplayText:i.subDisplayText,action:i.action,filters:s,pod:c,utterance:i.utterance};return this.showPinReportPageDialog(p)}this.isLiveReport=!1;var u=!1;this.pinTileScope=this.createPinTileScope(!1);var v=void 0===i.contractsReport?[]:[i.contractsReport];this.formattedTileContract=i.contract,i.composite&&i.composite.config&&(u=void 0!==i.composite.config.themeName&&i.composite.config.themeName!==t.defaultTheme),this.pinTileScope.viewModel.hasTileFormatting=u;var h=this.createCustomTileForPinData(i,!0),g=void 0;if(i.config&&i.config.workbookTile&&i.workbook&&i.workbook.contract){var m=this.workbookService.findWorkbook(i.workbook.contract.workbookId,i.workbook.contract.packageId);g=m?[m.contract]:void 0}this.dashboardTile=this.modelConverter.convertTile(h,[i.contractsModel],v,g);var f=this.createCustomTileForPinData(i,!1);this.reportTile=this.modelConverter.convertTile(f,[i.contractsModel],v),this.themeName=this.reportTile.composite?this.reportTile.composite.config.themeName:void 0,this.setTheme(this.dashboardTile,!1),this.setTheme(this.reportTile,!0),this.createModelDialogWithOptions(this.pinTileScope)},t.prototype.showPinReportPageDialog=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a,s,c,l,d,p,u,v,h;return __generator(this,(function(g){switch(g.label){case 0:return this.exploration=t.exploration,this.pinEvent=this.createPinEvent(t.isPinFromDashboard),this.isPinFromDashboard=!!t.isPinFromDashboard,this.isLiveReport=!0,this.pinTileScope=this.createPinTileScope(!1),this.pinTileScope.viewModel.needSaveReport=!1,this.pinTileScope.viewModel.hasTileFormatting=!1,o=this.reportService.findReport(t.reportId),r=o?o.modelId:void 0,a=this.modelService.findModel(r),s=a?[a]:[],c=t.section.size,l=c?c.width:void 0,d=c?c.height:void 0,u=o&&this.featureSwitchService.featureSwitches.usageMetricsEnabled&&this.usageMetricsReport.isUsageMetricsContentProvider(o.contentProviderId)&&!_.isEmpty(t.additionalODataFilter),u&&(p=t.additionalODataFilter),v=t.action||{action:e.common.constants.openReportActionName,targetSlideId:t.section.name,filter:p},o?[4,this.generateReportFilters(t,u)]:(this.pinTileScope.viewModel.needSaveReport=!0,this.createModelDialogWithOptions(this.pinTileScope,!0),[2]);case 1:return h=g.sent(),i=n.createReportTileForExploreData(t.reportId,r,t.section.id,t.displayText?t.displayText:o.displayName,t.subDisplayText?t.subDisplayText:t.section.displayName,v,t.pod,h,t.utterance,l,d),this.dashboardTile=this.modelConverter.convertTile(i,s,[o]),this.reportTile=this.modelConverter.convertTile(i,s,[o]),this.themeName=this.getTheme(t.exploration.exploreCanvas),this.setTheme(this.dashboardTile,!1),this.setTheme(this.reportTile,!0),this.createModelDialogWithOptions(this.pinTileScope,!0),[2]}}))}))},t.prototype.generateReportFilters=function(t,i){return __awaiter(this,void 0,e.Promise,(function(){var o,r,a;return __generator(this,(function(n){switch(n.label){case 0:return o=t.filters||[],i?[4,this.loadODataFilterDependencies()]:[3,2];case 1:n.sent(),e.explore.odata&&(r=e.explore.odata.createODataFilterParser(),a=r.tryGetFilters(t.additionalODataFilter),o.push.apply(o,a)),n.label=2;case 2:return[2,o?this.explorationSerializer.serializeFilterCollection(o):void 0]}}))}))},t.prototype.loadODataFilterDependencies=function(){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.promiseFactory.all([this.moduleLoader.require({javascript:"odataFilterParser"}),this.moduleLoader.require({javascript:"odataExplore"})])];case 1:return e.sent(),[2]}}))}))},t.prototype.isScriptVisualInLivePage=function(e){if(e&&e.exploreCanvas&&e.exploreCanvas.visualContainers){var t=e.exploreCanvas.contract.visualContainers;return a.visualContainerHasScriptVisuals(t,this.visualPlugin)}return!1},t.prototype.getTheme=function(e){var i;if(e){var o=e.visualContainers,r=o?o.length:0;r>0&&(i=o[0].themeName)}return i&&i!==t.defaultTheme?i:void 0},t.prototype.createModelDialogWithOptions=function(e,t){var i=t?"liveReport":"pinTile",o={dialogName:null,isDismissable:!0,scope:e,template:"<pin-tile-dialog></pin-tile-dialog>",focusOnFirstButton:!0,dialogCssClass:i};0===this.pinTileScenario&&(o.notificationText=this.localizationService.get("PinTile_Workbook_Changed"),o.notificationType=jsCommon.ModalDialogNotificationType.Info),this.modalDialogService.showLegacyWebModalDialog(o)},t.prototype.createPinEvent=function(t){return this.telemetryService.startEvent(e.telemetry.DashboardPinTile,"reportPage",t?e.telemetry.PinTileSource.Dashboard:e.telemetry.PinTileSource.Report,"",!1,"",!1,"",this.isScriptVisualInLivePage(this.exploration))},t.prototype.createCustomTileForPinData=function(e,a){var s={visualContainer:void 0,dataViewSource:void 0},c=e.contract,l=c&&c.$config;if(l){s.dataViewSource=c.tileDataSet,s.reportId=c.reportId,s.modelId=c.modelId,s.action=e.action,s.utterance=c.query&&c.query.modelQuery?e.contract.query.modelQuery.utterance:void 0,s.tileSubDisplay=e.getSubDisplayText(),s.tileHeading=e.getDisplayText(),s.themeName=!a&&e.composite&&e.composite.config?e.composite.config.themeName:t.defaultTheme,s.resourcePackageIds=c.resourcePackageIds;var d=l.visualContainer||l.realTimeVisual;if(d){s.queryMetadata=d.queryMetadata,s.elements=d.elements,s.tileLayoutType=d.layoutType,s.visualContainer=this.explorationSerializer.deserializeVisualContainer(this.explorationSerializer.serializeVisualContainer(d.$visualContainer));var p=this.visualPlugin.capabilities(r.getVisualType(s));if(p&&p.objects&&d.transform){var u=p.objects,v=JSON.parse(d.transform);s.dataTransforms=o.deserializeDataViewTransformActions(v,u)}}l.realTimeVisual&&(s.realTimeDataWindow=l.realTimeVisual.dataWindow);var h=c.query&&c.query.modelQuery&&c.query.modelQuery.sq,g=h?i.convertToTileDataQuery(c.query):void 0,m=l&&l.tileDataType;g&&(s.query=g),m&&(s.tileDataType=l.tileDataType),c.name&&(s.name=c.name)}var f=s.visualContainer?n.createTileForPinData(this.visualPlugin,s,e.model):n.createNonVisualTileFromExisting(c);return this.modelConverter.resolveTilePackage(f,this.packageService.packages),f},t.prototype.updateTile=function(e){this.formattedTileContract=e?this.dashboardTile.contract:this.reportTile.contract},t.prototype.hideDialog=function(){this.modalDialog&&this.modalDialog.hideDialog()},t.prototype.onPinButtonClickedActions=function(){var t=this.pinTileScope.viewModel.useDashboardFormatting?e.contracts.TileDialogPreviewFormats.DashboardFormat:e.contracts.TileDialogPreviewFormats.ReportFormat;if(this.userSettingsService.updatePinDialogPreviewTileFormat(t,this.pinEvent),this.savedReport){var i=this.savedReport;this.formattedTileContract.reportId=i.id,this.savedReport=null}if(this.modalDialog.hideDialog(),this.pinTileScope.viewModel.useExistingDashboard)this.dashboardService.pinTileWithoutNotification({tile:this.formattedTileContract,dashboardId:parseInt(this.pinTileScope.viewModel.selectedDashboardId,10),parentEvent:this.pinEvent,showNotification:!0,isLiveReport:this.isLiveReport});else{var o={tile:this.formattedTileContract,newDashboardName:this.pinTileScope.viewModel.newDashboardName,parentEvent:this.pinEvent,showNotification:!0,isLiveReport:this.isLiveReport};this.dashboardService.addDashboard(o.newDashboardName,o)}},t.prototype.onSaveAndContinueButtonClickedActions=function(){var t=this;this.rootScope.$emit(e.constants.saveReportFromPinDialog,this.pinTileScope.viewModel.newReportName);var i=this,o=function(){return setInterval((function(){i.savedReport&&clearInterval(o())}),100)};o(),this.pinTileScope.$applyAsync((function(){t.pinTileScope.viewModel.needSaveReport=!1}))},t.prototype.showNotSupportedDialog=function(){var e=this.errorService.control(),t=this.localizationService.get("PinTile_NotSupportedTitle"),i=this.localizationService.get("PinTile_NotSupportedMessage"),o=[new InJs.ModalDialogAction(this.localizationService.get("PinTile_OK"),function(t,i){e.hideDialog()})];e.showCustomDialog(t,$("<div/>").text(i),o,null,!0)},t.prototype.mapCanvasSize=function(t,i){if(t){var o=e.explore.SectionUtils.findSectionIndexForSectionId(t,i);if(t.sections&&t.sections[o]&&void 0!==t.sections[o].size.displayOption){var r=t.sections[o].size;r.displayOption=1}}return t},t.prototype.setTheme=function(i,o){i&&(i.calculateLayout(e.common.GridLayoutConstants.getDefaultGridItemViewport(e.common.GridLayoutConstants.getSmallLandscapeGridItem())),i.applyLayout(),o?(i.composite?(i.composite.config.themeName=this.themeName,i.composite.visual.themeName=this.themeName):i.reportTile&&(i.reportTile.themeName=this.themeName),this.pinTileScope&&this.pinTileScope.viewModel&&(this.pinTileScope.viewModel.reportTile=i)):(i.composite&&(i.composite.config.themeName=t.defaultTheme,i.composite.visual.themeName=t.defaultTheme),this.pinTileScope&&this.pinTileScope.viewModel&&(this.pinTileScope.viewModel.dashboardTile=i,this.pinTileScope.viewModel.workbookTile=i)))},t.prototype.isTileFormattingRequired=function(t){return t!==e.visuals.plugins.textbox.name&&t!==e.visuals.plugins.image.name},t.prototype.createPinTileScope=function(t){var i=this.rootScope.$new();return i.viewModel=new e.models.PinTileDialogModel(null),i.viewModel.needSaveReport=t,i},t})();s.defaultTheme="ThemeNew1",e.PinTileService=s})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e){return new r(e)}var i=e.common.constants,o=jsCommon.BrowserUtils;e.createPrintService=t;var r=(function(){function e(e){var t=this;if(this.rootScope=e,o.isFirefox()||o.isInternetExplorerOrEdge())window.onbeforeprint=function(){return t.enterPrintHandler()},window.onafterprint=function(){return t.exitPrintHandler()};else if(window.matchMedia){var i=window.matchMedia("print");i.addListener((function(e){t.mediaQueryListener(e)}))}}return e.prototype.mediaQueryListener=function(e){e.matches?this.enterPrintHandler():this.exitPrintHandler()},e.prototype.enterPrintHandler=function(){this.rootScope.$emit(i.enterPrintModeEvent)},e.prototype.exitPrintHandler=function(){this.rootScope.$emit(i.exitPrintModeEvent)},e})();e.PrintService=r})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,c,l,d){return new s(e,t,i,o,r,a,n,c,l,d)}var i=e.helpers.RedirectUrlHelper;e.createQRCodeService=t;var o=".qrLoading",r="#fff",a="#333",n="#ccc",s=(function(){function t(e,t,i,o,r,a,n,s,c,l){this.rootScope=e,this.compile=t,this.promiseFactory=i,this.localizationService=o,this.dashboardHttpService=r,this.reportHttpService=a,this.errorService=n,this.modalDialogService=s,this.telemetryService=c,this.moduleLoader=l,this.modalDialog=this.errorService.control(),this.stopQrGeneration=!1}return t.prototype.getQRCodeCanvas=function(e){var t={ecLevel:"M",background:r,text:e,size:180};return this.getPbiQRCodeCanvasWithOptions(t)},t.prototype.showDialogForTile=function(t,i,o,r,a){var n=this;this.showProgressDialog(),this.composeOpenTileRedirectUrl(a,r,o.id,o.objectId,o.originalDashboardObjectId,i.contract.id,i.contract.objectId,i.contract.originalTileObjectId).then((function(t){n.qrCodeScope=n.createQRCodeScope(),n.qrCodeScope.viewModel.displayText=i.getDisplayText(),n.qrCodeScope.viewModel.subDisplayText=i.getSubDisplayText(),n.qrCodeScope.viewModel.url=t,n.qrCodeScope.viewModel.dialogMessage=n.localizationService.get("InFocus_QRCodeDialog_Message"),n.qrCodeScope.viewModel.notificationMessage=n.localizationService.get("InFocus_QRCodeDialog_Notification"),n.telemetryService.logEvent(e.telemetry.QRCodeQRCodeDialogShown,r,o.objectId,i.objectId,a,o.originalDashboardObjectId,i.contract.originalTileObjectId),n.createModelDialogWithOptions(n.qrCodeScope)}))},t.prototype.showDialogForReport=function(t,i,o,r,a,n){var s=this;this.showProgressDialog(),this.composeOpenReportRedirectUrl(r,n,i.id,i.objectId,i.originalReportObjectId,a).then((function(t){s.qrCodeScope=s.createQRCodeScope(),s.qrCodeScope.viewModel.displayText=o,s.qrCodeScope.viewModel.url=t,s.qrCodeScope.viewModel.dialogMessage=s.localizationService.get("Report_QRCodeDialog_Message"),s.qrCodeScope.viewModel.notificationMessage=s.localizationService.get("Report_QRCodeDialog_Notification"),s.telemetryService.logEvent(e.telemetry.QRCodeQRCodeReportDialogShown,r,i.objectId,n,i.originalReportObjectId),s.createModelDialogWithOptions(s.qrCodeScope)}))},t.prototype.showProgressDialog=function(){var e=this.rootScope.$new(),t=this.compile("<qr-code-progress-dialog></qr-code-progress-dialog>")(e);$("body").append(t)},t.prototype.hideQRCodeDialog=function(){this.modalDialog&&this.modalDialog.hideDialog()},t.prototype.hideQRProgressDialog=function(){this.stopQrGeneration=!0,this.closeQRProgressDialog()},t.prototype.closeQRProgressDialog=function(){$("body").find(o).remove()},t.prototype.createModelDialogWithOptions=function(e){var t={dialogName:null,isDismissable:!0,scope:e,template:"<qr-code-dialog></qr-code-dialog>",focusOnFirstButton:!0,dialogCssClass:"qrCode"};this.stopQrGeneration?this.stopQrGeneration=!1:(this.closeQRProgressDialog(),this.modalDialogService.showLegacyWebModalDialog(t))},t.prototype.createQRCodeScope=function(){var t=this.rootScope.$new();return t.viewModel=new e.models.QrCodeDialogModel,t},t.prototype.composeOpenTileRedirectUrl=function(t,o,r,a,n,s,c,l){var d=this,p=this.promiseFactory.defer();return this.dashboardHttpService.getTileShortUrl(r,s,void 0).then((function(i){d.telemetryService.logEvent(e.telemetry.QRCodeShortUrlCreated,t,a,c,o,n,l),p.resolve(i.data)}),(function(r){var s,u="QR";s=_.isEmpty(o)?i.MobileRedirectUrlHelper.getTileRedirectUrl(t,null,a,c,u):i.MobileRedirectUrlHelper.getTileRedirectUrl(null,o,n,l,u),d.telemetryService.logEvent(e.telemetry.QRCodeShortUrlFailed,t,a,c,r.status.toString(),o,n,l),p.resolve(s)})),p.promise},t.prototype.composeOpenReportRedirectUrl=function(t,o,r,a,n,s){var c=this,l=this.promiseFactory.defer();return this.reportHttpService.getReportShortUrl(r,s,void 0).then((function(i){c.telemetryService.logEvent(e.telemetry.QRCodeReportShortUrlCreated,t,a,o,n),l.resolve(i.data)}),(function(r){var d,p="QR";d=_.isEmpty(o)?i.MobileRedirectUrlHelper.getReportRedirectUrl(t,null,a,s,p):i.MobileRedirectUrlHelper.getReportRedirectUrl(null,o,n,s,p),c.telemetryService.logEvent(e.telemetry.QRCodeReportShortUrlFailed,t,a,r.status.toString(),o,n),l.resolve(d)})),l.promise},t.prototype.getQRCodeCanvasWithOptions=function(e){var t=$("<canvas />"),i=t.get(0);return i.width=i.height=e.size,t.qrcode(e),i},t.prototype.getPbiQRCodeCanvasWithOptions=function(e){var t=this;return this.moduleLoader.require({javascript:"jquery-qrcode"}).then((function(){var i=$("<canvas />").get(0);i.width=190;var o=192;i.height=o+13+11+1;var s=i.getContext("2d");s.fillStyle=r,s.fillRect(0,0,i.width,i.height),s.drawImage(t.getQRCodeCanvasWithOptions(e),5,5);var c="Power BI";s.font="13px wf_segoe-ui_semibold",s.fillStyle=a,s.textBaseline="hanging";var l=(i.width-s.measureText(c).width)/2;return s.fillText(c,l,o),s.rect(0,0,i.width,i.height),s.strokeStyle=n,s.lineWidth=2,s.stroke(),i}))},t})();e.QRCodeService=s})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,a){return new r(e,t,i,o,a)}var o=e.common.contracts.RealTimeMode;t.createRealTimeDataService=i;var r=(function(){function e(e,t,i,o,r){this.modelService=t,this.realTimeLongPollDataService=i,this.realTimeLongPubNubDataService=o,this.tabularDataCache=r,this.listenerMap={},i.setCallbacks(this.processMessage.bind(this),this.raiseErrors.bind(this)),o.setCallbacks(this.processMessage.bind(this),this.raiseErrors.bind(this))}return e.prototype.subscribe=function(e,t){if(e&&t){var i=this.tabularDataCache,o=null!=e.originalModelId?e.originalModelId:e.id,r=i.getKey(o,e.tableName),a=this.listenerMap[r]||[];if(!_.contains(a,t)){a.push(t),this.listenerMap[r]=a;var n=i.get(r);if(n)return void t.onDataChanged();i.add({modelId:o,name:e.tableName,rowGroups:null,columns:this.getColumnMetadata(e.schema)});var s=this.resolveDataService(e);s&&s.subscribe(e)}}},e.prototype.unsubscribe=function(e,t){
if(e&&t){var i=this.tabularDataCache,o=null!=e.originalModelId?e.originalModelId:e.id,r=i.getKey(o,e.tableName),a=this.listenerMap[r];if(a&&(_.pull(a,t),_.isEmpty(a))){delete this.listenerMap[r],i.remove(r);var n=this.resolveDataService(e);n&&n.unsubscribe(e)}}},e.prototype.pause=function(){this.realTimeLongPollDataService.pause(),this.realTimeLongPubNubDataService.pause()},e.prototype.resume=function(){this.realTimeLongPollDataService.resume(),this.realTimeLongPubNubDataService.resume()},e.prototype.replaceListener=function(e,t,i){var o=null!=e.originalModelId?e.originalModelId:e.id,r=this.tabularDataCache.getKey(o,e.tableName),a=this.listenerMap[r]||[];this.listenerMap[r]=a;var n=_.remove(a,(function(e){return e===t}));_.isEmpty(n)||a.push(i)},e.prototype.processMessage=function(e){if(e){var t=this.tabularDataCache,i=t.getKey(e.modelId,e.name);if(_.isEmpty(e.rowGroups)){if(e.lastVersion){var o=this.tabularDataCache.get(i);o&&(o.lastVersion=e.lastVersion)}}else{t.mergeRows(e.modelId,e.name,e.rowGroups,e.lastVersion);var r=this.listenerMap[i];if(r)for(var a=0,n=r;a<n.length;a++){var s=n[a];s.onDataChanged()}}}},e.prototype.raiseErrors=function(e,t){for(var i=[],o=0,r=e;o<r.length;o++){var a=r[o],n=this.tabularDataCache.getKey(a.id,a.tableName);i.push(n)}i=_.uniq(i);for(var s=0,c=i;s<c.length;s++){var n=c[s],l=this.listenerMap[n];if(!l)return;for(var d=0,p=l;d<p.length;d++){var u=p[d];u.onError(t)}}},e.prototype.getColumnMetadata=function(e){if(e){var t=e.entities;if(!_.isEmpty(t)){var i=_.first(t);if(!_.isEmpty(i.properties)){for(var o=[],r=0,a=i.properties;r<a.length;r++){var n=a[r];o.push({name:n.name,type:n.type})}return o}}}},e.prototype.resolveDataService=function(e){var t=this.modelService.findModel(e.id,e.packageId);if(t)switch(t.realTimeMode){case o.CacheOnly:case o.PersistAndCache:return this.realTimeLongPollDataService;case o.PubNubCacheOnly:return this.realTimeLongPubNubDataService}},e})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a){return new u(e,t,i,o,r,a)}var o=jsCommon.JsonExtensions,r=e.data.tabular.MaxRealTimeDataWindowInMs,a=e.data.MessageExceedLimitClientError,n=e.data.RealTimeGetHistoryClientError,s=e.data.RealTimeLongPollError,c=20,l=12e4;t.createRealTimeLongPollDataService=i;var d,p="realTimeErrorCode";!(function(e){e[e.None=0]="None",e[e.MaximumDataExceeded=1]="MaximumDataExceeded"})(d||(d={}));var u=(function(t){function i(e,i,o,r,a,n){var s=t.call(this,e,a)||this;return s.tabularDataService=i,s.telemetryService=r,s.realTimeDataHttpService=o,s.activeRealTimeModelIds=[],s.options=n,s}return __extends(i,t),i.prototype.setCallbacks=function(e,t){this.updateCallback=e,this.errorCallback=t},i.prototype.subscribe=function(e){e&&(_.contains(this.activeRealTimeModelIds,e)||(this.activeRealTimeModelIds.push(e),this.delayedGetHistory()))},i.prototype.unsubscribe=function(e){e&&(_.remove(this.activeRealTimeModelIds,e),this.delayedGetUpdate())},i.prototype.resume=function(){this.paused=!1,this.delayedGetHistory()},i.prototype.getRequest=function(){for(var e=[],t=this.tabularDataService,i=0,o=this.activeRealTimeModelIds;i<o.length;i++){var r=o[i],a=null!=r.originalModelId?r.originalModelId:r.id,n=t.getKey(a,r.tableName),s=t.get(n);e.push({id:s.modelId,packageId:r.packageId,tableName:s.name,version:s.lastVersion?s.lastVersion:0})}if(!_.isEmpty(e))return{models:e}},i.prototype.getEndpointUrl=function(){return"powerbi/refresh/rtsubscribe"},i.prototype.processResponse=function(e){e&&this.processUpdates(e.results)},i.prototype.processError=function(){this.telemetryService.logEvent(e.telemetry.RealTimeLongPollError),this.errorCallback(this.activeRealTimeModelIds,(new s).getDetails(e.common.localize))},Object.defineProperty(i.prototype,"longPollDurationInMs",{get:function(){return l},enumerable:!0,configurable:!0}),i.prototype.delayedGetHistory=function(){var e=this,t=this.timeout;t.cancel(this.getHistoryHandle),this.getHistoryHandle=this.timeout((function(){return e.getHistory()}),c)},i.prototype.delayedGetUpdate=function(){var e=this,t=this.timeout;t.cancel(this.getUpdateHandle),this.getUpdateHandle=t((function(){e.getUpdate()}),c)},i.prototype.getUpdate=function(){this.options.enableDataRefresh&&(this.cancelCurrentRequest(),_.isEmpty(this.activeRealTimeModelIds)||this.startMonitoring())},i.prototype.getHistory=function(){for(var t=this,i=[],o=0,a=this.activeRealTimeModelIds;o<a.length;o++){var s=a[o],c=null!=s.originalModelId?s.originalModelId:s.id;i.push({modelId:c,tableName:s.tableName,fromMilliseconds:r})}_.isEmpty(i)||this.realTimeDataHttpService.getHistory(i).then((function(e){e&&t.processUpdates(e.data),t.getUpdate()}),(function(){var i=(new n).getDetails(e.common.localize);t.errorCallback(t.activeRealTimeModelIds,i)}))},i.prototype.processUpdates=function(t){if(!_.isEmpty(t))for(var o=0,r=t;o<r.length;o++){var a=r[o];if(a){var n=i.convertToDataRowGroup(a.rows);if(!_.isEmpty(n)){var s=i.checkForError(n);s&&this.errorCallback([a],s.getDetails(e.common.localize)),n=i.filterOutErrorRow(n);var c={modelId:a.id,name:a.tableName,rowGroups:n,lastVersion:a.version};this.updateCallback(c)}}}},i.checkForError=function(e){var t=_.last(e);if(t){var o=_.first(t.rows);if(o){var r=o[p];return r?i.getErrorForCode(r):void 0}}},i.filterOutErrorRow=function(e){for(var t=[],i=0,o=e;i<o.length;i++){var r=o[i];_.remove(r.rows,(function(e){return null!=e[p]})),_.isEmpty(r.rows)||t.push(r)}return t},i.getErrorForCode=function(e){switch(e){case jsCommon.EnumExtensions.toString(d,d.MaximumDataExceeded):return new a}},i.convertToDataRowGroup=function(e){var t=[];if(_.isEmpty(e))return t;for(var i=0,r=e;i<r.length;i++){var a=r[i],n=a&&a.data,s=o.tryParseJSON(n);_.isEmpty(s)||t.push({version:a.version,rows:s})}return t},i})(e.common.LongPollServiceBase)})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,s,c){return new n(e,t,i,o,r,a,s,c)}var o=e.errorDetailsHelper,r=e.dataServices.models.RealTimeModel,a=e.dataServices.models.RealTimeModelUtility;t.createRealTimeModelService=i;var n=(function(){function t(e,t,i,o,r,a,n,s){this.conceptualSchemaProxy=e,this.errorService=t,this.localizationService=i,this.modelService=o,this.promiseFactory=r,this.realTimeDataHttpService=a,this.telemetryService=n,this.timeoutService=s,this.selectedModelId=null}return t.prototype.setSelected=function(e){this.selectedModelId=e,this.selectedModel=null},t.prototype.getSelected=function(){var e=this;if(this.selectedModel)return this.promiseFactory.resolve(this.selectedModel);var t=this.getModel(this.selectedModelId);return t.then((function(t){e.selectedModel=t})),t},t.prototype.createModel=function(t){var i=this,a=this.promiseFactory.defer(),n=this.getColumnStatistic(t.columns),s=this.telemetryService.startEvent(e.telemetry.RealTimeAddUpdateRemoveStreamingDataset,e.telemetry.CreateUpdateDeleteAction.Create,n.dateTimeColumnCount,n.numericColumnCount,n.stringColumnCount,t.mode);return this.realTimeDataHttpService.createDataset(t).then((function(e){var o=new r(e.data,t);o.isNew=!0,i.selectedModel=o,s.resolve(),a.resolve(o)}),(function(e){i.errorService.error(i.localizationService.get("StreamingDataset_FailedToCreateDataset"),"StreamingDataset_FailedToCreateDataset",{requestId:e.requestId,statusCode:e.status.toString()}),s.reject(o.getTelemetryErrorDetails(e.error,e.status)),a.reject()})),a.promise},t.prototype.getModel=function(t){var i=this,n=this.promiseFactory.defer();if(!t||t<0)return n.resolve(null),n.promise;var s=_.first(this.modelService.findModels(t)),c=this.telemetryService.startEvent(e.telemetry.RealTimeGetStreamingDataset);return this.realTimeDataHttpService.getDataset(t).then((function(e){var o=a.getRealTimeDataSource(t),l=e.data;c.resolve(),i.conceptualSchemaProxy.get(o).then((function(e){var t=new r(l,r.createRealTimeDatasetDefinition(s.displayName,s.realTimeMode,e));n.resolve(t)}),(function(){n.reject(null)}))}),(function(e){i.errorService.error(i.localizationService.get("StreamingDataset_FailedToLoadDataset"),"StreamingDataset_FailedToLoadDataset",{requestId:e.requestId,statusCode:e.status.toString()}),c.reject(o.getTelemetryErrorDetails(e.error,e.status)),n.reject(null)})),n.promise},t.prototype.getAndSelectEmptyModel=function(){var t=e.models.modelFactory.createDefaultRealTimeModel();return this.selectedModel=t,t},t.prototype.updateModel=function(t,i){var r=this,n=this.promiseFactory.defer(),s=this.getColumnStatistic(t.columns),c=this.telemetryService.startEvent(e.telemetry.RealTimeAddUpdateRemoveStreamingDataset,e.telemetry.CreateUpdateDeleteAction.Update,s.dateTimeColumnCount,s.numericColumnCount,s.stringColumnCount,t.mode),l=a.getRealTimeDataSource(i||this.selectedModelId);return this.conceptualSchemaProxy.clearCache(null,l),this.realTimeDataHttpService.updateDataset(i||this.selectedModelId,t).then((function(){c.resolve(),n.resolve({})}),(function(e){r.errorService.error(r.localizationService.get("StreamingDataset_FailedToUpdateDataset"),"StreamingDataset_FailedToUpdateDataset",{requestId:e.requestId,statusCode:e.status.toString()}),c.reject(o.getTelemetryErrorDetails(e.error,e.status)),n.reject(null)})),n.promise},t.prototype.deleteModel=function(t){var i=this.modelService.findModel(t);this.telemetryService.logEvent(e.telemetry.RealTimeAddUpdateRemoveStreamingDataset,e.telemetry.CreateUpdateDeleteAction.Delete,null,null,null,i.realTimeMode),this.modelService.deleteModel(t),this.selectedModelId===t&&(this.selectedModelId=null,this.selectedModel=null)},t.prototype.getColumnStatistic=function(e){for(var t={dateTimeColumnCount:0,numericColumnCount:0,stringColumnCount:0},i=0,o=e;i<o.length;i++){var r=o[i];2===r.dataType?t.dateTimeColumnCount++:1===r.dataType?t.numericColumnCount++:0===r.dataType&&t.stringColumnCount++}return t},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a){return new c(e,t,i,o,r,a)}var o=e.errorDetailsHelper,r=e.dataServices.models.RealTimeModelUtility,a=e.data.RealTimePubNubGetCredentialsClientError;t.createRealTimePubNubDataService=i;var n=200,s=5e3,c=(function(){function t(e,t,i,o,r,a){this.promiseFactory=e,this.realTimeDataHttpService=t,this.tabularDataService=i,this.telemetryService=o,this.moduleLoader=r,this.timeout=a,this.modelCredentialMap={},this.pubNubConnectionMap={}}return t.prototype.getPubNub=function(){return this.moduleLoader.require({javascript:"pubnub"})},t.prototype.setCallbacks=function(e,t){this.updateCallback=e,this.errorCallback=t},t.prototype.pause=function(){this.toggleSubscribe(1)},t.prototype.resume=function(){this.toggleSubscribe(0)},t.prototype.toggleSubscribe=function(e){var t=this;_.forOwn(this.modelCredentialMap,(function(i,o){var r=t.getConnectionKey(i),a=t.pubNubConnectionMap[r],n=a&&a.instance;if(n)for(var s=Object.keys(a.channelListeners),c=0,l=s;c<l.length;c++){var d=l[c];0===e?n.subscribe({channel:d,message:function(e,o,r,a){t.processMessage(i,e,o[1])}}):n.unsubscribe({channel:d})}}))},t.prototype.subscribe=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i,o,r,a,s,c,l=this;return __generator(this,(function(d){switch(d.label){case 0:return t?[4,this.getCredentials(t)]:[2];case 1:return e=d.sent(),[4,this.getPubNub()];case 2:return i=d.sent(),o=this.getConnectionKey(e),r=this.pubNubConnectionMap[o],r||(a={message:function(t){l.processMessage(e,t.message,t.timetoken)}},r={instance:new i({subscribeKey:e.subscriptionKey,authKey:e.authKey,ssl:!0,noleave:!0,windowing:n}),channelListeners:{},listener:a},r.instance.addListener(a),this.pubNubConnectionMap[o]=r),s=e.channelName,c=r.channelListeners[s],_.isEmpty(c)&&(r.instance.subscribe({channels:[s]}),c=r.channelListeners[s]=[]),c.push(t),[2]}}))}))},t.prototype.unsubscribe=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i,o,r,a,n;return __generator(this,(function(s){switch(s.label){case 0:return t?[4,this.getCredentials(t)]:[2];case 1:return e=s.sent(),[4,this.getPubNub()];case 2:return s.sent(),i=e.channelName,o=this.getConnectionKey(e),r=this.pubNubConnectionMap[o],a=r&&r.channelListeners[i],a&&(_.remove(a,t),_.isEmpty(a)&&(delete r.channelListeners[i],n=r.instance,n.removeListener(r.listener),n.unsubscribe({channels:[i]}),_.isEmpty(Object.keys(r.channelListeners))&&delete this.pubNubConnectionMap[o])),[2]}}))}))},t.prototype.detectPubNubColumnsDefinition=function(t){return __awaiter(this,void 0,e.Promise,(function(){var e,i,o,a,n,c,l;return __generator(this,(function(d){switch(d.label){case 0:return e=t.channelName,i=this.promiseFactory.defer(),o=this.timeout,[4,this.getPubNub()];case 1:return a=d.sent(),n=new a({subscribeKey:t.subscriptionKey,authKey:t.authKey,ssl:!0,noleave:!0}),c={message:function(t){o.cancel(l),n.removeListener(c),n.unsubscribe({channels:[e]});var a=t.message;return a?void i.resolve(r.convertToColumnsDefinition(a)):void i.reject()}},n.addListener(c),l=o((function(){i.reject(),n.removeListener(c),n.unsubscribe({channels:[e]})}),s),n.subscribe({channels:[e]}),[2,i.promise]}}))}))},t.prototype.getCredentials=function(t){var i=this,r=this.promiseFactory.defer(),n=null!=t.originalModelId?t.originalModelId:t.id,s=this.tabularDataService.getKey(n,t.tableName),c=this.modelCredentialMap[s];if(c)r.resolve(c);else{var l=this.telemetryService.startEvent(e.telemetry.RealTimeGetPubNubCredentials);this.realTimeDataHttpService.getCredentials(t.id).then((function(e){var t=e.data;i.modelCredentialMap[s]=t,l.resolve(),r.resolve(t)}),(function(n){l.reject(o.getTelemetryErrorDetails(n.error,n.status)),i.errorCallback([t],(new a).getDetails(e.common.localize)),r.reject()}))}return r.promise},t.prototype.getConnectionKey=function(e){return e.subscriptionKey+(e.authKey||"")},t.prototype.processMessage=function(e,i,o){if(i&&o)for(var r=this.getConnectionKey(e),a=this.pubNubConnectionMap[r],n=a.channelListeners[e.channelName],s=t.convertTimeTokenToVersion(o),c=0,l=n;c<l.length;c++){var d=l[c],p=null!=d.originalModelId?d.originalModelId:d.id,u={modelId:p,name:d.tableName,rowGroups:t.convertToDataRowGroup(s,i),lastVersion:s};this.updateCallback(u)}},t.convertToDataRowGroup=function(e,t){return t?[{version:e,rows:[t]}]:[]},t.convertTimeTokenToVersion=function(e){var t=1e4;return Math.floor(e/t)},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o){return new n(e,t,i,o)}var o=jsCommon.Utility;t.createServerLatencyService=i,t.DefaultPauseTimeBetweenRequestsInMs=6e4;var r=2e3,a="pingLatency",n=(function(){function i(e,t,i,o){this.clusterUriRetriever=e,this.$http=t,this.telemetryService=i,this.$interval=o,this.requestPromise=null}return i.prototype.getServerLatencyInMs=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,o,n,s;return __generator(this,(function(c){switch(c.label){case 0:t=performance.now(),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,this.$http.get(this.pingUrl,{timeout:r})];case 2:return i=c.sent(),i.status!==e.HttpStatusCode.OK&&e.contract.fail("Ping request failed."),o=performance.now(),n=o-t,this.telemetryService.setHostInfo(a,n),[2,n];case 3:return s=c.sent(),this.telemetryService.setHostInfo(a,-1),[2,-1];case 4:return[2]}}))}))},i.prototype.startMonitoring=function(){var e=this;this.stopMonitoring(),this.getServerLatencyInMs(),this.requestPromise=this.$interval((function(){e.getServerLatencyInMs()}),t.DefaultPauseTimeBetweenRequestsInMs)},i.prototype.stopMonitoring=function(){this.requestPromise&&(this.$interval.cancel(this.requestPromise),this.requestPromise=null)},Object.defineProperty(i.prototype,"pingUrl",{get:function(){return this.pingUrlString||(this.pingUrlString=o.urlCombine(this.clusterUriRetriever.backendUri,"/powerbi/metadata/ping")),this.pingUrlString},enumerable:!0,configurable:!0}),i})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,o){return new i(e,t,o)}e.createSettingsMetadataService=t;var i=(function(){function t(e,t,i){this._promiseFactory=e,this._settingsHttpService=t,this._telemetryService=i}return t.prototype.getSettingsType=function(){return this._settingsType},t.prototype.getArtifactObjectId=function(){return this._artifactObjectId},t.prototype.setSettings=function(e,t){this._settingsType=e,this._artifactObjectId=t},t.prototype.getSettings=function(){var t=this._promiseFactory.defer(),i=this._telemetryService.startEvent(e.telemetry.SettingsLoadSettingsData);return this._settingsHttpService.getSettings(i.event).then((function(e){i.resolve(),t.resolve(e.data)}),(function(){i.reject(),t.reject()})),t.promise},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i){return new o(e,t,i)}t.ShowGridlinesSettingKey="ShowGridlines",t.SnapToGridSettingKey="SnapToGrid",t.createSettingsService=i;var o=(function(){function i(e,i,o){var r=this;this.telemetryService=e,this.$rootScope=i,this.userSettingsService=o,o.getExtendedSettingsByKeys([t.ShowGridlinesSettingKey,t.SnapToGridSettingKey]).then((function(e){r.showGridlines=e[0],r.snapToGrid=e[1],i.$applyAsync()}))}return i.prototype.getShowGridlines=function(){return this.showGridlines},i.prototype.setShowGridlines=function(i){this.showGridlines=i,this.persistSetting(e.telemetry.SettingsSetShowGridlines,t.ShowGridlinesSettingKey,i)},i.prototype.getSnapToGrid=function(){return this.snapToGrid},i.prototype.setSnapToGrid=function(i){this.snapToGrid=i,this.persistSetting(e.telemetry.SettingsSetSnapToGrid,t.SnapToGridSettingKey,i)},i.prototype.persistSetting=function(e,t,i){var o=this.telemetryService.startEvent(e,i);this.userSettingsService.updateExtendedSettings(t,i,o)},i})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(){var e={contentProviders:[],collapsed:!0};return e}e.getActivityPaneContract=t})(t=e.staticContract||(e.staticContract={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g){return new s(e,t,i,o,r,a,n,c,l,d,p,u,v,h,g)}var i,o=jsCommon.EnumExtensions,r=e.common.helpers.ModelConverterHelper,a=e.common.contracts.ModelProperty,n=e.common.contracts.Permissions;!(function(e){e[e.Dataset=0]="Dataset",e[e.Report=1]="Report"})(i=e.storageType||(e.storageType={})),e.createStorageUsageService=t;var s=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p,u,v,h){this.rootScope=e,this.telemetryService=t,this.errorService=i,this.dashboardHttpService=o,this.localizationService=r,this.featureSwitchService=a,this.reportService=n,this.modelService=s,this.promiseFactory=c,this.navigation=l,this.userInfo=d,this.groupService=p,this.workbookService=u,this.lazy=v,this.permissionService=h}return t.convertToUsageWithUnit=function(e){return e>=t.usageUnitRadix?t.usageInGBFormat.replace("{0}",(Math.ceil(e/t.usageUnitRadix*10)/10).toString()):t.usageInMBFormat.replace("{0}",e.toString())},Object.defineProperty(t.prototype,"quotaLimitInMB",{get:function(){if(this.featureSwitchService.featureSwitches.quotaSmallLimitEnabled)return t.smallLimitInMB;if(this.featureSwitchService.featureSwitches.forceFreeUserEnabled)return t.freeUserLimitInMB;var e;return this.userInfo&&this.userInfo.userMetadata&&this.userInfo.userMetadata.quotaStatus&&(e=this.userInfo.userMetadata.quotaStatus.quotaLimitInMB),e},enumerable:!0,configurable:!0}),t.prototype.getUsageModels=function(e){for(var a=this,s=[],c=this.modelService.models,l=this.reportService.reports,d=0,p=c.length;d<p;++d){var u=c[d].contract,v=u.sizeInMBs?u.sizeInMBs:0,h=_.filter(e,(function(e){return e.contract.modelIds&&e.contract.modelIds.indexOf(u.id)>=0}));if(this.shouldIncludeModel(u,h)){var g=this.permissionService.getModelEffectivePermissions(u),m={modelId:u.id,packageId:u.packageId,name:u.displayName,sizeInMBs:v,sizeWithUnit:t.convertToUsageWithUnit(v),storageType:i.Dataset,typeText:this.localizationService.get("QuotaManagement_ModelType_Dataset"),lastRefreshTime:r.convertRefreshTimeToJsDateTime(u.lastRefreshTime).toLocaleString(),reportsFromModel:_.filter(l,(function(e){return e.modelId===u.id})),dashboardsFromModel:h,associatedDashboards:"",associatedReports:"",ownedByMe:o.hasFlag(g,n.ReadWrite)};m.associatedDashboards=this.getAssociateNames(m.dashboardsFromModel,"displayName").join(", "),m.associatedReports=this.getAssociateNames(m.reportsFromModel,"displayName").join(", "),s.push(m)}}for(var f=this.workbookService.workbooks,d=0,p=f.length;d<p;d++){var y=f[d],b=_.filter(c,(function(e){return a.shouldIncludeWorkbook(e,y)}));if(b&&b.length>0){var S=b[0].contract,v=S.sizeInMBs,m={modelId:y.modelId,packageId:y.packageId,name:y.displayName,sizeInMBs:v,sizeWithUnit:t.convertToUsageWithUnit(v),storageType:i.Report,typeText:this.localizationService.get("QuotaManagement_ModelType_Report"),lastRefreshTime:r.convertRefreshTimeToJsDateTime(S.lastRefreshTime).toLocaleDateString(),reportsFromModel:[],dashboardsFromModel:[],associatedDashboards:"",associatedReports:"",ownedByMe:o.hasFlag(S.permissions,n.ReadWrite)};s.push(m)}}return s},t.prototype.getAssociateNames=function(e,t){for(var i=[],o=0;o<e.length;++o)i.push(e[o][t]);return i},t.prototype.getUsage=function(e){for(var t=this,i=0,r=0,a=0,s=this.modelService.models,c=0,l=s.length;c<l;++c){var d=s[c].contract,p=_.filter(e,(function(e){return e.contract.modelIds&&e.contract.modelIds.indexOf(d.id)>=0}));if(this.shouldIncludeModel(d,p)){var u=this.permissionService.getModelEffectivePermissions(d);o.hasFlag(u,n.ReadWrite)?i+=d.sizeInMBs:r+=d.sizeInMBs}}for(var v=this.workbookService.workbooks,c=0,l=v.length;c<l;++c){var h=v[c],g=_.filter(s,(function(e){return t.shouldIncludeWorkbook(e,h)}));if(g&&g.length>0){var m=g[0].contract,f=m.sizeInMBs;o.hasFlag(m.permissions,n.ReadWrite)?i+=f:r+=f}}return a=i+r,{ownedUsage:i,sharedUsage:r,totalUsage:a}},t.prototype.checkQuotaExceeded=function(t,i,o){void 0===i&&(i=e.telemetry.QuotaCheckOperation.Unknown);var r=this.getUsage(t),a=r.totalUsage,n=this.quotaLimitInMB;return a>n&&(this.logQuotaExceededEvent(this.userInfo.isPremiumUser,this.isMyWorkspace,i,r.ownedUsage,r.sharedUsage,n),o||this.showQuotaExceedDialog(),!0)},t.prototype.getUsageBarMenuItemViewModel=function(e){var i;i=this.isMyWorkspace?this.localizationService.get("QuotaManagement_ManagePersonalStorage"):this.localizationService.get("QuotaManagement_ManageGroupStorage");var o=this.getUsage(e).totalUsage,r=this.quotaLimitInMB;return{usageInMB:o,quotaLimitInMB:r,usageDescription:this.localizationService.get("QuotaManagement_UsageDescription").replace("{0}",t.convertToUsageWithUnit(o)).replace("{1}",t.convertToUsageWithUnit(r)),text:i}},t.prototype.showQuotaExceedDialog=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i=this;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.lazy("licenseHelper")];case 1:return t=o.sent(),this.userInfo.isPremiumUser?t.displayQuotaExceededErrorMessage(e.telemetry.LicenseEnforcementOperation.QuotaExceededTrialAndPaidUser,this.localizationService.get("QuotaExceedDialogMessage_TrialAndPaidUser"),this.localizationService.get("QuotaExceedDialogTitle"),(function(){return i.rootScope.$applyAsync((function(){i.navigation.showManageStorageSlider()}))})):t.displayQuotaExceededErrorMessage(e.telemetry.LicenseEnforcementOperation.QuotaExceededTrialUser,this.localizationService.format("QuotaExceedDialogMessage_TrialUser",[""+e.common.constants.FreeTrialPeriod]),this.localizationService.get("QuotaExceedDialogTitle"),(function(){return i.rootScope.$applyAsync((function(){i.navigation.showManageStorageSlider()}))})),[2]}}))}))},t.prototype.isInVisibleDashboard=function(e){if(_.isEmpty(e))return!0;for(var t=0,i=e;t<i.length;t++){var o=i[t];if(!o.isHidden)return!0}return!1},Object.defineProperty(t.prototype,"isMyWorkspace",{get:function(){return this.groupService.activeGroup&&this.groupService.activeGroup.isMyWorkspace},enumerable:!0,configurable:!0}),t.prototype.logQuotaExceededEvent=function(t,i,o,r,a,n){var s=i?e.telemetry.QuotaOpenManageStorageContext.Personal:e.telemetry.QuotaOpenManageStorageContext.Group,c=this.telemetryService;c.logEvent(e.telemetry.QuotaExceeded,t,s,o,r,a,n)},t.prototype.shouldIncludeModel=function(e,t){return!jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e.displayName)&&null!=e.sizeInMBs&&e.sizeInMBs>0&&(e.modelFeatures&a.OrgApp)!==a.OrgApp&&e.isHidden!==!0&&this.isInVisibleDashboard(t)},t.prototype.shouldIncludeWorkbook=function(e,t){return e.contract.id===t.contract.modelId&&e.contract.packageId===t.packageId&&null!=e.contract.sizeInMBs&&e.contract.sizeInMBs>0&&t.isOwner()},t})();s.usageInMBFormat="{0} MB",s.usageInGBFormat="{0} GB",s.usageUnitRadix=1024,s.freeUserLimitInMB=1024,s.smallLimitInMB=10,e.StorageUsageService=s})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,n,s,c,l,d,p,v){return new u(e,t,i,o,r,a,n,s,c,l,d,p,v)}var o=e.dataServices.AppUtils,r=e.helpers.ArtifactNotFoundHelper,a=e.common.contracts.ContentProviderCategory,n=e.common.constants,s=e.dataServices.models.Dashboard,c=e.dialogs.InstallStoreAppDialogBuilder,l=e.telemetry.InstallSource,d=e.common.models.Report,p=e.dataServices.models.Workbook;t.createStoreAppInstallService=i;var u=(function(){function t(e,t,i,o,r,a,n,s,l,d,p,u,v){this.appService=e,this.navigation=t,this.promiseFactory=i,this.contentProviderService=o,this.contentProviderHttpService=r,this.errorService=a,this.localizationService=n,this.telemetryService=s,this.quota=l,this.rootScope=p,this.activeGroup=u,this.dataServiceModelConverter=v,this.installStoreAppDialogBuilder=new c(s,d)}return t.prototype.addAppAndNavigate=function(t,i,o){var n=this,s=this.promiseFactory.defer();if(this.quota.checkQuotaExceeded(e.telemetry.QuotaCheckOperation.AppAutoInstall))return this.rejectDeferredAndNavigateAway(s),s.promise;var c=this.navigation;c.navigateToAppAutoInstall();var l=this.telemetryService.startEvent(e.telemetry.AppModelInitializeContentProviders);return this.contentProviderHttpService.getContentProviders(l.event).then((function(e){var l=e.data,d=_.find(l,(function(e){return e.providerKey===t}));if(!d)return r.showArtifactDoesNotExistDialog("ArtifactKind_App",n.errorService,n.localizationService,n.telemetryService),void n.rejectDeferredAndNavigateAway(s);if(!n.appService.isAppCategory(a.OrganizationalApp)||d.category!==a.OrganizationalApp)return s.reject(),void c.showGetDataSlider();var p=n.contentProviderService;return p.upgradeRequiredToConnect(d)?(p.displayFeatureDisabledDialog(d),void n.rejectDeferredAndNavigateAway(s)):void(o?n.installAppInternal(d,s,i):n.installStoreAppDialogBuilder.show(d).then((function(e){0===e?n.installAppInternal(d,s,i):n.rejectDeferredAndNavigateAway(s)})))}),(function(e){n.errorService.error(n.localizationService.get("ErrorMessage_FailedLoadContentProviders"),"FailedLoadContentProviders",{requestId:e.requestId,statusCode:e.status.toString()}),l.reject(),n.rejectDeferredAndNavigateAway(s)})),s.promise},t.prototype.onInstanceInstalled=function(e){this.installedAppGUID&&e&&e.providerContract.providerKey===this.installedAppGUID&&(this.installedAppModel=e,this.tryNavigateToApp()&&this.unsubscribe())},t.prototype.onInstanceUninstalled=function(e){},t.prototype.onInstanceUpdated=function(e){this.installedAppModel&&this.targetAppArtifact&&this.installedAppModel===e&&this.tryNavigateToApp()&&this.unsubscribe()},t.prototype.onInstancesReset=function(){},t.prototype.rejectDeferredAndNavigateAway=function(e){e.reject(),this.navigation.navigateToContentListOrActiveDashboard()},t.prototype.installAppInternal=function(e,t,i){var o=this,r=this.contentProviderService,a=this.navigation,s=l.AppAutoInstallLink;if(i&&(i.dashboardOriginalGUID||i.reportOriginalGUID||i.workbookID))this.targetAppArtifact=i,s=l.AppArtifactAutoInstallLink;else{var c=this.dataServiceModelConverter.convertAppModelBase(e);c&&1===c.defaultContentOption&&c.defaultContent&&(this.targetAppArtifact={dashboardOriginalGUID:c.defaultContent.dashboardObjectId,reportOriginalGUID:c.defaultContent.reportObjectId,workbookID:c.defaultContent.workbookObjectId})}r.storeDataAccessInfo(r.getDataAccessInfo(e),e,s).then((function(){t.resolve(null),o.appService.addApp(e),o.installedAppGUID=e.providerKey;var i=o.appService.getAppInstancesForApp(o.installedAppGUID);_.isEmpty(i)||(o.installedAppModel=i[0]),o.tryNavigateToApp()?o.installedAppGUID=o.installedAppModel=o.targetAppArtifact=null:(o.appService.subscribeToInstanceEvents(o),o.unregisterStateChangeHandler=o.rootScope.$on(n.navigation.stateChangeSuccess,(function(e,t,i,r,a){return o.unsubscribe()})))}),(function(){return t.reject()})),a.navigateToApps()},t.prototype.unsubscribe=function(){this.installedAppGUID=this.installedAppModel=this.targetAppArtifact=null,this.unregisterStateChangeHandler&&(this.unregisterStateChangeHandler(),this.unregisterStateChangeHandler=null),this.appService.unsubscribeToInstanceEvents(this)},t.prototype.tryNavigateToApp=function(){if(!this.installedAppModel)return!1;if(!this.targetAppArtifact)return this.navigation.navigateToApp(this.installedAppModel.providerContract.providerKey),!0;var e=o.getAppArtifact(this.installedAppModel,this.targetAppArtifact);if(!e)return!1;var t=this.installedAppModel.providerContract.providerKey;if(e instanceof s)this.navigation.navigateToAppDashboardByGUID(e.objectId,e.contract.originalDashboardObjectId,t);else if(e instanceof d){var i=e.packageId,r=e.modelId,a=_.find(this.installedAppModel.models,(function(e){return e.id===r&&e.packageId===i}));if(!a)return!1;this.navigation.navigateToReport({appGUID:t,reportGUID:e.objectId,reportOriginalGUID:e.contract.originalReportObjectId,groupGUID:this.activeGroup.activeGroupObjectId})}else e instanceof p&&this.navigation.navigateToAppWorkbookByUniqueId(e.uniqueId,t);return!0},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,o,r,a){return new i(e,t,o,r,a)}e.createTenantContentPackSerivce=t;var i=(function(){function t(e,t,i,o,r){this.telemetryService=e,this.featureSwitchService=t,this.contentProviderHttpService=i,this.promiseFactory=o,this.modelConverter=r,this.loadTenantContentPacks()}return t.prototype.tenantServiceContentPacksPromise=function(){return this._tenantContentPacksDeferred.promise},Object.defineProperty(t.prototype,"lastUpdatedTimestamp",{get:function(){return this._lastUpdatedTimestamp},enumerable:!0,configurable:!0}),t.prototype.loadTenantContentPacks=function(){var t=this;this._tenantContentPacksDeferred=this.promiseFactory.defer();var i=this.featureSwitchService.featureSwitches;if(i.templatePublishEnabled||i.templatePublishFlightingWorkAroundEnabled){var o=this.telemetryService.startEvent(e.telemetry.DashboardLoadTenantContentPacks);this.tenantServiceContentPacks=[],this.contentProviderHttpService.getTenantContentProviders(o.event).then((function(e){t.updateContentPackCollection(e.data),t._tenantContentPacksDeferred.resolve(t.tenantServiceContentPacks),o.resolve()}),(function(e){t._tenantContentPacksDeferred.reject(),o.reject()}))}},t.prototype.findContentPackByGUID=function(e){return null!=e?_.find(this.tenantServiceContentPacks,(function(t){return t.providerContract.providerKey===e})):null},t.prototype.setContentPackCleanForSession=function(e){var t=this.getContentPackIndexByGUID(e);t>0&&(this.tenantServiceContentPacks[t].providerContract.isDirty=!1)},t.prototype.deleteContentPack=function(t){var i=this.telemetryService.startEvent(e.telemetry.DashboardDeleteTemplateOrganizationApp),o=this.promiseFactory.defer();return e.contentPackService.deleteContentPack(t,i.event).then((function(e){i.resolve(),o.resolve(null)}),(function(e){i.reject(),o.reject({requestId:e.requestId,statusCode:e.status.toString(),activityId:e.activityId})})),o.promise},t.prototype.updateContentPackCollection=function(e){var t=this;this.tenantServiceContentPacks=[],e.map((function(e){t.tenantServiceContentPacks.push(t.modelConverter.convertContentPack(e))})),this.updateTimestamp()},t.prototype.updateTimestamp=function(){this._lastUpdatedTimestamp=(new Date).getTime()},t.prototype.getContentPackIndexByGUID=function(e){if(this.tenantServiceContentPacks.length>0)for(var t=0,i=this.tenantServiceContentPacks.length;t<i;t++){
var o=this.tenantServiceContentPacks[t];if(o.providerContract.providerKey===e)return t}return-1},t})();e.TenantContentPackService=i})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(t,o,r){var a=o.convertTileConfig(r.contract);if(a&&a.refreshPeriod){var n=a.refreshPeriod;n<i&&(n=i);var s=setInterval((function(){return r.refreshData()}),n);t.$on(e.common.constants.scopeDestroyEventName,(function(){return clearInterval(s)}))}}var i=6e4;e.tileDataRefreshWorker=t})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e){return new o(e)}var i="Tile_FailedToDisplay";e.createTileDisplayService=t;var o=(function(){function e(e){this.errorService=e}return e.prototype.onErrorIconClicked=function(e){var t=e.errorTitle,o=e.errorTitle,r=e.errorDetails;if(e.isError&&t){var a=r&&r.displayableErrorInfo;if(a){for(var n=0,s=a;n<s.length;n++){var c=s[n];if(c.errorInfoValue){t=c.errorInfoKey,o=c.errorInfoValue;break}}this.errorService.error(o,i,{title:t,helpLink:r.helpLink})}}},e.prototype.shouldShowTileVisual=function(e){return!0},e.prototype.isVisualSupportedInErrorState=function(e){var t=e.composite,i=e.realTime,o=!!(t&&t.tileData&&t.tileData.data),r=!!(i&&i.visual&&i.visual.data);return o||r},e})()})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,a,n,s,c,l,d,p){return new r(e,t,o,a,n,s,c,l,i,d,p)}e.createTutorialPopupService=t;var i=300,o=1500,r=(function(){function t(e,t,i,o,r,a,n,s,c,l,d){this.telemetryService=e,this.userInfo=t,this.applicationOptions=i,this.featureSwitchService=o,this.localizationService=r,this.navigation=a,this.conceptualModelSetting=n,this.rtl=s,this.appMetadataService=l,this.groupHttp=d,this.dataStore=c,this.initialize()}return t.prototype.initialize=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.featureSwitchService.getFeatureSwitches()];case 1:return o.sent(),t=e.createStartupTutorialModel(this.userInfo,this.applicationOptions,this.featureSwitchService,this.localizationService,this.navigation,this.conceptualModelSetting,this.rtl),[4,this.getCapacityTutorialModel()];case 2:return i=o.sent(),t=this.appendExtraTutorialModel(t,i),t&&this.startTutorialInternal(t),[2]}}))}))},t.prototype.appendExtraTutorialModel=function(e,t){return e?t?((i=e.itemKeys).push.apply(i,t.itemKeys),_.extend(e.items,t.items),e):e:t;var i},t.prototype.startTutorial=function(e){var t=this;this.dataStore.onReady((function(){return t.startTutorialInternal(e)}))},t.prototype.getCapacityTutorialModel=function(){return __awaiter(this,void 0,e.Promise,(function(){var t,i,o;return __generator(this,(function(r){switch(r.label){case 0:if(this.dataStore.hasKey("WelcomeToCapacity")&&this.dataStore.getKey("WelcomeToCapacity")||this.applicationOptions.isE2ERun)return[2,null];r.label=1;case 1:return r.trys.push([1,5,,6]),[4,this.appMetadataService.getAppMetadata()];case 2:return t=r.sent(),t.tenantHasCapacities?[4,this.groupHttp.getAvailableGroupCapacities()]:[3,4];case 3:if(i=r.sent(),i&&!_.isEmpty(i.data))return[2,e.createStartUpCapacityTutorialModel(this.localizationService)];r.label=4;case 4:return[3,6];case 5:return o=r.sent(),[3,6];case 6:return[2]}}))}))},t.prototype.startTutorialInternal=function(i){var o=this;this.tutorialModel&&this.stopTimer(),this.tutorialModel=i,this.itemKeys=this.tutorialModel.itemKeys;for(var r=0;r<this.itemKeys.length;++r){var a=this.itemKeys[r],n=this.tutorialModel.items[a];if(n.itemKey=a,n.dataStoreKey||(n.dataStoreKey=a),this.dataStore.hasKey(n.dataStoreKey))this.itemKeys.splice(r,1),--r;else if(!this.dataStore.hasKey(t.FirstUseKey)&&!n.includeNewUser){var s={event:void 0,resolve:_.noop,reject:_.noop};this.dataStore.setKey(n.dataStoreKey,!0,s),this.itemKeys.splice(r,1),--r}}if(this.itemKeys.length>0&&(this.nonModalPopupCount=_.countBy(this.itemKeys,(function(e){if(!o.tutorialModel.items[e].modal)return"nonModal"})).nonModal,this.nonModalPopupCurrentIndex=0,this.previousNonModalItem=null,this.startTimer()),!this.dataStore.hasKey(t.FirstUseKey)){var c=this.telemetryService.startEvent(e.telemetry.DashboardFirstUse);this.dataStore.setKey(t.FirstUseKey,!0,c)}},t.prototype.startTimer=function(){var e=this;this.popupContainer=new p;var t=this.tutorialModel.isBlockingTutorial?i:o;this.timerID=setInterval((function(){e.checkStatus()}),t),this.checkStatus()},t.prototype.stopTimer=function(){this.tutorialModel=null,this.currentItem=null,this.popup=null,this.popupContainer.destroy(),clearInterval(this.timerID)},t.prototype.checkStatus=function(){if(this.currentItem)this.canShow(this.currentItem)?this.popup?this.popup.alignPopup():this.showItem(this.currentItem):this.popup?this.popup.closePopup(!1):this.currentItem=null;else{if(0===this.itemKeys.length)return void this.stopTimer();for(var e=this.tutorialModel.isSequentialTutorial?1:this.itemKeys.length,t=0;t<e;++t){var i=this.itemKeys[t],o=this.tutorialModel.items[i];if(this.canShow(o))return void(this.currentItem=o)}}},t.prototype.showItem=function(t){var i,o=this;!t.modal&&this.tutorialModel.isSequentialTutorial&&(this.previousNonModalItem!==t&&(this.previousNonModalItem=t,++this.nonModalPopupCurrentIndex),i=e.formattingService.format(this.localizationService.get("TutorialPopup_ProgressCount"),[this.nonModalPopupCurrentIndex,this.nonModalPopupCount])),this.popup=new u(this.popupContainer,t.attachTo,{title:t.title,text:t.text,buttonLabel:t.buttonLabel,modalButtonClassOverride:t.modalButtonClassOverride,imageUrl:t.imageUrl,iframeUrl:t.iframeUrl,modal:t.modal,offset:t.offset,onButtonClick:t.onButtonClick,onClose:function(e,t){o.onItemClose(e,t)},preferredOrientation:t.preferredOrientation,customClass:t.customClass,iconClass:t.iconClass,cancelText:t.cancelText,overlayOptions:t.overlayOptions,progressCountText:i,learnMoreText:t.learnMoreText,learnMoreUrl:t.learnMoreUrl});var r=this.telemetryService;this.gettingStartedEvent=r.startEvent(e.telemetry.DashboardShowGettingStartedPopup,t.dataStoreKey)},t.prototype.onItemClose=function(e,t){var i=this;if(e&&(this.itemKeys.splice($.inArray(this.currentItem.itemKey,this.itemKeys),1),this.dataStore.setKey(this.currentItem.dataStoreKey,!0,this.gettingStartedEvent),this.currentItem.telemetryEventArgs&&this.telemetryService.logEvent.apply(this.telemetryService,this.currentItem.telemetryEventArgs)),t){var o=_(this.itemKeys).map((function(e){return i.tutorialModel.items[e]})).pluck("dataStoreKey").unique().value();this.itemKeys=[];for(var r=0,a=o;r<a.length;r++){var n=a[r];this.dataStore.setKey(n,!0,this.gettingStartedEvent)}}this.currentItem=null,this.popup=null},t.prototype.canShow=function(e){try{if(!e.canShow())return!1;if(e.modal)return!0;var t=e.attachTo(),i=t.offset();return null!=i&&((0!==i.left||0!==i.top)&&(this.rtl.isRtlLayout&&(i.left+=t.outerWidth()-1),!(!e.showWhenUnclickable&&0===$(document.elementFromPoint(i.left+1,i.top+1)).closest(t).length)))}catch(e){return!1}},t})();r.FirstUseKey="Welcome",e.TutorialPopupService=r;var a=(function(){function e(){}return e})();a.Left="left",a.Right="right",a.Top="top",a.Bottom="bottom",a.Center="center",a.LeftTop="leftTop",a.RightTopForRtl="rightTopForRtl",a.LeftBottom="leftBottom",a.RightBottomForRtl="rightBottomForRtl",e.Direction=a;var n=(function(){function e(){}return e})();n.Left="arrowLeft",n.Right="arrowRight",n.Top="arrowTop",n.Bottom="arrowBottom";var s=["modal"],c=[""],l=["non-modal-list-view","non-modal-list-view-visible"],d=(function(){function e(){}return e.toStringArray=function(e){switch(e){case 0:return s;case 1:return c;case 2:return l;default:return c}},e})(),p=(function(){function e(){this.popupContainer=$(e.PopupContainerTemplate),this.overlayContainer=$(e.OverlayContainerTemplate),this.overlayOptions=1,this.destroyed=!1,$(e.PopupParent).append(this.popupContainer),this.popupContainer.append(this.overlayContainer)}return e.prototype.updateOverlaysWithClasses=function(t){if(!this.destroyed&&this.overlayOptions!==t){this.clearOverlayContainer();for(var i=d.toStringArray(t),o=0,r=i;o<r.length;o++){var a=r[o];$(e.OverlayTemplate).addClass(a).appendTo(this.overlayContainer)}this.overlayOptions=t}},e.prototype.clearOverlayContainer=function(){this.overlayContainer.remove(),this.overlayContainer=$(e.OverlayContainerTemplate),this.popupContainer.append(this.overlayContainer)},e.prototype.destroy=function(){this.destroyed=!0,this.overlayContainer.remove(),this.popupContainer.remove()},e})();p.PopupParent="body",p.PopupContainerTemplate='<div class="tutorial-popup-container"></div>',p.OverlayContainerTemplate='<div class="tutorial-popup-overlay-container"></div>',p.OverlayTemplate='<div class="tutorial-popup-overlay"></div>';var u=(function(){function e(e,t,i){this.popupContainer=e,this.attachTo=t,this.options=i,this.createPopup(i)}return e.prototype.createPopup=function(t){var i=this,o=e.PopupTemplate;for(var r in t)"string"==typeof t[r]&&(o=o.replace("{"+r+"}",t[r]));this.popup=$(o);var a=this.popup.find(".icon i");t.iconClass?a.addClass(t.iconClass):a.hide(),t.customClass&&this.popup.addClass(t.customClass);var n=this.popup.find(".image");null!=t.imageUrl?n.addClass(e.VisibleClass):n.remove(),null!=t.offset?this.popOffset=t.offset:this.popOffset={left:0,top:0},null!=t.modalButtonClassOverride&&this.popup.find(".ok-btn").addClass(t.modalButtonClassOverride),this.popup.on(e.ElementClickEventName,(function(e){e.stopPropagation()})),$(window).on(e.WindowResizeEventName,(function(){requestAnimationFrame((function(){i.alignPopup()}))})),this.popup.find(".ok-btn").html(t.buttonLabel).on(e.ElementClickEventName,(function(){i.closePopup(!0);var e=t.onButtonClick;e&&"function"==typeof e&&e()}));var s=this.popup.find(".cancel");t.cancelText?s.on(e.ElementClickEventName,(function(){i.closePopup(!0,!0)})):s.remove(),$(e.PopupParentClass).append(this.popup),t.modal?(this.popup.addClass(e.ModalClass),$(e.PopupParentClass).off(e.ElementClickEventName)):this.attachTo().on(e.ElementClickEventName,(function(){i.closePopup(!0)})),t.learnMoreText?this.popup.find(".progress-count").addClass("with-learn-more"):this.popup.find(".learn-more").remove(),t.progressCountText||this.popup.find(".progress-count").remove(),requestAnimationFrame((function(){i.alignPopup()}))},e.prototype.closePopup=function(t,i){void 0===i&&(i=!1),null!=this.popup&&(this.popup.removeClass(e.VisibleClass),this.attachTo().off(e.ElementClickEventName),$(window).off(e.WindowResizeEventName),$(e.PopupParentClass).off(e.ElementClickEventName),this.popup.remove(),this.options.onClose(t,i))},e.prototype.alignPopup=function(){var t=this,i=this.popup,o=this.attachTo();if(null!=i){var r={width:i.outerWidth(),height:i.outerHeight()},n={left:0,top:0,width:$(window).width(),height:$(window).height()},s=n;if(!this.options.modal){if(null==o)return;s=$.extend({width:o.outerWidth(),height:o.outerHeight()},o.offset())}var c=Math.floor(s.left+s.width/2-r.width/2),l=Math.floor(s.top+s.height/2-r.height/2),d=Math.floor(s.left),p=Math.floor(s.top),u=Math.floor(s.left+s.width-r.width+this.popOffset.left),v=Math.floor(s.top+s.height-r.height+e.ArrowSpacing+this.popOffset.top),h=Math.floor(s.left+s.width+e.ArrowSpacing+this.popOffset.left),g=Math.floor(s.top+s.height+e.ArrowSpacing+this.popOffset.top),m=Math.floor(s.left-r.width-e.ArrowSpacing+this.popOffset.left),f=Math.floor(s.top-r.height-e.ArrowSpacing+this.popOffset.top);if(this.options.modal){if(this.tryFitInWindow(a.Center,c,l,r,s,n))return}else{var y=[{direction:a.Left,x:h,y:l},{direction:a.Right,x:m,y:l},{direction:a.Bottom,x:c,y:f},{direction:a.Top,x:c,y:g},{direction:a.Bottom,x:d,y:f},{direction:a.Left,x:h,y:p},{direction:a.Right,x:m,y:p},{direction:a.Top,x:d,y:g},{direction:a.Bottom,x:u,y:f},{direction:a.Left,x:h,y:v},{direction:a.Right,x:m,y:v},{direction:a.Top,x:u,y:g},{direction:a.LeftTop,x:h,y:l+.35*r.height},{direction:a.RightTopForRtl,x:m,y:l+.35*r.height},{direction:a.LeftBottom,x:h,y:l-.4*r.height},{direction:a.RightBottomForRtl,x:m,y:l-.4*r.height}];this.options.preferredOrientation&&(y=_.sortBy(y,(function(e){return e.direction===t.options.preferredOrientation?0:1})));for(var b=0;b<y.length;++b){var S=y[b];if(this.tryFitInWindow(S.direction,S.x,S.y,r,s,n))return}}this.tryFitInWindow(a.Center,c,0,r,s,n,!0)}},e.prototype.tryFitInWindow=function(t,i,o,r,s,c,l){if(void 0===l&&(l=!1),i>=0&&o>=0&&i+r.width<=c.width&&o+r.height<=c.height||l){this.arrowPosition!==t&&(this.popup.removeClass(this.arrowPosition).addClass(t).css({left:"initial",top:"initial"}),this.arrowPosition=t),this.popup.addClass(e.VisibleClass).css({left:i,top:o});var d=this.popup.find(".arrow");return d.removeAttr("style"),t===a.Left?(d.css({top:Math.floor(s.top+s.height/2-o-e.ArrowSpacing)}),d.addClass(n.Left)):t===a.Top?(d.css({left:Math.floor(s.left+s.width/2-i-e.ArrowSpacing)}),d.addClass(n.Top)):t===a.Right?(d.css({top:Math.floor(s.top+s.height/2-o-e.ArrowSpacing)}),d.addClass(n.Right)):t===a.Bottom?(d.css({left:Math.floor(s.left+s.width/2-i-e.ArrowSpacing)}),d.addClass(n.Bottom)):t===a.LeftTop?(d.css({top:Math.floor(s.top+s.height/2-(o-.05*r.height)-e.ArrowSpacing)}),d.addClass(n.Left)):t===a.RightTopForRtl?(d.css({top:Math.floor(s.top+s.height/2-(o-.05*r.height)-e.ArrowSpacing)}),d.addClass(n.Right)):t===a.LeftBottom?(d.css({top:Math.floor(s.top+s.height/2-o-e.ArrowSpacing)}),d.addClass(n.Left)):t===a.RightBottomForRtl&&(d.css({top:Math.floor(s.top+s.height/2-o-e.ArrowSpacing)}),d.addClass(n.Right)),this.options.overlayOptions?this.popupContainer.updateOverlaysWithClasses(this.options.overlayOptions):this.options.modal?this.popupContainer.updateOverlaysWithClasses(0):this.popupContainer.updateOverlaysWithClasses(1),!0}return!1},e})();u.PopupParentClass=".tutorial-popup-container",u.ArrowSpacing=20,u.VisibleClass="show",u.ModalClass="modal",u.ElementClickEventName="click.popup",u.WindowResizeEventName="resize.popup",u.PopupTemplate='             <div class="tutorial-popup">                 <div class="box">                     <div class="arrow"></div>                     <div class="icon"><i class="glyphicon glyph-small"></i></div>                     <div class="title">{title}</div>                     <img src="{imageUrl}" class="image"></img>                     <div class="text">{text}</div>                     <a class="learn-more" target="_blank" href="{learnMoreUrl}">{learnMoreText}</a>                     <div class="progress-count">{progressCountText}</div>                     <div class="ok-btn primary"></div>                     <div class="cancel">{cancelText}</div>                 </div>             </div>'})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,r,a,s,c,l,d,p){return new n(e,t,i,o,r,a,s,c,l,d,p)}var o=e.common.constants,r=e.telemetry.UsageMetricsArtifactType,a=e.helpers.ContentTileHelper;t.createUsageMetricsReportService=i;var n=(function(){function t(e,t,i,o,r,a,n,s,c,l,d){this.usageMetricsHttp=e,this.navigation=t,this.localizationService=i,this.notificationToastService=o,this.dashboardService=r,this.errorService=a,this.reportService=n,this.promiseFactory=s,this.packageService=c,this.modelService=l,this.moduleLoader=d,this.pendingUsageMetricsRequests=[]}return t.prototype.openDashboardUsageMetricsReport=function(t,i,o){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getPackageAndNavigateToUsageMetricsReport(r.Dashboard,t.displayName,t.objectId,i,o)];case 1:return[2,e.sent()]}}))}))},t.prototype.openReportUsageMetricsReport=function(t,i,o){return __awaiter(this,void 0,e.Promise,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,this.getPackageAndNavigateToUsageMetricsReport(r.Report,t.displayName,t.objectId,i,o)];case 1:return[2,e.sent()]}}))}))},t.prototype.getContentTileFromUsageMetricsFilters=function(t){return __awaiter(this,void 0,e.Promise,(function(){var i,o,r,a,n,s,c;return __generator(this,(function(l){switch(l.label){case 0:return[4,this.promiseFactory.all([this.moduleLoader.require({javascript:"odataFilterParser"}),this.moduleLoader.require({javascript:"odataExplore"})])];case 1:if(l.sent(),i=void 0,o={supportMultiplePredicates:!0},r=e.explore.odata.createODataFilterParser(o),a=r.tryGetFilters(t),_.isEmpty(a))return[2];for(n=0,s=a;n<s.length&&(c=s[n],i=this.getContentTileFromFilters(c),_.isEmpty(i));n++);return[2,i]}}))}))},t.prototype.isUsageMetricsContentProvider=function(e){return o.isUsageMetricsContentProvider(e)},t.prototype.reportBelongsToUsageMetricsContentPack=function(e){return!!e&&this.lookupPackageAndCheckPackageIsUsageMetricsContentPack(e.packageId)},t.prototype.reportOriginatedFromUsageMetricsContentPack=function(e){if(!e)return!1;if(this.reportBelongsToUsageMetricsContentPack(e))return!0;var t=this.packageService.findPackage(e.packageId);return!!t&&this.packageIsACopyOfUsageMetricsContentPack(t)},t.prototype.modelBelongsToUsageMetricsContentPack=function(e){return!!e&&this.lookupPackageAndCheckPackageIsUsageMetricsContentPack(e.packageId)},t.prototype.modelOriginatedFromUsageMetricsContentPack=function(e){if(!e)return!1;if(this.modelBelongsToUsageMetricsContentPack(e))return!0;var t=this.packageService.findPackage(e.packageId);return!!t&&this.packageIsACopyOfUsageMetricsContentPack(t)},t.prototype.packageIsACopyOfUsageMetricsContentPack=function(e){if(!e)return!1;if(!_.isNumber(e.originalPackageId))return!1;var t=this.packageService.findPackage(e.originalPackageId);return this.packageIsUsageMetricsContentPack(t)},t.prototype.packageIsUsageMetricsContentPack=function(e){return e&&o.isUsageMetricsContentProvider(e.contentProviderId)},t.prototype.contentTileBelongsToUsageMetricsContentPack=function(e){var t=a.getPackageId(e),i=this.packageService.findPackage(t);return this.packageIsUsageMetricsContentPack(i)},t.prototype.lookupPackageAndCheckPackageIsUsageMetricsContentPack=function(e){var t=this.packageService.findPackage(e);return!!t&&this.packageIsUsageMetricsContentPack(t)},t.prototype.getContentTileFromFilters=function(e){var t=_.first(e.filter.from().keys());if(t){var i=e.filter.from().source(t);if(i){var o=i.entity;if("Reports"===o||"Dashboards"===o){var r=_.first(e.filter.where());if(r&&r.condition){var a=r.condition.left,n=r.condition.right;if(a&&n){var s=a.ref,c=n.value;if(s&&c&&("ReportGuid"===s||"DashboardGuid"===s))return"ReportGuid"===s?this.reportService.findReportByGUID(c):"DashboardGuid"===s?this.dashboardService.findDashboardByGUID(c):void 0}}}}}},t.prototype.getPackageAndNavigateToUsageMetricsReport=function(t,i,o,r,a){return __awaiter(this,void 0,e.Promise,(function(){var n,s,c,l;return __generator(this,(function(d){switch(d.label){case 0:if(n=this.notificationToastService.notify({title:this.localizationService.get("UsageMetrics_LoadingTitle"),message:this.localizationService.format("UsageMetrics_LoadingSubtitle",[i]),notificationType:e.common.NotificationToastType.Loading,sticky:!0}),this.tryAttachToPendingUsageMetricsRequestIfExisting(i,o,r,t,n))return[2];if(this.tryNavigateToUsageMetricsReport(o,r,t))return this.onPackagePublishDone(n),[2];s=this.pushPendingUsageMetricsRequest(r,t),this.attachToPendingUsageMetricsRequest(s,i,o,r,t,n),d.label=1;case 1:return d.trys.push([1,3,4,5]),[4,this.usageMetricsHttp.getPackage(t,a.event)];case 2:return c=d.sent(),this.packageService.mergePackageCollection([c]),this.reportService.mergeReportCollection(c.reports),c.models[0].permissions=c.permissions,this.modelService.mergeDatasetCollection(c.models),s.defered.resolve(c.reports[0]),[3,5];case 3:throw l=d.sent(),s.defered.reject(l),l;case 4:return _.remove(this.pendingUsageMetricsRequests,s),[7];case 5:return[2]}}))}))},t.prototype.tryNavigateToUsageMetricsReport=function(e,t,i){var o=this.getUsageMetricsReportIfExisting(i);return!_.isEmpty(o)&&(this.constructODataFiltersThenNavigateToReportByGuid(o.objectId,i,e,t),!0)},t.prototype.tryAttachToPendingUsageMetricsRequestIfExisting=function(e,t,i,o,r){var a=this.getPendingRequestIfExisting(i,o);return!_.isEmpty(a)&&(this.attachToPendingUsageMetricsRequest(a,e,t,i,o,r),!0)},t.prototype.pushPendingUsageMetricsRequest=function(e,t){var i=this.promiseFactory.defer(),o={artifactType:t,groupObjectId:e,defered:i};return this.pendingUsageMetricsRequests.push(o),o},t.prototype.attachToPendingUsageMetricsRequest=function(e,t,i,o,r,a){var n=this;e.defered.promise.then((function(e){e&&n.showSuccessToastToNavigateToReport(e.objectId,i,o,t,r),n.onPackagePublishSucceeded(a)}),(function(e){return n.onPackagePublishFailed(a,e.requestId,e.errorCode)}))},t.prototype.showSuccessToastToNavigateToReport=function(t,i,o,r,a){var n=this,s={displayText:this.localizationService.get("UsageMetrics_FinishedLoadingButtonText"),action:function(){return n.constructODataFiltersThenNavigateToReportByGuid(t,a,i,o)}};this.notificationToastService.notify({title:this.localizationService.get("UsageMetrics_FinishedLoadingTitle"),message:this.localizationService.format("UsageMetrics_FinishedLoadingSubtitle",[r]),notificationType:e.common.NotificationToastType.Success,actionButtons:[s],sticky:!0})},t.prototype.getUsageMetricsReportIfExisting=function(e){var t=this,i=-1;if(e===r.Dashboard)i=103;else{if(e!==r.Report)return;i=102}var o=_.find(this.reportService.reports,(function(e){var o=t.packageService.findPackage(e.packageId);return o.contentProviderId===i}));return o},t.prototype.constructODataFiltersThenNavigateToReportByGuid=function(e,t,i,o){var a="";t===r.Report?a="Reports/ReportGuid eq '"+i+"'":t===r.Dashboard&&(a="Dashboards/DashboardGuid eq '"+i+"'"),this.navigation.navigateToReport({groupGUID:o,reportGUID:e,filter:a})},t.prototype.getPendingRequestIfExisting=function(e,t){var i=_.find(this.pendingUsageMetricsRequests,(function(i){return i.artifactType===t&&i.groupObjectId===e}));return i},t.prototype.onPackagePublishSucceeded=function(e){this.onPackagePublishDone(e)},t.prototype.onPackagePublishFailed=function(e,t,i){this.onPackagePublishDone(e),this.showErrorMessage(t,i)},t.prototype.onPackagePublishDone=function(e){_.isEmpty(e)||this.notificationToastService.hide(e)},t.prototype.showErrorMessage=function(e,t){this.errorService.error(this.localizationService.get("UsageMetrics_FailedOpeningReport_Message"),"FailedToOpenUsageMetricsReport",{requestId:e,statusCode:t})},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,o,r,a,n,s,c,l){return new i(e,t,o,r,a,n,s,c,l)}e.createUserSettingsService=t;var i=(function(){function t(e,t,i,o,r,a,n,s,c){this.telemetryService=e,this.modelConverter=t,this.promiseFactory=i,this.userSettingsHttpService=o,this.errorService=r,this.localizationService=a,this.appMetadataService=n,this.networkAvailability=s,this.rootScope=c,this.getSettingsDeferred=null,this.forceRefreshOfUserSettings=!1}return t.prototype.getUserSettings=function(){var t=this;return this.getSettingsDeferred||(this.getSettingsDeferred=this.promiseFactory.defer(),this.appMetadataService.getAppMetadata().then((function(i){if(i.userSettings&&!t.forceRefreshOfUserSettings){var o=i.userSettings.preferredLanguage,r=e.common.cultureInfo;o&&o!==r&&t.telemetryService.logEvent(e.telemetry.LocaleIncorrectLocaleSetting,o,r),t.getSettingsDeferred.resolve(t.modelConverter.convertUserSettings(i.userSettings)),t.getSettingsDeferred=null}else t.loadUserSettingsFromServer(i),t.forceRefreshOfUserSettings=!1}),(function(){t.loadUserSettingsFromServer()}))),this.getSettingsDeferred.promise},t.prototype.refreshUserSettings=function(){this.forceRefreshOfUserSettings=!0},t.prototype.getExtendedSettingByKey=function(e){var t=this,i=this.promiseFactory.defer();return this.ensureExtendedSettings().then((function(){i.resolve(t.extendedSettings[e])})),i.promise},t.prototype.getExtendedSettingsByKeys=function(e){var t=this,i=this.promiseFactory.defer();return this.ensureExtendedSettings().then((function(){i.resolve(_.map(e,(function(e){return t.extendedSettings[e]})))})),i.promise},t.prototype.updateExtendedSettings=function(e,t,i){var o=this;return this.ensureExtendedSettings().then((function(){o.extendedSettings[e]=t;var r=JSON.stringify(o.extendedSettings);return o.userSettingsHttpService.updateExtendedSettings(r,i.event).then((function(){i.resolve()}))})).catch((function(e){i.reject()}))},t.prototype.ensureExtendedSettings=function(){var e=this,t=this.promiseFactory.defer();return this.extendedSettings?t.resolve(null):this.getUserSettings().then((function(i){e.extendedSettings=i&&i.extendedSettings?i.extendedSettings:{},t.resolve(null)})),t.promise},t.prototype.loadUserSettingsFromServer=function(t){var i=this;if(!this.networkAvailability.isNetworkAvailable())return this.getSettingsDeferred.reject(),void(this.getSettingsDeferred=null);var o=this.telemetryService.startEvent(e.telemetry.PrivacyInitializeSettingsModel);this.userSettingsHttpService.getUserSettings(o.event).then((function(e){var r=e.data;t&&(t.userSettings=r),i.getSettingsDeferred.resolve(i.modelConverter.convertUserSettings(r)),i.getSettingsDeferred=null,o.resolve()}),(function(e){i.getSettingsDeferred.reject(),o.reject(),i.getSettingsDeferred=null,i.errorService.error(i.localizationService.get("SettingsGeneral_Error_FailedToLoad"),"SettingsGeneral_Error_FailedToLoad",{requestId:e.requestId,statusCode:e.status.toString()})}))},t.prototype.updateAllowQnaDataCollection=function(t,i){var o=this,r=this.promiseFactory.defer();return this.userSettingsHttpService.updateAllowQnaDataCollection(t,i.event).then((function(){i.resolve(),window.initialDashboardContainer&&window.initialDashboardContainer.userSettings&&(window.initialDashboardContainer.userSettings.allowQnaDataCollection=t),r.resolve(t),o.rootScope.$emit(e.constants.notifyUpdateAllowQnaDataCollectionEventName,t)}),(function(e){i.reject(),r.reject(),o.errorService.error(o.localizationService.get("SettingsGeneral_Error_FailedToSave"),"SettingsGeneral_Error_FailedToSave",{requestId:e.requestId,statusCode:e.status.toString()})})),r.promise},t.prototype.updateEsriSetting=function(e,t){var i=this,o=this.promiseFactory.defer(),r={esriVisualEnabled:e};return this.userSettingsHttpService.updateUserSettings(r,t.event).then((function(){t.resolve(),o.resolve(e)}),(function(e){t.reject(),o.reject(),i.errorService.error(i.localizationService.get("SettingsGeneral_Error_FailedToSave"),"SettingsGeneral_Error_FailedToSave",{requestId:e.requestId,statusCode:e.status.toString()})})),o.promise},t.prototype.updateLanguageSetting=function(e,t){var i=this,o=this.promiseFactory.defer(),r={preferredLanguage:e};return this.userSettingsHttpService.updateUserSettings(r,t.event).then((function(){t.resolve(),o.resolve(e)}),(function(e){t.reject(),o.reject(),i.errorService.error(i.localizationService.get("SettingsGeneral_Error_FailedToSave"),"SettingsGeneral_Error_FailedToSave",{requestId:e.requestId,statusCode:e.status.toString()})})),o.promise},t.prototype.updatePinDialogPreviewTileFormat=function(e,t){var i=this,o=this.promiseFactory.defer(),r={tileDialogPreviewFormat:e};return this.userSettingsHttpService.updateUserSettings(r,t.event).then((function(){t.resolve(),window.initialDashboardContainer&&window.initialDashboardContainer.userSettings&&(window.initialDashboardContainer.userSettings.tileDialogPreviewFormat=e),o.resolve(e)}),(function(e){t.reject(),o.reject(),i.errorService.error(i.localizationService.get("SettingsGeneral_Error_FailedToSave"),"SettingsGeneral_Error_FailedToSave",{requestId:e.requestId,statusCode:e.status.toString()})})),o.promise},t})()})(powerbi||(powerbi={}));var powerbi;!(function(e){var t="zh-hans",i="zh-hant",o="cn",r="zh-TW",a=(function(){function e(){}return e.createIfUndefined=function(){e.Popover||($("body").append(e.PopoverHtml),e.Popover=$(e.PopoverSelector),e.hide(),e.Popover.find(e.FooterSelector).on(jsCommon.DOMConstants.mouseDownEventName,(function(e){e.stopPropagation()})))},e.setFooterText=function(t){e.Popover.find(e.FooterSelector).html(t)},e.show=function(){e.createIfUndefined(),e.Popover.show()},e.hide=function(){e.Popover&&e.Popover.hide()},e})();a.PopoverHtml='<div id="popover"><div id="popovermain"><div class="powerbi-spinner"><div class="spinner"><div class="dots" ><span>&#9679;</span><span>&#9679;</span><span>&#9679;</span><span>&#9679;</span><span>&#9679;</span></div></div></div></div><div class="footer"></div></div>',a.PopoverSelector="#popover",a.FooterSelector=".footer",e.UserVoicePopover=a;var n=(function(){function n(){}return Object.defineProperty(n,"api",{get:function(){return n.updateEventBindings(),window.UserVoice},enumerable:!0,configurable:!0}),n.updateIdentificationInfo=function(){e.session.userInfo&&n.api.push([n.identifyKey,{email:e.session.UserInfoUtils.getEmailAddressForReceivingMail(),display_name:e.session.UserInfoUtils.getFullName(),id:e.session.userInfo.puid}])},n.ensureUserVoice=function(s,c){var l=this;if(!this.serviceLoaded){var d=this.promiseFactory.defer(),p=(new Date).toTimeString();n.loadAPI();var u=e.common.httpService.powerbiRequestOptions();return u.telemetryDescription="GetUserVoiceDetails",e.common.localization.loader.currentLanguageLocale.toLowerCase()===t?n.api.push(["set","locale",o]):e.common.localization.loader.currentLanguageLocale.toLowerCase()===i?n.api.push(["set","locale",r]):n.api.push(["set","locale",e.common.localization.loader.currentLanguageLocale||window.navigator.language||window.navigator.userLanguage]),n.api.push(["set",{accent_color:"#000000"}]),n.api.push(["set","ticket_custom_fields",{ClientSessionID:s.sessionId,TimeZone:p.substring(p.indexOf(" ")+1)}]),n.updateIdentificationInfo(),e.common.httpService.get("/powerbi/metadata/user/userVoiceDetails",u).then((function(t){null!=t.data&&null!=t.data.alternateEmail&&t.data.alternateEmail.length>0&&e.session.userInfo&&(e.session.userInfo.alternateEmail=t.data.alternateEmail),n.updateIdentificationInfo(),l.serviceLoaded=!0,c(),d.resolve({})})),$("body").on(jsCommon.DOMConstants.mouseDownEventName,(function(e){n.onBodyClick(e),a.hide()})),d}c()},n.loadAPI=function(){window.UserVoice||(window.UserVoice=window.UserVoice||[],(function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//widget.uservoice.com/EPlzu5neSTcHV7QTq9luQ.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})())},n.updateEventBindings=function(){window.setTimeout((function(){n.activeWidgets=$(".uv-popover"),n.activeWidgets.on(jsCommon.DOMConstants.mouseClickEventName,(function(e){e.stopPropagation()}))}),250)},n.onBodyClick=function(e){n.activeWidgets&&n.activeWidgets.length>0&&(n.activeWidgets.remove(),n.activeWidgets=null)},n})();n.identifyKey="identify",n.serviceLoaded=!1,n.promiseFactory=e.createJQueryPromiseFactory(),e.UserVoiceService=n})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){function t(e,t){t.models=i(e.models,t.models),t.packages=i(e.packages,t.packages),t.reports=i(e.reports,t.reports),t.workbooks=i(e.workbooks,t.workbooks)}function i(e,t){if(_.isEmpty(e))return t;if(_.isEmpty(t))return e;for(var i={},o=0,r=t.length;o<r;o++){var a=t[o];i[a.id]=a}for(var n=0,s=e.length;n<s;n++){var c=e[n];i[c.id]=c}var l=[];for(var d in i)l.push(i[d]);return l}e.mergeDashboardContainerModelsReportsAndPackages=t})(t=e.contracts||(e.contracts={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.explore.contracts,o=e.explore.viewModels,r=(function(){function t(i,o){var r=this;this.scope=i,this.services=o,this.rtl=this.services.rtl,this.scope.userGroupHeader=new e.models.UserGroupHeaderModel,this.scope.viewModel.isLoaded=!1,this.scope.sortDescending=!1,this.scope.sortProperty="associatedReport.displayName",this.scope.onDeleteEmbedClick=function(e){return r.onDeleteEmbedClick(e)},this.scope.showEmbedCode=function(e){return r.showEmbedCode(e)},this.scope.updateSortProperty=function(e){return r.updateSortProperty(e)},this.loadEmbeddedResources(),this.scope.manageFlyoutStyle=t.ManageFlyoutInactiveStyle,this.scope.toggleFlyout=function(e,t){return r.toggleFlyout(e,t)},i.$on("$destroy",(function(){return r.dispose()})),$(window).on(jsCommon.DOMConstants.keyDownEventName,(function(e){return r.keyDownHideDialog(e)})),$(window).on(jsCommon.DOMConstants.mouseDownEventName,(function(e){
return r.mouseDownHideDialog(e)}))}return t.createOptions=function(){return{additionalServices:["reportService","modelService","embedProxy","embed","errorService","modelConverter","localizationService","telemetryService","promiseFactory","modalDialogService","rtl","activeGroupId"]}},t.prototype.deleteEmbed=function(t,o){var r=this,a=_.find(this.scope.viewModel.embeddedResources,(function(e){return e.contract.snapshotId===t&&e.contract.embedType===o})),n=this.services.telemetryService.startEvent(e.telemetry.ManageEmbedDeleteEmbedCode,a.contract.snapshotId,a.contract.embedType,a.contract.disabled);this.deleteEmbedInternal(a).then((function(e){n.resolve();var i=_.findIndex(r.scope.viewModel.embeddedResources,(function(e){return e.contract.snapshotId===t&&e.contract.embedType===o}));r.scope.viewModel.embeddedResources.splice(i,1)}),(function(e){n.reject(),a.contract.embedType===i.EmbedType.Interactive&&r.services.errorService.error("Delete live embed error","DeleteLiveEmbedError",{requestId:e.requestId,statusCode:e.status.toString()})}))},t.prototype.onDeleteEmbedClick=function(e){var t=this,i=this.scope.$new(!0),o=[new InJs.ModalDialogAction(this.services.localizationService.get("ManageEmbed_PublishToWeb_DeleteConfirmationConfirmButtonText"),function(o,r){i.closeDialog(),t.deleteEmbed(e.contract.snapshotId,e.contract.embedType)},null,"confirmation"),new InJs.ModalDialogAction(this.services.localizationService.get("ManageEmbed_PublishToWeb_DeleteConfirmationCloseButtonText"),function(e,t){i.closeDialog()})],r=this.services.localizationService.get("ManageEmbed_PublishToWeb_DeleteConfirmationTitle"),a=this.services.localizationService.get("ManageEmbed_PublishToWeb_DeleteConfirmationMessage");i.viewModel={message:a};var n={dialogCssClass:"embedDeleteDialog",dialogName:r,template:"<confirmation-modal-dialog></confirmation-modal-dialog>",scope:i,dialogActions:o};this.services.modalDialogService.showLegacyWebModalDialog(n)},t.prototype.toggleFlyout=function(e,i){this.scope.manageFlyoutStyle===t.ManageFlyoutActiveStyle?this.scope.manageFlyoutStyle=t.ManageFlyoutInactiveStyle:(this.scope.selectedEmbed=i,this.showDialog(e))},t.prototype.showDialog=function(e){var i=this;if(!this.flyoutElement){var o=this.services.activeGroupId.isReadOnly?t.ManageFlyoutTemplateForReadOnlyMember:t.ManageFlyoutTemplateForNonReadOnlyMember;this.template=angular.element(o),this.flyoutElement=this.services.compile(this.template)(this.scope),this.arrowElement=this.flyoutElement.find(t.ArrowSelector),$("body").append(this.flyoutElement)}var r={left:e.pageX,top:e.pageY},a=e.target,n=a.clientWidth;this.services.timeout((function(){if(r.top-=i.flyoutElement.height()/2-t.PositionOffset.top,r.top=i.adjustPositionTop(r),i.rtl&&i.rtl.isRtlLayout){var e=i.flyoutElement.width();r.left=r.left-(e+t.ArrowWidth)-t.PositionOffset.left,i.arrowElement.addClass(t.rightArrowDirection)}else r.left+=n+t.ArrowWidth+t.PositionOffset.left;i.flyoutElement.css(r),i.scope.manageFlyoutStyle=t.ManageFlyoutActiveStyle}))},t.prototype.adjustPositionTop=function(e){var i=0,o=i+$(document).height()-this.flyoutElement.height();return e.top<i?(this.arrowElement.css({top:e.top+this.flyoutElement.height()/2-i+t.ArrowPositionOffset.top}),i):e.top>o?(this.arrowElement.css({top:e.top+this.flyoutElement.height()/2-o+t.ArrowPositionOffset.top}),o):(this.arrowElement.removeAttr("style"),e.top)},t.prototype.showEmbedCode=function(t){var i=this.scope.$new(!0),r=t.associatedReport.id,a=t.contract,n=a.name,s={name:n,reportId:r,culture:e.common.cultureInfo,size:{height:a.size.height,width:a.size.width},version:e.build},c=this.services.promiseFactory.defer();c.reject(),i.viewModel=o.ViewModelFactory.createEmbedModalDialog(this.services.localizationService,this.services.embed,void 0,s,c.promise,void 0);var l=i.viewModel;l.publishState=4,l.currentEmbed=a;var d=l.embedTab.embed,p=this.services.embed;d.link=p.createEmbedUri(a),d.embedCode=p.createEmbedCode(a);var u={containerCssClass:"small embedContainer",dialogCssClass:"embedDialog",dialogName:null,template:"<embed-modal-dialog></embed-modal-dialog>",scope:i};this.services.modalDialogService.showLegacyWebModalDialog(u)},t.prototype.deleteEmbedInternal=function(e){if(e.contract.embedType===i.EmbedType.Interactive)return this.services.embedProxy.deleteLiveEmbed(e.contract.snapshotId)},t.prototype.loadEmbeddedResources=function(){this.scope.viewModel.isLoaded=!1,this.scope.viewModel.embeddedResources=[],this.loadAllEmbeds()},t.prototype.loadAllEmbeds=function(){var t=this,i=this.services.telemetryService.startEvent(e.telemetry.ManageEmbedLoadAllLiveEmbeddedResources);this.services.embedProxy.getLiveEmbeds().then((function(e){i.resolve(),t.processAllEmbeddedResources(e),t.scope.viewModel.isLoaded=!0}),(function(e){i.reject(),t.scope.viewModel.isLoaded=!0,t.services.errorService.error(t.services.localizationService.get("ManageEmbed_ErrorMessage_FailedGetLiveEmbeds"),"FailedGetLiveEmbedForReport",{requestId:e.requestId,statusCode:e.status.toString()})}))},t.prototype.processAllEmbeddedResources=function(e){for(var t=this,i=0,o=e.length;i<o;i++){var r=this.services.reportService.findReport(e[i].reportId);r.model=r.model||this.services.modelService.findModel(r.modelId,r.packageId);var a=this.services.modelConverter.convertEmbedToEmbeddedResource(e[i],r);this.services.localizationService.ensureLocalization((function(){a.embedType=t.services.localizationService.get(a.embedTypeLocalizationKey),a.status=t.services.localizationService.get(a.statusLocalizationKey),t.scope.viewModel.embeddedResources.push(a)}))}},t.prototype.mouseDownHideDialog=function(e){var i=this;this.clickOutsideFlyout(e)&&this.scope.$apply((function(){i.scope.manageFlyoutStyle=t.ManageFlyoutInactiveStyle}))},t.prototype.keyDownHideDialog=function(e){var i=this;this.scope.manageFlyoutStyle===t.ManageFlyoutActiveStyle&&27===e.keyCode&&this.scope.$apply((function(){i.scope.manageFlyoutStyle=t.ManageFlyoutInactiveStyle}))},t.prototype.clickOutsideFlyout=function(e){var i=e.pageX,o=e.pageY;if(this.flyoutElement&&this.scope.manageFlyoutStyle===t.ManageFlyoutActiveStyle){var r=this.flyoutElement.offset(),a=r.left,n=r.top,s=a+this.flyoutElement.width(),c=n+this.flyoutElement.height();return a>i||i>s||n>o||o>c}return!1},t.prototype.dispose=function(){this.flyoutElement&&this.flyoutElement.remove(),$(window).off(jsCommon.DOMConstants.keyDownEventName,this.keyDownHideDialog),$(window).off(jsCommon.DOMConstants.mouseDownEventName,this.mouseDownHideDialog)},t.prototype.updateSortProperty=function(e){this.scope.sortProperty===e?this.scope.sortDescending=!this.scope.sortDescending:(this.scope.sortProperty=e,this.scope.sortDescending=!1)},t})();r.ArrowWidth=28,r.ArrowPositionOffset={left:0,top:-10},r.ArrowSelector=".wrapper .arrow",r.ManageFlyoutActiveStyle="active",r.ManageFlyoutInactiveStyle="inactive",r.rightArrowDirection="right",r.PositionOffset={left:-22,top:0},r.GetCodeTemplate="<div class='action alignIcon'><i class='glyphicon glyph-small pbi-glyph-code'></i><a href='' localize='ManageEmbed_CodeText' ng-click='showEmbedCode(selectedEmbed)'></a></div>",r.DeleteTemplate="<div class='alignIcon'><i class='glyphicon glyph-small pbi-glyph-delete'></i><a href='' localize='ManageEmbed_DeleteText' ng-click='onDeleteEmbedClick(selectedEmbed)'></a></div>",r.ManageFlyoutTemplate="<div class='manageFlyout active' ng-class='manageFlyoutStyle'><div class='wrapper'><div class='arrow'></div><div class='manageFlyout-container'>{0}</div></div></div>",r.ManageFlyoutTemplateForReadOnlyMember=jsCommon.StringExtensions.format(r.ManageFlyoutTemplate,r.GetCodeTemplate),r.ManageFlyoutTemplateForNonReadOnlyMember=jsCommon.StringExtensions.format(r.ManageFlyoutTemplate,r.GetCodeTemplate+"<br/>"+r.DeleteTemplate),t.ManageEmbedView=r})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.helpers.ModelConverterHelper,o=(function(){function t(e,t){this.scope=e,this.services=t,this.initialize(this.scope.viewModel)}return t.createOptions=function(){return{additionalServices:["localizationService","modelConverter","modelService","navigation","storageUsageService","userSettingsService","featureSwitchService","dashboardDataService","rtl","sampleQuestionsService"],scopedServiceRoot:!0}},t.prototype.initialize=function(t){var o=this,r=!t||!t.models;if(r&&this.services.navigation.inQnaView()){var a=this.services.dashboardDataService.activeDashboard,n=this.services.dashboardDataService.activeDashboardModels;a&&n?(this.scope.viewModel.models=n,this.scope.viewModel.title=a.displayName):this.unregisterDashboardContainerWatch=this.services.rootScope.$on(e.constants.dashboardContainerLoaded,(function(){var e=o.services.dashboardDataService.activeDashboard,t=o.services.dashboardDataService.activeDashboardModels;o.scope.viewModel.models=t,o.scope.viewModel.title=e.displayName}))}else r&&this.services.navigation.inQnaModelView()&&this.services.modelService.modelsPromise.then((function(e){var t=o.services.navigation.currentDatasetDBName,i=_(e).filter((function(e){return e.dbName===t})).map((function(e){return e.contract})).value();o.scope.viewModel.models=i,o.scope.viewModel.title=i[0].displayName}));this.scope.questionBoxOutput={utterance:"",showQnaFeedback:!1,showPinButton:!1,interpretUtterance:null,updateUtteranceWithoutInterpret:null,clearQuestionBox:null,showUserFeedbackDialog:null},this.scope.newQnaEnabled=!this.services.rtl.isRtlLayout,this.scope.getAdditionalODataFilter=function(){return o.services.navigation.additionalODataFilter},this.scope.pinQnAVisual=function(e){return o.pinQnAVisual(e)},this.scope.showQnaStart=function(){return o.showQnaStart()};var s=this.scope.navigation=this.services.navigation,c={getInitialVisualState:function(){return 4},setInterpretListener:function(e){o.scope.infoNavContainerInterpretListener=e},updatePinIconState:function(e){o.scope.pinIconState=e},setUtteranceText:function(e){o.scope.questionBoxOutput.updateUtteranceWithoutInterpret(e)}};this.scope.infoNavHostService=c,this.scope.allowQnaDataCollection=!1,this.services.userSettingsService.getUserSettings().then((function(e){e&&(o.scope.allowQnaDataCollection=e.allowQnaDataCollection)}));var l=this.services.rootScope.$on(e.constants.notifyUpdateAllowQnaDataCollectionEventName,(function(e,t){e.stopPropagation(),e.preventDefault(),o.scope.allowQnaDataCollection=t}));if(this.scope.$watch("viewModel.models",(function(e){if(e){var t=o.services.featureSwitchService.featureSwitches;o.scope.modelsSupportQna=_.some(e,(function(e){return i.getIsQnaSupported(e,t)}))}})),s.qnaQuery)var d=this.scope.$watch("questionBoxOutput.interpretUtterance",(function(e){e&&(e(s.qnaQuery),o.watchUtteranceForNavigation(),d())}));else this.watchUtteranceForNavigation();this.services.localizationService.ensureLocalization((function(){o.scope.unsupportedModelMessage=o.services.localizationService.get("QnAVisualization_UnsupportedModelTitleText")})),this.scope.$on("$destroy",(function(){l(),o.unregisterDashboardContainerWatch&&o.unregisterDashboardContainerWatch()})),this.setQnaEnableAndTilesUtterance()},t.prototype.watchUtteranceForNavigation=function(){var e=this.services.navigation;this.scope.$watch("questionBoxOutput.utterance",(function(t){e.inQnaModelView()||e.inQnaView()?e.showQnaView(t,2,!1):_.isEmpty(t)||(e.qnaQuery||"")===(t||"")||e.showQnaView(t,0,!1)}))},t.prototype.pinQnAVisual=function(t){t.stopPropagation(),this.services.rootScope.$emit(e.infonav.constants.pinSelectedVisual)},t.prototype.showQnaStart=function(){var e=this.services.navigation;e.showQnaStart(e.inQnaStartView()?2:0)},t.prototype.setQnaEnableAndTilesUtterance=function(){var e=this.services.dashboardDataService;e.updateIsQnaEnabled();var t=e.activeDashboard&&e.activeDashboard.tiles;if(!_.isEmpty(t)){var i=this.services.sampleQuestionsService;i.clearTilesUtterance();for(var o=0,r=t;o<r.length;o++){var a=r[o];_.isEmpty(a.utterance)||i.addTileUtterance(a.utterance,a.contract.modelId)}}},t})();t.QnaContainerController=o})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.services.FullScreenFitStyle,o=(function(){function t(o,r){var a=this;this.restrict="E",this.templateUrl="views/fullScreenControls.html",this.replace=!0,this.scope={},this.link=function(o,r,n){var s=-1,c=function(){s!==-1&&(window.clearTimeout(s),r.addClass(t.TransitioningCSSClass)),s=window.setTimeout((function(){s=-1,r.removeClass(t.TransitioningCSSClass)}),t.ControlDisplayTimeInMs)},l=function(e){o.$applyAsync((function(){return 27===e.keyCode?void(a.fullScreen.fullScreenMode=!1):void(a.navigation.inDashboardDetailView()&&83===e.keyCode?o.toggleFitContent():a.navigation.inDashboardDetailView()&&87===e.keyCode?o.toggleFitWidth():a.navigation.inReportDetailView()&&(37===e.keyCode?a.fullScreen.fullScreenPreviousPage():39===e.keyCode&&a.fullScreen.fullScreenNextPage()))}))};o.toggleFitContent=function(){a.fullScreen.fitStyle=a.fullScreen.fitStyle!==i.FitToContent?i.FitToContent:i.None},o.toggleFitWidth=function(){a.fullScreen.fitStyle=a.fullScreen.fitStyle!==i.FitToWidth?i.FitToWidth:i.None},o.print=function(){return window.print()},o.exitFullScreen=function(){return a.fullScreen.fullScreenMode=!1},o.fullScreen=a.fullScreen,o.navigation=a.navigation,o.$watch("fullScreen.fullScreenMode",(function(e,t){e?(c(),$(document).on("mousemove",c),$(document).on("keydown",l)):($(document).off("mousemove",c),$(document).off("keydown",l))})),o.$on(e.common.constants.scopeDestroyEventName,(function(){$(document).off("mousemove",c),$(document).off("keydown",l)}))},this.fullScreen=o,this.navigation=r}return t})();o.TransitioningCSSClass="transitioning",o.ControlDisplayTimeInMs=1500,t.FullScreenControls=o})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/manageEmbedView.html",this.scope={viewModel:"=",dashboardContainer:"="},this.replace=!0,this.controller=e.common.createController(e.controllers.ManageEmbedView)}return t})();t.ManageEmbedView=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.templateUrl="views/qna/qnaContainer.html",this.replace=!0,this.scope={viewModel:"=",collapsiblePaneMode:"="},this.controller=e.common.createController(e.controllers.QnaContainerController)}return t})();t.QnaContainer=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){}return e})();e.ManageEmbedViewModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e){this.contract=e}return e})();e.QnaContainer=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={})),angular.module("powerbi").run(["$templateCache",function(e){e.put("components/alertsEditor/alertsEditor.html",'<div id="alertsEditor" class="paneLayout"><header><div class="alertsPaneHeader"><h4 class="alertsEditorPaneTitle" ng-bind="::$ctrl.viewModel.tileName"></h4><h4 class="alertsEditorPaneSubtitle" localize="AlertsPane_Title"></h4></div> <button class="optionsMenuButton" dropdown-overlay-invoke="moreOptionsMenu"><i class="glyphicon pbi-glyph-more glyph-small"></i></button><dropdown-overlay dropdown-overlay-name="moreOptionsMenu" dropdown-overlay-class="angular-dropdown override-box-shadow"><dropdown-menu-items dropdown-items="::$ctrl.viewModel.moreOptionsMenu" dropdown-class="additionalMenus active" dropdown-on-item-selected="$ctrl.moreOptionsMenuSelected(selected)"></dropdown-menu-items></dropdown-overlay></header><section class="banner" ng-if="!$ctrl.isLoading"><pbi-button label="AlertsPane_AddAlert" class="wideButton" icon-name="add" primary="true" ng-click="$ctrl.addNewAlert()"></pbi-button></section><section class="contentContainer"><div class="alertsLoadingContainer" ng-if="$ctrl.isLoading"><spinner modern></spinner><div class="alertsLoadingText" localize="AlertsPane_Loading"></div></div><div ng-if="!$ctrl.isLoading"><div class="noAlertsContainer" ng-if="!$ctrl.viewModel.alerts || $ctrl.viewModel.alerts.length <= 0"><i class="glyphicon glyph-medium pbi-glyph-bell"></i><div class="noAlertsText" localize="AlertsPane_NoAlerts"></div></div><div class="alertsContainer" ng-if="$ctrl.viewModel.alerts.length> 0"><form name="$ctrl.alertForm"><div class="alert" ng-repeat="alert in $ctrl.viewModel.alerts track by $index"><div class="alertHeader" ng-click="alert.isExpanded = !alert.isExpanded"><i class="glyphicon glyph-mini" ng-class="alert.isExpanded ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"></i><div class="alertTitle" ng-bind="alert.title" ng-attr-title="alert.title"></div><i class="alertDelete glyphicon glyph-small pbi-glyph-delete" ng-click="$ctrl.removeAlert($event, $index)"></i></div><div class="errorBlock" ng-if="alert.alertFailureState !== 0" ng-class="{hidden: !alert.isExpanded}"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" ng-repeat="failureMessage in ::$ctrl.viewModel.alertFailureMessages track by $index" ng-if="alert.alertFailureState === failureMessage.value" ng-bind="failureMessage.message" ng-attr-title="failureMessage.message"></div></div><div class="alertContent" ng-class="{hidden: !alert.isExpanded}"><pbi-toggle ng-model="alert.enabled" label="AlertsPane_ActiveLabel" on-state-text="AlertsPane_ToggleOn" off-state-text="AlertsPane_ToggleOff"></pbi-toggle><ng-form name="{{\'alertForm\' + $index}}"><fieldset ng-class="{disabled: !alert.enabled}"><pbi-textfield ng-disabled="!alert.enabled" ng-model="alert.title" ng-class="{validationError: !$ctrl.isValidTitle(alert)}" label="AlertsPane_AlertTitle" maxlength="250"></pbi-textfield><div class="errorBlock" ng-if="!$ctrl.isValidTitle(alert)"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="AlertsPane_InvalidTitle" localize-tooltip="AlertsPane_InvalidTitle"></div></div><pbi-textfield class="alertMeasureName" ng-model="alert.measureName" ng-disabled="true" label="AlertsPane_AlertRule"></pbi-textfield><div class="condition"><label localize="AlertsPane_Condition"></label> <select ng-disabled="!alert.enabled" ng-model="alert.operator" ng-options="operator.value as operator.label for operator in ::$ctrl.viewModel.operatorOptions"></select></div><pbi-textfield ng-disabled="!alert.enabled" class="alertThreshold" ng-model="alert.thresholdValue" ng-class="{validationError: !$ctrl.isValidThreshold(alert)}" label="AlertsPane_Threshold"></pbi-textfield><div class="errorBlock" ng-if="!$ctrl.isValidThreshold(alert)"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="AlertsPane_InvalidThreshold" localize-tooltip="AlertsPane_InvalidThreshold"></div></div><pbi-radio-group class="frequency" ng-disabled="!alert.enabled" ng-model="alert.frequency" label="AlertsPane_NotificationFrequency"><pbi-radio ng-repeat="frequency in ::$ctrl.viewModel.frequencyOptions track by $index" label="{{frequency.label}}" ng-value="frequency.value"></pbi-radio></pbi-radio-group><label localize="AlertsPane_NotificationFrequency_Message"></label><div class="alertNotificationEmailText" localize="AlertsPane_EmailText"></div><pbi-checkbox ng-disabled="!alert.enabled" label="AlertsPane_EmailLabel" ng-model="alert.emailNotificationEnabled"></pbi-checkbox></fieldset></ng-form></div></div></form></div></div></section><section class="banner"><ul><li><a href="https://go.microsoft.com/fwlink/?linkid=841258" target="_blank"><pbi-button label="AlertsPane_Microsoft_Flow" kind="text"></pbi-button></a></li></ul></section><footer><fieldset class="buttons"><spinner modern ng-if="$ctrl.isUpdating"></spinner><pbi-button primary="true" label="AlertsPane_Save" ng-click="$ctrl.saveChangesAndExit()" ng-disabled="!$ctrl.viewModel.isValid() || $ctrl.isUpdating || $ctrl.isLoading || !$ctrl.hasChangesToSave()"></pbi-button><pbi-button label="AlertsPane_Cancel" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></div>'),e.put("components/appArtifactsList/appArtifactsList.html",'<section class="typeTitle" ng-click="$ctrl.toggle($event)"><i class="caret glyphicon pbi-glyph-caretright glyph-mini smallFontSize" ng-class="{expanded : $ctrl.viewModel.expanded}"/><span class="unselectable" localize="{{::$ctrl.viewModel.title}}"></span></section><section ng-if="$ctrl.viewModel.expanded" class="unselectable artifactsHeader"><header class="name trimmedTextWithEllipsis unselectable" localize="ContentHeader_Name"></header><header class="actions trimmedTextWithEllipsis unselectable" ng-class="::{noClassification: !$ctrl.viewModel.isDataClassificationEnabled}" localize="ContentHeader_Actions"></header><header ng-if="::$ctrl.viewModel.isDataClassificationEnabled" class="classification" localize="ContentHeader_Classification"></header></section><section ng-if="$ctrl.viewModel.expanded" class="artifactsScrollSection"><div class="itemContainer" ng-repeat="artifact in $ctrl.viewModel.artifacts"><section class="artifact"><section class="icons"><span class="tileTypeIndicator glyphicon glyph-small {{::$ctrl.viewModel.className}}"></span></section><section class="name" ng-class="{clickable: $ctrl.canOpenTile(artifact) }" ng-click="$ctrl.openContentTile(artifact)"><span class="displayName trimmedTextWithEllipsis" ng-bind="::artifact.displayName" title="{{::artifact.displayName}}"></span><pbi-icon ng-if="::$ctrl.isNew(artifact)" name="asterisk" size="mini"></pbi-icon></section><content-tile-options-menu class="actions unselectable" ng-class="::{readOnly: !$ctrl.canShowOptionsMenu(artifact), noClassification: !$ctrl.viewModel.isDataClassificationEnabled}" view-model="::artifact" in-list-view="true"></content-tile-options-menu><data-classification-label ng-if="::$ctrl.viewModel.isDataClassificationEnabled" class="classification unselectable" data-classification-id="artifact.dataClassificationId"></data-classification-label></section></div></section>'),e.put("components/appChannelHeader/appChannelHeader.html",'<header class="channelHeader" ng-style="{\'background-color\': $ctrl.viewModel.headerBackgroundColor, \'color\': $ctrl.getHeaderFontColor()}"><app-logo view-model="::$ctrl.viewModel" size="small"></app-logo><h6 class="header trimmedTextWithEllipsis unselectable" bind-text-and-tooltip="$ctrl.getAppTitle()"></h6><span class="description trimmedTextWithEllipsis" bind-text-and-tooltip="$ctrl.viewModel.description"></span><aside class="status"><div class="details"><pbi-icon name="gauge" size="small"></pbi-icon><span class="countLabel" bind-text-and-tooltip="$ctrl.dashboards.length.toString()"></span></div><div class="details"><pbi-icon name="barchart" size="small"></pbi-icon><span class="countLabel" bind-text-and-tooltip="$ctrl.reports.length.toString()"></span></div><div class="details"><pbi-icon name="excel" size="small"></pbi-icon><span class="countLabel" bind-text-and-tooltip="$ctrl.workbooks.length.toString()"></span></div><div class="details"><pbi-icon name="database" size="small"></pbi-icon><span class="countLabel" bind-text-and-tooltip="$ctrl.datasets.length.toString()"></span></div><div class="details appIndex" ng-if="::$ctrl.enableNavigation" ng-click="$ctrl.navigateToApp()"><pbi-icon name="bulletedlist" size="small"></pbi-icon><span class="countLabel" bind-text-and-tooltip="::$ctrl.appIndexLabel"></span></div></aside></header>'),e.put("components/appContainer/appContainer.html",'<app-channel-header view-model="::$ctrl.installedApp" ng-if="$ctrl.installedApp"></app-channel-header><div ng-if="$ctrl.installedApp && $ctrl.inAppArtifactsListView()" ng-init="$ctrl.updateExpandedState()" class="appContent"><div ng-repeat="artifactList in ::$ctrl.artifactLists" class="appDetail"><app-artifacts-list view-model="artifactList" ng-if="!$ctrl.isEmptyList(artifactList)"></app-artifacts-list></div></div>'),e.put("components/appLogo/appLogo.html",'<section class="container {{::$ctrl.size}}" ng-switch="$ctrl.hasAppLogoImage()"><span ng-switch-when="true" class="imageLogo" ng-style="{\'background-image\': $ctrl.getAppLogoImageUrlStyle(), \'background-color\': $ctrl.viewModel.iconBackgroundColor}"></span><pbi-icon ng-switch-when="false" class="iconLogo" name="{{$ctrl.viewModel.icon}}" ng-style="{\'color\': $ctrl.viewModel.iconColor, \'background-color\': $ctrl.viewModel.iconBackgroundColor}" size="{{::$ctrl.size}}"></pbi-icon></section>'),e.put("components/appPlaceholder/appPlaceholder.html","<loading-watermark></loading-watermark>"),e.put("components/appsContainer/appsContainer.html",'<div class="mainContent"><insufficient-license-bar ng-if="::!$ctrl.hasSufficientLicense()" config="::$ctrl.insufficientLicenseBarConfig"></insufficient-license-bar><div class="dashboardControls"><search-box should-focus="true" on-change="$ctrl.onSearchTextChange()" on-blur="$ctrl.resolveSearchTelemetry()" filter="$ctrl.searchText" placeholder="SearchContent"></search-box></div><div class="dashboardSliderMain" feature-switch-class="breadcrumbNavigationEnabled" ng-class="::{hasTopBar: !$ctrl.hasSufficientLicense()}"><pbi-data-loader-spinner class="centered" ng-if="!$ctrl.isLoaded"></pbi-data-loader-spinner><water-mark-message ng-if="$ctrl.showWatermarkConfig" config="$ctrl.watermarkConfig"></water-mark-message><div class="galleryContainer appsGallery" feature-switch-class="breadcrumbNavigationEnabled" ng-if="::$ctrl.isLoaded"><content-tile-container tiles="$ctrl.filteredProviders" place-holder-tile="::$ctrl.getAppTile" disable-lazy-loading="true" collapsible-pane-mode="false" ng-if="!$ctrl.showWatermarkConfig"></content-tile-container></div></div></div>'),e.put("components/breadcrumbs/breadcrumb.html",'<pbi-icon ng-if="::breadcrumb.beforeIcon && !breadcrumb.group" name="{{::breadcrumb.beforeIcon}}" size="{{::breadcrumb.beforeIconSize}}" class="breadcrumbBeforeIcon"></pbi-icon><group-icon ng-if="::breadcrumb.entity && breadcrumb.entity.aadGroupId && !breadcrumb.icon" group="breadcrumb.entity" placeholder-size="small"></group-icon><span ng-bind="breadcrumb.label"></span><pbi-icon ng-if="::breadcrumb.afterIcon && !breadcrumb.group" name="{{::breadcrumb.afterIcon}}" size="{{::breadcrumb.afterIconSize}}" class="breadcrumbAfterIcon"></pbi-icon><pbi-icon class="capacity" name="diamond" size="small" ng-if="breadcrumb.entity.capacity" tooltip tooltip-config="{tooltipLocalizeDescription: \'Capacity_Icon_Tooltop\', tooltipArrowPosition: 1}"></pbi-icon>'),e.put("components/breadcrumbs/breadcrumbLabel.html",'<span class="breadcrumb" tooltip tooltip-config="breadcrumb.tooltipConfig"><ng-include src="::\'components/breadcrumbs/breadcrumb.html\'"></ng-include></span>'),e.put("components/breadcrumbs/breadcrumbLink.html",'<a class="breadcrumb" ui-sref="{{::breadcrumb.uiSref}}" ui-sref-opts="{{::breadcrumb.stateOptions}}" tooltip tooltip-config="breadcrumb.tooltipTemplateConfig" ng-click="$ctrl.logTelemetry(breadcrumb.state)"><ng-include src="::\'components/breadcrumbs/breadcrumb.html\'"></ng-include></a>'),e.put("components/breadcrumbs/breadcrumbs.html",'<pbi-icon ng-repeat-start="breadcrumb in $ctrl.breadcrumbs | filter: $ctrl.breadcrumbFilter" ng-if="!$first" name="chevronrightmedium" size="mini"></pbi-icon><ng-include class="{{::breadcrumb.customClass}}" src="$ctrl.getTemplate(breadcrumb, $last)"></ng-include><data-classification-label ng-repeat-end ng-if="::breadcrumb.entity && (breadcrumb.entity.dataClassificationId || breadcrumb.entity.dataClassificationId === 0)" data-classification-id="::breadcrumb.entity.dataClassificationId"></data-classification-label>'),e.put("components/contentDatasetActions/contentDatasetActions.html",'<section class="datacell optionsCell" ng-class="{\'publishing\': $ctrl.isPackagePublishInProgress($ctrl.viewModel.contract.packagePublishStatus)}"><section ng-if="::!$ctrl.streamingDataset"> <button class="createReport pbi-glyph-create-report" localize-tooltip="DashboardContextMenu_CreateReport" ng-if="::$ctrl.canCreateReport($ctrl.viewModel)" ng-click="$ctrl.createReport($ctrl.viewModel)"></button> <button class="refreshNow pbi-glyph-refresh" localize-tooltip="ContentTileOptions_RefreshNow" ng-if="::$ctrl.canRefreshNow($ctrl.viewModel)" ng-click="$ctrl.refreshNow($ctrl.viewModel.contract)"></button> <button class="scheduleRefresh pbi-glyph-refresh-data" localize-tooltip="ContentTileOptions_ScheduleRefresh" ng-if="::$ctrl.canScheduleRefresh($ctrl.viewModel)" ng-click="$ctrl.refreshSchedule($ctrl.viewModel.contract)"></button> <button class="viewRelated pbi-glyph-link" localize-tooltip="DashboardAppBar_ViewRelated" ng-if="::$ctrl.viewRelatedEnabled" ng-click="$ctrl.viewRelatedContent()"></button> <button class="moreButton pbi-glyph-more" ng-click="$ctrl.showOptions($ctrl.viewModel); $event.stopPropagation();" dropdown-overlay-invoke="{{::$ctrl.rowId}}" prefer-left="true" need-blur="true" disable-animation="true" localize-tooltip="Options_Menu"></button></section><section ng-if="::$ctrl.streamingDataset" class="actionContents"> <button class="glyphicon glyph-small actionIcon {{::action.iconClass}}" ng-repeat="action in $ctrl.getStreamingDatasetActions($ctrl.viewModel) track by action.action" ng-click="$ctrl.streamingDatasetActionSelected($ctrl.viewModel, action)" ng-attr-title="{{::action.text}}"></button></section><dropdown-overlay ng-if="$ctrl.menuSelected" dropdown-overlay-name="{{::$ctrl.rowId}}"><ul class="angular-dropdown active datasetActionList"><li ng-repeat="item in $ctrl.datasetMenuActions" class="dropdown-item" ng-mousedown="$ctrl.datasetMenuActionSelected(item); $event.stopPropagation();"><a href="" target="_blank"><div class="dropdown-content"><div class="dropdown-label" ng-bind="::item.text"></div></div></a></li></ul></dropdown-overlay></section>'),e.put("components/contentHeader/contentHeader.html",'<section ng-switch="$ctrl.tabType"><section class="unselectable" ng-switch-when="0"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="owner" localize="ContentHeader_Owner"></header><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification" localize="ContentHeader_Classification"></header></section><section class="unselectable" ng-switch-when="2"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="owner" localize="ContentHeader_Owner"></header></section><section class="unselectable" ng-switch-when="4"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="owner" localize="ContentHeader_Owner"></header></section><section class="unselectable" ng-switch-when="8"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="lastRefresh" localize="ContentHeader_LastRefresh"></header><header class="nextRefresh" localize="ContentHeader_NextRefresh"></header><header class="apiAccess" localize="ContentHeader_ApiAccess"></header></section><section class="unselectable" ng-switch-when="16"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="lastAccess" localize="ContentHeader_LastAccess"></header><header class="location" localize="ContentHeader_Location"></header><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification" localize="ContentHeader_Classification"></header></section><section class="unselectable" ng-switch-when="64"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="sharedTime" localize="ContentHeader_SharedTime"></header><header class="owner" localize="ContentHeader_Owner"></header><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification" localize="ContentHeader_Classification"></header></section><section class="unselectable" ng-switch-when="128"><header class="name" localize="ContentHeader_Name"></header><header class="actions" localize="ContentHeader_Actions"></header><header class="location" localize="ContentHeader_Owner"></header><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification" localize="ContentHeader_Classification"></header></section></section>'),
e.put("components/contentListContainerV2/contentListContainerV2.html",'<div class="contentListView" ng-class="{\'initializing\': !$ctrl.initialized, \'onlySharedWithMe\': $ctrl.isOnlySharedWithMe()}"><introduce-app-bar ng-if="$ctrl.shouldDisplayIntroduceAppBar" config="::$ctrl.introduceAppBarConfig"></introduce-app-bar><div class="header"><div class="dashboardAppBar"><div ng-hide="$ctrl.groupService.activeGroup.isMyWorkspace || $ctrl.groupService.isInGroupTransition"><group-actions group="$ctrl.groupService.activeGroup" dropdown-orientation="vertical" allow-unpublish-app="true" unpublish-app-in-progress="$ctrl.unpublishAppInProgress"></group-actions><pbi-button ng-if="$ctrl.isAppsEnabled() && !$ctrl.isActiveWorkspaceReadOnly" class="publishAppBtn appBarBtn" primary="true" localize-tooltip="CreateApp_Publish" label="CreateApp_Publish" icon-name="my-apps" ng-click="$ctrl.addChannel()" ng-disabled="$ctrl.unpublishAppInProgress"></pbi-button></div> <button ng-if="!$ctrl.isActiveWorkspaceReadOnly" dropdown-overlay-invoke="CreateContentListItem" preferLeft="true" needBlur="true" class="createButton dropDownBtn appBarBtn"><pbi-icon name="add" size="small"></pbi-icon><span class="label" localize="Create_ButtonText"></span></button><dropdown-overlay dropdown-overlay-name="CreateContentListItem" class="overlayTopBar"><dropdown-list class="topBar contentListViewDropdown"><dropdown-list-item ng-click="$ctrl.addDashboard()" localize="ContentList_Dashboard"></dropdown-list-item><dropdown-list-item ng-click="$ctrl.addReport()" localize="ContentList_Report"></dropdown-list-item><dropdown-list-item ui-sref="landing.groups.group.getData" localize="ContentList_Dataset"></dropdown-list-item><dropdown-list-item ng-click="$ctrl.showStreamingDatasetGalleryPane()" localize="ContentList_StreamingDataset"></dropdown-list-item></dropdown-list></dropdown-overlay></div></div><div class="dashboardControls"><search-box should-focus="::true" on-change="$ctrl.onSearchTextChange()" on-blur="$ctrl.resolveSearchTelemetry()" filter="$ctrl.searchText" placeholder="SearchContent"></search-box></div><div class="contentListOptionsTabs unselectable"><div class="left"><div class="optionTab dashboard label-med" ng-class="{selected: $ctrl.activeTab === 0}" ng-click="$ctrl.setActiveTab(0)" localize="ContentList_Dashboards"></div><div class="optionTab report label-med" ng-class="{selected: $ctrl.activeTab === 2}" ng-click="$ctrl.setActiveTab(2)" localize="ContentList_Reports"></div><div class="optionTab workbook label-med" ng-class="{selected: $ctrl.activeTab === 4}" ng-click="$ctrl.setActiveTab(4)" localize="ContentList_Workbooks"></div><div class="optionTab dataset label-med" ng-if="$ctrl.canManageDatasets" ng-class="{selected: $ctrl.activeTab === 8}" ng-click="$ctrl.setActiveTab(8)" localize="ContentList_Datasets"></div></div><div class="right"><span class="count" localize="ShowingXItems" localize-fragments><span fragment-index="0" ng-bind="$ctrl.getNumberOfShownTabItems()"></span></span><select-tile-sort selected-predicate="$ctrl.sortPredicate" on-select="$ctrl.selectSort" predicates="$ctrl.sortPredicates"></select-tile-sort></div></div><div class="dashboardSliderMain" ng-class="{hasIntroduceAppBar: $ctrl.shouldDisplayIntroduceAppBar}"><spinner ng-show="$ctrl.showSpinner" class="large centered"></spinner><water-mark-message config="$ctrl.getWatermarkConfig()" ng-show="$ctrl.getWatermarkConfig()"></water-mark-message><content-list-gallery view-model="::$ctrl.galleryViewModel" is-data-classification-enabled="$ctrl.dataClassificationEnabled"></content-list-gallery></div></div>'),e.put("components/contentListGallery/contentListGallery.html",'<div class="galleryContainer" ng-class="$ctrl.galleryContainerStyle"><content-header class="contentHeaderSection" tab-type="$ctrl.viewModel.tabType" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled"></content-header><content-row-container tab-type="$ctrl.viewModel.tabType" tiles="$ctrl.viewModel.getTiles()" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled" collapsible-pane-mode="$ctrl.viewModel.collapsiblePaneMode" finish-load-event="{{::$ctrl.viewModel.finishLoadEvent}}"></content-row-container></div>'),e.put("components/contentRow/contentRow.html",'<section class="galleryItem" ng-switch="::$ctrl.tabType" ng-class="{selected: $ctrl.viewModel.isContentTileSelected, publishing: $ctrl.publishInProgress()}" data-id="{{::$ctrl.viewModel.id}}" data-name="{{::$ctrl.viewModel.displayName}}"><section class="galleryItemContainer" ng-switch-when="0"><section class="nameDetails"><span class="tileTypeIndicator glyphicon pbi-glyph-gauge glyph-small" localize-tooltip="Artifact_Dashboard"></span><header class="favoriteIndicator"><span ng-if="$ctrl.canFavorite()" class="favoriteBtn pbi-glyph-favoritestar" localize-tooltip="Artifact_Favorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.favoriteContentTile()"></span><span ng-if="$ctrl.canUnFavorite()" class="unfavoriteBtn powervisuals-glyph star-full" localize-tooltip="Artifact_Favorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.unfavoriteContentTile()"></span></header><header class="galleryItemTitle trimmedTextWithEllipsis" title="{{$ctrl.viewModel.displayName}}" ng-click="$ctrl.openContentTile()"><span ng-bind="$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.isNew()" name="asterisk" size="mini"></pbi-icon></header><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="false"></dataset-icon-container></section><content-tile-options-menu class="tileOptions unselectable" ng-class="{readOnly: !$ctrl.canShowOptionsMenu()}" view-model="::$ctrl.viewModel" in-list-view="true"></content-tile-options-menu><header class="authorName trimmedTextWithEllipsis" ng-bind="::$ctrl.getOwnerNameOrMailForDashboard()" title="{{::$ctrl.getOwnerNameOrMailForDashboard()}}"></header><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification unselectable"><data-classification-label data-classification-id="$ctrl.viewModel.dataClassificationId"></data-classification-label></header></section><section class="galleryItemContainer" ng-switch-when="2"><section class="nameDetails"><span class="tileTypeIndicator glyphicon pbi-glyph-barchart glyph-small" localize-tooltip="Artifact_Report"></span><header class="galleryItemTitle trimmedTextWithEllipsis" ng-click="$ctrl.openContentTile()"><span ng-bind="$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.isNew()" name="asterisk" size="mini"></pbi-icon></header><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="false"></dataset-icon-container></section><content-tile-options-menu class="tileOptions unselectable" ng-class="{readOnly: !$ctrl.canShowOptionsMenu()}" view-model="::$ctrl.viewModel" in-list-view="true"></content-tile-options-menu><header class="authorName trimmedTextWithEllipsis" ng-bind="::$ctrl.viewModel.ownerFullname" title="{{::$ctrl.viewModel.ownerFullname}}"></header></section><section class="galleryItemContainer" ng-switch-when="4"><section class="nameDetails"><span class="tileTypeIndicator glyphicon pbi-glyph-excel glyph-small" localize-tooltip="Artifact_Workbook"></span><header class="galleryItemTitle trimmedTextWithEllipsis" title="{{$ctrl.viewModel.displayName}}" ng-click="$ctrl.openContentTile()"><span ng-bind="$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.isNew()" name="asterisk" size="mini"></pbi-icon></header><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="false"></dataset-icon-container><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="true"></dataset-icon-container></section><content-tile-options-menu class="tileOptions unselectable" ng-class="{readOnly: !$ctrl.canShowOptionsMenu()}" view-model="::$ctrl.viewModel" in-list-view="true"></content-tile-options-menu><header class="authorName trimmedTextWithEllipsis" ng-bind="::$ctrl.viewModel.ownerFullname" title="{{::$ctrl.viewModel.ownerFullname}}"></header></section><section class="galleryItemContainer" ng-switch-when="8"><section class="nameDetails"><span class="tileTypeIndicator glyphicon pbi-glyph-database glyph-small" localize-tooltip="Artifact_Dataset"></span><header class="galleryItemTitle trimmedTextWithEllipsis" title="{{$ctrl.viewModel.displayName}}" ng-click="$ctrl.openContentTile()"><span ng-bind="$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.isNew()" name="asterisk" size="mini"></pbi-icon></header><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="false"></dataset-icon-container></section><header class="tileOptions unselectable"><content-dataset-actions view-model="::$ctrl.viewModel" can-show-new="::false" streaming-dataset="$ctrl.streamingDataset"></content-dataset-actions></header><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="true"></dataset-icon-container><header class="lastRefresh trimmedTextWithEllipsis" ng-bind="$ctrl.convertRefreshTimeToJsDateTime($ctrl.viewModel.contract.lastRefreshTime) | date:\'h:mm a MM.dd.yyyy\'"></header><header class="nextRefresh trimmedTextWithEllipsis" ng-bind="$ctrl.convertRefreshTimeToJsDateTime($ctrl.viewModel.contract.nextRefreshTime) | date:\'h:mm a MM.dd.yyyy\'"></header><header class="apiAccess trimmedTextWithEllipsis" ng-bind="::$ctrl.apiAccessType" title="{{::$ctrl.apiAccessType}}"></header></section><section class="galleryItemContainer" ng-switch-when="16" ng-init="$ctrl.initializeMruRow()"><section class="nameDetails" ng-switch="::$ctrl.getActualContentType()"><span class="tileTypeIndicator glyphicon pbi-glyph-barchart glyph-small" localize-tooltip="Artifact_Report" ng-switch-when="2"></span><span class="tileTypeIndicator glyphicon pbi-glyph-gauge glyph-small" localize-tooltip="Artifact_Dashboard" ng-switch-when="4"></span><span class="tileTypeIndicator glyphicon pbi-glyph-excel glyph-small" localize-tooltip="Artifact_Workbook" ng-switch-when="8"></span><span class="tileTypeIndicator glyphicon pbi-glyph-my-apps glyph-small" localize-tooltip="Artifact_InstalledApp" ng-switch-when="16"></span><header class="favoriteIndicator" ng-if="$ctrl.isItemAvailable"><span ng-if="$ctrl.canFavorite()" class="favoriteBtn pbi-glyph-favoritestar" localize-tooltip="Artifact_Favorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.favoriteContentTile()"></span><span ng-if="$ctrl.canUnFavorite()" class="unfavoriteBtn powervisuals-glyph star-full" localize-tooltip="ContentListMenu_RemoveFavorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.unfavoriteContentTile()"></span></header> <button class="galleryItemTitle trimmedTextWithEllipsis" title="{{::$ctrl.viewModel.displayName}}" ng-click="$ctrl.openContentTile()" ng-class="{\'notAvailable\': !$ctrl.isItemAvailable}"><span ng-bind="$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.isNew()" name="asterisk" size="mini"></pbi-icon><pbi-icon ng-if="::$ctrl.hasCapacity()" name="diamond" size="mini"></pbi-icon></button></section><header class="tileOptions unselectable" ng-class="{\'readOnly\': !$ctrl.isItemAvailable}"><content-tile-options-menu view-model="::$ctrl.getOriginalContentTileOrViewModel()" delete-enabled="false" in-list-view="true"></content-tile-options-menu></header><header class="lastAccess trimmedTextWithEllipsis" ng-bind="::$ctrl.getPrettyDate($ctrl.viewModel.lastAccess)"></header> <button class="location" ng-click="$ctrl.navigateToGroup()"><header class="locationName trimmedTextWithEllipsis" title="{{::$ctrl.groupName}}" ng-bind="::$ctrl.groupName"></header></button><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification unselectable"><data-classification-label data-classification-id="$ctrl.viewModel.dataClassificationId"></data-classification-label></header></section><section class="galleryItemContainer" ng-switch-when="64"><section class="nameDetails"><span class="tileTypeIndicator glyphicon pbi-glyph-gauge glyph-small" localize-tooltip="Artifact_Dashboard"></span><header class="favoriteIndicator"><span ng-if="$ctrl.canFavorite()" class="favoriteBtn pbi-glyph-favoritestar" localize-tooltip="Artifact_Favorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.favoriteContentTile()"></span><span ng-if="$ctrl.canUnFavorite()" class="unfavoriteBtn powervisuals-glyph star-full" localize-tooltip="Artifact_Favorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.unfavoriteContentTile()"></span></header><header class="galleryItemTitle trimmedTextWithEllipsis" title="{{$ctrl.viewModel.displayName}}" ng-click="$ctrl.openContentTile()"><span ng-bind="$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.isNew()" name="asterisk" size="mini"></pbi-icon><pbi-icon ng-if="::$ctrl.hasCapacity()" name="diamond" size="mini"></pbi-icon></header><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="::false" refresh-related="false"></dataset-icon-container></section><content-tile-options-menu class="tileOptions unselectable" ng-class="{readOnly: !$ctrl.canShowOptionsMenu()}" view-model="::$ctrl.viewModel" in-list-view="true"></content-tile-options-menu><header class="sharedTime trimmedTextWithEllipsis" ng-bind="::$ctrl.getPrettySharedDate($ctrl.viewModel.sharedTime)"></header><section class="authorName"><header ng-if="$ctrl.getOwnerNameOrMailForDashboard()" class="trimmedTextWithEllipsis" ng-bind="::$ctrl.getOwnerNameOrMailForDashboard()" title="{{::$ctrl.getOwnerNameOrMailForDashboard()}}"></header><header ng-if="!$ctrl.getOwnerNameOrMailForDashboard()" localize="SharedWithMe_Owner_Loading" localize-tooltip="SharedWithMe_Owner_Loading"></header></section><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification unselectable"><data-classification-label data-classification-id="$ctrl.viewModel.dataClassificationId"></data-classification-label></header></section><section class="galleryItemContainer" ng-switch-when="128" ng-init="$ctrl.initializeFavoriteRow()"><section class="nameDetails" ng-switch="::$ctrl.getActualContentType()"><span class="tileTypeIndicator glyphicon pbi-glyph-gauge glyph-small" localize-tooltip="Artifact_Dashboard" ng-switch-when="4"></span><span class="tileTypeIndicator glyphicon pbi-glyph-my-apps glyph-small" localize-tooltip="Artifact_InstalledApp" ng-switch-when="16"></span><header class="favoriteIndicator"><span class="unfavoriteBtn powervisuals-glyph star-full" localize-tooltip="ContentListMenu_RemoveFavorite" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.unfavoriteContentTile()"></span></header> <button class="galleryItemTitle trimmedTextWithEllipsis" title="{{::$ctrl.viewModel.displayName}}" ng-click="$ctrl.openContentTile()"><span ng-bind="::$ctrl.viewModel.displayName"></span><pbi-icon ng-if="::$ctrl.hasCapacity()" name="diamond" size="mini"></pbi-icon><dataset-icon-container view-model="$ctrl.viewModel" refresh-related="false"></dataset-icon-container></button></section><header class="tileOptions unselectable favoriteOptions"><content-tile-options-menu view-model="::$ctrl.viewModel" in-list-view="true"></content-tile-options-menu></header><header class="location"><span class="locationName trimmedTextWithEllipsis" bind-text-and-tooltip="$ctrl.viewModel.ownerInfo"></span></header><header ng-if="::$ctrl.isDataClassificationEnabled" class="classification unselectable"><data-classification-label data-classification-id="::$ctrl.viewModel.dataClassificationId"></data-classification-label></header></section></section>'),e.put("components/contentRowContainer/contentRowContainer.html",'<div ng-switch="$ctrl.tabType" class="contentScrollSectionContainer"><div ng-switch-when="0" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles() track by tile.id" view-model="tile" tab-type="::$ctrl.tabType" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div><div ng-switch-when="2" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles() track by tile.uniqueId" view-model="tile" tab-type="::$ctrl.tabType" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div><div ng-switch-when="4" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles() track by tile.uniqueId" view-model="tile" tab-type="::$ctrl.tabType" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div><div ng-switch-when="8" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles() track by tile.id" view-model="tile" tab-type="::$ctrl.tabType" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div><div ng-switch-when="16" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles()" view-model="tile" tab-type="::$ctrl.tabType" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div><div ng-switch-when="64" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles() track by tile.id" view-model="tile" tab-type="::$ctrl.tabType" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div><div ng-switch-when="128" class="contentScrollSection" vs-repeat ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><content-row ng-repeat="tile in $ctrl.getTiles() track by tile.uniqueId" view-model="tile" tab-type="::$ctrl.tabType" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled" disable-lazy-loading="::$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-row></div></div>'),e.put("components/contentTile/contentTile.html",'<li class="galleryItem unselectable" ng-class="{\'selected\': $ctrl.viewModel.isContentTileSelected, \'publishing\':$ctrl.publishInProgress()}" data-id="{{::$ctrl.viewModel.id}}" data-content-tile-type="{{$ctrl.getTileTypeName()}}" data-name="{{::$ctrl.viewModel.displayName}}" in-viewport="$ctrl.onceInViewport()" in-viewport-context=".dashboardSliderMain" in-viewport-offset="150%"><div class="galleryTileContainer" ng-switch="$ctrl.viewModel.contentTileType" ng-click="$ctrl.openContentTile()"><div class="backgroundAndContent" ng-switch-when="1" ng-init="$ctrl.viewModel.workspaceId ? $ctrl.setGroupIcon($ctrl.viewModel.workspaceId) : $ctrl.setUserPhoto()"><div class="galleryBackground" ng-switch="$ctrl.viewModel.favoriteType"><div class="dashboardFavorite" ng-switch-when="1"><i class="glyphicon dashboardWatermarkIcon pbi-glyph-gauge glyph-large"></i><div class="galleryIcons"><i class="glyphicon pbi-glyph-gauge glyph-med" title="{{::$ctrl.dashboardTitle}}"></i></div></div><div class="reportFavorite" ng-switch-when="2"><i class="glyphicon reportWatermarkIcon pbi-glyph-barchart glyph-large"></i><div class="galleryIcons"><i class="glyphicon pbi-glyph-barchart glyph-large"></i></div></div></div><div class="iconsContainer"><div ng-if="!$ctrl.isMyWorkspace" class="owner" ng-switch="$ctrl.hasGroupIconSet" title="{{::$ctrl.groupName}}"><i ng-switch-when="false" class="glyphicon pbi-glyph-group glyph-med groupIcon placeholder"></i> <img class="groupIcon" ng-switch-when="true" ng-src="{{$ctrl.groupIcon}}"/></div><div ng-if="$ctrl.isMyWorkspace" ng-switch="$ctrl.hasUserIconSet" title="{{::$ctrl.groupName}}"><i ng-switch-when="false" class="glyphicon pbi-glyph-user glyph-med groupIcon placeholder"></i><div ng-switch-when="true" class="userIcon" ng-style="{\'background-image\': $ctrl.userIcon}"/></div><data-classification-label data-classification-id="$ctrl.viewModel.dataClassificationId"></data-classification-label></div><div class="content"><div class="titleAndIndicator"><dataset-icon-container view-model="$ctrl.viewModel" refresh-related="false"></dataset-icon-container><div class="galleryItemTitle trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName" ng-attr-title="{{$ctrl.viewModel.displayName}}"/></div><div class="authorNameFavorite trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.ownerInfo" ng-attr-title="{{$ctrl.viewModel.ownerInfo}}"/></div></div><div class="backgroundAndContent" ng-switch-when="4"><div class="galleryBackground" ng-init="$ctrl.setOwnerPhoto()"><i class="glyphicon dashboardWatermarkIcon pbi-glyph-gauge glyph-large"></i><div class="galleryIcons"><i class="glyphicon pbi-glyph-gauge glyph-large"></i></div></div><div class="iconsContainer"><div ng-if="$ctrl.hasOwnerPhoto && $ctrl.inViewport" ng-switch="$ctrl.hasOwnerPhotoSet"><i ng-switch-when="false" class="glyphicon pbi-glyph-user glyph-med groupIcon placeholder"></i> <img ng-switch-when="true" class="userIcon" ng-src="{{$ctrl.ownerIcon}}"/></div><data-classification-label ng-if="$ctrl.inViewport" data-classification-id="$ctrl.viewModel.dataClassificationId"></data-classification-label></div><div class="content"><div class="titleAndIndicator"><dataset-icon-container ng-if="$ctrl.inViewport" view-model="$ctrl.viewModel" refresh-related="false"></dataset-icon-container><div class="galleryItemTitle trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName" ng-attr-title="{{$ctrl.viewModel.displayName}}"/></div><div class="authorName trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.ownerFullname" ng-attr-title="{{$ctrl.viewModel.ownerFullname}}"/></div></div><div class="backgroundAndContent" ng-switch-when="2"><div class="galleryBackground"><i class="glyphicon reportWatermarkIcon pbi-glyph-barchart glyph-large"></i><div class="galleryIcons"><i class="glyphicon pbi-glyph-barchart glyph-large"></i></div></div><div class="content"><div class="titleAndIndicator"><dataset-icon-container ng-if="$ctrl.inViewport" view-model="$ctrl.viewModel" refresh-related="false"></dataset-icon-container><div class="galleryItemTitle trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName" ng-attr-title="{{$ctrl.viewModel.displayName}}"/></div><div class="authorName trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.ownerFullname" ng-attr-title="{{$ctrl.viewModel.ownerFullname}}"/></div></div><div class="backgroundAndContent" ng-switch-when="8"><div class="galleryBackground"><i class="glyphicon workbookWatermarkIcon pbi-glyph-excel glyph-large"></i><div class="galleryIcons"><i class="glyphicon pbi-glyph-excel glyph-large"></i></div></div><div class="content"><div class="titleAndIndicator"><dataset-icon-container ng-if="$ctrl.inViewport" view-model="$ctrl.viewModel" refresh-related="false"></dataset-icon-container><dataset-icon-container ng-if="$ctrl.inViewport" view-model="$ctrl.viewModel" refresh-related="true"></dataset-icon-container><div class="galleryItemTitle trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName" ng-attr-title="{{$ctrl.viewModel.displayName}}"/></div><div class="authorName trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.ownerFullname" ng-attr-title="{{$ctrl.viewModel.ownerFullname}}"/></div></div><div class="backgroundAndContent" ng-switch-when="16"><section class="galleryBackground"><app-logo view-model="::$ctrl.viewModel" size="large"></app-logo></section><section class="titleAndIndicator"><pbi-icon ng-if="::$ctrl.hasCapacity()" name="diamond" size="small" tooltip tooltip-config="{tooltipLocalizeDescription: \'Capacity_Icon_Tooltop\', tooltipArrowPosition: 1}"></pbi-icon><h1 class="trimmedTextWithEllipsis unselectable" bind-text-and-tooltip="::$ctrl.viewModel.displayName"/><h2 class="trimmedTextWithEllipsis unselectable" bind-text-and-tooltip="::$ctrl.viewModel.displayDate | date:\'MMM dd, yyyy\'"/></section><section class="appActions"><header class="trimmedTextWithEllipsis" bind-text-and-tooltip="::$ctrl.viewModel.author"/><content-tile-options-menu view-model="::$ctrl.viewModel"></content-tile-options-menu></section></div><div class="backgroundAndContent placeHolderBorder" ng-switch-when="1024"><section class="placeHolderGalleryBackground"><pbi-icon class="addApp" name="my-apps" size="large"></pbi-icon></section><h1 class="placeHolderTitle" bind-text-and-tooltip="::$ctrl.viewModel.displayName"></h1></div><div class="backgroundAndContent" ng-switch-when="256"><div class="galleryBackground"><group-icon group="::$ctrl.viewModel" placeholder-size="large"></group-icon></div><section class="titleAndIndicator"><h1 class="trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName"/><h2 class="trimmedTextWithEllipsis unselectable" ng-bind="::$ctrl.getOwnershipTextForWorkspace()"/></section><section class="contentDetails" ng-if="!$ctrl.isTileActionsVisible"><h1 class="trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName" title="{{$ctrl.viewModel.displayName}}"/><h2 class="trimmedTextWithEllipsis unselectable" ng-bind="::$ctrl.getOwnershipTextForWorkspace()"/><h3 class="trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.getGroupTypeTextForWorkspace()"/><h3 class="trimmedTextWithEllipsis unselectable" ng-if="::$ctrl.viewModel.contract.isReadOnly" localize="ContentList_Workspaces_ReadOnly"/><pbi-icon class="upperRight" ng-click="$ctrl.toggleTileActionsVisibility($event)" name="more" size="small"></pbi-icon></section><section class="contentActions" ng-if="$ctrl.isTileActionsVisible"><h1 class="trimmedTextWithEllipsis unselectable" ng-bind="$ctrl.viewModel.displayName" title="{{$ctrl.viewModel.displayName}}"/><div class="actions"><content-tile-options-menu view-model="::$ctrl.viewModel"></content-tile-options-menu></div><pbi-icon class="upperRight" ng-click="$ctrl.toggleTileActionsVisibility($event)" name="close" size="mini"></pbi-icon></section></div><div class="tileOptions trimmedTextWithEllipsis unselectable" ng-if="$ctrl.viewModel.contentTileType !== 16 && $ctrl.viewModel.contentTileType !== 256 && $ctrl.inViewport" ng-class="{\'readOnly\': !$ctrl.canShowOptionsMenu()}"><content-tile-options-menu view-model="$ctrl.viewModel"></content-tile-options-menu></div></div></li>'),e.put("components/contentTileContainer/contentTileContainer.html",'<div class="contentSection" ng-class="{isContentTileContentDisabled: $ctrl.collapsiblePaneMode !== 0}"><div class="mainContentHeader"><div class="galleryTitle" ng-transclude="title"></div></div> <button class="addButton" ng-click="$ctrl.activeAddDashboard()" localize-tooltip="NavigationPane_CreateDashboard" ng-show="$ctrl.showAddDashboardBtn"><i class="glyphicon pbi-glyph-add"></i></button><div class="contentScrollSection"><ul class="galleryList noselect"><content-tile ng-repeat="tile in $ctrl.getTiles()" view-model="tile" disable-lazy-loading="$ctrl.disableLazyLoading" ng-repeat-finish-event="{{::$ctrl.finishLoadEvent}}"></content-tile><content-tile ng-if="::$ctrl.placeHolderTile" disable-lazy-loading="false" view-model="::$ctrl.placeHolderTile"></content-tile></ul></div></div>'),e.put("components/contentTileOptionsMenu/contentTileOptionsMenu.html",'<section ng-switch="$ctrl.tileType" ng-init="$ctrl.canShare($ctrl.viewModel, $ctrl.tileType)"><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="1"><div class="shareBtn pbi-glyph-share" localize-tooltip="ContentListMenu_Share" ng-if="::$ctrl.canShareTile" ng-click="$ctrl.shareContentTile($ctrl.viewModel, $ctrl.tileType)"></div></section><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="2"><div class="actionIcon usageMetricsReportBtn pbi-glyph-chart" localize-tooltip="ContentTileOptions_UsageMetricsReport" ng-if="::$ctrl.canOpenUsageMetricsReport($ctrl.tileType)" ng-click="$ctrl.openUsageMetricsReport($ctrl.tileType)"></div><div class="actionIcon personalizeBtn pbi-glyph-contentviewicon" localize-tooltip="ContentTileOptions_Personalize" ng-if="::$ctrl.canPersonalize()" ng-click="$ctrl.personalize()"></div><div class="actionIcon analyzeInExcel pbi-glyph-excel" localize-tooltip="ContentTileOptions_AnalyzeInExcel" ng-if="::$ctrl.canAnalyzeInExcel()" ng-click="$ctrl.analyzeInExcel()"></div><div class="actionIcon insightsBtn pbi-glyph-insight" localize-tooltip="ContentTileOptions_GetInsights" ng-if="::$ctrl.canRunInsights()" ng-click="$ctrl.runInsights()"></div><div class="actionIcon viewRelatedContentBtn pbi-glyph-link" localize-tooltip="DashboardAppBar_ViewRelated" ng-if="::$ctrl.viewRelated" ng-click="$ctrl.viewRelatedContent()"></div><div class="actionIcon powerPointBtn pbi-glyph-powerpoint" localize-tooltip="ContentTileOptions_ExportPowerPoint" ng-if="::$ctrl.canExportPowerPoint($ctrl.tileType)" ng-click="$ctrl.exportToPowerPoint($ctrl.tileType)"></div><div class="actionIcon renameBtn pbi-glyph-settings" title="{{::$ctrl.tooltipForSettings($ctrl.tileType)}}" ng-if="::$ctrl.canRewrite($ctrl.viewModel.getPermissions())" ng-click="$ctrl.contentTileRename($ctrl.tileType)"></div><div class="actionIcon removeBtn pbi-glyph-delete" localize-tooltip="ContentTileOptions_Delete" ng-if="::$ctrl.deleteEnabled" ng-click="$ctrl.deleteContentTile($ctrl.tileType)"></div></section><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="4"><div class="actionIcon usageMetricsReportBtn pbi-glyph-chart" localize-tooltip="ContentTileOptions_UsageMetricsReport" ng-if="::$ctrl.canOpenUsageMetricsReport($ctrl.tileType)" ng-click="$ctrl.openUsageMetricsReport($ctrl.tileType)"></div><div class="actionIcon personalizeBtn pbi-glyph-contentviewicon" localize-tooltip="ContentTileOptions_Personalize" ng-if="::$ctrl.canPersonalize()" ng-click="$ctrl.personalize()"></div><div class="actionIcon shareBtn pbi-glyph-share" localize-tooltip="ContentListMenu_Share" ng-if="::$ctrl.canShareTile" ng-click="$ctrl.shareContentTile($ctrl.viewModel, $ctrl.tileType)"></div><div class="actionIcon exportBtn pbi-glyph-export" ng-if="::$ctrl.isExportAllowed($ctrl.tileType)" ng-click="$ctrl.exportDashboard()"></div><div class="actionIcon viewRelatedContentBtn pbi-glyph-link" localize-tooltip="DashboardAppBar_ViewRelated" ng-if="::$ctrl.viewRelated" ng-click="$ctrl.viewRelatedContent()"></div><div class="actionIcon dashboardfavoriteBtn pbi-glyph-favoritestar" localize-tooltip="Artifact_Favorite" ng-if="$ctrl.canFavorite()" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.favoriteContentTile($ctrl.tileType)"></div><div class="actionIcon dashboardUnfavoriteBtn powervisuals-glyph star-full" localize-tooltip="ContentListMenu_RemoveFavorite" ng-if="$ctrl.canUnFavorite()" ng-disabled="$ctrl.isFavoriteDisabled()" ng-click="$ctrl.unfavoriteContentTile($ctrl.tileType)"></div><div class="actionIcon renameBtn pbi-glyph-settings" title="{{::$ctrl.tooltipForSettings($ctrl.tileType)}}" ng-if="::$ctrl.canRewrite($ctrl.viewModel.getPermissions())" ng-click="$ctrl.contentTileRename($ctrl.tileType)"></div><div class="actionIcon removeBtn pbi-glyph-delete" localize-tooltip="ContentTileOptions_Delete" ng-if="::$ctrl.deleteEnabled" ng-click="$ctrl.deleteContentTile($ctrl.tileType)"></div></section><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="8"><div class="actionIcon personalizeBtn pbi-glyph-contentviewicon" localize-tooltip="ContentTileOptions_Personalize" ng-if="::$ctrl.canPersonalize()" ng-click="$ctrl.personalize()"></div><div class="actionIcon refreshNow pbi-glyph-refresh" localize-tooltip="ContentTileOptions_RefreshNow" ng-if="::$ctrl.canRefreshNow()" ng-click="$ctrl.refreshNow()"></div><div class="actionIcon scheduleRefresh pbi-glyph-refresh-data" localize-tooltip="ContentTileOptions_ScheduleRefresh" ng-if="::$ctrl.canScheduleRefresh()" ng-click="$ctrl.scheduleRefresh()"></div><div class="actionIcon editWorkbookBtn pbi-glyph-edit" localize-tooltip="ContentTileOptions_EditWorkbooks" ng-if="::$ctrl.canEditWorkbook($ctrl.tileType)" ng-click="$ctrl.editWorkbook($ctrl.tileType)"></div><div class="actionIcon replaceWorkbookBtn pbi-glyph-getdata" localize-tooltip="ContentTileOptions_ReplaceWorkbooks" ng-if="::$ctrl.canReplaceWorkbook($ctrl.tileType)" ng-click="$ctrl.replaceWorkbook($ctrl.tileType)"></div><div class="actionIcon renameBtn pbi-glyph-settings" title="{{::$ctrl.tooltipForSettings($ctrl.tileType)}}" ng-if="::$ctrl.canRewrite($ctrl.viewModel.getPermissions())" ng-click="$ctrl.contentTileRename($ctrl.tileType)"></div><div class="actionIcon removeBtn pbi-glyph-delete" localize-tooltip="ContentTileOptions_Delete" ng-if="::$ctrl.deleteEnabled" ng-click="$ctrl.deleteContentTile($ctrl.tileType)"></div></section><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="16"><pbi-icon name="favoritestar" size="small" localize-tooltip="Artifact_Favorite" ng-if="$ctrl.canFavorite()" ng-click="$ctrl.favoriteContentTile()"></pbi-icon><pbi-icon name="favoritefilled" size="small" localize-tooltip="ContentListMenu_RemoveFavorite" ng-if="$ctrl.canUnFavorite()" ng-click="$ctrl.unfavoriteContentTile()"></pbi-icon><pbi-icon name="delete" size="small" localize-tooltip="Delete_ToolTip" ng-if="::$ctrl.deleteEnabled" ng-click="$ctrl.deleteContentTile($ctrl.tileType)"></pbi-icon></section><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="64"><pbi-icon class="actionIcon" name="excel" size="small" localize-tooltip="ContentTileOptions_AnalyzeInExcel" ng-if="::$ctrl.canAnalyzeInExcel()" ng-click="$ctrl.analyzeInExcel()"></pbi-icon><pbi-icon class="actionIcon" name="insight" size="small" localize-tooltip="ContentTileOptions_GetInsights" ng-if="::$ctrl.canRunInsights()" ng-click="$ctrl.runInsights()"></pbi-icon><pbi-icon class="actionIcon" name="refresh" size="small" localize-tooltip="ContentTileOptions_RefreshNow" ng-if="::$ctrl.canRefreshNow()" ng-click="$ctrl.refreshNow()"></pbi-icon><pbi-icon class="actionIcon" name="refresh-data" size="small" localize-tooltip="ContentTileOptions_ScheduleRefresh" ng-if="::$ctrl.canScheduleRefresh()" ng-click="$ctrl.scheduleRefresh()"></pbi-icon></section><section class="tileMenu" onclick="event.stopPropagation();" ng-switch-when="256"><pbi-icon ng-if="!$ctrl.viewModel.isMyWorkspace" ng-repeat="item in $ctrl.viewModel.metadata.contextMenuItemList" name="{{::$ctrl.getIconForGroupContextMenuItem(item)}}" size="small" title="{{::$ctrl.getTooltipForGroupContextMenuItem(item)}}" ng-click="$ctrl.onGroupContextMenuItemSelected(item)"></pbi-icon></section></section>'),
e.put("components/dashboardEditMobileDisplay/dashboardEditMobileDisplay.html",'<div class="dashboardModeView mobileAuthoring mobileLayout"><dashboard-pane view-model="$ctrl.viewModel.dashboardPane"></dashboard-pane><div class="simulatorWrapper"><section class="mobileAuthoringIntroduction"><span class="phoneAuthoringTitle" localize="Phone_Authoring_Dashboard_Title"></span><i class="centeredGlyph glyphicon pbi-glyph-info glyph-small icon"><span class="tooltipText" localize="Phone_Authoring_Dashboard_Description"></span></i></section><div class="authoringDashboardContainer"><div class="authoringDashboard"><div ng-if="$ctrl.pinnedTiles().length === 0" class="emptyStateLabel"><i class="circle glyphicon pbi-glyph-pinned glyph-reg"></i><div class="emptyStateTitle" localize="Authoring_Dashboard_Empty_State_Label"></div></div><div class="authoringDashboardTitleContainer"> <span class="label">{{$ctrl.viewModel.mobileDashboard.displayName}}</span></div><dashboard disable-tile-ease-in="true" view-model="$ctrl.viewModel.mobileDashboard" display-layout="1" disable-pointer-events="true" mobile-layout="1" in-edit-mobile-layout-mode="true"></dashboard></div></div></div></div>'),e.put("components/dashboardPane/dashboardPane.html",'<article class="dashboardPane sidePane smallFontSize" ng-class="{ isCollapsed: !$ctrl.viewModel.isPaneExpanded}"><div class="paneHeader"> <button class="toggleBtn" ng-class="{ isCollapsed: !$ctrl.viewModel.isPaneExpanded }" ng-click="$ctrl.toggle()" localize-tooltip="DashboardPane_Toggle"><i class="btnIcon glyphicon pbi-glyph-chevronrightmedium glyph-mini"></i><h2 class="sidePaneHorizontalTitle sidePaneTitle unselectable fieldsTab largeFontSize trimmedTextWithEllipsis" ng-if="$ctrl.viewModel.isPaneExpanded" localize="DashboardPane_Header"></h2><div class="verticalTitle" ng-if="!$ctrl.viewModel.isPaneExpanded"><h2 class="largeFontSize" localize="DashboardPane_Header"></h2></div></button></div><div class="paneContents flex" ng-show="$ctrl.viewModel.isPaneExpanded"><dashboard-tile-list view-model="$ctrl.viewModel.dashboard"></dashboard-tile-list></div></article>'),e.put("components/dashboardTileList/dashboardTileList.html",'<div class="tile-list"><div class="no-items-container" ng-if="!$ctrl.shouldShowUnpinnedTileList()"><i class="glyphicon pbi-glyph-unpin glyph-medium"></i><label localize="DashboardTileList_NoTiles" class="no-items-message"></label></div><ul class="tile-container" ng-if="$ctrl.shouldShowUnpinnedTileList()"><dashboard-tile ng-repeat="tile in $ctrl.unpinnedTiles() track by $ctrl.tileTrackerFn(tile)" view-model="tile" can-edit="false" disable-interactions="true" add-tile-to-mobile-view="$ctrl.addTileToMobile(tile)" disable-pointer-events="true" viewport-context-selector="\'dashboard-tile-list\'"></dashboard-tile></ul></div>'),e.put("components/dataClassificationLabel/dataClassificationLabel.html",'<a class="dataClassification" ng-href="{{$ctrl.dataClassification.url}}" onclick="event.stopPropagation();" target="_blank" ng-if="$ctrl.isDataClassificationFeatureEnabled && $ctrl.dataClassification && $ctrl.dataClassification.showTag && $ctrl.dataClassification.url" title="{{$ctrl.dataClassification.name}}" ng-bind="$ctrl.dataClassification.shortHand"></a><span class="dataClassification" ng-if="$ctrl.isDataClassificationFeatureEnabled && $ctrl.dataClassification && $ctrl.dataClassification.showTag && !$ctrl.dataClassification.url" title="{{$ctrl.dataClassification.name}}" ng-bind="$ctrl.dataClassification.shortHand"></span>'),e.put("components/datasetIconContainer/datasetIconContainer.html",'<span class="datasetItemIcon" ng-switch="::$ctrl.refreshRelated"><span class="datasetItemIndicator" ng-switch-when="false"><i ng-if="::$ctrl.isShared()" class="glyphicon pbi-glyph-shared" localize-tooltip="NavigationPane_SharedWithMe"></i><i ng-if="$ctrl.isNew()" class="glyphicon pbi-glyph-asterisk"></i></span><span class="datasetRefreshIcons" ng-switch-when="true" ng-switch="$ctrl.isRefreshInProgress()"><spinner ng-switch-when="true" localize-tooltip="NavigationPane_RefreshInProgress"></spinner><span ng-switch-default><i ng-if="$ctrl.isPublishError()" class="warning glyphicon pbi-glyph-warning glyph-small" localize-tooltip="NavigationPane_RefreshPublishError"></i><i ng-if="$ctrl.showRefreshError && $ctrl.showRefreshError()" class="warning glyphicon pbi-glyph-warning glyph-small" tooltip tooltip-config="$ctrl.tooltipConfig" ng-click="$event.stopPropagation();$ctrl.showRefreshErrorDialog()"></i></span></span></span>'),e.put("components/errorPlaceholder/errorPlaceholder.html",'<div class="errorPlaceholder"><div class="errorContainer"><div class="errorPlaceholderIcon glyphicon pbi-glyph-error glyph-med" title="{{$ctrl.errorText}}"></div><div class="errorPlaceholderTextContainer"><span class="errorPlaceholderText" ng-bind="$ctrl.errorText"></span><a ng-if="$ctrl.errorDetails" class="getDetailsText clickAction" localize="ErrorPlaceHolder_SeeDetails" ng-click="$ctrl.seeErrorDetails()"></a></div></div></div>'),e.put("components/exportDataDialog/exportDataDialog.html",'<dialog-frame><dialog-header><span localize="ModalDialog_ExportDataTitle" class="dialogTitle"></span></dialog-header><dialog-body><span localize="ModalDialog_ExportDataTextDialogTwo" class="dialogMessage"></span><ul class="radioButtonText"><li ng-repeat="val in ::$ctrl.viewModel.options"><div class="pbi-input dataTypeMenu" tooltip tooltip-config="$ctrl.getTooltipConfigForDataType(val)"> <input class="dataTypeItem" type="radio" name="option" ng-model="$ctrl.viewModel.dataType" ng-value="::$index" ng-change="$ctrl.update(val)" ng-disabled="$ctrl.isDataTypeDisabled(val)"><label ng-bind="::val"></label></div></li></ul><pbi-select ng-if="$ctrl.viewModel.isCsvFormatDisabled" class="exportDataSelectButton" label="ModalDialog_ExportDataFormatTypeText" ng-model="$ctrl.viewModel.dataFormat"><pbi-option label="ModalDialog_ExportDataFormatXL" ng-value="\'0\'" ng-disabled="::$ctrl.viewModel.isExlFormatDisabled"></pbi-option><pbi-option label="ModalDialog_ExportDataFormatCsv" ng-value="\'1\'" ng-disabled="true"></pbi-option></pbi-select><pbi-select ng-if="!$ctrl.viewModel.isCsvFormatDisabled" class="exportDataSelectButton" label="ModalDialog_ExportDataFormatTypeText" ng-model="$ctrl.viewModel.dataFormat"><pbi-option label="ModalDialog_ExportDataFormatXL" ng-value="\'0\'" ng-disabled="::$ctrl.viewModel.isExlFormatDisabled"></pbi-option><pbi-option label="ModalDialog_ExportDataFormatCsv" ng-value="\'1\'"></pbi-option></pbi-select><pbi-alert class="dataInfoMessage" kind="\'info\'" message-info="ModalDialog_ExportDataInfoMessage"></pbi-alert><div ng-if="::$ctrl.viewModel.isExlFormatDisabled" ng-switch="$ctrl.viewModel.exportXlsxUnsupportedType"><pbi-alert ng-switch-when="1" kind="\'info\'" message-info="ExlFormat_ToolTipDescription_AsOnPrem"></pbi-alert><pbi-alert ng-switch-default kind="\'info\'" message-info="ExlFormat_ToolTipDescription"></pbi-alert></div><pbi-alert ng-if="$ctrl.viewModel.isCsvFormatDisabled" kind="\'info\'" message-info="SupportOnlyExlFormat_ToolTipDescription"></pbi-alert></dialog-body><dialog-footer><pbi-link ng-if="::($ctrl.viewModel.isUnderlyingDisabled && !$ctrl.viewModel.isExlFormatDisabled)" class="learnMoreLink" guid="827799" label="Learn_Aggregates"></pbi-link> <button autofocus type="submit" ng-click="$ctrl.exportData()" class="primary" localize="ModalDialogButtonText_Export"></button> <button ng-click="$ctrl.close()" localize="ModalDialogButtonText_Cancel"></button></dialog-footer></dialog-frame>'),e.put("components/exportDataDialog/exportDataDialogDefinition.html",'<export-data-dialog view-model="viewModel"></export-data-dialog>'),e.put("components/favoritesContainer/favoritesContainer.html",'<div class="favoriteContainerView isNavigationPaneEnabled contentListView" ng-class="{isMainContentDisabled: collapsiblePaneMode !== 0}"><div class="header" feature-switch-not="breadcrumbNavigationEnabled"><div class="dashboardAppBar appBar"><div class="appBarSection left"><ul><li class="label"><span class="appBarTitle" localize="Favorites_FavoritesTitle"></span></li></ul></div></div></div><div class="dashboardControls"><search-box should-focus="true" on-change="$ctrl.onSearchTextChange()" on-blur="$ctrl.resolveSearchTelemetry()" filter="$ctrl.searchText" placeholder="SearchContent"></search-box></div><div class="contentListOptionsTabs unselectable"><div class="right"><span class="count" localize="ShowingXItems" localize-fragments><span fragment-index="0" ng-bind="$ctrl.filteredFavorites.length"></span></span><select-tile-sort selected-predicate="$ctrl.sortPredicate" on-select="$ctrl.selectSort" predicates="$ctrl.sortPredicates"></select-tile-sort></div></div><div class="dashboardSliderMain" ng-class="{noFavorites: $ctrl.showEmptyFavoritesWatermark}" feature-switch-class="breadcrumbNavigationEnabled"><pbi-data-loader-spinner class="centered" ng-if="!$ctrl.initialized"></pbi-data-loader-spinner><water-mark-message config="::$ctrl.emptySearchWatermarkConfig" ng-show="$ctrl.showEmptySearchWatermarkConfig"></water-mark-message><content-list-gallery view-model="::$ctrl.galleryViewModel" is-data-classification-enabled="::$ctrl.isDataClassificationEnabled"></content-list-gallery><div class="emptyFavorites noselect"><div class="empty-favorites-img"></div><div class="noFavTitle" localize="Favorites_NoFavoritesTitle"></div><div class="noFavMessage" localize="Favorites_NoFavoritesMessage1"></div><i class="glyphicon pbi-glyph-favoritestar glyph-small"></i><div class="noFavMessage" localize="Favorites_NoFavoritesMessage2"></div></div></div></div>'),e.put("components/featuredDashboardContainer/featuredDashboardContainer.html",'<div class="featuredDashboardContainer"><water-mark-message config="::$ctrl.watermarkConfig"></water-mark-message><div ng-if="$ctrl.hasDashboards()" class="mfuDashboards"><header localize="FeaturedDashboard_MostFrequentlyUsedTitle"></header><div class="dashboards"><div class="outline" ng-repeat="dashboard in ::$ctrl.dashboards" ng-class="{\'selected\': dashboard.objectId === $ctrl.selectedDashboard.objectId}"> <button class="dashboard trimmedTextWithEllipsis" ng-click="$ctrl.selectDashboard(dashboard)" ng-bind="::dashboard.displayName" title="{{::dashboard.displayName}}"/></div></div><pbi-button primary="true" ng-click="$ctrl.setHomeDashboard()" localize-tooltip="FeaturedDashboard_SetDashboard" label="FeaturedDashboard_SetDashboard" ng-disabled="!$ctrl.selectedDashboard"></pbi-button></div></div>'),e.put("components/groupActions/groupActions.html",'<button class="options navigationPaneButton groupContextMenuButton " dropdown-menu dropdown-class="navigationPaneGroupContextMenu" dropdown-items="$ctrl.items" dropdown-orientation="$ctrl.dropdownOrientation" dropdown-on-item-selected="$ctrl.onGroupNavigationPaneMenuItemSelected(selected, $ctrl.group)" dropdown-separator-class="groupContextMenuSeparator"><i class="glyphicon pbi-glyph-more glyph-small"></i></button>'),e.put("components/groupEditor/create/createGroupBlade.html",'<ng-form name="createGroupForm"><div class="groupsEditorBlade paneLayout"><header><h1 class="primaryHeading" localize="GroupEditor_Title_CreateGroup"></h1></header><section class="contentContainer"><section class="displayBlock"><h4 class="title" localize="GroupEditor_GroupNameLabel_Text_CreateGroup"></h4> <input id="groupName" required name="groupName" type="text" spellcheck="false" autocomplete="off" ng-model="$ctrl.model.groupName" ng-keyup="$ctrl.groupNameKeyUp()"/></section><section class="displayBlock"><h4 class="title" ng-if="$ctrl.model.groupName" localize="GroupEditor_GroupIdLabel_Text"></h4> <input name="groupId" spellcheck="false" type="text" autocomplete="off" ng-if="$ctrl.model.groupName" ng-model="$ctrl.model.groupId" ng-disabled="!$ctrl.isEditingGroupId" ng-keyup="$ctrl.groupIdKeyUp()"><pbi-button kind="icon" icon-name="edit" icon-size="small" ng-click="$ctrl.isEditingGroupId = true" ng-if="$ctrl.model.groupName && !$ctrl.isEditingGroupId" localize-tooltip="GroupEditor_GroupIdEdit_Tooltip"></pbi-button><div ng-if="$ctrl.isValidatingGroupId" class="spinnerWithText"><spinner class="xsmall"></spinner><div localize="GroupEditor_WaitForGroupIdValidation"></div></div><div class="spinnerWithText" ng-hide="$ctrl.isValidatingGroupId || !$ctrl.model.groupId" ng-switch="$ctrl.groupValidationStatus"><label ng-switch-when="0" localize="GroupEditor_CreateGroup_GroupId_Available_Text"></label><label ng-switch-when="1" localize="GroupEditor_CreateGroup_GroupId_NotAvailable_Text"></label><label ng-switch-when="2" localize="GroupEditor_FailedValidateGroupId_Message"></label><label ng-switch-when="3" localize="GroupEditor_CreateGroup_GroupId_HasInvalidCharacters"></label></div></section><section class="displayBlock"><h4 class="title" localize="PBI_Button_Label_Privacy"></h4> <select name="privacySetting" ng-model="$ctrl.model.privacyOption" ng-options="privacyOption.key as privacyOption.value for privacyOption in $ctrl.model.privacyOptions" ng-disabled="$ctrl.isSaving"></select> <select name="accessControlOption" ng-if="::$ctrl.readOnlyGroupEnabled" ng-model="$ctrl.model.accessControlOption" ng-options="accessControlOption.key as accessControlOption.value for accessControlOption in $ctrl.model.accessControlOptions" ng-disabled="$ctrl.isSaving"></select></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_AddGroupMembersLabel_Text"></h4><emails-list id="emailList" view-model="$ctrl.model.emailsList"></emails-list><pbi-button id="addButton" label="GroupEditor_AddButton_Text" primary="true" ng-click="$ctrl.add()" ng-disabled="!$ctrl.model.emailsList.inputUserList || $ctrl.isSaving"></pbi-button><div class="spinnerWithText" ng-if="$ctrl.isAddingMembers"><spinner></spinner><div localize="GroupEditor_WaitForAddingMembers"></div></div><div class="error"><label title="{{$ctrl.model.invalidEmailAddressesErrorMessage }}" ng-if="$ctrl.model.invalidEmailAddressesErrorMessage  !== \'\'" ng-bind="$ctrl.model.invalidEmailAddressesErrorMessage "></label><label title="{{$ctrl.model.notExitingEmailAddressesErrorMessage}}" ng-if="$ctrl.model.notExitingEmailAddressesErrorMessage !== \'\'" ng-bind="$ctrl.model.notExitingEmailAddressesErrorMessage"></label></div><ul class="userListContainer"><li ng-repeat="member in $ctrl.model.displayMemberList track by member.userPrincipalName"><span class="username trimmedTextWithEllipsis" ng-bind="::member.userPrincipalName"></span> <select name="groupMemberRole" class="usertype" ng-if="::$ctrl.readOnlyGroupEnabled && member.role !== 2" ng-model="member.role" ng-options="groupMemberRole.key as groupMemberRole.value for groupMemberRole in $ctrl.model.groupMemberRoleOptions"></select><pbi-button kind="icon" icon-name="delete" icon-size="mini" ng-click="$ctrl.removeMember(member);createGroupForm.$setDirty();"></pbi-button></li></ul></section><section class="displayBlock advanced" ng-if="::$ctrl.capacityEnabled" ng-click="$ctrl.toggleAdvancedMode()"><h4 class="title" localize="GroupEditor_Advanced"></h4><i class="glyphicon glyph-mini expand" ng-class="$ctrl.isAdvancedModeExpanded ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"></i></section><section class="displayBlock capacity" ng-if="$ctrl.isAdvancedModeExpanded"><div class="capToggle"><div class="subtitle"><label localize="Premium"></label><pbi-icon name="info" size="small" tooltip tooltip-config="{tooltipLocalizeDescription: \'GroupEditor_PremiumTooltip\', tooltipArrowPosition: 1}"></pbi-icon></div><pbi-toggle on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff" ng-model="$ctrl.model.isCapacityEnabled" ng-change="$ctrl.toggleCapacity();editGroupForm.$setDirty();" ng-disabled="!$ctrl.canEditCapacity()" class="toggle"></pbi-toggle></div><div class="capEdit" ng-if="$ctrl.canEditCapacity() && $ctrl.model.isCapacityEnabled"><div class="subtitle"><label localize="GroupEditor_CapacitySelection"></label><pbi-icon name="info" size="small"></pbi-icon></div> <select ng-model="$ctrl.model.capacity.id" ng-options="capacity.id as capacity.name for capacity in $ctrl.availableCapacities"/><a localize="LearnMore" href="https://go.microsoft.com/fwlink/?linkid=845343"></a></div></section></section><footer><fieldset class="buttons"><spinner ng-if="$ctrl.isSaving"></spinner><pbi-button label="GroupEditor_SaveButton_Text" ng-click="$ctrl.save()" ng-disabled="!createGroupForm.$dirty || editGroupForm.$invalid || !$ctrl.canSave || $ctrl.isSaving" primary="true"></pbi-button><pbi-button label="GroupEditor_DiscardButton_Text" ng-click="$ctrl.cancel()" ng-disabled="$ctrl.isSaving"></pbi-button></fieldset></footer></div></ng-form>'),e.put("components/groupEditor/edit/editGroupBlade.html",'<ng-form name="editGroupForm"><div class="groupsEditorBlade paneLayout"><header><h1 class="primaryHeading" localize="GroupEditor_Title_EditGroup"></h1></header><section class="contentContainer"><section class="displayBlock"><h4 class="title" localize="GroupEditor_GroupNameLabel_Text_EditViewGroup"></h4> <input name="groupName" required ng-model="$ctrl.model.groupName" ng-disabled="$ctrl.editNonAdmin" type="text" spellcheck="false" autocomplete="off" maxlength="64" autofocus></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_PrivacyLabel_Text"></h4> <input id="privacySetting" required type="text" disabled="disabled" ng-value="$ctrl.getPrivacyOption()"/> <select name="accessOption" ng-if="::$ctrl.readOnlyGroupEnabled" ng-model="$ctrl.model.accessControlOption" ng-options="accessControlOption.key as accessControlOption.value for accessControlOption in $ctrl.model.accessControlOptions" ng-disabled="$ctrl.isSaving"></select></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_AddGroupMembers_ViewMode_Label_Text"></h4><emails-list id="emailList" view-model="$ctrl.model.emailsList"></emails-list><pbi-button label="GroupEditor_AddButton_Text" primary="true" ng-click="$ctrl.add()" ng-disabled="!$ctrl.model.emailsList.inputUserList || $ctrl.isSaving"></pbi-button><div class="spinnerWithText" ng-if="$ctrl.isAddingMembers"><spinner></spinner><div localize="GroupEditor_WaitForAddingMembers"></div></div><div class="error"><label title="{{$ctrl.model.invalidEmailAddressesErrorMessage }}" ng-if="$ctrl.model.invalidEmailAddressesErrorMessage  !== \'\'" ng-bind="$ctrl.model.invalidEmailAddressesErrorMessage "></label><label title="{{$ctrl.model.notExitingEmailAddressesErrorMessage}}" ng-if="$ctrl.model.notExitingEmailAddressesErrorMessage !== \'\'" ng-bind="$ctrl.model.notExitingEmailAddressesErrorMessage"></label></div><ul class="userListContainer"><li ng-repeat="member in $ctrl.model.displayMemberList | orderBy:\'+userPrincipalName\' track by member.userPrincipalName"><span class="username trimmedTextWithEllipsis" ng-bind="member.userPrincipalName" ng-attr-title="{{::member.userPrincipalName}}"></span> <select ng-if="::$ctrl.model.isAdmin" ng-model="member.role" class="usertype" ng-options="groupMemberRole.key as groupMemberRole.value for groupMemberRole in $ctrl.model.groupMemberRoleOptions" ng-disabled="$ctrl.isMemberTheOnlyAdmin(member)"></select><span class="usertype" ng-if="!$ctrl.model.isAdmin && member.role === 1" localize="GroupEditor_RoleOptions_Admin"></span><span class="usertype" ng-if="!$ctrl.model.isAdmin && member.role === 0" localize="GroupEditor_RoleOptions_Member"></span><pbi-button ng-if="::$ctrl.model.isAdmin" kind="icon" icon-name="delete" icon-size="mini" ng-click="$ctrl.removeMember(member);editGroupForm.$setDirty();"></pbi-button></li></ul></section><section class="displayBlock advanced" ng-if="::$ctrl.capacityEnabled" ng-click="$ctrl.toggleAdvancedMode()"><h4 class="title" localize="GroupEditor_Advanced"></h4><i class="glyphicon glyph-mini expand" ng-class="$ctrl.isAdvancedModeExpanded ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"></i></section><section class="displayBlock capacity" ng-if="$ctrl.isAdvancedModeExpanded"><div class="capToggle"><div class="subtitle"><label localize="Premium"></label><pbi-icon name="info" size="small" tooltip tooltip-config="{tooltipLocalizeDescription: \'GroupEditor_PremiumTooltip\', tooltipArrowPosition: 1}"></pbi-icon></div><pbi-toggle on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff" ng-model="$ctrl.model.isCapacityEnabled" ng-change="$ctrl.toggleCapacity();editGroupForm.$setDirty();" ng-disabled="!$ctrl.canEditCapacity() && !$ctrl.model.isCapacityEnabled" class="toggle" tooltip tooltip-config="$ctrl.getToggleTooltipConfig()"></pbi-toggle></div><div class="capInfo" ng-if="!$ctrl.canEditCapacity() && $ctrl.model.isCapacityEnabled"><pbi-icon name="info" size="small"></pbi-icon> <label>{{$ctrl.getInCapacityMessage()}}</label><a localize="LearnMore" href="https://go.microsoft.com/fwlink/?linkid=845343"></a></div><div class="capEdit" ng-if="$ctrl.canEditCapacity() && $ctrl.model.isCapacityEnabled"><div class="subtitle"><label localize="GroupEditor_CapacitySelection"></label><pbi-icon name="info" size="small"></pbi-icon></div> <select ng-model="$ctrl.model.capacity.id" ng-options="capacity.id as capacity.name disable when capacity.disabled for capacity in $ctrl.availableCapacities"/><a localize="LearnMore" href="https://go.microsoft.com/fwlink/?linkid=845343"></a></div></section></section><footer><fieldset class="buttons"><pbi-button id="deleteGroupButton" ng-if="$ctrl.model.isAdmin" label="GroupEditor_DeleteGroup_Text" icon-name="delete" ng-click="$ctrl.deleteGroup()" ng-disabled="$ctrl.isSaving || !$ctrl.canSave"></pbi-button><pbi-button label="GroupEditor_SaveButton_Text" ng-click="$ctrl.save()" ng-disabled="!editGroupForm.$dirty || editGroupForm.$invalid || !$ctrl.canSave" primary="true"></pbi-button><pbi-button label="GroupEditor_DiscardButton_Text" ng-click="$ctrl.cancel()" ng-disabled="$ctrl.isSaving || !$ctrl.canSave"></pbi-button></fieldset></footer></div></ng-form>'),e.put("components/groupEditor/view/viewGroupBlade.html",'<div class="groupsEditorBlade paneLayout"><header><h1 class="primaryHeading" localize="GroupEditor_Title_ViewGroup"></h1></header><section class="contentContainer viewContainer"><section class="displayBlock"><h4 class="title" localize="PBI_Button_Label_Name"></h4><span class="textBody" ng-bind="::$ctrl.model.groupName"></span></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_PrivacyLabel_Text"></h4><div class="textBody" ng-bind="::$ctrl.getAccessControlOption()"></div><div class="textBody" ng-bind="$ctrl.getPrivacyOption()"></div></section><section class="displayBlock"><h4 class="title" localize="GroupEditor_AddGroupMembers_ViewMode_Label_Text"></h4><ul class="userListContainer" ng-if="!$ctrl.isLoadingGroupMembers"><li ng-repeat="member in ::$ctrl.model.displayMemberList | orderBy:\'+userPrincipalName\' track by member.userPrincipalName"><span class="username trimmedTextWithEllipsis" ng-bind="::member.userPrincipalName" ng-attr-title="{{::member.userPrincipalName}}"></span><span class="glyphicon pbi-glyph-mail glyph-small invite" ng-if="member.role === 2 && !member.invitationSent" localize-tooltip="GroupEditor_PendingInvitation"></span><span class="glyphicon pbi-glyph-mail glyph-small invite" ng-if="member.role === 2 && member.invitationSent" localize-tooltip="GroupEditor_InvitationSent"></span><span class="usertype" ng-if="::$ctrl.readOnlyGroupEnabled && member.role === 1" localize="GroupEditor_RoleOptions_Admin"></span><span class="usertype" ng-if="::$ctrl.readOnlyGroupEnabled && member.role === 0" localize="GroupEditor_RoleOptions_Member"></span></li></ul><div ng-if="$ctrl.isLoadingGroupMembers"><spinner></spinner><span localize="GroupEditor_WaitLoadMembers"></span></div></section></section><footer><fieldset class="buttons"><pbi-button label="PBI_Button_Label_OK" primary="true" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></div>'),e.put("components/groupIcon/groupIcon.html",'<lazy-icon ng-if="$ctrl.group" src="$ctrl.src" placeholder="$ctrl.placeholder" placeholder-size="$ctrl.placeholderSize"></lazy-icon>'),e.put("components/groupList/groupList.html",'<button class="button myWorkspace" ng-class="{selected: $ctrl.isActiveGroup($ctrl.myWorkspace)}" ng-click="$ctrl.switchGroup($ctrl.myWorkspace)" title="{{::$ctrl.myWorkspace.displayName}}"><div class="flexDiv"><group-icon group="::$ctrl.myWorkspace" placeholder-size="small"></group-icon><span class="workspaceName" ng-bind="::$ctrl.myWorkspace.displayName"></span></div></button><header class="groupHeader"><span localize="NavigationPane_Groups_Workspaces_V2"></span></header><ul><li ng-repeat="group in $ctrl.groups track by group.aadGroupId"> <button class="button" ng-click="$ctrl.switchGroup(group)" ng-class="{selected: $ctrl.isActiveGroup(group)}" title="{{group.displayName}}"><div class="flexDiv"><group-icon group="group" placeholder-size="small"></group-icon><span class="workspaceName" ng-bind="group.displayName"></span><pbi-icon class="capacity" name="diamond" size="small" ng-if="!!group.capacity" tooltip tooltip-config="{tooltipLocalizeDescription: \'Capacity_Icon_Tooltop\', tooltipArrowPosition: 1}"></pbi-icon></div></button><group-actions group="group"></group-actions></li></ul><pbi-button class="addGroup" ng-click="$ctrl.addGroup()" primary="true" label="NavigationPane_CreateAppWorkspace"></pbi-button><div ng-if="$ctrl.isExpanded" class="capture" ng-click="$ctrl.toggleGroupListPane(false)"></div>'),e.put("components/groupSwitcher/groupSwitcher.html",'<div class="flexDiv" ng-click="$ctrl.onToggled()" localize-tooltip="NavigationPane_Workspaces"> <button><div class="flexDiv"><i class="navicon glyphicon pbi-glyph-collections glyph-small"></i><span class="btnLabel" localize="NavigationPane_Workspaces"></span></div></button></div> <button class="switcher" ng-click="$ctrl.onToggled()" localize-tooltip="GroupSwitch_NavPaneTitle"><span class="glyphicon glyph-small"></span></button>'),e.put("components/groupSwitcherV2/groupSwitcherV2.html",'<div class="groupSwitcherV2" ng-class="{\'isExpanded\':$ctrl.isExpanded && $ctrl.canExpand}"><div class="activeGroup"><div class="toggle" ng-click="$ctrl.toggleGroupSwitcherPane()" localize-tooltip="NavigationPane_Workspaces"><div class="icon"><i class="glyphicon pbi-glyph-collections glyph-small"></i></div><span class="text" localize="NavigationPane_Workspaces"></span></div> <button class="options add" focus-out-trigger ng-click="$ctrl.addGroup()" localize-tooltip="NavigationPane_CreateGroup"><i class="glyphicon pbi-glyph-add"></i></button></div><div class="list"><span class="sectionLabel" localize="NavigationPane_Groups_MyWorkspace_V2"></span><div focus-out-trigger class="groupItem" ng-click="$ctrl.switchGroup($ctrl.groupService.groups[0])" ng-class="{\'selected\': $ctrl.isGroupSelected($ctrl.groupService.groups[0])}"><div class="icon" ng-switch="$ctrl.userPhoto !== undefined"><i ng-switch-when="false" class="glyphicon pbi-glyph-user glyph-med groupIcon placeholder"></i><div ng-switch-when="true" ng-style="{\'background-image\': $ctrl.userPhoto,\'background-size\':\'cover\',\'background-position\':\'0px 0px\'}"></div></div><span class="text" title="{{$ctrl.groupService.groups[0].displayName}}" ng-bind="$ctrl.groupService.groups[0].displayName"></span></div><span class="sectionLabel" localize="NavigationPane_Groups_MyGroups"></span><ul><li ng-repeat="group in $ctrl.getGroups()" focus-out-trigger ng-click="$ctrl.switchGroup(group)" class="groupItem" ng-if="$index!=0" ng-class="{\'selected\': $ctrl.isGroupSelected(group)}"><div class="icon" ng-switch="group.icon !== undefined"><i ng-switch-when="false" class="glyphicon pbi-glyph-group glyph-med groupIcon placeholder"></i> <img ng-switch-when="true" class="groupIcon" ng-src="{{group.icon}}"/></div><span class="text"><span title="{{group.displayName}}" ng-bind="group.displayName"></span></span></li></ul></div></div>'),e.put("components/installStoreAppDialog/installStoreAppDialog.html",'<dialog-frame><dialog-header><label ng-bind="::$ctrl.titleText"></label></dialog-header><dialog-body><label localize="App_AutoInstall_AddDialogMessage"></label><a class="helpLink" href="{{::$ctrl.appsLink}}" target="_blank"><label class="successLabel regularBlackText" localize="LearnMore"></label></a></dialog-body><dialog-footer> <button autofocus type="submit" ng-click="$ctrl.ok()" class="primary" localize="ModalDialog_Add"></button> <button ng-click="$ctrl.cancel()" localize="PBI_Button_Label_Cancel"></button></dialog-footer></dialog-frame>'),e.put("components/installStoreAppDialog/installStoreAppDialogDefinition.html",'<install-store-app-dialog app="app"></install-store-app-dialog>'),e.put("components/insufficientLicenseBar/insufficientLicenseBar.html",'<span><label ng-bind="::$ctrl.content"></label></span> <button localize="UpgradeAccount_StartTrialButton" ng-click="$ctrl.startTrial()" ng-if="::$ctrl.showTrialButton()"></button> <button localize="UpgradeDialogButtonText_UpgradeNow" ng-click="$ctrl.upgrade()"></button>'),e.put("components/introduceAppBar/introduceAppBar.html",'<section ng-if="$ctrl.showIntroduceAppBar" class="trimmedTextWithEllipsis"><label class="title" ng-bind="::$ctrl.title"></label><label ng-bind="::$ctrl.content"></label><a href="{{::$ctrl.learnMoreLink}}" target="_blank" ng-bind="::$ctrl.learnMoreText"></a><pbi-icon name="close" size="small" class="closeButton" ng-click="$ctrl.hideBar()"></pbi-icon></section>'),e.put("components/introduceAppDialog/introduceAppDialog.html",'<dialog-frame><dialog-header><header class="smallHeader" localize="AppModel_IntroduceApp"></header><header class="mainHeader" localize="AppModel_TryApp"></header><pbi-icon name="question" size="micro" tooltip tooltip-config="$ctrl.learnMoreTooltipConfig" ng-click="$ctrl.learnMoreAboutApps()"></pbi-icon></dialog-header><dialog-body><table><thead><tr><th></th><th localize="AppModel_ContentPacks"></th><th localize="AppModel_Apps"></th></tr></thead><tbody><tr><td localize="AppModel_BundleContent"></td><td><pbi-icon name="chromeminimize" size="small"></pbi-icon></td><td><pbi-icon name="success" size="small"></pbi-icon></td></tr><tr><td localize="AppModel_PermanentUrls"></td><td><pbi-icon name="chromeminimize" size="small"></pbi-icon></td><td><pbi-icon name="success" size="small"></pbi-icon></td></tr><tr><td localize="AppModel_AlwaysUpToDate"></td><td><pbi-icon name="chromeminimize" size="small"></pbi-icon></td><td><pbi-icon name="success" size="small"></pbi-icon></td></tr><tr><td localize="AppModel_CustomizableThemes"></td><td><pbi-icon name="chromeminimize" size="small"></pbi-icon></td><td><pbi-icon name="success" size="small"></pbi-icon></td></tr></tbody></table><section class="convertDescription" localize="AppModel_ConvertDescription"></section></dialog-body><dialog-footer><pbi-button class="okButton" autofocus type="submit" ng-click="$ctrl.ok()" primary="primary" label="{{::$ctrl.okButtonTextLocId}}"></pbi-button></dialog-footer></dialog-frame>'),e.put("components/introduceAppDialog/introduceAppDialogDefinition.html",'<introduce-app-dialog config="config"></introduce-app-dialog>'),e.put("components/makeACopyDialog/makeACopyDialog.html",'<dialog-frame><dialog-header><label localize="::$ctrl.titleKey"></label></dialog-header><dialog-body><label class="message" localize="::$ctrl.messageKey"></label><label localize="::$ctrl.itemsIntroKey"></label><div class="itemList"><label ng-repeat="item in ::$ctrl.itemNames track by $index" ng-bind="::item"></label></div></dialog-body><dialog-footer> <button autofocus type="submit" ng-click="$ctrl.save()" class="primary" localize="ModalDialog_Save"></button> <button ng-click="$ctrl.cancel()" localize="ModalDialog_Cancel"></button></dialog-footer></dialog-frame>'),e.put("components/makeACopyDialog/makeACopyDialogDefinition.html",'<make-a-copy-dialog title-key="titleKey" message-key="messageKey" items-intro-key="itemsIntroKey" dashboards="dashboards" reports="reports" models="models"></make-a-copy-dialog>'),e.put("components/metadataContainer/metadataContainer.html","<div ng-repeat='metadata in $ctrl.datasetMetadata' class='metadata' ng-switch='metadata.type'><div ng-switch-when='0'> <span class='message'>{{metadata.value()}}</span><span ng-if='metadata.infoTooltipConfig' class='glyphicon glyph-mini pbi-glyph-info' tooltip tooltip-config='::metadata.infoTooltipConfig'></span></div><div ng-switch-when='2'> <span>{{ metadata.value() }}</span> <a ng-bind-attr='{href: metadata.linkUrl(), title: metadata.linkTitle() || metadata.linkText(), target: metadata.linkTarget}'>{{ metadata.linkText() }}</a></div><div ng-switch-when='3'><span class='refreshFlyoutWarning' ng-if='metadata.isWarning == true'><i class='glyphicon pbi-glyph-error glyph-mini'></i></span> <a class='refreshHistory' href='' ng-click='metadata.actionOnClick()'>{{metadata.value()}}</a></div><div ng-switch-when='4'><div ng-switch='metadata.status'><div ng-switch-when='0'><span class='glyphicon glyph-small pbi-glyph-error statusIcon'></span><span class='statusText' ng-bind='metadata.value'></span></div><div ng-switch-when='1'><span class='glyphicon glyph-small pbi-glyph-success glyph-success-color statusIcon'></span><span class='statusText' ng-bind='metadata.value'></span></div></div></div></div>"),
e.put("components/navigationPaneV2/navigationPaneV2.html",'<div class="navigationPaneV2" ng-class="{isFrozen: $ctrl.groupService.isInGroupTransition, isExpanded: $ctrl.isExpanded}"> <button class="expanderBtn glyphicon pbi-glyph-globalnavbutton slideFadeIn" ng-click="$ctrl.onToggleClicked()" title="{{ $ctrl.getExpandButtonTitle() }}"></button><div class="navigationPaneBody slideFadeIn" feature-switch-class="appsEnabled"><div class="globalPivots"><nav-pane-flyout-button class="button favorites" show-recent="false" icon="pbi-glyph-favoritestar" label="Favorites_NavPaneTitle" navigate-to="$ctrl.navigateToFavorites()" ng-class="{\'highlight\':$ctrl.isOnFavorites(), isExpanded: $ctrl.isExpanded}" ng-click="$ctrl.onGroupSwitcherToggled(false)"></nav-pane-flyout-button><nav-pane-flyout-button class="button recent" icon="pbi-glyph-mru" label="RecentlyViewed_NavPaneTitle" navigate-to="$ctrl.navigateToRecentlyViewed()" ng-class="{\'highlight\':$ctrl.isOnRecentlyViewed(), isExpanded: $ctrl.isExpanded}" ng-click="$ctrl.onGroupSwitcherToggled(false)"></nav-pane-flyout-button> <button class="button myApps" localize-tooltip="Apps_NavPaneTitle" ng-if="::$ctrl.isAppsEnabled()" ng-click="$ctrl.navigateToApps()" ng-class="{\'highlight\':$ctrl.isOnApps()}"><div class="flexDiv"><i class="navicon glyphicon pbi-glyph-my-apps glyph-small"></i><span class="btnLabel" localize="Apps_NavPaneTitle"></span></div></button> <button class="button sharedWithMe" localize-tooltip="NavigationPane_SharedWithMeTitle" ng-click="$ctrl.navigateToOnlySharedWithMe()" ng-class="{\'highlight\':$ctrl.isOnSharedWithMe()}"><div class="flexDiv"><i class="navicon glyphicon pbi-glyph-shared glyph-small"></i><span class="btnLabel" localize="NavigationPane_SharedWithMeTitle"></span></div></button></div><group-switcher class="button workspaces" on-toggled="$ctrl.onGroupSwitcherToggled(isExpanded)" ng-class="{\'highlight\':$ctrl.isOnWorkspaces(), isExpanded: $ctrl.isExpanded, isGroupSwitcherExpanded: $ctrl.isGroupSwitcherExpanded}"></group-switcher><quick-access-pane selected="$ctrl.isOnWorkspace()" ng-if="$ctrl.groupService.activeGroup" close-menus="$ctrl.onGroupSwitcherToggled(false)"></quick-access-pane> <button class="button getData" localize-tooltip="NavigationPane_GetData" ng-click="$ctrl.navigateToGetData()" ng-show="$ctrl.showGetDataBtn"><div class="flexDiv"><i class="navicon glyphicon pbi-glyph-getdata glyph-small"></i><span class="btnLabel" localize="NavigationPane_GetData"></span></div></button></div><group-list ng-if="$ctrl.isGroupSwitcherExpanded" ng-class="{large: $ctrl.shouldShowLargeGroupList}" active-group="$ctrl.groupService.activeGroup" on-toggled="$ctrl.onGroupSwitcherToggled(isExpanded)" is-expanded="$ctrl.isGroupSwitcherExpanded"></group-list></div>'),e.put("components/navPaneFlyoutButton/navPaneFlyoutButton.html",'<div class="flexDiv"> <button class="main" ng-click="$ctrl.navigateTo()" localize-tooltip="{{$ctrl.label}}"><div class="flexDiv"><i class="navicon glyphicon glyph-small" ng-class="::$ctrl.icon"></i><span class="name" localize="$ctrl.label"></span></div></button></div> <button class="switcher" ng-mousedown="$ctrl.mouseDownToggle()" ng-click="$ctrl.toggleFlyout()"><span class="glyphicon glyph-small" ng-class="{expanded: $ctrl.isExpanded}"></span></button><ul ng-class="{expand: $ctrl.isExpanded}" flyout-toggle="$ctrl.isExpanded"><li ng-repeat="item in $ctrl.items" title="{{item.displayName}}" ng-switch="::$ctrl.getActualType(item)"><a ng-click="$ctrl.openContent(item)"><i class="tileTypeIndicator glyphicon pbi-glyph-barchart glyph-small" ng-switch-when="2"></i><i class="tileTypeIndicator glyphicon pbi-glyph-gauge glyph-small" ng-switch-when="4"></i><i class="tileTypeIndicator glyphicon pbi-glyph-excel glyph-small" ng-switch-when="8"></i><i class="tileTypeIndicator glyphicon pbi-glyph-my-apps glyph-small" ng-switch-when="16"></i><span class="flyoutName" ng-bind="item.displayName"></span></a></li><li><a class="seeAll" ng-click="$ctrl.navigateToArea()" localize="NavigationPane_SeeAllLabel"></a></li></ul>'),e.put("components/popupNotificationDialog/popupNotificationDialog.html",'<dialog-frame><dialog-header><header class="smallHeader" ng-bind="::$ctrl.config.subtitle"></header><header class="mainHeader" ng-bind="::$ctrl.config.title"></header></dialog-header><dialog-body> <img src="{{::$ctrl.config.imgUrl}}" ng-if="::$ctrl.config.imgUrl"><section class="description" ng-bind="::$ctrl.config.message"></section></dialog-body><dialog-footer id="popupNotificationFooter"> <button type="submit" ng-click="$ctrl.ok()" autofocus class="okButton actionButton primary">{{::$ctrl.config.okButton.text}}</button> <button class="cancelButton text" ng-click="$ctrl.close()">{{::$ctrl.config.cancelButton.text}}</button></dialog-footer></dialog-frame>'),e.put("components/popupNotificationDialog/popupNotificationDialogDefinition.html",'<popup-notification-dialog config="config"></popup-notification-dialog>'),e.put("components/previewFeaturesModal/previewFeaturesModal.html",'<header><i class="glyphicon pbi-glyph-powerbi glyph-custom"></i><h localize="PreviewFeaturesModal_Header"></h></header><div class="content"><ul class="tabs"><li ng-repeat="tab in $ctrl.tabs track by tab.icon" ng-click="$ctrl.selectTab(tab)" ng-class="{selected: $ctrl.isTabSelected(tab)}"><i class="glyphicon pbi-glyph-{{tab.icon}} glyph-custom"></i><span ng-bind="tab.title"></span></li></ul><p><span ng-bind="$ctrl.activeTab.text"></span><a target="_blank" ng-href="{{$ctrl.activeTab.learnMoreUrl}}" localize="LearnMore"></a></p></div>'),e.put("components/previewFeedbackModal/previewFeedbackModal.html",'<header><i class="glyphicon pbi-glyph-powerbi glyph-custom"></i><h localize="PreviewFeedbackModal_Header"></h></header><div class="content"><p><div localize="PreviewFeedbackModal_Content1"></div><div localize="PreviewFeedbackModal_Content2"></div></p></div>'),e.put("components/printableImage/printableImage.html",'<img class="image" ng-class="{loaded: $ctrl.imageLoaded, animate: !$ctrl.disableAnimation}" ng-src="{{$ctrl.source}}" on-load="$ctrl.onLoad()" on-error="$ctrl.onError()"/>'),e.put("components/progressDialog/progressDialog.html",'<dialog-frame dismissable="false"><dialog-header><label localize="::$ctrl.titleKey"></label></dialog-header><dialog-body><span class="pbi-spinner"></span><label class="message" localize="::$ctrl.messageKey"></label></dialog-body><dialog-footer></dialog-footer></dialog-frame>'),e.put("components/progressDialog/progressDialogDefinition.html",'<progress-dialog title-key="titleKey" message-key="messageKey"></progress-dialog>'),e.put("components/quickAccessPane/quickAccessPane.html",'<div class="quickAccessPaneLauncher"><div class="flexDiv"> <button class="button workspace" ng-class="{highlight: $ctrl.selected}" ng-click="$ctrl.navigateToContentList()" title="{{$ctrl.groupService.activeGroup.displayName}}"><div class="flexDiv"><group-icon group="$ctrl.groupService.activeGroup" placeholder-size="small"></group-icon><span class="workspaceName" ng-bind="$ctrl.groupService.activeGroup.displayName"></span><pbi-icon class="capacity" name="diamond" size="small" ng-if="!!$ctrl.groupService.activeGroup.capacity" tooltip tooltip-config="{tooltipLocalizeDescription: \'Capacity_Icon_Tooltop\', tooltipArrowPosition: 1}"></pbi-icon></button></div> <button class="button switcher" ng-class="{highlight: $ctrl.selected}" ng-click="$ctrl.togglePane()" localize-tooltip="GroupSwitch_NavPaneTitle"><span class="glyphicon glyph-small" ng-class="{\'pbi-glyph-chevronupmedium\': $ctrl.paneExpanded, \'pbi-glyph-chevrondownmedium\': !$ctrl.paneExpanded}"></span></button></div><section class="artifactListing" ng-if="$ctrl.paneExpanded"><header class="artifactHeader unselectable" ng-click="$ctrl.toggleDashboards()" localize="NavigationPane_Dashboards_Header"></header><ul ng-if="$ctrl.dashboardsExpanded && !$ctrl.groupService.isInGroupTransition"><dashboard-navigation-pane-list-item ng-repeat="dashboard in $ctrl.dashboards track by dashboard.objectId" ng-click="$ctrl.openItem(dashboard)" view-model="::dashboard" new-style="true" selected="dashboard.objectId === $ctrl.currentObjectId"></dashboard-navigation-pane-list-item><li localize="NavigationPane_NoDashboardText" localize-tooltip="NavigationPane_NoDashboardText" class="noItemText navPaneListItem" ng-if="$ctrl.dashboards.length === 0"></li></ul><header class="artifactHeader unselectable" ng-click="$ctrl.toggleReports()" localize="NavigationPane_Reports_Header"></header><ul ng-if="$ctrl.reportsExpanded && !$ctrl.groupService.isInGroupTransition"><report-navigation-pane-list-item ng-repeat="report in $ctrl.reports track by report.objectId" ng-click="$ctrl.openItem(report)" view-model="::report" new-style="true" selected="report.objectId === $ctrl.currentObjectId"></report-navigation-pane-list-item><li localize="NavigationPane_NoReportText" localize-tooltip="NavigationPane_NoReportText" class="noItemText navPaneListItem" ng-if="$ctrl.reports.length === 0"></li></ul><header class="artifactHeader unselectable" ng-click="$ctrl.toggleWorkbooks()" localize="NavigationPane_Workbooks_Header"></header><ul ng-if="$ctrl.workbooksExpanded && !$ctrl.groupService.isInGroupTransition"><workbook-navigation-pane-list-item ng-repeat="workbook in $ctrl.workbooks track by workbook.uniqueId" ng-click="$ctrl.openItem(workbook)" view-model="::workbook" new-style="true" selected="workbook.uniqueId === $ctrl.currentObjectId"></workbook-navigation-pane-list-item><li localize="NavigationPane_NoWorkbookText" localize-tooltip="NavigationPane_NoWorkbookText" class="noItemText navPaneListItem" ng-if="$ctrl.workbooks.length === 0"></li></ul><header class="artifactHeader unselectable" ng-if="!$ctrl.isActiveWorkspaceReadOnly" ng-click="$ctrl.toggleDatasets()" localize="NavigationPane_Datasets_Header"></header><ul ng-if="$ctrl.datasetsExpanded && !$ctrl.groupService.isInGroupTransition && !$ctrl.isActiveWorkspaceReadOnly"><dataset-navigation-pane-list-item ng-repeat="model in $ctrl.datasets" ng-click="$ctrl.openModel(model)" view-model="::model" new-style="true" selected="model.dbName === $ctrl.currentObjectId || (navigation.inRowLevelSecurityView() && navigation.rowLevelSecurityModelId === model.id)"></dataset-navigation-pane-list-item><li localize="NavigationPane_NoDatasetText" localize-tooltip="NavigationPane_NoDatasetText" class="noItemText navPaneListItem" ng-if="$ctrl.datasets.length === 0"></li></ul></section>'),e.put("components/realTimeBlade/realTimeBlade.html",'<ng-form id="realTimeBlade" name="realTimeBladeForm" class="paneLayout"><header><h1 class="primaryHeading" localize="Realtime_AddStreamingDataTitle"></h1><h2 class="secondaryHeading" ng-bind="$ctrl.getBreadCrumb()"></h2></header><section class="banner" ng-if="$ctrl.stage === 0"><pbi-button label="ManageDatasets_AddStreamingDataset" class="wideButton" icon-name="add" primary="true" ng-click="$ctrl.navigateToManageDatasets(true)"></pbi-button></section><section class="contentContainer noPadding" ng-switch="$ctrl.stage"><section class="datasetsSelector" ng-switch-when="0"><h4 class="headerText" localize="Realtime_yourDatasets"></h4><ul class="datasetsList"><li class="dataset" ng-repeat="model in ::$ctrl.models" ng-class="{selected: $ctrl.selectedModel === model}" ng-click="$ctrl.selectModel(model)" ng-bind="::model.displayName" ng-attr-title="{{::model.displayName}}"></li></ul></section><real-time-tile-visualization-design tile="$ctrl.selectedTile" model="$ctrl.selectedModel" has-errors="$ctrl.hasVisualConfigError" ng-switch-when="1"></real-time-tile-visualization-design></section><section class="banner"><pbi-button label="Realtime_manageData" kind="text" ng-click="$ctrl.navigateToManageDatasets()"></pbi-button></section><footer><fieldset class="buttons"><pbi-button label="PBI_Button_Label_Back" ng-click="$ctrl.prev()"></pbi-button><pbi-button label="PBI_Button_Label_Next" primary="true" ng-click="$ctrl.next()" ng-disabled="realTimeBladeForm.$invalid || !$ctrl.nextValid()"></pbi-button><pbi-button label="PBI_Button_Label_Cancel" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></ng-form>'),e.put("components/realTimeTile/realTimeTile.html",'<div class="realTimeTile compositeTile" ng-class="{ fullLayout: $ctrl.viewModel.config.layoutType === 1 }"><div class="visualTile"><visual ng-if="!$ctrl.viewModel.isLoading && !$ctrl.viewModel.hideVisual" view-model="$ctrl.viewModel.visual" allow-deferred-rendering="::true"></visual></div></div>'),e.put("components/realTimeTileVisualizationDesign/realTimeTileVisualizationDesign.html",'<ng-form name="realTimeVisualizationForm"><section id="realTimeVisualization"><section class="visualSelector selectLabelBlock"><label localize="Realtime_VisualizationType"></label> <select ng-model="$ctrl.activeVisual" ng-options="supportedVisual as supportedVisual.title for supportedVisual in ::$ctrl.supportedVisualTypes" ng-change="$ctrl.onVisualChanged()"></select></section><section class="visualConfig"><ul class="tabs" ng-if="$ctrl.showCardFormattingOptions"><li class="tabHeader" ng-repeat="tab in ::$ctrl.tabs track by $index" ng-class="{active: $ctrl.activeTab.id === tab.id}" ng-click="$ctrl.activateTab(tab)"><i class="glyphicon glyph-small icon {{::tab.iconClass}}"></i></li></ul><section ng-show="!$ctrl.showCardFormattingOptions || $ctrl.activeTab.id === 0"><div class="selectLabelBlock errorBlock" ng-if="$ctrl.hasErrors"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="Realtime_RoleEntryError" localize-tooltip="Realtime_RoleEntryError"></div></div><div class="selectLabelBlock" ng-repeat="role in $ctrl.roleBuckets track by $index"><label ng-bind="role.displayName"></label><ul class="roleBuckets"><li class="roleEntryRow" ng-repeat="boundEntry in role.roleEntries track by $index"><div class="propertyContainer" ng-click="$ctrl.clickedEntry(boundEntry, role)"><selection-box class="item-fill" ng-class="{hasError: boundEntry.hasError}" items="role.roleProperties" selected-value="boundEntry.selectedProperty" on-select="$ctrl.onRoleBucketEntryChanged" allow-external-values="true"></selection-box><i class="glyphicon pbi-glyph-chevrondownmedium"></i></div> <button ng-click="$ctrl.deleteRoleProperty(boundEntry, role)" localize-tooltip="Realtime_deleteRoleEntry" ng-disabled="$ctrl.disableDeleteRolePropertyButton"><i class="glyphicon glyph-small icon pbi-glyph-delete"></i></button></li></ul> <button type="button" ng-click="$ctrl.addNewRoleProperty(role)" localize-tooltip="Realtime_addRoleEntry" ng-disabled="!$ctrl.enableAddMoreButton(role)" id="addNewRole"><i class="glyphicon glyph-small icon pbi-glyph-add"></i><span class="buttonText" localize="Realtime_AddValue"></span></button></div></section><section class="cardFormatBlock" ng-if="$ctrl.showCardFormattingOptions && $ctrl.activeTab.id === 1"><h3 localize="Realtime_DataLabel"></h3><div class="labeledRow"><label localize="Visual_DisplayUnits"></label> <select ng-model="$ctrl.config.displayUnit" ng-change="$ctrl.updateCardFormatting()" ng-model-options="{ debounce: 250 }" ng-options="displayUnit.displayName for displayUnit in ::$ctrl.displayUnits track by displayUnit.value"></select></div><div class="labeledRow"><label localize="Visual_Precision"></label> <input name="precision" ng-class="{hasError: realTimeVisualizationForm.precision.$touched && !realTimeVisualizationForm.precision.$valid}" ng-model="$ctrl.config.precision" ng-change="$ctrl.updateCardFormatting()" ng-model-options="{ debounce: 100 }" type="number" min="0" max="{{::$ctrl.maxPrecisionValue}}"/><div class="errorBlock" ng-if="realTimeVisualizationForm.precision.$touched && !realTimeVisualizationForm.precision.$valid"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="Realtime_InvalidPrecision" localize-tooltip="Realtime_InvalidPrecision"></div></div></div></section><section class="timeConfigBlock" ng-if="$ctrl.showTimeWindow"><h3 localize="Realtime_TimeWindowHeader"></h3><label localize="Realtime_TimeWindowSelectLabel"></label> <select class="optionBlock" ng-model="$ctrl.config.timeWindow" ng-change="$ctrl.updateRealTimeTile()" ng-model-options="{ debounce: 250 }" ng-options="time for time in ::$ctrl.times"></select> <select class="optionBlock" ng-model="$ctrl.config.timeWindowGranularityOption" ng-change="$ctrl.updateRealTimeTile()" ng-model-options="{ debounce: 250 }" ng-options="timeLabel.value for timeLabel in ::$ctrl.timeLabels track by timeLabel.timeWindow"></select></section></section></section></ng-form>'),e.put("components/recentlyViewedContainer/recentlyViewedContainer.html",'<div class="recentlyViewedContainer contentListView"><div class="dashboardControls"><search-box should-focus="::true" on-change="$ctrl.ensureSearchTelemetry()" on-blur="$ctrl.resolveSearchTelemetry()" filter="$ctrl.searchText" placeholder="SearchContent"></search-box></div><div class="contentListOptionsTabs unselectable"><div class="right"><span class="count" localize="ShowingXItems" localize-fragments><span fragment-index="0" ng-bind="$ctrl.filteredRecentlyUsedArtifacts.length"></span></span><select-tile-sort selected-predicate="$ctrl.sortPredicate" on-select="$ctrl.selectSort" predicates="$ctrl.sortPredicates"></select-tile-sort></div></div><div class="dashboardSliderMain"><water-mark-message config="$ctrl.watermarkConfig" ng-show="$ctrl.showWatermarkConfig"></water-mark-message><content-list-gallery view-model="::$ctrl.galleryViewModel" is-data-classification-enabled="$ctrl.dataClassificationEnabled"></content-list-gallery></div></div>'),e.put("components/relatedContentBlade/relatedContentBlade.html",'<div class="relatedContentBlade paneLayout"><header><div class="header"><h4 class="title" localize="PermissionCenter_RelatedContent"></h4><span class="subtitle" ng-bind="::$ctrl.viewModel.displayName"></span></div></header><section class="contentContainer"><div ng-if="$ctrl.viewModel.artifactType !== 0"><h4 localize="NavigationPane_Dashboards_Header"></h4><ul ng-if="$ctrl.hasItems($ctrl.dashboards)"><li class="item" ng-repeat="item in $ctrl.dashboards track by item.objectId"><a ng-click="$ctrl.openContent(item)" title="{{item.displayName}}"><span ng-bind="item.displayName"></span></a> <button class="shareBtn pbi-glyph-share" localize-tooltip="ContentListMenu_Share" ng-if="::$ctrl.canShare(item)" ng-click="$ctrl.shareContentTile(item)"></button> <button class="renameBtn pbi-glyph-settings" title="{{::$ctrl.tooltipForSettings(item.contentTileType)}}" ng-if="::$ctrl.canWriteTo(item)" ng-click="$ctrl.openSettings(item)"></button></li></ul><span class="empty" ng-if="!$ctrl.hasItems($ctrl.dashboards)" localize="RelatedContentBlade_NoRelated"></span></div><div ng-if="$ctrl.viewModel.artifactType !== 2"><h4 localize="NavigationPane_Reports_Header"></h4><ul ng-if="$ctrl.hasItems($ctrl.reports)"><li class="item" ng-repeat="item in $ctrl.reports track by item.objectId"><a ng-click="$ctrl.openContent(item)" title="{{item.displayName}}"><span ng-bind="item.displayName"></span></a> <button class="analyzeInExcel pbi-glyph-excel" localize-tooltip="ContentTileOptions_AnalyzeInExcel" ng-if="::$ctrl.canAnalyzeInExcel(item)" ng-click="$ctrl.analyzeInExcel(item)"></button> <button class="renameBtn pbi-glyph-settings" title="{{::$ctrl.tooltipForSettings(item.contentTileType)}}" ng-if="::$ctrl.canWriteTo(item)" ng-click="$ctrl.openSettings(item)"></button> <button class="insightsBtn pbi-glyph-insight" localize-tooltip="ContentTileOptions_GetInsights" ng-if="::$ctrl.canRunInsights(item)" ng-click="$ctrl.runInsights(item)"></button></li></ul><span class="empty" ng-if="!$ctrl.hasItems($ctrl.reports)" localize="RelatedContentBlade_NoRelated"></span></div><div ng-if="$ctrl.viewModel.artifactType !== 1 && !$ctrl.viewModel.readOnly"><h4 localize="NavigationPane_Datasets_Header"></h4><ul ng-if="$ctrl.hasItems($ctrl.models)"><li ng-repeat="model in $ctrl.models track by $index"><related-content-dataset-row view-model="model"></related-content-dataset-row></li></ul><span class="empty" ng-if="!$ctrl.hasItems($ctrl.models)" localize="RelatedContentBlade_NoRelated"></span></div></section><footer><fieldset class="buttons"> <button class="biButton" type="button" localize="PBI_Button_Label_Close" ng-click="$ctrl.close()"></button></fieldset></footer></div>'),e.put("components/relatedContentDatasetRow/relatedContentDatasetRow.html",'<div class="relatedContentDatasetRow"><div class="header"><span ng-bind="$ctrl.viewModel.displayName" title="{{$ctrl.viewModel.displayName}}"></span><content-dataset-actions view-model="$ctrl.viewModel" delete-enabled="false" view-related-enabled="false"></content-dataset-actions></div><div class="refresh"><dataset-icon-container view-model="::$ctrl.viewModel" can-show-new="false" refresh-related="true"></dataset-icon-container><span class="trimmedTextWithEllipsis" ng-bind="$ctrl.convertRefreshTimeToJsDateTime($ctrl.viewModel.contract.lastRefreshTime)"></span></div></div>'),e.put("components/selectArtifactFilter/selectArtifactFilter.html",'<select-button overlay-name="SelectArtifactFilter"><span localize="PermissionCenter_ViewAllContent" class="dropdownFontColor"></span></select-button><dropdown-overlay dropdown-overlay-name="SelectArtifactFilter" class="overlayTopBar"><dropdown-list class="topBar filters artifactFilter"><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Dashboard)"><div class="pbi-input"> <input id="dashboardCheckBoxInput" type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Dashboard)"/><label localize="ContentList_Dashboards" for="dashboardCheckBoxInput"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Report)"><div class="pbi-input"> <input id="reportCheckBoxInput" type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Report)"/><label localize="ContentList_Reports" for="reportCheckBoxInput"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Workbook)"><div class="pbi-input"> <input id="workbookCheckBoxInput" type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Workbook)"/><label localize="ContentList_Workbooks" for="workbookCheckBoxInput"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Dataset)"><div class="pbi-input"> <input id="datasetChecBoxInput" type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Dataset)"/><label localize="ContentList_Datasets" for="datasetChecBoxInput"></label></div></dropdown-list-item></dropdown-list></dropdown-overlay>'),e.put("components/selectButton/selectButton.html",'<div class="toggle" ng-mousedown="$ctrl.toggleDropdown($event)"><ng-transclude class="title"></ng-transclude><span class="glyphicon glyph-mini anchorContainer" ng-class="$ctrl.dropdownOpen ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"><span class="js-anchor anchor"></span></span></div>'),e.put("components/selectDatasetDialog/selectDatasetDialog.html",'<dialog-frame><dialog-header><span localize="$ctrl.titleLabel"></span></dialog-header><dialog-body><label class="description" localize="$ctrl.descriptionLabel"></label><search-box filter="$ctrl.searchString" on-change="$ctrl.onSearchStringChanged()"></search-box><label class="error" ng-if="!$ctrl.hasModels" localize="NavigationPane_NoDatasetText"></label><div class="content" ng-if="$ctrl.hasModels"><label class="error" ng-if="$ctrl.tableConfig.filteredData.length === 0" localize="NavigationPane_NoDatasetSearchResultText"></label><table pbi-table pbi-table-config="$ctrl.tableConfig" ng-if="$ctrl.tableConfig.filteredData.length> 0"><tr ng-repeat="model in $ctrl.tableConfig.filteredData track by model.id" ng-click="$ctrl.selectModel(model)" ng-keydown="$ctrl.itemKeydown($event, model)" ng-class="{selected: $ctrl.selectedDataset.id === model.id}" tabindex="0"><td ng-bind="::model.displayName" title="{{::model.displayName}}" localized-header="CreateReport_Header_Name" sort-by="displayName"></td><td ng-bind="::$ctrl.getLastRefreshDate(model)" title="{{::$ctrl.getLastRefreshDate(model)}}" localized-header="CreateReport_Header_LastRefreshed" sort-by="lastRefreshEpochTime"></td></tr></table></div></dialog-body><dialog-footer><a href="" class="importDataset" localize="CreateReport_ImportNewDataset" ng-click="$ctrl.importDataset()"></a> <button type="submit" ng-click="$ctrl.confirm()" class="primary" ng-disabled="!$ctrl.selectedDataset" localize="$ctrl.confirmLabel"></button> <button ng-click="$ctrl.cancel()" localize="$ctrl.cancelLabel"></button></dialog-footer></dialog-frame>'),e.put("components/selectDatasetDialog/selectDatasetDialogDefinition.html",'<select-dataset-dialog title-label="titleLabel" description-label="descriptionLabel" confirm-label="confirmLabel" cancel-label="cancelLabel" models="models"></select-dataset-dialog>'),e.put("components/selectTileFilter/selectTileFilter.html",'<select-button overlay-name="SelectTileFilter"><span localize="Filters"></span></select-button><dropdown-overlay dropdown-overlay-name="SelectTileFilter" class="overlayTopBar"><dropdown-list class="topBar filters"><span class="dropdownListHeader" localize="FilterContent"></span><dropdown-list-item ng-click="$ctrl.selectOwner()($ctrl.OwnerAll)"><div class="pbi-input"> <input type="radio" ng-checked="$ctrl.isSelectedOwner($ctrl.OwnerAll)"/><label class="form-label" localize="NavigationPane_OwnershipFilterAllContent"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectOwner()($ctrl.OwnerMine)"><div class="pbi-input"> <input type="radio" ng-checked="$ctrl.isSelectedOwner($ctrl.OwnerMine)"/><label class="form-label" localize="NavigationPane_OwnershipFilterMyContent"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectOwner()($ctrl.OwnerShared)"><div class="pbi-input"> <input type="radio" ng-checked="$ctrl.isSelectedOwner($ctrl.OwnerShared)"/><label class="form-label" localize="NavigationPane_OwnershipFilterSharedWithMe"></label></div></dropdown-list-item><hr><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Dashboard)"><div class="pbi-input"> <input type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Dashboard)"/><label localize="ContentList_Dashboards"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Report)"><div class="pbi-input"> <input type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Report)"/><label localize="ContentList_Reports"></label></div></dropdown-list-item><dropdown-list-item ng-click="$ctrl.selectType()($ctrl.Workbook)"><div class="pbi-input"> <input type="checkbox" ng-checked="$ctrl.isSelectedType($ctrl.Workbook)"/><label localize="ContentList_Workbooks"></label></div></dropdown-list-item></dropdown-list></dropdown-overlay>'),e.put("components/selectTileSort/selectTileSort.html",'<select-button overlay-name="SelectTileSort""><span ng-bind="$ctrl.title"></span></select-button><dropdown-overlay dropdown-overlay-name="SelectTileSort" class="overlayTopBar"><dropdown-list class="topBar sort"><span class="dropdownListHeader" localize="SortBy"></span><dropdown-list-item ng-repeat="item in $ctrl.dropdownItems track by item.predicate.toAngularFilter()" ng-class="{selected: $ctrl.isSelected(item.predicate)}" ng-click="$ctrl.select(item.predicate)" ng-bind="item.title"></dropdown-list-item></dropdown-list></dropdown-overlay>'),e.put("components/settingsAlerts/settingsAlertsView.html",'<div class="alertsSettings"><div ng-repeat="group in ::$ctrl.viewModel track by $index"><section class="group"><div class="groupTitle" ng-bind="group.title"></div><table><thead><tr><th ng-repeat="column in $ctrl.columns track by $index" ng-class="column.predicateName" ng-click="$ctrl.order(group, column.predicateName)"> <button><span ng-bind="column.displayName"></span><span class="sortChevron" ng-if="group.sortPredicate === column.predicateName"><i class="glyphicon pbi-glyph-chevrondownmedium glyph-micro" ng-show="group.reverse"></i><i class="glyphicon pbi-glyph-chevronupmedium glyph-micro" ng-hide="group.reverse"></i></span></button></th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="alert in group.alerts | orderBy:group.sortPredicate:group.reverse track by $index"><td class="dataCell" ng-bind="alert.alertTitle"></td><td class="dataCell" ng-bind="alert.dashboardName"></td><td class="dataCell" ng-bind="alert.alertCreatedDate"></td><td class="actions"><pbi-toggle class="toggleAction" no-label ng-model="alert.enabled" on-state-text="AlertsPane_ToggleOn" off-state-text="AlertsPane_ToggleOff" ng-change="$ctrl.toggleAlert(alert)"></pbi-toggle><span class="editAction" ng-click="$ctrl.editAlert(alert)" localize="AlertsSettings_AlertEdit"></span><span class="deleteAction" ng-click="$ctrl.deleteAlert(alert)" localize="AlertsSettings_AlertDelete"></span></td></tr></tbody></table></section></div></div>'),e.put("components/settingsBlade/settingsBlade.html",'<ng-form name="settingsForm"><div class="settingsBlade paneLayout"><header><h3 class="primaryHeading trimmedTextWithEllipsis" ng-bind="::$ctrl.artifactName" title="{{::$ctrl.artifactName}}"></h3></header><section class="contentContainer"><div class="ownerInfo info trimmedTextWithEllipsis" ng-if="$ctrl.isSettingsPane"><span class="details" localize="SettingsBlade_OwnerInfo"></span><span class="details" ng-bind="::$ctrl.ownerInfo" title="{{::$ctrl.ownerInfo}}"></span><span class="details" localize="SettingsBlade_OwnerInfoSeparator"/><a class="infoMail" ng-if="$ctrl.ownerMail" href="mailto:{{$ctrl.ownerMail}}"><span ng-bind="$ctrl.ownerMail" title="{{::$ctrl.ownerMail}}"></span></a></div><div class="modelNameText info" ng-bind="::$ctrl.artifactLabel"></div><div class="info"> <input class="nameInput" type="text" ng-model="$ctrl.artifact.displayName" spellcheck="false" autofocus="autofocus" maxlength="250"/></div><ng-form name="dashboardSettingsForm"><section class="info" ng-if="$ctrl.isSettingsPane"><settings-dashboard-blade view-model="$ctrl.artifact" dashboard-settings-form="dashboardSettingsForm"></settings-dashboard-blade></section></ng-form><div class="workbookSettings metadata info" ng-if="$ctrl.isWorkbook"><settings-workbook-blade view-model="$ctrl.artifact"></settings-workbook-blade></div></section><footer><fieldset class="buttons"><div ng-show="$ctrl.isSaving" class="spinnerWithText"><spinner></spinner><div localize="GroupEditor_WaitForSave"></div></div> <button class="biButton primary" type="button" ng-disabled="$ctrl.isDisabled()" ng-click="$ctrl.saveModelName($ctrl.artifact.displayName)" localize="SettingsBlade_Save"></button> <button class="biButton" type="button" localize="SettingsBlade_Cancel" ng-click="$ctrl.cancel()"></button></fieldset></footer></div></ng-form>'),e.put("components/settingsCommunications/settingsCommunications.html",'<section class="settingsDatasets"><settings-subscriptions view-model="$ctrl.viewModel.settingsSubscriptionsModel"></settings-subscriptions></section>'),e.put("components/settingsDashboardBlade/settingsDashboardBlade.html",'<form name="$ctrl.dashboardSettingsForm"><section class="dashboardSettingsQnA"><div class="qnaSection title" localize="SettingsDashboard_QnA_Title"/><div class="toggleButton"> <span class="qnaToggle"><input type="checkbox" ng-model="qnaEnabled" ng-change="$ctrl.setQnADirty()" title="{{$ctrl.qnaTooltip(qnaEnabled)}}"/><span class="toggleBox"></span><span class="toggleHandle"></span></span></div><div class="qnaSection info" localize="SettingsDashboard_QnA_Info1"/><div class="qnaSection info"><a href="https://go.microsoft.com/fwlink/?LinkId=808174" target="_blank" localize="LearnMore"/></div><div class="qnaSection warning" ng-if="$ctrl.isQnaDirty && qnaEnabled && !$ctrl.settingsDashboardModel.hasQnaSupportedModel"><i class="glyphicon pbi-glyph-warning glyph-small alertWarning"/><span localize="SettingsDashboard_QnA_QnaUnavailableWarning"/></div></section><section class="dashboardSettingsGravity"><div class="gravitySection title" localize="SettingsDashboard_Gravity_Title"/><div class="toggleButton"> <span class="gravityToggle"><input type="checkbox" ng-model="gravityEnabled" title="{{$ctrl.gravityTooltip(gravityEnabled)}}"/><span class="toggleBox"></span><span class="toggleHandle"></span></span></div><div class="gravitySection info" localize="SettingsDashboard_Gravity_GravityNoticeMessage"/></section><section class="dashboardSettingsDataClassification" ng-hide="!dataClassifications || dataClassifications.length==0"><div class="title" localize="SettingsDashboard_DataClassification_Title"></div> <select ng-options="option.id as option.name for option in dataClassifications" ng-model="dataClassificationId" ng-change="onDataClassificationIdChanged()"></select><div class="inlineWarning" ng-show="isNonDefaultDataClassificationSelected"><div class="message"><span class="glyphicon glyph-small pbi-glyph-info"></span><span localize="SettingsDashboard_DataClassification_NoDefaultChoosed"></span><span class="defaultDataClassificationOption">{{defaultDataClassification.name}}</span></div></div></section></form>'),
e.put("components/settingsPreviewFeatures/settingsPreviewFeatures.html",'<div class="dashboardSettings previewFeaturesSettings"><h class="dashboardSettingsTitle" localize="Settings_PreviewFeaturesSettings"></h><div class="dashboardSettingsSection"><div class="dashboardSettingsSectionTitle trimmedTextWithEllipsis" localize="Settings_PreviewFeatures_Navigation_New"></div><div localize="Settings_PreviewFeatures_Navigation_Description_New"></div><a target="_blank" href="https://go.microsoft.com/fwlink/?linkid=833187" localize="LearnMore"></a><div class="settingsControls"><div class="pbi-input"> <input type="radio" ng-model="$ctrl.previewModel" ng-value="true"/><label class="form-label" localize="ToggleSwitchOn"></label></div><div class="pbi-input"> <input type="radio" ng-model="$ctrl.previewModel" ng-value="false"/><label class="form-label" localize="ToggleSwitchOff"></label></div></div></div><div class="dashboardSettingsSection"> <button class="primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="$ctrl.isClean()" ng-click="$ctrl.applyChanges()"/> <button localize="SettingsDataset_DiscardButtonText" ng-disabled="$ctrl.isClean()" ng-click="$ctrl.discardChanges()"/></div></div>'),e.put("components/settingsSubscriptions/settingsSubscriptions.html",'<section class="dashboardSettings subscriptionSettings" ng-cloak ng-if="$ctrl.viewModel.subscriptions.length> 0"><span class="dashboardSettingsSectionTitle" ng-bind="::$ctrl.viewModel.workspaceName"/><table><thead><tr><th class="empty"></th><th ng-repeat="column in $ctrl.viewModel.columnsHeader track by $index" ng-class="column.predicateName" ng-click="$ctrl.sort(column.predicateName)"><div class="tableHeader"><span ng-bind="column.displayName"></span><span class="sortChevron" ng-if="$ctrl.sortType == column.predicateName && column.allowSorting"><i class="glyphicon pbi-glyph-chevrondownmedium glyph-micro" ng-if="!$ctrl.sortReverse"></i><i class="glyphicon pbi-glyph-chevronupmedium glyph-micro" ng-if="$ctrl.sortReverse"></i></span></div></th><th class="actions"></th></tr></thead><tbody><tr ng-repeat="subscription in $ctrl.viewModel.subscriptions"><td class="artifactImg" ng-class="::subscription.dashboardInfo && \'dashboardImg\'"><span ng-if="::subscription.reportInfo" class="tileTypeIndicator glyphicon pbi-glyph-barchart glyph-small" localize-tooltip="Artifact_Report"></span><span ng-if="::subscription.dashboardInfo" class="tileTypeIndicator glyphicon pbi-glyph-gauge glyph-small" localize-tooltip="Artifact_Dashboard"></span></td><td><div class="dataCell" tooltip tooltip-config="$ctrl.getTooltipConfig(subscription)" ng-bind="$ctrl.getArtifactDisplayName(subscription)"></div></td><td class="actions"><div class="bodyColumn"><div class="menuBtn" localize-tooltip="ContentTileOptions_EditWorkbooks" ng-click="$ctrl.editSubscription(subscription)"><i class="glyphicon pbi-glyph-edit glyph-small"></i></div></div></td><td class="dataCell" ng-bind="$ctrl.getSubscriptionsCount(subscription)"></td></tr></tbody></table></section><water-mark-message config="::$ctrl.getWaterMarkConfig()" ng-if="!$ctrl.isLoading && !$ctrl.viewModel.subscriptions.length">'),e.put("components/settingsWorkbookBlade/settingsWorkbookBlade.html",'<section class="workbookSettingsPane"><div ng-repeat="metadata in $ctrl.model.metadata" class="metadata" ng-switch="metadata.type"><h6 class="metadataLabel" ng-if="metadata.label" ng-bind="metadata.label" ng-class="{\'divider\': !$first}"></h6><div class="metadataContent" ng-class="{\'noLabel\': !metadata.label}" ng-switch-when="0"><span class="message trimmedTextWithEllipsis" ng-bind="metadata.value()"></span><span ng-if="metadata.infoTooltipConfig" class="glyphicon glyph-mini pbi-glyph-info tooltipIcon" tooltip tooltip-config="::metadata.infoTooltipConfig"></span></div><div class="metadataContent" ng-class="{\'noLabel\': !metadata.label}" ng-switch-when="2"> <span>{{ metadata.value() }}</span> <a ng-bind-attr="{href: metadata.linkUrl(), title: metadata.linkTitle() || metadata.linkText(), target: metadata.linkTarget}">{{ metadata.linkText() }}</a></div><div class="metadataContent" ng-class="{\'noLabel\': !metadata.label}" ng-switch-when="3"><span class="refreshFlyoutWarning" ng-if="metadata.isWarning == true"><i class="glyphicon pbi-glyph-error glyph-mini"></i></span> <a class="refreshHistory" href="" ng-click="metadata.actionOnClick()">{{metadata.value()}}</a></div><div class="metadataContent" ng-class="{\'noLabel\': !metadata.label}" ng-switch-when="4"><div ng-switch="metadata.status"><div ng-switch-when="0"><span class="glyphicon glyph-small pbi-glyph-error statusIcon"></span><span class="statusText" ng-bind="metadata.value"></span></div><div ng-switch-when="1"><span class="glyphicon glyph-small pbi-glyph-success glyph-success-color statusIcon"></span><span class="statusText" ng-bind="metadata.value"></span></div></div></div></div></section>'),e.put("components/sharedByColumn/sharedByColumn.html",'<section class="contentHeaderContainer unselectable"><header class="name trimmedTextWithEllipsis" localize="ContentHeader_Owner"></header></section><div class="unselectable listContainer" vs-repeat><div ng-repeat="ownerInfo in $ctrl.ownerInfos track by ownerInfo.objectId" class="listItemWrapper"><div class="listItem" ng-class="{selected: $ctrl.selectedOwner === ownerInfo.objectId}" ng-click="$ctrl.onSelectedOwnerChanged({selectedOwner: ownerInfo.objectId})"><div class="icon" ng-switch="!!ownerInfo.icon"><i ng-switch-when="false" class="glyphicon glyph-small placeholder" ng-class="ownerInfo.isUser() ? \'pbi-glyph-user\' : \'pbi-glyph-group\'"></i> <img ng-switch-when="true" ng-src="{{ownerInfo.icon}}"/></div><div class="text trimmedTextWithEllipsis" ng-bind="::ownerInfo.name" title="{{::ownerInfo.name}}"></div></div></div></div><spinner ng-if="$ctrl.showSpinner" class="large"></spinner>'),e.put("components/sharedWithMeContainer/sharedWithMeContainer.html",'<div class="contentListView onlySharedWithMe" ng-class="{\'initializing\': !$ctrl.initialized}"><div class="header"></div><div class="dashboardControls"><search-box should-focus="::true" on-change="$ctrl.onSearchTextChange()" on-blur="$ctrl.resolveSearchTelemetry()" filter="$ctrl.searchText" placeholder="SearchContent"></search-box></div><div class="contentListOptionsTabs unselectable"><div class="left"><div class="optionTab dashboard label-med" ng-class="{hasNoResults: !$ctrl.hasResults}"></div></div><div class="right"><span class="count" localize="ShowingXItems" localize-fragments><span fragment-index="0" ng-bind="$ctrl.getNumberOfShownTabItems()"></span></span><select-tile-sort selected-predicate="$ctrl.sortPredicate" on-select="$ctrl.onSortPredicateChanged" predicates="$ctrl.sortPredicates"></select-tile-sort></div></div><div class="dashboardSliderMain"><spinner ng-if="$ctrl.showSpinner" class="large centered"></spinner><water-mark-message config="$ctrl.getWatermarkConfig()" ng-if="$ctrl.shouldShowWatermark()"></water-mark-message><shared-by-column ng-if="!$ctrl.showSpinner" shared-dashboards="$ctrl.sharedDashboardsPrefiltered" selected-owner="$ctrl.selectedSharedByOwner" on-selected-owner-changed="$ctrl.onSelectedOwnerChanged(selectedOwner)"></shared-by-column><content-list-gallery ng-if="!$ctrl.showSpinner" view-model="::$ctrl.galleryViewModel" is-data-classification-enabled="$ctrl.dataClassificationEnabled"></content-list-gallery></div></div>'),e.put("components/streamingDataset/pubNubEditor/pubNubEditor.html",'<form name="pubNubForm" class="streamingDatasetForm"><div class="streamingDataset pubNubEditor paneLayout"><header><h3 class="primaryHeading" localize="StreamingDatasetEditor_NewDataset"></h3></header><div class="contentContainer"><section class="contentHeader" localize="StreamingDatasetEditor_PubNub_Header" localize-fragments><a fragment-index="0" localize="StreamingDatasetEditor_PubNub_LearnMore" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=821989"></a></section><label class="input-field-label required" localize="StreamingDatasetEditor_DatasetName"></label> <input type="text" name="name" autocomplete="off" ng-class="{hasError: streamingDatasetForm.name.$invalid && streamingDatasetForm.name.$touched}" ng-model="$ctrl.realTimeModel.definition.name" required/><div class="errorBlock" ng-if="pubNubForm.name.$invalid && pubNubForm.name.$touched"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="StreamingDatasetEditor_NameRequired"></div></div><label class="input-field-label required" localize="StreamingDataset_PubNub_SubscriptionKey"></label> <input type="text" name="subscriptionKey" autocomplete="off" ng-class="{hasError: pubNubForm.subscriptionKey.$invalid && pubNubForm.subscriptionKey.$touched}" ng-model="$ctrl.viewModel.subscriptionKey" required/><div class="errorBlock" ng-if="pubNubForm.subscriptionKey.$invalid && pubNubForm.subscriptionKey.$touched"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="StreamingDataset_PubNub_SubscriptionKeyRequired"></div></div><label class="input-field-label required" localize="StreamingDataset_PubNub_ChannelName"></label> <input type="text" name="channelName" autocomplete="off" ng-class="{hasError: pubNubForm.channelName.$invalid && pubNubForm.channelName.$touched}" ng-model="$ctrl.viewModel.channelName" required/><div class="errorBlock" ng-if="pubNubForm.channelName.$invalid && pubNubForm.channelName.$touched"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="StreamingDataset_PubNub_ChannelNameRequired"></div></div><label class="input-field-label" localize="StreamingDataset_PubNub_PAMKey"></label> <input type="password" autocomplete="off" ng-model="$ctrl.viewModel.authKey"/><div class="alertBlock" ng-if="$ctrl.viewModel.authKey"><i class="glyphicon glyph-small pbi-glyph-securityalert"></i><div class="message" localize="StreamingDataset_PubNub_AuthKeyWarning"></div></div></div><footer><fieldset class="buttons"><pbi-button label="Back_ButtonText" ng-click="$ctrl.back()"></pbi-button><pbi-button label="Next_ButtonText" primary="true" ng-click="$ctrl.next()" ng-disabled="pubNubForm.$invalid"></pbi-button><pbi-button label="Cancel_ButtonText" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></div></form>'),e.put("components/streamingDataset/streamingDataSample/streamingDataSample.html",'<div class="streamingDataSample"><section class="tabs" ng-if="::$ctrl.showHeader"><span class="tabHeader" ng-repeat="example in ::$ctrl.apiExamples" ng-class="{selected: $ctrl.activeExample.id === example.id}" ng-click="$ctrl.showExample(example)" ng-bind="::example.title"></span></section><section class="exampleView" ng-if="$ctrl.hasColumns()" ng-switch="$ctrl.activeExample.id"><section ng-switch-when="1" select-text-on-click><div> [</div><div class="padLeft"> {</div><div class="streamingDataValue" ng-repeat="column in $ctrl.viewModel.columns | filter:{name: \'\'} track by $index"> <span class="columnName">"{{$ctrl.escapeCharacters(column.name)}}"</span> <span class="operator padRight">:</span><span ng-bind="$ctrl.mockValues[column.dataType]"></span><span class="operator" ng-bind="$last ? \'\' : \',\'"></span></div><div class="padLeft"> }</div><div> ]</div></section><section ng-switch-when="2" select-text-on-click><div class="codeBlock tight"> <span class="keyword">curl</span> <span class="flag">--include</span> <span class="operator">\\</span></div><div class="codeBlock tight"> <span class="flag">--request</span> POST <span class="operator">\\</span></div><div class="codeBlock tight"> <span class="flag">--header</span> <span class="string">"Content-Type: application/json"</span> <span class="operator">\\</span></div><div class="codeBlock tight"> <span class="flag">--data-binary</span> "[</div><div class="padLeft"> {</div><div class="streamingDataValue" ng-repeat="column in ::$ctrl.viewModel.columns | filter:{name: \'\'} track by $index"> <span class="columnName">\\"{{::$ctrl.escapeCharacters(column.name)}}\\"</span> <span class="operator padRight">:</span><span ng-bind="::$ctrl.escapeCharacters($ctrl.mockValues[column.dataType])"></span><span class="operator" ng-bind="$last ? \'\' : \',\'"></span></div> <span class="padLeft">}</span><div class="codeBlock tight"> ]" <span class="operator">\\</span></div><div class="string codeBlock">"{{::$ctrl.url()}}"</div></section><section ng-switch-when="3" select-text-on-click><div class="codeBlock"> <span class="identifier">$endpoint</span> <span class="operator">=</span> <span class="string">"{{::$ctrl.url()}}"</span></div><div class="codeBlock"> <span class="identifier">$payload</span> <span class="operator">=</span> <span>@{</span><div class="streamingDataValue" ng-repeat="column in ::$ctrl.viewModel.columns | filter:{name: \'\'} track by $index"> <span class="columnName">"{{::$ctrl.escapeCharacters(column.name)}}"</span> <span class="padRight operator">=</span><span ng-bind="::$ctrl.mockValues[column.dataType]"></span></div> }</div><div class="codeBlock"> <span class="keyword">Invoke-RestMethod</span> <span class="flag">-Method</span> Post <span class="flag">-Uri</span> "$endpoint" <span class="flag">-Body</span> <span>(<span class="keyword">ConvertTo-Json</span> <span class="identifier">@($payload)</span>)</span></div></section></section></div>'),e.put("components/streamingDataset/streamingDatasetEditor/streamingDatasetEditor.html",'<form name="streamingDatasetForm" custom-validator-synchronizer class="streamingDatasetForm"><div class="streamingDataset streamingDatasetEditor paneLayout"><header><spinner ng-if="$ctrl.isLoading"></spinner><h3 class="primaryHeading" ng-bind="$ctrl.header"></h3></header><fieldset class="contentContainer" ng-disabled="$ctrl.isLoading"><section class="contentHeader" localize="StreamingDatasetEditor_Push_Header" localize-fragments ng-if="$ctrl.historicalAnalysisEnabled"><a fragment-index="0" localize="StreamingDatasetEditor_Push_LearnMore" target="_blank" href="https://go.microsoft.com/fwlink/?linkid=822594"></a></section><section class="warning" ng-if="!!$ctrl.warningText"><i class="glyphicon pbi-glyph-warning glyph-small"></i><div>{{::$ctrl.warningText}}</div></section><label class="input-field-label required" localize="StreamingDatasetEditor_DatasetName"></label> <input type="text" name="name" autocomplete="off" ng-class="{hasError: streamingDatasetForm.name.$invalid && streamingDatasetForm.name.$touched}" ng-model="$ctrl.viewModel.definition.name" placeholder="{{::$ctrl.namePlaceholder}}" required/><div class="errorBlock" ng-if="streamingDatasetForm.name.$invalid && streamingDatasetForm.name.$touched"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="StreamingDatasetEditor_NameRequired" localize-tooltip="StreamingDatasetEditor_NameRequired"></div></div><label class="input-field-label required" localize="StreamingDatasetEditor_Values"></label><ng-form class="streamValue" name="streamValueForm" ng-repeat="column in $ctrl.viewModel.definition.columns track by $index"> <input type="text" name="name" autocomplete="off" placeholder="{{::$ctrl.columnPlaceholder}}" ng-change="$ctrl.columnUpdated($last)" ng-class="{hasError: streamValueForm.name.$invalid}" ng-model="column.name" ng-required="!$last" custom-validator="{validate: $ctrl.validateColumnName}"/> <select class="rowContent" ng-model="column.dataType" ng-options="type.value as type.displayName for type in ::$ctrl.dataTypes"></select><i class="glyphicon pbi-glyph-delete glyph-small icon" ng-if="!$last" ng-click="$ctrl.removeColumn(column);streamingDatasetForm.$setDirty();"></i><div class="errorBlock" ng-if="streamValueForm.name.$invalid"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="StreamingDatasetEditor_ColumnNameError" localize-tooltip="StreamingDatasetEditor_ColumnNameError"></div></div></ng-form><streaming-data-sample view-model="$ctrl.viewModel.definition" show-header="false"></streaming-data-sample><div ng-if="$ctrl.historicalAnalysisEnabled"><label class="input-field-label" localize="StreamingDatasetEditor_HistoricDataAnalysis"></label><div class="toggleButton"> <input type="checkbox" ng-model="$ctrl.viewModel.definition.mode" ng-false-value="{{$ctrl.realTimeMode.CacheOnly}}" ng-true-value="{{$ctrl.realTimeMode.PersistAndCache}}"/><span class="toggleBox"></span><span class="toggleHandle"></span><span class="toggleDescription unselectable" ng-bind="$ctrl.toggleStateText"></span></div></div></fieldset><footer><fieldset class="buttons"><pbi-button label="Back_ButtonText" ng-click="$ctrl.back()" ng-disabled="$ctrl.isLoading" ng-if="$ctrl.from != 0"></pbi-button><pbi-button label="{{$ctrl.buttonText}}" primary="true" ng-click="$ctrl.save()" ng-disabled="!streamingDatasetForm.$dirty || streamingDatasetForm.$invalid || !$ctrl.canSave"></pbi-button><pbi-button label="Cancel_ButtonText" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></div></form>'),e.put("components/streamingDataset/streamingDatasetGallery/streamingDatasetGallery.html",'<div class="streamingDataset streamingDatasetGallery paneLayout"><header><h3 class="primaryHeading" localize="StreamingDatasetEditor_NewDataset"></h3><h3 class="secondaryHeading" localize="StreamingDataset_ChooseSource"></h3></header><div class="contentContainer"><ul><li class="streamingDatasetOption unselectable {{option.cssClass}}" ng-class="{selected: $ctrl.selectedOption === option}" ng-repeat="option in ::$ctrl.streamingDatasetOptions | orderBy: \'displayName\'" ng-click="$ctrl.selectOption(option)"><div class="logo"></div><div class="name" ng-bind="::option.displayName"></div></li></ul><aside class="callout_box" ng-if="$ctrl.isLinkTypeSelected()" localize="StreamingDataset_ASAHelpText" localize-fragments><a fragment-index="0" ng-attr-href="{{$ctrl.selectedOption.link}}" target="_blank" localize="StreamingDataset_AzureStreamAnalytics"></a></aside></div><footer><fieldset class="buttons"><pbi-button label="Next_ButtonText" primary="true" ng-click="$ctrl.next()" ng-disabled="$ctrl.isLinkTypeSelected()"></pbi-button><pbi-button label="Cancel_ButtonText" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer></div>'),e.put("components/streamingDataset/streamingDatasetPushInfo/streamingDatasetPushInfo.html",'<div class="streamingDatasetPushInfo streamingDataset paneLayout"><header ng-switch="!!$ctrl.viewModel.isNew"><h1 class="primaryHeading trimmedTextWithEllipsis" ng-switch-when="true"><i class="glyphicon pbi-glyph-circled-checkmark glyph-med"></i><span class="createdHeading" localize="StreamingDatasetPushInfo_Created"></span></h1><h1 class="primaryHeading trimmedTextWithEllipsis" ng-if="$ctrl.viewModel" ng-switch-when="false" localize="StreamingDatasetPushInfo_APIInfo" localize-fragments><span fragment-index="0" ng-bind="::$ctrl.viewModel.definition.name" ng-attr-title="{{::$ctrl.viewModel.definition.name}}"></span></h1><h2 class="secondaryHeading" ng-if="$ctrl.viewModel" ng-switch-when="false" localize="StreamingDatasetPushInfo_APIHowTo" localize-fragments><a fragment-index="0" href="https://dev.powerbi.com" target="_blank" localize="StreamingDatasetPushInfo_APIHowToLinkText"></a></h2><spinner ng-if="!$ctrl.viewModel"></spinner></header><section class="contentContainer noPadding" ng-class="{isNew: $ctrl.viewModel.isNew}"><section class="sampleHeader"><div class="datasetInfo"><div ng-if="$ctrl.viewModel.isNew" localize="StreamingDatasetPushInfo_SchemaCreated" localize-fragments><span fragment-index="0" ng-bind="::$ctrl.viewModel.definition.name"></span></div></div><label class="input-field-label" localize="StreamingDatasetPushInfo_PushURL"></label> <input type="text" ng-disabled="!$ctrl.viewModel" ng-value="::$ctrl.viewModel.getPushUrl()" readonly="true" onclick="this.select()"/></section><streaming-data-sample view-model="$ctrl.viewModel.definition" url="$ctrl.viewModel.getPushUrl()" show-header="true"></streaming-data-sample></section><footer><fieldset class="buttons"><pbi-button label="Done_ButtonText" primary="true" ng-click="$ctrl.close()"></pbi-button></fieldset></footer></div>'),e.put("components/subscriptionPane/subscriptionPane.html",'<div class="paneLayout subscriptionPane"><header><div class="subscriptionPaneHeader"><h4 class="subscriptionPaneSubtitle" ng-if="!$ctrl.isLoading" title="{{::$ctrl.getSubscriptionSubtitle()}}" ng-bind="::$ctrl.getSubscriptionSubtitle()"></h4><h4 class="subscriptionPaneTitle" localize="EmailSnapshot_Title"></h4></div></header><section class="banner" ng-if="!$ctrl.isLoading"><pbi-button label="EmailSnapshot_AddSubscription" icon-name="add" primary="true" class="wideButton" ng-click="$ctrl.addNewSubscription()" ng-if="::$ctrl.canAddSubscription()"></pbi-button><pbi-alert class="alertmessage" kind="\'info\'" message-info="\'EmailSnapshot_OneSubscription\'" ng-if="::!$ctrl.canAddSubscription()"/></section><section class="contentContainer" ng-if="!$ctrl.isLoading"><form name="$ctrl.subscriptionForm" class="subscriptionForm"><div class="subscription" ng-repeat="subscription in $ctrl.getCurrentSubscriptions() track by $index"><section class="formHeader"><i ng-if="!$ctrl.isSubscriptionDeleted(subscription)" class="glyphicon glyph-mini expand" ng-click="subscription.expanded = !subscription.expanded" ng-class="subscription.expanded ? \'pbi-glyph-chevronupmedium\' : \'pbi-glyph-chevrondownmedium\'"></i><div class="title" ng-bind="$ctrl.getSubscriptionName(subscription)" title="{{$ctrl.getSubscriptionName(subscription)}}"></div><div class="draft" ng-if="$ctrl.isDraftSubscription(subscription)" localize="EmailSnapshot_Draft"></div><i ng-if="!$ctrl.isSubscriptionDeleted(subscription)" class="subscriptionDelete glyphicon glyph-small pbi-glyph-delete" ng-click="$ctrl.removeSubscription(subscription)" localize-tooltip="Delete_ToolTip"></i><pbi-toggle ng-if="!$ctrl.isSubscriptionDeleted(subscription)" on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff" ng-model="subscription.enabled" ng-change="$ctrl.changeSubscriptionToUpdatedState(subscription)" class="toggle"></pbi-toggle><div ng-if="$ctrl.isSubscriptionDeleted(subscription)" ng-click="$ctrl.undoRemoveSubscription(subscription)" class="undo"><div localize="EmailSnapshot_Undo" class="text"></div><i class="glyphicon pbi-glyph-undo icon"></i></div></section><section ng-if="subscription.expanded && !$ctrl.isSubscriptionDeleted(subscription)"><fieldset class="reportPageSettings" ng-if="$ctrl.isReportSubscription()"><legend localize="EmailSnapshot_Report_Page" localize-tooltip></legend> <select class="reportPage" ng-model="subscription.selectedSlide" ng-change="$ctrl.changeSubscriptionToUpdatedState(subscription)" ng-options="slide as slide.displayName for slide in ::$ctrl.viewModel.report.slides track by slide.id"/></fieldset><fieldset class="frequencySettings" ng-if="$ctrl.canShowSchedule()"><legend localize="EmailSnapshot_Frequency" localize-tooltip></legend> <select class="frequency" ng-model="subscription.selectedFrequency" ng-change="$ctrl.changeSubscriptionToUpdatedState(subscription)" ng-options="freq.frequencyType as freq.label for freq in ::$ctrl.getAllowedFrequencies()"/></fieldset><pbi-alert class="alertmessage" kind="\'info\'" message-info="\'EmailSnapshot_Message\'" ng-if="!$ctrl.canShowSchedule()"/></section></div></form></section><fieldset class="message" ng-if="!$ctrl.isLoading"><a class="link" ng-bind="::$ctrl.viewModel.editMessage" ng-click="$ctrl.navigate()"></a></fieldset><footer ng-if="!$ctrl.isLoading"><fieldset class="buttons"><spinner modern ng-if="$ctrl.isUpdating"></spinner><pbi-button primary="true" label="EmailSnapshot_Save" ng-click="$ctrl.saveChangesAndExit()"></pbi-button><pbi-button label="EmailSnapshot_Cancel" ng-click="$ctrl.cancel()"></pbi-button></fieldset></footer><spinner ng-show="$ctrl.isLoading" class="icon large centered"></spinner></div>'),e.put("components/userNotifications/userNotificationsView.html",'<div class="usernotifications paneLayout"><header><div class="notificationheader"><div class="headercontainer"><div localize="UsersNotifications_AlertsFeed" class="heading"></div><div localize="UsersNotifications_AllNotifications" class="subheading"></div></div> <button ng-if="$ctrl.userNotifications.menuEnabled" localize-tooltip="UsersNotifications_Options" class="options" dropdown-overlay-invoke="notificationOptionsContextMenu" need-blur="true" prefer-left="true"><i class="glyphicon glyph-small pbi-glyph-more"></i></button><dropdown-overlay dropdown-overlay-name="notificationOptionsContextMenu" dropdown-overlay-class="angular-dropdown override-box-shadow"><dropdown-menu-items dropdown-items="::$ctrl.userNotifications.moreOptionsMenu" dropdown-class="additionalMenus active" dropdown-on-item-selected="$ctrl.moreOptionsMenuSelected(selected)"></dropdown-menu-items></dropdown-overlay></div></header><section class="contentContainer noPadding"><div class="notificationcontainer"><div class="nonotification" ng-if="!$ctrl.userNotifications.loadingData && (!$ctrl.userNotifications.notifications || $ctrl.userNotifications.notifications.length <= 0)"><div><i class="glyphicon pbi-glyph-emoji"></i></div><div localize="UsersNotifications_NoNotificationsMessage"></div></div><div ng-if="$ctrl.userNotifications.notifications && $ctrl.userNotifications.notifications.length> 0"><div ng-repeat="notification in $ctrl.userNotifications.notifications track by notification.contract.id"><div ng-init="$ctrl.userNotifications.loadIcon(notification)" ng-show="!notification.showDismissalDialog" class="notification" ng-class="notification.contract.id <= 0 ? \'pinned\' : (!notification.seen ? \'unseen\' : \'seen\')"><div class="notificationicon" ng-if="::!notification.contract.iconUrl" ng-switch="notification.image.imageType"><i class="glyphicon glyph-small pbi-glyph-user" ng-switch-when="0"></i><i class="glyphicon glyph-small pbi-glyph-group" ng-switch-when="1"></i><i class="glyphicon glyph-small pbi-glyph-gauge" ng-switch-when="2"></i><i class="glyphicon glyph-small pbi-glyph-barchart" ng-switch-when="3"></i><i class="glyphicon glyph-small pbi-glyph-insight" ng-switch-when="4"></i><i class="glyphicon glyph-small pbi-glyph-comment" ng-switch-when="5"></i><i class="glyphicon glyph-small pbi-glyph-powerbi" ng-switch-when="6"></i><i class="glyphicon glyph-small pbi-glyph-database" ng-switch-when="7"></i><i class="glyphicon glyph-small pbi-glyph-settings" ng-switch-when="8"></i><i class="glyphicon glyph-small pbi-glyph-uparrow rotate" ng-switch-when="9"></i><i class="glyphicon glyph-small pbi-glyph-uparrow" ng-switch-when="10"></i></div><div class="notificationicon" ng-if="::notification.contract.iconUrl"> <img class="icon" ng-src="{{::notification.contract.iconUrl}}"/></div><div class="message"><div><span class="title" ng-bind="::notification.title"></span><span class="time" ng-bind="::notification.formattedDate"></span></div><div class="desc" ng-bind="::notification.description"></div><div class="action" ng-if="::notification.actionText"><button ng-click="$ctrl.userNotifications.performAction(notification)" ng-bind="::notification.actionText"></button></div></div><div> <button class="close" ng-click="$ctrl.userNotifications.dismissNotification(notification)" localize-tooltip="UsersNotifications_DismissNotification"><i class="glyphicon glyph-micro pbi-glyph-close"></i></button></div></div></div><div ng-if="showLoadMore" class="loadmore"> <button ng-show="!disableLoadMore" ng-click="loadMoreNotification()" localize="UsersNotifications_LoadMore"></button><spinner ng-show="disableLoadMore" class="icon large centered"></spinner></div></div></div><spinner ng-show="$ctrl.userNotifications.loadingData" class="icon large centered"></spinner></section></div>'),e.put("components/workspacesContainer/workspacesContainer.html",'<div class="mainContent" ng-class="{\'initializing\': !$ctrl.initialized}"><div class="dashboardControls"><search-box should-focus="true" on-change="$ctrl.onSearchTextChange()" on-blur="$ctrl.resolveSearchTelemetry()" filter="$ctrl.searchText" placeholder="SearchContent"></search-box></div><div class="dashboardSliderMain" feature-switch-class="breadcrumbNavigationEnabled"><pbi-data-loader-spinner class="centered" ng-if="!$ctrl.groups"></pbi-data-loader-spinner><water-mark-message config="::$ctrl.watermarkConfig" ng-if="$ctrl.showWatermarkConfig"></water-mark-message><div class="galleryContainer workspacesGallery" feature-switch-class="breadcrumbNavigationEnabled" ng-if="$ctrl.groups"><content-tile-container tiles="$ctrl.groups" disable-lazy-loading="true" collapsible-pane-mode="false"></content-tile-container></div></div></div>'),e.put("views/bottomBar.html",'<div class="bottomBar" ng-hide="context.activeView === 2"><div class="dashboardConnectionsContainer"><dashboard-connections-dialog context="context.dashboardConnections"/></div><div class="dashboardConnectionsBtn unselectable" id="dashboardConnectionsBtn" ng-click="context.dashboardConnections.visible = !context.dashboardConnections.visible"><span localize="Landing_DashboardConnectionsButtonText"></span> <span>{{context.dashboardConnections.dashboardConnectionsCount}}</span><i class=\'ms-Icon ms-Icon--alert warningIcon\' ng-hide="!context.dashboardConnections.error"></i></div></div>'),e.put("views/collapsiblePane.html",'<div class="collapsiblePane" ng-class="{expanded: viewModel.isExpanded, hidden: !viewModel.isExpanded, smallWidth:viewModel.expandedWidth===1, mediumWidth:viewModel.expandedWidth===2, largeWidth:viewModel.expandedWidth===3}"><div class="innerLayout"><div class="contentFrameHost" ng-transclude></div><div class="expandButtonContainer"><div class="expanderBtn" ng-click="togglePane()" ng-hide="isExpanderHidden === true" localize-tooltip="ActivityPane_Tooltip"><i class="expandIcon glyphicon pbi-glyph-chevronleftmedium glyph-micro"></i></div></div></div></div>'),e.put("views/contentProviderDialog.html",'<div class="contentProviderDialogFrame" ng-show="showIFrame"><div class="loading"><spinner class="large centered"></spinner></div><iframe name="contentProviderDialogFrame" class="contentProviderDialogFrame" sandbox="allow-scripts allow-popups allow-same-origin allow-forms"></iframe><div ng-include src="customConfigurationHandler" ng-if="customConfigurationHandler"></div></div>'),e.put("views/contentProviderLocalFile.html",'<div class="tileContainer localFile"><excel-upload-format ng-if="shouldChooseFormat"></excel-upload-format><div id="loadingId" class="loading" ng-click="$event.stopPropagation()"><div class="content"><div class="information"><div class="title"><span ng-attr-title="{{uploadingMessage}}">{{uploadingMessage}}</span></div><spinner class="large"></spinner></div> <button class="primary" ng-click="closeLoadingDialog()" localize="GetData_Cancel"></button></div></div></div>'),e.put("views/contentProviderStore/contentProviderChildTile.html",'<a><div class="childTitle" ng-bind="::viewModel.title | uppercase"/><div class="childDescription" ng-bind="::viewModel.descriptionTrustedHtml"/></a>'),e.put("views/contentProviderStore/contentProviderEventTile.html",'<div ng-click="handleClick()" class="eventTile"><content-provider-tile-body></content-provider-tile-body></div>'),e.put("views/contentProviderStore/contentProviderLinkTile.html",'<a href="{{::href}}" class="fwLinkTile" target="_blank"><content-provider-tile-body></content-provider-tile-body></a>'),e.put("views/contentProviderStore/contentProviderLocalFileTile.html",'<div ng-click="chooseFile()" class="localFileTile"><content-provider-tile-body></content-provider-tile-body></div>'),e.put("views/contentProviderStore/contentProviderNormalTile.html","<div><content-provider-tile-body></content-provider-tile-body></div>"),e.put("views/contentProviderStore/contentProviderSplash.html",'<div class="contentProviderSplash"><div ng-class="{welcome: screenState == 0}" class="container"><h1 ng-if="screenState == 0" localize="GetData_WelcomeTitle" class="title"></h1><h1 ng-if="screenState == 1" localize="GetData_GetData" class="title"></h1><h1 ng-if="screenState == 2" class="title">{{getSplashTitleForCurrentGroup()}}</h1><div ng-if="screenState == 0" class="desc"><div localize="GetData_WelcomeDescLine1"></div><div localize="GetData_WelcomeDescLine2"></div></div><div ng-if="screenState == 2 && !isMyWorkspace()" class="desc"><div localize="Groups_Splash_Description1"></div><div localize="Groups_Splash_Description2"></div></div><section class="helpSection"><span localize="GetData_TutorialLinkPreface_Text"></span><a localize="GetData_Try_This_Tutorial_Or_Watch_A_Video_1" href="https://go.microsoft.com/fwlink/p/?LinkId=522081" target=" _blank"></a><span localize="GetData_Try_This_Tutorial_Or_Watch_A_Video_2"></span><a localize="GetData_Try_This_Tutorial_Or_Watch_A_Video_3" href="javascript:void(0)" class="intoVideoButton" ng-click="showIntroductionVideoModal()"></a></section><section class="dataSourceTiles"><article class="dataSourceTileGroup"><h2 localize="GetData_ContentLibrary_Title"></h2><div class="dataSourceTile" ng-click="navigateToCategory(2, \'splashPage\')" ng-if="featureSwitchOrgAppsEnabled"><div class="tileContent"><h localize="GetData_MyOrganization" class="dataSourceTitle"></h><div localize="GetData_MyOrganizationDesc" class="dataSourceDesc"></div></div> <button class="getBtn biButton primary"><div localize="GetData_Get" class="btnLabel trimmedTextWithEllipsis" localize-tooltip="GetData_Get"></div><i class="glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div><div class="dataSourceTile" id="serviceAppTile" ng-click="navigateToCategory(1, \'splashPage\')" ng-if="showServicesTile"><div class="tileContent"><h localize="GetData_Services" class="dataSourceTitle"></h><div localize="GetData_ServicesDesc" class="dataSourceDesc"></div></div> <button class="getBtn biButton primary"><div localize="GetData_Get" class="btnLabel trimmedTextWithEllipsis" localize-tooltip="GetData_Get"></div><i class="glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div><div class="separator"></div><footer><a ng-click="navigateToCategory(4, \'splashPage\')" href="javascript:void(0)"><i class="glyphicon pbi-glyph-paste glyph-small"></i> &nbsp;<span localize="GetData_Samples" class="text"></span></a><a href="https://go.microsoft.com/fwlink/?linkid=839715" target="_blank"><i class="glyphicon pbi-glyph-puzzle glyph-small"></i> &nbsp;<span localize="GetData_SolutionTemplates" class="text"></span></a><a href="https://go.microsoft.com/fwlink/?linkid=839714" target="_blank"><i class="glyphicon pbi-glyph-person glyph-small"></i> &nbsp;<span localize="GetData_PartnerShowcase" class="text"></span></a></footer></article><article class="dataSourceTileGroup"><h2 localize="GetData_UploadOrConnectData_Title"></h2><div class="dataSourceTile" ng-click="navigateToCategory(3, \'splashPage\')"><div class="tileContent"><h localize="GetData_Files" class="dataSourceTitle"></h><div localize="GetData_FilesDesc" class="dataSourceDesc"></div></div> <button class="getBtn biButton primary"><div localize="GetData_Get" class="btnLabel trimmedTextWithEllipsis" localize-tooltip="GetData_Get"></div><i class="glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div><div class="dataSourceTile" ng-click="navigateToCategory(6, \'splashPage\')"><div class="tileContent"><h localize="GetData_Databases" class="dataSourceTitle"></h><div localize="GetData_Databases_Desc" class="dataSourceDesc"></div></div> <button class="getBtn biButton primary"><div localize="GetData_Get" class="btnLabel trimmedTextWithEllipsis" localize-tooltip="GetData_Get"></div><i class="glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div><footer><a class="skipBtn" ng-click="navigateToContentList()" ng-if="listViewEnabled() && inGroupWelcomeView()"><span localize="ContentList_SkipGetData" class="text"></span></a></footer></article></section></div></div>'),
e.put("views/contentProviderStore/contentProviderSplashIntroVideoModal.html",'<iframe ng-src="https://go.microsoft.com/fwlink/?LinkID=761006" allowfullscreen></iframe><span localize="GetData_TutorialLinkPreface_Text"></span><a href="https://go.microsoft.com/fwlink/?LinkId=780853 " localize="GetData_Watch_Our_Video_Course_Or_Try_This_Tutorial_1" target="_blank"></a><span localize="GetData_Watch_Our_Video_Course_Or_Try_This_Tutorial_2"></span><a class="tutorialLink" localize="GetData_Watch_Our_Video_Course_Or_Try_This_Tutorial_3" href="https://go.microsoft.com/fwlink/p/?LinkId=522081" target="_blank"></a>'),e.put("views/contentProviderStore/contentProviderStore.html",'<div class="sliderContentView contentProviderStore" ng-class="{splashState: isSplashState()}"><div class="navigation"><div class="backBtn" ng-click="navigateToHome()" ng-class="{welcome: screenState == 0 && isSplashState()}" feature-switch-not="breadcrumbNavigationEnabled"><i class="glyphicon pbi-glyph-arrowleft"></i> <span class="currentGroupLabel" ng-attr-title="{{getCurrentGroupName()}}">{{getCurrentGroupName()}}</span></div><ul class="categoryContainer"><li class="categoryHeader"><span localize="GetData_ContentLibrary_Title" localize-tooltip="GetData_ContentLibrary_Title"></span></li><li class="category" ng-class="{\'selected\':viewModel.selectedCategory==2}" ng-if="featureSwitchOrgAppsEnabled" ng-click=" navigateToCategory(2, \'navPane\')"><i class="glyphicon pbi-glyph-emi glyph-small"></i><span ng-bind="::getCategoryDisplayName(2)"></span></li><li class="category" ng-class="{\'selected\':viewModel.selectedCategory==1}" ng-click="navigateToCategory(1, \'navPane\')"><i class="glyphicon pbi-glyph-chromerestore glyph-small"></i><span ng-bind="getCategoryDisplayName(1)"></span></li><li class="category" ng-class="{\'selected\':viewModel.selectedCategory==4}" ng-click="navigateToCategory(4, \'navPane\')"><i class="glyphicon pbi-glyph-paste glyph-small"></i><span ng-bind="::getCategoryDisplayName(4)"></span></li><li class="categoryHeader"><span localize="GetData_UploadOrConnectData_Title" localize-tooltip="GetData_UploadOrConnectData_Title"></span></li><li class="category" ng-class="{\'selected\':viewModel.selectedCategory==3 }" ng-click="navigateToCategory(3, \'navPane\')"><i class="glyphicon pbi-glyph-save glyph-small"></i><span ng-bind="::getCategoryDisplayName(3)"></span></li><li class="category" ng-class="{\'selected\':viewModel.selectedCategory==6}" ng-click="navigateToCategory(6, \'navPane\')"><i class="drum-icon"></i><span ng-bind="::getCategoryDisplayName(6)" ng-attr-title="{{getCategoryDisplayName(6)}}"></span></li></ul><ul class="categoryContainer bottomStack"><li class="category"><i class="glyphicon pbi-glyph-link glyph-small"></i><a target="_blank" href="https://go.microsoft.com/fwlink/?LinkID=613515"><span localize="GetData_AddYourContent" localize-tooltip="GetData_AddYourContent"></span></a></li><li class="category"><i class="glyphicon pbi-glyph-link glyph-small"></i><a target="_blank" href="https://go.microsoft.com/fwlink/?LinkID=613519"><span localize="GetData_FindAPartner" localize-tooltip="GetData_FindAPartner"></span></a></li><li class="category"><i class="glyphicon pbi-glyph-link glyph-small"></i><a target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=522424"><span localize="GetData_SubmitAnIdea" localize-tooltip="GetData_SubmitAnIdea"></span></a></li></ul></div><div class="contentProviderStoreContent"><div class="topBar"><div class="breadcrumb" ng-if="!isSplashState()" feature-switch-class="breadcrumbNavigationEnabled"><span><span class="link" localize="NavigationPane_GetData" ng-click="navigateToGetData()"></span></span><span ng-if="viewModel.selectedCategory"><i class="glyphicon pbi-glyph-chevronrightmedium glyph-micro"></i> <span class="link" ng-class="{current: !viewModel.selectedContentProviderTile}" ng-click="navigateToCategory(viewModel.selectedCategory, \'breadcrumb\')">{{getCategoryDisplayName(viewModel.selectedCategory)}}</span></span><span ng-if="viewModel.selectedContentProviderTile"><i class="glyphicon pbi-glyph-chevronrightmedium glyph-micro"></i> <span class="link current">{{viewModel.selectedContentProviderTile.title}}</span></span></div><div class="search" ng-class="{\'highlighted\': viewModel.searchKeyword}" ng-show="viewModel.searchBoxVisible"> <input ng-model="viewModel.searchKeyword"/><i class="glyphicon pbi-glyph-search glyph-small"></i></div></div><content-provider-tile-browser ng-hide="!showProviderTiles()" tiles="viewModel.contentProviderTiles" selected-content-provider-tile="viewModel.selectedContentProviderTile" navigate-to-category="navigateToCategory" has-content-provider-loaded="viewModel.hasContentProviderLoaded" is-splash-state="isSplashState"></content-provider-tile-browser><content-provider-local-file selected-file="selectedLocalFile" is-update-from-element-flow="false" ng-if="isLocalFileSelected"></content-provider-local-file><content-provider-configuration/></div><content-provider-splash></content-provider-splash></div>'),e.put("views/contentProviderStore/contentProviderTileBody.html",'<div class="tileHolder"><div class="tileBody"><div ng-if="viewModel.iconCSSClass" class="providerIcon {{::viewModel.iconCSSClass}}"/><div ng-if="!viewModel.iconCSSClass" class="providerIcon urlIcon" style="background-image:url({{::viewModel.iconUrl}})"/><div class="text"> <span class="title">{{::viewModel.title}}</span></div></div></div>'),e.put("views/contentProviderStore/contentProviderTileBrowser.html",'<div class="tileContainer dataSourceList"><div ng-if="currentCategory === 2 && visibleTiles.length === 1" class="header" localize="PublishContentPack_FirstContentPack"></div><div ng-if="showNoSearchResultText" class="noSearchResultText" localize="GetData_NoSearchResultsFound"></div><load-notification hide="isSplashState() || hasContentProviderLoaded" message="contentProviderLoadingMessage"></load-notification><div class="tile" ng-repeat="contentProviderTile in tiles" ng-class="{\'selected\': selectedContentProviderTile==contentProviderTile}" ng-switch on="contentProviderTile.contract.configurationUIstyle"><content-provider-normal-tile ng-switch-when="0" view-model="contentProviderTile" class="tileContent" ng-click="navigateToTile($index, true);"></content-provider-normal-tile><content-provider-normal-tile ng-switch-when="1" view-model="contentProviderTile" class="tileContent" ng-click="navigateToTile($index, true);"></content-provider-normal-tile><content-provider-normal-tile ng-switch-when="2" view-model="contentProviderTile" class="tileContent" ng-click="navigateToTile($index, true);"></content-provider-normal-tile><content-provider-local-file-tile ng-switch-when="3" view-model="contentProviderTile" class="tileContent" ng-click="navigateToTile($index, true);" on-cancel="clearSelection()"></content-provider-local-file-tile><content-provider-link-tile ng-switch-when="4" view-model="contentProviderTile" class="tileContent" ng-click="navigateToTile($index, false);"></content-provider-link-tile><content-provider-event-tile ng-switch-when="5" view-model="contentProviderTile" class="tileContent" ng-click="navigateToTile($index, false);"></content-provider-event-tile></div><div class="detailPane" ng-class="{\'grouping\': selectedContentProviderTile.tileGrouping.groupingChildItems}"><div class="detailPaneArrow"></div><div class="accordion" ng-if="!selectedContentProviderTile.tileGrouping.groupingChildItems"><i class="close glyphicon pbi-glyph-close glyph-mini" ng-click="closeDetailPane()"></i><div class="title" ng-bind="selectedContentProviderTile.title" ng-attr-title="{{selectedContentProviderTile.title}}"></div><div class="publishMetadata" ng-if="selectedContentProviderTile.publisher"><div><span ng-bind="getPublishMetaData(selectedContentProviderTile.publisher)"></span> <span ng-if="selectedContentProviderTile.emailAddress">-<a ng-bind-attr="{href: selectedContentProviderTile.emailAddressAsLink}" ng-bind="selectedContentProviderTile.emailAddress"></a></span></div><div><span ng-bind="getPrettyDate(selectedContentProviderTile.publishDate)"></span></div></div><div class="detailPaneContent"><div class="detailContainer"><div class="descriptionContainer"><div class="description" ng-class="{\'short\': selectedContentProviderTile.usePBIDesktop}" ng-bind-html="selectedContentProviderTile.descriptionTrustedHtml"></div><div class="more-information" ng-if="selectedContentProviderTile.usePBIDesktop"><i class="glyphicon glyph-small pbi-glyph-info"></i><span localize="GetData_DownloadDesktopInfo" localize-fragments><pbi-link fragment-index="0" guid="824921" label="GetData_LearnMoreAboutDesktop"></pbi-link></span></div></div><div class="connectContainer"> <button class="primary connect detailPaneConnectBtn" ng-click="connect()"><div ng-if="!selectedContentProviderTile.usePBIDesktop" class="label trimmedTextWithEllipsis" localize="GetData_Connect" localize-tooltip="GetData_Connect"></div><div ng-if="selectedContentProviderTile.usePBIDesktop" class="label trimmedTextWithEllipsis" localize="GetData_DownloadDesktop" localize-tooltip="GetData_DownloadDesktop"></div><i class="glyphicon pbi-glyph-getdata"></i></button><a class="learnMoreLink" ng-if="selectedContentProviderTile.learnMoreUrl && !selectedContentProviderTile.usePBIDesktop" target="_blank" href="{{selectedContentProviderTile.learnMoreUrl}}" localize="LearnMore"></a></div></div></div></div><div class="accordion grouping" ng-if="selectedContentProviderTile.tileGrouping.groupingChildItems"><a ng-click="closeDetailPane()"><i class="close glyphicon pbi-glyph-close glyph-mini"></i></a><div class="groupingSection"><div class="groupingTitle" ng-bind="selectedContentProviderTile.title" ng-attr-title="{{selectedContentProviderTile.title}}"></div><div class="groupingSrollWrapper"><div class="groupingScrollArea"><div class="groupingIntroduction"><div class="groupingDescription"><span ng-bind="getLocalizedValue(selectedContentProviderTile.descriptionLocalizationKey)"></span><a class="learnMoreLink" ng-if="selectedContentProviderTile.learnMoreUrl" target="_blank" href="{{selectedContentProviderTile.learnMoreUrl}}" localize="LearnMore"></a></div><hr/><div class="groupingInstruction" localize="GetData_GroupingInstruction"/></div><div class="childContainer"><content-provider-child-tile ng-repeat="childContentProviderTile in selectedContentProviderTile.tileGrouping.groupingChildItems | orderBy:[\'sortPriority\', \'title\'] track by $index" ng-click="selectChildTile(childContentProviderTile)" view-model="childContentProviderTile" class="childTile" ng-class="{\'activeChild\': childContentProviderTile==selectedChildContentProvider}"></content-provider-child-tile></div></div><div class="reservation"></div></div><div class="groupingConnectContainer"> <button class="primary connect group" ng-disabled="!selectedChildContentProvider" ng-click="childConnect()"><span localize="GetData_Connect"></span><i class="glyphicon pbi-glyph-getdata"></i></button></div></div></div></div><div><div class="extraInfo" ng-if="currentCategory === 2 && visibleTiles.length === 1"><div><h3 localize="PublishContentPack_AddDataToMyOrgTitle"></h3></div><span localize="PublishContentPack_AddDataToMyOrgText" localize-fragments><a fragment-index="0" localize="LearnMore" href="https://go.microsoft.com/fwlink/?LinkID=616059" target="_blank"></a></span></div></div></div>'),e.put("views/contentProviderStore/customConfigHandlers/sharePointConfigHandler.html","<share-point-url-input></share-point-url-input>"),e.put("views/contentProviderStore/customConfigHandlers/sharePointUrlModal.html",'<div class="sharePointConfig"><div localize="SharePointSiteExample"></div> <input type="text" autofocus="" tabindex="1" ng-model="url"/><div class="notice infonav-dialogContentNotification typeInfo"><span class="glyphicon pbi-glyph-info glyph-mini"></span><span class="infonav-dialogContentNotificationText" localize="SharePoint_ModalNotification"></span></div><div ng-show="isLoading"><spinner class="xsmall"></spinner><span class="loading" localize="DataLoaderSpinner_LoadingMessage1"></span></div><div ng-show="hasError" class="error">{{errorMessage}}</div></div>'),e.put("views/contextMenu.html",'<div class="contextMenu" ng-class="contextMenuStyle"><div class="wrapper" ng-class="::arrowDirection"><div class="arrow"></div><dropdown-list><div class="metadata-container"><div ng-bind="context.source.displayName" class="title trimmedTextWithEllipsis" title="{{context.source.displayName}}"></div><div ng-click="close()" class="close-btn"><i class="glyphicon pbi-glyph-close glyph-mini"></i></div><div ng-repeat="metadata in context.metadata" class="metadata"><h6 class="metadataLabel" ng-bind="metadata.label"></h6><div ng-if="metadata.type === 0"> <span class="message">{{metadata.value()}}</span><span ng-if="metadata.infoTooltipConfig" class="glyphicon glyph-mini pbi-glyph-info tooltipIcon" tooltip tooltip-config="::metadata.infoTooltipConfig"></span></div><div ng-if="metadata.type === 2"> <span>{{ metadata.value() }}</span> <a ng-bind-attr="{href: metadata.linkUrl(), title: metadata.linkTitle() || metadata.linkText(), target: metadata.linkTarget}">{{ metadata.linkText() }}</a></div><div ng-if="metadata.type === 3"><span class="refreshFlyoutWarning" ng-if="metadata.isWarning == true"><i class="glyphicon pbi-glyph-error glyph-mini"></i></span> <a class="refreshHistory" href="" ng-click="metadata.actionOnClick();close();">{{metadata.value()}}</a></div><div ng-if="metadata.type === 4"><div ng-switch="metadata.status"><div ng-switch-when="0"><span class="glyphicon glyph-small pbi-glyph-error statusIcon"></span><span class="statusText" ng-bind="metadata.value"></span></div><div ng-switch-when="1"><span class="glyphicon glyph-small pbi-glyph-success glyph-success-color statusIcon"></span><span class="statusText" ng-bind="metadata.value"></span></div></div></div></div><hr/></div><dropdown-list-item ng-repeat="button in context.actions" class="contextMenuButton trimmedTextWithEllipsis" ng-click="button.action();close();"> <a ng-if="button.link" href="{{button.link}}" target="_blank" title="{{button.text}}">{{::button.text }}</a><span ng-if="!button.link" title="{{button.text}}" ng-bind="button.text"></span></dropdown-list-item></dropdown-list></div></div>'),e.put("views/dashboard.html",'<div class="dashboard" dashboard-printer><pbi-data-loader-spinner class="centered" ng-if="!viewModel.isLoaded && !isGroupTransitionDelayed && !showReloadDashboard"></pbi-data-loader-spinner><div class="error" ng-if="!viewModel.isLoaded && showReloadDashboard"><i class="glyphicon pbi-glyph-error glyph-large"></i><h3 localize="DashboardTilesLoadError_Title"></h3><span class="tileLoadErrorMessage" localize="DashboardTilesLoadError_Message1" localize-fragments><a fragment-index="0" href="https://support.powerbi.com" target="_blank" localize="DashboardTilesLoadError_Message2"></a><span fragment-index="1" localize="DashboardTilesLoadError_Message3"/></span> <button class="biButton primary" ng-click="reloadActiveDashboard()" localize="DashboardTilesLoadError_Reload"></button></div><ul class="tileContainer" ng-show="!showReloadDashboard" grid-layout id="dashboard{{viewModel.id}}"><dashboard-tile ng-repeat="tile in filteredTiles() track by tileTrackerFn(tile)" view-model="tile" can-edit="canEditTiles()" disable-pointer-events="{{::disablePointerEvents}}" grid-layout-item grid-layout-container="gridLayoutContainer" ng-repeat-finish-event="dashboardTileRepeatFinished" remove-tile-from-mobile-view="removeTileFromMobileView(tile)" in-edit-mobile-layout-mode="inEditMobileLayoutMode"></dashboard-tile></ul></div>'),e.put("views/dashboardContainer.html",'<div class="dashboardContainerView isNavigationPaneEnabled" ng-class="{isMainContentDisabled: collapsiblePaneMode !== 0 || showDashboardTileErrors,                isDashboardHeaderEnabled: showDashboardTileErrors,                isSelectedTileHighlighted: collapsiblePaneMode === 1 || collapsiblePaneMode === 7 || collapsiblePaneMode === 9 || showDashboardTileErrors,                qnaMode: navigation.inQnaView() || navigation.inQnaStartView(),                isQuestionBoxHidden: !shouldDisplayQuestionBox}" ng-switch="getViewState()"><div class="mainContent" ng-switch-when="0"><div class="header" ng-cloak><div class="dashboardAppBar appBar"><div class="appBarSection left" ng-switch="refreshState"><ul ng-if="showBreadcrumb"><li class="label groupLabel" ng-if="listViewEnabled()"> <button class="activeDashboardLabel appBarTitle" title="{{groupService.activeGroup.displayName}}" ng-click="navigateToContentList()">{{groupService.activeGroup.displayName}}</button></li><li class="breadcrumbLabel" ng-if="listViewEnabled()"><i class="glyphicon pbi-glyph-arrowright glyph-small"></i></li><li class="label" ng-class="{breadCrumbEnabled: listViewEnabled()}"> <span class="activeDashboardLabel appBarTitle" title="{{dashboardDataService.displayName}}">{{dashboardDataService.displayName}}</span><i ng-hide="dashboardDataService.activeDashboard.canEdit && !permissionService.isActiveWorkspaceIsReadOnly && !fullScreen.fullScreenMode" class="readonlyIcon glyphicon pbi-glyph-lock glyph-mini"></i></li><li class="label dataClassificationSection"><data-classification-label data-classification-id="dashboardDataService.activeDashboard.dataClassificationId"></data-classification-label></li></ul><section class="notification" ng-switch-when="1"><spinner modern></spinner><span class="notificationText" localize="DashboardContainer_RefreshInProgress"></span></section><section class="notification" ng-switch-when="2"><span class="glyphicon glyph-small pbi-glyph-success icon"></span><span class="notificationText" localize="DashboardContainer_RefreshCompleted"></span></section></div><div class="appBarSection right"><ul class="optionsMenu"><li ng-if="showAddTileButton() && !viewModel.isPhonePortraitViewMode"> <button ng-click="showTileGalleryPane()" localize-tooltip="DashboardAppBar_AddTile" id="addTile"><i class="glyphicon pbi-glyph-add icon smallIcon"></i><span class="appBarMenuItem" localize="DashboardAppBar_AddTile"></span></button></li><li ng-if="showUsageMetricsButton() && !viewModel.isPhonePortraitViewMode"> <button ng-click="openUsageMetricsReport()" localize-tooltip="UsageMetrics" id="addTile"><i class="glyphicon pbi-glyph-chart icon smallIcon"></i><span class="appBarMenuItem" localize="UsageMetrics"></span></button></li><li ng-if="showViewRelatedButton() && !viewModel.isPhonePortraitViewMode"> <button ng-click="showRelatedContentPane()" localize-tooltip="DashboardAppBar_ViewRelated"><i class="glyphicon pbi-glyph-link icon smallIcon"></i><span class="appBarMenuItem" localize="DashboardAppBar_ViewRelated"></span></button></li><li ng-if="showHomeDashboardButton() && !isOnHomeDashboard && !viewModel.isPhonePortraitViewMode"> <button ng-click="setHomeDashboard()" class="setFeatured" localize-tooltip="SetFeaturedDashboardButton"><i class="glyphicon pbi-glyph-gauge glyph-small"></i><span class="appBarMenuItem" localize="SetFeaturedDashboardButton"></span></button></li><li ng-if="showHomeDashboardButton() && isOnHomeDashboard && !viewModel.isPhonePortraitViewMode"> <button ng-click="unsetHomeDashboard()" class="unsetFeatured" localize-tooltip="NavigationPane_DisableFeaturedDashboard"><i class="glyphicon pbi-glyph-gauge glyph-small"></i><span class="appBarMenuItem" localize="NavigationPane_DisableFeaturedDashboard"></span></button></li><li ng-if="favoriteEnabled && !dashboardDataService.activeDashboard.isFavorite && !viewModel.isPhonePortraitViewMode"> <button ng-click="addDashboardFavorite()" ng-disabled="dashboardDataService.activeDashboard.id < 0 || dashboardDataService.activeDashboard.isFavoriteDisabled" class="addFavorite" localize-tooltip="Artifact_Favorite"><i class="powervisuals-glyph star-empty glyph-small icon"></i><span class="appBarMenuItem" localize="Artifact_Favorite"></span></button></li><li ng-if="favoriteEnabled && dashboardDataService.activeDashboard.isFavorite && !viewModel.isPhonePortraitViewMode"> <button ng-click="deleteDashboardFavorite()" ng-disabled="dashboardDataService.activeDashboard.isFavoriteDisabled" class="deleteFavorite" localize-tooltip="Artifact_UnFavorite"><i class="powervisuals-glyph star-full glyph-small icon"></i><span class="appBarMenuItem" localize="Artifact_UnFavorite"></span></button></li><li ng-if="::isEmailSubscriptionEnabled()" class="subscription" localize-tooltip="ReportAppBar_Subscribe" ng-click="showSubscriptionPane()"><i class="glyphicon pbi-glyph-mail glyph-small"></i><span localize="ReportAppBar_Subscribe"></span></li><li> <button ng-click="showShareSlider()" class="shareDashboardButton" localize-tooltip="ReportAppBar_ShareButton" ng-if="sharingEnabled() && !viewModel.isPhonePortraitViewMode"><i class="glyphicon pbi-glyph-share glyph-small icon"></i><span class="appBarMenuItem" localize="ReportAppBar_ShareButton"></span></button></li><li ng-if="viewModel.isPhonePortraitViewMode"> <button ng-click="unpinAllTiles()" ng-disabled="!shouldShowUnpinTiles()" localize-tooltip="Phone_Authoring_Clear_All_Tiles"><i class="glyphicon pbi-glyph-unpin glyph-small icon"></i><span class="appBarMenuItem" localize="Phone_Authoring_Clear_All_Tiles"></span></button></li><li ng-if="viewModel.isPhonePortraitViewMode"> <button ng-click="resetTiles()" localize-tooltip="Dashboard_Authoring_Reset_Tiles"><i class="glyphicon pbi-glyph-undo glyph-small icon"></i><span class="appBarMenuItem" localize="Dashboard_Authoring_Reset_Tiles"></span></button></li><li ng-if="shouldShowAuthoringDropDown()" ng-click="showMenu($event, getAuthoringMenuProperties)" title="{{authorMenuSelectedItem().tooltip}}"><i class="{{authorMenuSelectedItem().iconClass}} glyph-small"></i> <span class="appBarMenuItem">{{authorMenuSelectedItem().text}}</span><i id="anchorElementForAuthoring" class="glyphicon pbi-glyph-chevrondownmedium glyph-mini marginTextFromGlyph"></i></li><li class="moreOptionsItem"> <button id="optionsBtn" class="moreOptionsDashboardButton" ng-click="showMoreOptionsMenu($event)" ng-if="isMoreOptionsMenuAvailable()" localize-tooltip="Options_Menu"><i class="glyphicon glyph-small pbi-glyph-more"></i></button></li></ul> <span class="dashboardTileErrors trimmedTextWithEllipsis" ng-if="dashboardTileErrorCount>0"><div class="badge mini-label" ng-bind="dashboardTileErrorCount" ng-click="showTileErrorDetails()"></div><i class="glyphicon glyph-small pbi-glyph-warning" ng-click="showTileErrorDetails()"></i><span class="errorMessage"><span localize="DashboardAppBar_TileError"></span><span class="errorToggle" ng-switch="showDashboardTileErrors" ng-click="toggleTileError()"><span ng-switch-when="true" localize="DashboardAppBar_TileError_HideErrors"></span><span ng-switch-when="false" localize="DashboardAppBar_TileError_ShowErrors"></span></span></span></span></div></div><div class="qnaAppBar appBar" ng-if="navigation.inQnaView() || navigation.inQnaStartView()"><div class="appBarSection left"><ul><li> <button ng-click="navigation.navigateToDashboardByGUID(dashboardDataService.activeDashboard.objectId)"><i class="glyphicon pbi-glyph-pageleft glyph-small backBtn"></i> <span class="activeDashboardLabel appBarTitle displayOnSmallScreen">{{dashboardDataService.displayName}}</span></button></li></ul></div></div><div class="dashboardFullScreenTitle"> {{viewModel.displayName}}</div><div class="dashboardControlsWrapper" ng-cloak ng-if="shouldDisplayQuestionBox && !viewModel.isPhonePortraitViewMode"><qna-input-launcher ng-if="dashboardDataService.activeDashboardContainsQnaSupportedModel" models="dashboardDataService.activeDashboardModels" show-qna="showQna"></qna-input-launcher></div></div><div class="dashboardSliderMain fillAvailableSpace" id="paneContainer" ng-class="{dashboardViewSliderPhoneMode: viewModel.isPhonePortraitViewMode}"><ng-switch on="viewModel.viewMode"><dashboard-edit-mobile-display ng-switch-when="1" view-model="viewModel.dashboardEditMobileDisplay"></dashboard-edit-mobile-display><div class="dashboardModeView" ng-switch-default><div class="dashboardViewSlider"><dashboard disable-tile-ease-in="true" view-model="dashboardDataService.activeDashboard" display-layout="0" is-group-transition-delayed="groupService.isGroupTransitionDelayed"></dashboard></div></div></ng-switch></div></div><water-mark-message config="errorMessageConfig" ng-switch-when="1"></water-mark-message><request-dashboard-access ng-switch-when="2"></request-dashboard-access></div>'),e.put("views/devToolsView.html",'<div class="devToolsView"><title-bar></title-bar><dev-tools-main-container></dev-tools-main-container></div>'),e.put("views/dropdowns/appBarAuthoringMenu.html",'<dropdown-overlay dropdown-overlay-name="authorOptionsMenu" dropdown-overlay-class="angular-dropdown override-box-shadow angular-dropdown-authoring"><ul class="angular-dropdown angular-dropdown-authoring active additionalMenus mobileAuthoringAdditionalMenus" ng-class="{dark: getMode() === 0}"><li ng-repeat="item in getMenuActions()" class="dropdown-item moreOptions" ng-class="{selectedItem: item.checked}" ng-mousedown="menuActionSelected(item); $event.stopPropagation();"><a href="" target="_blank"><div class="dropdown-content angular-dropdown-authoring"><i class="dropdown-icon {{::item.iconClass}}"></i><div class="dropdown-label" ng-bind="::item.text"></div></div></a></li></ul></dropdown-overlay>'),e.put("views/dropdowns/navigationBarSettingsMenu.html",'<dropdown-overlay dropdown-overlay-name="settingsMenu" dropdown-overlay-class="angular-dropdown navigationBar-contextMenu override-box-shadow"><ul class="navigationBar-contextMenu active" ng-attr-read-only="{{!canWrite()}}"><li class="quotaManagement"><div class="dropdown-item addBorderBottom" ng-click="onManageStorageSelected()"> <button class="dropdown-content "><usage-bar-menu-item label-class="lableItem"></usage-bar-menu-item></button></div></li><li ng-if="featureSwitchOrgAppsEnabled()" class="orgApps"><div class="dropdown-item addBorderBottom" ng-click="onCreateContentPackSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_CreateContentPack"/></div><div class="dropdown-item addBorderBottom" ng-click="onViewContentPackSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ViewContentPack"/></div></li><li ng-if="showAdminPortal()" class="dropdown-item addBorderBottom" ng-click="onAdminPortalSelected()"> <button class="dropdown-content dropdown-label" localize="AdminPortal_Title"/></li><li ng-if="featureSwitchEnterpriseGatewayEnabled()" class="dropdown-item addBorderBottom" ng-click="onManageGatewaysSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ManageGateways"/></li><li ng-if="featureSwitchPermissionCenterEnabled()" class="dropdown-item addBorderBottom" ng-click="onManagePermissionsSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ManagePermissions"/></li><li ng-if="o365PowerBIEnabled()" class="dropdown-item addBorderBottom" ng-click="onO365PowerBISelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_PowerBIForO365"/></li><li class="dropdown-item addBorderBottom" ng-click="onPowerBISettingsSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_PowerBISettings"/></li><li><div ng-if="featureSwitchPublishToWeb()" class="dropdown-item addBorderBottom" ng-click="onManageEmbedSelected()"> <button class="dropdown-content dropdown-label" localize="TopNav_SettingsMenu_ManageEmbedCodes"/></div></li></ul></dropdown-overlay>'),e.put("views/excelUploadFormat.html",'<div class="excelContent"><div class="uploadFormat"><header><h1 class="title" localize="UploadExcelLocalFile_ChooseFormat"></h1><div class="text" localize="UploadExcel_ChooseFormatDescription"></div></header><table class="contentContainer"><tr class="contentItem"><td class="optionColumn"><div class="imageContainer"><div class="importDataIntoPowerBI"></div></div></td><td></td><td class="optionColumn"><div class="imageContainer"><div class="viewExcelInPowerView"></div></div></td></tr><tr class="spacer"></tr><tr class="contentItem"><td class="optionColumn"><span class="contentItemTitle" localize="UploadExcel_ChooseFormat_ImportData"></span></td><td class="seperatorColumn"><span class="contentItemTitle" localize="UploadExcel_ChooseFormat_Or"></span></td><td class="optionColumn"><span class="contentItemTitle" localize="UploadExcelLocalFile_ChooseFormat_ViewExcel"></span></td></tr><tr class="contentItem"><td class="optionColumn"><div class="contentItemDescription"><span localize="UploadExcelLocalFile_ChooseFormat_ImportDataDescription"></span></div></td><td></td><td class="optionColumn"><div class="contentItemDescription"><span localize="UploadExcelLocalFile_ChooseFormat_ViewExcelDescription"></span></div></td></tr><tr class="contentItem"><td class="optionColumn"><div class="contentBtnItem"> <button class="buttonProviderFormat submitBtn BigBtn importDataBtn" ng-click="chooseFormat(0)" ng-disabled="inProgress"><span localize="UploadExcel_ChooseFormat_Import"></span><i class="arrow glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div></td><td></td><td class="optionColumn"><div class="contentBtnItem"> <button class="buttonProviderFormat submitBtn BigBtn viewExcelBtn" ng-click="chooseFormat(1)" ng-disabled="inProgress"><span localize="UploadExcelLocalFile_ChooseFormat_Upload"></span><i class="arrow glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i></button></div></td></tr></table></div></div>'),e.put("views/explorationContainer.html",'<div class="explorationContainer explorationWithChrome" ng-class="{\'editing\' : (viewModeState.getMode() === 1 || viewModeState.getMode() === 2),    \'reading\': viewModeState.getMode() === 0}"><exploration-app-bar ng-if="viewModel.options.showAppBar" view-model="viewModel"></exploration-app-bar><div class="explorationHost" ng-class="{ \'explorationHostNoAppBar\': !viewModel.options.showAppBar }"><exploration-host view-model="viewModel" id="pvExplorationHost"><task-pane view-model="viewModel.taskPane" ng-if="viewModeState.getMode() === 1 || viewModeState.getMode() === 2" field-list-config="::fieldListConfig" ng-show="viewModel.options.showTaskPane" resizable resizable-containerid="pvExplorationHost" resizable-sibling="visualizationPane" resizable-expanded="{{viewModel.taskPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"></task-pane><visualization-pane view-model="viewModel.visualizationPane" ng-show="isVisualizationPaneVisible()" resizable resizable-containerid="pvExplorationHost" resizable-sibling="taskPane" resizable-expanded="{{viewModel.visualizationPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"></visualization-pane><div class="horizontalItemsContainer"><exploration view-model="viewModel.exploration" ng-class="{\'exploreCanvasToBottom\': !isFooterVisible()}" canvas-options="canvasOptions"></exploration><exploration-footer ng-show="isFooterVisible()" view-model="viewModel"></exploration-footer></div></exploration-host></div><div class="explorationMask" ng-if="viewModel.showMask"><div class="centeredSpinner"><spinner></spinner></div></div><div class="canvasSpinnerBackground" ng-if="viewModel.showSpinner"><pbi-data-loader-spinner class="centered"></pbi-data-loader-spinner></div></div>'),e.put("views/fullScreenControls.html",'<div class="fullScreenBtnHost"><div ng-if="fullScreen.fullScreenMode"> <button class="fullScreenBrowserBack floatingViewBtn" localize-tooltip="Back_In_Browser" ng-click="navigation.navigateBack()"><i class="glyphicon pbi-glyph-pageleft"></i><span localize="FullScreen_Back"></span></button><span ng-if="navigation.inReportView() || navigation.inDatasetView()"><span class="floatingViewDivider"></span> <button class="fullScreenPrevious floatingViewBtn" localize-tooltip="Previous_Report_Page" ng-click="fullScreen.fullScreenPreviousPage()"><i class="glyphicon pbi-glyph-chevronleftmedium"></i></button> <button class="fullScreenNext floatingViewBtn" localize-tooltip="Next_Report_Page" ng-click="fullScreen.fullScreenNextPage()"><i class="glyphicon pbi-glyph-chevronrightmedium"></i></button></span><span class="floatingViewDivider"></span> <button class="printBtn floatingViewBtn" localize-tooltip="FullScreen_Print" ng-click="print()"><i class="glyphicon pbi-glyph-print"></i></button> <button class="fitContentBtn floatingViewBtn" localize-tooltip="FullScreen_FitToScreen" ng-if="navigation.inDashboardView()" ng-click="toggleFitContent()"><i class="glyphicon pbi-glyph-fittopage"></i></button> <button class="fitWidthBtn floatingViewBtn" localize-tooltip="FullScreen_FitToWidth" ng-if="navigation.inDashboardView()" ng-click="toggleFitWidth()"><i class="glyphicon pbi-glyph-fittowidth"></i></button> <button class="exitFullScreenBtn floatingViewBtn" ng-click="exitFullScreen()" localize-tooltip="FullScreen_Exit"><i class="glyphicon pbi-glyph-fullscreenexit"></i></button></div></div>'),
e.put("views/groupNavigationPaneListItem.html",'<li class="navPaneListItem" ng-right-click="showContextMenuIfEnabled()" ng-class="{selected: selected === true, active: showContextMenu === true}" data-id="{{::viewModel.id}}"><div class="navPaneItemIcon" ng-switch on="model.icon"><div ng-switch-when="3" class="groupsListItemIcon defaultGroupIcon"></div><div ng-switch-when="4" class="groupsListItemIcon groupsUserPhoto" ng-style="userPhoto ?{\'background-image\': userPhoto,\'background-size\':\'cover\',\'background-position\':\'0px 0px\'}:\'\'"></div></div><div class="navPaneListItemName trimmed groupNavPaneListItemName"><div class="textLabel" title="{{model.source.displayName}}">{{model.source.displayName}}</div></div></li>'),e.put("views/historyDialogView.html",'<div><modal-dialog class="historyDialog" history-dialog="viewModel" view-model="dialogModel" ng-if="viewModel.showModalDialog" on-cancel-action="closeDialog()" on-confirm-action="closeDialog()"><div class="title"><span localize="HistoryDialog_Title"></span></div><div class="model-package-selection"><span ng-class="{\'active\': refreshTypeSelected === 0}" ng-click="refreshTypeSelected = 0" localize="HistoryDialog_ScheduledTab"></span><span ng-class="{\'active\': refreshTypeSelected === 1}" ng-click="refreshTypeSelected = 1" localize="HistoryDialog_OneDriveTab"></span></div><div class="historyTableContainer"><table class="historyTable"><thead class="historyTableHeader"><tr><th class="historyDetails" localize="HistoryDialog_TableHeader_Details"></th><th class="historyType" localize="HistoryDialog_TableHeader_Type"></th><th class="historyStart" localize="HistoryDialog_TableHeader_Start"></th><th class="historyEnd" localize="HistoryDialog_TableHeader_End"></th><th class="historyStatus" localize="HistoryDialog_TableHeader_Status"></th><th class="historyFailMessage" localize="HistoryDialog_TableHeader_FailMessage"></th></tr></thead><tbody class="historyTableBody" ng-repeat="history in getSelectedHistories(refreshTypeSelected)" ng-init="detailExpand=false"><tr><td class="errorDetailsLink"><div ng-show="history.isSuccessful===false" ng-switch="detailExpand" ng-click="detailExpand=!detailExpand"><span localize="HistoryDialog_RefreshDetail_Show" ng-switch-when="false"></span><span localize="HistoryDialog_RefreshDetail_Hide" ng-switch-when="true"></span></div></td><td class="historyType" ng-switch="isScheduledRefresh(history)"><span ng-switch-when=true localize="HistoryDialog_RefreshType_Scheduled"></span><span ng-switch-when=false localize="HistoryDialog_RefreshType_OnDemand"></span></td><td class="historyStart"><span ng-bind="::history.startTime"/></td><td class="historyEnd"><span ng-bind="::history.endTime"/></td><td class="historyStatus"><span ng-bind="::history.status"/></td><td class="historyFailMessage"><span ng-bind="::history.friendlyErrorMessage"/></td></tr><tr class="historyErrorDetails" ng-if="detailExpand"><td colspan="9"><inline-name-value-pairs mode="\'info\'" show-title="false" detail-expand="true" name-value-pairs="history.details"></inline-name-value-pairs></td></tr></tbody></table></div></modal-dialog></div>'),e.put("views/inFocus.html",'<div class="inFocusContainer" on-resize="handleResize(width, height)" ng-if="showInFocusMode"><div class="inFocusAppBar appBar"><div class="appBarSection left"><ul><li> <button class="iconBox" ng-click="hide()"><i class="glyphicon pbi-glyph-arrowleft glyph-small"></i><span class="dashboardTitle link appBarMenuItem" localize="InFocus_ExitInFocus"></span></button></li><li class="appBarDivider"></li><li class="focusTitle appBarTitle" ng-bind="viewModel.displayText"></li><li class="focusSubtitle appBarText" ng-bind="viewModel.subDisplayText"></li></ul></div><div class="appBarSection right" ng-class="{readOnlyMode: !(canEdit || viewModel.openInsightArgs.canPin), insights: viewModel.openInsightArgs != null}" ng-if="viewModel.inFocusTile"><ul><li class="lastRefreshTimestamp appBarText metadata" ng-if="viewModel.inFocusTile.formattedTime"><span class="caption" localize="InFocus_RefreshTime"></span><span ng-bind="viewModel.inFocusTile.formattedTime"></span></li><li class="appBarDivider"></li><li class="getRelatedInsightsBtn" localize-tooltip="Insights_GetRelatedInsights_Tooltip" ng-if="relatedInsightsEnabled"> <button ng-click="getRelatedInsights()"><i class="glyphicon pbi-glyph-insight glyph-small"></i><span class="appBarMenuItem" ng-bind="viewModel.getRelatedInsightsText"></span></button></li><li class="pinBtn" ng-if="viewModel.inFocusTile && viewModel.inFocusTile.type != 5 && viewModel.inFocusTile.type != 8"> <button ng-click="pinVisual()"><i class="glyphicon pbi-glyph-pinned glyph-small"></i><span class="appBarMenuItem" ng-bind="viewModel.pinVisualText"></span></button></li><li class="editBtn" ng-if="inFocusEditEnabled"> <button ng-click="editVisual()"><i class="glyphicon pbi-glyph-edit glyph-small" ng-class="{inEditMode: viewModeState.getMode() === 1}"></i><span class="appBarMenuItem" ng-bind="viewModel.editVisualText"></span></button></li><li class="saveBtn" ng-if="inFocusEditEnabled"> <button ng-disabled="viewModeState.getMode() === 0" ng-click="saveVisual()"><i class="glyphicon pbi-glyph-save glyph-small"></i><span class="appBarMenuItem" ng-bind="::viewModel.saveVisualText"></span></button></li><li class="moreOptionsItem"> <button dropdown-menu class="moreOptionsInFocusButton" dropdown-items="inFocusMenuItems" dropdown-on-item-selected="inFocusMenuItemSelected(selected)" dropdown-class="additionalMenus"><i class="glyphicon pbi-glyph-more glyph-small"></i></button></li></ul></div></div><div ng-if="viewModel.inFocusTile" ng-switch="viewModel.inFocusTile.type"><section class="explorationContainer inFocus" ng-switch-when="0"><exploration-host ng-if="viewModel.showVisualEnabled && !inFocusDrillableError" class="explorationHost inFocusBody" view-model="viewModel" id="inFocusExpHost"><task-pane view-model="viewModel.taskPane" field-list-config="::fieldListConfig" ng-if="viewModeState.getMode() === 1" resizable resizable-containerid="InFocusExpHost" resizable-sibling="visualizationPane" resizable-expanded="{{viewModel.taskPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"></task-pane><visualization-pane class="inFocusVizPane" view-model="viewModel.visualizationPane" resizable resizable-containerid="InFocusExpHost" resizable-sibling="taskPane" resizable-expanded="{{viewModel.visualizationPane.isPaneExpanded}}" resizable-default-width="180" resizable-min-width="180" resizable-max-width="420" resizable-collapsed-width="32"></visualization-pane><insights-pane ng-if="viewModel.showInsightsPane" model="viewModel.inFocusTile.datasetModel.contract" visual-contract="viewModel.canvas.visual.visualContainer.contract" exploration-contract="viewModel.canvas.exploration.contract" tile-action="viewModel.inFocusTile.action.action" visual-title="viewModel.displayText + \' \' + viewModel.subDisplayText" visual="viewModel.canvas.visual.visualContainer.readOnlyState.visual" parent-event="openInFocusEvent"></insights-pane><div class="exploration"> <button class="previousVisualButton" ng-if="viewModel.showPreviousVisualButton" ng-click="showPreviousVisual()"><i class="glyphicon iconBox pbi-glyph-chevronleftmedium glyph-small"></i><span localize="InFocus_PreviousVisual"></span></button><explore-canvas view-model="::viewModel.canvas.exploration.exploreCanvas"></explore-canvas><div class="sourceInfo"><a class="sourceStyle" ng-if="viewModel.inFocusTile.report" ng-click="openReport()" ng-bind="viewModel.source"></a><div class="insightFeedbackStyle" ng-if="viewModel.openInsightArgs.insightContainerModel && viewModel.openInsightArgs.showInsightsEvent"><span localize="Insights_FeedbackLink"></span> <button ng-click="logInsightFeedback(true)" class="insightFeedbackButton" localize="Insights_FeedbackYes"></button> <button ng-click="logInsightFeedback(false)" class="insightFeedbackButton" localize="Insights_FeedbackNo"></button></div></div></div></exploration-host><water-mark-message ng-if="inFocusDrillableError" config="errorMessageConfig"></water-mark-message><div class="inFocusCenteredSpinner" ng-show="!viewModel.inFocusTile"><spinner modern delay="1000"></spinner></div></section><workbook-tile view-model="viewModel.workbook" class="explorationContainer inFocus" ng-switch-when="5"></workbook-tile><real-time-tile view-model="viewModel.realTime" class="realTimeTile inFocus" ng-switch-when="8"></real-time-tile></div></div>'),e.put("views/insights/insights.html",'<div class="sliderContentView insightsSliderContentView"><insights-canvas view-model="viewModel.insightsCanvasModel"></insights-canvas></div>'),e.put("views/landing.html",'<div class="landingController"><navigation-bar ng-if="::isInitialized" current-dashboard="dashboardDataService.activeDashboard.displayName" current-report="activeReportInfo.displayName" current-workbook="activeWorkbookInfo.displayName"></navigation-bar><impersonation-bar class="unselectable" ng-if="impersonation.impersonating" on-back="quitImpersonation()"></impersonation-bar><div id="contentMain" class="contentMain" ng-class="{isCollapsiblePaneExpanded: viewModel.collapsiblePane.isExpanded}"><navigation-pane ng-if="::(isInitialized && !listViewEnabled())" ng-cloak view-model="viewModel.dashboardContainer" current-report="activeReportInfo" current-workbook="activeWorkbookInfo"></navigation-pane><navigation-pane-v2 ng-if="::(isInitialized && listViewEnabled())" is-expanded="$ctrl.isNavigationPaneExpanded" on-toggled="$ctrl.toggleNavigationPane(isExpanded)" ng-class="{isExpanded: $ctrl.isNavigationPaneExpanded}" resizable resizable-containerid="contentMain" resizable-expanded="{{$ctrl.isNavigationPaneExpanded}}" resizable-default-width="220" resizable-min-width="200" resizable-max-width="420" resizable-collapsed-width="48" resizable-side="{{::navigationPaneSide}}"></navigation-pane-v2><div id="contentColumn" class="contentColumn"><notification-bar></notification-bar><landing-container ng-cloak></landing-container></div><div class="taskPaneSliderOverlay" ng-click="hideTaskPaneSliderOnClick()" ng-if="viewModel.collapsiblePane.isExpanded" ng-class="{isCollapsiblePaneExpanded: viewModel.collapsiblePane.isExpanded, showOverlay:viewModel.collapsiblePane.expandedWidth> 0}"></div><task-pane-slider ng-show="viewModel.collapsiblePaneMode !== 0"></task-pane-slider><div class="notificationPane" ng-if="viewModel.showNotificationPane"><div class="taskPaneSliderOverlay" ng-click="hideNotificationPaneOnClick()" ng-if="viewModel.notificationPane.isExpanded" ng-class="{isCollapsiblePaneExpanded: viewModel.notificationPane.isExpanded, showOverlay:viewModel.notificationPane.expandedWidth> 0}"></div><collapsible-pane view-model="viewModel.notificationPane" is-expander-hidden="viewModel.showNotificationPane"><user-notifications></user-notifications></collapsible-pane></div></div><marketplace-host ng-if="navigation.inGetDataView()"></marketplace-host><nps-host></nps-host><div class="sliderPane fullPageSlider unselectable" ng-if="navigation.inFullPageSliderView()" ui-view="fullPageSlider"></div></div>'),e.put("views/landingContainer.html",'<div class="landingContainer"><notification-toast></notification-toast><full-screen-controls></full-screen-controls><div class="waitingContainer" ng-if="groupService.isGroupTransitionDelayed || (isDashboardLandingContainerActive && showLoadingForDashboard())"><div class="spinnerWithText"><spinner class="large"></spinner><div class="loadingText" localize="Loading_Text"></div></div></div><div id="featuredDashboardLandingContainer" class="featuredDashboardRootContent" ng-if="inEmptyFeaturedDashboardView()"><featured-dashboard-container></featured-dashboard-container></div><div id="favoritesLandingContainer" class="favoritesRootContent" ng-if="favoritesEnabled && inFavoritesView()"><favorites-container collapsible-pane-mode="viewModel.collapsiblePaneMode"></favorites-container></div><div id="appsLandingContainer" class="appsRootContent" ng-if="inAppsView()"><apps-container></apps-container></div><div id="installedAppLandingContainer" ng-if="inAppView()" ng-class="{\'scrollable\': isScrollable()}"><app-container></app-container></div><div id="workspacesLandingContainer" class="workspacesRootContent" ng-if="inWorkspacesView()"><workspaces-container></workspaces-container></div><div id="contentListLandingContainer" class="contentListRootContent" ng-if="!groupService.isGroupTransitionDelayed && contentListEnabled() && isContentListActive"><content-list-container-v2 collapsible-pane-mode="viewModel.collapsiblePaneMode"></content-list-container-v2></div><div id="dashboardLandingContainer" class="landingRootContent" ng-if="isDashboardLandingContainerActive && !showLoadingForDashboard() && !inQnaModelView() && !inQnaView()" ng-class="{inApps: inAppView()}"><dashboard-container view-model="viewModel.dashboardContainer" collapsible-pane-mode="viewModel.collapsiblePaneMode" is-active="isDashboardLandingContainerActive"></dashboard-container></div><div id="datasetLandingContainer" class="landingRootContent datasetContainerContent" ng-if="inDatasetView() && !inQnaModelView()" ng-class="{inApps: inAppView()}"><manage-datasets></manage-datasets></div><div id="reportLandingContainer" class="landingRootContent reportContainerContent" ng-if="inReportView() && !inQnaModelView()" ng-class="{inApps: inAppView()}"><exploration-container view-model="viewModel.explorationContainer"></exploration-container></div><div id="workbookLandingContainer" class="landingRootContent workbookContainerContent" ng-if="inWorkbookView()" ng-class="{inApps: inAppView()}"><workbook-container view-model="viewModel.workbookContainer"></workbook-container></div><div id="qnaLandingContainer" class="landingRootContent" ng-if="inQnaModelView() || inQnaView()" ng-class="{inApps: inAppView()}"><qna-container view-model="viewModel.qnaContainer" collapsible-pane-mode="viewModel.collapsiblePaneMode"></qna-container></div><div in-focus ng-if="::isInitialized" can-edit="dashboardDataService.activeDashboard.canEdit"></div><content-provider-splash screen-state="2" class="isGroupWelcome" ng-if="inGroupWelcomeView()"></content-provider-splash><div class="sliderPane unselectable" ng-if="navigation.inContentSliderView()" ui-view="contentSlider"></div></div>'),e.put("views/loadNotificationDialog.html",'<div class="contentProviderLoadNotificationContent"><span class="pbi-spinner"></span><span class="contentProviderLoadNotificationMessage" localize="ParametersLoadingMessage"></span></div>'),e.put("views/localFileBrowser.html",'<div> <input class="browseFileInput" type="file" accept="{{fileDialogFilter}}"/></div>'),e.put("views/manageEmbedView.html",'<div class="sliderContentView manageEmbed"><user-group-header view-model="userGroupHeader"></user-group-header><div class="tableArea"><div class="centeredSpinner" ng-show="!viewModel.isLoaded"><spinner modern></spinner></div><div ng-show="viewModel.isLoaded" ng-switch="viewModel.embeddedResources.length> 0"><table class="manageEmbedTable" ng-switch-when="true"><thead><tr><th class="associatedReport" ng-click="updateSortProperty(\'associatedReport.displayName\')" localize="ManageEmbed_AssociatedReport_Header"></th><th class="status" ng-click="updateSortProperty(\'status\')" localize="ManageEmbed_Status_Header"></th><th class="dateCreated" ng-click="updateSortProperty(\'dateCreatedSortable\')" localize="ManageEmbed_DateCreated_Header"></th><th class="actions header"></th></tr></thead><tbody><tr ng-repeat="resource in viewModel.embeddedResources | orderBy:sortProperty:sortDescending track by (resource.contract.snapshotId + resource.contract.embedType)"><td class="itemField trimmedTextWithEllipsis" ng-bind="resource.associatedReport.displayName"></td><td class="itemField trimmedTextWithEllipsis" ng-bind="resource.status"></td><td class="itemField trimmedTextWithEllipsis" ng-bind="resource.dateCreated ? resource.dateCreated : resource.contract.date"></td><td class="actionsField"><a href="" class="glyphicon glyph-small pbi-glyph-more" ng-click="$event.stopPropagation();toggleFlyout($event, resource)" localize-tooltip="NavigationPane_OpenMenu"></a></td></tr></tbody></table><div class="manageEmbedTableEmpty" ng-switch-when="false"><i class="glyphicon pbi-glyph-warning glyph-med warningIcon"></i><h2 localize="ManageEmbed_NoEmbedCodesWarningTitle"></h2><p localize="ManageEmbed_NoEmbedCodesWarningText"></p></div></div></div></div>'),e.put("views/manageStorageView.html",'<div class="sliderContentView"><div class="manageStorage"><user-group-header view-model="userGroupHeader"></user-group-header><usage-bar usage-bar-model="viewModel.usageBarModel" view-model="viewModel"></usage-bar> <button class="primary submit" type="button" ng-if="!viewModel.isPremiumUser" ng-click="tryItFree()"><span ng-bind="viewModel.tryItFreeText"></span></button><div class="storageArea"><div class="own"><div class="tab" ng-click="viewModel.ownedByMeSelected=true" ng-switch on="viewModel.isMyWorkspace"><div localize="QuotaManagement_OwnedByMe" ng-switch-when="true"></div><div localize="QuotaManagement_OwnedByUs" ng-switch-when="false"></div><div class="highlight" ng-if="viewModel.ownedByMeSelected"></div></div><div class="tab" ng-click="viewModel.ownedByMeSelected=false"><div localize="QuotaManagement_OwnedByOthers"></div><div class="highlight" ng-if="!viewModel.ownedByMeSelected"></div></div></div><div class="usageList"><table class="usageListTable"><thead><tr><th class="delete"></th><th class="name header" localize="QuotaManagement_ModelName"></th><th class="size header" localize="QuotaManagement_ModelSize"></th><th class="type header" localize="QuotaManagement_ModelType"></th><th class="lastRefresh header" localize="QuotaManagement_ModelLastRefreshedTime"></th><th class="associated header" localize="QuotaManagement_AssociatedDashboards"></th><th class="associated header" localize="QuotaManagement_AssociatedReports"></th></tr></thead><tbody><tr class="ms-font-weight-regular" ng-repeat="usage in viewModel.usageDetails|filter:{ownedByMe: viewModel.ownedByMeSelected}|filter:isInVisibleDashboard(dashboardsFromModel)| orderBy:\'-sizeInMBs\'"><td class="deleteIcon" ng-click="deleteModel(usage)" localize-tooltip="QuotaManagement_DeleteButtonText"><div class="btn-delete"></div></td><td class="itemField" title="{{usage.name}}" ng-bind="usage.name"></td><td class="itemField" ng-bind="usage.sizeWithUnit"></td><td class="itemField" ng-bind="usage.typeText"></td><td class="itemField" ng-bind="usage.lastRefreshTime"></td><td class="itemField associated" title="{{usage.associatedDashboards}}" ng-bind="usage.associatedDashboards"></td><td class="itemField associated" title="{{usage.associatedReports}}" ng-bind="usage.associatedReports"></td></tr></tbody></table></div></div></div></div>'),e.put("views/navigationBar.html",'<div id="topBar" class="unselectable fadeIn" feature-switch-class="breadcrumbNavigationEnabled"><div class="topNavLeft"><o365-application-launcher></o365-application-launcher><pbi-logo config="logoConfig" ng-click="navigateToLanding()"></pbi-logo></div><breadcrumbs feature-switch="breadcrumbNavigationEnabled"></breadcrumbs><div class="topNavRight"><span class="topNavTrialStatus" ng-if="::getProTrialStatus()" ng-bind="::getProTrialStatus()" ng-click="promptForUpgrade()"></span> <button class="enterFullScreenBtn topNavButton" ng-if="fullScreen.fullScreenModeSupported" localize-tooltip="TopNav_FullScreen_Enter" ng-click="enterFullScreen()"><i class="glyphicon glyph-small pbi-glyph-fullscreen"></i></button> <button class="notificationsBtn topNavButton" localize-tooltip="UsersNotifications_BadgeTooltip" ng-click="showUserNotifications()"><i class="glyphicon glyph-small pbi-glyph-notification-center"></i> <span ng-if="getUserNotificationsCount()>0" class="badge" ng-class="{\'warning\': getHighestNotificationLevel(userNotifications) === 2}" ng-bind="getUserNotificationsCount()"></span></button> <button id="settingsMenuBtn" class="topNavButton" ng-click="showSettingsMenu($event)" localize-tooltip="TopNav_Settings"><i class="glyphicon glyph-small pbi-glyph-gear"></i></button> <button id="downloadMenuBtn" class="topNavButton" ng-click="showMenu(\'downloadMenu\', downloadMenu, $event)" localize-tooltip="TopNav_Download"><i class="glyphicon glyph-small pbi-glyph-download"></i></button> <button id="helpMenuBtn" class="topNavButton" ng-click="showMenu(\'helpMenu\', helpMenu, $event)" localize-tooltip="TopNav_Help"><i class="glyphicon glyph-small pbi-glyph-question"></i></button><pbi-button kind="icon" icon-name="smiley" icon-size="small" no-label="" class="topNavButton" ng-click="showFeedbackContextMenu($event)" localize-tooltip="TopNav_Feedback"></pbi-button> <button id="powerBIUserInfoBtn" class="powerBIUserInfoButton" ng-click="showMenu(\'powerBIUserInfo\', userInfoMenu, $event)" ng-style="userPhoto ? {\'background-image\': userPhoto, \'background-size\':\'cover\', \'background-position\':\'0px 0px\'} : \'\'"><i ng-if="!userPhoto" class="glyphicon glyph-small pbi-glyph-user"></i></button></div><div class="topNavCenter" feature-switch-not="breadcrumbNavigationEnabled"><div class="currentNavigationTitle" ng-show="navigation.inDashboardView()"><span ng-bind="currentDashboard"></span></div><div class="currentNavigationTitle" ng-show="navigation.inReportView()"><span ng-bind="currentReport"></span><span ng-show="reportChanged">*</span></div><div class="currentNavigationTitle" ng-show="navigation.inWorkbookView()"><span ng-bind="currentWorkbook"></span></div></div></div>'),e.put("views/navigationPane.html",'<div class="navigationPane unselectable" ng-class="{isCollapsed: isPaneExpanded === false, isFrozen: groupService.isInGroupTransition}" ng-attr-read-only="{{!canWrite()}}"><div class="innerLayout"><div class="expanderBtn slideFadeIn" ng-click="toggleNavigationPane()" ng-switch on="isPaneExpanded"><i class="glyphicon pbi-glyph-globalnavbutton" localize-tooltip="NavigationPane_Minimize" ng-switch-when="true"></i><i class="glyphicon pbi-glyph-globalnavbutton" localize-tooltip="NavigationPane_Expand" ng-switch-when="false"></i></div><div class="getDataBtn btn primary trimmedTextWithEllipsis slideFadeIn" ng-if="!navigation.inGroupWelcomeView() && !impersonation.impersonating" ng-disabled="groupService.isGroupTransitionDelayed" ng-click="switchToExternalContentViewerMode(navigatorPaneGetDataButton)" localize-tooltip="NavigationPane_GetData"><i class="glyphicon pbi-glyph-getdata glyph-small getDataIcon"></i><span class="label trimmedTextWithEllipsis" localize="NavigationPane_GetData"></span></div><div class="scrollRegion" ng-if="isPaneExpanded"><div class="homeSection" ng-if="homeDashboardEnabled && !impersonation.impersonating"> <button class="homeTitleButton trimmedTextWithEllipsisFullWidth" ng-click="navigateToHome()" localize-tooltip="NavigationPane_FeaturedDashboardTitle"><i class="glyphicon pbi-glyph-gauge glyph-small" ng-class="{\'highlight\': isOnHome}"></i><span class="btnLabel" localize="NavigationPane_FeaturedDashboardTitle"></span></button> <button class="homeMenuButton" dropdown-menu dropdown-class="navigationPaneGroupContextMenu" dropdown-dark-theme="false" dropdown-items="homeDashboardMenuItems" dropdown-orientation="horizontal" dropdown-on-item-selected="homeDashboardMenuItemSelected(selected)" ng-disabled="!home.isHomeDashboardSet"><i class="glyphicon moreIcon pbi-glyph-more"></i></button></div><div class="favoritesSection" ng-if="favoritesEnabled && !impersonation.impersonating" localize-tooltip="Favorites_NavPaneTitle"> <button class="favoritesTitleButton" ng-click="navigateToFavorites()"><i class="glyphicon pbi-glyph-favoritestar glyph-small" ng-class="{\'highlight\': isInFavoritesView()}"></i><span localize="Favorites_NavPaneTitle"></span></button></div><div class="collapsibleSection groupCollapsibleSection" ng-class="{isExpanded: isGroupsListExpanded === true }" ng-if="!impersonation.impersonating"><div class="sectionTitle trimmedTextWithEllipsis"><div class="collapseToggle" ng-click="toggleNavigationPaneSection(groupSection)"><i class="glyphicon pbi-glyph-chevrondownmedium"></i><div class="groupsTitle"><div ng-bind="groupService.activeGroup.displayName" title="{{groupService.activeGroup.displayName}}" class="trimmedTextWithEllipsis"></div></div><div class="waitingContainer" ng-show="groupService.isGroupTransitionDelayed"><spinner></spinner></div></div><group-actions ng-hide="groupService.activeGroup.isMyWorkspace || groupService.isInGroupTransition" group="groupService.activeGroup"></group-actions></div><ul class="navigationItemList"><group-navigation-pane-list-item ng-repeat="group in filteredGroups = (groupService.groups |filter: { isMyWorkspace:true })" ng-click="switchGroup(group)" view-model="group" selected="groupService.activeGroup.aadGroupId === group.aadGroupId"></group-navigation-pane-list-item></ul><div class="sectionTitle subsectionTitle trimmedTextWithEllipsis"><div class="subsectionTitleText" ng-switch on="groupService.groups.length === 1"> <button ng-switch-when="true" class="navigationPaneButton groupAddButton" ng-click="addGroup()" localize="NavigationPane_GroupsTitle_CreateGroup"></button><span ng-switch-when="false" localize="NavigationPane_GroupsTitle_HasGroups" localize-tooltip="NavigationPane_GroupsTitle_HasGroups"></span></div> <button class="navigationPaneButton addButton" ng-click="addGroup()" localize-tooltip="NavigationPane_CreateGroup"><i class="glyphicon pbi-glyph-add"></i></button></div><ul class="navigationItemList"><group-navigation-pane-list-item ng-repeat="group in filteredGroups = (groupService.groups |filter: { isMyWorkspace:false } | orderBy: \'displayName\' | limitTo: isListOfGroupsExpanded ? 99999 : 5)" ng-click="switchGroup(group)" view-model="group" selected="groupService.activeGroup.aadGroupId === group.aadGroupId"></group-navigation-pane-list-item></ul> <button class="groupsMoreLessButton" ng-show="groupService.groups.length> 5" ng-click="isListOfGroupsExpanded = !isListOfGroupsExpanded" ng-switch on="isListOfGroupsExpanded"><span ng-switch-when="true" localize="Groups_LessButtonText"/><span ng-switch-when="false" localize="Groups_MoreButtonText" class="groupsMoreButton"/></button></div><div class="freezableScrollRegion" ng-disabled="groupService.isGroupTransitionDelayed"><div class="viewArchivedContent collapsibleSection" ng-click="viewArchivedContent()" ng-if="showArchivedContentLink && !impersonation.impersonating"><div class="sectionTitle trimmedTextWithEllipsis"><span class="collapseToggle"><i class="glyphicon pbi-glyph-library glyph-small"></i><span localize="NavigationPane_ArchivedContent"></span></span></div></div><search-box filter="$ctrl.searchFilter" on-change="searchFilterChanged()"></search-box><div class="collapsibleSection ownershipFitlerCollapsibleSection" ng-if="!impersonation.impersonating"><div class="sectionTitle" tabindex="0" dropdown-overlay-invoke="ownershipFilterContextMenu" localize-tooltip="NavigationPane_OwnershipFilterShowTooltip" need-blur="true" horizontal="true"><span class="collapseToggle trimmedTextWithEllipsisFullWidth"><i class="glyphicon pbi-glyph-show glyph-small"></i><span localize="NavigationPane_OwnershipFilterShow"></span><span class="selectedOwnershipFilterText" ng-bind="selectedOwnershipFilter.text"></span></span> <button class="navigationPaneButton filterMoreButton"><i class="glyphicon pbi-glyph-more"></i></button></div></div><dropdown-overlay dropdown-overlay-name="ownershipFilterContextMenu"><dropdown-list class="ownershipFilterContextMenu"><dropdown-list-item ng-repeat="menuItem in ownershipFilterContextMenuItems" ng-click="ownershipFilterSelected(menuItem)" title="{{::menuItem.text}}"><div class="pbi-input"> <input type="radio" name="filterOption" ng-checked="selectedOwnershipFilter.filter===menuItem.filter"><label class="form-label" ng-bind="menuItem.text"></label></div></dropdown-list-item></dropdown-list></dropdown-overlay><div class="collapsibleSection dashboardCollapsibleSection" ng-class="{isExpanded: isDashboardsListExpanded === true }" ng-if="!impersonation.impersonating"><div class="sectionTitle"><span class="collapseToggle trimmedTextWithEllipsisFullWidth" ng-click="toggleNavigationPaneSection(dashboardSection)"><i class="glyphicon pbi-glyph-gauge glyph-small"></i><span localize="NavigationPane_DashboardsTitle" localize-tooltip="NavigationPane_DashboardsTitle"></span></span> <button class="navigationPaneButton addButton" ng-hide="groupService.isInGroupTransition" ng-click="activeAddDashboard()" localize-tooltip="NavigationPane_CreateDashboard"><i class="glyphicon pbi-glyph-add"></i></button></div><div class="addDashboardInputBox" ng-if="showAddDashboardInputBox"><text-input on-complete="addDashboard" validate="isDashboardNameValid" placeholder="addDashboardPlaceholder" is-focused="isAddDashboardInputboxFocused"></div><ul class="navigationItemList dashboardList"><dashboard-navigation-pane-list-item ng-repeat="dashboard in filteredDashboards = (viewModel.visibleDashboards | filter: ownershipFilterFunction(selectedOwnershipFilter.filter) | filter: { displayName: $ctrl.searchFilter } | orderBy: \'displayName\')" ng-click="switchActiveDashboard(dashboard.objectId)" view-model="dashboard" selected="dashboardDataService.activeDashboard.objectId === dashboard.objectId && navigation.inDashboardView()"></dashboard-navigation-pane-list-item><li localize="NavigationPane_NoDashboardText" localize-tooltip="NavigationPane_NoDashboardText" class="noItemText trimmedTextWithEllipsis" ng-if="viewModel.dashboards.length === 0"></li><li localize="NavigationPane_NoDashboardSearchResultText" localize-tooltip="NavigationPane_NoDashboardSearchResultText" class="noItemText trimmedTextWithEllipsis" ng-if="viewModel.dashboards.length> 0 && filteredDashboards.length === 0"></li></ul></div><div class="collapsibleSection reportCollapsibleSection" ng-class="{isExpanded: isReportsListExpanded === true }"><div class="sectionTitle"><span class="collapseToggle trimmedTextWithEllipsisFullWidth" ng-click="toggleNavigationPaneSection(reportSection)"><i class="glyphicon pbi-glyph-barchart glyph-small"></i><span localize="NavigationPane_ReportsTitle" localize-tooltip="NavigationPane_ReportsTitle"></span></span></div><ul class="navigationItemList reportList"><report-navigation-pane-list-item ng-repeat-start="reportResource in filteredReports = (reportsResourceList() | filter: ownershipFilterFunction(selectedOwnershipFilter.filter) | filter: { displayName: $ctrl.searchFilter } | orderBy:\'displayName\') track by reportResource.uniqueId" ng-if="reportResource.resourceType == 0" ng-click="openReport(reportResource)" view-model="reportResource" selected="navigation.inReportView() && reportService.currentActiveReport.id === reportResource.id"></report-navigation-pane-list-item><workbook-navigation-pane-list-item ng-repeat-end ng-if="reportResource.resourceType == 1" ng-click="viewWorkbook(reportResource)" view-model="reportResource" selected="navigation.inWorkbookView() && workbookService.currentActiveWorkbook.uniqueId === reportResource.uniqueId"></workbook-navigation-pane-list-item><li localize="NavigationPane_NoReportText" localize-tooltip="NavigationPane_NoReportText" class="noItemText trimmedTextWithEllipsis" ng-if="reportService.copyAndEditReports.length === 0 && workbookService.workbooks.length === 0"></li><li localize="NavigationPane_NoReportSearchResultText" localize-tooltip="NavigationPane_NoReportSearchResultText" class="noItemText trimmedTextWithEllipsis" ng-if="(reportService.copyAndEditReports.length> 0 || workbookService.workbooks.length > 0) && filteredReports.length === 0"></li></ul></div><div class="collapsibleSection datasetCollapsibleSection" ng-class="{isExpanded: isDatasetsListExpanded === true }" ng-if="!impersonation.impersonating"><div class="sectionTitle"><span class="collapseToggle trimmedTextWithEllipsisFullWidth " ng-click="toggleNavigationPaneSection(datasetSection)"><i class="glyphicon pbi-glyph-database glyph-small"></i><span localize="NavigationPane_DatasetsTitle" localize-tooltip="NavigationPane_DatasetsTitle"></span></span> <button class="navigationPaneButton addButton" ng-hide="groupService.isInGroupTransition" ng-click="switchToExternalContentViewerMode(navigatorPaneAddDatasetButton)" localize-tooltip="NavigationPane_GetData"><i class="glyphicon pbi-glyph-add"></i></button></div><ul class="navigationItemList datasetList"><dataset-navigation-pane-list-item ng-repeat="model in filteredModels = (modelService.sanitizedCopyAndEditModels | filter: ownershipFilterFunction(selectedOwnershipFilter.filter) | filter: { isHidden: \'!true\', displayName: $ctrl.searchFilter } | orderBy: \'displayName\')" ng-click="openModel(model)" view-model="model" selected="(navigation.inDatasetView() && reportService.currentActiveReport.id === model.id) || (navigation.inRowLevelSecurityView() && navigation.rowLevelSecurityModelId === model.id)"></dataset-navigation-pane-list-item><li class="trimmedTextWithEllipsis streamingDataset" localize="ManageDatasets_StreamingDatasets" ng-click="navigateToStreamingDatasets()"></li><li localize="NavigationPane_NoDatasetText" localize-tooltip="NavigationPane_NoDatasetText" class="noItemText trimmedTextWithEllipsis" ng-if="modelService.models.length === 0"></li><li localize="NavigationPane_NoDatasetSearchResultText" localize-tooltip="NavigationPane_NoDatasetSearchResultText" class="noItemText trimmedTextWithEllipsis" ng-if="modelService.models.length> 0 && filteredModels.length === 0"></li></ul></div></div></div></div></div>'),
e.put("views/navigationPaneListItem.html",'<li class="navPaneListItem" ng-right-click="showContextMenuIfEnabled()" ng-class="{selected: selected, active: showContextMenu}" data-id="{{::viewModel.id}}"><div class="navPaneItemIcon" ng-if="::!newStyle" ng-switch="isRefreshInProgress()"><spinner ng-switch-when="true" localize-tooltip="NavigationPane_RefreshInProgress"></spinner><div ng-switch-default><i ng-if="model.icon === 1 && model.source.packagePublishStatus !== 2 && model.source.contract.lastRefreshStatus !== 4" class="glyphicon pbi-glyph-share" localize-tooltip="NavigationPane_SharedWithMe"></i><i ng-if="model.icon === 5 && showIcon && showIcon()" class="glyphicon pbi-glyph-excel" localize-tooltip="NavigationPane_ExcelWorkbook"></i><i ng-if="getPackagePublishStatus && getPackagePublishStatus() === 2" class="warning glyphicon pbi-glyph-warning glyph-small" localize-tooltip="NavigationPane_RefreshPublishError"></i><i ng-if="showRefreshError && showRefreshError()" class="warning glyphicon pbi-glyph-warning glyph-small" tooltip tooltip-config="tooltipConfig" ng-click="$event.stopPropagation();showRefreshErrorDialog()"></i></div></div><editable-label class="navPaneListItemName smallFontSize" ng-class="{trimmed: model.source.isNew || model.source.packagePublishStatus === 2 || model.source.packagePublishStatus === 4, publishing: model.source.packagePublishStatus === 1, editing: model.isNameEditable}" view-model="::model.source" on-blur="::rename(newName)" validate="::isNameValid" disable-click="true" editable="model.isNameEditable"></editable-label><div class="navPaneItemIndicator" ng-if="::!newStyle"><i ng-if="model.source.isNew && model.source.packagePublishStatus !== 2 && model.source.packagePublishStatus !== 4 && !model.source.isRefreshInProgress" class="glyphicon pbi-glyph-asterisk"></i></div> <button class="navigationPaneButton itemActionsBtn" context-menu localize-tooltip="NavigationPane_OpenMenu" context="::model" show-context-menu="showContextMenu" ng-click="$event.stopPropagation();showContextMenuIfEnabled()"><i class="glyphicon pbi-glyph-more"></i></button></li>'),e.put("views/npsHost.html",'<div class="npsHost"></div>'),e.put("views/o365ApplicationLauncher.html",'<div class="o365Waffle"><div class="powerBILogo"><div class="waffle glyphicon pbi-glyph-waffle"></div></div><div id="o365AppLauncherContainer" class="o365AppLauncherContainer" ng-class="{o365AppLauncherContainerOldStyle: oldStyleAppLauncher === true}" tabindex="-1"><div id="o365AppLauncherUpperTriangle" class="uppertriangle" ng-show="oldStyleAppLauncher"></div><div class="o365LoadingContainer" ng-show="loadingAppLauncher"><div class="loadingspinner"><spinner></spinner></div><div class="o365AppLauncherLoading" localize="Loading_Text"></div></div><div class="o365AppLauncherError" ng-show="loadingError" localize="TopNav_O365ApplicationLauncher_Error"></div><div id="o365AppLauncherContent" class="o365AppLauncherContent" ng-show="!loadingAppLauncher"></div></div></div>'),e.put("views/pbiDataLoaderSpinner.html",'<div class="dataLoaderSpinner"><spinner class="xlarge"></spinner><h3 class="unselectable"></h3></div>'),e.put("views/pinTileDialog.html",'<div class="explorationPinTileDialog" ng-class="{liveReportTile: isLiveReport, pinDashboardTile: !isLiveReport}"><div class="tilePreview section" ng-class="{noTitle: !viewModel.hasTitle(viewModel.useDashboardFormatting ? viewModel.reportTile:viewModel.dashboardTile), noPreview: viewModel.needSaveReport, showPreview: !viewModel.needSaveReport,vrmPreview:!viewModel.hasTileFormatting }"><div class="liveReport" ng-if="isLiveReport"><span class="previewSection" localize="PinLiveReport_Preview"/><span localize="PinLiveReport_SavedState"/></div><div class="dashTile tilePreviewFrame" ng-show="viewModel.useDashboardFormatting"><ul><dashboard-tile view-model="viewModel.dashboardTile"></dashboard-tile></ul></div><div class="reportTile tilePreviewFrame" ng-show="!viewModel.useDashboardFormatting"><ul><dashboard-tile view-model="viewModel.reportTile"></dashboard-tile></ul></div><div class="tileFormatting section" ng-show="viewModel.hasTileFormatting"><div class="tileFormattingMessage pinTileBoldText" localize="ReportContainer_TileFormattingMessage"></div><div class="formatChoices tileRadioGroup"><ul><li><div class="pbi-input"> <input type="radio" name="cpRadio1" ng-disabled="viewModel.needSaveReport" ng-model="viewModel.useDashboardFormatting" ng-value="true" ng-change="updateFormatting()"><label class="form-label" localize="ReportContainer_UseDashboardFormattingRadioText"></label></div></li><li><div class="pbi-input"> <input type="radio" name="cpRadio2" ng-disabled="viewModel.needSaveReport" ng-model="viewModel.useDashboardFormatting" ng-value="false" ng-change="updateFormatting()"><label class="form-label" localize="ReportContainer_RetainReportFormattingRadioText"></label></div></li></ul></div></div></div><div class="dashboardSelector section"><div class="sectionContainer pinToDashboard" ng-model="viewModel.needSaveReport" ng-show="!viewModel.needSaveReport"><h2 class="title trimmedTextWithEllipsis" localize="ReportContainer_PinToDashboardTitle" localize-tooltip="ReportContainer_PinToDashboardTitle"></h2><div class="message" localize="ReportContainer_SelectExistingOrCreateNewDashboardMessage"></div><div class="pinMessage" localize="ReportContainer_WhereToPinMessage"></div><div class="dashboardChoices tileRadioGroup"><ul><li><div class="pbi-input" ng-disabled="viewModel.noExistingDashboard"> <input type="radio" class="existingDashRadio" ng-model="viewModel.useExistingDashboard" ng-value="true" ng-disabled="noPinnableDashboard()"><label class="form-label" localize="ReportContainer_UseExistingDashboardRadioText"></label></div></li><li><div class="pbi-input"> <input class="newDashRadio" type="radio" ng-model="viewModel.useExistingDashboard" ng-value="false"><label class="form-label" localize="ReportContainer_UseNewDashboardRadioText"></label></div></li></ul></div><div class="existingDashboardDropDown" ng-show="viewModel.useExistingDashboard"> <select ng-model="viewModel.selectedDashboardId"><option ng-selected="{{dashboard.id === dashboardDataService.activeDashboard.id}}" ng-repeat="dashboard in getDashboards() | filter:isDashboardPinnable | orderBy:\'displayName\'" value="{{dashboard.id}}" title="{{dashboard.displayName}}" ng-bind="dashboard.displayName"></option></select></div><div class="newNameTextBox animate-show section" ng-show="!viewModel.useExistingDashboard"> <input type="text" class="pinTileText inputDashboardTitle" ng-trim="false" min="1" maxlength="500" ng-model="viewModel.newDashboardName"/></div><div class="liveReportMessage" ng-if="isLiveReport"><span class="glyphicon pbi-glyph-info glyph-mini"/><span localize="PinLiveReport_RefreshMessage"/></div></div><div class="sectionContainer saveYourReport" ng-model="viewModel.needSaveReport" ng-hide="!viewModel.needSaveReport"><h2 class="title" localize="ReportAppBar_SaveAsDialogTitle"></h2><div class="message" localize="ReportContainer_NeedToSaveReportBeforePin"></div><div class="newNameTextBox animate-show section"> <input type="text" class="pinTileText inputReportTitle" ng-trim="false" min="1" maxlength="500" ng-model="viewModel.newReportName"/></div></div><div class="pinTileButtons"> <button class="cancelpinTile biButton" ng-click="cancel()" localize="PBI_Button_Label_Cancel"></button> <button class="pinTile biButton primary trimmedTextWithEllipsis" ng-click="pin()" ng-show="!viewModel.needSaveReport" ng-disabled="viewModel.isPinned || (!viewModel.useExistingDashboard && (!viewModel.newDashboardName || viewModel.newDashboardName.length===0))" ng-bind="::pinButtonText" ng-attr-title="{{::pinButtonText}}"></button> <button class="saveAndContinueBtn biButton primary" ng-click="saveAndContinue()" ng-show="viewModel.needSaveReport" ng-disabled="(!viewModel.newReportName || viewModel.newReportName.length===0)" localize="ReportContainer_SaveAndContinue"></button></div></div></div>'),e.put("views/publishContentPackView.html",'<div class="sliderContentView"><div class="publishContentPack"><user-group-header view-model="viewModel.userGroupHeader" feature-switch-not="breadcrumbNavigationEnabled"></user-group-header><article class="page" feature-switch-class="breadcrumbNavigationEnabled"><fieldset ng-disabled="viewModel.isPublishInProgress"><div class="publishContentPackHeader" ng-bind="viewModel.headerText" feature-switch-not="breadcrumbNavigationEnabled"></div><div class="contentPackAccess section"><div class="contentPackAccessChoose" localize="Publish_ChooseContentPackAccess"></div><div class="contentPackAccessChoices"><ul><li><div class="pbi-input"> <input type="radio" ng-model="viewModel.contentPackCreatedFor" name="publish" ng-value="false" ng-change="enableUpdateButton()"/><label class="trimmedTextWithEllipsis" localize="Publish_Group"/></div></li><li ng-class="::{disabled: isPublishContentPackFeatureDisabled}"><div class="pbi-input"> <input type="radio" ng-model="viewModel.contentPackCreatedFor" name="publish" ng-value="true" ng-change="enableUpdateButton()" ng-disabled="::isPublishContentPackFeatureDisabled"/><label class="trimmedTextWithEllipsis" localize="Publish_Organization"/></div><span class="glyphicon pbi-glyph-info glyph-mini" localize-tooltip="Publish_PublishContentPackToOrganizationDisabled"></span></li></ul></div></div> <span class="section" ng-if="viewModel.hasNotification" title="{{::viewModel.publishNotification}}">{{::viewModel.publishNotification}}</span><div class="contentPackGroups animate-show section" ng-show="!viewModel.contentPackCreatedFor"><emails-list view-model="viewModel.emailsList" allow-object-ids allow-security-groups allow-distribution-lists allow-unified-groups></emails-list><div class="groupsValidationError errorSection" ng-if="viewModel.hasGroupsValidationError"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind=viewModel.groupsValidationError></span></div></div><div class="contentPackTitle section"><h5 class="header" localize="Publish_Title"></h5><textarea id="inputTitle" ng-trim="false" maxlength="500" ng-model="viewModel.titleText" required ng-change="enableUpdateButton()"/><div class="titleValidationError errorSection" ng-if="viewModel.hasTitleValidationError"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind=viewModel.titleValidationError></span></div></div><div class="contentPackDescription section"><h5 class="header" localize="Publish_Description"></h5><textarea id="msg" ng-model="viewModel.descriptionText" ng-trim="false" maxlength="4000" ng-change="enableUpdateButton()"/><div class="descValidationError errorSection" ng-if="viewModel.hasDescriptionValidationError"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind=viewModel.descriptionTextValidationError></span></div></div><div class="contentPackImage section"><div class="showDefaultImage" ng-show="imageThumbView==\'\'"><i class="glyphicon glyph-large pbi-glyph-powerbi"></i></div><div style="background-image:url({{imageThumbView}})" ng-show="imageThumbView" class="imageForContentPack" id="contentPackImageId"></div><div class="imageUploadText"><div class="imageLinkOne"><span localize="Publish_UploadImage"></span> <input type="file" class="uploadImg" ng-disabled="viewModel.isPublishInProgress" ng-file-select="onFileSelect($files)" data-multiple="false" onclick="this.value = null" accept=".jpeg,.jpg,.png"/></div><span class="imageLinkTwo" localize="Publish_UploadText"></span><div class="infoMessage" localize="Publish_ImageDimensionText"/><div class="useDefaultImage" ng-show="imageThumbView!==\'\'"><a href="" ng-click="setDefaultImage(true)" class="useDefaultLink"><span localize="Publish_UseDefaultImage"></span></a></div><div class="imageValidationError errorSection" ng-if="viewModel.hasImageValidationError"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind=viewModel.imageValidationErrorText></span></div></div></div><div class="contentpackItemsToPublish"><h5 class="contentpackItemsToPublishHeader" localize="Publish_ItemsToPublish"/><div class="dashboardList"><h5 class="listHeader" localize="Publish_Dashboards"></h5><div class="listItems"><ul><li ng-repeat="dashboard in dashboards"> <label><input type="checkbox" ng-model="dashboard.isSelected" ng-disabled="!dashboard.isEnabled || dashboardHasLegacyReport(dashboard) || !canDashboardBeAdded(dashboard.id)" ng-change="toggleDashboard(dashboard)"/><span class="displayNameForContentPackItemstoPublish" ng-class="{disabled: dashboardHasLegacyReport(dashboard)}" ng-bind="dashboard.displayName" title="{{dashboard.displayName}}"/></label><span ng-if="dashboardHasLegacyReport(dashboard)" class="infoIcon glyphicon pbi-glyph-info glyph-mini" localize-tooltip="Dashboard_Report_Upgrade_Required"/><span ng-if="!canDashboardBeAdded(dashboard.id)" class="infoIcon glyphicon pbi-glyph-info glyph-mini" localize-tooltip="Dashboard_Contains_Unowned"/></li><li localize="NavigationPane_NoDashboardText" class="noItemText" ng-if="dashboards.length === 0"></li></ul></div></div><div class="reportList"><h5 class="listHeader" localize="Publish_Reports"></h5><div class="listItems"><ul><li ng-repeat-start="reportResource in filteredReportResources = (filteredReportResources | filter: { displayName: searchFilter } | orderBy:\'displayName\') track by reportResource.uniqueId" ng-if="reportResource.resourceType == 0"> <label><span class="glyphicon pbi-glyph-blank-mini glyph-mini"/><input type="checkbox" ng-model="reportResource.isSelected" ng-disabled="!reportResource.isEnabled || isLegacyReport(reportResource)" ng-change="toggleReport($index)"/> <span class="displayNameForContentPackItemstoPublish" ng-class="{disabled: !reportResource.isEnabled || isLegacyReport(reportResource)}" title="{{reportResource.displayName}}">{{reportResource.displayName}}</span></label><span ng-if="isLegacyReport(reportResource)" class="infoIcon glyphicon pbi-glyph-info glyph-mini" localize-tooltip="Report_Upgrade_Required"/></li><li ng-repeat-end ng-if="reportResource.resourceType == 1"> <label><span class="glyphicon pbi-glyph-excel glyph-mini"/><input type="checkbox" ng-model="reportResource.isSelected" ng-disabled="!reportResource.isEnabled" ng-change="toggleWorkbook($index)"/> <span class="displayNameForContentPackItemstoPublish" ng-class="{disabled: !reportResource.isEnabled}" title="{{reportResource.displayName}}">{{reportResource.displayName}}</span></label></li><li localize="NavigationPane_NoReportText" class="noItemText" ng-if="filteredReportResources.length === 0"></li></ul></div></div><div class="modelList"><h5 class="listHeader" localize="Publish_Datasets"></h5><div class="listItems"><ul><li ng-repeat="model in models"> <label><input type="checkbox" ng-model="model.isSelected" ng-disabled="!model.isEnabled" ng-change="enableUpdateButton()"/><span class="displayNameForContentPackItemstoPublish" ng-class="{disabled: !model.isEnabled}" ng-bind="model.displayName" title="{{model.displayName}}"/></label></li><li localize="NavigationPane_NoDatasetText" class="noItemText" ng-if="models.length === 0"></li></ul></div></div></div><div class="itemsNotSelectedError errorSection" ng-if="viewModel.hasNoItemsSelected"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind=viewModel.itemsNotSelectedError></span></div><div class="publishDataNotification"><span localize="Publish_DataAccessNotification"></span><a href="https://go.microsoft.com/fwlink/?LinkID=616059" target="_blank"><span localize="LearnMore"></span></a></div><div ng-if="showTemplateUI" class="templateUI trimmedTextWithEllipsis"> <label ng-class="{disabled: !isTemplatingAllowed()}" title="{{getLocalizedTemplatizeModelToolTip()}}"><input type="checkbox" ng-model="viewModel.isTemplate" ng-disabled="!isTemplatingAllowed() || viewModel.providerKey"/><span localize="PublishContentPack_TemplatizeModel" class="templatizeModelDescription"/><a href="https://go.microsoft.com/fwlink/?LinkId=820986" target="_blank"><span localize="LearnMore"/></a></label></div><div class="templateValidationError errorSection" ng-if="viewModel.hasTemplatePublishError"><i class="glyphicon glyph-small pbi-glyph-error"></i><span class="message" ng-bind="viewModel.templatePublishErrorText" ng-attr-title="viewModel.templatePublishErrorText"></span><a class="learnMoreErrorLink" href="https://go.microsoft.com/fwlink/?LinkId=820986" target="_blank"><span localize="LearnMore"/></a></div><div class="publishDataNotification publishDataNotificationWarning" ng-if="isRemoteWorkbookSelected"><span localize="Publish_ExcelWorkbookNeedPermissionsMessage"></span><a href={{workbooksWebUri}} target="_blank" class="goToOneDriveMessageInfo" ng-switch="getWorkookPermissionsMessageType()"><span localize="Sharing_GoToWorkBookNotificationLink" ng-switch-when="0"></span><span localize="Sharing_GoToGroupSharedDocumentNotificationLink" ng-switch-when="2"></span></a></div><div class="messageInfo"><div class="publishActionButtons"> <button class="cancel biButton" ng-click="cancelPublishContentPack()" ng-disabled="viewModel.isPublishCancelled " localize="Publish_ContentPackCancelButton"></button> <button class="publish biButton primary" ng-click="publishContentPack()" ng-disabled="viewModel.isPublishInProgress || viewModel.isUpdateScenario || (dashboards.length===0 && reports.length===0 && models.length===0 && workbooks.length===0 ) || !isPublishAllowed()" ng-bind="viewModel.publishButtonText"></button><span class="messageInfoErrorSection" ng-if="viewModel.isPublishOrUpdateError" ng-bind="viewModel.publishOrUpdateError"/><spinner class="publishActionSpinner" ng-if="viewModel.isPublishInProgress"></spinner></div></div></fieldset></article></div></div>'),e.put("views/qna/qnaContainer.html",'<div class="dashboardContainerView isNavigationPaneEnabled qnaMode" ng-class="{isMainContentDisabled: collapsiblePaneMode !== 0,                isSelectedTileHighlighted: collapsiblePaneMode === 1}" ng-switch="modelsSupportQna"><div class="mainContent" ng-switch-when="true"><div class="header" ng-cloak><div class="qnaAppBar appBar"><div class="appBarSection left"><ul><li> <button class="backBtn" ng-click="navigation.navigateBack()"><i class="glyphicon pbi-glyph-arrowleft glyph-small"></i><span class="activeDashboardLabel appBarTitle displayOnSmallScreen" localize="QnA_ExitQnA"></span></button></li></ul></div><div class="appBarSection right" ng-if="newQnaEnabled"><ul><li class="pinBtn" ng-if="pinIconState.visible && !!pinIconState.enabled" ng-switch=""> <button id="pinVisualBtn" class="in_navigationBtn infoNavActionItem" localize-tooltip="PinVisual_ToolTip" ng-click="pinQnAVisual($event)"><i class="glyphicon pbi-glyph-pinned pinButton glyph-small"></i><span class="appBarMenuItem" localize="PinVisual_ToolTip"></span></button></li></ul></div></div><div class="dashboardControlsWrapper" ng-if="!newQnaEnabled" ng-cloak><div class="legacyQnaWrapper"><div class="qnaQuestionBoxWrapper"><question-box-container get-additional-o-data-filter="getAdditionalODataFilter" interpret-listener="infoNavContainerInterpretListener" output="questionBoxOutput" usage-reporting-enabled="allowQnaDataCollection" models="viewModel.models"></question-box-container><span ng-if="modelSupportsQna" class="qnaStart smallFontSize"><a ng-click="showQnaStart()" localize="QnaStart_EntryLink"></a></span></div><section class="infoNavActions"><span ng-if="pinIconState.visible" ng-switch="!!pinIconState.enabled"><span id="pinVisualBtn" class="in_navigationBtn infoNavActionItem" localize-tooltip="PinVisual_ToolTip" ng-click="pinQnAVisual($event)" ng-switch-when="true"><i class="glyphicon pbi-glyph-pinned pinButton"></i></span><span id="pinVisualBtn" class="in_navigationBtn infoNavActionItem infoNavActionItemDisabled" localize-tooltip="PinVisual_DisabledForReportPagesToolTip" ng-switch-when="false"><i class="glyphicon pbi-glyph-pinned pinButton"></i></span></span><span id="userFeedbackBtn" class="in_navigationBtn infoNavActionItem" ng-if="questionBoxOutput.showQnaFeedback" localize-tooltip="UtteranceFeedbackTooltip" ng-click="questionBoxOutput.showUserFeedbackDialog()"><i class="glyphicon pbi-glyph-flag"></i></span></section></div></div></div><div class="dashboardSliderMain"><div class="infoNavVisualizationModeView"><info-nav-container host-service="infoNavHostService" question-box-output="questionBoxOutput" interpret-listener="infoNavContainerInterpretListener" usage-reporting-enabled="allowQnaDataCollection" models="viewModel.models" get-additional-o-data-filter="getAdditionalODataFilter"></info-nav-container></div></div></div><div class="waterMarkMsg unselectable" ng-switch-when="false"><i class="glyphicon pbi-glyph-warning glyph-med warningIcon"></i><p>{{::unsupportedModelMessage}}</p></div></div>'),e.put("views/qrCodeDialog.html",'<div class="qrCodeDialog"><div class="qrCodePreview section"><div class="tileHeader"><div class="heading title"><div class="displayText" ng-bind="viewModel.displayText"></div></div><div class="heading subTitle"><div class="subDisplayText" ng-bind="viewModel.subDisplayText"></div></div></div> <img class="qrCode" ng-src="{{qrCodeImageDataUrl}}"/></div><div class="qrCodeInstructions"><h2 class="title" localize="QRCodeDialog_Title"></h2><div class="message" ng-bind="viewModel.dialogMessage"></div><div class="notification"><i class="glyphicon pbi-glyph-info glyph-small"></i><div class="notificationBody" ng-bind="viewModel.notificationMessage"></div><div class="qrCodeButtons"> <button class="done biButton" ng-click="hideDialog()" localize="QRCodeDialog_Done"></button><a class="downloadButton btn primary" ng-disabled="!qrCodeCanvas" localize="QRCodeDialog_Download" ng-href="{{qrCodeImageDataUrl}}" ng-click="tryIEDownloadQRCodeImage()" download="{{qrCodeImageFileName}}"></a></div></div></div></div>'),e.put("views/qrCodeProgressDialog.html",'<div class="qrLoading" ng-click="$event.stopPropagation()"><div class="content"><div class="information"><div class="title" localize="QRCodeProgressDialog_Title"/><spinner class="large"></spinner></div> <button class="primary" ng-click="hideDialog()" localize="GetData_Cancel"></button></div></div>'),e.put("views/requestDashboardAccess.html",'<div class="requestDashboardAccess unselectable"><i class="glyphicon pbi-glyph-error glyph-large"></i><div class="contentArea"><div><h2>{{::viewModel.splashMessage}}</h2></div> <button ng-show="!viewModel.isRequestActive" class="primary actionButton" ng-disabled="viewModel.isRequestActive" ng-click="requestAccess()" localize="RequestDashboardAccess_RequestAccessButton"></button><div class="spinner" ng-show="viewModel.isRequestActive"><spinner></spinner></div></div></div>'),e.put("views/requestDashboardAccessModal.html",'<div class="requestDashboardAccessModal unselectable"><div><div> <span>{{::viewModel.requestAccessDescription}}</span></div><div><textarea maxlength="1000" ng-model="viewModel.message" ng-attr-placeholder="{{viewModel.placeholderText}}"></textarea></div></div></div>'),e.put("views/settings/manageDatasets.html",'<div class="mainContent"><div class="header" ng-cloak><div class="dashboardAppBar appBar" ng-if="$ctrl.inDatasetsView()"><div class="appBarSection left"><ul feature-switch-not="breadcrumbNavigationEnabled"><li class="label workspaceLabel"> <button class="appBarTitle" title="{{$ctrl.activeGroupName}}" ng-click="$ctrl.navigateToContentList()" ng-disabled="!$ctrl.listViewEnabled" ng-bind="$ctrl.activeGroupName"></button></li><li class="label breadcrumbLabel"><i class="glyphicon pbi-glyph-arrowright glyph-small"></i></li><li class="label datasetsLabel"><span class="appBarTitle" ng-if="$ctrl.activeTab === 1" localize="NavigationPane_ManageDatasets"></span><span class="appBarTitle" ng-if="$ctrl.activeTab === 2" localize="NavigationPane_StreamingData"></span></li></ul></div><div class="appBarSection right"><ul><li class="label right" ng-if="$ctrl.activeTab === 1"> <button ng-click="$ctrl.navigateToGetData()" localize-tooltip="ManageDatasets_AddDataset"><i class="glyphicon pbi-glyph-add glyph-small icon"></i><span class="appBarMenuItem" localize="ManageDatasets_AddDataset"></span></button></li><li class="label right" ng-if="$ctrl.activeTab === 2"> <button ng-click="$ctrl.showStreamingDatasetGalleryPane()" localize-tooltip="ManageDatasets_AddStreamingDataset"><i class="glyphicon pbi-glyph-add glyph-small icon"></i><span class="appBarMenuItem" localize="ManageDatasets_AddStreamingDataset"></span></button></li></ul></div></div></div><div class="dashboardSliderMain"><div class="manageDatasetsPane flexbox"><section class="manageDatasetsOptionsList item-auto"><div class="optionTab label-med" ng-class="{selected: $ctrl.activeTab === 1}" ng-click="$ctrl.setActiveTab(1)" ng-if="$ctrl.listViewEnabled" localize="NavigationPane_ManageDatasets"></div><div class="optionTab label-med" ng-class="{selected: $ctrl.activeTab === 2}" ng-click="$ctrl.setActiveTab(2)" localize="NavigationPane_StreamingData"></div></section><section><div class="search"> <input placeholder="{{$ctrl.placeholderText}}" ng-model="$ctrl.searchFilter" ng-model-options="{ debounce: 300 }" fast-keydown="$ctrl.resetSearchOnEsc($event)" autofocus/></div></section><section class="contentContainer item-fill"><section ng-if="$ctrl.activeTab === 1"><section class="headerSection"><table><thead class="fixed-header"><tr><th class="datasetNameCell"> <button ng-click="order(\'displayName\')"> <span localize="ManageDatasets_Name"/>&nbsp;<span ng-if="predicate === \'displayName\'"><i class="glyphicon pbi-glyph-chevrondownmedium glyph-small" ng-show="reverse"></i><i class="glyphicon pbi-glyph-chevronupmedium glyph-small" ng-hide="reverse"></i></span></button></th><th class="lastRefreshCell"> <button ng-click="order(\'lastRefreshTime\')"> <span localize="ManageDatasets_LastRefresh"/>&nbsp;<span ng-if="predicate === \'lastRefreshTime\'"><i class="glyphicon pbi-glyph-chevrondownmedium glyph-small" ng-show="reverse"></i><i class="glyphicon pbi-glyph-chevronupmedium glyph-small" ng-hide="reverse"></i></span></button></th><th class="nextRefreshCell"> <button ng-click="order(\'nextRefreshTime\')"> <span localize="ManageDatasets_NextRefresh"/>&nbsp;<span ng-if="predicate === \'nextRefreshTime\'"><i class="glyphicon pbi-glyph-chevrondownmedium glyph-small" ng-show="reverse"></i><i class="glyphicon pbi-glyph-chevronupmedium glyph-small" ng-hide="reverse"></i></span></button></th><th class="optionsCell"></th></tr></thead></table></section><section class="bodySection"><table class="friend"><tbody><tr class="datasetRow" ng-repeat-start="model in filteredModels= (modelService.sanitizedCopyAndEditModels | then:$ctrl.mapDateObjects | filter: {displayName: $ctrl.searchFilter, isHidden: \'!true\'}) | orderBy:predicate:reverse" ng-click="$ctrl.toggleRowState($index)"><td class="datacell datasetNameCell" ng-class="{\'thinBorder\': $ctrl.activePosition === $index, \'publishing\': $ctrl.isPackagePublishInProgress(model.contract.packagePublishStatus)}"><span class="datasetDisplayName trimmedTextWithEllipsis" ng-bind="model.displayName" ng-attr-title="{{model.displayName}}"></span><dataset-icon-container view-model="model" refresh-related="false"/></td><td class="datacell lastRefreshCell" ng-class="{\'thinBorder\': $ctrl.activePosition === $index, \'publishing\': $ctrl.isPackagePublishInProgress(model.contract.packagePublishStatus)}"><dataset-icon-container class="refreshDatasetContainer" view-model="model" refresh-related="true"/> <span class="lastRefreshTime">{{$ctrl.convertRefreshTimeToJsDateTime(model.contract.lastRefreshTime) | date:\'h:mm a MM.dd.yyyy\'}}</span></td><td class="datacell nextRefreshCell" ng-class="{\'thinBorder\': $ctrl.activePosition === $index, \'publishing\': $ctrl.isPackagePublishInProgress(model.contract.packagePublishStatus)}"> {{$ctrl.convertRefreshTimeToJsDateTime(model.contract.nextRefreshTime) | date:\'h:mm a MM.dd.yyyy\'}}</td><td class="datacell optionsCell" ng-class="{\'thinBorder\': $ctrl.activePosition === $index, \'publishing\': $ctrl.isPackagePublishInProgress(model.contract.packagePublishStatus)}"> <button ng-click="$ctrl.showOptions(model, $index); $event.stopPropagation();" dropdown-overlay-invoke="datasetMenu" prefer-left="true" need-blur="true" disable-animation="true"><i class="glyphicon moreIcon pbi-glyph-more"></i></button></td></tr><tr ng-repeat-end ng-if="$ctrl.activePosition === $index"><td class="metadatacell" colspan="3"><metadata-container view-model="model"/></td><td class="metadatacell" ng-click="$ctrl.toggleRowState($index)"><i class="glyphicon pbi-glyph-chevronupmedium glyph-small"/></td></tr></tbody></table></section></section><section ng-if="$ctrl.activeTab === 2"><section class="headerSection"><table><thead class="fixed-header"><tr><th class="datasetNameCell"> <button ng-click="order(\'displayName\')"> <span localize="ManageDatasets_Name"/>&nbsp;<span ng-if="predicate === \'displayName\'"><i class="glyphicon pbi-glyph-chevrondownmedium glyph-small" ng-show="reverse"></i><i class="glyphicon pbi-glyph-chevronupmedium glyph-small" ng-hide="reverse"></i></span></button></th><th class="datasetTypeCell"> <button><span localize="StreamingDatasetModel_Type"></span></button></th><th class="associatedDashboardsCell"> <button><span localize="StreamingDatasetModel_UsedInDashboards"></span></button></th><th class="historicalCell"> <button><span localize="StreamingDatasetModel_Historical"></span></button></th><th class="realTimeActionsCell"> <button><span localize="StreamingDatasetModel_Actions"></span></button></th></tr></thead></table></section><section class="bodySection"><table class="friend" ng-if="modelService.streamingModels.length> 0"><tbody><tr ng-repeat="model in filteredModels= (modelService.streamingModels | filter: {displayName: $ctrl.searchFilter}) | orderBy:predicate:reverse"><td class="datacell datasetNameCell"><span class="datasetDisplayName trimmedTextWithEllipsis" ng-bind="model.displayName" ng-attr-title="{{model.displayName}}"></span><dataset-icon-container view-model="model" refresh-related="false"/></td><td class="datacell datasetTypeCell trimmedTextWithEllipsis" ng-bind="::$ctrl.getModelType(model)" ng-attr-title="::$ctrl.getModelType(model)"></td><td class="datacell associatedDashboardsCell trimmedTextWithEllipsis" ng-bind="::$ctrl.getDashboardsForModel(model)" ng-attr-title="{{::$ctrl.getDashboardsForModel(model)}}"></td><td class="datacell historicalCell trimmedTextWithEllipsis" ng-switch="model.realTimeMode"><span ng-switch-when="1" localize="Disabled"></span><span ng-switch-when="2" localize="Enabled"></span></td><td class="datacell realTimeActionsCell"><div class="actionContents"><i class="glyphicon glyph-small actionIcon {{::action.iconClass}}" ng-repeat="action in $ctrl.getStreamingDatasetActions(model) track by action.action" ng-click="$ctrl.streamingDatasetActionSelected(model, $parent.$index, action)" ng-attr-title="{{::action.text}}"></i></div></td></tr></tbody></table><div class="noDatasets" ng-if="modelService.streamingModels.length === 0"><i class="glyphicon glyph-large pbi-glyph-info"></i><h3 localize="StreamingDatasetModel_NoStreamingDatasets"></h3><span localize="StreamingDatasetModel_NoStreamingDatasetsInfo" localize-fragments><a fragment-index="0" href="https://go.microsoft.com/fwlink/?linkid=822071" target="_blank" localize="LearnMore"></a></span></div></section></section></section><dropdown-overlay dropdown-overlay-name="datasetMenu"><ul class="angular-dropdown active datasetActionList"><li ng-repeat="item in $ctrl.datasetMenuActions" class="dropdown-item" ng-mousedown="$ctrl.datasetMenuActionSelected(item); $event.stopPropagation();"><a href="" target="_blank"><div class="dropdown-content"><div class="dropdown-label" ng-bind="::item.text"></div></div></a></li></ul></dropdown-overlay></div></div></div>'),e.put("views/settings/refreshStatusView.html",'<div class="topMarginTextContainer" ng-switch="lastRefreshFailed"><div class="lastRefreshResult" ng-switch-when="false"><span ng-bind="lastRefreshStatus"/></div><div class="lastRefreshFailed" ng-switch-when="true"><inline-name-value-pairs name-value-pairs="lastRefreshHistoryDetails" show-title="true" detail-expand="false" class="expandableBlockWarning"><span ng-bind="lastRefreshStatus"/><br/><span ng-bind="lastRefreshFailureMessage"/></inline-name-value-pairs></div><div><span ng-bind="nextRefreshTime" ng-show="viewModel.refreshSettings && viewModel.refreshSettings.refreshEnabled"/></div></div>'),
e.put("views/settings/refreshWelcomeView.html",'<div class="topMarginTextContainer"><div class="sectionPoints"><div ng-if="!enterpriseGatewayETLEnabled"><div localize="SettingsDataset_Welcome_Before_Configuration"></div><ol class="gatewayInstructionList"><li><div class="installGateway" ng-switch="isPersonalGatewayRunning"><div ng-switch-when="false"><div class="gatewayInstallInfo"><i class="arrowRight glyphicon pbi-glyph-rightarrow glyph-mini"></i><span localize="SettingsDataset_Install_OnPrem_Gateway" localize-fragments><a fragment-index="0" localize="SettingsDataset_OnPrem_Gateway_InstallNow" target="_blank" href={{::onPremGatewayDownloadLink}}></a><a fragment-index="1" localize="LearnMore" target="_blank" href="https://go.microsoft.com/fwlink/?LinkID=534232"></a></span></div><div class="gatewayInstallInfoSubtitle"><i class="infoCircle glyphicon pbi-glyph-info glyph-small"></i><div class="gatewayDownloadInfoContainer"><span localize="SettingsDataset_OnPrem_Gateway_InstallPage"></span><a ng-bind=::onPremGatewayDownloadLink target="_blank" href={{::onPremGatewayDownloadLink}}></a></div></div></div><div ng-switch-when="true"><i class="check glyphicon pbi-glyph-checkmark glyph-small"></i> <span localize="SettingsDataset_Install_OnPrem_Gateway_Succeed" localize-fragments><span fragment-index="0">{{personalGateway.gatewayAnnotation.machineName}}</span><a fragment-index="1" localize="LearnMore" target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=627094"></a></span></div></div></li><li><div class="provideCredential"><div ng-switch="isPersonalGatewayRunning"><span ng-switch-when="false" localize="SettingsDataset_Provide_Credential"></span><div ng-switch-when="true" ng-switch="viewModel.datasources && viewModel.hasDatasourceWithWrongCredentials"><div ng-switch-when="true"><i class="arrowRight glyphicon pbi-glyph-rightarrow glyph-mini"></i><span localize="SettingsDataset_Provide_Credential"></span></div><div ng-switch-when="false"><i class="check glyphicon pbi-glyph-checkmark glyph-small"></i><span localize="SettingsDataset_Provide_Credential_Valid"></span></div></div></div></div></li><li><div class="SetSchedule" ng-switch="refreshScheduleComplete"><div ng-switch-when="false"><i class="arrowRight glyphicon pbi-glyph-rightarrow glyph-mini" ng-show="isPersonalGatewayRunning && viewModel.datasources &&!viewModel.hasDatasourceWithWrongCredentials"></i><span localize="SettingsDataset_SetScheduleRefresh"></span></div><div ng-switch-when="true"><i class="check glyphicon pbi-glyph-checkmark glyph-small"></i><span localize="SettingsDataset_SetScheduleRefresh_Done"></span></div></div></li></ol></div><div ng-if="enterpriseGatewayETLEnabled && selectGatewayModel.enterpriseGateways.length < 1"><div localize="SettingsDataset_Welcome_Before_Configuration"></div><ol class="gatewayInstructionList"><li><div class="installGateway" ng-switch="isPersonalGatewayRunning"><div ng-switch-when="false"><div class="gatewayInstallInfo"><i class="arrowRight glyphicon pbi-glyph-rightarrow glyph-mini"></i><span localize="SettingsDataset_Install_OnPrem_Gateway" localize-fragments><a fragment-index="0" localize="SettingsDataset_OnPrem_Gateway_InstallNow" target="_blank" href="//go.microsoft.com/fwlink/?LinkID=534231"></a><a fragment-index="1" localize="LearnMore" target="_blank" href="//go.microsoft.com/fwlink/?LinkId=627094"></a></span></div><div class="gatewayInstallInfoSubtitle"><i class="infoCircle glyphicon pbi-glyph-info glyph-small"></i><div class="gatewayDownloadInfoContainer"><span localize="SettingsDataset_OnPrem_Gateway_InstallPage"></span> <a target="_blank" href="//go.microsoft.com/fwlink/?LinkID=534231">//go.microsoft.com/fwlink/?LinkID=534231</a></div></div></div><div ng-switch-when="true"><i class="check glyphicon pbi-glyph-checkmark glyph-small"></i> <span localize="SettingsDataset_Install_OnPrem_Gateway_Succeed" localize-fragments><span fragment-index="0">{{personalGateway.gatewayAnnotation.machineName}}</span><a fragment-index="1" localize="LearnMore" target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=627094"></a></span></div></div></li><li><div class="provideCredential"><div ng-switch="isPersonalGatewayRunning"><span ng-switch-when="false" localize="SettingsDataset_Provide_Credential"></span><div ng-switch-when="true" ng-switch="viewModel.datasources && viewModel.hasDatasourceWithWrongCredentials"><div ng-switch-when="true"><i class="arrowRight glyphicon pbi-glyph-rightarrow glyph-mini"></i><span localize="SettingsDataset_Provide_Credential"></span></div><div ng-switch-when="false"><i class="check glyphicon pbi-glyph-checkmark glyph-small"></i><span localize="SettingsDataset_Provide_Credential_Valid"></span></div></div></div></div></li><li><div class="SetSchedule" ng-switch="refreshScheduleComplete"><div ng-switch-when="false"><i class="arrowRight glyphicon pbi-glyph-rightarrow glyph-mini" ng-show="isPersonalGatewayRunning && viewModel.datasources &&!viewModel.hasDatasourceWithWrongCredentials"></i><span localize="SettingsDataset_SetScheduleRefresh"></span></div><div ng-switch-when="true"><i class="check glyphicon pbi-glyph-checkmark glyph-small"></i><span localize="SettingsDataset_SetScheduleRefresh_Done"></span></div></div></li></ol><span localize="SettingsDataset_AboutEnterpriseGateway" localize-fragments><a fragment-index="0" localize="LearnMore" target="_blank" href="//go.microsoft.com/fwlink/?LinkId=627094"></a></span></div></div></div>'),e.put("views/settings/settingsCloseAccountView.html",'<div class="dashboardSettings" ng-cloak><div class="deleteAccountSettings"><h1 class="dashboardSettingsTitle" localize="Settings_CloseAccount"></h1><div ng-if="::canCloseAccount"><div class="description" localize="Settings_CloseAccount_Description"></div><div class="inputTitle" localize="Settings_CloseAccount_WhyAreYouClosingYourAccount"></div> <select ng-model="reason"><option localize="Settings_CloseAccount_Reason_PlaceHolder" value="" disabled selected></option><option localize="Settings_CloseAccount_Reason_HardToUse" value="Settings_CloseAccount_Reason_HardToUse"></option><option localize="Settings_CloseAccount_Reason_TooManyErrors" value="Settings_CloseAccount_Reason_TooManyErrors"></option><option localize="Settings_CloseAccount_Reason_MissingFeatures" value="Settings_CloseAccount_Reason_MissingFeatures"></option><option localize="Settings_CloseAccount_Reason_NotValuableEnoughToMe" value="Settings_CloseAccount_Reason_NotValuableEnoughToMe"></option><option localize="Settings_CloseAccount_Reason_DidntNeedToUseIt" value="Settings_CloseAccount_Reason_DidntNeedToUseIt"></option><option localize="Settings_CloseAccount_Reason_ForgotAboutIt" value="Settings_CloseAccount_Reason_ForgotAboutIt"></option><option localize="Settings_CloseAccount_Reason_HaventHadTimeToUseIt" value="Settings_CloseAccount_Reason_HaventHadTimeToUseIt"></option><option localize="Settings_CloseAccount_Reason_DecidedToUseOtherSoftware" value="Settings_CloseAccount_Reason_DecidedToUseOtherSoftware"></option></select><div class="inputTitle" localize="Settings_CloseAccount_AnythingElseYouWantToTellUs"></div><textarea ng-model="userComment" rows="3"></textarea></div><div class="warning inlineWarning" ng-if="::!canCloseAccount"><div class="message"><span class="glyphicon glyph-small pbi-glyph-info"></span><span localize="Settings_CloseAccount_ContactYourAdmin"></span></div></div> <button class="closeAccountBtn primary" ng-disabled="::!canCloseAccount" ng-click="promptCloseAccount()" localize="Settings_CloseAccount"></button></div></div>'),e.put("views/settings/settingsDashboardsView.html",'<div class="settingsDatasets"><div class="settingsDatasetsLeftColumn" ng-if="viewModel && viewModel.dashboards && viewModel.dashboards.length !== 0"><div class="datasetsList"><ul><li ng-repeat="dashboard in viewModel.dashboards | orderBy: \'name\' track by dashboard.dashboardId" ng-click="onDashboardSelected(dashboard.objectId)" ng-class="{selected: viewModel.currentDashboardId === dashboard.objectId}"><span ng-bind="::dashboard.name"/></li></ul></div></div><div class="settingsDatasetsRightColumn" ng-if="viewModel && viewModel.dashboards && viewModel.dashboards.length !== 0"><div ng-repeat="dashboard in viewModel.dashboards track by dashboard.objectId"><settings-dashboard view-model="dashboard" ng-if="viewModel.currentDashboardId === dashboard.objectId"/></div></div></div>'),e.put("views/settings/settingsDashboardView.html",'<form name="dashboardSettingsForm" class="dashboardSettings" ng-cloak><div class="dashboardSettingsTitle">{{::sectionTitle}}</div><div class="dashboardSettingsSection"><div class="dashboardSettingsSectionTitle" localize="SettingsDashboard_QnA_Title"/><div class="dashboardSettingsInfo"><span localize="SettingsDashboard_QnA_Information" localize-fragments><a fragment-index="0" href="https://go.microsoft.com/fwlink/?LinkId=808174" target="_blank" localize="LearnMore"/></span></div><div class="dashboardSettingsCheckbox"> <label><input name="qnaEnabled" ng-model="qnaEnabled" type="checkbox"/><span class="dashboardSettingsQnaEnabledSpan" localize="SettingsDashboard_QnA_QnaEnabledMessage"/></label></div><div class="warning" ng-show="qnaEnabled && !viewModel.hasQnaSupportedModel"><i class="glyphicon pbi-glyph-warning glyph-small"/><span localize="SettingsDashboard_QnA_QnaUnavailableWarning"/></div></div><div class="dashboardSettingsSection"><div class="dashboardSettingsSectionTitle" localize="SettingsDashboard_Gravity_Title"/><div class="dashboardSettingsInfo"><span localize="SettingsDashboard_Gravity_Info"/></div><div class="dashboardSettingsCheckbox"> <label><input name="gravityEnabled" ng-model="gravityEnabled" type="checkbox"/><span class="dashboardSettingsGravityEnabledSpan" localize="SettingsDashboard_Gravity_GravityEnabledMessage"/></label></div><div class="warning" ng-show="gravityEnabled"><i class="glyphicon pbi-glyph-warning glyph-small"></i><div localize="SettingsDashboard_Gravity_GravityNoticeMessage"></div></div></div><div class="dashboardSettingsSection" ng-hide="!dataClassifications || dataClassifications.length==0"><div class="dashboardSettingsSectionTitle" localize="SettingsDashboard_DataClassification_Title"/><div> <select ng-options="option.id as option.name for option in dataClassifications" ng-model="dataClassificationId" ng-change="onDataClassificationIdChanged()"></select><div class="warning" ng-show="isNonDefaultDataClassificationSelected"><i class="glyphicon pbi-glyph-warning glyph-small"></i><div><span localize="SettingsDashboard_DataClassification_NoDefaultChoosed"></span><span class="defaultDataClassificationOption">{{defaultDataClassification.name}}</span></div></div></div></div><div class="dashboardSettingsSection"> <button id="dashboardSettingsApply" class="biButton primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="!dashboardSettingsForm.$dirty" ng-click="applyChanges()"/> <button class="biButton" localize="SettingsDataset_DiscardButtonText" ng-disabled="!dashboardSettingsForm.$dirty" ng-click="discardChanges()"/></div></form>'),e.put("views/settings/settingsDatasetFeaturedQuestionsView.html",'<div><div class="featuredQuestionsSection" ng-if="modelSupportsQna"><div class="sectionHeader" ng-click="sectionExpanded = !sectionExpanded"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[sectionExpanded]"></i><span class="refreshSectionTitle" localize="SettingsDataset_FeaturedQuestions_Title"></span></div><div class="expandableInnerContainer" ng-if="sectionExpanded"><div class="prompt" localize="SettingsDataset_FeaturedQuestions_Prompt"></div><div class="question" ng-repeat="q in questions"> <input class="mediumFontSize" type="text" ng-model="q.utterance" ng-class="{hasError: q.utterance.length === 0}" ng-change="onChange(q)" maxlength="{{maxUtteranceLength}}" aria-label="{{inputAriaLabel}}"/><a class="deleteQuestion" ng-click="deleteQuestion($index)" localize-tooltip="SettingsDataset_FeaturedQuestions_DeleteQuestion"><i class="glyphicon pbi-glyph-close glyph-mini"></i></a><div class="emptyQuestion smallFontSize" ng-if="!q.isValid"><i class="glyphicon pbi-glyph-error glyph-small"></i> <span>{{q.validationMessage}}</span></div></div><div ng-if="questions.length < maxQuestions"><a href="" class="addQuestion" ng-click="addQuestion()" localize="SettingsDataset_FeaturedQuestions_AddAnotherQuestion"></a></div><div class="buttonsContainer"> <button class="primary" localize="SettingsDataset_ApplyButtonText" ng-click="applyChanges()" ng-disabled="!isDirty || !isValid"></button> <button localize="SettingsDataset_DiscardButtonText" ng-click="discardChanges()" ng-disabled="!isDirty"></button></div></div></div></div>'),e.put("views/settings/settingsDatasetsView.html",'<div class="settingsDatasets"><div class="settingsDatasetsLeftColumn" ng-if="filteredModels && filteredModels.length !== 0"><div class="datasetsList" ng-if="filteredModels"><ul><li ng-repeat="model in filteredModels | orderBy: \'displayName\' track by model.id" ng-click="onDatasetSelected(model.dbName)" ng-class="{selected: viewModel.currentDatasetId === model.id}"><span ng-bind="::model.displayName"/></li></ul></div></div><div class="settingsDatasetsRightColumn" ng-if="viewModel && viewModel.datasets"><div ng-repeat="dataset in viewModel.datasets"><settings-dataset view-model="dataset" ng-if="viewModel.currentDatasetId === dataset.modelId" storage-refresh-supported="storageRefreshSupported"></settings-dataset></div></div></div>'),e.put("views/settings/settingsDatasetView.html",'<div class="dataset" ng-cloak ng-switch="datasetPageReady"><div class="settingsDatasetsTitle"><span localize="SettingsDataset_Title"/><span ng-bind="viewModel.name"/></div><spinner ng-switch-when="false"></spinner><div class="settingsContainer" ng-switch-when="true"><inline-message ng-if="showHeaderMessage" display-icon="displayIcon" use-error-icon="storageSourceFileNotFound" use-error-background="storageSourceFileNotFound" class="warning"> {{headerMessage}} <a ng-show="showInstallPGWLink" target="_blank" href="//go.microsoft.com/fwlink/?LinkID=534231">{{headerLink}}</a> {{headerGatewayWarning}}<span ng-show="disabledEntireRefreshPageShowLearnMoreLink" localize="DataSourceSupport_LearnMoreMessage" localize-fragments><a fragment-index="0" localize="LearnMore" target="_blank" href="https://support.powerbi.com/knowledgebase/articles/474669-refresh-data"/></span><a ng-if="headerLearnMoreLink" localize="LearnMore" target="_blank" href={{headerLearnMoreLink}}/></inline-message><div class="tryProAccountButton" ng-if="::!hasLicenseForProModel"> <button class="biButton primary" ng-bind="tryProAccountButtonText" ng-click="tryProAccount()"></button></div><div ng-if="!disableEntireRefreshPage"><div class="takeoverContainer" ng-if="shouldTakeoverContainerShow()"><spinner ng-if="!isTakeoverStatusReady"></spinner><div ng-if="isTakeoverStatusReady" ng-bind-html="getTrustedHtml(viewModel.takeoverStatusText)"></div><div ng-if="!viewModel.takenOver && isTakeoverStatusReady" class="buttonsContainer"> <button class="primary" ng-click="showTakeoverDialog()" ng-bind="viewModel.takeoverButtonText"></button></div></div><div class="gatewayStatus" ng-if="gatewayStatusMessage" ng-bind="gatewayStatusMessage"></div><div class="expandableRefreshSections"><div ng-switch="firstTimeExperience && viewModel.takenOver" ng-if="!disableRefreshSection"><refresh-welcome ng-switch-when="true"></refresh-welcome><refresh-status ng-switch-when="false"><refresh-status></div><div><a href="" class="refreshHistory" localize="SettingsDataset_RefreshHistoryText" ng-click="showHistoryDialog()"></a></div><div ng-include="\'views/settings/settingsGateways.html\'" ng-if="isOnPremGatewayAllowed"></div><div ng-include="\'views/settings/settingsDatasourceCredentials.html\'" ng-if="!disableDatasourcesSection"></div><div ng-include="\'views/settings/settingsDatasourceScheduleRefresh.html\'" ng-if="!disableRefreshSection"></div><div ng-include="\'views/settings/settingsOneDriveCredentials.html\'" ng-if="showStorageConnection"></div><div ng-include="\'views/settings/settingsOneDriveRefresh.html\'" ng-if="showStorageRefresh"></div></div></div><div ng-include="\'views/settings/settingsQnaView.html\'"></div><dataset-parameters-dialog view-model="datasetParametersDialogParameters"></dataset-parameters-dialog><auth-dialog view-model="authDialogParameters" ng-if="authDialogParameters.showAuthDialog"></auth-dialog></div></div>'),e.put("views/settings/settingsDatasourceCredentials.html",'<div ng-if="::hasEditableDatasources" class="settingsDatasourceCredentials"><div class="refreshSectionHeader" ng-class="{disabledContainer : shouldDatasourceCredentialsDisabled()}" ng-click="viewModel.manageDataSourcesExpand = !viewModel.manageDataSourcesExpand" ng-switch on="enterpriseGatewayETLEnabled && selectGatewayModel.useEnterpriseGateway !== undefined && selectGatewayModel.useEnterpriseGateway"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[!shouldDatasourceCredentialsDisabled() && viewModel.manageDataSourcesExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_ManageDataSources_Title" ng-switch-when="false"></span><span class="refreshSectionTitle" localize="SettingsDataset_ManageDataSources_Title_EnterpriseGateway" ng-switch-when="true"></span></div><div class="expandableInnerContainer" ng-show="!shouldDatasourceCredentialsDisabled() && viewModel.manageDataSourcesExpand" ng-switch="showDiscoverDatasourcesSpinner"><spinner ng-switch-when="true"></spinner><div ng-switch-when="false"><inline-message trace-details="datasourceTraceDetails" use-error-icon class="expandableBlockWarning" ng-show="viewModel.hasDatasourceWithWrongCredentials || viewModel.hasDirectQueryDatasourceWithMissingCredentials"><span ng-show="viewModel.hasDatasourceWithWrongCredentials" localize="SettingsDataset_ManageDataSources_Warning_YouNeedToProvideCredentials"></span><span ng-show="viewModel.hasDirectQueryDatasourceWithMissingCredentials" localize="SettingsDataset_ManageDataSources_Warning_DirectQueryMissingCredentials"></span></inline-message><div class="topMarginTextContainer"><table class="datasourceContainer"><tr ng-repeat="datasource in viewModel.datasources | orderBy:\'displayName\'"><th class="datasourceName"><span title="{{::datasource.fullName}}" ng-bind="::datasource.displayName"></span><th><div class="statusContainer"><spinner ng-show="testConnectionProgressing(datasource)"></spinner><i class="glyphicon pbi-glyph-error glyph-small" title="{{datasource.testConnectionErrorMessage}}" ng-show="testConnectionFailed(datasource)"></i></div><a href="" class="dataSourceEditButton" localize="SettingsDataset_ManageDataSources_EditButtonText" ng-click="editDatasource(datasource)"></a></th></tr></table></div></div></div></div>'),e.put("views/settings/settingsDatasourceScheduleRefresh.html",'<div ng-if="::hasRefreshSchedule" class="settingsDatasourceScheduleRefresh"><div class="refreshSectionHeader" ng-class="{disabledContainer : shouldScheduleRefreshContainerDisabled()}" ng-click="viewModel.refreshSectionExpand = !viewModel.refreshSectionExpand"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[(firstTimeExperience && viewModel.takenOver) ? false : viewModel.refreshSectionExpand]"></i><span class="refreshSectionTitle" ng-attr-localize="{{viewModel.isDirectQueryOrOnPremModel ? \'SettingsDataset_DirectQuery_SettingTitle\' : \'SettingsDataset_ScheduleRefresh_Title\'}}"></span></div><div class="expandableInnerContainer" ng-show="viewModel.refreshSectionExpand"><div class="datasetSchedule" ng-cloak><div class="topMarginTextContainer" ng-class="{disabledContainer : !viewModel.takenOver}" ng-switch="::viewModel.isDirectQueryOrOnPremModel"><section ng-switch-when="true" class="directQueryRefreshHeader"><header localize="SettingsDataset_DirectQuery_RefreshTitle"></header><a href="https://go.microsoft.com/fwlink/?linkid=839732" target="_blank" localize="SettingsDashboard_DQRefresh_LearnMore"/></section><section ng-switch-when="false"><header localize="SettingsDataset_ScheduleRefresh_EnableRefresh_Title"></header><pbi-toggle ng-model="viewModel.refreshSettings.refreshEnabled" ng-disabled="shouldRefreshSettingsToggleDisabled()" ng-change="refreshSettingsToggleMouseUp()" no-label on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff"></pbi-toggle></section></div><fieldset class="inputContainer" ng-class="{disabledContainer : shouldRefreshSettingsDisabled()}" ng-disabled="shouldRefreshSettingsDisabled()"><div class="refreshFrequencyContainer"><header localize="SettingsDataset_ScheduleRefresh_RefreshFrequency_Title"></header> <select ng-model="viewModel.refreshFrequencyString" ng-options="key as value for (key, value) in ::viewModel.refreshFrequencies"/></div><section ng-if="viewModel.showRefreshTimeInfo"><div class="refreshTimeZoneContainer"><header localize="SettingsDataset_ScheduleRefresh_TimeZone"></header> <select ng-model="viewModel.refreshSettings.refreshTimeZoneId" ng-options="refreshTimeZone.key as refreshTimeZone.value for refreshTimeZone in viewModel.refreshTimeZonesViewModel"/></div><ul class="refreshFrequencyWeekDays" ng-if="viewModel.showWeekDays"><li ng-repeat="weekdayKey in ::viewModel.weekdayKeys"><pbi-checkbox label="{{::weekdayKey}}" ng-model="viewModel.refreshSettings.refreshDays[$index]" class="refreshFrequencyDay"></pbi-checkbox></li></ul><div ng-switch="hasLicenseForProModel"><div class="refreshWindowContainer" ng-switch-when="false"><header localize="SettingsDataset_ScheduleRefresh_TimeWindow"></header> <select ng-model="viewModel.refreshSettings.refreshTimeWindowIndex" ng-options="viewModel.refreshTimeWindows.indexOf(refreshTimeWindow) as refreshTimeWindow for refreshTimeWindow in viewModel.refreshTimeWindows"/><span class="updateAccountScheduleDataRefreshMessage" ng-bind="updateAccountScheduleDataRefreshMessage"/><div><button class="biButton primary" ng-bind="tryProAccountButtonText" ng-click="tryProAccount()"></button></div></div><div ng-switch-when="true"><div class="refreshProWindowContainer"><header localize="SettingsDataset_ScheduleRefresh_TimeProWindow"></header><div ng-repeat="time in viewModel.refreshSettings.refreshTimesHourly "> <select ng-model="time.refreshHourIndex" ng-options="viewModel.refreshTimeHourWindows.indexOf(refreshTimeHourWindow) as refreshTimeHourWindow for refreshTimeHourWindow in viewModel.refreshTimeHourWindows"/> <select ng-model="time.refreshMinuteIndex" ng-options="viewModel.refreshTimeMinuteWindows.indexOf(refreshTimeMinuteWindow) as refreshTimeMinuteWindow for refreshTimeMinuteWindow in viewModel.refreshTimeMinuteWindows"/> <select ng-model="time.refreshAmPmIndex" ng-options="viewModel.refreshTimeAmPmWindows.indexOf(refreshTimeAmPmWindow) as refreshTimeAmPmWindow for refreshTimeAmPmWindow in viewModel.refreshTimeAmPmWindows"/><i class="refreshTimeDeletButton glyphicon pbi-glyph-cancel glyph-mini" ng-click="removeRefreshTime($index)"></i><div class="invalidTimeWarning" ng-if="time.isDuplicate"><i class="invalidTimeErrorIcon glyphicon pbi-glyph-error glyph-small"></i><span localize="SettingsDataset_DuplicateTime"></span></div><div class="invalidTimeWarning" ng-if="time.isIncomplete"><i class="invalidTimeErrorIcon glyphicon pbi-glyph-error glyph-small"></i><span localize="SettingsDataset_IncompleteTime"></span></div></div></div><a href="" class="addRefreshTime" localize="SettingsDataset_Add_Refresh_Time" ng-show="canAddRefreshTime()" ng-click="addRefreshTime()"></a></div></div></section><div class="sendFailureEmail" ng-if="::!viewModel.isDirectQueryOrOnPremModel"><pbi-checkbox label="SettingsDataset_ScheduleRefresh_SendRefreshFailureEmail" ng-model="viewModel.refreshSettings.refreshNotificationEnabled"></pbi-checkbox></div></fieldset><div class="buttonsContainer"> <button class="biButton primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="shouldSettingsDatasetButtonDisable()" ng-click="applyChanges()"></button> <button class="biButton" localize="SettingsDataset_DiscardButtonText" ng-disabled="shouldSettingsDatasetButtonDisable()" ng-click="discardChanges()"></button></div></div></div></div>'),e.put("views/settings/settingsEsriView.html",'<div class="dashboardSettings" ng-cloak><h class="dashboardSettingsTitle" localize="SettingsEsri_Title"/><div ng-if="esriVisualDisallowed"" class="dashboardSettingsSection"><inline-message class="inlineWarning"><span localize="SettingsEsri_OrganizationHasDisabled"></span></inline-message></div><div ng-if="!esriVisualDisallowed"" class="dashboardSettingsSection"><table class="dashboardSettingsCheckbox"><tr><td> <input id="esriVisualEnabled" type="checkbox" ng-model="esriSettings.esriVisualEnabled" ng-change="onSettingChange()"/></td><td class="dashboardSettingsInfo"><label class="settingDescription" localize="SettingsEsri_UseEsriMap" for="esriVisualEnabled"/></td></tr></table></div><div ng-if="!esriVisualDisallowed" class="dashboardSettingsSection"> <button id="dashboardSettingsApply" class="primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="!isDirty" ng-click="applyChanges()"/> <button localize="SettingsDataset_DiscardButtonText" ng-disabled="!isDirty" ng-click="discardChanges()"/></div></div>'),e.put("views/settings/settingsGateways.html",'<div><div class="refreshSectionHeader" ng-class="{disabledContainer : shouldGatewaysContainerDisabled()}" ng-click="viewModel.gatewaysExpand = !viewModel.gatewaysExpand"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[viewModel.gatewaysExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_GatewayConnection_Title"></span></div><div class="expandableInnerContainer" ng-show="viewModel.takenOver && viewModel.gatewaysExpand"><select-gateway ng-if="viewModel.takenOver" view-model="selectGatewayModel"></select-gateway><div class="buttonsContainer"> <button class="primary" localize="SettingsDataset_ApplyButtonText" ng-click="applyGatewaySelection()" ng-disabled="!selectGatewayModel.isDirty"></button> <button localize="SettingsDataset_DiscardButtonText" ng-click="discardGatewaySelection()" ng-disabled="!selectGatewayModel.isDirty"></button></div></div></div>'),e.put("views/settings/settingsGeneralView.html",'<div class="settingsDatasets"><div class="settingsDatasetsLeftColumn"><div class="datasetsList"><ul><li ng-repeat="subGroup in subGroups track by subGroup.type" ng-click="onSubgroupSelected(subGroup.type)" ng-class="{selected: viewModel.selectedSubgroupType === subGroup.type}"><span ng-bind="subGroup.name"></span></li></ul></div></div><div class="settingsDatasetsRightColumn" ng-switch="viewModel.selectedSubgroupType"><settings-privacy ng-switch-when="0" view-model="viewModel.privacy"></settings-privacy><settings-close-account ng-switch-when="1"></settings-close-account><settings-language ng-switch-when="2" view-model="viewModel.language"></settings-language><settings-plugins ng-switch-when="3" view-model="viewModel.plugins"></settings-plugins><settings-preview-features ng-switch-when="4"></settings-preview-features><settings-esri ng-switch-when="5" view-model="viewModel.esri"></settings-esri></div></div>'),e.put("views/settings/settingsLanguageView.html",'<form name="languageSettingsForm" class="dashboardSettings" ng-cloak><h class="dashboardSettingsTitle" localize="SettingsLanguage_Title"/><div class="dashboardSettingsSection"><div class="dashboardSettingsSectionTitle" localize="SettingsLanguage_SelectLanguage_Title"/><div class="dashboardSettingsSectionSubTitle"><span localize="SettingsLanguage_SelectLanguage_SubTitle" localize-fragments><a fragment-index="0" href="https://go.microsoft.com/fwlink/?LinkID=723835" target="_blank" localize="LearnMore"/></span></div><div class="dropdown"> <select ng-options="language.name for language in ::supportedLanguages track by language.code" ng-model="currentLanguage" ng-change="languageSelected()"></select><spinner ng-if="isLoading"></spinner></div></div><div class="dashboardSettingsSection"> <button id="dashboardSettingsApply" class="primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="!languageSettingsForm.$dirty" ng-click="applyChanges()"/> <button localize="SettingsDataset_DiscardButtonText" ng-disabled="!languageSettingsForm.$dirty" ng-click="discardChanges()"/></div></form>'),e.put("views/settings/settingsOneDriveCredentials.html",'<div class="settingsOneDriveCredentials"><div class="refreshSectionHeader" ng-class="{disabledContainer : storageSourceFileNotFound}" ng-click="viewModel.manageStorageSourceExpand = !viewModel.manageStorageSourceExpand"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[viewModel.manageStorageSourceExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_ManageStorageSource_Title"></span></div><div class="expandableInnerContainer" ng-show="viewModel.manageStorageSourceExpand" ng-switch="showDiscoverStorageSourcesSpinner"><spinner ng-switch-when="true"></spinner><div ng-switch-when="false"><inline-message trace-details="storageSourceTraceDetails" use-error-icon class="expandableBlockWarning" ng-show="testPackageConnectionFailed()"><span localize="SettingsDataset_ManageStorageSource_Warning_YouNeedToProvideCredentials"></span></inline-message><div><table class="datasourceContainer"><tr><th class="datasourceName"><span title="{{::getStorageSourceDisplayName()}}" ng-bind="getStorageSourceDisplayName()"></span></th><th><div class="statusContainer"><spinner ng-show="testPackageConnectionProgressing()"></spinner><i class="glyphicon pbi-glyph-error glyph-small" title="{{viewModel.storageSource.testConnectionErrorMessage}}" ng-show="testPackageConnectionFailed()"></i></div><a href="" class="dataSourceEditButton" localize="SettingsDataset_ManageDataSources_EditButtonText" ng-click="editStorageSource()"></a></th></tr></table></div></div></div></div>'),e.put("views/settings/settingsOneDriveRefresh.html",'<div class="settingsOneDriveRefresh"><div class="refreshSectionHeader" ng-class="{disabledContainer : storageSourceFileNotFound}" ng-click="viewModel.manageStorageRefreshExpand = !viewModel.manageStorageRefreshExpand"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[viewModel.manageStorageRefreshExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_RefreshStorageSource_Title"></span></div><div class="expandableInnerContainer" ng-show="viewModel.manageStorageRefreshExpand" ng-switch="showDiscoverStorageSourcesSpinner"><spinner ng-switch-when="true"></spinner><div class="topMarginTextContainer" ng-switch-when="false"><header localize="SettingsDataset_Enable_PackageRefresh_Title"></header><inline-message trace-details="storageSourceTraceDetails" use-error-icon class="expandableBlockWarning" ng-show="testPackageConnectionFailed()"><span localize="SettingsDataset_ManageStorageSource_Warning_YouNeedToProvideCredentials"></span></inline-message><pbi-toggle ng-model="viewModel.contract.isPackageRefreshEnabled" ng-disabled="shouldPackageRefreshSettingsToggleDisabled()" ng-change="updateStorageSourceRefresh()" no-label on-state-text="ToggleSwitchOn" off-state-text="ToggleSwitchOff"></pbi-toggle></div></div></div>'),e.put("views/settings/settingsPluginsView.html",'<div class="dashboardSettings" ng-cloak><h class="dashboardSettingsTitle" localize="SettingsPlugins_Title"/><div class="dashboardSettingsSection"><table class="dashboardSettingsCheckbox"><tr><td> <input id="developerModeSettingsCheckbox" type="checkbox" ng-model="pluginsSettings.developerMode" ng-change="applyChanges()"/></td><td class="dashboardSettingsInfo"><label class="settingDescription" localize="SettingsPlugins_DeveloperMode_Info" for="developerModeSettingsCheckbox"/><a href="https://aka.ms/powerbideveloperhelp" target="_blank" localize="LearnMore"/></td></tr></table></div></div>'),
e.put("views/settings/settingsPrivacyView.html",'<div class="dashboardSettings" ng-cloak><h class="dashboardSettingsTitle" localize="SettingsPrivacy_Title"/><div class="dashboardSettingsSection"><div class="dashboardSettingsSectionTitle" localize="SettingsPrivacy_DataCollection_Title"/><table class="dashboardSettingsCheckbox"><tr><td> <input id="qnaDataCollection" type="checkbox" ng-model="privacySettings.allowQnaDataCollection" ng-change="onSettingChange()"/></td><td class="dashboardSettingsInfo"><label class="settingDescription" localize="SettingsPrivacy_DataCollection_Info" for="qnaDataCollection"/><a href="https://go.microsoft.com/fwlink/p/?LinkId=615884" target="_blank" localize="LearnMore"/></td></tr></table></div><div class="dashboardSettingsSection"> <button id="dashboardSettingsApply" class="primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="!isDirty" ng-click="applyChanges()"/> <button localize="SettingsDataset_DiscardButtonText" ng-disabled="!isDirty" ng-click="discardChanges()"/></div></div>'),e.put("views/settings/settingsPublishedContentView.html",'<div class="settings"></div>'),e.put("views/settings/settingsQnaView.html",'<div class="expandableRefreshSections"><section class="qnaSection" ng-if="qna"><div class="sectionHeader" ng-click="viewModel.qnaSectionExpand = !viewModel.qnaSectionExpand"><i class="glyphicon" ng-class="{true:\'refreshSectionExpander pbi-glyph-caretdownright\', false:\'refreshSectionExpander pbi-glyph-caretright\'}[viewModel.qnaSectionExpand]"></i><span class="refreshSectionTitle" localize="SettingsDataset_QnaAndCortana_Title"></span></div><div class="expandableInnerContainer" ng-show="viewModel.qnaSectionExpand"><inline-message ng-if="qna.showOnPremiseSetting" display-icon="displayIcon" use-error-icon="storageSourceFileNotFound" use-error-background="storageSourceFileNotFound"><span><a class="onPremQna" localize="SettingsDataset_Qna_OnPremWarning"></a><a class="learnAboutOnPremQna" target="_blank" href="https://go.microsoft.com/fwlink/?LinkId=786785" localize="LearnMore"></a></span></inline-message><div class="qnaOptions" ng-if="qna.showOnPremiseSetting"><pbi-checkbox label="SettingsDataset_Cortana_EnableQnaOption" ng-model="qna.powerBIQnaEnabled" ng-change="enableQna()"></pbi-checkbox></div><div class="qnaOptions" ng-if="qna.showCortanaSetting"><pbi-checkbox label="SettingsDataset_Cortana_EnableCortanaOption" ng-model="qna.cortanaEnabled" ng-change="enableCortana()"></pbi-checkbox></div><div class="qnaInfo" ng-if="qna.showCortanaSetting"><span localize="SettingsDataset_Cortana_InformationSharing"/></div><div class="buttonsContainer"> <button class="primary" localize="SettingsDataset_ApplyButtonText" ng-disabled="!viewModel.isQnaDirty" ng-click="qna.apply()"></button> <button localize="SettingsDataset_DiscardButtonText" ng-disabled="!viewModel.isQnaDirty" ng-click="qna.discard()"></button></div></div><settings-dataset-featured-questions view-model="viewModel"></settings-dataset-featured-questions></section></div>'),e.put("views/settings/settingsViewerView.html",'<div class="sliderContentView" ng-switch="isLoading"><div class="layoutTop"><div class="backToDashboard section"><div class="sliderContentHeader ms-font-weight-light ms-font-color-neutralSecondary"><span feature-switch-not="breadcrumbNavigationEnabled" localize="SettingsViewer_Title"></span><spinner class="settingsLoadingSpinner" ng-switch-when="true"></spinner></div></div></div><div class="layoutBottom" ng-switch-when="false"><div class="layoutLeft"><div class="settingsList"><ul><li ng-repeat="settingsGroup in settingsGroups" ng-click="onSettingsGroupSelected(settingsGroup.type)" ng-class="{selected: currentSettingsGroup === settingsGroup.type}"> <span>{{::settingsGroup.name}}</span></li></ul></div></div><div class="layoutRight"><div ng-switch on="currentSettingsGroup" feature-switch-class="breadcrumbNavigationEnabled"><settings-general ng-switch-when="general" view-model="viewModel.general"></settings-general><settings-dashboards ng-switch-when="dashboards" view-model="viewModel.dashboards"></settings-dashboards><settings-datasets ng-switch-when="datasets" view-model="viewModel.datasets"></settings-datasets><settings-workbooks ng-switch-when="workbooks" view-model="viewModel.workbooks"></settings-workbooks><settings-published-content ng-switch-when="publishedContent"></settings-published-content><settings-alerts ng-switch-when="alerts"></settings-alerts><settings-communications ng-switch-when="communications" view-model="viewModel.communications"></settings-communications></div></div></div></div>'),e.put("views/shareView.html",'<div id="sharingPane" class="paneLayout"><header><div class="primaryHeading label-xxl" localize="ShareView_ShareDashboard"></div><div class="secondaryHeading pbi-link" ng-class="{requestsSummaryActive: anyRequests()}" ng-bind="viewModel.requestsSummaryText"></div><section class="sharingOptionsList"><div class="sharingOptionTab label-med inviteTab" ng-class="{selected: viewModel.inviteSelected}" ng-click="sharedWithUsers(false)" localize="ShareView_ShareText"></div><div class="sharingOptionTab label-med sharedWithTab" ng-class="{selected: viewModel.sharedWithSelected}" ng-click="sharedWithUsers(true)" ng-if="::isOwner()" localize="ShareView_AccessText"></div></section></header><section class="contentContainer"><section class="sharingPaneSection invite" ng-show="viewModel.inviteSelected"><div class="sharingSectionTitleContainer"><span class="sharingSectionTitle" localize="Sharing_GrantAccess"></span></div><div class="sharePaneNotification shareAlert" ng-if="viewModel.proContentAlertMessage" id="proContentMessageElement"><i class="glyphicon glyph-small pbi-glyph-warning"></i><span ng-bind="viewModel.proContentAlertMessage"></span><a class="learnMore" href="//go.microsoft.com/fwlink/?LinkId=616914" target="_blank" localize="LearnMore"></a></div><emails-list ng-hide="isNotPermitted()" view-model="viewModel.emailsList" allow-object-ids allow-security-groups allow-distribution-lists on-tag-added="validateInputTag" on-tag-removed="resetValidation"></emails-list><div class="sharePaneNotification shareError" ng-if="viewModel.hasValidationError"><i class="glyphicon glyph-small pbi-glyph-error"></i> <span>{{viewModel.emailValidationError}}</span></div><div class="sharePaneNotification shareError" ng-if="viewModel.showSecurityGroupUpgradeAccount"><i class="glyphicon glyph-small pbi-glyph-error"></i><span localize="Sharing_SecurityGroupRequiresPro"></span><a class="learnMore" href="//go.microsoft.com/fwlink/?LinkId=616914" target="_blank" localize="LearnMore"></a></div><div class="sharePaneNotification shareAlert" ng-if="viewModel.hasValidationWarning"><i class="glyphicon glyph-small pbi-glyph-warning"></i> <span>{{viewModel.emailValidationWarning}}</span></div><div class="emailMessage"><textarea id="msg" ng-model="viewModel.messageText" ng-disabled="isNotPermitted()" ng-trim="false" maxlength="4000" ng-attr-placeholder="{{viewModel.placeholderMessage}}"/></div></section><section class="sharingPaneSection sharedWith" ng-show="viewModel.sharedWithSelected"><div class="userListContainer sharedWithUsers"><div class="sharingSectionTitleContainer" ng-class="{isResharer: !isOwner()}"><span class="sharingSectionTitle shareWithTitle" localize="ShareView_DashboardSharedWith"></span><span class="sharingSectionTitle shareWithNotAvailableTitle" localize="ShareView_DashboardSharedWithNotAvailable"></span></div><div class="searchBoxContainer" ng-if="::isOwner()"><search-box filter="viewModel.searchFilter"></search-box></div><ul ng-if="::isOwner()"><li><div id="ownerLabel" class="username trimmedTextWithEllipsis" ng-bind="viewModel.owner.fullName" title="{{viewModel.owner.fullName}}"></div><div class="usertype" localize="Sharing_Owner"></div></li><li ng-repeat="user in filteredSharedUsers = (viewModel.sharedUsers | filter: { fullName: viewModel.searchFilter })"><div class="username trimmedTextWithEllipsis" ng-bind="user.fullName" title="{{user.fullName}}"></div><div class="action"><div class="dropMenuContainer"> <button class="optionsMenu" dropdown-menu dropdown-items="user.sharingPermissionsOptions" dropdown-on-item-selected="sharingPermissionsItemSelected(selected)"><span class="glyphicon pbi-glyph-more glyph-small"></span></button></div><div class="performAction">{{user.permissionsDisplayText}}</div><div class="inProgress" ng-show="user.id === viewModel.removedUserId && user.kind === viewModel.removedUserKind && viewModel.selectedList === SharingUserList.SharedUsers"><spinner dots></spinner></div></div><div class="userTypeLabel" ng-show="user.isExternalUser"><span localize="Sharing_Guest"></span><i class="glyphicon glyph-small pbi-glyph-info" localize-tooltip="Sharing_Guest_Info"></i></div></li><li ng-repeat="userInvite in filteredInvitedUsers = (viewModel.invitedUsers | filter: { sentToEmailAddress: viewModel.searchFilter })"><div class="username trimmedTextWithEllipsis" ng-attr-data-invitation-id="{{userInvite.id}}" ng-bind="userInvite.sentToEmailAddress" title="{{userInvite.sentToEmailAddress}}"></div><div class="action"><div class="inProgress" ng-show="userInvite.id === viewModel.removedUserId && viewModel.selectedList === SharingUserList.InvitedUsers"><spinner dots></spinner></div><div class="performAction noOptions" ng-click="cancelInvite(userInvite.id)" ng-hide="userInvite.id === viewModel.removedUserId && viewModel.selectedList === SharingUserList.InvitedUsers" localize="Sharing_CancelInvite"></div></div><div class="userTypeLabel" ng-show="userInvite.isExternalUser"><span localize="Sharing_Guest"></span><i class="glyphicon glyph-small pbi-glyph-info" localize-tooltip="Sharing_Guest_Info"></i></div></li><li ng-if="featureSwitchPermissionCenterEnabled" class="action"><a href="" class="pbi-link" localize="PermissionCenter_HomeHeader" ng-click="navigateToManagePermissions()"></a></li></ul></div><div class="userListContainer pendingRequests" ng-if="anyRequests()"><div class="sharingSectionTitleContainer"><span class="sharingSectionTitle" localize="ShareView_DashboardAccessRequestedBy"></span><i class="icon glyphicon pbi-glyph-info glyph-small" localize-tooltip="ShareView_PendingRequestsTooltip"></i></div><ul ng-if="::isOwner()"><li ng-repeat="requestingUser in viewModel.requestingUsers"><div class="username trimmedTextWithEllipsis" ng-bind="requestingUser.fullName" title="{{requestingUser.fullName}}"></div><div class="glyphDeny glyphicon pbi-glyph-close glyph-mini mini-label" ng-hide="requestingUser.isPerformingAccessRequest" ng-click="denyAccess(requestingUser)" localize-tooltip="Reject"></div><div class="glyphGrant glyphicon pbi-glyph-success glyph-small" ng-hide="requestingUser.isPerformingAccessRequest" ng-click="grantAccess([requestingUser])" localize-tooltip="Approve"></div><div class="requestAccessSpinner" ng-show="requestingUser.isPerformingAccessRequest"><spinner dots></spinner></div></li><li class="action"><a href="" class="pbi-link" localize="ShareView_ApproveAll" ng-click="approveAll()"></a></li></ul></div><div class="shareLink"><div class="sharingSectionTitleContainer"><span class="sharingSectionTitle" localize="ShareView_ShareLink"></span><i class="icon glyphicon pbi-glyph-info glyph-small" localize-tooltip="ShareView_InternalDashboardLinkTooltip"></i></div> <input class="dashboardUrl" type="text" readonly onclick="this.select()" ng-attr-value="{{getDashboardUrl()}}"/></div></section></section><footer><div class="sharePaneNotification shareAlert" ng-hide="isNotPermitted() || !shouldShowPermissionsWarning()"><i class="icon glyphicon pbi-glyph-warning glyph-small"></i><span class="workbookPermissonsMessageInfo" ng-switch="getWorkookPermissionsMessageType()"><span localize="Sharing_WorkbookOwnerPermissionNeeded" ng-switch-when="0"></span><span localize="Sharing_WorkbookNonOwnerPermissionNeeded" ng-switch-when="1"></span><span localize="Sharing_WorkbookGroupPermissionNeeded" ng-switch-when="2"></span><a class="learnMore" href="//go.microsoft.com/fwlink/p/?LinkId=692007" target="_blank"><span localize="LearnMore"></span></a><a href={{workbookWebUri}} target="_blank" class="goToOneDriveMessageInfo" ng-if="getWorkookPermissionsMessageType() !== 1" ng-switch="getWorkookPermissionsMessageType()"><span localize="Sharing_GoToWorkBookNotificationLink" ng-switch-when="0"></span><span localize="Sharing_GoToGroupSharedDocumentNotificationLink" ng-switch-when="2"></span></a></span></div><div class="sharePaneNotification shareInfo"><i class="glyphicon glyph-small pbi-glyph-info"></i><span localize="Sharing_DataAccessNotification"></span><a class="learnMore" href="//go.microsoft.com/fwlink/?LinkID=522083" target="_blank"><span localize="LearnMore"></span></a></div><div class="messageInfo" ng-show="viewModel.inviteSelected"><label id="cantShare" class="error" localize="Sharing_UsersCannotReshare" ng-show="isNotPermitted()"></label><div class="sharingOptions" ng-hide="isNotPermitted()"><pbi-checkbox label="Sharing_UsersCanReshare" ng-model="viewModel.allowReshare" ng-disabled="viewModel.isEmailBeingSent"></pbi-checkbox><pbi-checkbox label="Sharing_NotifyViaEmail" ng-model="viewModel.notifyViaEmail" ng-disabled="viewModel.isEmailBeingSent"></pbi-checkbox></div></div><div class="buttons"> <button ng-show="viewModel.sharedWithSelected" class="biButton default closeButton" ng-click="cancelShare()" localize="ShareView_CloseButtonText"></button><div ng-show="viewModel.inviteSelected"><spinner ng-show="viewModel.isEmailBeingSent"></spinner> <button class="biButton primary shareButton" type="button" ng-click="shareEmail()" ng-disabled="viewModel.hasValidationError || viewModel.isEmailBeingSent || isNotPermitted() || viewModel.emailsList.inputUserList.length === 0" localize="ShareView_ShareButtonText"></button> <button class="biButton default cancelButton" type="button" ng-click="cancelShare()" localize="ShareView_CancelButtonText"></button></div></div></footer></div>'),e.put("views/states/adminPortalState.html","<admin-portal></admin-portal>"),e.put("views/states/appAutoInstallState.html","<app-placeholder></app-placeholder>"),e.put("views/states/createChannelState.html",'<create-app-channel class="flexbox"></create-app-channel>'),e.put("views/states/devToolsViewState.html","<dev-tools-view></dev-tools-view>"),e.put("views/states/externalContentViewerState.html",'<content-provider-store active-dashboard="dashboardDataService.activeDashboard"></content-provider-store>'),e.put("views/states/gatewaysState.html","<gateways></gateways>"),e.put("views/states/insightsState.html",'<insights active-dashboard="dashboardDataService.activeDashboard"></insights>'),e.put("views/states/manageEmbedViewState.html",'<manage-embed-view view-model="viewModel.dashboardContainer.manageEmbedPane" dashboard-container="viewModel.dashboardContainer"></manage-embed-view>'),e.put("views/states/managePermissionsState.html","<permission-details></permission-details>"),e.put("views/states/manageStorageViewState.html",'<manage-storage-view view-model="viewModel.dashboardContainer.manageStoragePane" dashboard-container="viewModel.dashboardContainer"></manage-storage-view>'),e.put("views/states/permissionCenterState.html","<permission-center-home></permission-center-home>"),e.put("views/states/publishContentPackViewState.html",'<introduce-app-bar></introduce-app-bar><publish-content-pack-view view-model="viewModel.dashboardContainer.publishPane" dashboard-container="viewModel.dashboardContainer"></publish-content-pack-view>'),e.put("views/states/rowLevelSecurityState.html","<row-level-security-container></row-level-security-container>"),e.put("views/states/settingsViewerState.html","<settings-viewer></settings-viewer>"),e.put("views/states/shareViewState.html",'<share-view view-model="viewModel.dashboardContainer.sharePane" active-dashboard="dashboardDataService.activeDashboard"></share-view>'),e.put("views/states/viewContentPackViewState.html","<introduce-app-bar></introduce-app-bar><view-content-pack></view-content-pack>"),e.put("views/taskPaneSliderView.html",'<div class="taskPaneSliderView" ng-if="isPaneExpanded()"><collapsible-pane view-model="viewModel.collapsiblePane" is-expander-hidden="viewModel.collapsiblePaneMode !== 0"><tile-editor ng-if="viewModel.collapsiblePaneMode === 1"></tile-editor><create-group-blade ng-if="viewModel.collapsiblePaneMode === 2" group-editor-mode="viewModel.collapsiblePaneMode"></create-group-blade><edit-group-blade ng-if="viewModel.collapsiblePaneMode === 3" group-editor-mode="viewModel.collapsiblePaneMode" parameters="viewModel.parameters"></edit-group-blade><view-group-blade ng-if="viewModel.collapsiblePaneMode === 4" group-editor-mode="viewModel.collapsiblePaneMode" parameters="viewModel.parameters"></view-group-blade><tile-gallery ng-if="viewModel.collapsiblePaneMode === 5"></tile-gallery><share-view ng-if="viewModel.collapsiblePaneMode === 6" view-model="viewModel.dashboardContainer.sharePane"></share-view><real-time-blade ng-if="viewModel.collapsiblePaneMode === 7"></real-time-blade><upn-mapping-pane ng-if="viewModel.collapsiblePaneMode === 8"></upn-mapping-pane><alerts-editor ng-if="viewModel.collapsiblePaneMode === 9"></alerts-editor><streaming-dataset-editor ng-if="viewModel.collapsiblePaneMode === 10" from="viewModel.previousMode"></streaming-dataset-editor><streaming-dataset-push-info ng-if="viewModel.collapsiblePaneMode === 11"></streaming-dataset-push-info><settings-blade ng-if="viewModel.collapsiblePaneMode === 12"></settings-blade><streaming-dataset-gallery ng-if="viewModel.collapsiblePaneMode === 13"></streaming-dataset-gallery><pub-nub-editor ng-if="viewModel.collapsiblePaneMode === 14"></pub-nub-editor><subscription-pane ng-if="viewModel.collapsiblePaneMode === 15"></subscription-pane><capacity-migrate-workspaces ng-if="viewModel.collapsiblePaneMode === 16"></capacity-migrate-workspaces><related-content-blade ng-if="viewModel.collapsiblePaneMode === 17" view-model="viewModel.parameters"></related-content-blade><capacity-settings-editor ng-if="viewModel.collapsiblePaneMode === 18"></capacity-settings-editor></collapsible-pane></div>'),e.put("views/tileEditor.html",'<ng-form name="tileEditorForm"><div class="tileEditor paneLayout"><header><h3 class="primaryHeading" ng-bind="::tileEditorHeaderPaneTitle()"></h3><ul class="headerTabs" ng-if="::isSavedRealTimeTile"><li class="label-med" ng-repeat="tab in ::headerTabs" ng-class="{selected: activeHeaderTab.type === tab.type}" ng-click="activateHeaderTab(tab)" ng-bind="::tab.text"></li></ul></header><section class="contentContainer noPadding"><real-time-tile-visualization-design ng-if="(activeHeaderTab.type === 0) && isSavedRealTimeTile" tile="tileModel" model="selectedModel"></real-time-tile-visualization-design><section class="tileDetails" ng-show="(activeHeaderTab.type === 1) || !isSavedRealTimeTile"><aside class="requiredField" localize="TileEditor_RequiredField"></aside><section class="tileEditorSection"><h4 class="sectionHeader" localize="TileEditor_SectionHeader_Details"></h4><section class="sectionContent"><pbi-checkbox label="TileEditor_PaneSubtitle_DisplayTitle" ng-model="displayTitle" ng-change="toggleDisplayTitle()" ng-disabled="viewModel.titleRequired || viewModel.tile.config.lastRefreshTimeEnabled"></pbi-checkbox><div ng-class="{disabled: !displayTitle}"><h6 class="input-field-label" ng-class="{required:viewModel.titleRequired}" localize="TileEditor_PaneSubtitle_Title"></h6> <input type="text" name="title" class="displayText" ng-class="{hasError: hasTitleError()}" ng-disabled="!displayTitle" ng-model="viewModel.tile.displayText"/><div class="errorBlock" ng-if="hasTitleError()"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="TileEditor_EmptyTitleWarning" localize-tooltip="TileEditor_EmptyTitleWarning"></div></div><h6 class="input-field-label" localize="TileEditor_PaneSubtitle_Subtitle"></h6> <input type="text" class="subDisplayText" ng-disabled="!displayTitle" ng-model="viewModel.tile.subDisplayText"/></div></section></section><section ng-show="viewModel.tile.config.widget" class="tileEditorSection"><h4 class="sectionHeader" localize="TileEditor_SectionHeader_Content"></h4><section class="sectionContent"><div class="widgetEditorContent"></div></section></section><section class="tileEditorSection"><h4 class="sectionHeader" localize="TileEditor_SectionHeader_Functionality"></h4><section class="sectionContent"><pbi-checkbox label="TileEditor_DisplayLastRefreshTime" ng-if="viewModel.hasLastRefreshTime" ng-model="viewModel.tile.config.lastRefreshTimeEnabled" ng-change="showLastRefreshTimeChanged()"></pbi-checkbox><pbi-checkbox label="TileEditor_SetCustomLink" ng-model="hasCustomLink" ng-change="setCustomLinkChanged()" ng-disabled="::!viewModel.canAddOrRemoveCustomLink" name="customLink"></pbi-checkbox><h6 class="input-field-label altTextStyling" localize="TileEditor_SelectLinkType"></h6><pbi-radio-group ng-model="customLinkType" ng-disabled="!hasCustomLink" ng-change="setCustomLinkChanged()" no-label name="linkType"><pbi-radio label="TileEditor_ExternalLink" ng-value="1"/><pbi-radio label="TileEditor_ArtifactLink" ng-value="2"/></pbi-radio-group><div ng-class="{disabled: !hasCustomLink}" ng-if="(customLinkType === 1)" class="externalLink"><h6 class="input-field-label altTextStyling required" localize="TileEditor_Url"></h6> <input class="customLinkUrl" type="text" name="customUrl" ng-model="viewModel.tile.action.targetUrl" ng-disabled="!hasCustomLink" ng-class="{hasError: hasExternalLinkError()}"/><div class="errorBlock" ng-if="hasExternalLinkError()"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="TileEditor_Action_Url_WarningInvalidUrl" localize-tooltip="TileEditor_Action_Url_WarningInvalidUrl"></div></div><h6 class="input-field-label altTextStyling" localize="TileEditor_SetOpenInSameTab"></h6><pbi-radio-group ng-model="viewModel.tile.action.openInSameTab" ng-disabled="!hasCustomLink" no-label><pbi-radio label="TileEditor_Yes" ng-value="true"/><pbi-radio label="TileEditor_No" ng-value="false"/></pbi-radio-group></div><div ng-class="{disabled: !hasCustomLink}" ng-if="(customLinkType === 2)" class="internalLink"><h6 class="input-field-label altTextStyling required" localize="TileEditor_PickArtifact"></h6> <select class="artifactPicker" name="artifactPicker" ng-model="internalLinkInfo.target" ng-disabled="!hasCustomLink" ng-change="onLinkTargetChanged()" ng-class="{hasError: hasInternalLinkError()}" ng-options="candidate as internalLinkInfo.getCandidateName(candidate) for candidate in internalLinkInfo.candidates | orderBy: \'displayName\'"></select><div class="errorBlock" ng-if="hasInternalLinkError()"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="TileEditorArtifactNotFound" localize-tooltip="TileEditorArtifactNotFound"></div></div></div></section></section><section class="tileEditorSection"><div ng-if="viewModel.tile.workbook && viewModel.tile.config.workbookTile"><h4 class="tileEditorTitle sectionHeader" localize="TileEditor_PaneTitle_Workbook_AdvancedOptions"></h4><section class="sectionContent"><h6 class="input-field-label altTextStyling" localize="TileEditor_PaneSubtitle_Fit"></h6><label class="toggleButton"><toggle checked="viewModel.tile.workbook.keepOriginalContentSize" on-change="setDynamicImageForWorkbookTile()"></toggle><span class="keepOriginSizeTileMessage" localize="TileEditor_SetKeepOriginalContentSize"/></label></section></div></section></section></section><section class="banner"><ul><li ng-if="viewModel.canRestoreDefaults()"><pbi-button label="TileEditor_UseDefaultText" kind="text" ng-click="restoreDefaults()"></pbi-button></li><li><pbi-button label="TileEditor_TechnicalDetails" kind="text" ng-click="showTechnicalDetailsDialog()"></pbi-button></li></ul></section><footer><fieldset class="buttons"><pbi-button label="PBI_Button_Label_Back" ng-if="viewModel.tile.isTemporary" ng-click="back()"></pbi-button><pbi-button label="PBI_Button_Label_Apply" primary="true" ng-disabled="!canSave()" ng-click="saveChangesAndExit()"></pbi-button><pbi-button label="PBI_Button_Label_Cancel" ng-click="closeTileEditorWithoutSaving()"></pbi-button></fieldset></footer></div></ng-form>'),e.put("views/tileGallery.html",'<div class="addTilesView paneLayout"><header><h3 class="primaryHeading" localize="Add_Tile_Experience_Add_Tile"></h3><h3 class="secondaryHeading" localize="Add_Tile_Experience_Select_Source"></h3></header><section class="contentContainer"><div class="tilesGroup" ng-repeat="tileGroup in $ctrl.tileGroups"><h4 class="headerText" ng-bind="::tileGroup.title"></h4><ul class="tilesContainer"><li class="tile" ng-repeat="tile in tileGroup.tiles" ng-class="{selected: $ctrl.selectedTile.id === tile.id}" ng-click="$ctrl.select(tile)"><i class="glyphicon glyph-large icon {{::tile.iconClass}}"></i><h5 class="tileTitle" ng-bind="::tile.title" ng-attr-title="{{::tile.title}}"></h5></li></ul></div></section><footer><fieldset class="buttons"><pbi-button label="PBI_Button_Label_Next" primary="true" ng-disabled="!$ctrl.selectedTile" ng-click="$ctrl.next()"></pbi-button><pbi-button label="PBI_Button_Label_Cancel" ng-click="$ctrl.closeTileGalleryPane()"></pbi-button></fieldset></footer></div>'),e.put("views/tiles/compositeTile.html",'<div class="compositeTile" ng-class="{ fullLayout: viewModel.config.layoutType === 1 }"><div class="visualTile"><visual ng-if="$ctrl.readyToRender()" view-model="viewModel.visual" allow-deferred-rendering="::allowDeferredRendering"></visual></div></div>'),e.put("views/tiles/dashboardTile.html",'<li class="dashboardTile baseTile" in-viewport="onceInViewport()" in-viewport-context="{{::viewportContextSelector}}" in-viewport-offset="100%" ng-class="{selected: model.isSelected, readonly: isReadOnly(), showOptions: optionsMenuVisible, nonActionable: isNonActionable()}" ng-click="$event.stopPropagation()" ng-mouseenter="setHover(true)" ng-mouseleave="setHover(false)"><dashboard-tile-open-options ng-if="displayDashboardTileOpenOptions()" model="model"></dashboard-tile-open-options><div class="dashboardTileLayout" ng-if="inViewport" ng-click="openTile(disablePointerEvents, $event)"><section ng-if="::(inEditMobileLayoutMode() || displayDashboardTileShowIcon())"> <button ng-click="addTileToMobileView()" class="tileAction pinTile glyphicon pbi-glyph-pinned glyph-small showTileIcon" localize-tooltip="DashboardTile_ToggleVisibility" ng-if="displayDashboardTileShowIcon()"></button> <button ng-click="removeTileFromMobileView()" class="tileAction unpinTile glyphicon pbi-glyph-unpin glyph-small" localize-tooltip="DashboardTile_unpinTile" ng-if="::(!displayDashboardTileShowIcon())"></button></section><a class="urlTile" ng-attr-href="{{viewModel.href}}" ng-attr-target="{{viewModel.hrefTarget}}" rel="noopener noreferrer"><tile view-model="viewModel" disable-pointer-events="{{::disablePointerEvents}}" header-click-target="openNotification ? openNotifications(event) : openTile(true, event)"></tile></a><dashboard-tile-options-menu ng-if="displayDashboardTileOptionsMenuVisible()"></dashboard-tile-options-menu></div><div ng-if="::viewModel.shouldNewBadgeAppear" class="newBadgeContainer" localize="DashboardTile_NewTileBadge"></div></li>'),e.put("views/tiles/dashboardTileOpenOptions.html",'<div class="moreOptions" localize-tooltip="NavigationPane_OpenMenu"> <button class="inFocusTileBtn" ng-click="inFocusTile($event);" ng-disabled="model.isLoading" ng-if="shouldShowInfocusButton()" localize-tooltip="TileEditor_InFocusTile"><i class="glyphicon pbi-glyph-miniexpand glyph-small"></i></button> <button class="openTileOptionsBtn" ng-click="setOptionsMenuVisibility(true, $event)"><i class="glyphicon pbi-glyph-more"></i></button></div>'),e.put("views/tiles/dashboardTileOptionsMenu.html",'<div class="tileOptionsMenu"> <button class="closeOptionsMenu" ng-click="setOptionsMenuVisibility(false, $event)"><i class="glyphicon pbi-glyph-close glyph-mini"></i></button><a class="openActionDescription mediumFontSize" ng-click="openTile(true, $event)" ng-attr-href="{{viewModel.href}}" ng-attr-target="{{viewModel.hrefTarget}}" rel="noopener noreferrer"><div class="actionInfo" ng-switch="::getOpenActionType()"><div ng-switch-when="0"><i class="glyphicon pbi-glyph-link glyph-small"></i><span class="openActionHeader trimmedTextWithEllipsis" localize="TileMenuOption_GoToURL"></span></div><div ng-switch-when="1"><i class="glyphicon pbi-glyph-comment glyph-small"></i><span class="openActionHeader trimmedTextWithEllipsis" localize="TileMenuOption_GoToQnA"></span></div><div ng-switch-when="2"><i class="glyphicon pbi-glyph-barchart glyph-small"></i><span class="openActionHeader trimmedTextWithEllipsis" localize="TileMenuOption_GoToReport"></span></div><div ng-switch-when="3"><i class="glyphicon pbi-glyph-excel glyph-small"></i><span class="openActionHeader trimmedTextWithEllipsis" localize="TileMenuOption_GoToWorkbook"></span></div><div ng-switch-when="4"><i class="glyphicon pbi-glyph-dataset glyph-small"></i><span class="openActionHeader trimmedTextWithEllipsis" localize="TileMenuOption_GoToDataset"></span></div></div><i class="glyphicon pbi-glyph-rightarrow glyph-small"></i><span class="actionText trimmedTextWithEllipsis" ng-bind="::getOpenActionDescriptionText()"></span></a><div class="optionsMenu" ng-click="$event.stopPropagation();"> <button class="inFocusTileBtn" ng-click="inFocusTile($event);" ng-disabled="model.isLoading" ng-if="shouldShowInfocusButton()" localize-tooltip="TileEditor_InFocusTile"><i class="glyphicon pbi-glyph-miniexpand glyph-small"></i></button> <button class="insightsBtn" localize-tooltip="Insights_GetRelatedInsights_Tooltip" ng-disabled="model.isLoading" ng-click="inFocusTile($event, true)" ng-if="isInsightsSupported()  && shouldShowInfocusButton()"><i class="glyphicon pbi-glyph-insight"></i></button> <button class="vcPinBtn" ng-click="pinTileFromDashboard($event)" ng-disabled="model.isLoading" ng-hide="!shouldShowPinButton();" localize-tooltip="PinVisual_ToolTip"><i class="glyphicon pbi-glyph-pinned"></i></button> <button class="vcAlertBtn" ng-click="showAlertsEditor($event)" ng-disabled="model.isLoading" ng-hide="::!shouldShowAlertsButton();" localize-tooltip="ManageAlerts_Tooltip"><i class="glyphicon pbi-glyph-bell"></i></button> <button class="vcExportBtn" ng-click="exportVisualData($event);" ng-if="::canExport" localize-tooltip="ExportData_MenuItem"><i class="glyphicon pbi-glyph-export glyph-small"></i></button> <button class="editTileBtn" ng-click="editTile($event);" ng-disabled="model.isLoading" localize-tooltip="TileEditor_PaneTitle_Details"><i class="glyphicon pbi-glyph-edit"></i></button> <button class="deleteTileBtn" ng-click="deleteTile();" localize-tooltip="TileEditor_DeleteTile"><i class="glyphicon pbi-glyph-delete"></i></button></div><div class="webContentWarning" ng-if="::viewModel.type === 1"><span localize="WebContentWarning_Widget" localize-tooltip="WebContentWarning_Widget"></span><a href="https://go.microsoft.com/fwlink/?LinkID=759648" localize="LearnMore" target="_blank"></a></div></div>'),e.put("views/tiles/iframeTile.html",'<div class="iframeTile"><iframe class="iframeSelf" ng-if="!viewModel.isLoading" frameborder="0" ng-src="{{iframeSource}}" sandbox="allow-scripts allow-popups allow-same-origin allow-forms" marginheight="0" marginwidth="0"></iframe></div>'),e.put("views/tiles/imageTile.html",'<div class="imageTile"><printable-image source="{{viewModel.imageUrl}}"></printable-image></div>'),e.put("views/tiles/modelTile.html",'<div class="modelTile"><printable-image source="{{imageUrl}}"></printable-image></div>'),e.put("views/tiles/providerTile.html",'<div class="dashboardTaskPaneTile" ng-click="openTile()"><div class="background" background-image="{{viewModel.backgroundImageUrl}}"></div><div class="dashboardTaskPaneTitle" ng-bind="viewModel.displayText"></div></div>'),e.put("views/tiles/reportTile.html",'<div class="explorationContainer" ng-switch="viewModel.isError"><exploration ng-switch-when="false" view-model="viewModel.exploration" disable-print="true"></exploration><error-placeholder ng-switch-when="true" error-text="viewModel.errorText"></error-placeholder></div>'),
e.put("views/tiles/ssrsTile.html",'<div class="ssrsTile"><printable-image source="{{viewModel.imageUrl}}"></printable-image></div>'),e.put("views/tiles/tile.html",'<div class="tile baseTile" ng-class="{ noTitle: !viewModel.hasTitle(), largeHeader:largeHeader, noSubtitle: !viewModel.hasSubtitle() && viewModel.hasTitle() }"><div class="item-auto" ng-if="::(viewModel.type === 1)"><div class="webContentCorner"></div> <button class="webContentIcon" localize-tooltip="WebContentWarning_Widget" ng-click="onIconClick(getWebContentIcon(), $event)"><i class="glyphicon pbi-glyph-securityalert glyph-small"></i></button></div><header class="flexbox"> <button ng-repeat="icon in ::getIcons()" class="item-auto {{::icon.itemClass}}" ng-if="::icon.show()" title="{{::icon.tooltip()}}" ng-click="onIconClick(icon, $event)"><i class="glyphicon glyph-small {{::icon.iconClass}}"></i><span class="badge" ng-if="::icon.hasBadge" ng-bind="icon.badgeValueSetter()"></span></button><div class="headerText item-fill" ng-click="headerClickTarget({event: $event})"><div class="displayText" ng-bind="viewModel.getDisplayText()"></div><div class="flexbox"><span class="subDisplayText item-auto first-part" ng-bind="viewModel.getSubDisplayText()"></span> <span class="subDisplayText item-auto" ng-show="viewModel.shouldPlaceBulletSeperator()">•</span><span class="subDisplayText item-auto item-fill" bind-text-and-tooltip="viewModel.lastRefreshTimeInLocaleWithLabel()"></span></div></div></header><section><div class="loadingPlaceholder"><div class="loadingPlaceholderText glyphicon pbi-glyph-powerbi glyph-large"></div></div><div ng-show="!viewModel.isTileLoading && shouldShowTileVisual()" class="tileBody unselectable" ng-class="::{nonInteractive: disablePointerEvents}" ng-switch on="::{{viewModel.type}}"><composite-tile view-model="viewModel.composite" ng-switch-when="0" allow-interactivity="{{::allowInteractivity}}"></composite-tile><iframe-tile view-model="viewModel.iframe" ng-switch-when="1"></iframe-tile><image-tile view-model="viewModel.image" ng-attr-title="{{viewModel.displayText}}" ng-switch-when="2"></image-tile><model-tile view-model="viewModel.model" ng-switch-when="3"></model-tile><ssrs-tile view-model="viewModel.ssrs" ng-switch-when="4"></ssrs-tile><workbook-tile view-model="viewModel.workbook" ng-switch-when="5"></workbook-tile><report-tile view-model="viewModel.reportTile" ng-switch-when="6"></report-tile><real-time-tile view-model="viewModel.realTime" ng-switch-when="8"></real-time-tile></div><error-placeholder ng-if="!shouldShowTileVisual()" error-text="errorText" error-details="errorDetails"></error-placeholder></section></div>'),e.put("views/tiles/workbookTile.html",'<div class="workbookTile" ng-class="{hasTitle: title}" ng-switch="useLiveEwaControl"><iframe ng-src="{{::workbookTileUrl}}" ng-switch-when="true"/><printable-image source="{{viewModel.dynamicImageUrl}}" disable-animation="true" ng-class="{backgroundOriginalSize: viewModel.keepOriginalContentSize}" ng-switch-when="false"></printable-image> <img class="internalWorkbookTileImage" name="internalWorkbookTileImage" ng-src="{{viewModel.previewImageUrl}}" ng-hide="true"/></div>'),e.put("views/usageBarMenuItemView.html",'<div class="usageBarMenuItemBlock"><div class="{{labelClass}}">{{text}}</div><div class="toptext">{{usageDescription}}</div><section class="usageBar"><div class="bar usedSpace"></div><div class="bar freeSpace"></div></section></div>'),e.put("views/usageBarView.html",'<div class="usageBarBlock"><div class="toptext">{{usageBarModel.usageDescription}}</div><section class="usageBar"><div class="bar selfUsed"></div><div class="bar othersUsed"></div><div class="bar freeSpace"></div></section><section class="legends"><span class="square selfUsed"></span><div class="textstyle">{{usageBarModel.selfUsageInUnit}}</div><span ng-switch on="viewModel.isMyWorkspace"><div class="textstyle" localize="QuotaManagement_OwnedByMe" ng-switch-when="true"></div><div class="textstyle" localize="QuotaManagement_OwnedByUs" ng-switch-when="false"></div></span><span class="square othersUsed"></span><div class="textstyle">{{usageBarModel.otherUsageInUnit}}</div><div class="textstyle" localize="QuotaManagement_OwnedByOthers"></div></section><section class="limit"><div class="limitnumber">{{viewModel.quotaLimitInUnit}}</div><div class="limitline"></div></section></div>'),e.put("views/userGroupHeaderView.html",'<header class="userGroupHeader"><h1><span class="name" ng-bind="viewModel.isMyWorkspace ? viewModel.userName : viewModel.activeGroup.displayName"></span><span class="servicePlan" localize="QuotaManagement_FreeUser" ng-if="!viewModel.isPremiumUser"></span><span class="servicePlan" localize="QuotaManagement_ProTrialUser" ng-if="viewModel.userHasFreeTrial && !viewModel.userHasPremiumPlan && viewModel.isMyWorkspace"></span><span class="servicePlan" localize="QuotaManagement_ProUser" ng-if="viewModel.userHasPremiumPlan && viewModel.isMyWorkspace"></span></h1></header>'),e.put("views/viewContentPack.html",'<div class="sliderContentView"><div class="viewContentPack"><user-group-header view-model="userGroupHeader" feature-switch-not="breadcrumbNavigationEnabled"></user-group-header><div class="tableArea" ng-switch="contentPacks.length> 0" feature-switch-class="breadcrumbNavigationEnabled"><table class="viewContentPackTable" ng-switch-when="true"><tbody><tr><th class="contentPackName" localize="Publish_ContentPackName"></th><th class="publishedTo" localize="Publish_ContentPackPublishedTo"></th><th class="datePublished" localize="Publish_ContentPackDatePublished"></th><th class="actions" localize="Publish_ContentPackActions"></th></tr><tr ng-repeat="user in contentPacks"><td class="name"> <span ng-bind="user.displayText"/>&nbsp;&nbsp;<span ng-show="user.providerContract.isDirty" class="indicator glyphicon pbi-glyph-warning glyph-small" localize-tooltip="PublishContentPack_ChangesTooltip"></span></td><td class="publishedTo" ng-bind="user.publishedTo"></td><td class="datePublished" ng-bind="user.publishTime | date:\'MMM d, yyyy\'"></td><td class="performAction noOptions"><a href="" ng-click="editContentPack(user.providerId)" class="editContentack linkSection"><span localize="Publish_EditContentPack"></span></a> &nbsp;|&nbsp;<a href="" ng-click="deleteContentPack(user.providerKey)" class="deleteContentPack linkSection"><span localize="Publish_DeleteContentPack"></span></a></td></tr></tbody></table><div class="viewContentPackTableEmpty unselectable" ng-switch-when="false"><i class="glyphicon pbi-glyph-warning glyph-med warningIcon"></i><h2 localize="ContentPack_NoContentPackWarningTitle"></h2><p localize="ContentPack_NoContentPackWarningText"></p><a href="https://go.microsoft.com/fwlink/?LinkId=623862" target="_blank" localize="LearnMore"></a></div></div></div></div>'),e.put("views/warningBar.html",'<div class="warningBar"><span class=\'warning\'><i class=\'glyphicon pbi-glyph-error icon\'></i></span><div class=\'errorMessage\'>{{viewModel.text}}</div><div class=\'button officeStyleLink\' ng-if="viewModel.type === 1" localize="ErrorBar_FixItText" ng-click="onFixItClick()"></div><div class=\'button officeStyleLink\' ng-if="viewModel.type === 2" localize="ErrorBar_NoText" ng-click="onNoClick()"></div><div class=\'button officeStyleLink\' ng-if="viewModel.type === 2" localize="ErrorBar_YesText" ng-click="onYesClick()"></div></div>'),e.put("views/waterMarkMessage.html",'<div class="waterMarkMsg unselectable"><i class="glyphicon" ng-class="{true: \'pbi-glyph-error glyph-med\', false: \'pbi-glyph-warning glyph-med warningIcon\'}[config.mode]"></i><div ng-if="config.imgClass" ng-class="config.imgClass"></div><div ng-switch="config.canEdit"><div ng-switch-when="true"><h2 class="title" ng-bind="config.titleNonShared"></h2><p class="content" ng-bind="config.contentNonShared"></p></div><div ng-switch-when="false"><h2 class="title" ng-bind="config.titleShared"></h2><p class="content" ng-bind="config.contentShared"></p><p ng-bind="config.contact"></p></div></div><p ng-if="config.linkAction"><span class="linkDescription" ng-bind="config.linkDescription"></span><span class="linkText" ng-mousedown="config.linkAction()" ng-bind="config.linkText"></span></p><pbi-button ng-if="config.btnClick" label="{{config.btnLabelKey}}" localize-tooltip="{{config.btnLabelKey}}" ng-click="config.btnClick()" primary="true"></pbi-button></div>'),e.put("views/widgets/editIframeWidget.html",'<div><h6 class="input-field-label required" localize="EditWidget_EmbedCode"></h6><textarea ng-model="viewModel.tile.iframe.embedCode"></textarea><div class="infoBlock"><i class="glyphicon glyph-small pbi-glyph-info"></i><span class="message" localize="EditWidget_WebContentIssues" localize-fragments><a class="link" href="https://go.microsoft.com/fwlink/?LinkID=799824" target="_blank" fragment-index="0" localize="LearnMore"></a></span></div></div>'),e.put("views/widgets/editImageWidget.html",'<div><form name="imageContentForm"><h6 class="input-field-label required" localize="TileEditor_Url"></h6> <input type="url" name="imageUrl" ng-model="viewModel.tile.image.imageUrl" ng-change="onChange()" ng-class="{hasError: imageContentForm.imageUrl.$touched && !viewModel.isImageUrlValid()}"/><div class="errorBlock" ng-show="imageContentForm.imageUrl.$touched && !viewModel.isImageUrlValid()"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="EditWidget_ImageWidget_InvalidUrl" localize-tooltip="EditWidget_ImageWidget_InvalidUrl"></div></div></form></div>'),e.put("views/widgets/editTextWidget.html",'<div class="editWidgetContainer" toolbar-anchor><div class="widgetDetails" localize="EditWidget_Details"></div><div><toolbar-overlay view-model="viewModel.toolbarModel" toolbar-container></toolbar-overlay><visual class="textVisual" view-model="viewModel.visualModel"></visual></div></div>'),e.put("views/widgets/editVideoWidget.html",'<div><form name="videoContentForm"><h6 class="input-field-label required" localize="EditWidget_VideoWidget_Url"></h6> <input type="url" name="videoUrl" ng-model="url" ng-blur="blurChanged()" ng-change="inputChanged()" ng-class="{hasError: videoContentForm.videoUrl.$touched && !viewModel.isVideoUrlValid()}"/><div class="errorBlock" ng-show="videoContentForm.videoUrl.$touched && !viewModel.isVideoUrlValid()"><i class="glyphicon glyph-small pbi-glyph-error"></i><div class="message" localize="EditWidget_VideoWidget_InvalidUrl" localize-tooltip="EditWidget_VideoWidget_InvalidUrl"></div></div></form></div>'),e.put("views/workbookAppBar.html",'<div class="workbookAppBarContent appBar trimmedTextWithEllipsis unselectable"><div class="appBarSection left"><ul><li class="workbookAppBarItemNotClickable"><span class="excelOnlineText" localize="WorkbookAppBar_ExcelOnline"></span></li><li class="appBarDivider"></li><li class="edit-menu" ng-class="{workbookAppBarItemNotClickable: !isEditEnabled()}"> <button dropdown-menu dropdown-items="editMenuActions" dropdown-class="workbookAppBarMenu" dropdown-dark-theme="viewModeState.getMode() === 0" dropdown-on-item-selected="editMenuActionSelected(selected)" ng-disabled="!isEditEnabled()" localize-tooltip="{{getEditButtonTooltipLocId()}}" dynamic-tooltip-update tabindex="0"><span localize="WorkbookAppBar_EditButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li></ul></div><div class="appBarSection right"><ul><li ng-switch="getRefreshDataStatus()" class="appBarText refreshStatus workbookAppBarItemNotClickable"><div ng-switch-when="0"><span ng-bind="refreshInformationText"></span></div><div ng-switch-when="1"> <button ng-click="showRefreshHistory()"><i class="glyphicon pbi-glyph-warning"></i></button><span ng-bind="refreshInformationText"></span></div><div ng-switch-when="2"><i class="glyphicon pbi-glyph-info" tooltip tooltip-config="refreshNotSupportedTooltip"></i><span ng-bind="refreshInformationText"></span></div></li><li class="reload" ng-class="{workbookAppBarItemNotClickable: !isWorkbookLoaded()}"> <button ng-disabled="!isWorkbookLoaded()" ng-click="reloadClicked()"><i class="glyphicon pbi-glyph-refresh"></i><span localize="WorkbookAppBar_ReloadButton"></span></button></li><li class="data-menu" id="data" ng-class="{workbookAppBarItemNotClickable: !isWorkbookLoaded()}"> <button ng-disabled="!isWorkbookLoaded()" dropdown-menu dropdown-items="dataMenuActions" dropdown-class="workbookAppBarMenu" dropdown-on-item-selected="dataMenuActionSelected(selected)" tabindex="0"><i class="glyphicon pbi-glyph-dataset"></i><span localize="WorkbookAppBar_DataButton"></span><i class="glyphicon pbi-glyph-chevrondownmedium glyph-mini"></i></button></li><li ng-class="{workbookAppBarItemNotClickable: !isPinToDashboardEnabled()}"> <button class="pinToDashboard" ng-disabled="!isPinToDashboardEnabled()" ng-click="pinClicked()" localize-tooltip="{{getPinButtonTooltipLocId()}}" dynamic-tooltip-update><i class="glyphicon pbi-glyph-pinned"></i><span localize="WorkbookAppBar_PinWorkbookElementButton"></span></button></li></ul></div></div>'),e.put("views/workbookContainer.html",'<div id="workbookContainerWrapper" class="workbookContainerContent"><workbook-discoverability-toast class="discoverabilityToast"></workbook-discoverability-toast><workbook-app-bar view-model="viewModel" ng-if="workbookAppBarIncluded"></workbook-app-bar><spinner class="centeredSpinner" ng-show="!isEmbeddedWorkbookReady && !embeddedWorkbookFailed"></spinner><iframe name="workbookEWAIsolation" class="workbookEWAIsolation" src="/ewaIsolation.cshtml" ng-if="isEmbeddedWorkbookDataReady" ng-class="{\'fullSizeFrame\': !workbookAppBarIncluded }"></iframe></div>');e.put("views/workbookDiscoverabilityToast.html",'<div class="workbookDiscoverabilityToast" ng-show="viewModel.showDiscoverabilityToast"><div class="arrow"></div><div class="title" localize="WorkbookPinDiscoverability_Title"></div><div class="message" localize="WorkbookPinDiscoverability_Message"></div><div class="gotItBtn"><pbi-button label="TutorialPopup_GotIt" primary="true" ng-click="dismissToast()"></pbi-button></div><i class="glyphicon pbi-glyph-pinned"></i></div>')}]);var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=220,o=(function(){function t(t,i){this.scope=t,this.services=i;var o=this.scope.viewModel.tile;this.scope.viewModel=new e.models.EditTextWidgetModel(o,this.services.featureSwitchService,this.services.explorationSerializer,this.services.visualPlugin),this.initializeViewModelProperties()}return t.createOptions=function(){return{additionalServices:["explorationSerializer","featureSwitchService","moduleLoader","localizationService","promiseFactory","visualPlugin"],scopedDependencies:["uiComponent"]}},t.prototype.initializeViewModelProperties=function(){var t=this,o=this.scope.viewModel;o.visualModel={type:e.dataServices.TileUtils.getVisualType(o.tile.config),viewport:{height:i},dataTransforms:o.tile.composite.visual.dataTransforms,hostServices:{getLocalizedString:function(e){return t.services.localizationService.get(e)},getViewMode:function(){return 1},getEditMode:function(){return 0},persistProperties:function(e){return t.persistProperties(e)},setToolbar:function(e){return t.setToolbar(e)},loader:function(){return t.services.moduleLoader},promiseFactory:function(){return t.services.promiseFactory},getUIComponentFactory:function(){return t.services.uiComponent.getUIComponentFactory(t.scope)}}},o.toolbarModel={visible:!0,$element:null,update:function(){},theme:e.common.directives.ToolbarOverlay.Themes.light,layout:e.common.directives.ToolbarOverlay.Layouts.stacked}},t.prototype.persistProperties=function(t){for(var i=this.scope.viewModel.tile.composite.visual,o=0,r=t;o<r.length;o++){var a=r[o],n=e.data.DataViewObjectDefinitions.ensure(i.dataTransforms.objects,a.objectName,a.selector);n.properties=a.properties,i.dataViews[0].metadata.objects||(i.dataViews[0].metadata.objects={}),i.dataViews[0].metadata.objects[a.objectName]=a.properties,i.visual.onDataChanged({dataViews:i.dataViews})}this.scope.$applyAsync(_.noop)},t.prototype.setToolbar=function(e){var t=this.scope.viewModel.toolbarModel;t.$element=e,t.update()},t})();t.EditTextWidgetController=o})(i=t.widgets||(t.widgets={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i,o){var r=this;this.featureSwitchService=t,this.explorationSerializer=i,this.visualPlugin=o,this.replace=!0,this.restrict="E",this.templateUrl="views/widgets/editIframeWidget.html",this.link=function(t){var i=t.viewModel.tile;t.viewModel=new e.models.EditIframeWidgetModel(i,r.featureSwitchService,r.explorationSerializer,r.visualPlugin)}}return t})();t.EditIframeWidget=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(t,i,o){var r=this;this.featureSwitchService=t,this.explorationSerializer=i,this.visualPlugin=o,this.replace=!0,this.restrict="E",this.templateUrl="views/widgets/editImageWidget.html",this.link=function(t){var i=t.viewModel.tile;i.image.isStatic=!0,t.viewModel=new e.models.EditImageWidgetModel(i,r.featureSwitchService,r.explorationSerializer,r.visualPlugin),t.onChange=function(){i.resetTileErrors&&i.resetTileErrors()},t.$on(e.common.constants.scopeDestroyEventName,(function(){i.resetTileErrors&&i.resetTileErrors()}))}}return t})();t.EditImageWidget=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.controller=e.common.createController(e.controllers.widgets.EditTextWidgetController),this.replace=!0,this.restrict="E",this.templateUrl="views/widgets/editTextWidget.html"}return t})();t.EditTextWidget=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(e){function t(t,i,o,r){return e.call(this,t,i,o,r)||this}return __extends(t,e),t.prototype.isDirty=function(){var t=this.tile;return t.iframe.srcUrl!==t.config.iframe.srcUrl||t.iframe.embedCode!==t.config.iframe.embedCode||e.prototype.isDirty.call(this)},t.prototype.isValid=function(t){return!!this.tile.iframe.embedCode&&e.prototype.isValid.call(this,t)},t.prototype.undoChanges=function(){var t=this.tile;t.iframe.srcUrl=t.config.iframe.srcUrl,t.iframe.embedCode=t.config.iframe.embedCode,e.prototype.undoChanges.call(this)},t.prototype.updateModelContract=function(){this.tile.config.iframe.srcUrl=this.tile.iframe.srcUrl,this.tile.config.iframe.embedCode=this.tile.iframe.embedCode,e.prototype.updateModelContract.call(this)},t})(e.TileEditorModel);e.EditIframeWidgetModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.dataServices.models.Tile,o=(function(e){function t(t,i,o,r){return e.call(this,t,i,o,r)||this}return __extends(t,e),t.prototype.isImageUrlValid=function(){var e=this.tile.image.imageUrl;return!!e&&(e.indexOf("data:")>=0||i.isValidUrl(e,!1))},t.prototype.isDirty=function(){var t=this.tile;return t.image.imageUrl!==t.config.imageTile.imageUrl||e.prototype.isDirty.call(this)},t.prototype.isValid=function(t){return this.isImageUrlValid()&&e.prototype.isValid.call(this,t)},t.prototype.undoChanges=function(){var t=this.tile;t.image.imageUrl=t.config.imageTile.imageUrl,e.prototype.undoChanges.call(this)},t.prototype.updateModelContract=function(){this.tile.config.imageTile.imageUrl=this.tile.image.imageUrl,e.prototype.updateModelContract.call(this)},t})(t.TileEditorModel);t.EditImageWidgetModel=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.data.DataViewTransform,o=(function(t){function o(o,r,a,n){var s=t.call(this,o,r,a,n)||this,c=s.tile.composite.visual,l=c.visual;if(l&&l.visualPlugin){var d=l.visualPlugin.capabilities;c.dataViews||(c.dataViews=i.apply({prototype:void 0,objectDescriptors:d?d.objects:null,transforms:c.dataTransforms,colorAllocatorFactory:e.visuals.createColorAllocatorFactory(),dataRoles:null}))}return s.originalDataTransforms=angular.copy(c.dataTransforms),s.originalDataViews=angular.copy(c.dataViews),s}return __extends(o,t),o.prototype.isDirty=function(){var e=this.tile.composite.visual.dataTransforms;return!_.isEqual(e,this.originalDataTransforms)||t.prototype.isDirty.call(this)},o.prototype.undoChanges=function(){var e=this.tile.composite.visual;e.dataTransforms=this.originalDataTransforms,e.dataViews=this.originalDataViews,e.visual.onDataChanged({dataViews:e.dataViews}),t.prototype.undoChanges.call(this)},o.prototype.updateModelContract=function(){this.tile.config.visualContainer.$visualContainer.config.singleVisual.objects=this.tile.composite.visual.dataTransforms.objects,t.prototype.updateModelContract.call(this)},o})(t.TileEditorModel);t.EditTextWidgetModel=o})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,a,n,s,c,d,p,u){return new l(e,t,i,o,r,a,n,s,c,d,p,u)}var i=e.dataServices.ContractUtils,o=e.explore.util.FilterContainerBuilder,r=e.explore.viewModels.FilterViewModelFactory,a=e.explore.QueryProjectionBuilderCoreUtils,n=e.data.services.SemanticQuerySerializer,s=e.dataServices.contracts.TileType;e.createExportDataService=t;var c="sobe_onpremisevirtualserver",l=(function(){function t(e,t,i,o,r,a,n,s,c,l,d,p){this.promiseFactory=e,this.notificationToastService=t,this.localizationService=i,this.conceptualSchemaProxy=o,this.visualPluginService=r,this.visualPluginOps=a,this.exportVisualDataService=n,this.featureSwitchService=s,this.displayNameService=c,this.aggrOps=l,this.filterRestatementService=d,this.drillToDetails=p}return t.prototype.exportTileDataToCsv=function(t){var o=this,r=t.composite,s=t.contract,c=t.config,l=e.dataServices.TileUtils.getVisualType(c),d=this.getDataSources(t),p=this.promiseFactory.defer(),u=this.localizationService,v=this.notificationToastService,h=v.notify({title:u.get("ExportData_LoadingTitle"),message:u.get("ExportData_LoadingMessage"),notificationType:e.common.NotificationToastType.Loading});return this.conceptualSchemaProxy.get(d).then((function(t){v.hide(h);var u=i.convertToSemanticQueryWithDataShapeBinding(s.query),g=n.deserializeQuery(u.defn),m=c.visualContainer.elements,f=m&&m.length>0?m[0].DataRoles:null,y=o.visualPluginService.getPlugin(l),b=a.createProjectionBuilderFromDataRoles(y,f,g,t),S=o.visualPluginService.capabilities(l);if(S){var w=c.visualContainer.$visualContainer.config.singleVisual.objects,C={objects:w,visualType:l,query:new e.explore.contracts.VisualQuery(g,b.build(u.shape))};o.exportVisualDataToCsv(c.visualContainer.heading1,r.tileData,d,C,r.visual.dataTransforms,null).then((function(e){p.resolve(e)}),(function(e){p.reject(e)}))}}),(function(){v.hide(h)})),p.promise},t.prototype.exportVisualDataToCsv=function(t,i,o,r,a,n){var s=this.localizationService,c=this.notificationToastService,l=c.notify({title:s.get("ExportData_LoadingTitle"),message:s.get("ExportData_LoadingMessage"),notificationType:e.common.NotificationToastType.Loading,sticky:!0}),d=this.exportVisualDataService.exportToCsv(t,i,o,r,a,n);return this.handleExportDataResult(d,l)},t.prototype.exportVisualDataToExcel=function(t,i,o,r,a,n){var s=this,c=this.localizationService,l=this.notificationToastService,d=this.promiseFactory.defer(),p=l.notify({title:c.get("ExportData_LoadingTitle"),message:c.get("ExportData_LoadingMessage"),notificationType:e.common.NotificationToastType.Loading,sticky:!0});return this.conceptualSchemaProxy.get(i).then((function(e){var c=o;if(a){var l=s.drillToDetails.generateDetailsTable(o,e,n);if(!l)return void d.reject({blob:null,error:4});c=l}s.generateFiltersDescriptionPromise(e,r,c,i).then((function(e){s.exportVisualDataService.exportToExcel(t,i,c,r,e).then((function(e){d.resolve(e)}),(function(e){d.reject(e)}))}),(function(){d.reject({blob:null,error:5})}))}),(function(){d.reject({blob:null,error:3})})),this.handleExportDataResult(d.promise,p)},t.prototype.canExportTileData=function(t){if(!this.featureSwitchService.featureSwitches.exportDataEnabled)return!1;if(t.type!==s.composite)return!1;var o=t.composite&&t.composite.visual&&t.composite.visual.type,r=this.visualPluginService.getPlugin(o);if(!r)return!1;if(!t.composite.tileData)return!1;if(!this.visualPluginOps.isQueryVisual(o))return!1;try{var a=t&&t.contract&&t.contract.query,n=i.convertToSemanticQueryWithDataShapeBinding(a),c=n.defn;if(!c||!c.Version||c.Version<e.data.SemanticQueryVersions.Version2)return!1}catch(e){return!1}return!0},t.prototype.getExportDataToExcelUnsupportedType=function(e,t){var i=e.objects,o=e.visualType,r=!0;return!r&&this.isDataModelASOnPremises(t)?1:i&&i.forecast?3:i&&i.clustering?2:this.visualPluginService.isScriptVisual(o)?4:this.visualPluginService.isCustomVisual(o)?5:0},t.prototype.isDataModelASOnPremises=function(e){return e&&e.vsName&&e.vsName===c},t.prototype.generateFiltersDescriptionPromise=function(t,i,a,n){var s={filtersNamesAndRestatements:[]},c=this.promiseFactory.defer();if(!i||!i.dataFilter)return c.resolve(s),c.promise;var l=o.fromSemanticFilter(i.dataFilter,t);if(!l)return c.resolve({}),c.promise;for(var d={container:l,scopeType:0},p=[],u=[],v=[],h=0,g=l;h<g.length;h++){var m=g[h],f=this.visualPluginService.capabilities(a.visualType),y=r.convertFilterContainer(m,t,this.displayNameService,d,this.visualPluginService,this.aggrOps,this.localizationService,f);y.updateFilterProperties(t,this.visualPluginService,this.aggrOps),y.contract.config={singleVisual:a};var b={includeVariationSource:!0};p.push(this.displayNameService.getDisplayName(y.contract.expression,t,f,b)),u.push(this.displayNameService.getQualifiedDisplayName(y.contract.expression,t,f,b));var S=this.promiseFactory.defer(),w=e.explore.components.TopNFilterViewModelFactory.createViewModelFromSemanticFilter(m.filter,t,this.localizationService,this.displayNameService,this.aggrOps);if(w)S.resolve(w.getRestatement(this.localizationService));else{var C=e.explore.viewModels.FilterViewModelFactory.extractAdvFilterCard(m);if(!C)return c.resolve({}),c.promise;var D=C.getRestatement(y.formatter);D?S.resolve(D):S.promise=this.filterRestatementService.loadRestatement(n,m,y.formatter)}v.push(S.promise)}return p.length!==l.length||v.length!==l.length||u.length!==l.length?(c.resolve({}),c.promise):(this.promiseFactory.all(v).then((function(e){for(var t=0;t<l.length;t++)_.isEmpty(p[t])||_.isEmpty(e[t])||s.filtersNamesAndRestatements.push({displayName:p[t],qualifiedDisplayName:u[t],restatement:e[t]});c.resolve(s)})),c.promise)},t.prototype.getDataSources=function(t){var i=t.contract,o=e.explore.contracts.createDataSourceArray(),r={type:"dsr",id:i.modelId,name:i.modelName,dsr:{schemaName:i.modelName,vsName:t.vsName,dbName:t.dbName,modelId:i.modelId}};if(o.push(r),this.featureSwitchService.featureSwitches.reportMeasures){var a=e.explore.constants.ExplorationSchemaName;o.push({type:e.explore.dataReaderPlugins.ExplorationDataReaderType,id:i.id,name:a,extends:i.modelName,exploration:{schemaName:a,extends:i.modelName,getModelExtensions:function(){return t.config.visual.$modelExtensions}}})}return o},t.saveResult=function(e){switch(e.format){case 0:var t=new Blob([e.blob],{type:"text/csv;charset=utf-8;"});saveAs(t,e.fileName);break;case 1:var i=new Blob([e.blob],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;"});saveAs(i,e.fileName)}},t.prototype.handleExportDataResult=function(i,o){var r=this.promiseFactory.defer(),a=this.localizationService,n=this.notificationToastService;return i.then((function(i){null!=i.error?(n.notify({title:a.get("ExportData_FailureTitle"),message:a.get("ExportData_FailureMessage"),notificationType:e.common.NotificationToastType.Error}),r.reject(i)):(i.isPartialResult&&n.notify({title:a.get("ExportData_PartialDataTitle"),message:a.get("ExportData_PartialDataMessage"),notificationType:e.common.NotificationToastType.Warning}),t.saveResult(i),r.resolve(i))}),(function(t){n.notify({title:a.get("ExportData_FailureTitle"),message:a.get("ExportData_FailureMessage"),notificationType:e.common.NotificationToastType.Error}),r.reject(t)})).finally((function(){return n.hide(o)})),r.promise},t})();e.ExportDataService=l})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i){return new o(e,t,i)}t.createExportStaticExplorationService=i;var o=(function(){function t(e,t,i){this.exportStaticReportProxy=e,this.notificationToast=t,this.localizationService=i}return t.prototype.exportToPng=function(i,o,r){var a=this,n=this.localizationService,s=this.notificationToast.notify({title:n.get("ExportStaticImage_Title"),message:n.get("ExportStaticImage_Message"),notificationType:e.common.NotificationToastType.Loading});this.exportStaticReportProxy.exportAsImage(o,r).then((function(e){var o=new Blob([e.blob],{type:"image/png"});saveAs(o,t.getFileName(i))})).finally((function(){a.notificationToast.hide(s)}))},t.getFileName=function(e){var t=jsCommon.StringExtensions.normalizeFileName(e);return t+".png"},t})();t.ExportStaticExplorationService=o})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(e,t){var i=this;this.restrict="E",this.replace=!0,this.templateUrl="views/pbiDataLoaderSpinner.html",this.link=function(e,t,o){var r=t.find("h3");r.text(i.loc.get("DataLoaderSpinner_LoadingMessage1")),i.timeout((function(){r.text(i.loc.get("DataLoaderSpinner_LoadingMessage2"))}),5e3)},this.loc=e,this.timeout=t}return e})();e.PbiDataLoaderSpinner=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o,a,n,s){return new r(e,t,i,o,a,n,s)}var o=e.common.constants;t.createPageTitleService=i;var r=(function(){function t(e,t,i,o,r,a,n){this.navigationService=t,this.window=a,this.dashboardService=i,this.reportService=o,this.localizationService=e,this.workbookService=r,this.rootScope=n,this.initialize()}return t.prototype.refresh=function(){var e,t=this.navigationService,i=this.localizationService,o=this.reportService,r=this.workbookService,a=this.dashboardService;if(t.inReportView()){var n=o.findReportByGUID(t.currentReportGUID);n&&n.displayName&&(e=i.format("PowerBI_PageTitle",[n.displayName]))}else if(t.inWorkbookView()){var s=r.findWorkbookByUniqueId(t.currentWorkbookURLIdentifier);s&&s.displayName&&(e=i.format("PowerBI_PageTitle",[s.displayName]))}else if(t.inDashboardView()){var c=a.findDashboardByGUID(t.currentDashboardGUID);c&&c.displayName&&(e=i.format("PowerBI_PageTitle",[c.displayName]))}_.isEmpty(e)&&(e=i.get("Power_BI")),this.window.document.title=e},t.prototype.initialize=function(){var t=this,i=this.rootScope,r=function(){t.refresh()},a=i.$on(o.navigation.stateChangeSuccess,r),n=i.$on(o.currentActiveReportInfoChangedEventName,r),s=i.$on(e.constants.renameDashboardEventName,r),c=i.$on(e.constants.dashboardContainerLoaded,r);i.$on("$destroy",(function(){a(),n(),s(),c()}))},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t,i,o){return new a(e,t,i,o)}var o=e.common.models.CollapsiblePaneExpandedWidth,r=e.common.constants.TaskPaneCollapsiblePaneMode;t.createShareSliderService=i;var a=(function(){function e(e,t,i,o){this.navigation=e,this.rootscope=t,this.taskPaneSliderService=i,this.licenseEnforcementService=o}return e.prototype.openShareSlider=function(e){if(e){if(this.shareDashboard=e,!this.licenseEnforcementService.supportsSharing(!0))return;this.taskPaneSliderService.expandPane(r.SharingPane,o.Large)}},e})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(t,i){var o=this;this.scope=t,this.services=i;var r=this.scope.viewModel.tile;this.scope.viewModel=new e.models.EditVideoWidgetModel(r,this.services.featureSwitchService,this.services.explorationSerializer,this.services.visualPlugin),this.scope.url=r.iframe.srcUrl,this.scope.inputChanged=function(){return o.inputChanged()}}return t.createOptions=function(){return{additionalServices:["explorationSerializer","featureSwitchService","visualPlugin"]
}},t.prototype.inputChanged=function(){var e=this.scope.url,i=this.scope.viewModel.tile.iframe,o=this.parseUrl(e),r=o.hostname.toLowerCase();if(("www.youtube.com"===r||"youtube.com"===r)&&o.queryParams.v)return i.srcUrl=e,void(i.embedCode=jsCommon.StringExtensions.format(t.youtubeEmbedTemplate,o.queryParams.v+o.search));if("youtu.be"===r){var a=_.trimLeft(o.pathname,"/");if(a)return i.srcUrl=e,void(i.embedCode=jsCommon.StringExtensions.format(t.youtubeEmbedTemplate,a+o.search))}else if(_.contains(r,"vimeo.com")){var n=this.parseVimeoVideoId(e);if(null!=n)return i.srcUrl=e,void(i.embedCode=jsCommon.StringExtensions.format(t.vimeoEmbedTemplate,n))}i.srcUrl="",i.embedCode=""},t.prototype.parseUrl=function(e){var t=document.createElement("a");return t.href=e,{hostname:t.hostname,pathname:t.pathname,search:t.search,queryParams:jsCommon.QueryStringUtil.parseQueryString(t.search)}},t.prototype.parseVimeoVideoId=function(e){var t=/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)((#|\?)(.*))?$/i,i=e.match(t);if(i)return i[5]},t})();i.youtubeEmbedTemplate='<iframe width="100%" height="100%" src="https://www.youtube.com/embed/{0}" frameborder="0"></iframe>',i.vimeoEmbedTemplate='<iframe width="100%" height="100%" src="https://player.vimeo.com/video/{0}" frameborder="0"></iframe>',t.EditVideoWidgetController=i})(i=t.widgets||(t.widgets={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i;!(function(t){var i=(function(){function t(t,i){var o=this;this.excelProviderBaseEndpointPath="/powerbi/providers/excel/",this.scope=t,this.services=i,this.scope.isLoading=!1,this.scope.hasError=!1;var r,a="<share-point-url-modal></share-point-url-modal>",n=this.services.telemetryService.startChildEvent(this.services.telemetryService.root,e.telemetry.CustomConfigHandlerSharePointDiscover,this.scope.url),s={dialogName:this.services.localizationService.get("SharePoint_ModalTitle"),isDismissable:!1,scope:this.scope,template:a,focusOnFirstButton:!0,dialogActions:[new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_Connect"),function(i,a){o.scope.isLoading=!0,o.scope.hasError=!1,o.services.contentProviderConfigHandler.configData={},o.services.contentProviderConfigHandler.configData.sharePointUrl=o.scope.url,o.getDocumentLibararies(n.event).then((function(i){o.services.contentProviderConfigHandler.configData.result=i,o.scope.isLoading=!1,r.closeDialog(),t.$emit(e.common.constants.contentProviderStoreCustomConfigurationPostbackEventName,!0),n.resolve()}),(function(t){o.scope.hasError=!0,o.scope.isLoading=!1,(t.status=e.HttpStatusCode.NotFound)?(o.scope.errorMessage=o.services.localizationService.get("SharePoint_AccessError"),n.resolve()):(r.closeDialog(),n.reject())}))}),new InJs.ModalDialogAction(this.services.localizationService.get("ModalDialog_Cancel"),function(i,a){o.scope.isLoading=!1,o.scope.hasError=!1,r.closeDialog(),t.$emit(e.common.constants.contentProviderStoreCustomConfigurationPostbackEventName,!1)})],notificationType:jsCommon.ModalDialogNotificationType.Info};r=this.services.modalDialogService.showLegacyWebModalDialog(s)}return t.createOptions=function(){return{additionalServices:["modalDialogService","localizationService","contentProviderConfigHandler","telemetryService"]}},t.prototype.getDocumentLibararies=function(t){var i=e.common.httpService.powerbiRequestOptions(t,"GetSharepointDocumentLibraries"),o=this.excelProviderBaseEndpointPath+"allDocumentLibraries";return this.scope.url&&(o=o+"?siteUrl="+this.scope.url),e.common.httpService.get(o,i)},t})();t.SharePointUrlInputController=i})(i=t.contentProviderStore||(t.contentProviderStore={}))})(t=e.controllers||(e.controllers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.controller=e.common.createController(e.controllers.widgets.EditVideoWidgetController),this.replace=!0,this.restrict="E",this.templateUrl="views/widgets/editVideoWidget.html"}return t})();t.EditVideoWidget=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(e){function t(t,i,o,r){return e.call(this,t,i,o,r)||this}return __extends(t,e),t.prototype.isVideoUrlValid=function(){return!!this.tile.iframe.srcUrl},t.prototype.isDirty=function(){var t=this.tile;return t.iframe.srcUrl!==t.config.iframe.srcUrl||e.prototype.isDirty.call(this)},t.prototype.isValid=function(t){return this.isVideoUrlValid()&&e.prototype.isValid.call(this,t)},t.prototype.undoChanges=function(){var t=this.tile;t.iframe.srcUrl=t.config.iframe.srcUrl,t.iframe.embedCode=t.config.iframe.embedCode,e.prototype.undoChanges.call(this)},t.prototype.updateModelContract=function(){var t=this.tile.config.iframe,i=this.tile.iframe;t.srcUrl=i.srcUrl,t.embedCode=i.embedCode,e.prototype.updateModelContract.call(this)},t})(e.TileEditorModel);e.EditVideoWidgetModel=t})(t=e.models||(e.models={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/tiles/dashboardTileOpenOptions.html",this.replace=!0}return e})();e.DashboardTileOpenOptions=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(e){var t=(function(){function e(){this.restrict="E",this.templateUrl="views/tiles/dashboardTileOptionsMenu.html",this.replace=!0}return e})();e.DashboardTileOptionsMenu=t})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=(function(){function t(){this.restrict="E",this.controller=e.common.createController(e.controllers.contentProviderStore.SharePointUrlInputController)}return t})();t.SharePointUrlInput=i})(t=e.directives||(e.directives={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){var i=e.common.constants,o=(function(){function e(){}return e.getClusterLocation=function(e,t){var o=i.clusterLocations;for(var r in o)for(var a=o[r],n=0,s=a;n<s.length;n++){var c=s[n];if(e.toLocaleLowerCase().indexOf(c)>=0)return t.get(r)}return t.get("Cluster_Location_TestEnvironment")},e})();t.ClusterLocationHelper=o})(t=e.helpers||(e.helpers={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i,o,r,n){return new a(e,t,i,o,r,n)}var i=e.contracts.DynamicMessageNotificationLevel,o=e.contracts.DynamicMessageNotificationType,r=e.contracts.DynamicMessageActionType;e.createDynamicMessagingDataService=t;var a=(function(){function t(e,t,i,o,r,a){var n=this;this.dynamicMessagingDataHttp=e,this.userNotificationInfo=t,this.userInfo=i,this.telemetryService=o,this.localizationService=r,this.asyncFeatureSwitchService=a,"undefined"!=typeof dynamicMessagingUrl&&this.asyncFeatureSwitchService.getFeatureSwitches().then((function(){n.asyncFeatureSwitchService.featureSwitches.dynamicMessageEnabled&&n.getData()}))}return t.prototype.postData=function(t){if(this.notificationMessage){var i=this.telemetryService.startEvent(e.telemetry.DynamicMessageUserAction,t);return this.dynamicMessagingDataHttp.postData(this.localizationService.currentLanguageLocale,this.notificationMessage.MessageID,this.notificationMessage.TransactionID,this.notificationMessage.CampaignId,this.userInfo.puid,t).then((function(e){i.resolve()}),(function(t){i.reject({errorCode:"DynamicMessagingPostUserActionFailed.",errorSource:e.telemetry.ErrorSource.External})}))}},t.prototype.getData=function(){var t=this,i=this.telemetryService.startEvent(e.telemetry.DynamicMessageGetMessage,!1);this.userInfo.puid&&this.dynamicMessagingDataHttp.getData(this.userInfo.puid,this.localizationService.currentLanguageLocale).then((function(o){if(null!=o.data){var r=o.data[dynamicMessageSurfaceName],a=r.Data;if(r&&99!==r.ContentType&&r.Message){t.notificationMessage=r;var n=jsCommon.JsonExtensions.tryParseJSON(r.Message);n&&n.NotificationTitle&&n.NotificationMessage&&(t.userNotificationInfo.addClientNotification({id:0,notificationCategory:e.userNotifications.contracts.NotificationCategory.DynamicMessage,notificationType:t.getUserNotificationType(a),notificationLevel:t.getUserNotificationLevel(a),message:t.createNotificationMessage(n),action:_.isEmpty(n.Buttons)?null:t.createNotificationAction(n.Buttons[0],n.ActionType),subAction:_.isEmpty(n.Buttons)&&n.Buttons.length<2?null:t.createNotificationAction(n.Buttons[1]),seen:!1}),i.event.info.parsedMessage=!0)}}i.resolve()}),(function(t){i.reject({errorCode:"DynamicMessagingInitializationFailed.",errorSource:e.telemetry.ErrorSource.External})}))},t.prototype.createNotificationAction=function(e,t){var i=null;return e&&(i={resource:{text:e.Text},actionType:this.getNotificationActionType(t),path:[e.URL]}),i},t.prototype.getNotificationActionType=function(t){if(!t)return 5;var i=e.contracts.DynamicMessageActionType[t];switch(i){case r.EnablePreviewFeatures:return 6;default:return 5}},t.prototype.createNotificationMessage=function(e){var t={title:{text:e.NotificationTitle},image:this.createNotificationImage(e.Body),message:{text:e.NotificationMessage}};return e.Body&&(t.subTitle=this.createNotificationSubtitle(e.Body)),t},t.prototype.createNotificationImage=function(e){var t={imageType:6};if(e){var i=e.filter((function(e){return e.ImageURL})).map((function(e){return e.ImageURL}));t.imagePath=_.first(i)}return t},t.prototype.createNotificationSubtitle=function(e){var t={},i=e.filter((function(e){return e.Text})).map((function(e){return e.Text}));return _.isEmpty(i)||(t.text=i[0]),t},t.prototype.getUserNotificationType=function(e){if(!e)return 1;var t=o[e.NotificationType];switch(t){case o.NotificationPane:return 1;case o.Popup:return 0;case o.NotificationBar:return 2;default:return 1}},t.prototype.getUserNotificationLevel=function(e){if(!e)return 1;var t=i[e.NotificationLevel];switch(t){case i.Low:return 0;case i.Normal:return 1;case i.High:return 2;default:return 1}},t})();e.DynamicMessagingDataService=a})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(){return new i}e.createDynamicMessagingDataHttpService=t;var i=(function(){function t(){}return t.prototype.getData=function(t,i){var o=e.common.httpService.powerbiRequestOptions();return e.common.httpService.get(jsCommon.StringExtensions.format("{0}/api/V2/messaging/Web/Message?source={1}&Locale={2}&id=5:{3}",dynamicMessagingUrl,dynamicMessageSurfaceName,i,t),o)},t.prototype.postData=function(t,i,o,r,a,n){var s=e.common.httpService.powerbiRequestOptions(),c=jsCommon.StringExtensions.format("{0}/api/v1/messaging/Web/useraction?source={1}&Locale={2}&contentID={3}&transactionID={4}&campaignId={5}&id={6}&type=0&useraction={7}",dynamicMessagingUrl,dynamicMessageSurfaceName,t,i,o,r,a,n);return e.common.httpService.post(c,{},s)},t})();e.DynamicMessagingDataHttpService=i})(powerbi||(powerbi={}));var powerbi;!(function(e){var t;!(function(t){function i(e,t){return new o(e,t)}t.createQuota=i;var o=(function(){function t(e,t){this.storageUsageService=e,this.dashboardService=t}return Object.defineProperty(t.prototype,"quotaLimitInMB",{get:function(){return this.storageUsageService.quotaLimitInMB},enumerable:!0,configurable:!0}),t.prototype.getUsageModels=function(){return this.storageUsageService.getUsageModels(this.dashboardService.dashboards)},t.prototype.getUsage=function(){return this.storageUsageService.getUsage(this.dashboardService.dashboards)},t.prototype.checkQuotaExceeded=function(t,i){return void 0===t&&(t=e.telemetry.QuotaCheckOperation.Unknown),this.storageUsageService.checkQuotaExceeded(this.dashboardService.dashboards,t,i)},t.prototype.getUsageBarMenuItemViewModel=function(){return this.storageUsageService.getUsageBarMenuItemViewModel(this.dashboardService.dashboards)},t.prototype.showQuotaExceedDialog=function(){this.storageUsageService.showQuotaExceedDialog()},t.prototype.isInVisibleDashboard=function(e){return this.storageUsageService.isInVisibleDashboard(e)},t})()})(t=e.services||(e.services={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){function t(e,t,i){return new o(e,t,i)}var i=e.telemetry.UsageMetricsArtifactType;e.createUsageMetricsHttpService=t;var o=(function(){function t(e,t,i){this.telemetryService=e,this.promiseFactory=t,this.httpService=i}return t.prototype.getPackage=function(t,o){return __awaiter(this,void 0,e.Promise,(function(){var r,a,n,s,c,l,d,p;return __generator(this,(function(u){switch(u.label){case 0:r=this.telemetryService.startChildEvent(o,e.telemetry.UsageMetricsHttpGetPackage,t),u.label=1;case 1:switch(u.trys.push([1,3,,4]),a=void 0,t){case i.Report:a="powerbi/content/providers/usagemetrics/report/";break;case i.Dashboard:a="powerbi/content/providers/usagemetrics/dashboard/"}return n=this.httpService.powerbiRequestOptions(o,"getPackage"),[4,this.httpService.get(a,n)];case 2:return s=u.sent(),r.resolve(),[2,s.data];case 3:return c=u.sent(),l=this.promiseFactory.defer(),d=e.errorDetailsHelper.getTelemetryErrorDetails(c.error),r.reject(d),p=this.getErrorCode(c),l.reject({errorCode:p,requestId:c.requestId,error:c.error}),[2,l.promise];case 4:return[2]}}))}))},t.prototype.getErrorCode=function(e){var t;return e&&(e.error?t=e.error.code:e.status&&(t=e.status.toString())),t},t})()})(powerbi||(powerbi={}));;var __extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}})(),powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){e.NotIn="NotIn",e.SelectAll="All",e.operatorDictionary={None:0,LessThan:1,LessThanOrEqual:2,GreaterThan:3,GreaterThanOrEqual:4,Contains:5,DoesNotContain:6,StartsWith:7,DoesNotStartWith:8,Is:9,IsNot:10,IsBlank:11,IsNotBlank:12},e.logicalOperatorDictionary={Or:1,And:0};var r;!(function(e){e.InvalidDataType="InvalidDataType",e.FieldNotFound="FieldNotFound",e.FilterConditionNotFound="FilterConditionNotFound",e.FilterValidationErrors="FilterValidationErrors",e.LogicalConditionNotFound="LogicalConditionNotFound",e.BasicFilterSerializationError="BasicFilterSerializationError",e.AdvancedFilterSerializationError="AdvancedFilterSerializationError",e.InvalidFilterType="InvalidFilterType",e.InvalidFilterCondition="InvalidFilterCondition",e.FilterNotFound="FilterNotFound",e.BasicFilterOperatorNotFound="BasicFilterOperatorNotFound",e.InvalidReportData="InvalidReportData",e.InvalidPageData="InvalidPageData"})(r=e.ErrorCodes||(e.ErrorCodes={}));var t;!(function(e){e.InvalidFilterMessage="Filter is not valid, validation errors: ",e.InvalidTarget="Could not serialize json filter target to SQ expression.",e.InvalidCondition="Advanced filter requires a filter condition (None | LessThan | LessThanOrEqual | GreaterThan | GreaterThanOrEqual | Contains | DoesNotContain | StartsWith | DoesNotStartWith | Is | IsNot | IsBlank | IsNotBlank).",e.InvalidDataTypeMessage="The data type of the value {0} is not supported. Only string, number and boolean are supported.",e.FilterSerializationError="Could not serialize filter.",e.InvalidFilterTypeMessage="Not supported filter type - can't serialize to json syntax.",e.SemanticFilterInvalidCondition="Filter with invalid condition - can't serialize to json syntax.",e.FilterNotFoundMessage="Invoked filter serialization function with no filter.",e.FieldNotFoundMessage="Invoked filter serialization function on a table that has no column/measure/hierarchy.",e.BasicFilterOperatorNotFoundMessage="Basic filter requires an operator (In | Not).",e.FilterValuesNotFound=" Could not retrieve filter values.",e.InvalidReportDataMessage="Could not find the report.",e.InvalidPageDataMessage="Could not find the active page.",e.DataPointSerializationError="Could not serialize a data point."})(t=e.ErrorMessages||(e.ErrorMessages={}))})(r=e.constants||(e.constants={}))})(r=e.jsonFilter||(e.jsonFilter={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){function o(e){return new u(e)}var i=t.constants,a=e.data.SemanticFilter,n=e.data.SQExprBuilder,s=jsCommon.Trace,l=jsCommon.Utility;t.createJSONFilterParser=o;var u=(function(){function o(e){this.promiseFactory=e,this.PowerBIModels=window["powerbi-models"],this.fieldVisitor=new t.JsonFilterBuilder.SemanticFilterFieldVisitor}return o.prototype.tryCreateFilterContainer=function(e,r,t){try{return this.constructFilterContainer(e,r,t)}catch(e){return c.traceError(e),null}},o.prototype.tryGetFilters=function(e,r){var o=[];if(!e.filters||0===e.filters.length)return this.promiseFactory.resolve(o);try{o=e.filters.map((function(e){return t.JsonFilterBuilder.fromSemanticFilter(e,r,e.filter)}))}catch(e){return c.traceError(e),void 0!==e.message?this.promiseFactory.reject({message:e.message}):this.promiseFactory.reject({message:i.ErrorMessages.FilterSerializationError})}return this.promiseFactory.resolve(o)},o.prototype.tryGetSelectedDataPoints=function(e,r,t){var o=this,a=t.visualContainer;if(!a||!a.config||!a.config.singleVisual)return this.promiseFactory.reject({message:i.ErrorMessages.DataPointSerializationError});if(_.isEmpty(t.dataPointsDescriptions))return this.promiseFactory.resolve(null);var n,s=a.config.singleVisual,l=this.promiseFactory.defer();return this.tryGetFilters(t.visualContainer,r).then((function(a){try{n={report:o.getReportInfo(e),page:o.getActivePageInfo(e),visual:o.getVisualInfo(t.visualTitleText,s.visualType),dataPoints:o.getDataPoints(t.dataPointsDescriptions,r),regions:null,filters:a},l.resolve(n)}catch(e){c.traceError(e),void 0!==e.message?l.reject({message:e.message}):l.reject({message:i.ErrorMessages.DataPointSerializationError})}})).catch((function(e){l.reject(e)})),l.promise},o.prototype.getValues=function(e,r){var t=this,o=[];return e?_.map(e,(function(e){return{target:t.getSelectedValueTarget(e.expr,r),value:e.value,formattedValue:e.formattedValue}})):o},o.prototype.getSelectedValueTarget=function(r,t){var o=e.data.SQExprConverter.asFieldPattern(r,t);if(!o)return null;var i;if(o.columnAggr||o.groupingColumnAggr){var a=o.columnAggr||o.groupingColumnAggr;i={table:a.entity,column:a.name,aggregationFunction:e.data.aggregateFunctionName(a.aggregate)}}else if(o.hierarchyLevelAggr){var n=o.hierarchyLevelAggr;i={table:n.entity,hierarchy:n.name,hierarchyLevel:n.level,aggregationFunction:e.data.aggregateFunctionName(n.aggregate)}}else if(o.measure){var s=o.measure;i={table:s.entity,measure:s.name}}else if(o.column){var l=o.column;i={table:l.entity,column:l.name}}return i},o.prototype.getDataPoints=function(r,t){for(var o=[],i=0,a=r;i<a.length;i++){for(var n=a[i],s={identity:[],values:this.getValues(n.values,t)},l=n.selector.data,u=0,c=l;u<c.length;u++){var d=c[u];if(d.expr){var p=d,v=e.data.SQExprConverter.getAllComparands(p);if(!v)return o;for(var g=0,F=v;g<F.length;g++){var f=F[g],h=f.expr.accept(this.fieldVisitor);s.identity.push({target:h,equals:f.value})}}}o.push(s)}return o},o.prototype.getReportInfo=function(e){return e&&null!=e.activeSectionIndex||l.throwException(c.invalidReportData()),{id:e.report.objectId,displayName:e.report.displayName}},o.prototype.getActivePageInfo=function(e){e&&null!=e.activeSectionIndex||l.throwException(c.invalidPageData());var r=e.sections[e.activeSectionIndex];return{name:r.name,displayName:r.displayName}},o.prototype.getVisualInfo=function(e,r){return{name:null,title:e,type:r}},o.prototype.constructFilterContainer=function(e,r,t){var o,i=this.validateFilter(t);if(i)l.throwException(c.filterValidationErrors(i));else{var a=this.PowerBIModels.getFilterType(t);a===this.PowerBIModels.FilterType.Basic?o=this.buildBasicFilterContainer(e,t):a===this.PowerBIModels.FilterType.Advanced&&(o=this.buildAdvancedFilterContainer(e,r,t))}return o},o.prototype.buildBasicFilterContainer=function(t,o){var s,u=this.getFieldExpr(o.target);u||l.throwException(c.fieldNotFound(o.target));var d=void 0;if(o.operator!==i.SelectAll){for(var p=this.getFieldExprsForKeys(o.target),v=[],g=0,F=0,f=o.values;F<f.length;F++){var h=f[F],m=[],y=o.keyValues;if(p&&y)for(var E=0,C=y[g];E<C.length;E++){var x=C[E];m.push(this.buildSQConstantExpr(x))}else m.push(this.buildSQConstantExpr(h));v.push(m),g++}var I=n.inValues(p||[u],v),N=void 0;N=o.operator===i.NotIn?n.not(I):I,d=a.fromSQExpr(N)}return s={name:r.FilterUtils.getNextFilterName(t.filters),expression:u,filter:d,type:e.explore.contracts.FilterType.Categorical}},o.prototype.buildAdvancedFilterContainer=function(t,o,n){var s,u=this.getFieldExpr(n.target);u||l.throwException(c.fieldNotFound(n.target));for(var d=[],p=0;p<n.conditions.length;p++){var v=this.getCondition(n.conditions[p]);v&&d.push(v)}var g=u.getMetadata(o),F=g?g.type:null,f=i.logicalOperatorDictionary[n.logicalOperator],h=r.viewModels.FilterCardConverter.toSQExpr(u,F,d,f);return h&&(s={name:r.FilterUtils.getNextFilterName(t.filters),expression:u,filter:a.fromSQExpr(h),type:e.explore.contracts.FilterType.Advanced}),s},o.prototype.getCondition=function(e){e||l.throwException(c.filterConditionNotFound());var t,o=i.operatorDictionary[e.operator];return t=_.isString(e.value)&&jsCommon.DateExtensions.parseIsoDateFast(e.value.substr(0,26))?jsCommon.DateExtensions.parseIsoDateFast(e.value.substr(0,26)):e.value,new r.viewModels.Condition(o,t)},o.prototype.getFieldExprsForKeys=function(e){var r=this;if(!e||!e.keys)return null;var t=_.map(e.keys,(function(t){return r.getFieldExpr(e,t)}));return t},o.prototype.getFieldExpr=function(e,r){var t;if(r)return n.fieldExpr({column:{schema:void 0,entity:e.table,name:r}});if(this.PowerBIModels.isMeasure(e)){var o=e;t=n.measureRef(n.entity(void 0,o.table),o.measure)}else if(this.PowerBIModels.isHierarchy(e)){var i=e;t=n.hierarchyLevel(n.hierarchy(n.entity(void 0,i.table),i.hierarchy),i.hierarchyLevel)}else if(this.PowerBIModels.isColumn(e)){var a=e;t=n.fieldExpr({column:{schema:void 0,entity:a.table,name:a.column}})}return t},o.prototype.buildSQConstantExpr=function(r){var t;if(_.isString(r))if(null!=jsCommon.DateExtensions.parseIsoDateFast(r.substr(0,26))){var o=jsCommon.DateExtensions.parseIsoDateFast(r.substr(0,26));t=n.dateTime(o)}else t=n.text(r);else _.isBoolean(r)?t=n.boolean(r):_.isNumber(r)?t=e.Double.isInteger(r)?n.integer(r):n.double(r):l.throwException(c.invalidDataType(r));return t},o.prototype.validateFilter=function(e){var r=this.PowerBIModels.validateFilter(e);return r},o})(),c=(function(){function e(){}return e.traceError=function(e){s.error("Throwing exception: "+JSON.stringify(e),null==e.Stack)},e.fieldNotFound=function(e){var r=e?"Target table: "+e.table:"";return{name:i.ErrorCodes.FieldNotFound,message:i.ErrorMessages.InvalidTarget+r}},e.filterValidationErrors=function(e){var r=e.map((function(e){return e.message})).join(", ");return{name:i.ErrorCodes.FilterValidationErrors,message:i.ErrorMessages.InvalidFilterMessage+r}},e.invalidDataType=function(e){return{name:i.ErrorCodes.InvalidDataType,message:jsCommon.StringExtensions.format(i.ErrorMessages.InvalidDataTypeMessage,e)}},e.filterConditionNotFound=function(){return{name:i.ErrorCodes.FilterConditionNotFound,message:i.ErrorMessages.InvalidCondition}},e.basicFilterSerializationError=function(e){return{name:i.ErrorCodes.BasicFilterSerializationError,message:i.ErrorMessages.FilterSerializationError+e}},e.advancedFilterSerializationError=function(){return{name:i.ErrorCodes.AdvancedFilterSerializationError,message:i.ErrorMessages.FilterSerializationError}},e.invalidFilterType=function(){return{name:i.ErrorCodes.InvalidFilterType,message:i.ErrorMessages.InvalidFilterTypeMessage}},e.invalidFilterCondition=function(){return{name:i.ErrorCodes.InvalidFilterCondition,message:i.ErrorMessages.SemanticFilterInvalidCondition}},e.filterNotFound=function(){return{name:i.ErrorCodes.FilterNotFound,message:i.ErrorMessages.FilterNotFoundMessage}},e.fieldExpressionNotFound=function(){return{name:i.ErrorCodes.FieldNotFound,message:i.ErrorMessages.FieldNotFoundMessage}},e.basicFilterOperatorNotFound=function(){return{name:i.ErrorCodes.BasicFilterOperatorNotFound,message:i.ErrorMessages.BasicFilterOperatorNotFoundMessage}},e.invalidReportData=function(){return{name:i.ErrorCodes.InvalidReportData,message:i.ErrorMessages.InvalidReportDataMessage}},e.invalidPageData=function(){return{name:i.ErrorCodes.InvalidPageData,message:i.ErrorMessages.InvalidPageDataMessage}},e})();t.JsonFilterParserErrors=c})(t=r.jsonFilter||(r.jsonFilter={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o,i=jsCommon.Utility,a=e.explore.viewModels.FilterCardConverter,n=e.explore.jsonFilter.constants;!(function(o){function s(e,o,a){var s=e.expression;s||i.throwException(t.JsonFilterParserErrors.fieldExpressionNotFound());var p,v,g=new d;if(a){var F=void 0;F=a.conditions(),F&&!_.isEmpty(F)&&1===F.length||i.throwException(t.JsonFilterParserErrors.invalidFilterCondition());var f=F[0];v=c.getAdvancedFilterExpression(f)}var h=e.type;if(null==h&&(h=r.FilterUtils.getDefaultFilterType(s,o,v?v.field:null)),v&&h===r.contracts.FilterType.Advanced){var m=v.field.accept(g),y=c.getAdvancedFilterLogicalOperator(v.logicalOperator),E=v.conditions.map((function(e){return c.getAdvancedFilterCondition(e)})),C=new l.AdvancedFilter(m,y,E);C||i.throwException(t.JsonFilterParserErrors.advancedFilterSerializationError()),p=C.toJSON()}else{var m=u.getTarget(s,g,o),x=a?u.getOperator(o,a,s):n.SelectAll,I=u.getValuesFromSQExpr(e,o,a),N=void 0;N=I.keyValues&&I.keyValues.length>0?new l.BasicFilterWithKeys(m,x,I.displayedValues,I.keyValues):new l.BasicFilter(m,x,I.displayedValues),N||i.throwException(t.JsonFilterParserErrors.basicFilterSerializationError()),p=N.toJSON()}return p}var l=window["powerbi-models"];o.fromSemanticFilter=s;var u;!(function(r){function o(r,o,a){var s={displayedValues:[],keyValues:[]};if(!a)return s;var l,p=r.expression,v=u(o,a,p);v&&(l=v.scopeIds),_.isEmpty(l)&&i.throwException(t.JsonFilterParserErrors.basicFilterSerializationError(n.ErrorMessages.FilterValuesNotFound));for(var g=0,F=l;g<F.length;g++){var f=F[g];if(p.hasGroupOnKeys(o)){var h=e.data.SQExprConverter.getAllComparands(f),m=h.map((function(e){return c(e.value)}));s.keyValues.push(m);var y=r.cachedValueItems;_.isEmpty(y)||y.length!==l.length?i.throwException(t.JsonFilterParserErrors.basicFilterSerializationError(n.ErrorMessages.FilterValuesNotFound)):s.displayedValues=y.map((function(e){return d(e)}))}else{var E=e.data.SQExprConverter.getFirstComparandValue(f);s.displayedValues.push(c(E))}}return s}function a(e,r,o){var a=u(e,r,o);return a?a.isNot?"NotIn":"In":void i.throwException(t.JsonFilterParserErrors.basicFilterOperatorNotFound())}function s(e,r,t){var o=e.accept(r);return e.hasGroupOnKeys(t)&&(o.keys=l(e,r,t)),o}function l(e,r,t){var o=e.getKeyColumns(t),i=[];return o&&(i=o.map((function(e){return e.accept(r).column}))),i}function u(r,o,a){var n=a.getKeyColumns(r);return n||i.throwException(t.JsonFilterParserErrors.fieldExpressionNotFound()),e.data.SQExprConverter.asScopeIdsContainer(o,n)}function c(e){return _.isDate(e)?e.toISOString():e}function d(e){var r=e;return null===e?null:"string"==typeof e?e:r&&r.displayName?r.displayName:void i.throwException(t.JsonFilterParserErrors.invalidDataType("Unrecognized type of value: "+e))}r.getValuesFromSQExpr=o,r.getOperator=a,r.getTarget=s})(u||(u={}));var c;!(function(e){function o(e){return a.createAdvFilter(e)}function n(e){switch(e){case 0:return"And";case 1:return"Or";case 2:return"And"}}function s(e){!r.viewModels.OperatorHelper.getValueRequired(e.operator)||e.value&&e.value.hasValue||i.throwException(t.JsonFilterParserErrors.filterConditionNotFound());var o;9===e.operator?o="Is":10===e.operator?o="IsNot":3===e.operator?o="GreaterThan":4===e.operator?o="GreaterThanOrEqual":1===e.operator?o="LessThan":2===e.operator?o="LessThanOrEqual":5===e.operator?o="Contains":6===e.operator?o="DoesNotContain":7===e.operator?o="StartsWith":8===e.operator?o="DoesNotStartWith":11===e.operator?o="IsBlank":12===e.operator?o="IsNotBlank":i.throwException(t.JsonFilterParserErrors.filterConditionNotFound());var a=e.value;return{operator:o,value:e.value.isDate?a.value.toISOString():a.value}}e.getAdvancedFilterExpression=o,e.getAdvancedFilterLogicalOperator=n,e.getAdvancedFilterCondition=s})(c||(c={}));var d=(function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return __extends(r,e),r.prototype.visitEntity=function(e){return{table:e.entity,column:null}},r.prototype.visitHierarchy=function(e){var r=e.arg.accept(this);return r?{table:r.table,hierarchy:e.hierarchy,hierarchyLevel:null}:null},r.prototype.visitColumnRef=function(e){var r=e.source.accept(this);return r?{table:r.table,column:e.ref}:null},r.prototype.visitMeasureRef=function(e){var r=e.source.accept(this);return r?{table:r.table,measure:e.ref}:null},r.prototype.visitHierarchyLevel=function(e){var r=e.arg.accept(this);return r?{table:r.table,hierarchy:r.hierarchy,hierarchyLevel:e.level}:null},r})(e.data.DefaultSQExprVisitor);o.SemanticFilterFieldVisitor=d})(o=t.JsonFilterBuilder||(t.JsonFilterBuilder={}))})(t=r.jsonFilter||(r.jsonFilter={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={})),define("JSONFilter/services/jsonFilterParserMin",["require","exports"],(function(e,r){"use strict";function t(e){return new a(e)}var o=powerbi,i=o.explore;r.create=t;var a=(function(){function e(e){this.parser=i.jsonFilter.createJSONFilterParser(e)}return e.prototype.tryCreateSemanticFilter=function(e,r,t){var o=[{name:e}],i=this.parser.tryCreateFilterContainer(o,r,t);if(i)return i.filter},e})()}));;
window.parseTimeMarkers = window.parseTimeMarkers || {};
window.parseTimeMarkers['reportEmbed.externals.min.js'] = {
    nominalStart: Date.now(),
    start: Date.now()
};
/*! powerbi-models v0.11.2 | (c) 2016 Microsoft Corporation MIT */
!(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define('powerbi-models',[],t):"object"==typeof exports?exports["powerbi-models"]=t():e["powerbi-models"]=t()})(this,(function(){return (function(e){function t(s){if(r[s])return r[s].exports;var i=r[s]={exports:{},id:s,loaded:!1};return e[s].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)})([function(e,t,r){function s(e){var t=e.message;return t||(t=e.path+" is invalid. Not meeting "+e.keyword+" constraint"),{message:t}}function i(e,t){return function(r){var i=p(e,t),n=i(r);return n?void 0:i.errors.map(s)}}function n(e){return h(e)&&!!e.keys}function o(e){return a(e)===l.Basic&&!!e.keyValues}function a(e){var t=e,r=e;return"string"==typeof t.operator&&Array.isArray(t.values)?l.Basic:"string"==typeof r.logicalOperator&&Array.isArray(r.conditions)?l.Advanced:l.Unknown}function c(e){return void 0!==e.table&&void 0!==e.measure}function h(e){return void 0!==e.table&&void 0!==e.column}function u(e){return void 0!==e.table&&void 0!==e.hierarchy&&void 0!==e.hierarchyLevel}var f=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(t,r){function s(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}})();Object.defineProperty(t,"__esModule",{value:!0}),t.advancedFilterSchema=r(1),t.filterSchema=r(2),t.loadSchema=r(3),t.dashboardLoadSchema=r(4),t.pageSchema=r(5),t.settingsSchema=r(6),t.basicFilterSchema=r(7),t.createReportSchema=r(8),t.saveAsParametersSchema=r(9);var p=r(10);t.validateSettings=i(t.settingsSchema,{schemas:{basicFilter:t.basicFilterSchema,advancedFilter:t.advancedFilterSchema}}),t.validateReportLoad=i(t.loadSchema,{schemas:{settings:t.settingsSchema,basicFilter:t.basicFilterSchema,advancedFilter:t.advancedFilterSchema}}),t.validateCreateReport=i(t.createReportSchema),t.validateDashboardLoad=i(t.dashboardLoadSchema),t.validatePage=i(t.pageSchema),t.validateFilter=i(t.filterSchema,{schemas:{basicFilter:t.basicFilterSchema,advancedFilter:t.advancedFilterSchema}});var l;!(function(e){e[e.Advanced=0]="Advanced",e[e.Basic=1]="Basic",e[e.Unknown=2]="Unknown"})(l=t.FilterType||(t.FilterType={})),t.isFilterKeyColumnsTarget=n,t.isBasicFilterWithKeys=o,t.getFilterType=a,t.isMeasure=c,t.isColumn=h,t.isHierarchy=u;var d=(function(){function e(e){this.target=e}return e.prototype.toJSON=function(){return{$schema:this.schemaUrl,target:this.target}},e})();t.Filter=d;var m=(function(e){function t(r,s){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=e.call(this,r)||this;if(o.operator=s,o.schemaUrl=t.schemaUrl,0===i.length&&"All"!==s)throw new Error('values must be a non-empty array unless your operator is "All".');return Array.isArray(i[0])?o.values=i[0]:o.values=i,o}return f(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.operator=this.operator,t.values=this.values,t},t})(d);m.schemaUrl="http://powerbi.com/product/schema#basic",t.BasicFilter=m;var y=(function(e){function t(t,r,s,i){var n=e.call(this,t,r,s)||this;n.keyValues=i,n.target=t;var o=t.keys?t.keys.length:0;if(o>0&&!i)throw new Error("You shold pass the values to be filtered for each key. You passed: no values and "+o+" keys");if(0===o&&i&&i.length>0)throw new Error("You passed key values but your target object doesn't contain the keys to be filtered");for(var a=0;a<n.keyValues.length;a++)if(n.keyValues[a]){var c=n.keyValues[a].length;if(c!==o)throw new Error("Each tuple of key values should contain a value for each of the keys. You passed: "+c+" values and "+o+" keys")}return n}return f(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.keyValues=this.keyValues,t},t})(m);t.BasicFilterWithKeys=y;var g=(function(e){function t(r,s){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];var o=e.call(this,r)||this;if(o.schemaUrl=t.schemaUrl,"string"!=typeof s||0===s.length)throw new Error("logicalOperator must be a valid operator, You passed: "+s);o.logicalOperator=s;var a;if(a=Array.isArray(i[0])?i[0]:i,0===a.length)throw new Error("conditions must be a non-empty array. You passed: "+i);if(a.length>2)throw new Error("AdvancedFilters may not have more than two conditions. You passed: "+i.length);if(1===a.length&&"And"!==s)throw new Error('Logical Operator must be "And" when there is only one condition provided');return o.conditions=a,o}return f(t,e),t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.logicalOperator=this.logicalOperator,t.conditions=this.conditions,t},t})(d);g.schemaUrl="http://powerbi.com/product/schema#advanced",t.AdvancedFilter=g;var v;!(function(e){e[e.Read=0]="Read",e[e.ReadWrite=1]="ReadWrite",e[e.Copy=2]="Copy",e[e.Create=4]="Create",e[e.All=7]="All"})(v=t.Permissions||(t.Permissions={}));var b;!(function(e){e[e.View=0]="View",e[e.Edit=1]="Edit"})(b=t.ViewMode||(t.ViewMode={}));var j;!(function(e){e[e.Aad=0]="Aad",e[e.Embed=1]="Embed"})(j=t.TokenType||(t.TokenType={})),t.validateSaveAsParameters=i(t.saveAsParametersSchema)},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{target:{oneOf:[{type:"object",properties:{table:{type:"string"},column:{type:"string"}},required:["table","column"]},{type:"object",properties:{table:{type:"string"},hierarchy:{type:"string"},hierarchyLevel:{type:"string"}},required:["table","hierarchy","hierarchyLevel"]},{type:"object",properties:{table:{type:"string"},measure:{type:"string"}},required:["table","measure"]}]},logicalOperator:{type:"string"},conditions:{type:"array",items:{type:"object",properties:{value:{type:["string","boolean","number"]},operator:{type:"string"}},required:["value","operator"]}}},required:["target","logicalOperator","conditions"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",oneOf:[{$ref:"#basicFilter"},{$ref:"#advancedFilter"}],invalidMessage:"filter is invalid"}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{accessToken:{type:"string",messages:{type:"accessToken must be a string",required:"accessToken is required"}},id:{type:"string",messages:{type:"id must be a string",required:"id is required"}},settings:{$ref:"#settings"},pageName:{type:"string",messages:{type:"pageName must be a string"}},filters:{type:"array",items:{type:"object",oneOf:[{$ref:"#basicFilter"},{$ref:"#advancedFilter"}]},invalidMessage:"filters property is invalid"},permissions:{type:"number","enum":[0,1,2,4,7],"default":0,invalidMessage:"permissions property is invalid"},viewMode:{type:"number","enum":[0,1],"default":0,invalidMessage:"viewMode property is invalid"},tokenType:{type:"number","enum":[0,1],"default":0,invalidMessage:"tokenType property is invalid"}},required:["accessToken","id"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{accessToken:{type:"string",messages:{type:"accessToken must be a string",required:"accessToken is required"}},id:{type:"string",messages:{type:"id must be a string",required:"id is required"}},pageView:{type:"string",messages:{type:'pageView must be a string with one of the following values: "actualSize", "fitToWidth", "oneColumn"'}},tokenType:{type:"number","enum":[0,1],"default":0,invalidMessage:"tokenType property is invalid"}},required:["accessToken","id"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{name:{type:"string",messages:{type:"name must be a string",required:"name is required"}}},required:["name"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{filterPaneEnabled:{type:"boolean",messages:{type:"filterPaneEnabled must be a boolean"}},navContentPaneEnabled:{type:"boolean",messages:{type:"navContentPaneEnabled must be a boolean"}},useCustomSaveAsDialog:{type:"boolean",messages:{type:"useCustomSaveAsDialog must be a boolean"}}}}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{target:{type:"object",properties:{table:{type:"string"},column:{type:"string"},hierarchy:{type:"string"},hierarchyLevel:{type:"string"},measure:{type:"string"}},required:["table"]},operator:{type:"string"},values:{type:"array",items:{type:["string","boolean","number"]}}},required:["target","operator","values"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{accessToken:{type:"string",messages:{type:"accessToken must be a string",required:"accessToken is required"}},datasetId:{type:"string",messages:{type:"datasetId must be a string",required:"datasetId is required"}},tokenType:{type:"number","enum":[0,1],"default":0,invalidMessage:"tokenType property is invalid"}},required:["accessToken","datasetId"]}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-04/schema#",type:"object",properties:{name:{type:"string",messages:{type:"name must be a string",required:"name is required"}}},required:["name"]}},function(e,t,r){e.exports=r(11)},function(e,t,r){"use strict";function s(e){return e=e instanceof RegExp?e:new RegExp(e),O?e.toString():"/"+e.source.replace(g,"\\$&")+"/"}function i(e){return'"'+e.replace(v,"\\$1")+'"'}function n(e,t){return b.lastIndex=0,b.test(t)?e+"."+t:e+"["+i(t)+"]"}function o(e){if(void 0===e)return"undefined";var t=Object.prototype.toString.call(e);return t.substr(8,t.length-9).toLowerCase()}function a(e){return(0|e)===e}function c(e,t){C[t].type=e,C[t].keyword=t}function h(e){var t,r,s,i=Object.keys(e),n=i.indexOf("properties"),o=i.indexOf("patternProperties"),a={"enum":Array.isArray(e["enum"])&&e["enum"].length>0,type:null,allType:[],perType:{}};for(e.type&&("string"==typeof e.type?a.type=[e.type]:Array.isArray(e.type)&&e.type.length&&(a.type=e.type.slice(0))),s=0;s<i.length;s++)t=i[s],"enum"!==t&&"type"!==t&&(r=C[t],r&&(r.type?(a.perType[r.type]||(a.perType[r.type]=[]),n>-1&&"required"===t||o>-1&&"additionalProperties"===t||a.perType[r.type].push(t)):a.allType.push(t)));return a}function u(e,t){var r,s,i=e.substr(4),n=i.length,o=[],a="",c=!1;for(s=0;s<n;s++)switch(r=i[s]){case".":a&&(a+=r);break;case"[":isNaN(+i[s+1])?(c=!0,a&&(o.push('"'+a+'"'),a="")):(c=!1,a&&(a+="."));break;case"]":o.push(c?a:'"'+a+'"'),a="";break;default:a+=r}return a&&o.push('"'+a+'"'),t&&o.push('"'+t+'"'),1===o.length&&c?'"" + '+o[0]+' + ""':o.join(' + "." + ')||'""'}function f(e){var t,r,s,i,n=e,a=o(e);if("object"===a)for(n={},t=Object.keys(e),i=0,r=t.length;i<r;i++)s=t[i],n[s]=f(e[s]);else if("array"===a)for(n=[],i=0,r=e.length;i<r;i++)n[i]=f(e[i]);else{if("regexp"===a)return new RegExp(e);if("date"===a)return new Date(e.toJSON())}return n}function p(e,t){for(var r=0,s=t.length;r<s;r++)if(w(e,t[r]))return!0;return!1}function l(){this.objects=[],this.properties=[]}function d(e,t,r,s,i){var n,a,c,h,u,p,m;if("object"!==o(e))return t;if(e=s.resolve(e),void 0===t&&e.hasOwnProperty("default")&&(t=f(e["default"])),n=o(t),"object"===n&&"object"===o(e.properties)){for(p=Object.keys(e.properties),h=0;h<p.length;h++)c=p[h],a=d(e.properties[c],t[c],r,s),void 0!==a&&(t[c]=a);if("always"!==r)for(m=Object.keys(t),h=0;h<m.length;h++)c=m[h],p.indexOf(c)<0&&(e.additionalProperties===!1||r===!1&&!e.additionalProperties)&&(i?i.mark(t,c):delete t[c])}else if("array"===n&&e.items){if("array"===o(e.items))for(h=0;h<e.items.length;h++)a=d(e.items[h],t[h],r,s),(void 0!==a||h<t.length)&&(t[h]=a);else if(t.length)for(h=0;h<t.length;h++)t[h]=d(e.items,t[h],r,s)}else if("array"===o(e.allOf)&&e.allOf.length){for(u=new l,h=0;h<e.allOf.length;h++)t=d(e.allOf[h],t,r,s,u);u.deleteDuplicates(),u.dispose()}return t}function m(e){this.path="data",this.schema=e.schema,this.formats=e.formats,this.greedy=e.greedy,this.resolver=e.resolver,this.id=e.id,this.funcache=e.funcache||{},this.scope=e.scope||{equalAny:p,unique:k,ucs2length:S,refs:{}}}function y(e,t){if("object"!==o(e))throw new Error(j);t=t||{};var r=0,s=function(){return"i"+r++},i=new q(e,t.schemas,t.missing$Ref||!1),n=new m({schema:e,resolver:i,id:s,schemas:t.schemas,formats:t.formats,greedy:t.greedy||!1}),a=A("validate","data")("validate.errors = []")('gen(data, "", validate.errors)')("return validate.errors.length === 0").compile({gen:n.compile()});return n.dispose(),n=null,a.errors=[],a.build=function(t,r){return d(e,r&&r.copy===!1?t:f(t),r&&r.additionalProperties,i)},a}var g=/[\/]/g,v=/(")/gim,b=/^[a-z_$][0-9a-z]*$/gi,j="jsen: invalid schema object",x="object"==typeof window&&!!window.navigator,O="/"!==new RegExp("/").source,A=r(12),w=r(13),k=r(14),q=r(15),I=r(24),S=r(25),$={},C={};$["null"]=function(e){return e+" === null"},$["boolean"]=function(e){return"typeof "+e+' === "boolean"'},$.string=function(e){return"typeof "+e+' === "string"'},$.number=function(e){return"typeof "+e+' === "number"'},$.integer=function(e){return"typeof "+e+' === "number" && !('+e+" % 1)"},$.array=function(e){return"Array.isArray("+e+")"},$.object=function(e){return"typeof "+e+' === "object" && '+e+" !== null && !Array.isArray("+e+")"},$.date=function(e){return e+" instanceof Date"},C["enum"]=function(e){var t=e.schema["enum"];e.code("if (!equalAny("+e.path+", "+JSON.stringify(t)+")) {"),e.error("enum"),e.code("}")},C.minimum=function(e){"number"==typeof e.schema.minimum&&(e.code("if ("+e.path+" < "+e.schema.minimum+") {"),e.error("minimum"),e.code("}"))},C.exclusiveMinimum=function(e){e.schema.exclusiveMinimum===!0&&"number"==typeof e.schema.minimum&&(e.code("if ("+e.path+" === "+e.schema.minimum+") {"),e.error("exclusiveMinimum"),e.code("}"))},C.maximum=function(e){"number"==typeof e.schema.maximum&&(e.code("if ("+e.path+" > "+e.schema.maximum+") {"),e.error("maximum"),e.code("}"))},C.exclusiveMaximum=function(e){e.schema.exclusiveMaximum===!0&&"number"==typeof e.schema.maximum&&(e.code("if ("+e.path+" === "+e.schema.maximum+") {"),e.error("exclusiveMaximum"),e.code("}"))},C.multipleOf=function(e){if("number"==typeof e.schema.multipleOf){var t=e.schema.multipleOf,r=t.toString().length-t.toFixed(0).length-1,s=r>0?Math.pow(10,r):1,i=e.path;r>0?e.code("if (+(Math.round(("+i+" * "+s+') + "e+" + '+r+') + "e-" + '+r+") % "+t*s+" !== 0) {"):e.code("if ((("+i+" * "+s+") % "+t*s+") !== 0) {"),e.error("multipleOf"),e.code("}")}},C.minLength=function(e){a(e.schema.minLength)&&(e.code("if (ucs2length("+e.path+") < "+e.schema.minLength+") {"),e.error("minLength"),e.code("}"))},C.maxLength=function(e){a(e.schema.maxLength)&&(e.code("if (ucs2length("+e.path+") > "+e.schema.maxLength+") {"),e.error("maxLength"),e.code("}"))},C.pattern=function(e){var t=e.schema.pattern;("string"==typeof t||t instanceof RegExp)&&(e.code("if (!("+s(t)+").test("+e.path+")) {"),e.error("pattern"),e.code("}"))},C.format=function(e){"string"==typeof e.schema.format&&I[e.schema.format]&&(e.code("if (!("+I[e.schema.format]+").test("+e.path+")) {"),e.error("format"),e.code("}"))},C.minItems=function(e){a(e.schema.minItems)&&(e.code("if ("+e.path+".length < "+e.schema.minItems+") {"),e.error("minItems"),e.code("}"))},C.maxItems=function(e){a(e.schema.maxItems)&&(e.code("if ("+e.path+".length > "+e.schema.maxItems+") {"),e.error("maxItems"),e.code("}"))},C.additionalItems=function(e){e.schema.additionalItems===!1&&Array.isArray(e.schema.items)&&(e.code("if ("+e.path+".length > "+e.schema.items.length+") {"),e.error("additionalItems"),e.code("}"))},C.uniqueItems=function(e){e.schema.uniqueItems&&(e.code("if (unique("+e.path+").length !== "+e.path+".length) {"),e.error("uniqueItems"),e.code("}"))},C.items=function(e){var t=e.declare(0),r=0;if("object"===o(e.schema.items))e.code("for ("+t+" = 0; "+t+" < "+e.path+".length; "+t+"++) {"),e.descend(e.path+"["+t+"]",e.schema.items),e.code("}");else if(Array.isArray(e.schema.items)){for(;r<e.schema.items.length;r++)e.code("if ("+e.path+".length - 1 >= "+r+") {"),e.descend(e.path+"["+r+"]",e.schema.items[r]),e.code("}");"object"===o(e.schema.additionalItems)&&(e.code("for ("+t+" = "+r+"; "+t+" < "+e.path+".length; "+t+"++) {"),e.descend(e.path+"["+t+"]",e.schema.additionalItems),e.code("}"))}},C.maxProperties=function(e){a(e.schema.maxProperties)&&(e.code("if (Object.keys("+e.path+").length > "+e.schema.maxProperties+") {"),e.error("maxProperties"),e.code("}"))},C.minProperties=function(e){a(e.schema.minProperties)&&(e.code("if (Object.keys("+e.path+").length < "+e.schema.minProperties+") {"),e.error("minProperties"),e.code("}"))},C.required=function(e){if(Array.isArray(e.schema.required))for(var t=0;t<e.schema.required.length;t++)e.code("if ("+n(e.path,e.schema.required[t])+" === undefined) {"),e.error("required",e.schema.required[t]),e.code("}")},C.properties=function(e){var t,r,s,i=e.schema.properties,a="object"===o(i)?Object.keys(i):[],c=Array.isArray(e.schema.required)?e.schema.required:[];if(a.length)for(r=0;r<a.length;r++)t=a[r],s=n(e.path,t),e.code("if ("+s+" !== undefined) {"),e.descend(s,i[t]),e.code("}"),c.indexOf(t)>-1&&(e.code("else {"),e.error("required",t),e.code("}"))},C.patternProperties=C.additionalProperties=function(e){var t,r,i,n,a,c,h,u="object"===o(e.schema.properties)?Object.keys(e.schema.properties):[],f=e.schema.patternProperties,p="object"===o(f)?Object.keys(f):[],l=e.schema.additionalProperties,d=l===!1||"object"===o(l);if(p.length||d){for(r=e.declare("[]"),i=e.declare('""'),n=e.declare(0),d&&(a=e.declare(!1)),e.code(r+" = Object.keys("+e.path+")"),e.code("for ("+n+" = 0; "+n+" < "+r+".length; "+n+"++) {")(i+" = "+r+"["+n+"]")("if ("+e.path+"["+i+"] === undefined) {")("continue")("}"),d&&e.code(a+" = false"),h=0;h<p.length;h++)c=p[h],e.code("if (("+s(c)+").test("+i+")) {"),e.descend(e.path+"["+i+"]",f[c]),d&&e.code(a+" = true"),e.code("}");d&&(u.length&&(t=e.declare(JSON.stringify(u)),e.code("if ("+t+".indexOf("+i+") > -1) {")("continue")("}")),e.code("if (!"+a+") {"),l===!1?e.error("additionalProperties",void 0,i):e.descend(e.path+"["+i+"]",l),e.code("}")),e.code("}")}},C.dependencies=function(e){if("object"===o(e.schema.dependencies))for(var t,r,s=Object.keys(e.schema.dependencies),i=s.length,a=0,c=0;c<i;c++){if(t=s[c],r=e.schema.dependencies[t],e.code("if ("+n(e.path,t)+" !== undefined) {"),"object"===o(r))e.descend(e.path,r);else for(a;a<r.length;a++)e.code("if ("+n(e.path,r[a])+" === undefined) {"),e.error("dependencies",r[a]),e.code("}");e.code("}")}},C.allOf=function(e){if(Array.isArray(e.schema.allOf))for(var t=0;t<e.schema.allOf.length;t++)e.descend(e.path,e.schema.allOf[t])},C.anyOf=function(e){if(Array.isArray(e.schema.anyOf)){var t=e.greedy,r=e.declare(0),s=e.declare(0),i=e.declare(!1),n=0;for(e.code(s+" = errors.length");n<e.schema.anyOf.length;n++)e.code("if (!"+i+") {"),e.code(r+" = errors.length"),e.greedy=!0,e.descend(e.path,e.schema.anyOf[n]),e.code(i+" = errors.length === "+r)("}");e.greedy=t,e.code("if (!"+i+") {"),e.error("anyOf"),e.code("} else {")("errors.length = "+s)("}")}},C.oneOf=function(e){if(Array.isArray(e.schema.oneOf)){var t=e.greedy,r=e.declare(0),s=e.declare(0),i=e.declare(0),n=0;for(e.code(s+" = errors.length"),e.code(r+" = 0");n<e.schema.oneOf.length;n++)e.code(i+" = errors.length"),e.greedy=!0,e.descend(e.path,e.schema.oneOf[n]),e.code("if (errors.length === "+i+") {")(r+"++")("}");e.greedy=t,e.code("if ("+r+" !== 1) {"),e.error("oneOf"),e.code("} else {")("errors.length = "+s)("}")}},C.not=function(e){if("object"===o(e.schema.not)){var t=e.greedy,r=e.declare(0);e.code(r+" = errors.length"),e.greedy=!0,e.descend(e.path,e.schema.not),e.greedy=t,e.code("if (errors.length === "+r+") {"),e.error("not"),e.code("} else {")("errors.length = "+r)("}")}},["minimum","exclusiveMinimum","maximum","exclusiveMaximum","multipleOf"].forEach(c.bind(null,"number")),["minLength","maxLength","pattern","format"].forEach(c.bind(null,"string")),["minItems","maxItems","additionalItems","uniqueItems","items"].forEach(c.bind(null,"array")),["maxProperties","minProperties","required","properties","patternProperties","additionalProperties","dependencies"].forEach(c.bind(null,"object")),["enum","allOf","anyOf","oneOf","not"].forEach(c.bind(null,null)),l.prototype.mark=function(e,t){var r,s=this.objects.indexOf(e);return s<0?(this.objects.push(e),r={},r[t]=1,void this.properties.push(r)):(r=this.properties[s],void(r[t]=r[t]?r[t]+1:1))},l.prototype.deleteDuplicates=function(){var e,t,r,s,i;for(s=0;s<this.properties.length;s++)for(e=this.properties[s],t=Object.keys(e),i=0;i<t.length;i++)r=t[i],e[r]>1&&delete this.objects[s][r]},l.prototype.dispose=function(){this.objects.length=0,this.properties.length=0},m.prototype.clone=function(e){var t=new m({schema:e,formats:this.formats,greedy:this.greedy,resolver:this.resolver,id:this.id,funcache:this.funcache,scope:this.scope});return t},m.prototype.declare=function(e){var t=this.id();return this.code.def(t,e),t},m.prototype.cache=function(e,t){var r,s=this.funcache[e];return s||(s=this.funcache[e]={key:this.id()},r=this.clone(t),s.func=r.compile(s.key),this.scope.refs[s.key]=s.func,r.dispose()),"refs."+s.key},m.prototype.error=function(e,t,r){var s=this.schema,n=this.path,o="data"!==n||t?'(path ? path + "." : "") + '+u(n,t)+",":"path,",a=t&&s.properties&&s.properties[t]?this.resolver.resolve(s.properties[t]):null,c=a?a.requiredMessage:s.invalidMessage;c||(c=a&&a.messages&&a.messages[e]||s.messages&&s.messages[e]),this.code("errors.push({"),c&&this.code("message: "+i(c)+","),r&&this.code("additionalProperties: "+r+","),this.code("path: "+o)("keyword: "+i(e))("})"),this.greedy||this.code("return")},m.prototype.refactor=function(e,t,r){var s="data"!==e?'(path ? path + "." : "") + '+u(e):"path",i=this.cache(r,t),n=this.declare();this.code(n+" = "+i+"("+e+", "+s+", errors)"),this.greedy||this.code("if (errors.length) { return }")},m.prototype.descend=function(e,t){var r=this.path,s=this.schema;this.path=e,this.schema=t,this.generate(),this.path=r,this.schema=s},m.prototype.generate=function(){function e(e){C[e](d)}var t,r,n,a,c,u,f,p=this.path,l=this.schema,d=this,m=this.scope;if("object"===o(l)){if(void 0!==l.$ref){if(l=this.resolver.resolve(l),this.resolver.hasRef(l))return void this.refactor(p,l,this.resolver.getNormalizedRef(this.schema)||this.schema.$ref);this.schema=l}if(n=h(l),n["enum"])return void C["enum"](d);for(a=Object.keys(n.perType),f=0;f<a.length;f++)u=a[f],this.code((f?"else ":"")+"if ("+$[u](p)+") {"),n.perType[u].forEach(e),this.code("}"),n.type&&(c=n.type.indexOf(u),c>-1&&n.type.splice(c,1));n.type&&(n.type.length?(this.code((a.length?"else ":"")+"if (!("+n.type.map((function(e){return $[e]?$[e](p):"true"})).join(" || ")+")) {"),this.error("type"),this.code("}")):(this.code("else {"),this.error("type"),this.code("}"))),n.allType.forEach((function(e){C[e](d)})),l.format&&this.formats&&(r=this.formats[l.format],r&&("string"==typeof r||r instanceof RegExp?(this.code("if (!("+s(r)+").test("+p+")) {"),this.error("format"),this.code("}")):"function"==typeof r&&((m.formats||(m.formats={}))[l.format]=r,(m.schemas||(m.schemas={}))[l.format]=l,t=i(l.format),this.code("if (!formats["+t+"]("+p+", schemas["+t+"])) {"),this.error("format"),this.code("}"))))}},m.prototype.compile=function(e){return this.code=A("jsen_compiled"+(e?"_"+e:""),"data","path","errors"),this.generate(),this.code.compile(this.scope)},m.prototype.dispose=function(){for(var e in this)this[e]=void 0},y.browser=x,y.clone=f,y.equal=w,y.unique=k,y.ucs2length=S,y.SchemaResolver=q,y.resolve=q.resolvePointer,e.exports=y},function(e,t){"use strict";e.exports=function(){var e=Array.apply(null,arguments),t=e.shift(),r="  ",s="",i="",n=1,o="{[",a="}]",c=function(){for(var e=r,t=0;t++<n-1;)e+=r;return e},h=function(e){s+=c()+e+"\n"},u=function(e){var t=e[0],r=e[e.length-1];return a.indexOf(t)>-1&&o.indexOf(r)>-1?(n--,h(e),n++):o.indexOf(r)>-1?(h(e),n++):a.indexOf(t)>-1?(n--,h(e)):h(e),u};return u.def=function(e,t){return i+=(i?",\n"+r+"    ":"")+e+(void 0!==t?" = "+t:""),u},u.toSource=function(){return"function "+t+"("+e.join(", ")+") {\n"+r+'"use strict"\n'+(i?r+"var "+i+";\n":"")+s+"}"},u.compile=function(e){var t="return ("+u.toSource()+")",r=e||{},s=Object.keys(r),i=s.map((function(e){return r[e]}));return Function.apply(null,s.concat(t)).apply(null,i)},u}},function(e,t){"use strict";function r(e){var t=Object.prototype.toString.call(e);return t.substr(8,t.length-9).toLowerCase()}function s(e,t){var r,s,n=Object.keys(e).sort(),o=Object.keys(t).sort();if(!i(n,o))return!1;for(r=0;r<n.length;r++)if(s=n[r],!i(e[s],t[s]))return!1;return!0}function i(e,t){var n,o=typeof e,a=typeof t;if("object"===o&&(o=r(e)),"object"===a&&(a=r(t)),o!==a)return!1;if("object"===o)return s(e,t);if("regexp"===o)return e.toString()===t.toString();if("array"===o){if(e.length!==t.length)return!1;for(n=0;n<e.length;n++)if(!i(e[n],t[n]))return!1;return!0}return e===t}e.exports=i},function(e,t,r){"use strict";function s(e,t,r){for(var s=0,i=e.length;s<i;s++)if(r(e[s],t))return s;return-1}var i=r(13);e.exports=function(e){return e.filter((function(e,t,r){return s(r,e,i)===t}))},e.exports.findIndex=s},function(e,t,r){"use strict";function s(e,t){if(!t.length)return e;var r,i=t.shift();e&&"object"==typeof e&&e.hasOwnProperty(i)&&(r=e[i]);{if(!t.length)return r;if(r&&"object"==typeof r)return s(r,t)}}function i(e){var t=e.indexOf("#"),r={base:e.substr(0,t),path:[]};return t<0?(r.base=e,r):(e=e.substr(t+1))?(r.path=e.split("/").map((function(e){return decodeURIComponent(e).replace(/~1/g,"/").replace(/~0/g,"~")})),"/"===e[0]&&r.path.shift(),r):r}function n(e,t,r,s){this.rootSchema=e,this.resolvers=null,this.resolvedRootSchema=null,this.cache={},this.idCache={},this.refCache={refs:[],schemas:[]},this.missing$Ref=r,this.refStack=[],s=s||"",this._buildIdCache(e,s),s=this.refCache.refs[this.refCache.schemas.indexOf(this.rootSchema)]||s,this._buildResolvers(t,s)}var o=r(16),a=r(23),c="jsen: invalid schema reference",h="jsen: duplicate schema id",u="jsen: circular schema reference";n.prototype._cacheId=function(e,t,r){if(this.idCache[e])throw new Error(h+" "+e);this.idCache[e]={resolver:r,schema:t}},n.prototype._buildIdCache=function(e,t){var r,s,i,n=t;if(e&&"object"==typeof e)for("string"==typeof e.id&&e.id?(n=o.resolve(t,e.id),this._cacheId(n,e,this)):e===this.rootSchema&&t&&this._cacheId(t,e,this),e.$ref&&"string"==typeof e.$ref&&(r=o.resolve(n,e.$ref),this.refCache.schemas.push(e),this.refCache.refs.push(r)),s=Object.keys(e),i=0;i<s.length;i++)this._buildIdCache(e[s[i]],n)},n.prototype._buildResolvers=function(e,t){if(e&&"object"==typeof e){var r=this,s={};Object.keys(e).forEach((function(i){var a=o.resolve(t,i),c=new n(e[i],null,r.missing$Ref,a);r._cacheId(a,c.rootSchema,c),Object.keys(c.idCache).forEach((function(e){r.idCache[e]=c.idCache[e]})),s[i]=c})),this.resolvers=s}},n.prototype.getNormalizedRef=function(e){var t=this.refCache.schemas.indexOf(e);return this.refCache.refs[t]},n.prototype._resolveRef=function(e){var t,r,n,o,h,u=new Error(c+" "+e),f=this.idCache;if(!e||"string"!=typeof e)throw u;if(e===a.id&&(h=a),r=f[e],r&&(h=r.resolver.resolve(r.schema)),void 0===h&&(n=i(e),o=n.path,n.base&&(r=f[n.base]||f[n.base+"#"],r?h=r.resolver.resolve(s(r.schema,o.slice(0))):o.unshift(n.base))),void 0===h&&this.resolvedRootSchema&&(h=s(this.resolvedRootSchema,o.slice(0))),void 0===h&&(h=s(this.rootSchema,o.slice(0))),void 0===h&&o.length&&this.resolvers&&(t=s(this.resolvers,o),t&&(h=t.resolve(t.rootSchema))),void 0===h||"object"!=typeof h){if(!this.missing$Ref)throw u;h={}}return this.cache[e]===h?h:(this.cache[e]=h,void 0!==h.$ref&&(h=this.resolve(h)),h)},n.prototype.resolve=function(e){if(!e||"object"!=typeof e||void 0===e.$ref)return e;var t=this.getNormalizedRef(e)||e.$ref,r=this.cache[t];if(void 0!==r)return r;if(this.refStack.indexOf(t)>-1)throw new Error(u+" "+t);return this.refStack.push(t),r=this._resolveRef(t),this.refStack.pop(),e===this.rootSchema&&(this.resolvedRootSchema=r),r},n.prototype.hasRef=function(e){var t,r,s,i,n=Object.keys(e);if(n.indexOf("$ref")>-1)return!0;for(s=0,t=n.length;s<t;s++)if(r=n[s],e[r]&&"object"==typeof e[r]&&!Array.isArray(e[r])&&(i=this.hasRef(e[r])))return!0;return!1},n.resolvePointer=function(e,t){var r=i(t),n=r.path;return r.base&&(n=[r.base].concat(n)),s(e,n)},e.exports=n},function(e,t,r){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
"use strict";function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,r){if(e&&h.isObject(e)&&e instanceof s)return e;var i=new s;return i.parse(e,t,r),i}function n(e){return h.isString(e)&&(e=i(e)),e instanceof s?e.format():s.prototype.format.call(e)}function o(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}var c=r(17),h=r(19);t.parse=i,t.resolve=o,t.resolveObject=a,t.format=n,t.Url=s;var u=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,p=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(l),m=["'"].concat(d),y=["%","/","?",";","#"].concat(m),g=["/","?","#"],v=255,b=/^[+a-z0-9A-Z_-]{0,63}$/,j=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},O={javascript:!0,"javascript:":!0},A={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},w=r(20);s.prototype.parse=function(e,t,r){if(!h.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),i=s!==-1&&s<e.indexOf("#")?"?":"#",n=e.split(i),o=/\\/g;n[0]=n[0].replace(o,"/"),e=n.join(i);var a=e;if(a=a.trim(),!r&&1===e.split("#").length){var f=p.exec(a);if(f)return this.path=a,this.href=a,this.pathname=f[1],f[2]?(this.search=f[2],t?this.query=w.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var l=u.exec(a);if(l){l=l[0];var d=l.toLowerCase();this.protocol=d,a=a.substr(l.length)}if(r||l||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var k="//"===a.substr(0,2);!k||l&&O[l]||(a=a.substr(2),this.slashes=!0)}if(!O[l]&&(k||l&&!A[l])){for(var q=-1,I=0;I<g.length;I++){var S=a.indexOf(g[I]);S!==-1&&(q===-1||S<q)&&(q=S)}var $,C;C=q===-1?a.lastIndexOf("@"):a.lastIndexOf("@",q),C!==-1&&($=a.slice(0,C),a=a.slice(C+1),this.auth=decodeURIComponent($)),q=-1;for(var I=0;I<y.length;I++){var S=a.indexOf(y[I]);S!==-1&&(q===-1||S<q)&&(q=S)}q===-1&&(q=a.length),this.host=a.slice(0,q),a=a.slice(q),this.parseHost(),this.hostname=this.hostname||"";var F="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!F)for(var P=this.hostname.split(/\./),I=0,R=P.length;I<R;I++){var T=P[I];if(T&&!T.match(b)){for(var E="",M=0,_=T.length;M<_;M++)E+=T.charCodeAt(M)>127?"x":T[M];if(!E.match(b)){var z=P.slice(0,I),L=P.slice(I+1),U=T.match(j);U&&(z.push(U[1]),L.unshift(U[2])),L.length&&(a="/"+L.join(".")+a),this.hostname=z.join(".");break}}}this.hostname.length>v?this.hostname="":this.hostname=this.hostname.toLowerCase(),F||(this.hostname=c.toASCII(this.hostname));var N=this.port?":"+this.port:"",Z=this.hostname||"";this.host=Z+N,this.href+=this.host,F&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!x[d])for(var I=0,R=m.length;I<R;I++){var V=m[I];if(a.indexOf(V)!==-1){var D=encodeURIComponent(V);D===V&&(D=escape(V)),a=a.split(V).join(D)}}var J=a.indexOf("#");J!==-1&&(this.hash=a.substr(J),a=a.slice(0,J));var B=a.indexOf("?");if(B!==-1?(this.search=a.substr(B),this.query=a.substr(B+1),t&&(this.query=w.parse(this.query)),a=a.slice(0,B)):t&&(this.search="",this.query={}),a&&(this.pathname=a),A[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var N=this.pathname||"",Y=this.search||"";this.path=N+Y}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",s=this.hash||"",i=!1,n="";this.host?i=e+this.host:this.hostname&&(i=e+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&h.isObject(this.query)&&Object.keys(this.query).length&&(n=w.stringify(this.query));var o=this.search||n&&"?"+n||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||A[t])&&i!==!1?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),s&&"#"!==s.charAt(0)&&(s="#"+s),o&&"?"!==o.charAt(0)&&(o="?"+o),r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})),o=o.replace("#","%23"),t+i+r+o+s},s.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(h.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}for(var r=new s,i=Object.keys(this),n=0;n<i.length;n++){var o=i[n];r[o]=this[o]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),c=0;c<a.length;c++){var u=a[c];"protocol"!==u&&(r[u]=e[u])}return A[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!A[e.protocol]){for(var f=Object.keys(e),p=0;p<f.length;p++){var l=f[p];r[l]=e[l]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||O[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var m=r.pathname||"",y=r.search||"";r.path=m+y}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=v||g||r.host&&e.pathname,j=b,x=r.pathname&&r.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],w=r.protocol&&!A[r.protocol];if(w&&(r.hostname="",r.port=null,r.host&&(""===x[0]?x[0]=r.host:x.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),b=b&&(""===d[0]||""===x[0])),v)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,x=d;else if(d.length)x||(x=[]),x.pop(),x=x.concat(d),r.search=e.search,r.query=e.query;else if(!h.isNullOrUndefined(e.search)){if(w){r.hostname=r.host=x.shift();var k=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");k&&(r.auth=k.shift(),r.host=r.hostname=k.shift())}return r.search=e.search,r.query=e.query,h.isNull(r.pathname)&&h.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!x.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var q=x.slice(-1)[0],I=(r.host||e.host||x.length>1)&&("."===q||".."===q)||""===q,S=0,$=x.length;$>=0;$--)q=x[$],"."===q?x.splice($,1):".."===q?(x.splice($,1),S++):S&&(x.splice($,1),S--);if(!b&&!j)for(;S--;S)x.unshift("..");!b||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),I&&"/"!==x.join("/").substr(-1)&&x.push("");var C=""===x[0]||x[0]&&"/"===x[0].charAt(0);if(w){r.hostname=r.host=C?"":x.length?x.shift():"";var k=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");k&&(r.auth=k.shift(),r.host=r.hostname=k.shift())}return b=b||r.host&&x.length,b&&!C&&x.unshift(""),x.length?r.pathname=x.join("/"):(r.pathname=null,r.path=null),h.isNull(r.pathname)&&h.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},s.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){var s;(function(e,i){!(function(n){function o(e){throw RangeError(P[e])}function a(e,t){for(var r=e.length,s=[];r--;)s[r]=t(e[r]);return s}function c(e,t){var r=e.split("@"),s="";r.length>1&&(s=r[0]+"@",e=r[1]),e=e.replace(F,".");var i=e.split("."),n=a(i,t).join(".");return s+n}function h(e){for(var t,r,s=[],i=0,n=e.length;i<n;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<n?(r=e.charCodeAt(i++),56320==(64512&r)?s.push(((1023&t)<<10)+(1023&r)+65536):(s.push(t),i--)):s.push(t);return s}function u(e){return a(e,(function(e){var t="";return e>65535&&(e-=65536,t+=E(e>>>10&1023|55296),e=56320|1023&e),t+=E(e)})).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:x}function p(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function l(e,t,r){var s=0;for(e=r?T(e/k):e>>1,e+=T(e/t);e>R*A>>1;s+=x)e=T(e/R);return T(s+(R+1)*e/(e+w))}function d(e){var t,r,s,i,n,a,c,h,p,d,m=[],y=e.length,g=0,v=I,b=q;for(r=e.lastIndexOf(S),r<0&&(r=0),s=0;s<r;++s)e.charCodeAt(s)>=128&&o("not-basic"),m.push(e.charCodeAt(s));for(i=r>0?r+1:0;i<y;){for(n=g,a=1,c=x;i>=y&&o("invalid-input"),h=f(e.charCodeAt(i++)),(h>=x||h>T((j-g)/a))&&o("overflow"),g+=h*a,p=c<=b?O:c>=b+A?A:c-b,!(h<p);c+=x)d=x-p,a>T(j/d)&&o("overflow"),a*=d;t=m.length+1,b=l(g-n,t,0==n),T(g/t)>j-v&&o("overflow"),v+=T(g/t),g%=t,m.splice(g++,0,v)}return u(m)}function m(e){var t,r,s,i,n,a,c,u,f,d,m,y,g,v,b,w=[];for(e=h(e),y=e.length,t=I,r=0,n=q,a=0;a<y;++a)m=e[a],m<128&&w.push(E(m));for(s=i=w.length,i&&w.push(S);s<y;){for(c=j,a=0;a<y;++a)m=e[a],m>=t&&m<c&&(c=m);for(g=s+1,c-t>T((j-r)/g)&&o("overflow"),r+=(c-t)*g,t=c,a=0;a<y;++a)if(m=e[a],m<t&&++r>j&&o("overflow"),m==t){for(u=r,f=x;d=f<=n?O:f>=n+A?A:f-n,!(u<d);f+=x)b=u-d,v=x-d,w.push(E(p(d+b%v,0))),u=T(b/v);w.push(E(p(u,0))),n=l(r,g,s==i),r=0,++s}++r,++t}return w.join("")}function y(e){return c(e,(function(e){return $.test(e)?d(e.slice(4).toLowerCase()):e}))}function g(e){return c(e,(function(e){return C.test(e)?"xn--"+m(e):e}))}var v=("object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof i&&i);v.global!==v&&v.window!==v&&v.self!==v||(n=v);var b,j=2147483647,x=36,O=1,A=26,w=38,k=700,q=72,I=128,S="-",$=/^xn--/,C=/[^\x20-\x7E]/,F=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},R=x-O,T=Math.floor,E=String.fromCharCode;b={version:"1.3.2",ucs2:{decode:h,encode:u},decode:d,encode:m,toASCII:g,toUnicode:y},s=function(){return b}.call(t,r,t,e),!(void 0!==s&&(e.exports=s))})(this)}).call(t,r(18)(e),(function(){return this})())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(21),t.encode=t.stringify=r(22)},function(e,t){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,s,i){t=t||"&",s=s||"=";var n={};if("string"!=typeof e||0===e.length)return n;var o=/\+/g;e=e.split(t);var a=1e3;i&&"number"==typeof i.maxKeys&&(a=i.maxKeys);var c=e.length;a>0&&c>a&&(c=a);for(var h=0;h<c;++h){var u,f,p,l,d=e[h].replace(o,"%20"),m=d.indexOf(s);m>=0?(u=d.substr(0,m),f=d.substr(m+1)):(u=d,f=""),p=decodeURIComponent(u),l=decodeURIComponent(f),r(n,p)?Array.isArray(n[p])?n[p].push(l):n[p]=[n[p],l]:n[p]=l}return n}},function(e,t){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,s,i){return t=t||"&",s=s||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(i){var n=encodeURIComponent(r(i))+s;return Array.isArray(e[i])?e[i].map((function(e){return n+encodeURIComponent(r(e))})).join(t):n+encodeURIComponent(r(e[i]))})).join(t):i?encodeURIComponent(r(i))+s+encodeURIComponent(r(e)):""}},function(e,t){e.exports={id:"http://json-schema.org/draft-04/schema#",$schema:"http://json-schema.org/draft-04/schema#",description:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},positiveInteger:{type:"integer",minimum:0},positiveIntegerDefault0:{allOf:[{$ref:"#/definitions/positiveInteger"},{"default":0}]},simpleTypes:{"enum":["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},minItems:1,uniqueItems:!0}},type:"object",properties:{id:{type:"string",format:"uri"},$schema:{type:"string",format:"uri"},title:{type:"string"},description:{type:"string"},"default":{},multipleOf:{type:"number",minimum:0,exclusiveMinimum:!0},maximum:{type:"number"},exclusiveMaximum:{type:"boolean","default":!1},minimum:{type:"number"},exclusiveMinimum:{type:"boolean","default":!1},maxLength:{$ref:"#/definitions/positiveInteger"},minLength:{$ref:"#/definitions/positiveIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{anyOf:[{type:"boolean"},{$ref:"#"}],"default":{}},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],"default":{}},maxItems:{$ref:"#/definitions/positiveInteger"},minItems:{$ref:"#/definitions/positiveIntegerDefault0"},uniqueItems:{type:"boolean","default":!1},maxProperties:{$ref:"#/definitions/positiveInteger"},minProperties:{$ref:"#/definitions/positiveIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{anyOf:[{type:"boolean"},{$ref:"#"}],"default":{}},definitions:{type:"object",additionalProperties:{$ref:"#"},"default":{}},properties:{type:"object",additionalProperties:{$ref:"#"},"default":{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},"default":{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},"enum":{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},dependencies:{exclusiveMaximum:["maximum"],exclusiveMinimum:["minimum"]},"default":{}}},function(e,t){"use strict";var r={};r["date-time"]=/(\d\d\d\d)(-)?(\d\d)(-)?(\d\d)(T)?(\d\d)(:)?(\d\d)(:)?(\d\d)(\.\d+)?(Z|([+-])(\d\d)(:)?(\d\d))/,r.uri=/^([a-zA-Z][a-zA-Z0-9+-.]*:){0,1}\/\/[^\s]*$/,r.email=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,r.ipv4=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,r.ipv6=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|[fF][eE]80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::([fF]{4}(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,r.hostname=/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])(\.([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9]))*$/,e.exports=r},function(e,t){"use strict";function r(e){for(var t,r,s=0,i=0,n=e.length;i<n;)s++,t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<n&&(r=e.charCodeAt(i++),56320!==(64512&r)&&i--);return s}e.exports=r}])}));

window.parseTimeMarkers['reportEmbed.externals.min.js'].end = Date.now();
;function loadReport(e,r,t,o,i,n,s,a,d){var c=jsCommon.QueryStringUtil.parseQueryString(),l=reportEmbedController.getEmbedMessageProxyService();if(!reportEmbedController)return void globalErrorService.error("Controller not initialized","Invalid setup");if(setAccessToken(r,d)){if(!e&&(e=c.reportId,jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)))return globalErrorService.error("reportId parameter is not valid","Invalid parameters"),void l.postErrorInvalidReportId();var p=c.groupId;return o||(o=c.pageName),t||(t=c.$filter),reportEmbedController.loadReport(e,p,t,void 0,o,i,n,s,a)}}function setPage(e){return reportEmbedController?void reportEmbedController.setPage(e):void globalErrorService.error("Controller not initialized","Invalid setup")}function toggleEditMode(e){return reportEmbedController?void reportEmbedController.changeViewMode(e):void globalErrorService.error("Controller not initialized","Invalid setup")}function saveReport(){return reportEmbedController?void reportEmbedController.saveReport():void globalErrorService.error("Controller not initialized","Invalid setup")}function saveReportAs(e){if(!reportEmbedController)return void globalErrorService.error("Controller not initialized","Invalid setup");var r={name:e};reportEmbedController.saveReportAs(r)}function createReport(e,r,t,o){if(setAccessToken(r,o))return reportEmbedController?reportEmbedController.createReport(e,t):void globalErrorService.error("Controller not initialized","Invalid setup")}function setAccessToken(e,r){var t=reportEmbedController.getEmbedMessageProxyService();if(e&&(window.powerBIAccessToken=e),jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(window.powerBIAccessToken))return globalErrorService.error("powerbiToken parameter not specified","Invalid parameters"),t.postErrorInvalidAccessToken(),!1;if(globalEmbedModeService.isAppTokenEmbed()){if(r===PowerBIModels.TokenType.Aad)return!1;window.powerBIAppToken=e}else r!==PowerBIModels.TokenType.Embed||globalEmbedModeService.isAnonymousLiveEmbed()||(window.powerBIEmbedToken=e);return!0}var __awaiter=this&&this.__awaiter||function(e,r,t,o){return new(t||(t=Promise))(function(i,n){function s(e){try{d(o.next(e))}catch(e){n(e)}}function a(e){try{d(o.throw(e))}catch(e){n(e)}}function d(e){e.done?i(e.value):new t(function(r){r(e.value)}).then(s,a)}d((o=o.apply(e,r||[])).next())})},__generator=this&&this.__generator||function(e,r){function t(e){return function(r){return o([e,r])}}function o(t){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(s=n[2&t[0]?"return":t[0]?"throw":"next"])&&!(s=s.call(n,t[1])).done)return s;switch(n=0,s&&(t=[0,s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,n=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(s=a.trys,!(s=s.length>0&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=r.call(e,a)}catch(e){t=[6,e],n=0}finally{i=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,n,s,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return{next:t(0),throw:t(1),return:t(2)}},__extends=this&&this.__extends||(function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}})(),reportEmbedController,globalErrorService,globalWindowService,globalEmbedModeService,PowerBIModels=window["powerbi-models"],perfMarkers=powerbi.common.perfMarkers,telemetry=powerbi.telemetry,powerbi;!(function(e){var r;!(function(r){var t;!(function(r){function t(r,t){void 0===t&&(t=[]);var o=r[0].toLowerCase()+r.slice(1);t.push((function(t,o,i,n){return new e.explore.reportembed.directives[r](t,o,i,n)})),angular.module("powerbi.explore.reportembed").directive(o,t)}var o,i,n=["powerbi.common","ui.router","powerbi","powerbi.explore","powerbi.settings"],s=2;angular.module("powerbi.explore.reportembed",n).config(["$httpProvider",function(e){e.useApplyAsync(!0)}]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,r,t){t.html5Mode(!0),r.otherwise("/reportEmbed"),e.state("reportEmbed",{url:"/reportEmbed?&unmin&reportId",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController"}).state("embedLive/live/report",{url:"/embedLive/live/report.html?unmin&key",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController"}).state("view",{url:"/view?unmin&key&r",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController"}).state("appTokenReportEmbed",{url:"/appTokenReportEmbed?unmin&reportid",templateUrl:"views/interactiveEmbed.html",reloadOnSearch:!1,controller:"ReportEmbedController"})}]).config(["pbiLazyLoadProvider",function(e){e.setHostEnv(s)}]).config(["telemetryServiceProvider",function(r){r.hostService=e.telemetry.createTelemetryHostService()}]).factory("explorationProxy",["promiseFactory","explorationSerializer","telemetryService","featureSwitchService",function(r,t,o,i){var n="explore/";return window.getExplorationUrl&&(n=window.getExplorationUrl),e.explore.proxies.createExplorationProxy(r,e.common.httpService,t,o,i,n)}]).factory("loadProgressNotificationService",["$timeout","$rootScope",function(t,o){return e.common.createLoadProgressNotificationService(t,(function(){o.$emit(r.constants.reportRenderFinished)}))}]).service("userServicePlanMetadata",["promiseFactory","featureSwitchService",function(t,o){return new r.services.UserServicePlanService(t,e.common.httpService,o)}]).service("clusterResolverService",["promiseFactory","telemetryService",function(t,o){return new r.services.ClusterResolverService(t,e.common.httpService,o)}]).service("reportEmbedExplorationService",["telemetryService","$rootScope","promiseFactory","explorationSerializer","embedModeService","editableFeatureSwitchService","featureSwitchService","explorationProxy",function(t,o,i,n,s,a,d,c){var l="explore/";return window.getExplorationUrl&&(l=window.getExplorationUrl),new r.services.ReportEmbedExplorationService(i,e.common.httpService,t,n,s,a,d,c,o,l)}]).service("reportEmbedModelService",["promiseFactory","editableFeatureSwitchService",function(t,o){var i="metadata/";return window.getModelUrl&&(i=window.getModelUrl),new r.services.ReportEmbedModelService(t,e.common.httpService,o,i)}]).factory("groupService",(function(){return[]})).factory("contentPackService",(function(){return[]})).factory("reportService",(function(){return[]})).factory("dashboardService",(function(){return[]})).factory("workbookService",(function(){return[]})).factory("userNotificationInfo",(function(){return[]})).factory("usageMetricsReport",(function(){return[]})).factory("appService",["promiseFactory",function(r){return e.dataServices.createMockAppService(r)}]).factory("modelService",(function(){return new e.dataServices.MockModelService})).factory("navigation",["$location","promiseFactory",function(e,t){return new r.services.ReportEmbedNavigationService(e,t)}]).factory("fullScreen",["$rootScope","navigation","$document",function(r,t,o){return e.services.createFullScreenService(r,t,o)}]).factory("modelConverter",["telemetryService","errorService","visualPlugin","promiseFactory","geolocationService","dataServiceModelConverter","localizationService",function(r,t,o,i,n,s,a){return e.models.createModelConverter(r,t,o,i,n,s,a)}]).factory("licenseEnforcementService",(function(){return[]})).factory("userInfo",(function(){return[]})).factory("trustedVisual",["promiseFactory","localizationService","visualConsent","approvedResourceService","visualSandbox","resourceLoader","telemetryService",function(r,t,o,i,n,s,a){var d=e.visualHost.createTrustedVisualService(r,a,o,i,n,s);return d.registerTrustedVisual([e.visualHost.EsriVisual],e.helpers.EsriVisualHelper.createEmbedRegisterTrustedVisualOptions(r,t)),d.registerTrustedVisual([e.visualHost.VisioVisual,e.visualHost.VisioDFVisual],e.explore.utils.VisioVisualHelper.createVisioVisualRegisterOptions()),d}]).factory("activeGroupId",(function(){return e.common.createEmbedActiveGroupIdService()})).factory("window-post-message-proxy",["$window",function(e){var r=e.window["http-post-message"].HttpPostMessage,t={processTrackingProperties:{addTrackingProperties:r.addTrackingProperties,getTrackingProperties:r.getTrackingProperties},suppressWarnings:!0};return new e.window["window-post-message-proxy"].WindowPostMessageProxy(t)}]).factory("powerbi-router",["$window","window-post-message-proxy",function(e,r){return new e.window["powerbi-router"].Router(r)}]).factory("http-post-message",["$window","window-post-message-proxy",function(e,r){return new e.window["http-post-message"].HttpPostMessage(e.window.parent,r)}]).run(["$location","$rootScope","scopedProvider","embedModeService","telemetryService",function(t,n,s,a,d){s.register("undoRedo",{fn:function(){return new e.explore.services.NoOpUndoRedoService}}).register("explorationCapabilities",{fn:function(){return i||(i=r.createOrUpdateEmbedExplorationCapabilities(t,n,s,a)),i}}).register("eventBridge",{fn:function(){return o||(o=e.common.createEventBridge()),o}}).register("reportEmbedFilterService",{services:["$rootScope","promiseFactory","conceptualSchemaProxy"],scopedServices:["eventBridge"],fn:function(e,t,o,i){return new r.services.ReportEmbedFilterService(e,t,o,i)}}).register("embedMessageProxyService",{services:["$rootScope","$window","window-post-message-proxy","http-post-message","powerbi-router","embedModeService","conceptualSchemaProxy","promiseFactory","telemetryService"],scopedServices:["eventBridge","reportEmbedFilterService"],fn:function(e,t,o,i,n,s,a,d,c,l,p){return new r.services.ReportEmbedMessageProxyService(e,t,o,i,n,s,a,d,c,l,p)}});for(var c=perfMarkers.getJsParseTimes(window.parseTimeMarkers),l=0,p=c;l<p.length;l++){var v=p[l];d.logEvent(e.telemetry.AppJavaScriptParse,v.fileName,v.start,v.end)}e.explore.reportembed.notifyModelsAndExplorationReady=function(e){n.$emit(r.constants.modelsAndExplorationReadyEventName,e)},e.explore.reportembed.notifyConceptualSchemaReady=function(e){n.$emit(r.constants.conceptualSchemaReadyEventName,e)}}]).provider("dataReaderProvider",(function(){var t="explore/querydata";window.queryDataUrl&&(t=window.queryDataUrl);var o="explore/conceptualschema";window.getConceptualSchemaUrl&&(o=window.getConceptualSchemaUrl);var i=this;return i.$get=["promiseFactory","featureSwitchService","delayedQueryResultHandler","localizationService","telemetryService","$rootScope",function(n,s,a,d,c,l){var p=e.common.httpService,v={dsr:{name:"dsr",reader:function(r){return new e.data.dsr.DsrDataReader(r,i.executeSemanticQueryProxyCommunication||e.data.dsr.createExecuteSemanticQueryProxyHttpCommunication(p,c,n,t),a)},queryGenerator:function(){return e.data.dsr.createQueryGenerator()},schemaReader:function(){return e.data.dsr.createConceptualSchemaReader(n,c,r.services.createConceptualSchemaProxyHttpCommunication(e.common.httpService,n,s,o,l),e.data.dsr.ConceptualSchemaFactory.createLocOptions(d))}},bingSocialDataReader:{name:"bingSocialDataReader",reader:function(r){return new e.data.bingSocial.BingSocialDataReader(r,p)}}},u={};return e.explore.dataReaderPlugins.registerExplorationDataReaderExtension(u,n,!1),e.data.createDataReaderProvider(e.data.createDataReaderFactory(v,u),{promiseFactory:function(){return n}})}],i})).controller("ReportEmbedController",["$http","$scope","$rootScope","$window","promiseFactory","embedModeService","errorService","explorationSerializer","modelConverter","telemetryService","localizationService","$timeout","reportEmbedExplorationService","reportEmbedModelService","activeGroupId","userServicePlanMetadata","clusterResolverService","scopedProvider","featureSwitchService","visualPlugin","loadProgressNotificationService","moduleLoader",function(e,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h,b,y,S,f,E,I){globalErrorService=a,globalWindowService=i,globalEmbedModeService=s,y.attachTo(o);var w=y.find(o).get("embedMessageProxyService",o),C=y.find(o).get("eventBridge",o),R=y.find(o).get("explorationCapabilities",o),M={embedModeService:s,errorService:a,eventBridge:C,explorationSerializer:d,modelConverter:c,telemetryService:l,$timeout:v,reportEmbedExplorationService:u,reportEmbedModelService:m,localizationService:p,activeGroupIdService:g,userServicePlanMetadata:h,clusterResolverService:b,promiseFactory:n,windowService:i,scopedProvider:y,featureSwitchService:S,embedMessageProxyService:w,visualPlugin:f,loadProgressNotificationService:E,explorationCapabilities:R,moduleLoader:I};return reportEmbedController=new r.controllers.ReportEmbedController(o,M),window.isReportControllerInitialized=!0,w.startListening(),window.isLoadReportMessagePending?(loadReport(window.reportObjectId,window.accessToken,window.oDataFilter,window.pageName,window.loadSettings),window.isLoadReportMessagePending=!1):s.isAnonymousLiveEmbed()&&loadReport("any","any",void 0),reportEmbedController}]),e.common.registerPBICommonBuildingBlocksForHost(s),e.visualHost.registerBuildingBlocksForHost(s),e.registerBuildingBlocksForHost(s),e.explore.registerBuildingBlocksForHost(s),r.registerReportEmbedDirective=t})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){function t(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={reportId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"EmbedCustomerAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:b.reportId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.EmbedCustomerActionLoggers};return y}function o(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={datasetId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"EmbedCustomerCreateAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({datasetId:b.datasetId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.EmbedCustomerCreateActionLoggers};return y}function i(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"EmbedSDKCustomerAction",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.EmbedSDKCustomerActionLoggers};return b}function n(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={datasetId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.CreateReport",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({datasetId:b.datasetId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedCreateReportLoggers};return y}function s(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={reportId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.LoadEmbeddedReport",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:b.reportId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedLoadEmbeddedReportLoggers};return y}function a(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h,b,y,S,f,E,I){void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=void 0),void 0===g&&(g=void 0),void 0===h&&(h=void 0),void 0===b&&(b=void 0),void 0===y&&(y=!1),void 0===S&&(S=!1),void 0===f&&(f=void 0),void 0===E&&(E=!1),void 0===I&&(I=!1);var w={endPoint:r,clientAndServerRequestIdMatch:t,responseRequestId:o,IsResolvedDuringScriptLoad:i,frontLoadStart:n,frontLoadEnd:s,reportId:a,embedType:d,embedUrl:c,referrer:l,parentId:p,isError:v,errorSource:u,errorCode:m,errorMessage:g,activityName:h,activityId:b,isDebug:y,isCancelled:S,pingLatency:f,isAppInactive:E,isInCapacity:I},C={name:"PBI.ReportEmbed.GetExplorationAndModel",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({endPoint:w.endPoint,clientAndServerRequestIdMatch:w.clientAndServerRequestIdMatch,responseRequestId:w.responseRequestId,IsResolvedDuringScriptLoad:w.IsResolvedDuringScriptLoad,frontLoadStart:w.frontLoadStart,frontLoadEnd:w.frontLoadEnd,reportId:w.reportId,embedType:w.embedType,embedUrl:w.embedUrl,referrer:w.referrer,parentId:w.parentId},{isError:w.isError,errorSource:e.telemetry.ErrorSource[w.errorSource],errorCode:w.errorCode,errorMessage:w.errorMessage,activityName:w.activityName,activityId:w.activityId,isDebug:w.isDebug,isCancelled:w.isCancelled,pingLatency:w.pingLatency,isAppInactive:w.isAppInactive,isInCapacity:w.isInCapacity})},info:w,loggers:e.telemetry.ReportEmbedGetExplorationAndModelLoggers};return C}function d(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={reportId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.LoadingStarted",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:b.reportId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedLoadingStartedLoggers};return y}function c(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={reportId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.PageLoaded",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:b.reportId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedPageLoadedLoggers};return y}function l(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={reportId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.ScriptLoaded",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:b.reportId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedScriptLoadedLoggers};return y}function p(r,t,o,i,n,s,a,d,c,l,p,v){void 0===t&&(t=!1),void 0===o&&(o=void 0),void 0===i&&(i=void 0),void 0===n&&(n=void 0),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=!1),void 0===c&&(c=!1),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1);var u={parentId:r,isError:t,errorSource:o,errorCode:i,errorMessage:n,activityName:s,activityId:a,isDebug:d,isCancelled:c,pingLatency:l,isAppInactive:p,isInCapacity:v},m={name:"PBI.ReportEmbed.EnterFullScreen",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({parentId:u.parentId},{isError:u.isError,errorSource:e.telemetry.ErrorSource[u.errorSource],errorCode:u.errorCode,errorMessage:u.errorMessage,activityName:u.activityName,activityId:u.activityId,isDebug:u.isDebug,isCancelled:u.isCancelled,pingLatency:u.pingLatency,isAppInactive:u.isAppInactive,isInCapacity:u.isInCapacity})},info:u,loggers:e.telemetry.ReportEmbedEnterFullScreenLoggers};return m}function v(r){var t={message:r},o={name:"PBI.ReportEmbed.InvalidReportResourceKey",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({message:t.message},{})},info:t,loggers:e.telemetry.ReportEmbedInvalidReportResourceKeyLoggers};return o}function u(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===t&&(t=void 0),void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={IsResolvedDuringScriptLoad:r,backendUrl:t,frontLoadStart:o,frontLoadEnd:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.ClusterResolved",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({IsResolvedDuringScriptLoad:b.IsResolvedDuringScriptLoad,frontLoadStart:b.frontLoadStart,frontLoadEnd:b.frontLoadEnd,parentId:b.parentId},{backendUrl:b.backendUrl,isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedClusterResolvedLoggers};return y}function m(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={embedType:r,embedUrl:t,referrer:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SwitchPage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({embedType:h.embedType,embedUrl:h.embedUrl,referrer:h.referrer,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSwitchPageLoggers};return b}function g(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h,b){void 0===r&&(r=void 0),void 0===a&&(a=!1),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=void 0),void 0===u&&(u=!1),void 0===m&&(m=!1),void 0===g&&(g=void 0),void 0===h&&(h=!1),void 0===b&&(b=!1);var y={platformUrl:r,reportId:t,embedType:o,embedUrl:i,referrer:n,parentId:s,isError:a,errorSource:d,errorCode:c,errorMessage:l,activityName:p,activityId:v,isDebug:u,isCancelled:m,pingLatency:g,isAppInactive:h,isInCapacity:b},S={name:"PBI.ReportEmbed.SocialSharing",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:y.reportId,embedType:y.embedType,embedUrl:y.embedUrl,referrer:y.referrer,parentId:y.parentId},{platformUrl:y.platformUrl,isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.ReportEmbedSocialSharingLoggers};return S}function h(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={reportId:r,embedType:t,embedUrl:o,referrer:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.SaveExploration",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({reportId:b.reportId,embedType:b.embedType,embedUrl:b.embedUrl,referrer:b.referrer,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedSaveExplorationLoggers};return y}function b(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h,b){void 0===a&&(a=!1),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=void 0),void 0===u&&(u=!1),void 0===m&&(m=!1),void 0===g&&(g=void 0),void 0===h&&(h=!1),void 0===b&&(b=!1);var y={customDialogUsed:r,reportId:t,embedType:o,embedUrl:i,referrer:n,parentId:s,isError:a,errorSource:d,errorCode:c,errorMessage:l,activityName:p,activityId:v,isDebug:u,isCancelled:m,pingLatency:g,isAppInactive:h,isInCapacity:b},S={name:"PBI.ReportEmbed.SaveAsExploration",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({customDialogUsed:y.customDialogUsed,reportId:y.reportId,embedType:y.embedType,embedUrl:y.embedUrl,referrer:y.referrer,parentId:y.parentId},{isError:y.isError,errorSource:e.telemetry.ErrorSource[y.errorSource],errorCode:y.errorCode,errorMessage:y.errorMessage,activityName:y.activityName,activityId:y.activityId,isDebug:y.isDebug,isCancelled:y.isCancelled,pingLatency:y.pingLatency,isAppInactive:y.isAppInactive,isInCapacity:y.isInCapacity})},info:y,loggers:e.telemetry.ReportEmbedSaveAsExplorationLoggers};return S}function y(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.LoadReport",category:e.TelemetryCategory.CustomerAction,time:Date.now(),
id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKLoadReportLoggers};return b}function S(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.SetActivePage",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKSetActivePageLoggers};return b}function f(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.GetAllPages",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKGetAllPagesLoggers};return b}function E(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.SetReportLevelFilters",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKSetReportLevelFiltersLoggers};return b}function I(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.GetReportLevelFilters",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKGetReportLevelFiltersLoggers};return b}function w(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.SetPageLevelFilters",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKSetPageLevelFiltersLoggers};return b}function C(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.GetPageLevelFilters",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKGetPageLevelFiltersLoggers};return b}function R(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.UpdateSettings",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKUpdateSettingsLoggers};return b}function M(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.ChangeViewMode",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKChangeViewModeLoggers};return b}function P(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.SaveExploration",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKSaveExplorationLoggers};return b}function x(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.SaveAsExploration",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKSaveAsExplorationLoggers};return b}function A(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g){void 0===n&&(n=!1),void 0===s&&(s=void 0),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=!1),void 0===v&&(v=!1),void 0===u&&(u=void 0),void 0===m&&(m=!1),void 0===g&&(g=!1);var h={requestId:r,reportId:t,embedType:o,parentId:i,isError:n,errorSource:s,errorCode:a,errorMessage:d,activityName:c,activityId:l,isDebug:p,isCancelled:v,pingLatency:u,isAppInactive:m,isInCapacity:g},b={name:"PBI.ReportEmbed.SDK.SetAccessToken",category:e.TelemetryCategory.CustomerAction,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:h.requestId,reportId:h.reportId,embedType:h.embedType,parentId:h.parentId},{isError:h.isError,errorSource:e.telemetry.ErrorSource[h.errorSource],errorCode:h.errorCode,errorMessage:h.errorMessage,activityName:h.activityName,activityId:h.activityId,isDebug:h.isDebug,isCancelled:h.isCancelled,pingLatency:h.pingLatency,isAppInactive:h.isAppInactive,isInCapacity:h.isInCapacity})},info:h,loggers:e.telemetry.ReportEmbedSDKSetAccessTokenLoggers};return b}function L(r,t,o,i){var n={requestId:r,reportId:t,embedType:o,message:i},s={name:"PBI.ReportEmbed.SDK.Error",category:e.TelemetryCategory.CriticalError,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:n.requestId,reportId:n.reportId,embedType:n.embedType,message:n.message},{})},info:n,loggers:e.telemetry.ReportEmbedSDKErrorLoggers};return s}function F(r,t,o,i,n,s,a,d,c,l,p,v,u,m,g,h){void 0===s&&(s=!1),void 0===a&&(a=void 0),void 0===d&&(d=void 0),void 0===c&&(c=void 0),void 0===l&&(l=void 0),void 0===p&&(p=void 0),void 0===v&&(v=!1),void 0===u&&(u=!1),void 0===m&&(m=void 0),void 0===g&&(g=!1),void 0===h&&(h=!1);var b={requestId:r,reportId:t,embedType:o,renderErrorOccurred:i,parentId:n,isError:s,errorSource:a,errorCode:d,errorMessage:c,activityName:l,activityId:p,isDebug:v,isCancelled:u,pingLatency:m,isAppInactive:g,isInCapacity:h},y={name:"PBI.ReportEmbed.AllVisualsRendered",category:e.TelemetryCategory.Verbose,time:Date.now(),id:T.generateGuid(),formatted:function(){return e.mergeFormattedEventInfo({requestId:b.requestId,reportId:b.reportId,embedType:b.embedType,renderErrorOccurred:b.renderErrorOccurred,parentId:b.parentId},{isError:b.isError,errorSource:e.telemetry.ErrorSource[b.errorSource],errorCode:b.errorCode,errorMessage:b.errorMessage,activityName:b.activityName,activityId:b.activityId,isDebug:b.isDebug,isCancelled:b.isCancelled,pingLatency:b.pingLatency,isAppInactive:b.isAppInactive,isInCapacity:b.isInCapacity})},info:b,loggers:e.telemetry.ReportEmbedAllVisualsRenderedLoggers};return y}var T=jsCommon.Utility;r.EmbedCustomerAction=t,r.EmbedCustomerCreateAction=o,r.EmbedSDKCustomerAction=i,r.ReportEmbedCreateReport=n,r.ReportEmbedLoadEmbeddedReport=s,r.ReportEmbedGetExplorationAndModel=a,r.ReportEmbedLoadingStarted=d,r.ReportEmbedPageLoaded=c,r.ReportEmbedScriptLoaded=l,r.ReportEmbedEnterFullScreen=p,r.ReportEmbedInvalidReportResourceKey=v,r.ReportEmbedClusterResolved=u,r.ReportEmbedSwitchPage=m,r.ReportEmbedSocialSharing=g,r.ReportEmbedSaveExploration=h,r.ReportEmbedSaveAsExploration=b,r.ReportEmbedSDKLoadReport=y,r.ReportEmbedSDKSetActivePage=S,r.ReportEmbedSDKGetAllPages=f,r.ReportEmbedSDKSetReportLevelFilters=E,r.ReportEmbedSDKGetReportLevelFilters=I,r.ReportEmbedSDKSetPageLevelFilters=w,r.ReportEmbedSDKGetPageLevelFilters=C,r.ReportEmbedSDKUpdateSettings=R,r.ReportEmbedSDKChangeViewMode=M,r.ReportEmbedSDKSaveExploration=P,r.ReportEmbedSDKSaveAsExploration=x,r.ReportEmbedSDKSetAccessToken=A,r.ReportEmbedSDKError=L,r.ReportEmbedAllVisualsRendered=F})(r=e.telemetry||(e.telemetry={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){e.reportLoadUrl="/report/load",e.loadReport="loadReport",e.error="error",e.minimumReportDataRefreshIntervalInMinutes=1,e.defaultId="defaultId",e.FilterLevel="page",e.reportPageLoaded="reportPageLoaded",e.reportRenderFinished="reportRenderFinished",e.modelsAndExplorationReadyEventName="modelsAndExplorationReady",e.conceptualSchemaReadyEventName="conceptualSchemaReady",e.showSocialSharingOverlayEventName="showSocialSharingOverlay";var r;!(function(e){e.POST="POST"})(r=e.HttpMethods||(e.HttpMethods={}));var t;!(function(e){e.getAllPagesFailed="Could not get all pages",e.invalidPageName="Invalid page name",e.setPageFailed="Could not set a page",e.loadReportFailed="Could not load a report",e.renderReportFailed="Could not render a report",e.setFilterFailed="Could not add a filter",e.clearAllFiltersFailed="Could not clear all filters",e.changeViewModeFailed="Could not change view mode",e.invalidViewMode="Invalid view mode",e.saveExplorationFailed="Could not save report",e.invalidFilter="Invalid filter definition",e.invalidAccessToken="Invalid access token",e.filtersSerializationError="Could not serialize filters to json syntax.",e.updateSettingsFailed="Error occurred while updating settings.",e.routeNotFound="Not Found. Url: {0} was not found.",e.publishToWebNotSupported="This feature is not supported for Publish To Web.",e.tooManyRefreshRequests="Report refresh limit of one request every {0} seconds reached. Please try again later.",e.powerBIEntityNotFound="PowerBI entity not found",e.insufficientPermissions="Could not load Edit mode: insufficient Permissions"})(t=e.ErrorMessages||(e.ErrorMessages={}));var o;!(function(e){e.saveReportNotAllowedInViewMode="SaveReportNotAllowedInViewMode",e.featureNotSupported="NotSupported",e.saveReportNotSupported="SaveReportNotSupported",e.reportLoadFailed="LoadReportFailed",e.reportRenderFailed="ReportRenderFailed",e.notFound="ReportNotFound",e.filterError="filterError",e.missingReportId="InvalidOrNoReportId",e.missingAccessToken="InvalidOrNoPowerBIAccessToken",e.missingViewMode="InvalidViewMode",e.saveReportFailed="SaveReportFailed",e.invalidReportObjectId="InvalidReprtObjectId",e.getReportFailed="GetReportFailed",e.getDatasetFailed="GetDatasetFailed",e.createReportFailed="CreateReportFailed",e.notAuthorized="NotAuthorized",e.powerBIEntityNotFound="PowerBIEntityNotFound"})(o=e.ErrorCodes||(e.ErrorCodes={}));var i;!(function(e){e.loadReportUIDMissingWarning="Warning: Received load report message that does not contain uid in request headers. Update your load message with the uid, otherwise emitted events will not contain uid associated with that report.",e.createReportUIDMissingWarning="Warning: Received create report message that does not contain uid in request headers. Update your create message with the uid, otherwise emitted events will not contain uid associated with that data set."})(i=e.WarningMessages||(e.WarningMessages={}));var n;!(function(e){e.OK=200,e.Accepted=202,e.BadRequest=400,e.NotFound=404,e.TooManyRequests=429,e.InternalServerError=500})(n=e.StatusCodes||(e.StatusCodes={}));var s;!(function(e){e.Loading="#Loading#",e.Error="#Error#"})(s=e.ModelsAndExplorationState||(e.ModelsAndExplorationState={}));var a;!(function(e){e.Loading="#Loading#",e.Error="#Error#"})(a=e.ConceptualSchemaState||(e.ConceptualSchemaState={}));var d;!(function(e){e.maxWidthMobileUI=480,e.maxHeightMobileUI=338,e.maxSizeTabletUI=768})(d=e.CssStyles||(e.CssStyles={}));var c;!(function(e){e.refreshFrequencyInSeconds=15})(c=e.ThrottlingLimits||(e.ThrottlingLimits={}))})(r=e.constants||(e.constants={}))})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=e.helpers.ClusterLocationHelper,o="https://go.microsoft.com/fwlink/?LinkID=620319",i="https://go.microsoft.com/fwlink/?LinkID=722383&clcid=0x409",n=(function(){function r(r,t,o){void 0===o&&(o=navigator.userAgent);var i=this;this.scope=r,this.services=t,this.userAgent=o,this.scope.isAnonymousLiveEmbed=t.embedModeService.isAnonymousLiveEmbed(),this.scope.showAboutDialog=function(){return i.showAboutDialog()},this.scope.useTitleForAnchor=function(){return i.useTitleForAnchor()},this.scope.showFlag=this.scope.isAnonymousLiveEmbed,this.scope.showFullScreen=this.scope.isAnonymousLiveEmbed,this.setEmailLink(),this.setPowerBILink(),this.scope.toggleFullScreenMode=function(){var r=document,t=i.services.fullScreen.fullScreenModeSupported&&(r.fullscreenEnabled||r.webkitFullscreenEnabled||r.mozFullScreenEnabled||r.msFullscreenEnabled);t&&(i.services.fullScreen.fullScreenMode=!i.services.fullScreen.fullScreenMode,i.services.fullScreen.fullScreenMode&&i.services.telemetryService.logEvent(e.telemetry.ReportEmbedEnterFullScreen))},this.scope.isFullScreen=function(){return i.services.fullScreen.fullScreenMode},this.scope.socialSharingFeatureEnabled=this.scope.isAnonymousLiveEmbed&&this.services.featureSwitchService.featureSwitches.socialSharingEnabled}return r.createOptions=function(){return{additionalServices:["embedModeService","errorService","localizationService","telemetryService","fullScreen","featureSwitchService"]}},r.prototype.showAboutDialog=function(){var r=this.services.errorService.control(),t=this.getFormattedDialogTemplate();if(e.build){var o=[new InJs.ModalDialogAction(this.services.localizationService.get("ReportEmbed_PrivacyPolicy"),function(e,r){window.open("https://go.microsoft.com/fwlink/?LinkId=248681","_blank")}),new InJs.ModalDialogAction(this.services.localizationService.get("ReportEmbed_Close"),function(e,t){r.hideDialog()})],i=t.replace("{{version}}",e.build);r.showCustomDialog(null,$(i),o,null,!0,!0,"","small")}},r.prototype.getFormattedDialogTemplate=function(){var e,o=this;return this.services.localizationService.ensureLocalization((function(){var i=new Date;if(e=jsCommon.StringExtensions.format(r.InnerAboutDialogTemplate,o.services.localizationService.get("TopNav_PowerBILogoTextNoPreview"),o.services.localizationService.format("PowerBI_Copyright_Text",[i.getFullYear().toString()]),o.services.localizationService.get("PowerBI_Build_Version_Text"),o.services.localizationService.get("AdditionalErrorInfo_ActivityIdText"),o.services.telemetryService.sessionId,o.services.localizationService.get("AdditionalErrorInfo_TimestampText"),i.toString()),!o.scope.isAnonymousLiveEmbed){var n=t.getClusterLocation(clusterUri,o.services.localizationService);e+=r.TemplateLocationString,e=jsCommon.StringExtensions.format(e,o.services.localizationService.get("AdditionalErrorInfo_DataLocationText"),n)}e+=r.TemplateClosingString})),e},r.prototype.setEmailLink=function(){var e="mailto:pbicontentconcern@microsoft.com?subject=Inappropriate%20Content&body=(Fill%20in%20the%20reason%20for%20your%20concern%20below)%0A%0APower%20BI%20Team%2C%0AI%20am%20reporting%20a%20concern%20with%20content%20linked%20below.%0A%0A%3CProvide%20your%20reason%3E%0A%0AURL%20to%20embedded%20content%3A%0A%7B%7BembedUrl%7D%7D%0A%0A---------------------%0AWe%20aim%20to%20review%20all%20concerns%20within%2048%20hours.%20We%20will%20contact%20you%20if%20we%20have%20additional%20questions%20related%20to%20your%20concern.",r=window.location.href;this.scope.linkToShare=r,this.scope.mailToLink=e.replace("%7B%7BembedUrl%7D%7D",encodeURIComponent(r))},r.prototype.setPowerBILink=function(){this.scope.isAnonymousLiveEmbed?this.scope.powerbiLink=i:this.scope.powerbiLink=o},r.prototype.useTitleForAnchor=function(){var e=this.userAgent.toLowerCase();return e.indexOf(" edge/")>-1},r})();n.InnerAboutDialogTemplate='<div class="aboutDialog"><div class="dialogIcon"><i class= "glyphicon pbi-glyph-powerbi icon"> </i></div><div class="info"><div class="title">{0}</div><div class="copyright">&copy;{1}</div><span class="field">{2}</span><span class="value">{{version}}</span><br><span class="field">{3}</span><span class="value">{4}</span><br><span class="field">{5}</span><span class="value">{6}</span>',n.TemplateLocationString='<br><span class="field">{0}</span><span class="value">{1}</span>',n.TemplateClosingString="</div></div>",r.LogoBarController=n})(t=r.controllers||(r.controllers={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(t){var o=(function(){function t(r,t){var o=this;this.scope=r,this.services=t,this.scope.showOverlay=!1,this.scope.currentPageNumber=0,this.scope.toggleOverlay=function(){return o.toggleOverlay()},this.scope.navigationPreviousPage=function(){return o.navigationPreviousPage()},this.scope.navigationNextPage=function(){return o.navigationNextPage()},this.scope.goToSection=function(e){return o.goToSection(e)},this.scope.socialSharingFeatureEnabled=t.embedModeService.isAnonymousLiveEmbed()&&this.services.featureSwitchService.featureSwitches.socialSharingEnabled,r.reportEmbedExplorationService=this.services.reportEmbedExplorationService,r.$watch("reportEmbedExplorationService.exploration.sections",(function(e){_.isArray(e)&&(r.allPagesCount=e.length,r.sections=e.map((function(e){return e.displayName})))})),r.$watch("reportEmbedExplorationService.exploration.activeSectionIndex",(function(e){_.isNumber(e)&&(r.currentPageNumber=e||0)}));var i=r.$on(e.explore.reportembed.constants.showSocialSharingOverlayEventName,(function(e,r){o.setHidePageNavigationFlyout(r)}));r.$on(e.common.constants.scopeDestroyEventName,(function(){i()}))}return t.createOptions=function(){return{additionalServices:["reportEmbedExplorationService","embedModeService","featureSwitchService"]}},t.prototype.setHidePageNavigationFlyout=function(e){this.scope.hidePageNavigationFlyout=e},t.prototype.toggleOverlay=function(){this.showPageNavigation()&&(this.scope.showOverlay=!this.scope.showOverlay)},t.prototype.navigationPreviousPage=function(){this.scope.currentPageNumber>0&&(this.scope.$emit(e.explore.constants.explorationPreviousPageEvent),this.scope.currentPageNumber-=1)},t.prototype.navigationNextPage=function(){this.scope.currentPageNumber<this.scope.allPagesCount-1&&(this.scope.$emit(e.explore.constants.explorationNextPageEvent),this.scope.currentPageNumber+=1)},t.prototype.goToSection=function(e){e>=0&&e<this.scope.allPagesCount&&(this.scope.$emit(r.constants.switchSectionEvent,e),this.scope.currentPageNumber=e,this.toggleOverlay())},t.prototype.showPageNavigation=function(){return this.scope.allPagesCount>1||this.scope.isSmallScreen},t})();t.LogoBarNavigationController=o})(o=t.controllers||(t.controllers={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){var i=jsCommon.EnumExtensions,n=e.common.events,s=e.dataServices.models.ContentPackItems,a=e.common.contracts,d=e.errorDetailsHelper,c=e.explore.services.events,l=e.explore.reportembed.constants,p=e.explore.viewModels,v=a.reportServer.ReportInstantiationMode,u="SAAS embed: Fail to initialize - Could not initialize report embed",m="PAAS embed: Fail to initialize - Could not initialize report embed",g="Fail to initialize - Could not initialize create report",h="PAAS embed: Fail to load - Could not parse the reportObjectId.",b="SAAS embed: Fail to initialize - Could not resolve cluster",y="PAAS embed: Fail to initialize - Could not resolve cluster",S="Anonymous embed error: Fail to initialize - Could not initialize report embed",f="Anonymous embed error: Fail to load - Could not parse the reportObjectId from the searchBar.",E="ReportEmbedEditingEnabled feature switch is off",I=(function(){function o(r,o){var i=this;this.PowerBIModels=window["powerbi-models"],this.scope=r,this.scope.showErrorMessage=!1,this.services=o,this.report={permissions:a.Permissions.Read,hasExploration:!0},this.windowMessageHelper=t.getHostCommunicationHelper(this.services.windowService),this.scope.$on(e.constants.openReportFinished,(function(e,r,t){if(t){if(i.getEmbedMessageProxyService().isEmbedMessageProxyServiceUsed()||i.windowMessageHelper.postErrorLoadReportFailed(),i.pageLoadedEvent){var o=i.prepareEmbedTelemetryErrorDetails(r);i.pageLoadedEvent.reject(o)}}else i.getEmbedMessageProxyService().isEmbedMessageProxyServiceUsed()||i.windowMessageHelper.postReportLoadMessageToParent(),i.pageLoadedEvent&&i.pageLoadedEvent.resolve(),i.services.embedModeService.isAnonymousLiveEmbed()&&i.refreshEnabled&&setInterval((function(){return i.refreshReportData()}),60*i.refreshIntervalInMinutes*1e3)}));var n=this.services.eventBridge.setBubblingScope(r).subscribe(c.saveExploration,(function(e,r){return i.save(e,r)})).subscribe(c.saveAsExploration,(function(e,r){return i.saveAs(e,r)}));this.embedType=this.services.embedModeService.getEmbedTypeDescription(),this.embedUrl=this.services.embedModeService.getPublicEmbedUrl(),this.embedReferrer=this.services.embedModeService.getPublicEmbedReferrer(),this.scope.canvasOptions={autoLayoutVisualPadding:0,scrollbarOffset:0},this.services.embedMessageProxyService.setupController(this),this.scope.$on("$destroy",(function(){n.unsubscribeAll()}))}return o.prototype.loadReport=function(r,o,i,n,s,a,d,c,p){var v=this,m=this.validateOdataFilter(i);return m.then((function(i){var m,g=v.services.promiseFactory.defer(),h=v.services.embedModeService.isAnonymousLiveEmbed(),y=v.services.promiseFactory.resolve(r);if(h&&(y=v.resolveReportIdForAnonymousEmbed(n)),p===v.PowerBIModels.ViewMode.Edit){if(v.services.embedModeService.isAnonymousLiveEmbed())return v.services.promiseFactory.reject(t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage());if(!c)return v.showError(),v.services.promiseFactory.reject(t.HostCommunicationHelper.buildInsufficientPermissionsMessage())}return y.then((function(t){r=t,v.reportObjectId=r,v.fireLoadReportStartUpTelemetry(r),m=v.services.telemetryService.startEvent(e.telemetry.ReportEmbedLoadEmbeddedReport,r,v.embedType,v.embedUrl,v.embedReferrer),v.loadPowerViewReportEventEmitted=!1,v.pageName=s,v.isEditing=p===v.PowerBIModels.ViewMode.Edit,a=a||{},v.createAndSetEmbedExplorationCapabilities(a,c),h?(v.scope.showLogoBar=!0,v.loadReportForAnonymous(r).then((function(){m.resolve(),g.resolve(null)})).catch((function(e){m.reject(e.telemetryError),g.reject(e.hostError)}))):v.services.embedModeService.isAppTokenEmbed()?(v.scope.showLogoBar=!1,v.additionalODataFilter=i,v.additionalJsonFilters=d,v.loadReportForAppToken(r,c,p).then((function(){m.resolve(),g.resolve(null)})).catch((function(e){m.reject(e.telemetryError),g.reject(e.hostError)}))):(v.additionalODataFilter=i,v.additionalJsonFilters=d,v.services.clusterResolverService.getClusterUrl().then((function(e){clusterUri=e.backendUrl,v.initializeReportEmbed(r,u,c,p).then((function(){m.resolve(),g.resolve(null)})).catch((function(e){m.reject(e.telemetryError),g.reject(e.hostError)}))}),(function(e){var r=v.handleLoadFailures(e,b,l.ErrorCodes.reportLoadFailed,null,e&&e.error);m.reject(r.telemetryError),g.reject(r.hostError)})))})).catch((function(t){r="",v.showError(),v.fireLoadReportStartUpTelemetry(r),m=v.services.telemetryService.startEvent(e.telemetry.ReportEmbedLoadEmbeddedReport,r,v.embedType,v.embedUrl,v.embedReferrer),g.reject(t);var o=v.prepareEmbedTelemetryErrorDetails(t.message);o.errorSource=e.telemetry.ErrorSource.User,m.reject(o)})),v.services.activeGroupIdService.activeGroupObjectId=o,g.promise}))},o.prototype.createReport=function(r,o){var i=this;if(this.services.embedModeService.isAnonymousLiveEmbed())return this.services.promiseFactory.reject(t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage());this.loadPowerViewReportEventEmitted=!1,this.reportObjectId=this.exploration=null;var n=this.services.promiseFactory.defer(),s=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedCreateReport,r,this.embedType,this.embedUrl,this.embedReferrer);return this.services.reportEmbedModelService.getModel(r,s).then((function(r){if(!i.services.featureSwitchService.featureSwitches.reportEmbedEditingEnabled){var t=i.handleLoadFailures(null,E,l.ErrorCodes.featureNotSupported);s.reject(t.telemetryError),n.reject(t.hostError)}var a=i.createReportExplorationCapabilities(i.PowerBIModels.Permissions.Create);i.services.explorationCapabilities.setCapabilities(a),i.isEditing=!0,i.useCustomSaveAsDialog=o&&o.useCustomSaveAsDialog,i.loadPowerViewForModel(r),n.resolve(null),s.resolve(),i.scope.$emit(e.constants.openReportFinished)}),(function(e){var r=i.handleLoadFailures(e,g,l.ErrorCodes.createReportFailed,l.ErrorCodes.getDatasetFailed,e&&e.error);
s.reject(r.telemetryError),n.reject(r.hostError)})),n.promise},o.prototype.load=function(e){return loadReport(e.id,e.accessToken,void 0,e.pageName,e.settings,e.filters,e.permissions,e.viewMode,e.tokenType)},o.prototype.create=function(e){return createReport(e.datasetId,e.accessToken,e.settings,e.tokenType)},o.prototype.getPages=function(){if(!this.exploration||!this.exploration.sections)return null;var e=this.exploration.sections.map((function(e){return{name:e.name,displayName:e.displayName}}));return e},o.prototype.setPage=function(o){var i,n=this;if(this.exploration){var s=this.getPageIndexByName(o);s>=0&&(this.scope.$applyAsync((function(){n.scope.$emit(r.constants.switchSectionEvent,s)})),this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSwitchPage,this.embedType,this.embedUrl,this.embedReferrer))}else i=t.HostCommunicationHelper.buildSetPageFailedMessage();return i},o.prototype.updateSettings=function(e){var r;try{r=this.checkAndUpdateExplorationCapabilities(e)}catch(e){return this.services.promiseFactory.reject({message:l.ErrorMessages.updateSettingsFailed})}var t={filterPaneEnabled:r.showVisualizationPane,navContentPaneEnabled:r.showNavContentPane};return this.services.promiseFactory.resolve(t)},o.prototype.changeViewMode=function(e){var r;if(this.exploration)if(this.services.embedModeService.isAnonymousLiveEmbed())r=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();else{if(!this.services.featureSwitchService.featureSwitches.reportEmbedEditingEnabled)return t.HostCommunicationHelper.buildNotSupportedMessage();e&&this.report.permissions===a.Permissions.Read?r=t.HostCommunicationHelper.buildInsufficientPermissionsMessage():this.isEditing!==e&&(this.isEditing=e,this.updateSettings({navContentPaneEnabled:!!this.isEditing||void 0}),this.services.eventBridge.publishToChannel(c.requestViewModeChange,e?1:0))}else r=t.HostCommunicationHelper.buildToggleViewModeFailedMessage();return r},o.prototype.save=function(e,r){return r&&r.overrideSaveRouting?this.saveReport():this.services.promiseFactory.reject(t.HostCommunicationHelper.buildSaveReportFailedMessage())},o.prototype.saveReport=function(){var e=this.isSaveEnabled();return e?this.services.promiseFactory.reject(e):this.exploration?this.saveReportInternal():this.saveAs(null,{overrideSaveRouting:!0})},o.prototype.saveAs=function(r,t){var o=this;if(t&&t.overrideSaveRouting){var i=this.services.promiseFactory.defer(),n=this.isSaveAsEnabled();return n?(i.reject(n),i.promise):this.useCustomSaveAsDialog?void this.services.eventBridge.publishToChannel(c.customSaveAsTriggered):(e.explore.controllers.showSaveAsDialog(this.services.errorService,this.services.localizationService).then((function(e){var r={name:e};return o.saveReportAsInternal(r).then((function(){i.resolve(null)}),(function(e){return i.reject(e),e}))}),(function(){})),i.promise)}},o.prototype.saveReportAs=function(e){var r=this.isSaveAsEnabled();return r?this.services.promiseFactory.reject(r):this.saveReportAsInternal(e)},o.prototype.setAccessToken=function(e){return setAccessToken(e)?null:t.HostCommunicationHelper.buildInvalidAccessTokenMessage()},o.prototype.getEmbedMessageProxyService=function(){return this.services.embedMessageProxyService},o.prototype.validateOdataFilter=function(r){return __awaiter(this,void 0,e.Promise,(function(){var t,o,i;return __generator(this,(function(n){switch(n.label){case 0:if(!r)return[3,4];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.loadODataFilterDependencies()];case 2:return n.sent(),t=e.explore.odata.createODataFilterParser(),o=t.tryGetFilters(r),_.isEmpty(o)&&this.services.embedMessageProxyService.postErrorInvalidFilter(),[3,4];case 3:return i=n.sent(),this.services.embedMessageProxyService.postErrorInvalidFilter(),[2,""];case 4:return[2,r]}}))}))},o.prototype.loadODataFilterDependencies=function(){return __awaiter(this,void 0,e.Promise,(function(){var e;return __generator(this,(function(r){switch(r.label){case 0:return e=this.services.moduleLoader,[4,this.services.promiseFactory.all([e.require({javascript:"odataFilterParser"}),e.require({javascript:"odataExplore"})])];case 1:return r.sent(),[2]}}))}))},o.prototype.fireLoadingEventAndFlush=function(r){var t=this.services.telemetryService;t.logEvent(e.telemetry.ReportEmbedLoadingStarted,r,this.embedType,this.embedUrl,this.embedReferrer);var o=this.services.promiseFactory.defer();o.promise.then((function(){t&&t.flush()})),o.resolve(null)},o.prototype.loadReportForAnonymous=function(e){var r=this,t=this.services.promiseFactory.defer();return jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)?t.reject(this.handleLoadFailures(null,f,l.ErrorCodes.reportLoadFailed,l.ErrorCodes.invalidReportObjectId)):this.getClusterUriIfTenantIdExists(this.targetTenantId,clusterUri).then((function(i){clusterUri=o.getAPIMHostUrl(i),r.initializeReportEmbed(e,S).then((function(){t.resolve(null)})).catch((function(e){t.reject(e)}))})),t.promise},o.prototype.resolveReportIdForAnonymousEmbed=function(r){var t=jsCommon.QueryStringUtil.parseQueryString(r),o=void 0;t.k?o=t.k:t.key&&(o=t.key);var i="",n=t.r;if(this.targetTenantId=void 0,n){var s=void 0;try{s=JSON.parse(atob(n))}catch(e){i=e}s&&(s.t&&(this.targetTenantId=s.t),s.k?o=s.k:i="Wrong format of encoded report - JSON object  doesn't contain a key")}return t.refresh&&(this.refreshEnabled=!0,this.refreshIntervalInMinutes=parseInt(t.refresh,10),(_.isNaN(this.refreshIntervalInMinutes)||this.refreshIntervalInMinutes<=l.minimumReportDataRefreshIntervalInMinutes)&&(this.refreshIntervalInMinutes=l.minimumReportDataRefreshIntervalInMinutes)),jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(o)?(i=f+i,this.services.telemetryService.logEvent(e.telemetry.ReportEmbedInvalidReportResourceKey,i),this.services.promiseFactory.reject({message:i})):(window.powerBIAccessToken=o,window.powerBIResourceKey=o,this.services.promiseFactory.resolve(o))},o.prototype.fireLoadReportStartUpTelemetry=function(r){if("number"==typeof window.viewLoadingStarted){var t=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedScriptLoaded,r,this.embedType,this.embedUrl,this.embedReferrer);t.event.time=window.viewLoadingStarted,t.resolve(),this.pageLoadedEvent=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedPageLoaded,r,this.embedType,this.embedUrl,this.embedReferrer),this.pageLoadedEvent.event.time=window.viewLoadingStarted}this.fireLoadingEventAndFlush(r)},o.prototype.loadReportForAppToken=function(e,r,t){var o=this,i=this.services.promiseFactory.defer();return jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e)?i.reject(this.handleLoadFailures(null,h,l.ErrorCodes.reportLoadFailed,l.ErrorCodes.invalidReportObjectId)):this.services.featureSwitchService.featureSwitches.paasDynamicRoutingEnabled?this.services.clusterResolverService.getClusterUrl().then((function(n){clusterUri=n.backendUrl,o.initializeReportEmbed(e,m,r,t).then((function(){i.resolve(null)})).catch((function(e){i.reject(e)}))}),(function(e){i.reject(o.handleLoadFailures(e,y,l.ErrorCodes.reportLoadFailed,null,e&&e.error))})):this.initializeReportEmbed(e,m,r,t).then((function(){i.resolve(null)})).catch((function(e){i.reject(e)})),i.promise},o.prototype.handleLoadFailures=function(e,r,o,i,n){var s=e&&e.httpStatusCode,a=e&&e.error,d=this.prepareEmbedTelemetryErrorDetails(r,a,s);return this.showError(n),{hostError:t.HostCommunicationHelper.buildLoadFailedError(o,e,i),telemetryError:d}},o.prototype.initializeReportEmbed=function(e,r,t,o){var i=this,n=this.services.promiseFactory.defer();return this.services.embedModeService.isAnonymousLiveEmbed()||this.services.embedModeService.isAppTokenEmbed()||this.services.userServicePlanMetadata.isPremiumUser().then((function(e){return i.scope.showLogoBar=!e}),(function(e){return i.scope.showLogoBar=!1})),this.services.reportEmbedExplorationService.getModelsAndExploration(e).then((function(e){return 1!==o||i.services.featureSwitchService.featureSwitches.reportEmbedEditingEnabled?(i.loadPowerViewReport(e,t,o),void n.resolve(null)):n.reject(i.handleLoadFailures(null,E,l.ErrorCodes.featureNotSupported))}),(function(e){n.reject(i.handleLoadFailures(e,r,l.ErrorCodes.reportLoadFailed,l.ErrorCodes.getReportFailed,e&&e.error))})),n.promise},o.prototype.loadPowerViewReport=function(e,r,t){var o=this;this.scope.exploreContainer=p.ViewModelFactory.createExplorationContainer(),this.exploration=e.exploration,this.model=this.createModel(e.models[0]),this.report.id=this.exploration.reportId,this.report.objectId=this.reportObjectId,this.setReportContainer(this.report,r);var i=t===this.PowerBIModels.ViewMode.Edit;this.services.$timeout((function(){return o.emitLoadPowerViewReportEvent(i?v.Exploration:v.None)}),0)},o.prototype.loadPowerViewForModel=function(e){var r=this;this.scope.exploreContainer=p.ViewModelFactory.createExplorationContainer(),this.model=this.createModel(e),this.setReportContainer(this.model.contract,this.PowerBIModels.Permissions.Create),this.services.$timeout((function(){return r.emitLoadPowerViewReportEvent(v.Exploration)}),0)},o.prototype.setReportContainer=function(e,r){var t=this.createReportModel(e,r);t.model=this.model,this.reportContainer=this.services.modelConverter.convertReportContainer(e),this.reportContainer.report=t},o.prototype.showError=function(e){var r="ReportEmbed_Default_Error_Message";if(e)switch(e.code){case"AppNotEnabled":r="ReportEmbed_Insufficient_Plan_Error_Message";break;case"UserNotLicensed":r="ReportEmbed_User_Not_Licensed_Error_Message";break;default:r="ReportEmbed_Default_Error_Message"}this.scope.errorMessage=this.services.localizationService.get(r),this.scope.showErrorMessage=!0,this.hideLoadingSplash()},o.prototype.showModalError=function(r,t,o,i){this.services.errorService.error(t,o,{requestId:r?r.requestId:void 0,customErrorDialogHelperText:i},!1,e.telemetry.ErrorSource.PowerBI)},o.prototype.emitLoadPowerViewReportEvent=function(e){if(!this.loadPowerViewReportEventEmitted){var r;if(this.exploration){var t={featureUsage:{}};r=this.services.explorationSerializer.deepCopyExploration(this.exploration,t),r.report=this.exploration.report}this.loadPowerViewReportEventEmitted=!0;var o={report:this.reportContainer.report,model:this.model,instantiationMode:e,exploration:r,additionalODataFilter:this.additionalODataFilter,reportPage:this.pageName,additionalJsonFilters:this.additionalJsonFilters};this.hideLoadingSplash(),this.scope.$emit(n.loadPowerViewReportEventName,o)}},o.prototype.createModel=function(e){var r=this,t=this.services.modelConverter.convertModel(e);return t.getPermissionsCallback=function(){return r.services.featureSwitchService.featureSwitches.reportEmbedEditingEnabled?a.Permissions.ReadWrite:a.Permissions.Read},t},o.prototype.createReportModel=function(e,r){var t=this,o=this.services.modelConverter.convertReport(e);return this.report.permissions=this.convertReportPermissions(r),o.getPermissionsCallback=function(){return t.report.permissions},this.services.modelConverter.fillReport(o,e),o},o.prototype.convertReportPermissions=function(e){var r=a.Permissions.Read;return(i.hasFlag(e,this.PowerBIModels.Permissions.Create)||i.hasFlag(e,this.PowerBIModels.Permissions.Copy))&&(r|=a.Permissions.Explore),i.hasFlag(e,this.PowerBIModels.Permissions.ReadWrite)&&(r|=a.Permissions.ReadWrite),i.hasFlag(e,this.PowerBIModels.Permissions.All)&&(r=a.Permissions.All),r},o.prototype.hideLoadingSplash=function(){var e=angular.element("#pbi-loading");0!==e.length&&e.remove()},o.prototype.getClusterUriIfTenantIdExists=function(e,r){return e?this.getClusterUriForTenant(e,r):this.services.promiseFactory.resolve(r)},o.prototype.getClusterUriForTenant=function(e,r){var t=this.services.promiseFactory.defer(),i=o.getAPIMHostUrl(r);return this.services.clusterResolverService.getPublicClusterForTenant(e,i).then((function(e){return t.resolve(e.backendUrl)}),(function(e){return t.reject()})),t.promise},o.getAPIMHostUrl=function(e){var r=jsCommon.Utility.getProtocolFromUrl(e),t=jsCommon.Utility.getHostNameForUrl(e),o=t.split(".");o[0]=o[0].replace("-redirect",""),o[0]=o[0].replace("global-",""),o[0]=o[0]+"-api";var i=o.join(".");return r+"://"+i},o.prototype.prepareEmbedTelemetryErrorDetails=function(r,t,o){var i=void 0;t&&(i=d.getTelemetryErrorDetails(t,o),r+=" message: "+t.code),o&&(r+=" HttpStatusCode: "+o);var n={errorSource:i?i.errorSource:e.telemetry.ErrorSource.PowerBI,errorCode:r};return n},o.prototype.getPageIndexByName=function(e){return this.exploration&&this.exploration.sections?this.exploration.sections.map((function(e){return e.name})).indexOf(e):-1},o.prototype.refreshReportData=function(){this.scope.$emit(n.refreshReportData)},o.prototype.getPageByName=function(e){var r,t=this.exploration&&this.exploration.sections?this.exploration.sections.filter((function(r){return r.name===e})):null;return t&&t.length>0&&(r={name:t[0].name,displayName:t[0].displayName}),r},o.prototype.createAndSetEmbedExplorationCapabilities=function(e,r){var t=this.getEmbedCommonCapabilities(r);return this.services.explorationCapabilities.setCapabilities(t),e&&(t=this.checkAndUpdateExplorationCapabilities(e),this.useCustomSaveAsDialog=e.useCustomSaveAsDialog),t},o.prototype.checkAndUpdateExplorationCapabilities=function(e){if(e){var r=this.services.explorationCapabilities.getCapabilities();return r.showVisualizationPane=void 0!==e.filterPaneEnabled?e.filterPaneEnabled:r.showVisualizationPane,r.showNavContentPane=void 0!==e.navContentPaneEnabled?e.navContentPaneEnabled:r.showNavContentPane,r.showAppBar=this.isEditing,this.services.explorationCapabilities.setCapabilities(r),this.useCustomSaveAsDialog=void 0!==e.useCustomSaveAsDialog?e.useCustomSaveAsDialog:this.useCustomSaveAsDialog,r}},o.prototype.saveReportInternal=function(){var r=this,o=this.exploration,i=this.reportObjectId,n=this.scope.exploreContainer.exploration.contract,a=o.reportId;if(e.helpers.ReportUtility.HasUnsupportedExploreVisuals(n,this.services.visualPlugin))return this.services.promiseFactory.reject(t.HostCommunicationHelper.buildSaveReportFailedMessage());this.showSaveMask();var d=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedSaveExploration,i,this.embedType,this.embedUrl,this.embedReferrer);return this.services.reportEmbedExplorationService.save(o,n,a).then((function(t){if(!t)return void d.reject();r.reportContainer.report.contract.hasExploration=!0;var o=r.reportContainer.report;return o&&o.isUsedByContentPack&&r.scope.$emit(e.constants.contentPackDirtyShowNotification,a,s.Report),r.onSaveSuccess(t,r.reportObjectId,!1,d)}),(function(e){return r.onSaveFailure(r.reportObjectId,!1,d,void 0,e)}))},o.prototype.saveReportAsInternal=function(r){var o=this,i=this.reportObjectId,n=this.scope.exploreContainer.exploration.contract;if(e.helpers.ReportUtility.HasUnsupportedExploreVisuals(n,this.services.visualPlugin))return this.services.promiseFactory.reject(t.HostCommunicationHelper.buildSaveReportFailedMessage());this.showSaveMask();var s=this.services.telemetryService.startEvent(e.telemetry.ReportEmbedSaveAsExploration,this.useCustomSaveAsDialog,i,this.embedType,this.embedUrl,this.embedReferrer);return this.services.reportEmbedExplorationService.saveAs(n,r.name,this.model.id,this.model.packageId).then((function(e){if(!e)return void o.onSaveFailure(o.reportObjectId,!0,s,void 0);o.reportContainer.report.contract.hasExploration=!0;var t=e.report?e.report.objectId:o.reportObjectId;return o.onSaveSuccess(e,t,!0,s,r.name)}),(function(e){return o.onSaveFailure(o.reportObjectId,!0,s,void 0,e)}))},o.prototype.publishSaveReportCompleted=function(e,r,t,o){var i={reportObjectId:e,reportName:t,saveAs:r,error:o,originalReportObjectId:r?this.reportObjectId:void 0};this.services.eventBridge.publishToChannel(c.saveReportCompleted,i)},o.prototype.isSaveAsEnabled=function(){return this.services.embedModeService.isAnonymousLiveEmbed()?t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage():this.model?this.services.featureSwitchService.featureSwitches.reportEmbedEditingEnabled?null:t.HostCommunicationHelper.buildSaveNotSupportedMessage():t.HostCommunicationHelper.buildSaveReportFailedMessage()},o.prototype.isSaveEnabled=function(){return this.isEditing?this.services.embedModeService.isAnonymousLiveEmbed()?t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage():this.exploration&&!this.services.featureSwitchService.featureSwitches.reportEmbedEditingEnabled?t.HostCommunicationHelper.buildSaveNotSupportedMessage():null:t.HostCommunicationHelper.buildSaveReportNotAllowedInViewModeMessage()},o.prototype.onSaveSuccess=function(r,t,o,i,n){this.synchronizeExplorationIds(r,this.scope.exploreContainer.exploration.contract);var s={featureUsage:{}},a=this.services.explorationSerializer;this.exploration=a.deepCopyExploration(r,s),this.exploration&&(this.exploration.report=r.report),this.scope.$emit(e.common.constants.onReportChangedEventName,!1),this.publishSaveReportCompleted(t,o,n),i.resolve(),this.hideSaveMask()},o.prototype.onSaveFailure=function(r,o,i,n,s){var a=s&&s.httpStatusCode===e.HttpStatusCode.Unauthorized?"ReportEmbed_ErrorDialogHelperText_Permissions":"ErrorDialogHelperText";this.showModalError(s,this.services.localizationService.get("ExplorationContainer_FailedToSaveReport"),"ExplorationContainer_FailedToSaveReportDefaultDetails",this.services.localizationService.get(a)),i.reject(this.prepareEmbedTelemetryErrorDetails(l.ErrorCodes.saveReportFailed,s?s.error:null,s?s.httpStatusCode:null));var d=t.HostCommunicationHelper.buildSaveReportFailedMessage();return this.publishSaveReportCompleted(r,o,n,d),this.hideSaveMask(),d},o.prototype.synchronizeExplorationIds=function(e,t){t.id=e.id,t.reportId=e.reportId,r.SectionUtils.synchronizeSectionsIds(e.sections,t.sections)},o.prototype.showSaveMask=function(){this.scope.exploreContainer.showMask=!0},o.prototype.hideSaveMask=function(){this.scope.exploreContainer.showMask=!1},o.prototype.createReportExplorationCapabilities=function(e){var r=this.getEmbedCommonCapabilities(e);return r.showAppBar=!0,r},o.prototype.getEmbedCommonCapabilities=function(e){var r=this.services.explorationCapabilities.getCapabilities(),t=this.services.embedModeService.isAnonymousLiveEmbed(),o=this.services.embedModeService.isSaasEmbed();return r.customVisualsAlwaysEnabled=t,r.showTaskPane=!0,r.visualContainerOptions={showMenu:!t,showPin:!1,disablePin:!1,showContextMenu:!0},r.showBackButtonOnAppBar=!1,r.disableLinguisticSchemaInitialization=!0,r.disableLogRTelemetry=!0,r.disableSaveOnKeyPress=!0,r.disableExport=t,r.disableExportToPowerPoint=!0,r.disableMoreOptions=!0,r.disableSnapshot=!0,r.disableSharePointEmbed=!0,r.disablePin=!0,r.disableQRGeneration=!0,r.disableSave=!i.hasFlag(e,this.PowerBIModels.Permissions.ReadWrite),r.disableSaveAs=!i.hasFlag(e,this.PowerBIModels.Permissions.Copy)&&!i.hasFlag(e,this.PowerBIModels.Permissions.Create),r.disablePrint=!0,r.disableDownload=!0,r.disableExploreActions=!1,r.disableSwitchMode=!0,r.overrideSaveRouting=!0,r.disableCustomVisualPluginActions=!0,r.disableExportToExcel=!o,r.disableViewRelatedContent=!0,r},o})();o.ReportEmbedController=I})(o=t.controllers||(t.controllers={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t="mailto:someone@example.com?subject=Sharing%20Power%20BI%20Report&body=Hi%2C%0D%0A%0D%0ATake%20a%20look%20at%20this%20Power%20BI%20report%20I%E2%80%99d%20like%20to%20share%20with%20you.%0D%0A%0D%0AURL%20to%20embedded%20content%3A%0D%0A%7B%7BembedUrl%7D%7D%0D%0A%0D%0A---------------------------%0D%0APowered%20by%20Power%20BI%20%0D%0Awww.powerbi.com",o=(function(){function r(e,r){var t=this;this.windowSpec="menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=600",this.scope=e,this.services=r,this.scope.reportEmbedExplorationService=this.services.reportEmbedExplorationService,this.scope.$watch("reportEmbedExplorationService.exploration.sections",(function(e){_.isArray(e)&&(t.sectionNames=e.map((function(e){return e.name})))})),this.scope.$watch("reportEmbedExplorationService.exploration.activeSectionIndex",(function(e){_.isNumber(e)&&(t.currentPageNumber=e||0,t.prepareShareLinks())})),this.scope.closeSocialSharing=function(){return t.closeSocialSharing()},this.scope.toggleSocialSharing=function(){return t.toggleSocialSharing()},this.scope.openUsingWindow=function(e){return t.openUsingWindow(e)},this.embedType=this.services.embedModeService.getEmbedTypeDescription(),this.embedUrl=this.services.embedModeService.getPublicEmbedUrl(),this.embedReferrer=this.services.embedModeService.getPublicEmbedReferrer()}return r.createOptions=function(){return{additionalServices:["reportEmbedExplorationService","$window","$document","$element","telemetryService","embedModeService"]}},r.prototype.toggleSocialSharing=function(){this.scope.socialSharingVisible=!this.scope.socialSharingVisible,this.scope.isSmallScreen&&this.emitSocialSharingOverlayEvent()},r.prototype.closeSocialSharing=function(){this.scope.socialSharingVisible=!1,this.scope.isSmallScreen&&this.emitSocialSharingOverlayEvent()},r.prototype.emitSocialSharingOverlayEvent=function(){this.scope.$emit(e.explore.reportembed.constants.showSocialSharingOverlayEventName,this.scope.socialSharingVisible)},r.prototype.prepareShareLinks=function(){this.setShareLink(),this.setSharingEmailLink()},r.prototype.setShareLink=function(){var e=this.getPageLink();this.scope.textShareLink=e,this.scope.shareLink=encodeURIComponent(e)},r.prototype.getPageLink=function(){var e=jsCommon.QueryStringUtil.parseQueryString(),r=e.shareUrl,t=this.embedReferrer;return t&&"true"===r?t:this.getEmbedPageUrl(this.embedUrl)},r.prototype.getEmbedPageUrl=function(e){var r="";return this.sectionNames&&this.currentPageNumber<this.sectionNames.length&&(r="&pageName="+this.sectionNames[this.currentPageNumber]),e+r},r.prototype.setSharingEmailLink=function(){this.scope.socialSharingEmailLink=t.replace("%7B%7BembedUrl%7D%7D",this.scope.shareLink)},r.prototype.openUsingWindow=function(e){var r=e.currentTarget,t=r.href;this.logSocialSharingEvent(t),this.scope.isSmallScreen||(this.services.$window.open(r.href,"",this.windowSpec),e.stopPropagation(),e.preventDefault())},r.prototype.logSocialSharingEvent=function(r){var t=this.scope.reportEmbedExplorationService.exploration.report.objectId;this.services.telemetryService.logEvent(e.telemetry.ReportEmbedSocialSharing,r,t,this.embedType,this.embedUrl,this.embedReferrer)},r})();r.LogoBarSocialSharingController=o})(t=r.controllers||(r.controllers={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=(function(){function t(){this.restrict="E",this.templateUrl="views/logoBarNavigation.html",this.scope={isSmallScreen:"=",isMediumScreen:"=",mailToLink:"=",showAboutDialog:"&"},this.controller=e.common.createController(r.controllers.LogoBarNavigationController)}return t})();t.LogoBarNavigation=o;var i=(function(){function e(){var e=this;this.restrict="A",this.link=function(r,t,o){var i=o;r.$watch(i.textSlideAnimation,(function(){e.clearAllTimeouts();var o=document.getElementById("flyoutElement");o&&o.setAttribute("flyout-visible",String(r.showOverlay)),t.children("li").each((function(t,o){if(r.showOverlay){var i=setTimeout((function(){$(o).addClass("slideUp").removeClass("slideDown sectionItemHidden")}),Math.min(50*t,500));e.addTimeout(i)}else $(o).removeClass("slideUp").addClass("sectionItemHidden")}))}))}}return e.prototype.addTimeout=function(e){(this.timeoutIDs=this.timeoutIDs||[]).push(e)},e.prototype.clearAllTimeouts=function(){this.timeoutIDs instanceof Array&&this.timeoutIDs.forEach((function(e){"number"==typeof e&&window.clearTimeout(e)}))},e})();t.TextSlideAnimation=i})(t=r.directives||(r.directives={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.reportembed.registerReportEmbedDirective("TextSlideAnimation",[]),powerbi.explore.reportembed.registerReportEmbedDirective("LogoBarNavigation",[]);var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=e.explore.reportembed.constants.CssStyles,i=(function(){function t(){this.restrict="E",this.replace=!0,this.templateUrl="views/logoBar.html",this.controller=e.common.createController(r.controllers.LogoBarController),this.link=function(e){function r(){var r=window.innerWidth>0?window.innerWidth:screen.width,t=window.innerHeight>0?window.innerHeight:screen.height;e.isSmallScreen=r<=o.maxWidthMobileUI||t<=o.maxHeightMobileUI,e.isMediumScreen=!e.isSmallScreen&&(r<=o.maxSizeTabletUI||t<=o.maxSizeTabletUI)}var t=document,i=t.fullscreenEnabled||t.webkitFullscreenEnabled||t.mozFullScreenEnabled||t.msFullscreenEnabled;i||window.setTimeout((function(){var e=document.getElementById("fullScreenIcon");e&&(e.setAttribute("target","_blank"),e.setAttribute("href",document.URL))}),0),r(),window.addEventListener("resize",(function(){r(),e.$apply()}))}}return t})();t.LogoBar=i})(t=r.directives||(r.directives={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.reportembed.registerReportEmbedDirective("LogoBar",[]);var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(t){var o=(function(){function t(){this.restrict="E",this.templateUrl="views/logoBarSocialSharing.html",this.scope=!0,this.controller=e.common.createController(r.controllers.LogoBarSocialSharingController)}return t})();t.LogoBarSocialSharing=o})(t=r.directives||(r.directives={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={})),powerbi.explore.reportembed.registerReportEmbedDirective("LogoBarSocialSharing",[]);var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){function t(e){return new i(e)}var o=e.explore.reportembed.constants;r.getHostCommunicationHelper=t;var i=(function(){function e(e){this.windowService=e}return e.buildErrorMessage=function(e){return{event:o.error,error:e}},e.prototype.postErrorMessageToParent=function(e){var r={event:o.error,error:e};this.windowService.parent.postMessage(JSON.stringify(r),"*")},e.prototype.postReportLoadMessageToParent=function(){var e={event:o.reportPageLoaded,error:""};this.windowService.parent.postMessage(JSON.stringify(e),"*")},e.prototype.postErrorLoadReportFailed=function(){this.postErrorMessageToParent(o.ErrorCodes.reportLoadFailed)},e.buildWindowPostErrorMessage=function(e){return{message:e}},e.buildNotSupportedMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorCodes.featureNotSupported)},e.buildSaveNotSupportedMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorCodes.saveReportNotSupported)},e.buildLoadFailedError=function(e,r,t){var i={message:e,detailedMessage:t};if(!r)return i;i.technicalDetails={requestId:r.requestId};var n=r.httpStatusCode,s=r.error;if(!s){if(403!==n&&401!==n)return i;s={code:o.ErrorCodes.notAuthorized}}return i.detailedMessage=s.message||t,i.errorCode=s.code,i},e.buildSetPageFailedMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.setPageFailed)},e.buildSetFilterFailedMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.setFilterFailed)},e.buildInvalidFilterMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.invalidFilter)},e.buildNotSupportedByPublishToWebMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.publishToWebNotSupported)},e.buildToggleViewModeFailedMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.changeViewModeFailed)},e.buildSaveReportFailedMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.saveExplorationFailed)},e.buildSaveReportNotAllowedInViewModeMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorCodes.saveReportNotAllowedInViewMode)},e.buildPowerBIEntityNotFoundMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.powerBIEntityNotFound)},e.buildInvalidAccessTokenMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.invalidAccessToken)},e.buildInsufficientPermissionsMessage=function(){return e.buildWindowPostErrorMessage(o.ErrorMessages.insufficientPermissions)},e})();r.HostCommunicationHelper=i})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){function t(r,t,o,i,n){var s=r.search(),a="false"!==s.filterPaneEnabled,d="false"!==s.navContentPaneEnabled,c="true"===s.dynamicDisplayOption?0:void 0;n||(n=e.explore.services.createExplorationCapabilitiesService());var l=!i.isAnonymousLiveEmbed()&&a,p=!i.isAnonymousLiveEmbed()&&d,v=i.isAnonymousLiveEmbed(),u=!i.isAnonymousLiveEmbed(),m=i.isAnonymousLiveEmbed(),g=!i.isSaasEmbed();return n.setCapabilities({showAppBar:!1,showTaskPane:!0,customVisualsAlwaysEnabled:v,showVisualizationPane:l,showNavContentPane:p,visualContainerOptions:{showMenu:u,showPin:!1,disablePin:!1,showContextMenu:!0},showBackButtonOnAppBar:!1,disableExport:m,disableLinguisticSchemaInitialization:!0,disableLogRTelemetry:!0,disableSaveOnKeyPress:!0,overrideDisplayOption:c,disableExportToExcel:g}),n}r.createOrUpdateEmbedExplorationCapabilities=t})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=(function(){function r(e,r,t){this.promiseFactory=e,this.httpService=r,this.telemetryService=t}return r.prototype.getClusterUrl=function(){var e=this,r=this.promiseFactory.defer(),t="metadata/cluster";if(this.clusterUrl)r.resolve(this.clusterUrl);else{var o={dismissGroupObjectId:!0};this.httpService.get(t,this.httpService.powerbiRequestOptions(null,null,o)).then((function(t){e.clusterUrl=t.data,r.resolve(e.clusterUrl)}),(function(e){r.reject({error:e.error,requestId:e.requestId,httpStatusCode:e.status})}))}return r.promise},r.prototype.getPublicClusterForTenant=function(r,t){var o,i,n=this.promiseFactory.defer(),s=window.clusterResolutionFrontLoadStartTime?new Date(window.clusterResolutionFrontLoadStartTime).toISOString():null,a=window.clusterResolutionFrontLoadEndTime?new Date(window.clusterResolutionFrontLoadEndTime).toISOString():null;if(jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(window.resolvedClusterUri)){jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(window.resolveClusterError)||(o=this.telemetryService.startEvent(e.telemetry.ReportEmbedClusterResolved,!0,void 0,s,a),i={errorSource:e.telemetry.ErrorSource.PowerBI,errorCode:"Front loaded resolver failed:"+window.resolveClusterError},o.reject(i));var d="public/routing/cluster/"+r,c=jsCommon.Utility.urlCombine(t,d);o=this.telemetryService.startEvent(e.telemetry.ReportEmbedClusterResolved,!1,void 0,s,a),this.httpService.get(c,this.httpService.powerbiRequestOptions()).then((function(e){o.event.info.backendUrl=e.data.FixedClusterUri,o.resolve(),n.resolve({backendUrl:e.data.FixedClusterUri})}),(function(r){var t="requestId:"+r.requestId;i={errorSource:e.telemetry.ErrorSource.PowerBI,errorCode:r.error?r.error.message+t:t,httpStatusCode:r.status},o.reject(i),n.reject({error:r.error,requestId:r.requestId})}))}else o=this.telemetryService.startEvent(e.telemetry.ReportEmbedClusterResolved,!0,window.resolvedClusterUri,s,a),o.resolve(),n.resolve({backendUrl:window.resolvedClusterUri});return n.promise},r})();r.ClusterResolverService=t})(t=r.services||(r.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){function i(e,r,t,i,n,s,a,d,c,l,p){return new o.ReportEmbedMessageProxyService(e,r,t,i,n,s,a,d,c,l,p)}var n=e.explore.reportembed.constants,s=jsCommon.StringExtensions,a=e.common.events,d=(function(){function o(r,t,o,i,s,a,d,c,l,p,v){this.requestId=n.defaultId,this.PowerBIModels=window["powerbi-models"],this.rootScope=r,this.eventBridge=p,
this.windowService=t,this.windowPostMessageProxy=o,this.httpPostMessage=i,this.router=s,this.reportEmbedFilterService=v,this.promiseFactory=c,this.jsonFilterParser=e.explore.jsonFilter.createJSONFilterParser(c),this.embedModeService=a,this.conceptualSchemaProxy=d,this.telemetryService=l,this.nextAllowedRefreshTime=new Date(1970,1,1).getTime()}return o.prototype.startListening=function(){var o=this;this.setupRoutes(this.router),this.eventBridge.createChannelSubscriptionManager().subscribe(r.services.events.sectionChanged,(function(e,r){return o.onSectionChange(r)})).subscribe(r.services.events.dataPointsSelected,(function(e,r){return o.onDataPointsSelection(r)})).subscribe(r.services.events.saveReportCompleted,(function(e,r){return o.onReportSave(r)})).subscribe(r.services.events.customSaveAsTriggered,(function(e){return o.onSaveDialogRequested()})),this.rootScope.$on(e.constants.openReportFinished,(function(e,r,t){return o.onReportLoaded(t)})),this.rootScope.$on(t.constants.reportRenderFinished,(function(e,r,t){return o.onReportRendered(t)})),this.rootScope.$on(a.loadPowerViewReportEventName,(function(e,r){o.exploration=r.exploration}))},o.prototype.setupController=function(e){this.embedController=e},o.prototype.setupRoutes=function(r){var o=this;r.post("/report/load",(function(r,t){o.requestId=r.headers.uid;var i=r.body,s=o.validateLoad(i);if(s)t.send(n.StatusCodes.BadRequest,s);else{o.embedController.load(i).catch((function(r){o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,i.id,o.embedModeService.getEmbedTypeDescription(),r.message),o.httpPostMessage.post("/reports/"+o.requestId+"/events/error",r)})),o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKLoadReport,o.requestId,i.id,o.embedModeService.getEmbedTypeDescription());var a=o.requestId?void 0:n.WarningMessages.loadReportUIDMissingWarning;t.send(n.StatusCodes.Accepted,a)}})),r.post("/report/create",(function(r,t){o.requestId=r.headers.uid;var i=r.body,s=o.validateCreateReport(i);if(s)return t.send(n.StatusCodes.BadRequest,s);o.embedController.create(i).catch((function(r){o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,i.datasetId,o.embedModeService.getEmbedTypeDescription(),r.message),o.httpPostMessage.post("/reports/"+o.requestId+"/events/error",r)}));var a=o.requestId?void 0:n.WarningMessages.createReportUIDMissingWarning;return t.send(n.StatusCodes.Accepted,a)})),r.get("/report/pages",(function(r,t){var i=o.embedController.getPages();return void 0!==i?(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetAllPages,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),t.send(n.StatusCodes.OK,i)):(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),n.ErrorMessages.getAllPagesFailed),t.send(n.StatusCodes.InternalServerError,n.ErrorMessages.getAllPagesFailed))})),r.put("/report/pages/active",(function(r,t){var i=r.body,s=o.validatePage(i);if(s)t.send(n.StatusCodes.BadRequest,s);else{var a=o.embedController.setPage(i.name);a&&(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),a.message),o.httpPostMessage.post("/reports/"+o.requestId+"/events/error",a)),o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetActivePage,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),t.send(n.StatusCodes.Accepted)}})),r.put("/report/filters",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}var a=r.body,d=o.validateFilters(a);return d?void i.send(n.StatusCodes.BadRequest,d):o.reportEmbedFilterService.setFilters(a).then((function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetReportLevelFilters,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.Accepted)}),(function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),r.message),i.send(n.StatusCodes.BadRequest,r)}))})),r.get("/report/filters",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}return o.reportEmbedFilterService.getFilters().then((function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetReportLevelFilters,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.OK,r)}),(function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),r.message),i.send(n.StatusCodes.BadRequest,r)}))})),r.put("/report/pages/:pageName/filters",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}var a=r.params.pageName,d=r.body,c={type:"page",name:a},l=o.validatePageLevel(c);if(l)i.send(n.StatusCodes.BadRequest,l);else{var p=o.validateFilters(d);if(!p)return o.reportEmbedFilterService.setFilters(d,c).then((function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetPageLevelFilters,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.Accepted)}),(function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),r.message),i.send(n.StatusCodes.BadRequest,r)}));i.send(n.StatusCodes.BadRequest,p)}})),r.get("/report/pages/:pageName/filters",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}var a=r.params.pageName,d={type:"page",name:a},c=o.validatePageLevel(d);return c?void i.send(n.StatusCodes.BadRequest,c):o.reportEmbedFilterService.getFilters(d).then((function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKGetPageLevelFilters,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.OK,r)}),(function(r){return o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),r.message),i.send(n.StatusCodes.BadRequest,r)}))})),r.patch("/report/settings",(function(r,t){o.requestId=r.headers.uid;var i=r.body,s=o.validateSettings(i);return s?void t.send(n.StatusCodes.BadRequest,s):(o.embedController.updateSettings(i).then((function(r){o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKUpdateSettings,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),o.httpPostMessage.post("/reports/"+o.requestId+"/events/settingsUpdated",r)}),(function(r){o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription(),r.message),o.httpPostMessage.post("/reports/"+o.requestId+"/events/error",r)})),void t.send(n.StatusCodes.Accepted))})),r.post("/report/print",(function(e,r){window.print(),r.send(n.StatusCodes.Accepted)})),r.post("/report/refresh",(function(e,r){var t=Date.now();if(t>o.nextAllowedRefreshTime)o.embedController.refreshReportData(),o.nextAllowedRefreshTime=t+1e3*n.ThrottlingLimits.refreshFrequencyInSeconds,r.send(n.StatusCodes.Accepted);else{var i={message:s.format(n.ErrorMessages.tooManyRefreshRequests,n.ThrottlingLimits.refreshFrequencyInSeconds.toString())};r.headers={"Retry-After":Math.ceil((o.nextAllowedRefreshTime-t)/1e3)},r.send(n.StatusCodes.TooManyRequests,i)}})),r.post("/report/switchMode/:viewMode",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}var a=r.params.viewMode;if(null==a||"edit"!==a.toLowerCase()&&"view"!==a.toLowerCase())return i.send(n.StatusCodes.BadRequest,n.ErrorMessages.invalidViewMode);var d="edit"===a.toLowerCase(),c=o.embedController.changeViewMode(d);return c?(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.BadRequest,c)):(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKChangeViewMode,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.OK))})),r.post("/report/save",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}o.embedController.saveReport().catch((function(r){o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),o.httpPostMessage.post("/reports/"+o.requestId+"/events/error",r)})),o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSaveExploration,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription());var a=o.requestId?void 0:n.WarningMessages.loadReportUIDMissingWarning;return i.send(n.StatusCodes.Accepted,a)})),r.post("/report/saveAs",(function(r,i){if(o.embedModeService.isAnonymousLiveEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedByPublishToWebMessage();return i.send(n.StatusCodes.BadRequest,s)}var a=r.body,d=o.validateSaveAsParameters(a);return d?i.send(n.StatusCodes.BadRequest,d):(o.embedController.saveReportAs(a).catch((function(r){o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,a.name,o.embedModeService.getEmbedTypeDescription()),o.httpPostMessage.post("/reports/"+o.requestId+"/events/error",r)})),o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSaveAsExploration,o.requestId,a.name,o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.Accepted))})),r.post("/report/token",(function(r,i){if(!o.embedModeService.isAppTokenEmbed()){var s=t.HostCommunicationHelper.buildNotSupportedMessage();return i.send(n.StatusCodes.BadRequest,s)}var a=r.body,d=o.embedController.setAccessToken(a);return d?(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKError,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.BadRequest,d)):(o.telemetryService.logEvent(e.telemetry.ReportEmbedSDKSetAccessToken,o.requestId,o.getReportObjectId(),o.embedModeService.getEmbedTypeDescription()),i.send(n.StatusCodes.Accepted))}))},o.prototype.onDataPointsSelection=function(e){var r=this;this.getConceptualSchema().then((function(t){r.jsonFilterParser.tryGetSelectedDataPoints(r.exploration,t,e).then((function(e){e&&r.httpPostMessage.post("/reports/"+r.requestId+"/events/dataSelected",e)})).catch((function(e){r.httpPostMessage.post("/reports/"+r.requestId+"/events/error",e)}))}))},o.prototype.onReportSave=function(e){e.error?this.httpPostMessage.post("/reports/"+this.requestId+"/events/error",e.error):this.httpPostMessage.post("/reports/"+this.requestId+"/events/saved",e)},o.prototype.onSaveDialogRequested=function(){this.httpPostMessage.post("/reports/"+this.requestId+"/events/saveAsTriggered",{})},o.prototype.getReportObjectId=function(){return this.exploration&&this.exploration.report?this.exploration.report.objectId:n.ErrorCodes.missingReportId},o.prototype.validateLoad=function(e){var r=this.PowerBIModels.validateReportLoad(e);return!r&&e.settings&&(r=this.validateSettings(e.settings)),r},o.prototype.validateSettings=function(e){return this.PowerBIModels.validateSettings(e)},o.prototype.validatePage=function(e){var r=this.PowerBIModels.validatePage(e);if(!r){var t=this.embedController.getPageIndexByName(e.name);t<0&&(r=[{message:n.ErrorMessages.invalidPageName}])}return r},o.prototype.validateFilters=function(e){for(var r,t=0,o=e;t<o.length;t++){var i=o[t],n=this.PowerBIModels.validateFilter(i);n&&(r=r||[],r=r.concat(n))}return r},o.prototype.validatePageLevel=function(e){var r,t=this.embedController.getPageIndexByName(e.name);return t<0&&(r=[],r.push({message:n.ErrorMessages.invalidPageName})),r},o.prototype.validateSaveAsParameters=function(e){return this.PowerBIModels.validateSaveAsParameters(e)},o.prototype.validateCreateReport=function(e){return this.PowerBIModels.validateCreateReport(e)},o.prototype.postErrorMessageToParent=function(e){var r=t.HostCommunicationHelper.buildErrorMessage(e);window.parent.postMessage(JSON.stringify(r),"*")},o.prototype.postErrorInvalidReportId=function(){this.postErrorMessageToParent(n.ErrorCodes.missingReportId)},o.prototype.postErrorInvalidAccessToken=function(){this.postErrorMessageToParent(n.ErrorCodes.missingAccessToken)},o.prototype.postErrorInvalidFilter=function(){this.postErrorMessageToParent(n.ErrorCodes.filterError)},o.prototype.postErrorReportNotFound=function(){this.postErrorMessageToParent(n.ErrorCodes.notFound)},o.prototype.isEmbedMessageProxyServiceUsed=function(){return this.requestId!==n.defaultId},o.prototype.onSectionChange=function(e){var r=this.embedController.getPageByName(e.name);this.httpPostMessage.post("/reports/"+this.requestId+"/events/pageChanged",{initiator:void 0,newPage:r})},o.prototype.onReportLoaded=function(e){this.isEmbedMessageProxyServiceUsed()&&(e?this.httpPostMessage.post("/reports/"+this.requestId+"/events/error",n.ErrorMessages.loadReportFailed):this.httpPostMessage.post("/reports/"+this.requestId+"/events/loaded",{initiator:void 0}))},o.prototype.onReportRendered=function(r){if(this.isEmbedMessageProxyServiceUsed()){var t=this.getReportObjectId();t!==n.ErrorCodes.missingReportId&&(this.telemetryService.logEvent(e.telemetry.ReportEmbedAllVisualsRendered,this.requestId,t,this.embedModeService.getEmbedTypeDescription(),r),r?this.httpPostMessage.post("/reports/"+this.requestId+"/events/error",n.ErrorMessages.renderReportFailed):this.httpPostMessage.post("/reports/"+this.requestId+"/events/rendered",{initiator:void 0}))}},o.prototype.getConceptualSchema=function(){if(!this.exploration)return this.promiseFactory.reject();var e=this.exploration.dataSources;return this.conceptualSchemaProxy.get(e)},o})();o.ReportEmbedMessageProxyService=d,o.createEmbedMessageProxyService=i})(o=t.services||(t.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=e.errorDetailsHelper,o=e.explore.reportembed.constants,i=(function(){function r(e,r,t,o,i,n,s,a,d,c){this.promiseFactory=e,this.httpService=r,this.telemetryService=t,this.serializer=o,this.embedModeService=i,this.editableFeatureSwitchService=n,this.featureSwitchService=s,this.explorationProxy=a,this.rootScope=d,this.uriPrefix=c,this.isInitialRequest=!0}return r.prototype.getModelsAndExplorationInternal=function(r){var o=this,i=this.embedModeService.getEmbedTypeDescription(),n=this.embedModeService.getPublicEmbedUrl(),s=this.embedModeService.getPublicEmbedReferrer(),a=this.telemetryService.startEvent(e.telemetry.ReportEmbedGetExplorationAndModel,this.uriPrefix,!0,null,!0,window.modelsAndExplorationFrontLoadStartTime?new Date(window.modelsAndExplorationFrontLoadStartTime).toISOString():null,window.modelsAndExplorationFrontLoadEndTime?new Date(window.modelsAndExplorationFrontLoadEndTime).toISOString():null,r,i,n,s),d=this.promiseFactory.defer(),c=this.uriPrefix+"reports/"+r+"/modelsAndExploration";return this.httpService.get(c,this.httpService.powerbiRequestOptions()).then((function(e){return a.event.info.clientAndServerRequestIdMatch=jsCommon.HttpUtils.clientAndServerRequestIdMatch(e),a.event.info.responseRequestId=jsCommon.HttpUtils.getResponseRequestId(e),a.resolve(),o.deserializeModelsAndExploration(e.data,d)}),(function(e){return e&&e.error&&jsCommon.StringExtensions.isNullOrUndefinedOrWhiteSpaceString(e.error.code)&&(e.error.code="Fail to load - Could not retrieve models and explorations."),a.reject(t.getTelemetryErrorDetails(e.error,e.status)),d.reject(e?{error:e.error,requestId:e.requestId,httpStatusCode:e.status}:{})})),d.promise},r.prototype.getModelsAndExploration=function(r){var t=this;if("undefined"!=typeof window.modelsAndExplorationResponse&&this.isInitialRequest!==!1&&this.featureSwitchService.featureSwitches.frontLoadReportEmbedEnabled){this.isInitialRequest=!1;var i=this.promiseFactory.defer();if(window.modelsAndExplorationResponse){if(window.modelsAndExplorationResponse===o.ModelsAndExplorationState.Loading)var n=this.rootScope.$on(o.modelsAndExplorationReadyEventName,(function(){window.modelsAndExplorationResponse!==o.ModelsAndExplorationState.Error?(t.deserializeModelsAndExploration(window.modelsAndExplorationResponse,i),t.logPreloadedModelsAndExplorationTelemetryEvent(r)):e.common.shouldRetryRequest(window.frontLoadStatus)?t.getModelsAndExplorationInternal(r).then((function(e){return i.resolve(e)})).catch((function(e){return i.reject(e)})):(t.logPreloadedModelsAndExplorationTelemetryEvent(r),i.reject({error:window.frontLoadError,httpStatusCode:window.frontLoadStatus})),n()}));else if(window.modelsAndExplorationResponse!==o.ModelsAndExplorationState.Error)this.deserializeModelsAndExploration(window.modelsAndExplorationResponse,i),this.logPreloadedModelsAndExplorationTelemetryEvent(r);else{if(e.common.shouldRetryRequest(window.frontLoadStatus))return this.getModelsAndExplorationInternal(r);this.logPreloadedModelsAndExplorationTelemetryEvent(r),i.reject({error:window.frontLoadError,httpStatusCode:window.frontLoadStatus})}return i.promise}return this.getModelsAndExplorationInternal(r)}return this.getModelsAndExplorationInternal(r)},r.prototype.save=function(e,r,t){return this.explorationProxy.save(e,r,t)},r.prototype.saveAs=function(e,r,t,o){return this.explorationProxy.saveAs(e,r,t,o)},r.prototype.logPreloadedModelsAndExplorationTelemetryEvent=function(r){var t=this.embedModeService.getEmbedTypeDescription(),i=this.embedModeService.getPublicEmbedUrl(),n=this.embedModeService.getPublicEmbedReferrer(),s=this.telemetryService.startEvent(e.telemetry.ReportEmbedGetExplorationAndModel,this.uriPrefix,!window.isModelsAndExplorationCached,window.modelsAndExplorationRequestId,!0,window.modelsAndExplorationFrontLoadStartTime?new Date(window.modelsAndExplorationFrontLoadStartTime).toISOString():null,window.modelsAndExplorationFrontLoadEndTime?new Date(window.modelsAndExplorationFrontLoadEndTime).toISOString():null,r,t,i,n),a=Date.now()-window.modelsAndExplorationFrontLoadEndTime+window.modelsAndExplorationFrontLoadStartTime;s.event.time=a,window.modelsAndExplorationResponse!==o.ModelsAndExplorationState.Error?s.resolve():s.reject(e.errorDetailsHelper.getTelemetryErrorDetails(window.frontLoadError,window.frontLoadStatus))},r.prototype.deserializeModelsAndExploration=function(e,r){var t;t={models:e.models,exploration:null},t.exploration=this.serializer.deserializeExploration(e.exploration,[],!0),this.exploration=t.exploration,this.editableFeatureSwitchService.registerFeatureSwitches(e.featureSwitches||{}),r.resolve(t)},r})();r.ReportEmbedExplorationService=i})(t=r.services||(r.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=e.common,o=(function(){function e(e,r,t){this.promiseFactory=e,this.httpService=r,this.featureSwitchService=t}return Object.defineProperty(e.prototype,"userHasPremiumPlan",{get:function(){return this.userMetadata&&t.contracts.premiumUserServicePlans.indexOf(this.userMetadata.userServicePlan)!==-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userHasFreeTrial",{get:function(){return this.userMetadata&&this.userMetadata.trial&&this.userMetadata.trial.state===t.contracts.TrialState.Enabled},enumerable:!0,configurable:!0}),e.prototype.checkIsPremiumUser=function(){return this.userHasPremiumPlan||this.userHasFreeTrial},e.prototype.isPremiumUser=function(){var e=this,r=this.promiseFactory.defer();if(this.userMetadata)r.resolve(this.checkIsPremiumUser());else{var t="metadata/userserviceplan";this.httpService.get(t,this.httpService.powerbiRequestOptions()).then((function(t){e.userMetadata=t.data,r.resolve(e.checkIsPremiumUser())}),(function(e){return r.reject()}))}return r.promise},e})();r.UserServicePlanService=o})(t=r.services||(r.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){var t=(function(e){function r(r,t){return e.call(this,r,t)||this}return __extends(r,e),r.prototype.inContentListView=function(){return!0},r.prototype.inReportEmbedView=function(){return!0},r})(e.services.MockNavigation);r.ReportEmbedNavigationService=t})(t=r.services||(r.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(t){var o;!(function(o){function i(e,r,t,i){return new o.ReportEmbedFilterService(e,r,t,i)}var n=e.explore.reportembed.constants,s=e.common.events,a=(function(){function e(e,t,o,i){var n=this;this.rootScope=e,this.promiseFactory=t,this.eventBridge=i,this.conceptualSchemaProxy=o,this.jsonFilterParser=r.jsonFilter.createJSONFilterParser(t),this.rootScope.$on(s.loadPowerViewReportEventName,(function(e,r){e.stopPropagation(),n.onLoadPowerViewReport(r)}))}return e.prototype.setFilters=function(e,r){var o=this,i=this.promiseFactory.defer(),n=this.getFilterContainerWithScope(r);if(n&&n.contract){var s=n.contract;this.getConceptualSchema().then((function(r){if(e&&e.length>0){for(var a=[],d=0,c=e;d<c.length;d++){var l=c[d],p=o.jsonFilterParser.tryCreateFilterContainer(s,r,l);if(!p)return i.reject(t.HostCommunicationHelper.buildInvalidFilterMessage());a.push(p)}var v=s.filters;if(s.filters=[],s.filters=a,v)for(var u=0,m=v;u<m.length;u++){var g=m[u];o.raiseFilterChangeEvent(s,n.scopeType,g,0)}if(a)for(var h=0,b=a;h<b.length;h++){var y=b[h];o.raiseFilterChangeEvent(s,n.scopeType,y,1)}}else for(;s.filters&&s.filters.length>0;){var S=s.filters[0];s.filters.splice(0,1),o.raiseFilterChangeEvent(s,n.scopeType,S,0)}i.resolve(null)}),(function(e){i.reject(t.HostCommunicationHelper.buildSetFilterFailedMessage())}))}else i.reject(t.HostCommunicationHelper.buildSetFilterFailedMessage());return i.promise},e.prototype.getFilters=function(e){var r=this,o=this.promiseFactory.defer(),i=this.getFilterContainerWithScope(e);return i&&i.contract?this.getConceptualSchema().then((function(e){r.jsonFilterParser.tryGetFilters(i.contract,e).then((function(e){o.resolve(e)}),(function(e){o.reject(e)}))}),(function(e){o.reject({message:n.ErrorMessages.filtersSerializationError})})):o.reject(t.HostCommunicationHelper.buildSetFilterFailedMessage()),o.promise},e.prototype.onLoadPowerViewReport=function(e){this.exploration=e.exploration},e.prototype.getConceptualSchema=function(){if(this.exploration){var e=this.exploration.dataSources;return this.conceptualSchemaProxy.get(e)}},e.prototype.getFilterContainerWithScope=function(e){var r;if(e&&e.type===n.FilterLevel){var t=e;r={contract:this.getSectionByName(t.name),scopeType:1}}else r={contract:this.exploration,scopeType:2};return r},e.prototype.raiseFilterChangeEvent=function(e,t,o,i){var n={container:e,scopeType:t},s={filter:o,changeType:i,scope:n};this.eventBridge.publishToChannel(r.services.events.filterContainerChanged,s)},e.prototype.getSectionByName=function(e){return this.exploration?_.find(this.exploration.sections,(function(r){return r.name===e})):null},e})();o.ReportEmbedFilterService=a,o.createReportEmbedFilterService=i})(o=t.services||(t.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){var r=(function(){function e(e,r,t,o){this.promiseFactory=e,this.httpService=r,this.editableFeatureSwitchService=t,this.uriPrefix=o}return e.prototype.getModel=function(e,r){var t=this,o=this.promiseFactory.defer();return this.getModelFromDatasetId(e,r.event).then((function(e){var r=e.data;t.editableFeatureSwitchService.registerFeatureSwitches(r.featureSwitches||{}),o.resolve(r.model)}),(function(e){var r={error:e.error,requestId:e.requestId,httpStatusCode:e.status};o.reject(r)})),o.promise},e.prototype.getModelFromDatasetId=function(e,r){var t=this.httpService.powerbiRequestOptions(r,"GetModelAndMetadata"),o=this.uriPrefix+"models/"+e;return this.httpService.get(o,t)},e})();e.ReportEmbedModelService=r})(r=e.services||(e.services={}))})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));var powerbi;!(function(e){var r;!(function(r){var t;!(function(r){var t;!(function(r){function t(e,r,t,o,i){return new n(e,r,t,o,i)}var o=e.data.dsr,i=e.explore.reportembed.constants;r.createConceptualSchemaProxyHttpCommunication=t;var n=(function(){function e(e,r,t,i,n){this.httpService=e,this.promiseFactory=r,this.featureSwitchService=t,this.uri=i,this.$rootScope=n,this.isInitialRequest=!0,this.proxy=o.createConceptualSchemaProxyHttpCommunication(this.httpService,this.promiseFactory,this.uri)}return e.prototype.execute=function(e,r){var t=this;if(r.event.info.endPoint=this.uri,"undefined"!=typeof window.conceptualSchemaResponse&&this.isInitialRequest!==!1&&this.featureSwitchService.featureSwitches.frontLoadReportEmbedEnabled){this.isInitialRequest=!1;var o=this.promiseFactory.defer();if(window.conceptualSchemaResponse){if(window.conceptualSchemaResponse===i.ConceptualSchemaState.Loading)var n=this.$rootScope.$on(i.conceptualSchemaReadyEventName,(function(){window.conceptualSchemaResponse!==i.ConceptualSchemaState.Error?(t.resolvePreloadedConceptualSchema(o),t.logPreloadedConceptualSchemaTelemetryEvent(r)):t.proxy.execute(e,r).then((function(e){return o.resolve(e)})).catch((function(e){return o.reject(e)})),n()}));else{if(window.conceptualSchemaResponse===i.ConceptualSchemaState.Error)return this.proxy.execute(e,r);this.resolvePreloadedConceptualSchema(o),this.logPreloadedConceptualSchemaTelemetryEvent(r)}return o.promise}return this.proxy.execute(e,r)}return this.proxy.execute(e,r)},e.prototype.resolvePreloadedConceptualSchema=function(e){var r={requestId:window.conceptualSchemaResponseRequestId,schemas:window.conceptualSchemaResponse.schemas};e.resolve(r)},e.prototype.logPreloadedConceptualSchemaTelemetryEvent=function(e){var r=Date.now()-window.conceptualSchemaDuration;e.event.time=r,e.event.info.clientAndServerRequestIdMatch=!window.isConceptualSchemaCached,e.event.info.responseRequestId=window.conceptualSchemaResponseRequestId,e.event.info.requestId=window.conceptualSchemaRequestId},e})()})(t=r.services||(r.services={}))})(t=r.reportembed||(r.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={})),angular.module("powerbi.explore.reportembed").run(["$templateCache",function(e){e.put("views/interactiveEmbed.html",'<div><div ng-hide="showErrorMessage" class="landingController"><notification-bar></notification-bar><div class="landingContainer"><notification-toast></notification-toast><div id="reportLandingContainer" class="embeddedLandingRootContent reportContainerContent isActive embeddedPV" ng-class="showLogoBar ? \'embeddedLandingRootContentLogoVisible\' : \'embeddedLandingRootContentLogoHidden\'"><div class="embeddedPV"><exploration-container view-model="exploreContainer" ng-if="exploreContainer" canvas-options="canvasOptions"></exploration-container></div></div></div></div><div ng-show="showErrorMessage" class="embedError" ng-class="showLogoBar ? \'embeddedLandingRootContentLogoVisible\' : \'embeddedLandingRootContentLogoHidden\'"><span ng-bind="errorMessage" class="errorText"/><br/><a target="_blank" href="https://go.microsoft.com/fwlink/?LinkID=722383&clcid=0x409"><span localize="ReportEmbed_Learn_More_Message" class="errorText"></span></a></div></div><logo-bar ng-show="showLogoBar"></logo-bar>'),e.put("views/logoBar.html",'<div class="unselectable"><div class="logoBar"><div class="logo"><a ng-if="useTitleForAnchor()"><span localize="ReportEmbed_Logobar_MarketingText" class="text" onclick="window.open(this.title, \'_blank\');" title="{{powerbiLink}}"></span></a><a target="_blank" ng-if="!useTitleForAnchor()" ng-href="{{powerbiLink}}"><span localize="ReportEmbed_Logobar_MarketingText" class="text"></span></a> <span class="embedText" ng-if="isAnonymousLiveEmbed">&nbsp;-&nbsp;</span><span localize="ReportEmbed_Logobar_EmbedText" class="embedText" ng-if="isAnonymousLiveEmbed"></span><logo-bar-navigation is-small-screen="isSmallScreen" show-about-dialog="showAboutDialog()" mail-to-link="mailToLink"/><a ng-if="!isSmallScreen && showFullScreen" id="fullScreenIcon"><i class="glyphicon glyph-small pbi-glyph-fullscreen icon" ng-if="!isFullScreen()" ng-click="toggleFullScreenMode()" localize-tooltip="ReportEmbed_Logobar_FullScreen_Enter"></i><i class="glyphicon glyph-small pbi-glyph-fullscreenexit icon" ng-if="isFullScreen()" ng-click="toggleFullScreenMode()" localize-tooltip="FullScreen_Exit"></i></a><i ng-if="!isSmallScreen && !socialSharingFeatureEnabled" class="glyphicon pbi-glyph-info glyph-small icon" ng-click="showAboutDialog()" localize-tooltip="ReportEmbed_Logobar_AboutPowerBI"></i><a ng-if="!isSmallScreen && !socialSharingFeatureEnabled" ng-show="showFlag" ng-href="{{mailToLink}}" localize-tooltip="ReportEmbed_Logobar_InappropriateContent"><i class="glyphicon pbi-glyph-flag glyph-small icon"></i></a><span ng-if="!isSmallScreen && socialSharingFeatureEnabled"><logo-bar-social-sharing></logo-bar-social-sharing></span></div></div></div>'),e.put("views/logoBarNavigation.html",' <span class="navigation-wrapper" ng-class="{\'navigation-wrapper-big\': !isSmallScreen}"><a><i class="glyphicon glyph-small pbi-glyph-chevronleftmedium middleIcon" ng-click="navigationPreviousPage()" ng-show="allPagesCount !==undefined && allPagesCount>1" ng-class="(currentPageNumber === 0) ? \'inactive\' : \'active\'" localize-tooltip="ReportEmbed_Logobar_Navigation_PreviousPage"></i></a> <a class="middleText" ng-click="toggleOverlay()" ng-if="!isSmallScreen" ng-show="allPagesCount !==undefined && allPagesCount>1"> <span class="innerText">{{currentPageNumber+1}}</span><span localize="ReportEmbed_Logobar_PagesOf" class="innerText"></span> <span class="innerText">{{allPagesCount}}</span></a> <a><i class="glyphicon glyph-small pbi-glyph-chevronrightmedium middleIcon" ng-click="navigationNextPage()" ng-show="allPagesCount !==undefined && allPagesCount>1" ng-class="(currentPageNumber === allPagesCount-1) ? \'inactive\' : \'active\'" localize-tooltip="ReportEmbed_Logobar_Navigation_NextPage"></i></a> <a ng-if="isSmallScreen" ng-show="allPagesCount !==undefined && allPagesCount>= 1" ng-click="toggleOverlay()" localize-tooltip="ReportEmbed_Logobar_MoreOptions"><i class="glyphicon pbi-glyph-more glyph-small icon"></i></a></span><section class="navOverlay" id="flyoutElement" flyout-visible="false" ng-if="isSmallScreen"><div class="pageContainer" ng-hide="hidePageNavigationFlyout"><div class="overlayContent"><div class="overlaySections"><ul text-slide-animation="showOverlay" class="list"><li ng-repeat="(key, section) in sections track by key" class="sectionItemHidden animated"> <a ng-click="goToSection($index)" class="sectionItem" ng-class="$index === (currentPageNumber) ? \'selected\' : \'\'" title="{{section}}">{{section}}</a></li></ul></div></div></div><div class="iconContainer"><div ng-if="socialSharingFeatureEnabled"><logo-bar-social-sharing></logo-bar-social-sharing></div><div class="rightIcons"><i class="glyphicon pbi-glyph-info glyph-small overlayIcon" ng-click="showAboutDialog()"></i><a ng-href="{{mailToLink}}"><i class="glyphicon pbi-glyph-flag glyph-small overlayIcon"></i></a></div></div><a class="overlay-close" ng-click="toggleOverlay()" ng-hide="hidePageNavigationFlyout"><i class="glyphicon glyph-small pbi-glyph-close"></i></a></section><section ng-if="!isSmallScreen" id="flyoutElement" flyout-visible="false" class="navFlyout" ng-attr-style="height: {{40+allPagesCount*29}}px"><div class="wrapper"><div class="textContainer"><div class="flyoutSections"><ul text-slide-animation="showOverlay" class="list"><li ng-repeat="(key, section) in sections track by key" class="sectionItemHidden animated"> <a ng-click="goToSection($index)" class="sectionItem" ng-class="$index === (currentPageNumber) ? \'selected\' : \'\'" title="{{section}}">{{section}}</a></li></ul></div></div></div><div class="arrow"></div></section>'),
e.put("views/logoBarSocialSharing.html",'<span class="leftIcons" ng-if="isSmallScreen"><a class="socialShare" ng-click="toggleSocialSharing()"><i class="glyphicon pbi-glyph-share glyph-small glyphicon-social-share"></i></a><span localize="ReportEmbed_Logobar_Share" class="shareText"></span></span><span class="navigation-wrapper"><a ng-click="toggleSocialSharing()" ng-if="!isSmallScreen" localize-tooltip="ReportEmbed_Logobar_Share"><i class="glyphicon pbi-glyph-share glyph-small icon"></i></a><a ng-if="!isSmallScreen && !isMediumScreen" ng-href="https://www.facebook.com/sharer/sharer.php?u={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)" localize-tooltip="ReportEmbed_Logobar_Facebook"><div class="glyphicon glyphicon-share-facebook glyph-small icon"/></a><a ng-if="!isSmallScreen && !isMediumScreen" ng-href="https://twitter.com/intent/tweet?text={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)" localize-tooltip="ReportEmbed_Logobar_Twitter"><div class="glyphicon glyphicon-share-twitter glyph-small icon"/></a><a ng-if="!isSmallScreen && !isMediumScreen" ng-href="https://www.linkedin.com/shareArticle?mini=true&url={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)" localize-tooltip="ReportEmbed_Logobar_LinkedIn"><div class="glyphicon glyphicon-share-linkedIn glyph-small icon"/></a></span><section ng-if="isSmallScreen && socialSharingVisible" id="socialSharingflyoutElement" class="navOverlay"><div class="pageContainer"><div class="sharingContainerSmallScreen"><header localize="ReportEmbed_Logobar_Share" class="sharingFlyoutHeader"></header><p localize="ReportEmbed_Logobar_ShareUrl" class="sharingUrlText"></p> <input class="sharingUrlBox" readonly onClick="this.setSelectionRange(0, this.value.length); event.stopPropagation(); " ng-model=\'textShareLink\' autofocus/><span class="smallScreenSocialIcons"><a ng-href="https://www.facebook.com/sharer/sharer.php?u={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)"><div class="glyphicon glyphicon-share-facebook-large"/></a><a ng-href="https://twitter.com/intent/tweet?text={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)"><div class="glyphicon glyphicon-share-twitter-large"/></a><a ng-href="https://www.linkedin.com/shareArticle?mini=true&url={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)"><div class="glyphicon glyphicon-share-linkedIn-large"/></a><a ng-href="{{socialSharingEmailLink}}"><div class="glyphicon pbi-glyph-mail emailOverlayLarge"/></a></span></div></div><div class="iconContainer"><span class="leftIcons"><a class="socialShare" ng-click="toggleSocialSharing()"><i class="glyphicon pbi-glyph-share glyph-small glyphicon-social-share"></i></a><span localize="ReportEmbed_Logobar_Share" class="shareText"></span></span><span class="rightIcons"><i class="glyphicon pbi-glyph-info glyph-small overlayIcon" ng-click="showAboutDialog()"></i><a ng-href="{{mailToLink}}"><i class="glyphicon pbi-glyph-flag glyph-small overlayIcon"></i></a></span></div><a class="overlay-close" ng-click="closeSocialSharing()"><i class="glyphicon glyph-small pbi-glyph-close"></i></a></section><section ng-if="!isSmallScreen && socialSharingVisible" id="socialSharingflyoutElement" class="socialSharingFlyout"><header localize="ReportEmbed_Logobar_Share" class="sharingFlyoutHeader"></header><p localize="ReportEmbed_Logobar_ShareUrl" class="sharingUrlText"></p> <input class="sharingUrlBox" readonly onClick="this.setSelectionRange(0, this.value.length); event.stopPropagation(); " ng-model=\'textShareLink\' autofocus/><span class="urlTextIcons"><a ng-if="isMediumScreen" ng-href="https://www.facebook.com/sharer/sharer.php?u={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)" localize-tooltip="ReportEmbed_Logobar_Facebook"><div class="glyphicon glyphicon-share-facebook-medium glyph-small shareFlyoutIcon"/></a><a ng-if="isMediumScreen" ng-href="https://twitter.com/intent/tweet?text={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)" localize-tooltip="ReportEmbed_Logobar_Twitter"><div class="glyphicon glyphicon-share-twitter-medium glyph-small shareFlyoutIcon"/></a><a ng-if="isMediumScreen" ng-href="https://www.linkedin.com/shareArticle?mini=true&url={{shareLink}}" ng-attr-target="{{\'_blank\'}}" ng-click="openUsingWindow($event)" localize-tooltip="ReportEmbed_Logobar_LinkedIn"><div class="glyphicon glyphicon-share-linkedIn-medium glyph-small shareFlyoutIcon"/></a><a ng-href="{{socialSharingEmailLink}}" localize-tooltip="ReportEmbed_Logobar_ShareViaEmail"><i class="glyphicon pbi-glyph-mail glyph-small shareFlyoutIcon"></i></a><i class="glyphicon pbi-glyph-info glyph-small shareFlyoutIcon" ng-click="showAboutDialog()" localize-tooltip="ReportEmbed_Logobar_AboutPowerBI"></i><a ng-href="{{mailToLink}}" localize-tooltip="ReportEmbed_Logobar_InappropriateContent"><i class="glyphicon pbi-glyph-flag glyph-small shareFlyoutIcon"></i></a></span><div class="arrow"></div></section>')}]);var powerbi;!(function(e){var r;!(function(e){var r;!(function(e){var r;!(function(e){var r=(function(){function e(){}return e.isAnonymousLiveEmbed=function(){return"undefined"!=typeof isAnonymousEmbed&&isAnonymousEmbed===!0},e})();e.AnonymousLiveEmbedHelper=r})(r=e.controllers||(e.controllers={}))})(r=e.reportembed||(e.reportembed={}))})(r=e.explore||(e.explore={}))})(powerbi||(powerbi={}));

window.parseTimeMarkers['powerbireportembed.common.bundle.min.js'].end = Date.now();
